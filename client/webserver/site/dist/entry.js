/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/css/application.scss":
/*!**********************************!*\
  !*** ./src/css/application.scss ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/css/bootstrap.scss":
/*!********************************!*\
  !*** ./src/css/bootstrap.scss ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/js/account.ts":
/*!***************************!*\
  !*** ./src/js/account.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ReputationMeter": () => (/* binding */ ReputationMeter),
/* harmony export */   "bondReserveMultiplier": () => (/* binding */ bondReserveMultiplier),
/* harmony export */   "epochWeight": () => (/* binding */ epochWeight),
/* harmony export */   "likelyTaker": () => (/* binding */ likelyTaker),
/* harmony export */   "parcelLimitScoreMultiplier": () => (/* binding */ parcelLimitScoreMultiplier),
/* harmony export */   "perTierBaseParcelLimit": () => (/* binding */ perTierBaseParcelLimit),
/* harmony export */   "strongTier": () => (/* binding */ strongTier),
/* harmony export */   "tradingLimits": () => (/* binding */ tradingLimits)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");



const bondReserveMultiplier = 2; // Reserves for next bond
const perTierBaseParcelLimit = 2;
const parcelLimitScoreMultiplier = 3;
class ReputationMeter {
    constructor(div) {
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(this.page.penaltyMarkerTmpl);
    }
    setHost(host) {
        this.host = host;
    }
    update() {
        const { page, host } = this;
        const { auth, maxScore, penaltyThreshold } = (0,_registry__WEBPACK_IMPORTED_MODULE_2__.app)().exchanges[host];
        const { rep: { score } } = auth;
        const displayTier = strongTier(auth);
        const minScore = displayTier ? displayTier * penaltyThreshold * -1 : penaltyThreshold * -1; // Just for looks
        const warnPct = 25;
        const scorePct = 100 - warnPct;
        page.scoreWarn.style.width = `${warnPct}%`;
        const pos = score >= 0 ? warnPct + (score / maxScore) * scorePct : warnPct - (Math.min(warnPct, score / minScore * warnPct));
        page.scorePointer.style.left = `${pos}%`;
        page.scoreMin.textContent = String(minScore);
        page.scoreMax.textContent = String(maxScore);
        const bonus = limitBonus(score, maxScore);
        page.limitBonus.textContent = bonus.toFixed(1);
        for (const m of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.scoreTray, '.penalty-marker'))
            m.remove();
        if (displayTier > 1) {
            const markerPct = warnPct / displayTier;
            for (let i = 1; i < displayTier; i++) {
                const div = page.penaltyMarkerTmpl.cloneNode(true);
                page.scoreTray.appendChild(div);
                div.style.left = `${markerPct * i}%`;
            }
        }
        page.score.textContent = String(score);
        page.scoreData.classList.remove('negative', 'positive');
        if (score > 0)
            page.scoreData.classList.add('positive');
        else
            page.scoreData.classList.add('negative');
    }
}
/*
 * strongTier is the effective tier, with some respect for bond overlap, such
 * that we don't count weak bonds that have already had their replacements
 * confirmed.
 */
function strongTier(auth) {
    const { weakStrength, targetTier, effectiveTier } = auth;
    if (effectiveTier > targetTier) {
        const diff = effectiveTier - targetTier;
        if (weakStrength >= diff)
            return targetTier;
        return targetTier + (diff - weakStrength);
    }
    return effectiveTier;
}
function likelyTaker(ord, rate) {
    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_1__.OrderTypeMarket || ord.tif === _orderutil__WEBPACK_IMPORTED_MODULE_1__.ImmediateTiF)
        return true;
    // Must cross the spread to be a taker (not so conservative).
    if (rate === 0)
        return false;
    if (ord.sell)
        return ord.rate < rate;
    return ord.rate > rate;
}
const preparcelQuantity = (ord, mkt, midGap) => {
    var _a, _b;
    const qty = ord.qty - ord.filled;
    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_1__.OrderTypeLimit)
        return qty;
    if (ord.sell)
        return qty * ord.rate / _orderutil__WEBPACK_IMPORTED_MODULE_1__.RateEncodingFactor;
    const rate = midGap || ((_a = mkt === null || mkt === void 0 ? void 0 : mkt.spot) === null || _a === void 0 ? void 0 : _a.rate) || 0;
    // Caller should not call this for market orders without a mkt arg.
    if (!mkt)
        return 0;
    // This is tricky. The server will use the mid-gap rate to convert the
    // order qty. We don't have a mid-gap rate, only a spot rate.
    if (rate && (((_b = mkt === null || mkt === void 0 ? void 0 : mkt.spot) === null || _b === void 0 ? void 0 : _b.bookVolume) || 0) > 0)
        return qty * _orderutil__WEBPACK_IMPORTED_MODULE_1__.RateEncodingFactor / rate;
    return mkt.lotsize; // server uses same fallback if book is empty
};
function epochWeight(ord, mkt, midGap) {
    var _a;
    if (ord.status !== _orderutil__WEBPACK_IMPORTED_MODULE_1__.StatusEpoch)
        return 0;
    const qty = preparcelQuantity(ord, mkt, midGap);
    const rate = midGap || ((_a = mkt.spot) === null || _a === void 0 ? void 0 : _a.rate) || 0;
    if (likelyTaker(ord, rate))
        return qty * 2;
    return qty;
}
function bookWeight(ord) {
    if (ord.status !== _orderutil__WEBPACK_IMPORTED_MODULE_1__.StatusBooked)
        return 0;
    return preparcelQuantity(ord);
}
function settlingWeight(ord) {
    let sum = 0;
    for (const m of (ord.matches || [])) {
        if (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_1__.MatchSideMaker) {
            if (m.status > _orderutil__WEBPACK_IMPORTED_MODULE_1__.MakerRedeemed)
                continue;
        }
        else if (m.status > _orderutil__WEBPACK_IMPORTED_MODULE_1__.TakerSwapCast)
            continue;
        sum += m.qty;
    }
    return sum;
}
function parcelWeight(ord, mkt, midGap) {
    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_1__.OrderTypeCancel)
        return 0;
    return epochWeight(ord, mkt, midGap) + bookWeight(ord) + settlingWeight(ord);
}
// function roundParcels (p: number): number {
//   return Math.floor(Math.round((p * 1e8)) / 1e8)
// }
function limitBonus(score, maxScore) {
    return score > 0 ? 1 + score / maxScore * (parcelLimitScoreMultiplier - 1) : 1;
}
function tradingLimits(host) {
    const { auth, maxScore, markets } = (0,_registry__WEBPACK_IMPORTED_MODULE_2__.app)().exchanges[host];
    const { rep: { score } } = auth;
    const tier = strongTier(auth);
    let usedParcels = 0;
    for (const mkt of Object.values(markets)) {
        let mktWeight = 0;
        for (const ord of (mkt.inflight || []))
            mktWeight += parcelWeight(ord, mkt);
        for (const ord of (mkt.orders || []))
            mktWeight += parcelWeight(ord, mkt);
        usedParcels += (mktWeight / (mkt.parcelsize * mkt.lotsize));
    }
    const parcelLimit = perTierBaseParcelLimit * limitBonus(score, maxScore) * tier;
    return [usedParcels, parcelLimit];
}


/***/ }),

/***/ "./src/js/app.ts":
/*!***********************!*\
  !*** ./src/js/app.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Application)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _register__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./register */ "./src/js/register.ts");
/* harmony import */ var _login__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./login */ "./src/js/login.ts");
/* harmony import */ var _wallets__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./wallets */ "./src/js/wallets.ts");
/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./settings */ "./src/js/settings.ts");
/* harmony import */ var _markets__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./markets */ "./src/js/markets.ts");
/* harmony import */ var _orders__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./orders */ "./src/js/orders.ts");
/* harmony import */ var _order__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./order */ "./src/js/order.ts");
/* harmony import */ var _mm__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./mm */ "./src/js/mm.ts");
/* harmony import */ var _mmsettings__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./mmsettings */ "./src/js/mmsettings.ts");
/* harmony import */ var _dexsettings__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./dexsettings */ "./src/js/dexsettings.ts");
/* harmony import */ var _mmarchives__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./mmarchives */ "./src/js/mmarchives.ts");
/* harmony import */ var _mmlogs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./mmlogs */ "./src/js/mmlogs.ts");
/* harmony import */ var _init__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./init */ "./src/js/init.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _notifications__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./notifications */ "./src/js/notifications.ts");
/* harmony import */ var _ws__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ws */ "./src/js/ws.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






















const idel = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel; // = element by id
const bind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind;
const unbind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind;
const notificationRoute = 'notify';
const noteCacheSize = 100;
/* constructors is a map to page constructors. */
const constructors = {
    login: _login__WEBPACK_IMPORTED_MODULE_3__["default"],
    register: _register__WEBPACK_IMPORTED_MODULE_2__["default"],
    markets: _markets__WEBPACK_IMPORTED_MODULE_6__["default"],
    wallets: _wallets__WEBPACK_IMPORTED_MODULE_4__["default"],
    settings: _settings__WEBPACK_IMPORTED_MODULE_5__["default"],
    orders: _orders__WEBPACK_IMPORTED_MODULE_7__["default"],
    order: _order__WEBPACK_IMPORTED_MODULE_8__["default"],
    dexsettings: _dexsettings__WEBPACK_IMPORTED_MODULE_11__["default"],
    init: _init__WEBPACK_IMPORTED_MODULE_14__["default"],
    mm: _mm__WEBPACK_IMPORTED_MODULE_9__["default"],
    mmsettings: _mmsettings__WEBPACK_IMPORTED_MODULE_10__["default"],
    mmarchives: _mmarchives__WEBPACK_IMPORTED_MODULE_12__["default"],
    mmlogs: _mmlogs__WEBPACK_IMPORTED_MODULE_13__["default"]
};
const languageData = {
    'en-US': {
        name: 'English',
        flag: 'ðŸ‡ºðŸ‡¸' // Not ðŸ‡¬ðŸ‡§. MURICA!
    },
    'pt-BR': {
        name: 'Portugese',
        flag: 'ðŸ‡§ðŸ‡·'
    },
    'zh-CN': {
        name: 'Chinese',
        flag: 'ðŸ‡¨ðŸ‡³'
    },
    'pl-PL': {
        name: 'Polish',
        flag: 'ðŸ‡µðŸ‡±'
    },
    'de-DE': {
        name: 'German',
        flag: 'ðŸ‡©ðŸ‡ª'
    },
    'ar': {
        name: 'Arabic',
        flag: 'ðŸ‡ªðŸ‡¬' // Egypt I guess
    }
};
// Application is the main javascript web application for Bison Wallet.
class Application {
    constructor() {
        this.notes = [];
        this.pokes = [];
        this.seedGenTime = 0;
        this.commitHash = "017099c1a5be1062de357cc615e25b563a1d76ed" || 0;
        this.noteReceivers = [];
        this.fiatRatesMap = {};
        this.showPopups = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].popupsLK) === '1';
        this.txHistoryMap = {};
        this.requiredActions = {};
        console.log('Bison Wallet, Build', this.commitHash.substring(0, 7));
        // Set Bootstrap dark theme attribute if dark mode is enabled.
        if (_state__WEBPACK_IMPORTED_MODULE_1__["default"].isDark()) {
            document.body.classList.add('dark');
        }
        // Loggers can be enabled by setting a truthy value to the loggerID using
        // enableLogger. Settings are stored across sessions. See docstring for the
        // log method for more info.
        this.loggers = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].loggersLK) || {};
        window.enableLogger = (loggerID, state) => {
            if (state)
                this.loggers[loggerID] = true;
            else
                delete this.loggers[loggerID];
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].loggersLK, this.loggers);
            return `${loggerID} logger ${state ? 'enabled' : 'disabled'}`;
        };
        // Enable logging from anywhere.
        window.log = (loggerID, ...a) => { this.log(loggerID, ...a); };
        window.mmStatus = () => this.mmStatus;
        // Recorders can record log messages, and then save them to file on request.
        const recorderKeys = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].recordersLK) || [];
        this.recorders = {};
        for (const loggerID of recorderKeys) {
            console.log('recording', loggerID);
            this.recorders[loggerID] = [];
        }
        window.recordLogger = (loggerID, on) => {
            if (on)
                this.recorders[loggerID] = [];
            else
                delete this.recorders[loggerID];
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].recordersLK, Object.keys(this.recorders));
            return `${loggerID} recorder ${on ? 'enabled' : 'disabled'}`;
        };
        window.dumpLogger = loggerID => {
            const record = this.recorders[loggerID];
            if (!record)
                return `no recorder for logger ${loggerID}`;
            const a = document.createElement('a');
            a.href = `data:application/octet-stream;base64,${window.btoa(JSON.stringify(record, null, 4))}`;
            a.download = `${loggerID}.json`;
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                document.body.removeChild(a);
            }, 0);
        };
        window.user = () => this.user;
    }
    /**
     * Start the application. This is the only thing done from the index.js entry
     * point. Read the id = main element and attach handlers.
     */
    start() {
        return __awaiter(this, void 0, void 0, function* () {
            // Handle back navigation from the browser.
            bind(window, 'popstate', (e) => {
                var _a;
                const page = (_a = e.state) === null || _a === void 0 ? void 0 : _a.page;
                if (!page && page !== '')
                    return;
                this.loadPage(page, e.state.data, true);
            });
            // The main element is the interchangeable part of the page that doesn't
            // include the header. Main should define a data-handler attribute
            // associated with one of the available constructors.
            this.main = idel(document, 'main');
            const handler = this.main.dataset.handler;
            // Don't fetch the user until we know what page we're on.
            yield this.fetchUser();
            const ignoreCachedLocale = "development" === 'development';
            yield _locales__WEBPACK_IMPORTED_MODULE_20__.loadLocale(this.lang, this.commitHash, ignoreCachedLocale);
            // The application is free to respond with a page that differs from the
            // one requested in the omnibox, e.g. routing though a login page. Set the
            // current URL state based on the actual page.
            const url = new URL(window.location.href);
            if (handlerFromPath(url.pathname) !== handler) {
                url.pathname = `/${handler}`;
                url.search = '';
                window.history.replaceState({ page: handler }, '', url);
            }
            // Attach stuff.
            this.attachHeader();
            this.attachActions();
            this.attachCommon(this.header);
            this.attach({});
            // If we are authed, populate notes, otherwise get we'll them from the login
            // response.
            if (this.authed)
                yield this.fetchNotes();
            this.updateMenuItemsDisplay();
            // initialize desktop notifications
            _notifications__WEBPACK_IMPORTED_MODULE_18__.fetchDesktopNtfnSettings();
            // Connect the websocket and register the notification route.
            _ws__WEBPACK_IMPORTED_MODULE_19__["default"].connect(getSocketURI(), () => this.reconnected());
            _ws__WEBPACK_IMPORTED_MODULE_19__["default"].registerRoute(notificationRoute, (note) => {
                this.notify(note);
            });
        });
    }
    /*
     * reconnected is called by the websocket client when a reconnection is made.
     */
    reconnected() {
        var _a;
        if (((_a = this.main) === null || _a === void 0 ? void 0 : _a.dataset.handler) === 'settings')
            window.location.assign('/');
        else
            window.location.reload(); // This triggers another websocket disconnect/connect (!)
        // a fetchUser() and loadPage(window.history.state.page) might work
    }
    /*
     * Fetch and save the user, which is the primary core state that must be
     * maintained by the Application.
     */
    fetchUser() {
        return __awaiter(this, void 0, void 0, function* () {
            const resp = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.getJSON)('/api/user');
            if (!this.checkResponse(resp))
                return;
            this.inited = resp.inited;
            this.authed = Boolean(resp.user);
            this.lang = resp.lang;
            this.langs = resp.langs;
            this.mmStatus = resp.mmStatus;
            if (!resp.user)
                return;
            const user = resp.user;
            this.seedGenTime = user.seedgentime;
            this.user = user;
            this.assets = user.assets;
            this.exchanges = user.exchanges;
            this.walletMap = {};
            this.fiatRatesMap = user.fiatRates;
            for (const [assetID, asset] of Object.entries(user.assets)) {
                if (asset.wallet) {
                    this.walletMap[assetID] = asset.wallet;
                }
            }
            this.updateMenuItemsDisplay();
            return user;
        });
    }
    fetchMMStatus() {
        return __awaiter(this, void 0, void 0, function* () {
            this.mmStatus = yield _mmutil__WEBPACK_IMPORTED_MODULE_15__.MM.status();
        });
    }
    /* Load the page from the server. Insert and bind the DOM. */
    loadPage(page, data, skipPush) {
        return __awaiter(this, void 0, void 0, function* () {
            // Close some menus and tooltips.
            this.tooltip.style.left = '-10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noteBox, this.page.profileBox);
            // Parse the request.
            const url = new URL(`/${page}`, window.location.origin);
            const requestedHandler = handlerFromPath(page);
            // Fetch and parse the page.
            const response = yield window.fetch(url.toString());
            if (!response.ok)
                return false;
            const html = yield response.text();
            const doc = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].noderize(html);
            const main = idel(doc, 'main');
            const delivered = main.dataset.handler;
            // Append the request to the page history.
            if (!skipPush) {
                const path = delivered === requestedHandler ? url.toString() : `/${delivered}`;
                window.history.pushState({ page: page, data: data }, '', path);
            }
            // Insert page and attach handlers.
            document.title = doc.title;
            this.main.replaceWith(main);
            this.main = main;
            this.noteReceivers = [];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.headerSpace);
            this.attach(data);
            return true;
        });
    }
    /* attach binds the common handlers and calls the page constructor. */
    attach(data) {
        const handlerID = this.main.dataset.handler;
        if (!handlerID) {
            console.error('cannot attach to content with no specified handler');
            return;
        }
        this.attachCommon(this.main);
        if (this.loadedPage)
            this.loadedPage.unload();
        const constructor = constructors[handlerID];
        if (constructor)
            this.loadedPage = new constructor(this.main, data);
        else
            this.loadedPage = null;
        // Bind the tooltips.
        this.bindTooltips(this.main);
        if (window.isWebview) {
            // Bind webview URL handlers
            this.bindUrlHandlers(this.main);
        }
        this.bindUnits(this.main);
    }
    bindTooltips(ancestor) {
        ancestor.querySelectorAll('[data-tooltip]').forEach((el) => {
            bind(el, 'mouseenter', () => {
                this.tooltip.textContent = el.dataset.tooltip || '';
                const lyt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(el);
                let left = lyt.centerX - this.tooltip.offsetWidth / 2;
                if (left < 0)
                    left = 5;
                if (left + this.tooltip.offsetWidth > document.body.offsetWidth) {
                    left = document.body.offsetWidth - this.tooltip.offsetWidth - 5;
                }
                this.tooltip.style.left = `${left}px`;
                this.tooltip.style.top = `${lyt.bodyTop - this.tooltip.offsetHeight - 5}px`;
            });
            bind(el, 'mouseleave', () => {
                this.tooltip.style.left = '-10000px';
            });
        });
    }
    /*
     * bindUnits binds a hovering unit selection menu to the value or rate
     * display elements. The menu gives users an option to convert the value
     * to their preferred units.
     */
    bindUnits(main) {
        const div = document.createElement('div');
        div.classList.add('position-absolute', 'p-3');
        // div.style.backgroundColor = 'yellow'
        const rows = document.createElement('div');
        div.appendChild(rows);
        rows.classList.add('body-bg', 'border');
        const addRow = (el, unit, cFactor) => {
            const box = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, '[data-unit-box]');
            const atoms = parseInt(box.dataset.atoms);
            const row = document.createElement('div');
            row.textContent = unit;
            rows.appendChild(row);
            row.classList.add('p-2', 'hoverbg', 'pointer');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(el, '[data-value]', _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(atoms / cFactor, Math.round(Math.log10(cFactor))));
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(el, '[data-unit]', unit);
            });
        };
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(main, '[data-conversion-value]')) {
            const box = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, '[data-unit-box]');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(box, 'mouseenter', () => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(rows);
                box.appendChild(div);
                const lyt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(box);
                const assetID = parseInt(box.dataset.assetID);
                const { unitInfo: ui } = this.assets[assetID];
                addRow(el, ui.conventional.unit, ui.conventional.conversionFactor);
                for (const { unit, conversionFactor } of ui.denominations)
                    addRow(el, unit, conversionFactor);
                addRow(el, ui.atomicUnit, 1);
                if (lyt.bodyTop > (div.offsetHeight + this.header.offsetHeight)) {
                    div.style.bottom = 'calc(100% - 1rem)';
                    div.style.top = 'auto';
                }
                else {
                    div.style.top = 'calc(100% - 1rem)';
                    div.style.bottom = 'auto';
                }
            });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(box, 'mouseleave', () => div.remove());
        }
    }
    bindUrlHandlers(ancestor) {
        if (!window.openUrl)
            return;
        for (const link of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, 'a[target=_blank]')) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(link, 'click', (e) => {
                var _a;
                e.preventDefault();
                window.openUrl((_a = link.href) !== null && _a !== void 0 ? _a : '');
            });
        }
    }
    /* attachHeader attaches the header element, which unlike the main element,
     * isn't replaced during page navigation.
     */
    attachHeader() {
        this.header = idel(document.body, 'header');
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(this.header);
        this.headerSpace = page.headerSpace;
        this.popupNotes = idel(document.body, 'popupNotes');
        this.popupTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(this.popupNotes, 'note');
        if (this.popupTmpl)
            this.popupTmpl.remove();
        else
            console.error('popupTmpl element not found');
        this.tooltip = idel(document.body, 'tooltip');
        page.noteTmpl.removeAttribute('id');
        page.noteTmpl.remove();
        page.pokeTmpl.removeAttribute('id');
        page.pokeTmpl.remove();
        page.loader.remove();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.loader);
        bind(page.noteBell, 'click', () => __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.pokeList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noteList);
            this.ackNotes();
            page.noteCat.classList.add('active');
            page.pokeCat.classList.remove('active');
            this.showDropdown(page.noteBell, page.noteBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteIndicator);
            for (const note of this.notes) {
                if (note.acked) {
                    note.el.classList.remove('firstview');
                }
            }
            this.setNoteTimes(page.noteList);
            this.setNoteTimes(page.pokeList);
        }));
        bind(page.burgerIcon, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.logoutErr);
            this.showDropdown(page.burgerIcon, page.profileBox);
        });
        bind(page.innerNoteIcon, 'click', () => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteBox); });
        bind(page.innerBurgerIcon, 'click', () => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.profileBox); });
        bind(page.profileSignout, 'click', () => __awaiter(this, void 0, void 0, function* () { return yield this.signOut(); }));
        bind(page.pokeCat, 'click', () => {
            this.setNoteTimes(page.pokeList);
            page.pokeCat.classList.add('active');
            page.noteCat.classList.remove('active');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.pokeList);
            this.ackNotes();
        });
        bind(page.noteCat, 'click', () => {
            this.setNoteTimes(page.noteList);
            page.noteCat.classList.add('active');
            page.pokeCat.classList.remove('active');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.pokeList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noteList);
            this.ackNotes();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.langBttnTmpl);
        const { name, flag } = languageData[this.lang];
        page.langFlag.textContent = flag;
        page.langName.textContent = name;
        for (const lang of this.langs) {
            if (lang === this.lang)
                continue;
            const div = page.langBttnTmpl.cloneNode(true);
            const { name, flag } = languageData[lang];
            div.textContent = flag;
            div.title = name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'click', () => this.setLanguage(lang));
            page.langBttns.appendChild(div);
        }
    }
    attachActions() {
        const { page } = this;
        Object.assign(page, _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel(document.body, 'requiredActions')));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.missingNoncesTmpl, page.actionTxTableTmpl, page.tooCheapTmpl, page.lostNonceTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.actionsCollapse, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialog);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionDialogCollapsed);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.actionDialogCollapsed, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialogCollapsed);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionDialog);
            if (page.actionDialogContent.children.length === 0)
                this.showOldestAction();
        });
        const showAdjacentAction = (dir) => {
            const selected = Object.values(this.requiredActions).filter((r) => r.selected)[0];
            const actions = this.sortedActions();
            const idx = actions.indexOf(selected);
            this.showRequestedAction(actions[idx + dir].uniqueID);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.prevAction, 'click', () => showAdjacentAction(-1));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.nextAction, 'click', () => showAdjacentAction(1));
    }
    setRequiredActions() {
        const { user: { actions }, requiredActions } = this;
        if (!actions)
            return;
        for (const a of actions)
            this.addAction(a);
        if (Object.keys(requiredActions).length) {
            this.showOldestAction();
            this.blinkAction();
        }
    }
    sortedActions() {
        const actions = Object.values(this.requiredActions);
        actions.sort((a, b) => a.stamp - b.stamp);
        return actions;
    }
    showOldestAction() {
        this.showRequestedAction(this.sortedActions()[0].uniqueID);
    }
    addAction(req) {
        const { page, requiredActions } = this;
        const existingAction = requiredActions[req.uniqueID];
        if (existingAction && existingAction.actionID === req.actionID)
            return;
        const div = this.actionForm(req);
        if (existingAction) {
            if (existingAction.selected)
                existingAction.div.replaceWith(div);
            existingAction.div = div;
        }
        else {
            requiredActions[req.uniqueID] = {
                div,
                stamp: (new Date()).getTime(),
                uniqueID: req.uniqueID,
                actionID: req.actionID,
                selected: false
            };
            const n = Object.keys(requiredActions).length;
            page.actionDialogCount.textContent = String(n);
            page.actionCount.textContent = String(n);
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.actionDialog)) {
                this.showRequestedAction(req.uniqueID);
            }
        }
    }
    blinkAction() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(this.page.actionDialog);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(this.page.actionDialogCollapsed);
    }
    resolveAction(req) {
        this.resolveActionWithID(req.uniqueID);
    }
    resolveActionWithID(uniqueID) {
        const { page, requiredActions } = this;
        const existingAction = requiredActions[uniqueID];
        if (!existingAction)
            return;
        delete requiredActions[uniqueID];
        const rem = Object.keys(requiredActions).length;
        existingAction.div.remove();
        if (rem === 0) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialog, page.actionDialogCollapsed);
            return;
        }
        page.actionDialogCount.textContent = String(rem);
        page.actionCount.textContent = String(rem);
        if (existingAction.selected)
            this.showOldestAction();
    }
    actionForm(req) {
        switch (req.actionID) {
            case 'tooCheap':
                return this.tooCheapAction(req);
            case 'missingNonces':
                return this.missingNoncesAction(req);
            case 'lostNonce':
                return this.lostNonceAction(req);
            case 'redeemRejected':
                return this.redeemRejectedAction(req);
        }
        throw Error('unknown required action ID ' + req.actionID);
    }
    actionTxTable(req) {
        const { assetID, payload } = req;
        const n = payload;
        const { unitInfo: ui, token } = this.assets[assetID];
        const table = this.page.actionTxTableTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(table);
        tmpl.lostTxID.textContent = n.tx.id;
        tmpl.lostTxID.dataset.explorerCoin = n.tx.id;
        (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_21__.setCoinHref)(token ? token.parentID : assetID, tmpl.lostTxID);
        tmpl.txAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.tx.amount, ui);
        tmpl.amtUnit.textContent = ui.conventional.unit;
        const parentUI = token ? this.unitInfo(token.parentID) : ui;
        tmpl.type.textContent = (0,_wallets__WEBPACK_IMPORTED_MODULE_4__.txTypeString)(n.tx.type);
        tmpl.feeAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.tx.fees, parentUI);
        tmpl.feeUnit.textContent = parentUI.conventional.unit;
        switch (req.actionID) {
            case 'tooCheap': {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.newFeesRow);
                tmpl.newFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.tx.fees, parentUI);
                tmpl.newFeesUnit.textContent = parentUI.conventional.unit;
                break;
            }
        }
        return table;
    }
    submitAction(req, action, errMsg) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(errMsg);
            const loading = this.loading(this.page.actionDialog);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/takeaction', {
                assetID: req.assetID,
                actionID: req.actionID,
                action
            });
            loading();
            if (!this.checkResponse(res)) {
                errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(errMsg);
                return;
            }
            this.resolveActionWithID(req.uniqueID);
        });
    }
    missingNoncesAction(req) {
        const { assetID } = req;
        const div = this.page.missingNoncesTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.doNothingBttn, 'click', () => {
            this.submitAction(req, { recover: false }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.recoverBttn, 'click', () => {
            this.submitAction(req, { recover: true }, tmpl.errMsg);
        });
        return div;
    }
    tooCheapAction(req) {
        const { assetID, payload } = req;
        const n = payload;
        const div = this.page.tooCheapTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        tmpl.txTable.appendChild(this.actionTxTable(req));
        const act = (bump) => {
            this.submitAction(req, {
                txID: n.tx.id,
                bump
            }, tmpl.errMsg);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.keepWaitingBttn, 'click', () => act(false));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.addFeesBttn, 'click', () => act(true));
        return div;
    }
    lostNonceAction(req) {
        const { assetID, payload } = req;
        const n = payload;
        const div = this.page.lostNonceTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        tmpl.nonce.textContent = String(n.nonce);
        tmpl.txTable.appendChild(this.actionTxTable(req));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.abandonBttn, 'click', () => {
            this.submitAction(req, { txID: n.tx.id, abandon: true }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.keepWaitingBttn, 'click', () => {
            this.submitAction(req, { txID: n.tx.id, abandon: false }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.replaceBttn, 'click', () => {
            const replacementID = tmpl.idInput.value;
            if (!replacementID) {
                tmpl.idInput.focus();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(tmpl.idInput);
                return;
            }
            this.submitAction(req, { txID: n.tx.id, abandon: false, replacementID }, tmpl.errMsg);
        });
        return div;
    }
    redeemRejectedAction(req) {
        const { orderID, coinID, coinFmt, assetID } = req.payload;
        const div = this.page.rejectedRedemptionTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name, token } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        tmpl.txid.textContent = coinFmt;
        tmpl.txid.dataset.explorerCoin = coinID;
        (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_21__.setCoinHref)(token ? token.parentID : assetID, tmpl.txid);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.doNothingBttn, 'click', () => {
            this.submitAction(req, { orderID, coinID, retry: false }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.tryAgainBttn, 'click', () => {
            this.submitAction(req, { orderID, coinID, retry: true }, tmpl.errMsg);
        });
        return div;
    }
    showRequestedAction(uniqueID) {
        const { page, requiredActions } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialogCollapsed);
        for (const r of Object.values(requiredActions))
            r.selected = r.uniqueID === uniqueID;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.actionDialogContent);
        const action = requiredActions[uniqueID];
        page.actionDialogContent.appendChild(action.div);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionDialog);
        const actions = this.sortedActions();
        if (actions.length === 1) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionsNavigator);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionsNavigator);
        const idx = actions.indexOf(action);
        page.currentAction.textContent = String(idx + 1);
        page.prevAction.classList.toggle('invisible', idx === 0);
        page.nextAction.classList.toggle('invisible', idx === actions.length - 1);
    }
    /*
     * updateMarketElements sets the textContent for any ticker or asset name
     * elements or any asset logo src attributes for descendents of ancestor.
     */
    updateMarketElements(ancestor, baseID, quoteID, xc) {
        const getAsset = (assetID) => {
            const a = this.assets[assetID];
            if (a)
                return a;
            if (!xc)
                throw Error(`no asset found for asset ID ${assetID}`);
            const xcAsset = xc.assets[assetID];
            return { unitInfo: xcAsset.unitInfo, name: xcAsset.symbol, symbol: xcAsset.symbol };
        };
        const { unitInfo: bui, name: baseName, symbol: baseSymbol } = getAsset(baseID);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-base-name'))
            el.textContent = baseName;
        for (const img of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-base-logo]'))
            img.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(baseSymbol);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-base-ticker]'))
            el.textContent = bui.conventional.unit;
        const { unitInfo: qui, name: quoteName, symbol: quoteSymbol } = getAsset(quoteID);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-quote-name'))
            el.textContent = quoteName;
        for (const img of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-quote-logo]'))
            img.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(quoteSymbol);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-quote-ticker]'))
            el.textContent = qui.conventional.unit;
    }
    setLanguage(lang) {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/setlocale', lang);
            window.location.reload();
        });
    }
    /*
     * showDropdown sets the position and visibility of the specified dropdown
     * dialog according to the position of its icon button.
     */
    showDropdown(icon, dialog) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noteBox, this.page.profileBox);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(dialog);
        if (window.innerWidth < 500)
            Object.assign(dialog.style, { left: '0', right: '0', top: '0' });
        else {
            const ico = icon.getBoundingClientRect();
            const right = `${window.innerWidth - ico.left - ico.width + 5}px`;
            Object.assign(dialog.style, { left: 'auto', right, top: `${ico.top - 4}px` });
        }
        const hide = (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, dialog)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(dialog);
                unbind(document, 'click', hide);
                if (dialog === this.page.noteBox && _doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.noteList)) {
                    this.ackNotes();
                }
            }
        };
        bind(document, 'click', hide);
    }
    ackNotes() {
        const acks = [];
        for (const note of this.notes) {
            if (note.acked) {
                note.el.classList.remove('firstview');
            }
            else {
                note.acked = true;
                if (note.id && note.severity > _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE)
                    acks.push(note.id);
            }
        }
        if (acks.length)
            _ws__WEBPACK_IMPORTED_MODULE_19__["default"].request('acknotes', acks);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noteIndicator);
    }
    setNoteTimes(noteList) {
        for (const el of Array.from(noteList.children)) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'span.note-time').textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(el.note.stamp);
        }
    }
    /*
     * bindInternalNavigation hijacks navigation by click on any local links that
     * are descendants of ancestor.
     */
    bindInternalNavigation(ancestor) {
        const pageURL = new URL(window.location.href);
        ancestor.querySelectorAll('a').forEach(a => {
            if (!a.href)
                return;
            const url = new URL(a.href);
            if (url.origin === pageURL.origin) {
                const token = url.pathname.substring(1);
                const params = {};
                if (url.search) {
                    url.searchParams.forEach((v, k) => {
                        params[k] = v;
                    });
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(a, 'click', (e) => {
                    e.preventDefault();
                    this.loadPage(token, params);
                });
            }
        });
    }
    /*
     * updateMenuItemsDisplay should be called when the user has signed in or out,
     * and when the user registers a DEX.
     */
    updateMenuItemsDisplay() {
        const { page, authed, mmStatus } = this;
        if (!page) {
            // initial page load, header elements not yet attached but menu items
            // would already be hidden/displayed as appropriate.
            return;
        }
        if (!authed) {
            page.profileBox.classList.remove('authed');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteBell, page.walletsMenuEntry, page.marketsMenuEntry);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(Object.keys(this.exchanges).length > 0, page.marketsMenuEntry, page.mmLink);
        page.profileBox.classList.add('authed');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noteBell, page.walletsMenuEntry, page.marketsMenuEntry);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(mmStatus, page.mmLink);
    }
    fetchNotes() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.getJSON)('/api/notes');
            if (!this.checkResponse(res))
                return console.error('failed to fetch notes:', (res === null || res === void 0 ? void 0 : res.msg) || String(res));
            res.notes.reverse();
            this.setNotes(res.notes);
            this.setPokes(res.pokes);
            this.setRequiredActions();
        });
    }
    /* attachCommon scans the provided node and handles some common bindings. */
    attachCommon(node) {
        this.bindInternalNavigation(node);
    }
    /*
     * updateBondConfs updates the information for a pending bond.
     */
    updateBondConfs(dexAddr, coinID, confs) {
        const dex = this.exchanges[dexAddr];
        for (const bond of dex.auth.pendingBonds)
            if (bond.coinID === coinID)
                bond.confs = confs;
    }
    updateTier(host, bondedTier) {
        this.exchanges[host].auth.rep.bondedTier = bondedTier;
    }
    /*
     * handleBondNote is the handler for the 'bondpost'-type notification, which
     * is used to update the dex tier and registration status.
     */
    handleBondNote(note) {
        if (note.auth)
            this.exchanges[note.dex].auth = note.auth;
        switch (note.topic) {
            case 'RegUpdate':
                if (note.coinID !== null) { // should never be null for RegUpdate
                    this.updateBondConfs(note.dex, note.coinID, note.confirmations);
                }
                break;
            case 'BondConfirmed':
                if (note.tier !== null) { // should never be null for BondConfirmed
                    this.updateTier(note.dex, note.tier);
                }
                break;
            default:
                break;
        }
    }
    /*
     * handleTransaction either adds a new transaction to the transaction history
     * or updates an existing transaction.
     */
    handleTransactionNote(assetID, note) {
        const txHistory = this.txHistoryMap[assetID];
        if (!txHistory)
            return;
        if (note.new) {
            txHistory.txs.unshift(note.transaction);
            return;
        }
        for (let i = 0; i < txHistory.txs.length; i++) {
            if (txHistory.txs[i].id === note.transaction.id) {
                txHistory.txs[i] = note.transaction;
                break;
            }
        }
    }
    handleTxHistorySyncedNote(assetID) {
        delete this.txHistoryMap[assetID];
    }
    loggedIn(notes, pokes) {
        this.setNotes(notes);
        this.setPokes(pokes);
        this.setRequiredActions();
    }
    /*
     * setNotes sets the current notification cache and populates the notification
     * display.
     */
    setNotes(notes) {
        this.log('notes', 'setNotes', notes);
        this.notes = [];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.noteList);
        for (let i = 0; i < notes.length; i++) {
            this.prependNoteElement(notes[i]);
        }
    }
    /*
     * setPokes sets the current poke cache and populates the pokes display.
     */
    setPokes(pokes) {
        this.log('pokes', 'setPokes', pokes);
        this.pokes = [];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.pokeList);
        for (let i = 0; i < pokes.length; i++) {
            this.prependPokeElement(pokes[i]);
        }
    }
    botStatus(host, baseID, quoteID) {
        var _a, _b;
        for (const bot of ((_b = (_a = this.mmStatus) === null || _a === void 0 ? void 0 : _a.bots) !== null && _b !== void 0 ? _b : [])) {
            const { config: c } = bot;
            if (host === c.host && baseID === c.baseID && quoteID === c.quoteID) {
                return bot;
            }
        }
    }
    updateUser(note) {
        const { user, assets, walletMap } = this;
        if (note.type === 'fiatrateupdate') {
            this.fiatRatesMap = note.fiatRates;
            return;
        }
        // Some notes can be received before we get a User during login.
        if (!user)
            return;
        switch (note.type) {
            case 'order': {
                const orderNote = note;
                const order = orderNote.order;
                const mkt = user.exchanges[order.host].markets[order.market];
                const tempID = orderNote.tempID;
                // Ensure market's inflight orders list is updated.
                if (note.topic === 'AsyncOrderSubmitted') {
                    const inFlight = order;
                    inFlight.tempID = tempID;
                    if (!mkt.inflight)
                        mkt.inflight = [inFlight];
                    else
                        mkt.inflight.push(inFlight);
                    break;
                }
                else if (note.topic === 'AsyncOrderFailure') {
                    mkt.inflight = mkt.inflight.filter(ord => ord.tempID !== tempID);
                    break;
                }
                else {
                    for (const i in mkt.inflight || []) {
                        if (!(mkt.inflight[i].tempID === tempID))
                            continue;
                        mkt.inflight = mkt.inflight.filter(ord => ord.tempID !== tempID);
                        break;
                    }
                }
                // Updates given order in market's orders list if it finds it.
                // Returns a bool which indicates if order was found.
                mkt.orders = mkt.orders || [];
                const updateOrder = (mkt, ord) => {
                    const i = mkt.orders.findIndex((o) => o.id === ord.id);
                    if (i === -1)
                        return false;
                    if (note.topic === 'OrderRetired')
                        mkt.orders.splice(i, 1);
                    else
                        mkt.orders[i] = ord;
                    return true;
                };
                // If the notification order already exists we update it.
                // In case market's orders list is empty or the notification order isn't
                // part of it we add it manually as this means the order was
                // just placed.
                if (!updateOrder(mkt, order))
                    mkt.orders.push(order);
                break;
            }
            case 'balance': {
                const n = note;
                const asset = user.assets[n.assetID];
                // Balance updates can come before the user is fetched after login.
                if (!asset)
                    break;
                const w = asset.wallet;
                if (w)
                    w.balance = n.balance;
                break;
            }
            case 'bondpost':
                this.handleBondNote(note);
                break;
            case 'reputation': {
                const n = note;
                this.exchanges[n.host].auth.rep = n.rep;
                break;
            }
            case 'walletstate':
            case 'walletconfig': {
                // assets can be null if failed to connect to dex server.
                if (!assets)
                    return;
                const wallet = note === null || note === void 0 ? void 0 : note.wallet;
                if (!wallet)
                    return;
                const asset = assets[wallet.assetID];
                asset.wallet = wallet;
                walletMap[wallet.assetID] = wallet;
                break;
            }
            case 'walletsync': {
                const n = note;
                const w = this.walletMap[n.assetID];
                if (w) {
                    w.syncStatus = n.syncStatus;
                    w.synced = w.syncStatus.synced;
                    w.syncProgress = n.syncProgress;
                }
                break;
            }
            case 'match': {
                const n = note;
                const ord = this.order(n.orderID);
                if (ord)
                    updateMatch(ord, n.match);
                break;
            }
            case 'conn': {
                const n = note;
                const xc = user.exchanges[n.host];
                if (xc)
                    xc.connectionStatus = n.connectionStatus;
                break;
            }
            case 'spots': {
                const n = note;
                const xc = user.exchanges[n.host];
                // Spots can come before the user is fetched after login and before/while the
                // markets page reload when it receives a dex conn note.
                if (!xc || !xc.markets)
                    break;
                for (const [mktName, spot] of Object.entries(n.spots))
                    xc.markets[mktName].spot = spot;
                break;
            }
            case 'fiatrateupdate': {
                this.fiatRatesMap = note.fiatRates;
                break;
            }
            case 'actionrequired': {
                const n = note;
                this.addAction(n.payload);
                break;
            }
            case 'walletnote': {
                const n = note;
                switch (n.payload.route) {
                    case 'transaction': {
                        const txNote = n.payload;
                        this.handleTransactionNote(n.payload.assetID, txNote);
                        break;
                    }
                    case 'actionRequired': {
                        const req = n.payload;
                        this.addAction(req);
                        this.blinkAction();
                        break;
                    }
                    case 'actionResolved': {
                        this.resolveAction(n.payload);
                    }
                }
                if (n.payload.route === 'transactionHistorySynced') {
                    this.handleTxHistorySyncedNote(n.payload.assetID);
                }
                break;
            }
            case 'runstats': {
                this.log('mm', { runstats: note });
                const n = note;
                const bot = this.botStatus(n.host, n.baseID, n.quoteID);
                if (bot) {
                    bot.runStats = n.stats;
                    bot.running = Boolean(n.stats);
                    if (!n.stats) {
                        bot.latestEpoch = undefined;
                        bot.cexProblems = undefined;
                    }
                }
                break;
            }
            case 'cexnote': {
                const n = note;
                switch (n.topic) {
                    case 'BalanceUpdate': {
                        const u = n.note;
                        this.mmStatus.cexes[n.cexName].balances[u.assetID] = u.balance;
                    }
                }
                break;
            }
            case 'epochreport': {
                const n = note;
                const bot = this.botStatus(n.host, n.baseID, n.quoteID);
                if (bot)
                    bot.latestEpoch = n.report;
                break;
            }
            case 'cexproblems': {
                const n = note;
                const bot = this.botStatus(n.host, n.baseID, n.quoteID);
                if (bot)
                    bot.cexProblems = n.problems;
                break;
            }
        }
    }
    /*
     * notify is the top-level handler for notifications received from the client.
     * Notifications are propagated to the loadedPage.
     */
    notify(note) {
        // Handle type-specific updates.
        this.log('notes', 'notify', note);
        this.updateUser(note);
        // Inform the page.
        for (const feeder of this.noteReceivers) {
            const f = feeder[note.type];
            if (!f)
                continue;
            try {
                f(note);
            }
            catch (error) {
                console.error('note feeder error:', error.message ? error.message : error);
                console.log(note);
                console.log(error.stack);
            }
        }
        // Discard data notifications.
        if (note.severity < _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE)
            return;
        // Poke notifications have their own display.
        const { popupTmpl, popupNotes, showPopups } = this;
        if (showPopups) {
            const span = popupTmpl.cloneNode(true);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(span, 'text').textContent = `${note.subject}: ${_notifications__WEBPACK_IMPORTED_MODULE_18__.plainNote(note.details)}`;
            const indicator = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(span, 'indicator');
            if (note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(indicator);
            }
            else
                setSeverityClass(indicator, note.severity);
            popupNotes.appendChild(span);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(popupNotes);
            // These take up screen space. Only show max 5 at a time.
            while (popupNotes.children.length > 5)
                popupNotes.removeChild(popupNotes.firstChild);
            setTimeout(() => __awaiter(this, void 0, void 0, function* () {
                yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(500, (progress) => {
                    span.style.opacity = String(1 - progress);
                });
                span.remove();
                if (popupNotes.children.length === 0)
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(popupNotes);
            }), 6000);
        }
        // Success and higher severity go to the bell dropdown.
        if (note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE)
            this.prependPokeElement(note);
        else
            this.prependNoteElement(note);
        // show desktop notification
        _notifications__WEBPACK_IMPORTED_MODULE_18__.desktopNotify(note);
    }
    /*
     * registerNoteFeeder registers a feeder for core notifications. The feeder
     * will be de-registered when a new page is loaded.
     */
    registerNoteFeeder(receivers) {
        this.noteReceivers.push(receivers);
    }
    /*
     * log prints to the console if a logger has been enabled. Loggers are created
     * implicitly by passing a loggerID to log. i.e. you don't create a logger,
     * you just log to it. Loggers are enabled by invoking a global function,
     * enableLogger(loggerID, onOffBoolean), from the browser's js console. Your
     * choices are stored across sessions. Some common and useful loggers are
     * listed below, but this list is not meant to be comprehensive.
     *
     * LoggerID   Description
     * --------   -----------
     * notes      Notifications of all levels.
     * book       Order book feed.
     * ws.........Websocket connection status changes.
     */
    log(loggerID, ...msg) {
        if (this.loggers[loggerID])
            console.log(`${nowString()}[${loggerID}]:`, ...msg);
        if (this.recorders[loggerID]) {
            this.recorders[loggerID].push({
                time: nowString(),
                msg: msg
            });
        }
    }
    prependPokeElement(cn) {
        const [el, note] = this.makePoke(cn);
        this.pokes.push(note);
        while (this.pokes.length > noteCacheSize)
            this.pokes.shift();
        this.prependListElement(this.page.pokeList, note, el);
    }
    prependNoteElement(cn) {
        const [el, note] = this.makeNote(cn);
        this.notes.push(note);
        while (this.notes.length > noteCacheSize)
            this.notes.shift();
        const noteList = this.page.noteList;
        this.prependListElement(noteList, note, el);
        this.bindUrlHandlers(el);
        // Set the indicator color.
        if (this.notes.length === 0 || (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.noteBox) && _doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(noteList)))
            return;
        let unacked = 0;
        const severity = this.notes.reduce((s, note) => {
            if (!note.acked)
                unacked++;
            if (!note.acked && note.severity > s)
                return note.severity;
            return s;
        }, _notifications__WEBPACK_IMPORTED_MODULE_18__.IGNORE);
        const ni = this.page.noteIndicator;
        setSeverityClass(ni, severity);
        if (unacked) {
            ni.textContent = String((unacked > noteCacheSize - 1) ? `${noteCacheSize - 1}+` : unacked);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(ni);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(ni);
    }
    prependListElement(noteList, note, el) {
        el.note = note;
        noteList.prepend(el);
        while (noteList.children.length > noteCacheSize)
            noteList.removeChild(noteList.lastChild);
        this.setNoteTimes(noteList);
    }
    /*
     * makeNote constructs a single notification element for the drop-down
     * notification list.
     */
    makeNote(note) {
        const el = this.page.noteTmpl.cloneNode(true);
        if (note.severity > _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE) {
            const cls = note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.SUCCESS ? 'good' : note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.WARNING ? 'warn' : 'bad';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'div.note-indicator').classList.add(cls);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'div.note-subject').textContent = note.subject;
        _notifications__WEBPACK_IMPORTED_MODULE_18__.insertRichNote(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'div.note-details'), note.details);
        const np = Object.assign({ el }, note);
        return [el, np];
    }
    makePoke(note) {
        const el = this.page.pokeTmpl.cloneNode(true);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(el, 'subject').textContent = `${note.subject}:`;
        _notifications__WEBPACK_IMPORTED_MODULE_18__.insertRichNote(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(el, 'details'), note.details);
        const np = Object.assign({ el }, note);
        return [el, np];
    }
    /*
     * loading appends the loader to the specified element and displays the
     * loading icon. The loader will block all interaction with the specified
     * element until Application.loaded is called.
     */
    loading(el) {
        const loader = this.page.loader.cloneNode(true);
        el.appendChild(loader);
        return () => { loader.remove(); };
    }
    /* orders retrieves a list of orders for the specified dex and market
     * including inflight orders.
     */
    orders(host, mktID) {
        let orders = [];
        const mkt = this.user.exchanges[host].markets[mktID];
        if (mkt.orders)
            orders = orders.concat(mkt.orders);
        if (mkt.inflight)
            orders = orders.concat(mkt.inflight);
        return orders;
    }
    /*
     * haveActiveOrders returns whether or not there are active orders involving a
     * certain asset.
     */
    haveActiveOrders(assetID) {
        for (const xc of Object.values(this.user.exchanges)) {
            if (!xc.markets)
                continue;
            for (const market of Object.values(xc.markets)) {
                if (!market.orders)
                    continue;
                for (const ord of market.orders) {
                    if ((ord.baseID === assetID || ord.quoteID === assetID) &&
                        (ord.status < _orderutil__WEBPACK_IMPORTED_MODULE_16__.StatusExecuted || (0,_orderutil__WEBPACK_IMPORTED_MODULE_16__.hasActiveMatches)(ord)))
                        return true;
                }
            }
        }
        return false;
    }
    /* order attempts to locate an order by order ID. */
    order(oid) {
        for (const xc of Object.values(this.user.exchanges)) {
            if (!xc || !xc.markets)
                continue;
            for (const market of Object.values(xc.markets)) {
                if (!market.orders)
                    continue;
                for (const ord of market.orders) {
                    if (ord.id === oid)
                        return ord;
                }
            }
        }
        return null;
    }
    /*
     * canAccelerateOrder returns true if the "from" wallet of the order
     * supports acceleration, and if the order has unconfirmed swap
     * transactions.
     */
    canAccelerateOrder(order) {
        var _a;
        const walletTraitAccelerator = 1 << 4;
        let fromAssetID;
        if (order.sell)
            fromAssetID = order.baseID;
        else
            fromAssetID = order.quoteID;
        const wallet = this.walletMap[fromAssetID];
        if (!wallet || !(wallet.traits & walletTraitAccelerator))
            return false;
        if (order.matches) {
            for (let i = 0; i < ((_a = order.matches) === null || _a === void 0 ? void 0 : _a.length); i++) {
                const match = order.matches[i];
                if (match.swap && match.swap.confs && match.swap.confs.count === 0 && !match.revoked) {
                    return true;
                }
            }
        }
        return false;
    }
    /*
     * unitInfo fetches unit info [dex.UnitInfo] for the asset. If xc
     * [core.Exchange] is provided, and this is not a SupportedAsset, the UnitInfo
     * sent from the exchange's assets map [dex.Asset] will be used.
     */
    unitInfo(assetID, xc) {
        const supportedAsset = this.assets[assetID];
        if (supportedAsset)
            return supportedAsset.unitInfo;
        if (!xc || !xc.assets) {
            throw Error(_locales__WEBPACK_IMPORTED_MODULE_20__.prep(_locales__WEBPACK_IMPORTED_MODULE_20__.ID_UNSUPPORTED_ASSET_INFO_ERR_MSG, { assetID: `${assetID}` }));
        }
        return xc.assets[assetID].unitInfo;
    }
    parentAsset(assetID) {
        const asset = this.assets[assetID];
        if (!asset.token)
            return asset;
        return this.assets[asset.token.parentID];
    }
    /*
    * baseChainSymbol returns the symbol for the asset's parent if the asset is a
    * token, otherwise the symbol for the asset itself.
    */
    baseChainSymbol(assetID) {
        const asset = this.user.assets[assetID];
        return asset.token ? this.user.assets[asset.token.parentID].symbol : asset.symbol;
    }
    /*
     * extensionWallet returns the ExtensionConfiguredWallet for the asset, if
     * it exists.
     */
    extensionWallet(assetID) {
        var _a;
        return (_a = this.user.extensionModeConfig) === null || _a === void 0 ? void 0 : _a.restrictedWallets[this.baseChainSymbol(assetID)];
    }
    /* conventionalRate converts the encoded atomic rate to a conventional rate */
    conventionalRate(baseID, quoteID, encRate, xc) {
        const [b, q] = [this.unitInfo(baseID, xc), this.unitInfo(quoteID, xc)];
        const r = b.conventional.conversionFactor / q.conventional.conversionFactor;
        return encRate * r / _orderutil__WEBPACK_IMPORTED_MODULE_16__.RateEncodingFactor;
    }
    walletDefinition(assetID, walletType) {
        const asset = this.assets[assetID];
        if (asset.token)
            return asset.token.definition;
        if (!asset.info)
            throw Error('where\'s the wallet info?');
        if (walletType === '')
            return asset.info.availablewallets[asset.info.emptyidx];
        return asset.info.availablewallets.filter(def => def.type === walletType)[0];
    }
    currentWalletDefinition(assetID) {
        const asset = this.assets[assetID];
        if (asset.token) {
            return asset.token.definition;
        }
        return this.walletDefinition(assetID, this.assets[assetID].wallet.type);
    }
    /*
     * fetchBalance requests a balance update from the API. The API response does
     * include the balance, but we're ignoring it, since a balance update
     * notification is received via the Application anyways.
     */
    fetchBalance(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/balance', { assetID: assetID });
            if (!this.checkResponse(res)) {
                throw new Error(`failed to fetch balance for asset ID ${assetID}`);
            }
            return res.balance;
        });
    }
    /*
     * checkResponse checks the response object as returned from the functions in
     * the http module. If the response indicates that the request failed, it
     * returns false, otherwise, true.
     */
    checkResponse(resp) {
        return (resp.requestSuccessful && resp.ok);
    }
    /**
     * signOut call to /api/logout, if response with no errors occurred remove auth
     * and other privacy-critical cookies/locals and reload the page, otherwise
     * show a notification.
     */
    signOut() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/logout');
            if (!this.checkResponse(res)) {
                if (res.code === _http__WEBPACK_IMPORTED_MODULE_17__.Errors.activeOrdersErr) {
                    this.page.logoutErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_20__.prep(_locales__WEBPACK_IMPORTED_MODULE_20__.ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG);
                }
                else {
                    this.page.logoutErr.textContent = res.msg;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.logoutErr);
                return;
            }
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].removeCookie(_state__WEBPACK_IMPORTED_MODULE_1__["default"].authCK);
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].removeCookie(_state__WEBPACK_IMPORTED_MODULE_1__["default"].pwKeyCK);
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].removeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].notificationsLK); // Notification storage was DEPRECATED pre-v1.
            window.location.href = '/login';
        });
    }
    /*
     * txHistory loads the tx history for an asset. If the results are not
     * already cached, they are cached. If we have reached the oldest tx,
     * this fact is also cached. If the exact amount of transactions as have been
     * made are requested, we will not know if we have reached the last tx until
     * a subsequent call.
    */
    txHistory(assetID, n, after) {
        return __awaiter(this, void 0, void 0, function* () {
            const url = '/api/txhistory';
            const cachedTxHistory = this.txHistoryMap[assetID];
            if (!cachedTxHistory) {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)(url, {
                    n: n,
                    assetID: assetID
                });
                if (!this.checkResponse(res)) {
                    throw new Error(res.msg);
                }
                let txs = res.txs;
                if (!txs) {
                    txs = [];
                }
                this.txHistoryMap[assetID] = {
                    txs: txs,
                    lastTx: txs.length < n
                };
                return this.txHistoryMap[assetID];
            }
            const txs = [];
            let lastTx = false;
            const startIndex = after ? cachedTxHistory.txs.findIndex(tx => tx.id === after) + 1 : 0;
            if (after && startIndex === -1) {
                throw new Error('invalid after tx ' + after);
            }
            let lastIndex = startIndex;
            for (let i = startIndex; i < cachedTxHistory.txs.length && txs.length < n; i++) {
                txs.push(cachedTxHistory.txs[i]);
                lastIndex = i;
                after = cachedTxHistory.txs[i].id;
            }
            if (cachedTxHistory.lastTx && lastIndex === cachedTxHistory.txs.length - 1) {
                lastTx = true;
            }
            if (txs.length < n && !cachedTxHistory.lastTx) {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)(url, {
                    n: n - txs.length + 1,
                    assetID: assetID,
                    refID: after,
                    past: true
                });
                if (!this.checkResponse(res)) {
                    throw new Error(res.msg);
                }
                let resTxs = res.txs;
                if (!resTxs) {
                    resTxs = [];
                }
                if (resTxs.length > 0 && after) {
                    if (resTxs[0].id === after) {
                        resTxs.shift();
                    }
                    else {
                        // Implies a bug in the client
                        console.error('First tx history element != refID');
                    }
                }
                cachedTxHistory.lastTx = resTxs.length < n - txs.length;
                lastTx = cachedTxHistory.lastTx;
                txs.push(...resTxs);
                cachedTxHistory.txs.push(...resTxs);
            }
            return { txs, lastTx };
        });
    }
    getWalletTx(assetID, txID) {
        const cachedTxHistory = this.txHistoryMap[assetID];
        if (!cachedTxHistory)
            return undefined;
        return cachedTxHistory.txs.find(tx => tx.id === txID);
    }
    clearTxHistory(assetID) {
        delete this.txHistoryMap[assetID];
    }
    needsCustomProvider(assetID) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            const baseChainID = (_c = (_b = (_a = this.assets[assetID]) === null || _a === void 0 ? void 0 : _a.token) === null || _b === void 0 ? void 0 : _b.parentID) !== null && _c !== void 0 ? _c : assetID;
            if (!baseChainID)
                return false;
            const w = this.walletMap[baseChainID];
            if (!w)
                return false;
            const traitAccountLocker = 1 << 14;
            if ((w.traits & traitAccountLocker) === 0)
                return false;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/walletsettings', { assetID: baseChainID });
            if (!this.checkResponse(res)) {
                console.error(res.msg);
                return false;
            }
            const settings = res.map;
            return !settings.providers;
        });
    }
}
/* getSocketURI returns the websocket URI for the client. */
function getSocketURI() {
    const protocol = (window.location.protocol === 'https:') ? 'wss' : 'ws';
    return `${protocol}://${window.location.host}/ws`;
}
/*
 * severityClassMap maps a notification severity level to a CSS class that
 * assigns a background color.
 */
const severityClassMap = {
    [_notifications__WEBPACK_IMPORTED_MODULE_18__.SUCCESS]: 'good',
    [_notifications__WEBPACK_IMPORTED_MODULE_18__.ERROR]: 'bad',
    [_notifications__WEBPACK_IMPORTED_MODULE_18__.WARNING]: 'warn'
};
/* handlerFromPath parses the handler name from the path. */
function handlerFromPath(path) {
    return path.replace(/^\//, '').split('/')[0].split('?')[0].split('#')[0];
}
/* nowString creates a string formatted like HH:MM:SS.xxx */
function nowString() {
    const stamp = new Date();
    const h = stamp.getHours().toString().padStart(2, '0');
    const m = stamp.getMinutes().toString().padStart(2, '0');
    const s = stamp.getSeconds().toString().padStart(2, '0');
    const ms = stamp.getMilliseconds().toString().padStart(3, '0');
    return `${h}:${m}:${s}.${ms}`;
}
function setSeverityClass(el, severity) {
    el.classList.remove('bad', 'warn', 'good');
    el.classList.add(severityClassMap[severity]);
}
/* updateMatch updates the match in or adds the match to the order. */
function updateMatch(order, match) {
    for (const i in order.matches) {
        const m = order.matches[i];
        if (m.matchID === match.matchID) {
            order.matches[i] = match;
            return;
        }
    }
    order.matches = order.matches || [];
    order.matches.push(match);
}


/***/ }),

/***/ "./src/js/basepage.ts":
/*!****************************!*\
  !*** ./src/js/basepage.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ BasePage)
/* harmony export */ });
class BasePage {
    /* unload is called when the user navigates away from the page. */
    unload() {
        // should be implemented by inheriting class.
    }
}


/***/ }),

/***/ "./src/js/charts.ts":
/*!**************************!*\
  !*** ./src/js/charts.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CandleChart": () => (/* binding */ CandleChart),
/* harmony export */   "Chart": () => (/* binding */ Chart),
/* harmony export */   "DepthChart": () => (/* binding */ DepthChart),
/* harmony export */   "Extents": () => (/* binding */ Extents),
/* harmony export */   "Region": () => (/* binding */ Region),
/* harmony export */   "Wave": () => (/* binding */ Wave)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");




const bind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind;
const PIPI = 2 * Math.PI;
const plusChar = String.fromCharCode(59914);
const minusChar = String.fromCharCode(59915);
const darkTheme = {
    body: '#0b2031',
    axisLabel: '#b1b1b1',
    gridBorder: '#383f4b',
    gridLines: '#383f4b',
    gapLine: '#6b6b6b',
    value: '#9a9a9a',
    zoom: '#5b5b5b',
    zoomHover: '#aaa',
    sellLine: '#ae3333',
    buyLine: '#05a35a',
    sellFill: '#591a1a',
    buyFill: '#02572f',
    crosshairs: '#888',
    legendFill: 'black',
    legendText: '#d5d5d5'
};
const lightTheme = {
    body: '#f4f4f4',
    axisLabel: '#1b1b1b',
    gridBorder: '#ddd',
    gridLines: '#ddd',
    gapLine: '#595959',
    value: '#4d4d4d',
    zoom: '#777',
    zoomHover: '#333',
    sellLine: '#99302b',
    buyLine: '#207a46',
    sellFill: '#bd5959',
    buyFill: '#4cad75',
    crosshairs: '#595959',
    legendFill: '#e6e6e6',
    legendText: '#1b1b1b'
};
// Chart is the base class for charts.
class Chart {
    constructor(parent, reporters) {
        this.parent = parent;
        this.report = reporters;
        this.theme = _state__WEBPACK_IMPORTED_MODULE_2__["default"].isDark() ? darkTheme : lightTheme;
        this.canvas = document.createElement('canvas');
        this.visible = true;
        parent.appendChild(this.canvas);
        const ctx = this.canvas.getContext('2d');
        if (!ctx) {
            console.error('error getting canvas context');
            return;
        }
        this.ctx = ctx;
        this.ctx.textAlign = 'center';
        this.ctx.textBaseline = 'middle';
        // Mouse handling
        this.mousePos = null;
        bind(this.canvas, 'mousemove', (e) => {
            // this.rect will be set in resize().
            if (!this.rect)
                return;
            this.mousePos = {
                x: e.clientX - this.rect.left,
                y: e.clientY - this.rect.y
            };
            this.draw();
        });
        bind(this.canvas, 'mouseleave', () => {
            this.mousePos = null;
            this.draw();
        });
        // Bind resize.
        const resizeObserver = new ResizeObserver(() => this.resize());
        resizeObserver.observe(this.parent);
        // Scrolling by wheel is smoother when the rate is slightly limited.
        this.wheelLimiter = null;
        bind(this.canvas, 'wheel', (e) => { this.wheel(e); }, { passive: true });
        bind(this.canvas, 'click', (e) => { this.click(e); });
        const setVis = () => {
            this.visible = document.visibilityState !== 'hidden';
            if (this.visible && this.renderScheduled) {
                this.renderScheduled = false;
                this.draw();
            }
        };
        bind(document, 'visibilitychange', setVis);
        this.unattachers = [() => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'visibilitychange', setVis); }];
    }
    wheeled() {
        this.wheelLimiter = window.setTimeout(() => { this.wheelLimiter = null; }, 100);
    }
    /* clear the canvas. */
    clear() {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
    /* draw calls the child class's render method. */
    draw() {
        this.render();
    }
    /* click is the handler for a click event on the canvas. */
    click(e) {
        this.report.click(e);
    }
    /* wheel is a mousewheel event handler. */
    wheel(e) {
        this.zoom(e.deltaY < 0);
    }
    /*
     * resize updates the chart size. The parentHeight is an argument to support
     * updating the height programmatically after the caller sets a style.height
     * but before the clientHeight has been updated.
     */
    resize() {
        this.canvas.width = this.parent.clientWidth;
        this.canvas.height = this.parent.clientHeight;
        const xLblHeight = 30;
        const yGuess = 40; // y label width guess. Will be adjusted when drawn.
        const plotExtents = new Extents(0, this.canvas.width, 0, this.canvas.height - xLblHeight);
        const xLblExtents = new Extents(0, this.canvas.width, this.canvas.height - xLblHeight, this.canvas.height);
        const yLblExtents = new Extents(0, yGuess, 0, this.canvas.height - xLblHeight);
        this.plotRegion = new Region(this.ctx, plotExtents);
        this.xRegion = new Region(this.ctx, xLblExtents);
        this.yRegion = new Region(this.ctx, yLblExtents);
        // After changing the visibility, this.canvas.getBoundingClientRect will
        // return nonsense until a render.
        window.requestAnimationFrame(() => {
            this.rect = this.canvas.getBoundingClientRect();
            this.report.resize();
        });
    }
    /* zoom is called when the user scrolls the mouse wheel on the canvas. */
    zoom(bigger) {
        if (this.wheelLimiter)
            return;
        this.report.zoom(bigger);
    }
    /* The market handler will call unattach when the markets page is unloaded. */
    unattach() {
        for (const u of this.unattachers)
            u();
        this.unattachers = [];
    }
    /* render must be implemented by the child class. */
    render() {
        console.error('child class must override render method');
    }
    /* applyLabelStyle applies the style used for axis tick labels. */
    applyLabelStyle(fontSize) {
        this.ctx.textAlign = 'center';
        this.ctx.textBaseline = 'middle';
        this.ctx.font = `${fontSize !== null && fontSize !== void 0 ? fontSize : '14'}px 'sans', sans-serif`;
        this.ctx.fillStyle = this.theme.axisLabel;
    }
    /* plotXLabels applies the provided labels to the x axis and draws the grid. */
    plotXLabels(labels, minX, maxX, unitLines) {
        const extents = new Extents(minX, maxX, 0, 1);
        this.xRegion.plot(extents, (ctx, tools) => {
            this.applyLabelStyle();
            const centerX = (maxX + minX) / 2;
            let lastX = minX;
            let unitCenter = centerX;
            const [leftEdge, rightEdge] = [tools.x(minX), tools.x(maxX)];
            const centerY = tools.y(0.5);
            labels.lbls.forEach(lbl => {
                const m = ctx.measureText(lbl.txt);
                const x = tools.x(lbl.val);
                if (x - m.width / 2 < leftEdge || x + m.width / 2 > rightEdge)
                    return;
                ctx.fillText(lbl.txt, x, centerY);
                if (centerX >= lastX && centerX < lbl.val) {
                    unitCenter = (lastX + lbl.val) / 2;
                }
                lastX = lbl.val;
            });
            ctx.font = '11px \'sans\', sans-serif';
            if (unitLines.length === 2) {
                ctx.fillText(unitLines[0], tools.x(unitCenter), tools.y(0.63));
                ctx.fillText(unitLines[1], tools.x(unitCenter), tools.y(0.23));
            }
            else if (unitLines.length === 1) {
                ctx.fillText(unitLines[0], tools.x(unitCenter), centerY);
            }
        }, true);
    }
    plotXGrid(labels, minX, maxX) {
        const extents = new Extents(minX, maxX, 0, 1);
        this.plotRegion.plot(extents, (ctx, tools) => {
            ctx.lineWidth = 1;
            ctx.strokeStyle = this.theme.gridLines;
            labels.lbls.forEach(lbl => {
                line(ctx, tools.x(lbl.val), tools.y(0), tools.x(lbl.val), tools.y(1));
            });
        }, true);
    }
    /*
     * plotYLabels applies the y labels based on the provided plot region, and
     * draws the grid.
     */
    plotYLabels(labels, minY, maxY, unit) {
        const extents = new Extents(0, 1, minY, maxY);
        const fillRect = (ctx, x, y, w, h, r) => {
            ctx.save();
            ctx.fillStyle = this.theme.body;
            ctx.beginPath();
            if (ctx.roundRect)
                ctx.roundRect(x, y, w, h, r); // Safari < 16 doesn't support
            else
                ctx.rect(x, y, w, h);
            ctx.fill();
            ctx.restore();
        };
        this.yRegion.plot(extents, (ctx, tools) => {
            this.applyLabelStyle();
            this.ctx.textAlign = 'left';
            const centerY = maxY / 2;
            let lastY = 0;
            let unitCenter = centerY;
            const x = tools.x(0);
            const [xPad, yPad] = [3, 3];
            labels.lbls.forEach(lbl => {
                const y = tools.y(lbl.val);
                if (y < tools.y(maxY) + yPad + 7 || y > tools.y(minY) - yPad - 7)
                    return;
                const m = ctx.measureText(lbl.txt);
                fillRect(ctx, x, y - 7 - yPad, m.width + xPad * 2, 14 + yPad * 3, 3);
                ctx.fillText(lbl.txt, x + xPad, y + 2);
                if (centerY >= lastY && centerY < lbl.val) {
                    unitCenter = (lastY + lbl.val) / 2;
                }
                lastY = lbl.val;
            });
            const m = ctx.measureText(unit);
            const y = tools.y(unitCenter);
            fillRect(ctx, x, y - yPad - 7, m.width + xPad * 2, 14 + yPad * 2, 3);
            ctx.fillText(unit, x + xPad, tools.y(unitCenter));
        }, true);
    }
    plotYGrid(region, labels, minY, maxY) {
        const extents = new Extents(0, 1, minY, maxY);
        region.plot(extents, (ctx, tools) => {
            ctx.lineWidth = 1;
            ctx.strokeStyle = this.theme.gridLines;
            labels.lbls.forEach(lbl => {
                line(ctx, tools.x(0), tools.y(lbl.val), tools.x(1), tools.y(lbl.val));
            });
        }, true);
    }
    /*
     * doYLabels generates and applies the y-axis labels, based upon the
     * provided plot region.
     */
    makeYLabels(region, step, unit, valFmt) {
        this.applyLabelStyle();
        const yLabels = makeLabels(this.ctx, region.height(), this.dataExtents.y.min, this.dataExtents.y.max, 50, step, unit, valFmt);
        // Reassign the width of the y-label column to accommodate the widest text.
        const yAxisWidth = (yLabels.widest || 0) + 20; /* x padding */
        this.yRegion.extents.x.max = yAxisWidth;
        this.yRegion.extents.y.max = region.extents.y.max;
        return yLabels;
    }
    line(x0, y0, x1, y1, skipStroke) {
        line(this.ctx, x0, y0, x1, y1, skipStroke);
    }
    /* dot draws a circle with the provided context. */
    dot(x, y, color, radius) {
        dot(this.ctx, x, y, color, radius);
    }
}
/* DepthChart is a javascript Canvas-based depth chart renderer. */
class DepthChart extends Chart {
    constructor(parent, reporters, zoom) {
        super(parent, {
            resize: () => this.resized(),
            click: (e) => this.clicked(e),
            zoom: (bigger) => this.zoomed(bigger)
        });
        this.reporters = reporters;
        this.zoomLevel = zoom;
        this.lines = [];
        this.markers = {
            buys: [],
            sells: []
        };
        this.setZoomBttns(); // can't wait for requestAnimationFrame -> resized
        this.resize();
    }
    // setZoomBttns creates new regions for zoom in and zoom out buttons. It is
    // used in initiation of the buttons and resizing.
    setZoomBttns() {
        this.zoomInBttn = new Region(this.ctx, new Extents(0, 0, 0, 0));
        this.zoomOutBttn = new Region(this.ctx, new Extents(0, 0, 0, 0));
    }
    /* resized is called when the window or parent element are resized. */
    resized() {
        // The button region extents are set during drawing.
        this.setZoomBttns();
        if (this.book)
            this.draw();
    }
    /* zoomed zooms the current view in or out. bigger=true is zoom in. */
    zoomed(bigger) {
        if (!this.zoomLevel)
            return;
        if (!this.book.buys || !this.book.sells)
            return;
        this.wheeled();
        // Zoom in to 66%, but out to 150% = 1 / (2/3) so that the same zoom levels
        // are hit when reversing direction.
        this.zoomLevel *= bigger ? 2 / 3 : 3 / 2;
        this.zoomLevel = (0,_doc__WEBPACK_IMPORTED_MODULE_0__.clamp)(this.zoomLevel, 0.005, 2);
        this.draw();
        this.reporters.zoom(this.zoomLevel);
    }
    /* clicked is the canvas 'click' event handler. */
    clicked(e) {
        if (!this.dataExtents)
            return;
        const x = e.clientX - this.rect.left;
        const y = e.clientY - this.rect.y;
        if (this.zoomInBttn.contains(x, y)) {
            this.zoom(true);
            return;
        }
        if (this.zoomOutBttn.contains(x, y)) {
            this.zoom(false);
            return;
        }
        const translator = this.plotRegion.translator(this.dataExtents);
        this.reporters.click(translator.unx(x));
    }
    // set sets the current data set and draws.
    set(book, lotSize, rateStepEnc, baseUnitInfo, quoteUnitInfo) {
        this.book = book;
        this.lotSize = lotSize / baseUnitInfo.conventional.conversionFactor;
        this.conventionalRateStep = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].conventionalRateStep(rateStepEnc, baseUnitInfo, quoteUnitInfo);
        this.baseUnit = baseUnitInfo.conventional.unit;
        this.quoteUnit = quoteUnitInfo.conventional.unit;
        if (!this.zoomLevel) {
            const [midGap, gapWidth] = this.gap();
            // Default to 5% zoom, but with a minimum of 5 * midGap, but still observing
            // the hard cap of 200%.
            const minZoom = Math.max(gapWidth / midGap * 5, 0.05);
            this.zoomLevel = Math.min(minZoom, 2);
        }
        this.draw();
    }
    /*
     * render draws the chart.
     * 1. Calculate the data extents and translate the order book data to a
     *    cumulative form.
     * 2. Draw axis ticks and grid, mid-gap line and value, zoom buttons, mouse
     *    position indicator...
     * 4. Tick labels.
     * 5. Data.
     * 6. Epoch line legend.
     * 7. Hover legend.
     */
    render() {
        // if connection fails it is not possible to get book.
        if (!this.book || !this.visible || this.canvas.width === 0) {
            this.renderScheduled = true;
            return;
        }
        this.clear();
        // if (!this.book || this.book.empty()) return
        const ctx = this.ctx;
        const mousePos = this.mousePos;
        const buys = this.book.buys;
        const sells = this.book.sells;
        const [midGap, gapWidth] = this.gap();
        const halfWindow = this.zoomLevel * midGap / 2;
        const high = midGap + halfWindow;
        const low = midGap - halfWindow;
        // Get a sorted copy of the markers list.
        const buyMarkers = [...this.markers.buys];
        const sellMarkers = [...this.markers.sells];
        buyMarkers.sort((a, b) => b.rate - a.rate);
        sellMarkers.sort((a, b) => a.rate - b.rate);
        const markers = [];
        const buyDepth = [];
        const buyEpoch = [];
        const sellDepth = [];
        const sellEpoch = [];
        const volumeReport = {
            buyBase: 0,
            buyQuote: 0,
            sellBase: 0,
            sellQuote: 0
        };
        let sum = 0;
        // The epoch line is above the non-epoch region, so the epochSum y value
        // must account for non-epoch orders too.
        let epochSum = 0;
        for (let i = 0; i < buys.length; i++) {
            const ord = buys[i];
            epochSum += ord.qty;
            if (ord.rate >= low)
                buyEpoch.push([ord.rate, epochSum]);
            if (ord.epoch)
                continue;
            sum += ord.qty;
            buyDepth.push([ord.rate, sum]);
            volumeReport.buyBase += ord.qty;
            volumeReport.buyQuote += ord.qty * ord.rate;
            while (buyMarkers.length && floatCompare(buyMarkers[0].rate, ord.rate)) {
                const mark = buyMarkers.shift();
                if (!mark)
                    continue;
                markers.push({
                    rate: mark.rate,
                    qty: ord.epoch ? epochSum : sum,
                    sell: ord.sell,
                    active: mark.active
                });
            }
        }
        const buySum = buyDepth.length ? last(buyDepth)[1] : 0;
        buyDepth.push([low, buySum]);
        const epochBuySum = buyEpoch.length ? last(buyEpoch)[1] : 0;
        buyEpoch.push([low, epochBuySum]);
        epochSum = sum = 0;
        for (let i = 0; i < sells.length; i++) {
            const ord = sells[i];
            epochSum += ord.qty;
            if (ord.rate <= high)
                sellEpoch.push([ord.rate, epochSum]);
            if (ord.epoch)
                continue;
            sum += ord.qty;
            sellDepth.push([ord.rate, sum]);
            volumeReport.sellBase += ord.qty;
            volumeReport.sellQuote += ord.qty * ord.rate;
            while (sellMarkers.length && floatCompare(sellMarkers[0].rate, ord.rate)) {
                const mark = sellMarkers.shift();
                if (!mark)
                    continue;
                markers.push({
                    rate: mark.rate,
                    qty: ord.epoch ? epochSum : sum,
                    sell: ord.sell,
                    active: mark.active
                });
            }
        }
        // Add a data point going to the left so that the data doesn't end with a
        // vertical line.
        const sellSum = sellDepth.length ? last(sellDepth)[1] : 0;
        sellDepth.push([high, sellSum]);
        const epochSellSum = sellEpoch.length ? last(sellEpoch)[1] : 0;
        sellEpoch.push([high, epochSellSum]);
        // Add ~30px padding to the top of the chart.
        const h = this.xRegion.extents.y.min;
        const growthFactor = (h + 40) / h;
        const maxY = (epochSellSum && epochBuySum ? Math.max(epochBuySum, epochSellSum) : epochSellSum || epochBuySum || 1) * growthFactor;
        const dataExtents = new Extents(low, high, 0, maxY);
        this.dataExtents = dataExtents;
        // A function to be run at the end if there is legend data to display.
        let mouseData = null;
        // Draw the grid.
        const xLabels = makeLabels(ctx, this.plotRegion.width(), dataExtents.x.min, dataExtents.x.max, 100, this.conventionalRateStep, '');
        this.plotXGrid(xLabels, low, high);
        const yLabels = this.makeYLabels(this.plotRegion, this.lotSize, this.baseUnit);
        this.plotYGrid(this.plotRegion, yLabels, this.dataExtents.y.min, this.dataExtents.y.max);
        this.plotRegion.plot(dataExtents, (ctx, tools) => {
            ctx.lineWidth = 1;
            // first, a square around the plot area.
            ctx.strokeStyle = this.theme.gridBorder;
            // draw a line to indicate mid-gap
            ctx.lineWidth = 2.5;
            ctx.strokeStyle = this.theme.gapLine;
            line(ctx, tools.x(midGap), tools.y(0), tools.x(midGap), tools.y(0.3 * dataExtents.y.max));
            ctx.font = '30px \'demi-sans\', sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = this.theme.value;
            const y = 0.5 * dataExtents.y.max;
            ctx.fillText(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(midGap), tools.x(midGap), tools.y(y));
            ctx.font = '12px \'sans\', sans-serif';
            // ctx.fillText('mid-market price', tools.x(midGap), tools.y(y) + 24)
            ctx.fillText(`${(gapWidth / midGap * 100).toFixed(2)}% spread`, tools.x(midGap), tools.y(y) + 24);
            // Draw zoom buttons.
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            const topCenterX = this.plotRegion.extents.midX;
            const topCenterY = tools.y(maxY * 0.9);
            const zoomPct = dataExtents.xRange / midGap * 100;
            const zoomText = `${zoomPct.toFixed(1)}%`;
            const w = ctx.measureText(zoomText).width;
            ctx.font = '13px \'sans\', sans-serif';
            ctx.fillText(zoomText, topCenterX, topCenterY + 1);
            // define the region for the zoom button
            const bttnSize = 20;
            const xPad = 10;
            let bttnLeft = topCenterX - w / 2 - xPad - bttnSize;
            const bttnTop = topCenterY - bttnSize / 2;
            this.zoomOutBttn.setExtents(bttnLeft, bttnLeft + bttnSize, bttnTop, bttnTop + bttnSize);
            let hover = mousePos && this.zoomOutBttn.contains(mousePos.x, mousePos.y);
            this.zoomOutBttn.plot(new Extents(0, 1, 0, 1), ctx => {
                ctx.font = '12px \'icomoon\'';
                ctx.fillStyle = this.theme.zoom;
                if (hover) {
                    ctx.fillStyle = this.theme.zoomHover;
                    ctx.font = '13px \'icomoon\'';
                }
                ctx.fillText(minusChar, this.zoomOutBttn.extents.midX, this.zoomOutBttn.extents.midY);
            });
            bttnLeft = topCenterX + w / 2 + xPad;
            this.zoomInBttn.setExtents(bttnLeft, bttnLeft + bttnSize, bttnTop, bttnTop + bttnSize);
            hover = mousePos && this.zoomInBttn.contains(mousePos.x, mousePos.y);
            this.zoomInBttn.plot(new Extents(0, 1, 0, 1), ctx => {
                ctx.font = '12px \'icomoon\'';
                ctx.fillStyle = this.theme.zoom;
                if (hover) {
                    ctx.fillStyle = this.theme.zoomHover;
                    ctx.font = '14px \'icomoon\'';
                }
                ctx.fillText(plusChar, this.zoomInBttn.extents.midX, this.zoomInBttn.extents.midY);
            });
            // Draw a dotted vertical line where the mouse is, and a dot at the level
            // of the depth line.
            const drawLine = (x, color) => {
                if (x > high || x < low)
                    return;
                ctx.save();
                ctx.setLineDash([3, 5]);
                ctx.lineWidth = 1.5;
                ctx.strokeStyle = color;
                line(ctx, tools.x(x), tools.y(0), tools.x(x), tools.y(maxY));
                ctx.restore();
            };
            // for (const line of this.lines || []) {
            //   drawLine(line.rate, line.color)
            // }
            const tolerance = (high - low) * 0.005;
            const hoverMarkers = [];
            for (const marker of markers || []) {
                const hovered = (mousePos && withinTolerance(marker.rate, tools.unx(mousePos.x), tolerance));
                if (hovered)
                    hoverMarkers.push(marker.rate);
                ctx.save();
                ctx.lineWidth = (hovered || marker.active) ? 5 : 3;
                ctx.strokeStyle = marker.sell ? this.theme.sellLine : this.theme.buyLine;
                ctx.fillStyle = marker.sell ? this.theme.sellFill : this.theme.buyFill;
                const size = (hovered || marker.active) ? 10 : 8;
                ctx.beginPath();
                const tip = {
                    x: tools.x(marker.rate),
                    y: tools.y(marker.qty) - 8
                };
                const top = tip.y - (Math.sqrt(3) * size / 2); // cos(30)
                ctx.moveTo(tip.x, tip.y);
                ctx.lineTo(tip.x - size / 2, top);
                ctx.lineTo(tip.x + size / 2, top);
                ctx.closePath();
                ctx.stroke();
                ctx.fill();
                ctx.restore();
            }
            // If the mouse is in the chart area, draw the crosshairs.
            if (!mousePos)
                return;
            if (!this.plotRegion.contains(mousePos.x, mousePos.y))
                return;
            // The mouse is in the plot region. Get the data coordinates and find the
            // side and depth for the x value.
            const dataX = tools.unx(mousePos.x);
            let evalSide = sellDepth;
            let trigger = (ptX) => ptX >= dataX;
            let dotColor = this.theme.sellLine;
            if (dataX < midGap) {
                evalSide = buyDepth;
                trigger = (ptX) => ptX <= dataX;
                dotColor = this.theme.buyLine;
            }
            let bestDepth = evalSide[0];
            for (let i = 0; i < evalSide.length; i++) {
                const pt = evalSide[i];
                if (trigger(pt[0]))
                    break;
                bestDepth = pt;
            }
            drawLine(dataX, this.theme.crosshairs);
            mouseData = {
                rate: dataX,
                depth: bestDepth[1],
                dotColor: dotColor,
                hoverMarkers: hoverMarkers
            };
        });
        // Draw the epoch lines
        ctx.lineWidth = 1.5;
        ctx.setLineDash([3, 3]);
        // epoch sells
        ctx.fillStyle = this.theme.sellFill;
        ctx.strokeStyle = this.theme.sellLine;
        this.drawDepth(sellEpoch);
        // epoch buys
        ctx.fillStyle = this.theme.buyFill;
        ctx.strokeStyle = this.theme.buyLine;
        this.drawDepth(buyEpoch);
        // Draw the book depth.
        ctx.lineWidth = 2.5;
        ctx.setLineDash([]);
        // book sells
        ctx.fillStyle = this.theme.sellFill;
        ctx.strokeStyle = this.theme.sellLine;
        this.drawDepth(sellDepth);
        // book buys
        ctx.fillStyle = this.theme.buyFill;
        ctx.strokeStyle = this.theme.buyLine;
        this.drawDepth(buyDepth);
        this.plotYLabels(yLabels, this.dataExtents.y.min, this.dataExtents.y.max, this.baseUnit);
        this.plotXLabels(xLabels, low, high, [`${this.quoteUnit}/`, this.baseUnit]);
        // Display the dot at the intersection of the mouse hover line and the depth
        // line. This should be drawn after the depths.
        if (mouseData) {
            this.plotRegion.plot(dataExtents, (ctx, tools) => {
                if (!mouseData)
                    return; // For TypeScript. Duh.
                dot(ctx, tools.x(mouseData.rate), tools.y(mouseData.depth), mouseData.dotColor, 5);
            });
        }
        // Report the book volumes.
        this.reporters.volume(volumeReport);
        this.reporters.mouse(mouseData);
    }
    /* drawDepth draws a single side's depth chart data. */
    drawDepth(depth) {
        const firstPt = depth[0];
        let x;
        this.plotRegion.plot(this.dataExtents, (ctx, tools) => {
            const yZero = tools.y(0);
            let y = tools.y(firstPt[1]);
            ctx.beginPath();
            ctx.moveTo(tools.x(firstPt[0]), tools.y(firstPt[1]));
            for (let i = 0; i < depth.length; i++) {
                // Set x, but don't set y until we draw the horizontal line.
                x = tools.x(depth[i][0]);
                ctx.lineTo(x, y);
                // If this is past the render edge, quit drawing.
                y = tools.y(depth[i][1]);
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            ctx.lineTo(x, yZero);
            ctx.lineTo(tools.x(firstPt[0]), yZero);
            ctx.closePath();
            ctx.globalAlpha = 0.25;
            ctx.fill();
        });
    }
    /* returns the mid-gap rate and gap width as a tuple. */
    gap() {
        const [b, s] = [this.book.bestGapBuy(), this.book.bestGapSell()];
        if (!b) {
            if (!s)
                return [1, 0];
            return [s.rate, 0];
        }
        else if (!s)
            return [b.rate, 0];
        return [(s.rate + b.rate) / 2, s.rate - b.rate];
    }
    /* setLines stores the indicator lines to draw. */
    setLines(lines) {
        this.lines = lines;
    }
    /* setMarkers sets the indicator markers to draw. */
    setMarkers(markers) {
        this.markers = markers;
    }
}
/* CandleChart is a candlestick data renderer. */
class CandleChart extends Chart {
    constructor(parent, reporters) {
        super(parent, {
            resize: () => this.resized(),
            click: ( /* e: MouseEvent */) => { this.clicked(); },
            zoom: (bigger) => this.zoomed(bigger)
        });
        this.reporters = reporters;
        this.zoomLevel = 1;
        this.numToShow = 100;
        this.resize();
    }
    /* resized is called when the window or parent element are resized. */
    resized() {
        const ext = this.plotRegion.extents;
        const candleExtents = new Extents(ext.x.min, ext.x.max, ext.y.min, ext.y.min + ext.yRange * 0.85);
        this.candleRegion = new Region(this.ctx, candleExtents);
        const volumeExtents = new Extents(ext.x.min, ext.x.max, ext.y.min + 0.85 * ext.yRange, ext.y.max);
        this.volumeRegion = new Region(this.ctx, volumeExtents);
        // Set a delay on the render to prevent lag.
        if (this.resizeTimer)
            clearTimeout(this.resizeTimer);
        this.resizeTimer = window.setTimeout(() => this.draw(), 100);
    }
    clicked( /* e: MouseEvent */) {
        // handle clicks
    }
    /* zoomed zooms the current view in or out. bigger=true is zoom in. */
    zoomed(bigger) {
        // bigger actually means fewer candles -> reduce zoomLevels index.
        const idx = this.zoomLevels.indexOf(this.numToShow);
        if (bigger) {
            if (idx === 0)
                return;
            this.numToShow = this.zoomLevels[idx - 1];
        }
        else {
            if (this.zoomLevels.length <= idx + 1 || this.numToShow > this.data.candles.length)
                return;
            this.numToShow = this.zoomLevels[idx + 1];
        }
        this.draw();
    }
    /* render draws the chart */
    render() {
        var _a;
        const data = this.data;
        if (!data || !this.visible || this.canvas.width === 0) {
            this.renderScheduled = true;
            return;
        }
        const candleWidth = data.ms;
        const mousePos = this.mousePos;
        const allCandles = data.candles || [];
        const n = Math.min(this.numToShow, allCandles.length);
        const candles = allCandles.slice(allCandles.length - n);
        this.clear();
        // If there are no candles. just don't draw anything.
        if (n === 0)
            return;
        // padding definition and some helper functions to parse candles.
        const candleWidthPadding = 0.2;
        const start = (c) => truncate(c.endStamp, candleWidth);
        const end = (c) => start(c) + candleWidth;
        const paddedStart = (c) => start(c) + candleWidthPadding * candleWidth;
        const paddedWidth = (1 - 2 * candleWidthPadding) * candleWidth;
        const first = candles[0];
        const last = candles[n - 1];
        let [high, low, highVol] = [first.highRate, first.lowRate, first.matchVolume];
        for (const c of candles) {
            if (c.highRate > high)
                high = c.highRate;
            if (c.lowRate < low)
                low = c.lowRate;
            if (c.matchVolume > highVol)
                highVol = c.matchVolume;
        }
        high += (high - low) * 0.1; // a little padding
        const xStart = start(first);
        let xEnd = end(last);
        xEnd += (xEnd - xStart) * 0.05; // a little padding
        // Calculate data extents and store them. They are used to apply labels.
        const rateStep = this.market.ratestep;
        const dataExtents = new Extents(xStart, xEnd, low, high);
        if (low === high) {
            // If there is no price movement at all in the window, show a little more
            // top and bottom so things render nicely.
            dataExtents.y.min -= rateStep;
            dataExtents.y.max += rateStep;
        }
        this.dataExtents = dataExtents;
        let mouseCandle = null;
        if (mousePos) {
            this.plotRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, 0, 1), (ctx, tools) => {
                const selectedStartStamp = truncate(tools.unx(mousePos.x), candleWidth);
                for (const c of candles) {
                    if (start(c) === selectedStartStamp) {
                        mouseCandle = c;
                        ctx.fillStyle = this.theme.gridLines;
                        ctx.fillRect(tools.x(start(c)), tools.y(0), tools.w(candleWidth), tools.h(1));
                        break;
                    }
                }
            });
        }
        // Draw the grid
        const rFactor = this.rateConversionFactor;
        const baseUnit = ((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_3__.app)().assets[this.market.baseid]) === null || _a === void 0 ? void 0 : _a.unitInfo.conventional.unit) || this.market.basesymbol.toUpperCase();
        const xLabels = makeCandleTimeLabels(candles, candleWidth, this.plotRegion.width(), 100);
        this.plotXGrid(xLabels, xStart, xEnd);
        const yLabels = this.makeYLabels(this.candleRegion, rateStep, baseUnit, v => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(v / rFactor));
        this.plotYGrid(this.candleRegion, yLabels, this.dataExtents.y.min, this.dataExtents.y.max);
        // Draw the volume bars.
        const volDataExtents = new Extents(xStart, xEnd, 0, highVol);
        this.volumeRegion.plot(volDataExtents, (ctx, tools) => {
            ctx.fillStyle = this.theme.gridBorder;
            for (const c of candles) {
                ctx.fillRect(tools.x(paddedStart(c)), tools.y(0), tools.w(paddedWidth), tools.h(c.matchVolume));
            }
        });
        // Draw the candles.
        this.candleRegion.plot(dataExtents, (ctx, tools) => {
            ctx.lineWidth = 1;
            for (const c of candles) {
                const desc = c.startRate > c.endRate;
                const [x, y, w, h] = [tools.x(paddedStart(c)), tools.y(c.startRate), tools.w(paddedWidth), tools.h(c.endRate - c.startRate)];
                const [high, low, cx] = [tools.y(c.highRate), tools.y(c.lowRate), w / 2 + x];
                ctx.strokeStyle = desc ? this.theme.sellLine : this.theme.buyLine;
                ctx.fillStyle = desc ? this.theme.sellFill : this.theme.buyFill;
                ctx.beginPath();
                ctx.moveTo(cx, high);
                ctx.lineTo(cx, low);
                ctx.stroke();
                ctx.fillRect(x, y, w, h);
                ctx.strokeRect(x, y, w, h);
            }
        });
        // Apply labels.
        this.plotXLabels(xLabels, xStart, xEnd, []);
        this.plotYLabels(yLabels, this.dataExtents.y.min, this.dataExtents.y.max, baseUnit);
        // Highlight the candle if the user mouse is over the canvas.
        if (mouseCandle) {
            const yExt = this.xRegion.extents.y;
            this.xRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, yExt.min, yExt.max), (ctx, tools) => {
                if (!mouseCandle)
                    return; // For TypeScript. Duh.
                this.applyLabelStyle();
                const rangeTxt = `${new Date(start(mouseCandle)).toLocaleString()} - ${new Date(end(mouseCandle)).toLocaleString()}`;
                const [xPad, yPad] = [25, 2];
                const rangeWidth = ctx.measureText(rangeTxt).width + 2 * xPad;
                const rangeHeight = 16;
                let centerX = tools.x((start(mouseCandle) + end(mouseCandle)) / 2);
                let left = centerX - rangeWidth / 2;
                const xExt = this.xRegion.extents.x;
                if (left < xExt.min)
                    left = xExt.min;
                else if (left + rangeWidth > xExt.max)
                    left = xExt.max - rangeWidth;
                centerX = left + rangeWidth / 2;
                const top = yExt.min + (this.xRegion.height() - rangeHeight) / 2;
                ctx.fillStyle = this.theme.legendFill;
                ctx.strokeStyle = this.theme.gridBorder;
                const rectArgs = [left - xPad, top - yPad, rangeWidth + 2 * xPad, rangeHeight + 2 * yPad];
                ctx.fillRect(...rectArgs);
                ctx.strokeRect(...rectArgs);
                this.applyLabelStyle();
                ctx.fillText(rangeTxt, centerX, this.xRegion.extents.midY, rangeWidth);
            });
        }
        // Report the mouse candle.
        this.reporters.mouse(mouseCandle);
    }
    /* setCandles sets the candle data and redraws the chart. */
    setCandles(data, market, baseUnitInfo, quoteUnitInfo) {
        this.data = data;
        if (!data.candles)
            return;
        this.market = market;
        const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor];
        this.rateConversionFactor = _orderutil__WEBPACK_IMPORTED_MODULE_1__.RateEncodingFactor * qFactor / bFactor;
        let n = 25;
        this.zoomLevels = [];
        const maxCandles = Math.max(data.candles.length, 1000);
        while (n < maxCandles) {
            this.zoomLevels.push(n);
            n *= 2;
        }
        this.numToShow = 100;
        this.draw();
    }
}
/* Wave is a loading animation that displays a colorful line that oscillates */
class Wave extends Chart {
    constructor(parent, opts) {
        super(parent, {
            resize: () => this.resized(),
            click: ( /* e: MouseEvent */) => { },
            zoom: ( /* bigger: boolean */) => { }
        });
        this.canvas.classList.add('fill-abs');
        this.canvas.style.zIndex = '5';
        this.opts = opts !== null && opts !== void 0 ? opts : {};
        const period = 1500; // ms
        const start = Math.random() * period;
        this.colorShift = Math.random() * 360;
        // y = A*cos(k*x + theta*t + c)
        // combine three waves with different periods and speeds and phases.
        const amplitudes = [1, 0.65, 0.75];
        const ks = [3, 3, 2];
        const speeds = [Math.PI, Math.PI * 10 / 9, Math.PI / 2.5];
        const phases = [0, 0, Math.PI * 1.5];
        const n = 75;
        const single = (n, angularX, angularTime) => {
            return amplitudes[n] * Math.cos(ks[n] * angularX + speeds[n] * angularTime + phases[n]);
        };
        const value = (x, angularTime) => {
            const angularX = x * Math.PI * 2;
            return (single(0, angularX, angularTime) + single(1, angularX, angularTime) + single(2, angularX, angularTime)) / 3;
        };
        this.resize();
        this.ani = new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(_doc__WEBPACK_IMPORTED_MODULE_0__.Animation.Forever, () => {
            const angularTime = (new Date().getTime() - start) / period * Math.PI * 2;
            const values = [];
            for (let i = 0; i < n; i++) {
                values.push(value(i / (n - 1), angularTime));
            }
            this.drawValues(values);
        });
    }
    resized() {
        const opts = this.opts;
        const [maxW, maxH] = [150, 100];
        const [cw, ch] = [this.canvas.width, this.canvas.height];
        let [w, h] = [cw * 0.8, ch * 0.8];
        if (w > maxW)
            w = maxW;
        if (h > maxH)
            h = maxH;
        let [l, t] = [(cw - w) / 2, (ch - h) / 2];
        if (opts.message) {
            this.fontSize = (0,_doc__WEBPACK_IMPORTED_MODULE_0__.clamp)(h * 0.15, 10, 14);
            this.applyLabelStyle(this.fontSize);
            const ypad = this.fontSize * 0.5;
            const halfH = (this.fontSize / 2) + ypad;
            t -= halfH;
            this.msgRegion = new Region(this.ctx, new Extents(0, cw, t + h, t + h + 2 * halfH));
        }
        this.region = new Region(this.ctx, new Extents(l, l + w, t, t + h));
    }
    drawValues(values) {
        if (!this.region)
            return;
        this.clear();
        const hsl = (h) => `hsl(${h}, 35%, 50%)`;
        const { region, msgRegion, canvas: { width: w, height: h }, opts: { backgroundColor: bg, message: msg }, colorShift, ctx } = this;
        if (bg) {
            if (bg === true)
                ctx.fillStyle = _state__WEBPACK_IMPORTED_MODULE_2__["default"].isDark() ? '#0a1e34' : '#f0f0f0';
            else
                ctx.fillStyle = bg;
            ctx.fillRect(0, 0, w, h);
        }
        region.plot(new Extents(0, 1, -1, 1), (ctx, t) => {
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            const shift = colorShift + (new Date().getTime() % 2000) / 2000 * 360; // colors move with frequency 1 / 2s
            const grad = ctx.createLinearGradient(t.x(0), 0, t.x(1), 0);
            grad.addColorStop(0, hsl(shift));
            ctx.strokeStyle = grad;
            ctx.beginPath();
            ctx.moveTo(t.x(0), t.y(values[0]));
            for (let i = 1; i < values.length; i++) {
                const prog = i / (values.length - 1);
                grad.addColorStop(prog, hsl(prog * 300 + shift));
                ctx.lineTo(t.x(prog), t.y(values[i]));
            }
            ctx.stroke();
        });
        if (!msg)
            return;
        msgRegion.plot(new Extents(0, 1, 0, 1), (ctx, t) => {
            this.applyLabelStyle(this.fontSize);
            ctx.fillText(msg, t.x(0.5), t.y(0.5), this.msgRegion.width());
        });
    }
    render() { }
    stop() {
        this.ani.stop();
        this.canvas.remove();
    }
}
/*
 * Extents holds a min and max in both the x and y directions, and provides
 * getters for related data.
 */
class Extents {
    constructor(xMin, xMax, yMin, yMax) {
        this.setExtents(xMin, xMax, yMin, yMax);
    }
    setExtents(xMin, xMax, yMin, yMax) {
        this.x = {
            min: xMin,
            max: xMax
        };
        this.y = {
            min: yMin,
            max: yMax
        };
    }
    get xRange() {
        return this.x.max - this.x.min;
    }
    get midX() {
        return (this.x.max + this.x.min) / 2;
    }
    get yRange() {
        return this.y.max - this.y.min;
    }
    get midY() {
        return (this.y.max + this.y.min) / 2;
    }
}
/*
 * Region applies an Extents to the canvas, providing utilities for coordinate
 * transformations and restricting drawing to a specified region of the canvas.
 */
class Region {
    constructor(context, extents) {
        this.context = context;
        this.extents = extents;
    }
    setExtents(xMin, xMax, yMin, yMax) {
        this.extents.setExtents(xMin, xMax, yMin, yMax);
    }
    width() {
        return this.extents.xRange;
    }
    height() {
        return this.extents.yRange;
    }
    contains(x, y) {
        const ext = this.extents;
        return (x < ext.x.max && x > ext.x.min &&
            y < ext.y.max && y > ext.y.min);
    }
    /*
     * A translator provides 4 function for coordinate transformations. x and y
     * translate data coordinates to canvas coordinates for the specified data
     * Extents. unx and uny translate canvas coordinates to data coordinates.
     */
    translator(dataExtents) {
        const region = this.extents;
        const xMin = dataExtents.x.min;
        // const xMax = dataExtents.x.max
        const yMin = dataExtents.y.min;
        // const yMax = dataExtents.y.max
        const yRange = dataExtents.yRange;
        const xRange = dataExtents.xRange;
        const screenMinX = region.x.min;
        const screenW = region.x.max - screenMinX;
        const screenMaxY = region.y.max;
        const screenH = screenMaxY - region.y.min;
        const xFactor = screenW / xRange;
        const yFactor = screenH / yRange;
        return {
            x: (x) => (x - xMin) * xFactor + screenMinX,
            y: (y) => screenMaxY - (y - yMin) * yFactor,
            unx: (x) => (x - screenMinX) / xFactor + xMin,
            uny: (y) => yMin - (y - screenMaxY) / yFactor,
            w: (w) => w / xRange * screenW,
            h: (h) => -h / yRange * screenH
        };
    }
    /* clear clears the region. */
    clear() {
        const ext = this.extents;
        this.context.clearRect(ext.x.min, ext.y.min, ext.xRange, ext.yRange);
    }
    /* plot prepares tools for drawing using data coordinates. */
    plot(dataExtents, drawFunc, skipMask) {
        const ctx = this.context;
        const region = this.extents;
        ctx.save(); // Save the original state
        if (!skipMask) {
            ctx.beginPath();
            ctx.rect(region.x.min, region.y.min, region.xRange, region.yRange);
            ctx.clip();
        }
        // The drawFunc will be passed a set of tool that can be used to assist
        // drawing. The tools start with the transformation functions.
        const tools = this.translator(dataExtents);
        // Create a transformation that allows drawing in data coordinates. It's
        // not advisable to stroke or add text with this transform in place, as the
        // result will be distorted. You can however use ctx.moveTo and ctx.lineTo
        // with this transform in place using data coordinates, and remove the
        // transform before stroking. The dataCoords method of the supplied tool
        // provides this functionality.
        // TODO: Figure out why this doesn't work on WebView.
        // const yRange = dataExtents.yRange
        // const xFactor = region.xRange / dataExtents.xRange
        // const yFactor = region.yRange / yRange
        // const xMin = dataExtents.x.min
        // const yMin = dataExtents.y.min
        // // These translation factors are complicated because the (0, 0) of the
        // // region is not necessarily the (0, 0) of the canvas.
        // const tx = (region.x.min + xMin) - xMin * xFactor
        // const ty = -region.y.min - (yRange - yMin) * yFactor
        // const setTransform = () => {
        //   // Data coordinates are flipped about y. Flip the coordinates and
        //   // translate top left corner to canvas (0, 0).
        //   ctx.transform(1, 0, 0, -1, -xMin, yMin)
        //   // Scale to data coordinates and shift into place for the region's offset
        //   // on the canvas.
        //   ctx.transform(xFactor, 0, 0, yFactor, tx, ty)
        // }
        // // dataCoords allows some drawing to be performed directly in data
        // // coordinates. Most actual drawing functions like ctx.stroke and
        // // ctx.fillRect should not be called from inside dataCoords, but
        // // ctx.moveTo and ctx.LineTo are fine.
        // tools.dataCoords = f => {
        //   ctx.save()
        //   setTransform()
        //   f()
        //   ctx.restore()
        // }
        drawFunc(this.context, tools);
        ctx.restore();
    }
}
/*
 * makeLabels attempts to create the appropriate labels for the specified
 * screen size, context, and label spacing.
 */
function makeLabels(ctx, screenW, min, max, spacingGuess, step, unit, valFmt) {
    valFmt = valFmt || _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs;
    const n = screenW / spacingGuess;
    const diff = max - min;
    if (n < 1 || diff <= 0)
        return { lbls: [] };
    const tickGuess = diff / n;
    // make the tick spacing a multiple of the step
    const tick = tickGuess + step - (tickGuess % step);
    let x = min + tick - (min % tick);
    const absMax = Math.max(Math.abs(max), Math.abs(min));
    // The Math.round part is the minimum precision required to see the change in the numbers.
    // The 2 accounts for the precision of the tick.
    const sigFigs = Math.round(Math.log10(absMax / tick)) + 2;
    const pts = [];
    let widest = 0;
    while (x < max) {
        x = Number(x.toPrecision(sigFigs));
        const lbl = valFmt(x);
        widest = Math.max(widest, ctx.measureText(lbl).width);
        pts.push({
            val: x,
            txt: lbl
        });
        x += tick;
    }
    const unitW = ctx.measureText(unit).width;
    if (unitW > widest)
        widest = unitW;
    return {
        widest: widest,
        lbls: pts
    };
}
const months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec'];
/* makeCandleTimeLabels prepares labels for candlestick data. */
function makeCandleTimeLabels(candles, dur, screenW, spacingGuess) {
    const first = candles[0];
    const last = candles[candles.length - 1];
    const start = truncate(first.endStamp, dur);
    const end = truncate(last.endStamp, dur) + dur;
    const diff = end - start;
    const n = Math.min(candles.length, screenW / spacingGuess);
    const tick = truncate(diff / n, dur);
    if (tick === 0) {
        console.error('zero tick', dur, diff, n); // probably won't happen, but it'd suck if it did
        return { lbls: [] };
    }
    let x = start;
    const zoneOffset = new Date().getTimezoneOffset();
    const dayStamp = (x) => {
        x = x - zoneOffset * 60000;
        return x - (x % 86400000);
    };
    let lastDay = dayStamp(start);
    let lastYear = 0; // new Date(start).getFullYear()
    if (dayStamp(first.endStamp) === dayStamp(last.endStamp))
        lastDay = 0; // Force at least one day stamp.
    const pts = [];
    let label;
    if (dur < 86400000) {
        label = (d, x) => {
            const day = dayStamp(x);
            if (day !== lastDay)
                return `${months[d.getMonth()]}${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`;
            else
                return `${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`;
        };
    }
    else {
        label = (d) => {
            const year = d.getFullYear();
            if (year !== lastYear)
                return `${months[d.getMonth()]}${d.getDate()} '${String(year).slice(2, 4)}`;
            else
                return `${months[d.getMonth()]}${d.getDate()}`;
        };
    }
    while (x <= end) {
        const d = new Date(x);
        pts.push({
            val: x,
            txt: label(d, x)
        });
        lastDay = dayStamp(x);
        lastYear = d.getFullYear();
        x += tick;
    }
    return { lbls: pts };
}
/* The last element of an array. */
function last(arr) {
    return arr[arr.length - 1];
}
/* line draws a line with the provided context. */
function line(ctx, x0, y0, x1, y1, skipStroke) {
    ctx.beginPath();
    ctx.moveTo(x0, y0);
    ctx.lineTo(x1, y1);
    if (!skipStroke)
        ctx.stroke();
}
/* dot draws a circle with the provided context. */
function dot(ctx, x, y, color, radius) {
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, PIPI);
    ctx.fill();
}
/* floatCompare compares two floats to within a tolerance of  1e-8. */
function floatCompare(a, b) {
    return withinTolerance(a, b, 1e-8);
}
/*
 * withinTolerance returns true if the difference between a and b are with
 * the specified tolerance.
 */
function withinTolerance(a, b, tolerance) {
    return Math.abs(a - b) < Math.abs(tolerance);
}
function truncate(v, w) {
    return v - (v % w);
}


/***/ }),

/***/ "./src/js/coinexplorers.ts":
/*!*********************************!*\
  !*** ./src/js/coinexplorers.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CoinExplorers": () => (/* binding */ CoinExplorers),
/* harmony export */   "Mainnet": () => (/* binding */ Mainnet),
/* harmony export */   "Simnet": () => (/* binding */ Simnet),
/* harmony export */   "Testnet": () => (/* binding */ Testnet),
/* harmony export */   "formatCoinID": () => (/* binding */ formatCoinID),
/* harmony export */   "setCoinHref": () => (/* binding */ setCoinHref)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");


const Mainnet = 0;
const Testnet = 1;
const Simnet = 2;
const coinIDTakerFoundMakerRedemption = 'TakerFoundMakerRedemption:';
/* ethBasedExplorerArg returns the explorer argument for ETH, ERC20 and EVM
Compatible assets and whether the return value is an address. */
function ethBasedExplorerArg(cid) {
    if (cid.startsWith(coinIDTakerFoundMakerRedemption))
        return [cid.substring(coinIDTakerFoundMakerRedemption.length), true];
    else if (cid.length === 42)
        return [cid, true];
    else
        return [cid, false];
}
const ethExplorers = {
    [Mainnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://etherscan.io/address/${arg}` : `https://etherscan.io/tx/${arg}`;
    },
    [Testnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://sepolia.etherscan.io/address/${arg}` : `https://sepolia.etherscan.io/tx/${arg}`;
    },
    [Simnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://etherscan.io/address/${arg}` : `https://etherscan.io/tx/${arg}`;
    }
};
const polygonExplorers = {
    [Mainnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://polygonscan.com/address/${arg}` : `https://polygonscan.com/tx/${arg}`;
    },
    [Testnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://amoy.polygonscan.com/address/${arg}` : `https://amoy.polygonscan.com/tx/${arg}`;
    },
    [Simnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://polygonscan.com/address/${arg}` : `https://polygonscan.com/tx/${arg}`;
    }
};
const CoinExplorers = {
    42: {
        [Mainnet]: (cid) => {
            const [txid, vout] = cid.split(':');
            if (vout !== undefined)
                return `https://explorer.dcrdata.org/tx/${txid}/out/${vout}`;
            return `https://explorer.dcrdata.org/tx/${txid}`;
        },
        [Testnet]: (cid) => {
            const [txid, vout] = cid.split(':');
            if (vout !== undefined)
                return `https://testnet.dcrdata.org/tx/${txid}/out/${vout}`;
            return `https://testnet.dcrdata.org/tx/${txid}`;
        },
        [Simnet]: (cid) => {
            const [txid, vout] = cid.split(':');
            if (vout !== undefined)
                return `http://127.0.0.1:17779/tx/${txid}/out/${vout}`;
            return `https://127.0.0.1:17779/tx/${txid}`;
        }
    },
    0: {
        [Mainnet]: (cid) => `https://mempool.space/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://mempool.space/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://mempool.space/tx/${cid.split(':')[0]}`
    },
    2: {
        [Mainnet]: (cid) => `https://ltc.bitaps.com/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://sochain.com/tx/LTCTEST/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://ltc.bitaps.com/${cid.split(':')[0]}`
    },
    20: {
        [Mainnet]: (cid) => `https://digiexplorer.info/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://testnetexplorer.digibyteservers.io/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://digiexplorer.info/tx/${cid.split(':')[0]}`
    },
    60: ethExplorers,
    60001: ethExplorers,
    60002: ethExplorers,
    3: {
        [Mainnet]: (cid) => `https://dogeblocks.com/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://blockexplorer.one/dogecoin/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://dogeblocks.com/tx/${cid.split(':')[0]}`
    },
    5: {
        [Mainnet]: (cid) => `https://blockexplorer.one/dash/mainnet/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://blockexplorer.one/dash/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://blockexplorer.one/dash/mainnet/tx/${cid.split(':')[0]}`
    },
    133: {
        [Mainnet]: (cid) => `https://zcashblockexplorer.com/transactions/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://blockexplorer.one/zcash/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://zcashblockexplorer.com/transactions/${cid.split(':')[0]}`
    },
    147: {
        [Mainnet]: (cid) => `https://explorer.zcl.zelcore.io/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://explorer.zcl.zelcore.io/tx/${cid.split(':')[0]}`
    },
    136: {
        [Mainnet]: (cid) => `https://explorer.firo.org/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://testexplorer.firo.org/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://explorer.firo.org/tx/${cid.split(':')[0]}`
    },
    145: {
        [Mainnet]: (cid) => `https://bch.loping.net/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://tbch4.loping.net/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://bch.loping.net/tx/${cid.split(':')[0]}`
    },
    966: polygonExplorers,
    966001: polygonExplorers,
    966002: polygonExplorers,
    966003: polygonExplorers,
    966004: polygonExplorers
};
function formatCoinID(cid) {
    if (cid.startsWith(coinIDTakerFoundMakerRedemption)) {
        const makerAddr = cid.substring(coinIDTakerFoundMakerRedemption.length);
        return _locales__WEBPACK_IMPORTED_MODULE_1__.prep(_locales__WEBPACK_IMPORTED_MODULE_1__.ID_TAKER_FOUND_MAKER_REDEMPTION, { makerAddr: makerAddr });
    }
    return cid;
}
/*
 * baseChainID returns the asset ID for the asset's parent if the asset is a
 * token, otherwise the ID for the asset itself.
 */
function baseChainID(assetID) {
    const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().user.assets[assetID];
    return asset.token ? asset.token.parentID : assetID;
}
/*
 * setCoinHref sets the hyperlink element's href attribute based on provided
 * assetID and data-explorer-coin value present on supplied link element.
 */
function setCoinHref(assetID, link) {
    const net = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().user.net;
    const assetExplorer = CoinExplorers[baseChainID(assetID)];
    if (!assetExplorer)
        return;
    const formatter = assetExplorer[net];
    if (!formatter)
        return;
    link.classList.remove('plainlink');
    link.classList.add('subtlelink');
    link.href = formatter(link.dataset.explorerCoin || '');
}


/***/ }),

/***/ "./src/js/dexsettings.ts":
/*!*******************************!*\
  !*** ./src/js/dexsettings.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ DexSettingsPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./account */ "./src/js/account.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







const animationLength = 300;
class DexSettingsPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body) {
        super();
        this.body = body;
        const host = this.host = body.dataset.host ? body.dataset.host : '';
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[host];
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.forms = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, ':scope > form');
        this.confirmRegisterForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.ConfirmRegistrationForm(page.confirmRegForm, () => __awaiter(this, void 0, void 0, function* () {
            this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_TRADING_TIER_UPDATED));
            this.renewToggle.setState(this.confirmRegisterForm.tier > 0);
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().updateMenuItemsDisplay();
        }), () => {
            this.runAnimation(this.regAssetForm, page.regAssetForm);
        });
        this.confirmRegisterForm.setExchange(xc, '');
        this.walletWaitForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.WalletWaitForm(page.walletWait, () => {
            this.runAnimation(this.confirmRegisterForm, page.confirmRegForm);
        }, () => {
            this.runAnimation(this.regAssetForm, page.regAssetForm);
        });
        this.walletWaitForm.setExchange(xc);
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.NewWalletForm(page.newWalletForm, assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier), () => this.runAnimation(this.regAssetForm, page.regAssetForm));
        this.regAssetForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.FeeAssetSelectionForm(page.regAssetForm, (assetID, tier) => __awaiter(this, void 0, void 0, function* () {
            if (assetID === _registry__WEBPACK_IMPORTED_MODULE_6__.PrepaidBondID) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
                this.updateReputation();
                this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_TRADING_TIER_UPDATED));
                return;
            }
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const wallet = asset.wallet;
            if (wallet) {
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.regAssetForm);
                const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.regAssetForm);
                this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
                loaded();
                this.progressTierFormsWithWallet(assetID, wallet);
                return;
            }
            this.confirmRegisterForm.setAsset(assetID, tier, 0);
            this.newWalletForm.setAsset(assetID);
            this.showForm(page.newWalletForm);
        }));
        this.regAssetForm.setExchange(xc, '');
        this.reputationMeter = new _account__WEBPACK_IMPORTED_MODULE_5__.ReputationMeter(page.repMeter);
        this.reputationMeter.setHost(host);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportDexBtn, 'click', () => this.exportAccount());
        this.accountDisabled = body.dataset.disabled === 'true';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.toggleAccountStatusBtn, 'click', () => {
            if (!this.accountDisabled)
                this.prepareAccountDisable(page.disableAccountForm);
            else
                this.toggleAccountStatus(false);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.updateCertBtn, 'click', () => page.certFileInput.click());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.updateHostBtn, 'click', () => this.prepareUpdateHost());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.certFileInput, 'change', () => this.onCertFileChange());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.goBackToSettings, 'click', () => (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('settings'));
        const showTierForm = () => {
            this.regAssetForm.setExchange((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[host], ''); // reset form
            this.showForm(page.regAssetForm);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.changeTier, 'click', () => { showTierForm(); });
        const willAutoRenew = xc.auth.targetTier > 0;
        this.renewToggle = new _doc__WEBPACK_IMPORTED_MODULE_0__.AniToggle(page.toggleAutoRenew, page.renewErr, willAutoRenew, (newState) => __awaiter(this, void 0, void 0, function* () {
            if (this.accountDisabled)
                return;
            if (newState)
                showTierForm();
            else
                return this.disableAutoRenew();
        }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.autoRenewBox, 'click', (e) => {
            e.stopPropagation();
            if (!this.accountDisabled)
                page.toggleAutoRenew.click();
        });
        page.penaltyComps.textContent = String(xc.auth.penaltyComps);
        const hideCompInput = () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.penaltyCompInput);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyComps);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.penaltyCompBox, 'click', (e) => {
            e.stopPropagation();
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host];
            page.penaltyCompInput.value = String(xc.auth.penaltyComps);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.penaltyComps);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyCompInput);
            page.penaltyCompInput.focus();
            const checkClick = (e) => {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, page.penaltyCompBox))
                    return;
                hideCompInput();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'click', checkClick);
            };
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'click', checkClick);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.penaltyCompInput, 'keyup', (e) => __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.penaltyCompsErr);
            if (e.key === 'Escape') {
                hideCompInput();
                return;
            }
            if (!(e.key === 'Enter'))
                return;
            const penaltyComps = parseInt(page.penaltyCompInput.value || '');
            if (isNaN(penaltyComps)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyCompsErr);
                page.penaltyCompsErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_INVALID_COMPS_VALUE);
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.otherBondSettings);
            try {
                yield this.updateBondOptions({ penaltyComps });
                loaded();
                page.penaltyComps.textContent = String(penaltyComps);
            }
            catch (e) {
                loaded();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyCompsErr);
                page.penaltyCompsErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_API_ERROR, { msg: e.msg });
            }
            hideCompInput();
        }));
        this.dexAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DEXAddressForm(page.dexAddrForm, (xc) => __awaiter(this, void 0, void 0, function* () {
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage(`/dexsettings/${xc.host}`);
        }), this.host);
        // forms.bind(page.bondDetailsForm, page.updateBondOptionsConfirm, () => this.updateBondOptions())
        _forms__WEBPACK_IMPORTED_MODULE_3__.bind(page.disableAccountForm, page.disableAccountConfirm, () => this.toggleAccountStatus(true));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                this.closePopups();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                this.closePopups();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, '.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { this.closePopups(); });
        });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            conn: () => { this.setConnectionStatus(); },
            reputation: () => { this.updateReputation(); },
            feepayment: () => { this.updateReputation(); },
            bondpost: () => { this.updateReputation(); }
        });
        this.setConnectionStatus();
        this.updateReputation();
    }
    unload() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
    progressTierFormsWithWallet(assetID, wallet) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, confirmRegisterForm: { fees } } = this;
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const { bondAssets } = this.regAssetForm.xc;
            const bondAsset = bondAssets[asset.symbol];
            if (!wallet.open) {
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.forms);
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/openwallet', { assetID: assetID });
                loaded();
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                    this.regAssetForm.setAssetError(`error unlocking wallet: ${res.msg}`);
                    this.runAnimation(this.regAssetForm, page.regAssetForm);
                }
                return;
            }
            if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + fees) {
                // If we are raising our tier, we'll show a confirmation form
                this.progressTierFormWithSyncedFundedWallet(assetID);
                return;
            }
            this.walletWaitForm.setWallet(assetID, fees, this.confirmRegisterForm.tier);
            this.showForm(page.walletWait);
        });
    }
    progressTierFormWithSyncedFundedWallet(bondAssetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host];
            const targetTier = this.confirmRegisterForm.tier;
            const page = this.page;
            const strongTier = xc.auth.liveStrength + xc.auth.pendingStrength - xc.auth.weakStrength;
            if (targetTier > xc.auth.targetTier && targetTier > strongTier) {
                this.runAnimation(this.confirmRegisterForm, page.confirmRegForm);
                return;
            }
            // Lowering tier
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            try {
                yield this.updateBondOptions({ bondAssetID, targetTier });
                loaded();
            }
            catch (e) {
                loaded();
                this.regAssetForm.setTierError(e.msg);
                return;
            }
            // this.animateConfirmForm(page.regAssetForm)
            this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_TRADING_TIER_UPDATED));
        });
    }
    updateReputation() {
        const page = this.page;
        const auth = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host].auth;
        const { rep: { penalties }, targetTier, expiredBonds } = auth;
        const displayTier = (0,_account__WEBPACK_IMPORTED_MODULE_5__.strongTier)(auth);
        page.targetTier.textContent = String(targetTier);
        page.effectiveTier.textContent = String(displayTier);
        page.penalties.textContent = String(penalties);
        page.bondsPendingRefund.textContent = `${(expiredBonds === null || expiredBonds === void 0 ? void 0 : expiredBonds.length) || 0}`;
        this.reputationMeter.update();
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.currentForm = form;
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    runAnimation(ani, form) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.currentForm);
            yield ani.animate();
            this.currentForm = form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form);
        });
    }
    closePopups() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
        if (this.animation)
            this.animation.stop();
    }
    showSuccess(msg) {
        return __awaiter(this, void 0, void 0, function* () {
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            this.currentForm = this.page.checkmarkForm;
            this.animation = _forms__WEBPACK_IMPORTED_MODULE_3__.showSuccess(this.page, msg);
            yield this.animation.wait();
            this.animation = new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(1500, () => { }, '', () => {
                if (this.currentForm === this.page.checkmarkForm)
                    this.closePopups();
            });
        });
    }
    // exportAccount exports and downloads the account info.
    exportAccount() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, host } = this;
            const req = { host };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/exportaccount', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.exportAccountErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.exportAccountErr);
                return;
            }
            res.account.bonds = res.bonds; // maintain backward compat of JSON file
            const accountForExport = JSON.parse(JSON.stringify(res.account));
            const a = document.createElement('a');
            a.setAttribute('download', 'dcrAccount-' + host + '.json');
            a.setAttribute('href', 'data:text/json,' + JSON.stringify(accountForExport, null, 2));
            a.click();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
        });
    }
    // toggleAccountStatus enables or disables the account associated with the
    // provided host.
    toggleAccountStatus(disable) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
            let host = this.host;
            if (disable)
                host = page.disableAccountHost.textContent;
            const req = { host, disable: disable };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/toggleaccountstatus', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                if (disable) {
                    page.disableAccountErr.textContent = res.msg;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.disableAccountErr);
                }
                else {
                    page.errMsg.textContent = res.msg;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
                }
                return;
            }
            if (disable) {
                this.page.toggleAccountStatusBtn.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_ENABLE_ACCOUNT);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            }
            else
                this.page.toggleAccountStatusBtn.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_DISABLE_ACCOUNT);
            this.accountDisabled = disable;
            // Refresh exchange information since we've just enabled/disabled the
            // exchange.
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage(`dexsettings/${host}`);
        });
    }
    prepareAccountDisable(disableAccountForm) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            page.disableAccountHost.textContent = this.host;
            page.disableAccountErr.textContent = '';
            this.showForm(disableAccountForm);
        });
    }
    // Retrieve an estimate for the tx fee needed to create new bond reserves.
    getBondsFeeBuffer(assetID, form) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/bondsfeebuffer', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                return 0;
            }
            return res.feeBuffer;
        });
    }
    prepareUpdateHost() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.dexAddrForm.refresh();
            this.showForm(page.dexAddrForm);
        });
    }
    onCertFileChange() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
            const files = page.certFileInput.files;
            let cert;
            if (files && files.length)
                cert = yield files[0].text();
            if (!cert)
                return;
            const req = { host: this.host, cert: cert };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/updatecert', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.updateCertMsg);
                setTimeout(() => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.updateCertMsg); }, 5000);
            }
        });
    }
    setConnectionStatus() {
        const page = this.page;
        const exchange = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.exchanges[this.host];
        const displayIcons = (connected) => {
            if (connected) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.disconnectedIcon);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.connectedIcon);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.disconnectedIcon);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.connectedIcon);
            }
        };
        if (exchange) {
            switch (exchange.connectionStatus) {
                case _registry__WEBPACK_IMPORTED_MODULE_6__.ConnectionStatus.Connected:
                    displayIcons(true);
                    page.connectionStatus.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_CONNECTED);
                    break;
                case _registry__WEBPACK_IMPORTED_MODULE_6__.ConnectionStatus.Disconnected:
                    displayIcons(false);
                    if (this.accountDisabled)
                        page.connectionStatus.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_ACCOUNT_DISABLED_MSG);
                    else
                        page.connectionStatus.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_DISCONNECTED);
                    break;
                case _registry__WEBPACK_IMPORTED_MODULE_6__.ConnectionStatus.InvalidCert:
                    displayIcons(false);
                    page.connectionStatus.textContent = `${_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_DISCONNECTED)} - ${_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_INVALID_CERTIFICATE)}`;
            }
        }
    }
    disableAutoRenew() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.page.otherBondSettings);
            try {
                this.updateBondOptions({ targetTier: 0 });
                loaded();
            }
            catch (e) {
                loaded();
                throw e;
            }
        });
    }
    /*
     * updateBondOptions is called when the form to update bond options is
     * submitted.
     */
    updateBondOptions(conf) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            conf.host = this.host;
            yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/updatebondoptions', conf);
            const targetTier = (_a = conf.targetTier) !== null && _a !== void 0 ? _a : (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host].auth.targetTier;
            this.renewToggle.setState(targetTier > 0);
        });
    }
    newWalletCreated(assetID, tier) {
        return __awaiter(this, void 0, void 0, function* () {
            this.regAssetForm.refresh();
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            if (!user)
                return;
            const page = this.page;
            const asset = user.assets[assetID];
            const wallet = asset.wallet;
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host];
            const bondAmt = xc.bondAssets[asset.symbol].amount;
            const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.newWalletForm);
            this.confirmRegisterForm.setFees(assetID, bondsFeeBuffer);
            if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {
                this.progressTierFormWithSyncedFundedWallet(assetID);
                return;
            }
            this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
            yield this.showForm(page.walletWait);
        });
    }
}


/***/ }),

/***/ "./src/js/doc.ts":
/*!***********************!*\
  !*** ./src/js/doc.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AniToggle": () => (/* binding */ AniToggle),
/* harmony export */   "Animation": () => (/* binding */ Animation),
/* harmony export */   "Easing": () => (/* binding */ Easing),
/* harmony export */   "IncrementalInput": () => (/* binding */ IncrementalInput),
/* harmony export */   "MiniSlider": () => (/* binding */ MiniSlider),
/* harmony export */   "NumberInput": () => (/* binding */ NumberInput),
/* harmony export */   "WalletIcons": () => (/* binding */ WalletIcons),
/* harmony export */   "clamp": () => (/* binding */ clamp),
/* harmony export */   "default": () => (/* binding */ Doc),
/* harmony export */   "parseFloatDefault": () => (/* binding */ parseFloatDefault),
/* harmony export */   "setupCopyBtn": () => (/* binding */ setupCopyBtn),
/* harmony export */   "toFourSigFigs": () => (/* binding */ toFourSigFigs),
/* harmony export */   "toPrecision": () => (/* binding */ toPrecision)
/* harmony export */ });
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


const parser = new window.DOMParser();
const FPS = 30;
const BipIDs = {
    0: 'btc',
    42: 'dcr',
    2: 'ltc',
    5: 'dash',
    20: 'dgb',
    22: 'mona',
    28: 'vtc',
    3: 'doge',
    145: 'bch',
    60: 'eth',
    60001: 'usdc.eth',
    60002: 'usdt.eth',
    60003: 'matic.eth',
    136: 'firo',
    133: 'zec',
    966: 'polygon',
    966001: 'usdc.polygon',
    966002: 'weth.polygon',
    966003: 'wbtc.polygon',
    966004: 'usdt.polygon',
    147: 'zcl'
};
const BipSymbolIDs = {};
(function () {
    for (const k of Object.keys(BipIDs)) {
        BipSymbolIDs[BipIDs[parseInt(k)]] = parseInt(k);
    }
})();
const BipSymbols = Object.values(BipIDs);
const RateEncodingFactor = 1e8; // same as value defined in ./orderutil
const log10RateEncodingFactor = Math.round(Math.log10(RateEncodingFactor));
const languages = navigator.languages.filter((locale) => locale !== 'c');
const intFormatter = new Intl.NumberFormat(languages, { maximumFractionDigits: 0 });
const fourSigFigs = new Intl.NumberFormat(languages, {
    minimumSignificantDigits: 4,
    maximumSignificantDigits: 4
});
/* A cache for formatters used for Doc.formatCoinValue. */
const decimalFormatters = {};
/*
 * decimalFormatter gets the formatCoinValue formatter for the specified decimal
 * precision.
 */
function decimalFormatter(prec) {
    return formatter(decimalFormatters, 2, prec);
}
/* A cache for formatters used for Doc.formatFullPrecision. */
const fullPrecisionFormatters = {};
/*
 * fullPrecisionFormatter gets the formatFullPrecision formatter for the
 * specified decimal precision.
 */
function fullPrecisionFormatter(prec, locales) {
    return formatter(fullPrecisionFormatters, prec, prec, locales);
}
/*
 * formatter gets the formatter from the supplied cache if it already exists,
 * else creates it.
 */
function formatter(formatters, min, max, locales) {
    const k = `${min}-${max}`;
    let fmt = formatters[k];
    if (!fmt) {
        fmt = new Intl.NumberFormat(locales !== null && locales !== void 0 ? locales : languages, {
            minimumFractionDigits: min,
            maximumFractionDigits: max
        });
        formatters[k] = fmt;
    }
    return fmt;
}
/*
 * convertToConventional converts the value in atomic units to conventional
 * units.
 */
function convertToConventional(v, unitInfo) {
    let prec = 8;
    if (unitInfo) {
        const f = unitInfo.conventional.conversionFactor;
        v /= f;
        prec = Math.round(Math.log10(f));
    }
    return [v, prec];
}
/*
 * bestDisplayOrder is used in bestConversion, and is the order of magnitude
 * that is considered the best for display. For example, if bestDisplayOrder is
 * 1, and the choices for display are 1,000 BTC or 0.00001 Sats, the algorithm
 * will look at the orders of the conversions, 1000 => 10^3 => order 3, and
 * 0.00001 => 10^-5 => order 5, and see which is closest to bestDisplayOrder and
 * choose that conversion. In the example, 3 - bestDisplayOrder = 2 and
 * 1 - (-5) = 6, so the conversion that has the order closest to
 * bestDisplayOrder is the first one, 1,000 BTC.
 */
const bestDisplayOrder = 1; // 10^1 => 1
/*
 * resolveUnitConversions creates a lookup object mapping unit -> conversion
 * factor. By default, resolveUnitConversions only maps the atomic and
 * conventional units. If a prefs dict is provided, additional units can be
 * included.
 */
function resolveUnitConversions(ui, prefs) {
    const unitFactors = {
        [ui.atomicUnit]: 1,
        [ui.conventional.unit]: ui.conventional.conversionFactor
    };
    if (ui.denominations && prefs) {
        for (const alt of ui.denominations)
            if (prefs[alt.unit])
                unitFactors[alt.unit] = alt.conversionFactor;
    }
    return unitFactors;
}
// Helpers for working with the DOM.
class Doc {
    /*
     * idel is the element with the specified id that is the descendent of the
     * specified node.
     */
    static idel(el, id) {
        return el.querySelector(`#${id}`);
    }
    /* bind binds the function to the event for the element. */
    static bind(el, ev, f, opts /* EventListenerOptions */) {
        for (const e of (Array.isArray(ev) ? ev : [ev]))
            el.addEventListener(e, f, opts);
    }
    /* unbind removes the handler for the event from the element. */
    static unbind(el, ev, f) {
        el.removeEventListener(ev, f);
    }
    /* noderize creates a Document object from a string of HTML. */
    static noderize(html) {
        return parser.parseFromString(html, 'text/html');
    }
    /*
     * mouseInElement returns true if the position of mouse event, e, is within
     * the bounds of the specified element or any of its descendents.
     */
    static mouseInElement(e, el) {
        if (el.contains(e.target))
            return true;
        const rect = el.getBoundingClientRect();
        return e.pageX >= rect.left && e.pageX <= rect.right &&
            e.pageY >= rect.top && e.pageY <= rect.bottom;
    }
    /*
     * layoutMetrics gets information about the elements position on the page.
     */
    static layoutMetrics(el) {
        const box = el.getBoundingClientRect();
        const docEl = document.documentElement;
        const top = box.top + docEl.scrollTop;
        const left = box.left + docEl.scrollLeft;
        const w = el.offsetWidth;
        const h = el.offsetHeight;
        return {
            bodyTop: top,
            bodyLeft: left,
            width: w,
            height: h,
            centerX: left + w / 2,
            centerY: top + h / 2
        };
    }
    static descendentMetrics(parent, kid) {
        const parentMetrics = Doc.layoutMetrics(parent);
        const kidMetrics = Doc.layoutMetrics(kid);
        return {
            bodyTop: kidMetrics.bodyTop - parentMetrics.bodyTop,
            bodyLeft: kidMetrics.bodyLeft - parentMetrics.bodyLeft,
            width: kidMetrics.width,
            height: kidMetrics.height,
            centerX: kidMetrics.centerX - parentMetrics.bodyLeft,
            centerY: kidMetrics.centerY - parentMetrics.bodyTop
        };
    }
    /* empty removes all child nodes from the specified element. */
    static empty(...els) {
        for (const el of els)
            while (el.firstChild)
                el.removeChild(el.firstChild);
    }
    /*
     * setContent removes all child nodes from the specified element and appends
     * passed elements.
     */
    static setContent(ancestor, ...kids) {
        Doc.empty(ancestor);
        for (const k of kids)
            ancestor.appendChild(k);
    }
    /*
     * hide hides the specified elements. This is accomplished by adding the
     * bootstrap d-hide class to the element. Use Doc.show to undo.
     */
    static hide(...els) {
        for (const el of els)
            el.classList.add('d-hide');
    }
    /*
     * show shows the specified elements. This is accomplished by removing the
     * bootstrap d-hide class as added with Doc.hide.
     */
    static show(...els) {
        for (const el of els)
            el.classList.remove('d-hide');
    }
    /*
     * show or hide the specified elements, based on value of the truthiness of
     * vis.
     */
    static setVis(vis, ...els) {
        if (vis)
            Doc.show(...els);
        else
            Doc.hide(...els);
    }
    /* isHidden returns true if the specified element is hidden */
    static isHidden(el) {
        return el.classList.contains('d-hide');
    }
    /* isDisplayed returns true if the specified element is not hidden */
    static isDisplayed(el) {
        return !el.classList.contains('d-hide');
    }
    /*
     * animate runs the supplied function, which should be a "progress" function
     * accepting one argument. The progress function will be called repeatedly
     * with the argument varying from 0.0 to 1.0. The exact path that animate
     * takes from 0.0 to 1.0 will vary depending on the choice of easing
     * algorithm. See the Easing object for the available easing algo choices. The
     * default easing algorithm is linear.
     */
    static animate(duration, f, easingAlgo) {
        return __awaiter(this, void 0, void 0, function* () {
            yield new Animation(duration, f, easingAlgo).wait();
        });
    }
    static blink(el) {
        return __awaiter(this, void 0, void 0, function* () {
            const [r, g, b] = _state__WEBPACK_IMPORTED_MODULE_1__["default"].isDark() ? [255, 255, 255] : [0, 0, 0];
            const cycles = 2;
            Doc.animate(1000, (p) => {
                el.style.outline = `2px solid rgba(${r}, ${g}, ${b}, ${(cycles - p * cycles) % 1})`;
            });
        });
    }
    static applySelector(ancestor, k) {
        return Array.from(ancestor.querySelectorAll(k));
    }
    static kids(ancestor) {
        return Array.from(ancestor.children);
    }
    static safeSelector(ancestor, k) {
        const el = ancestor.querySelector(k);
        if (el)
            return el;
        console.warn(`no element found for selector '${k}' on element ->`, ancestor);
        return document.createElement('div');
    }
    /*
     * idDescendants creates an object mapping to elements which are descendants
     * of the ancestor and have id attributes. Elements are keyed by their id
     * value.
     */
    static idDescendants(ancestor) {
        const d = {};
        for (const el of Doc.applySelector(ancestor, '[id]'))
            d[el.id] = el;
        return d;
    }
    /*
     * formatCoinValue formats the value in atomic units into a string
     * representation in conventional units. If the value happens to be an
     * integer, no decimals are displayed. Trailing zeros may be truncated.
     */
    static formatCoinValue(vAtomic, unitInfo) {
        const [v, prec] = convertToConventional(vAtomic, unitInfo);
        if (Number.isInteger(v))
            return intFormatter.format(v);
        return decimalFormatter(prec).format(v);
    }
    static conventionalCoinValue(vAtomic, unitInfo) {
        const [v] = convertToConventional(vAtomic, unitInfo);
        return v;
    }
    /*
     * formatRateFullPrecision formats rate to represent it exactly at rate step
     * precision, trimming non-effectual zeros if there are any.
     */
    static formatRateFullPrecision(encRate, bui, qui, rateStepEnc) {
        const r = bui.conventional.conversionFactor / qui.conventional.conversionFactor;
        const convRate = encRate * r / RateEncodingFactor;
        const rateStepDigits = log10RateEncodingFactor - Math.floor(Math.log10(rateStepEnc)) -
            Math.floor(Math.log10(bui.conventional.conversionFactor) - Math.log10(qui.conventional.conversionFactor));
        if (rateStepDigits <= 0)
            return intFormatter.format(convRate);
        return fullPrecisionFormatter(rateStepDigits).format(convRate);
    }
    static formatFourSigFigs(n, maxDecimals) {
        return formatSigFigsWithFormatters(intFormatter, fourSigFigs, n, maxDecimals);
    }
    static formatInt(i) {
        return intFormatter.format(i);
    }
    /*
     * formatFullPrecision formats the value in atomic units into a string
     * representation in conventional units using the full decimal precision
     * associated with the conventional unit's conversion factor.
     */
    static formatFullPrecision(vAtomic, unitInfo) {
        const [v, prec] = convertToConventional(vAtomic, unitInfo);
        return fullPrecisionFormatter(prec).format(v);
    }
    /*
     * formatFiatConversion formats the value in atomic units to its representation in
     * conventional units and returns the fiat value as a string.
     */
    static formatFiatConversion(vAtomic, rate, unitInfo) {
        if (!rate || rate === 0)
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNAVAILABLE);
        const prec = 2;
        const [v] = convertToConventional(vAtomic, unitInfo);
        const value = v * rate;
        return fullPrecisionFormatter(prec).format(value);
    }
    static languages() {
        return languages;
    }
    static formatFiatValue(value) {
        return fullPrecisionFormatter(2).format(value);
    }
    /*
     * bestConversion picks the best conversion factor for the atomic value. The
     * best is the one in which log10(converted_value) is closest to
     * bestDisplayOrder. Return: [converted_value, precision, unit].
     */
    static bestConversion(atoms, ui, prefs) {
        const unitFactors = resolveUnitConversions(ui, prefs);
        const logDiffs = [];
        const entryDiff = (entry) => Math.abs(Math.log10(atoms / entry[1]) - bestDisplayOrder);
        for (const entry of Object.entries(unitFactors))
            logDiffs.push([entry[0], entryDiff(entry)]);
        const best = logDiffs.reduce((best, entry) => entry[1] < best[1] ? entry : best);
        const unit = best[0];
        const cFactor = unitFactors[unit];
        const v = atoms / cFactor;
        return [v, Math.round(Math.log10(cFactor)), unit];
    }
    /*
     * formatBestUnitsFullPrecision formats the value with the best choice of
     * units, at full precision.
     */
    static formatBestUnitsFullPrecision(atoms, ui, prefs) {
        const [v, prec, unit] = this.bestConversion(atoms, ui, prefs);
        if (Number.isInteger(v))
            return [intFormatter.format(v), unit];
        return [fullPrecisionFormatter(prec).format(v), unit];
    }
    /*
     * formatBestUnitsFourSigFigs formats the value with the best choice of
     * units and rounded to four significant figures.
     */
    static formatBestUnitsFourSigFigs(atoms, ui, prefs) {
        const [v, prec, unit] = this.bestConversion(atoms, ui, prefs);
        return [Doc.formatFourSigFigs(v, prec), unit];
    }
    /*
     * formatBestRateElement formats a rate using the best available units and
     * updates the UI element. The ancestor should have descendents with data
     * attributes [best-value, data-unit, data-unit-box, data-denom].
     */
    static formatBestRateElement(ancestor, assetID, atoms, ui, prefs) {
        Doc.formatBestValueElement(ancestor, assetID, atoms, ui, prefs);
        Doc.setText(ancestor, '[data-denom]', ui.feeRateDenom);
    }
    /*
     * formatBestRateElement formats a value using the best available units and
     * updates the UI element. The ancestor should have descendents with data
     * attributes [best-value, data-unit, data-unit-box].
     */
    static formatBestValueElement(ancestor, assetID, atoms, ui, prefs) {
        const [v, unit] = this.formatBestUnitsFourSigFigs(atoms, ui, prefs);
        Doc.setText(ancestor, '[data-value]', v);
        Doc.setText(ancestor, '[data-unit]', unit);
        const span = Doc.safeSelector(ancestor, '[data-unit-box]');
        span.dataset.atoms = String(atoms);
        span.dataset.assetID = String(assetID);
    }
    static conventionalRateStep(rateStepEnc, baseUnitInfo, quoteUnitInfo) {
        const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor];
        return rateStepEnc / RateEncodingFactor * (bFactor / qFactor);
    }
    /*
     * logoPath creates a path to a png logo for the specified ticker symbol. If
     * the symbol is not a supported asset, the generic letter logo will be
     * requested instead.
     */
    static logoPath(symbol) {
        if (BipSymbols.indexOf(symbol) === -1)
            symbol = symbol.substring(0, 1);
        symbol = symbol.split('.')[0]; // e.g. usdc.eth => usdc
        return `/img/coins/${symbol}.png`;
    }
    static bipSymbol(assetID) {
        return BipIDs[assetID];
    }
    static bipIDFromSymbol(symbol) {
        return BipSymbolIDs[symbol];
    }
    static bipCEXSymbol(assetID) {
        const bipSymbol = BipIDs[assetID];
        if (!bipSymbol || bipSymbol === '')
            return '';
        const parts = bipSymbol.split('.');
        if (parts[0] === 'weth')
            return 'eth';
        return parts[0];
    }
    static logoPathFromID(assetID) {
        return Doc.logoPath(BipIDs[assetID]);
    }
    /*
     * symbolize creates a token-aware symbol element for the asset's symbol. For
     * non-token assets, this is simply a <span>SYMBOL</span>. For tokens, it'll
     * be <span><span>SYMBOL</span><sup>PARENT</sup></span>.
     */
    static symbolize(asset, useLogo) {
        const ticker = asset.unitInfo.conventional.unit;
        const symbolSpan = document.createElement('span');
        symbolSpan.textContent = ticker.toUpperCase();
        const parts = asset.symbol.split('.');
        const isToken = parts.length === 2;
        if (!isToken)
            return symbolSpan;
        const parentSymbol = parts[1];
        const span = document.createElement('span');
        span.appendChild(symbolSpan);
        if (useLogo) {
            const parentLogo = document.createElement('img');
            parentLogo.src = Doc.logoPath(parentSymbol);
            parentLogo.classList.add('token-parent');
            span.appendChild(parentLogo);
            return span;
        }
        const parentSup = document.createElement('sup');
        parentSup.textContent = parentSymbol.toUpperCase();
        parentSup.classList.add('token-parent');
        span.appendChild(parentSup);
        return span;
    }
    /*
     * shortSymbol removes the short format of a symbol, with any parent chain
     * identifier removed
     */
    static shortSymbol(symbol) {
        return symbol.split('.')[0].toUpperCase();
    }
    /*
     * setText sets the textContent for all descendant elements that match the
     * specified CSS selector.
     */
    static setText(ancestor, selector, textContent) {
        for (const el of Doc.applySelector(ancestor, selector))
            el.textContent = textContent;
    }
    static setSrc(ancestor, selector, textContent) {
        for (const img of Doc.applySelector(ancestor, selector))
            img.src = textContent;
    }
    /*
    * cleanTemplates removes the elements from the DOM and deletes the id
    * attribute.
    */
    static cleanTemplates(...tmpls) {
        tmpls.forEach(tmpl => {
            tmpl.remove();
            tmpl.removeAttribute('id');
        });
    }
    /*
    * tmplElement is a helper function for grabbing sub-elements of the market list
    * template.
    */
    static tmplElement(ancestor, s) {
        return ancestor.querySelector(`[data-tmpl="${s}"]`) || document.createElement('div');
    }
    /*
    * parseTemplate returns an object of data-tmpl elements, keyed by their
    * data-tmpl values.
    */
    static parseTemplate(ancestor) {
        const d = {};
        for (const el of Doc.applySelector(ancestor, '[data-tmpl]'))
            d[el.dataset.tmpl || ''] = el;
        return d;
    }
    /*
     * timeSince returns a string representation of the duration since the
     * specified unix timestamp (milliseconds).
     */
    static timeSince(ms) {
        return Doc.formatDuration((new Date().getTime()) - ms);
    }
    /*
     * hmsSince returns a time duration since the specified unix timestamp
     * formatted as HH:MM:SS
     */
    static hmsSince(secs) {
        let r = (new Date().getTime() / 1000) - secs;
        const h = String(Math.floor(r / 3600));
        r = r % 3600;
        const m = String(Math.floor(r / 60));
        const s = String(Math.floor(r % 60));
        return `${h.padStart(2, '0')}:${m.padStart(2, '0')}:${s.padStart(2, '0')}`;
    }
    /* formatDuration returns a string representation of the duration */
    static formatDuration(dur) {
        let seconds = Math.floor(dur);
        let result = '';
        let count = 0;
        const add = (n, s) => {
            if (n > 0 || count > 0)
                count++;
            if (n > 0)
                result += `${n} ${s} `;
            return count >= 2;
        };
        let y, mo, d, h, m, s;
        [y, seconds] = timeMod(seconds, aYear);
        if (add(y, 'y')) {
            return result;
        }
        [mo, seconds] = timeMod(seconds, aMonth);
        if (add(mo, 'mo')) {
            return result;
        }
        [d, seconds] = timeMod(seconds, aDay);
        if (add(d, 'd')) {
            return result;
        }
        [h, seconds] = timeMod(seconds, anHour);
        if (add(h, 'h')) {
            return result;
        }
        [m, seconds] = timeMod(seconds, aMinute);
        if (add(m, 'm')) {
            return result;
        }
        [s, seconds] = timeMod(seconds, 1000);
        add(s, 's');
        return result || '0 s';
    }
    /*
     * disableMouseWheel can be used to disable the mouse wheel for any
     * input. It is very easy to unknowingly scroll up on a number input
     * and then submit an unexpected value. This function prevents the
     * scroll increment/decrement behavior for a wheel action on a
     * number input.
     */
    static disableMouseWheel(...inputFields) {
        for (const inputField of inputFields) {
            Doc.bind(inputField, 'wheel', () => { }, { passive: true });
        }
    }
    // showFormError can be used to set and display error message on forms.
    static showFormError(el, msg) {
        el.textContent = msg;
        Doc.show(el);
    }
    // showFiatValue displays the fiat equivalent for the provided amount.
    static showFiatValue(display, amount, rate, ui) {
        if (rate) {
            display.textContent = Doc.formatFiatConversion(amount, rate, ui);
            Doc.show(display.parentElement);
        }
        else
            Doc.hide(display.parentElement);
    }
}
/*
 * Animation is a handler for starting and stopping animations.
 */
class Animation {
    constructor(duration, f, easingAlgo, done) {
        this.done = done;
        this.thread = this.run(duration, f, easingAlgo);
    }
    /*
     * run runs the animation function, increasing progress from 0 to 1 in a
     * manner dictated by easingAlgo.
     */
    run(duration, f, easingAlgo) {
        return __awaiter(this, void 0, void 0, function* () {
            duration = duration >= 0 ? duration : 1000 * 86400 * 365 * 10; // 10 years, in ms
            const easer = easingAlgo ? Easing[easingAlgo] : Easing.linear;
            const start = new Date().getTime();
            const end = (duration === Animation.Forever) ? Number.MAX_SAFE_INTEGER : start + duration;
            const range = end - start;
            const frameDuration = 1000 / FPS;
            let now = start;
            this.endAnimation = false;
            while (now < end) {
                if (this.endAnimation)
                    return this.runCompletionFunction();
                f(easer((now - start) / range));
                yield sleep(frameDuration);
                now = new Date().getTime();
            }
            f(1);
            this.runCompletionFunction();
        });
    }
    /* wait returns a promise that will resolve when the animation completes. */
    wait() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.thread;
        });
    }
    /* stop schedules the animation to exit at its next frame. */
    stop() {
        this.endAnimation = true;
    }
    /*
     * stopAndWait stops the animations and returns a promise that will resolve
     * when the animation exits.
     */
    stopAndWait() {
        return __awaiter(this, void 0, void 0, function* () {
            this.stop();
            yield this.wait();
        });
    }
    /* runCompletionFunction runs any registered callback function */
    runCompletionFunction() {
        if (this.done)
            this.done();
    }
}
Animation.Forever = -1;
/* Easing algorithms for animations. */
const Easing = {
    linear: t => t,
    easeIn: t => t * t,
    easeOut: t => t * (2 - t),
    easeInHard: t => t * t * t,
    easeOutHard: t => (--t) * t * t + 1,
    easeOutElastic: t => {
        const c4 = (2 * Math.PI) / 3;
        return t === 0
            ? 0
            : t === 1
                ? 1
                : Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * c4) + 1;
    }
};
/* WalletIcons are used for controlling wallets in various places. */
class WalletIcons {
    constructor(box) {
        const stateElement = (name) => box.querySelector(`[data-state=${name}]`);
        this.icons = {};
        this.icons.sleeping = stateElement('sleeping');
        this.icons.locked = stateElement('locked');
        this.icons.unlocked = stateElement('unlocked');
        this.icons.nowallet = stateElement('nowallet');
        this.icons.syncing = stateElement('syncing');
        this.icons.nopeers = stateElement('nopeers');
        this.icons.disabled = stateElement('disabled');
        this.status = stateElement('status');
    }
    /* sleeping sets the icons to indicate that the wallet is not connected. */
    sleeping() {
        const i = this.icons;
        Doc.hide(i.locked, i.unlocked, i.nowallet, i.syncing, i.disabled);
        Doc.show(i.sleeping);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_OFF);
    }
    /*
     * locked sets the icons to indicate that the wallet is connected, but locked.
     */
    locked() {
        const i = this.icons;
        Doc.hide(i.unlocked, i.nowallet, i.sleeping, i.disabled);
        Doc.show(i.locked);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_LOCKED);
    }
    /*
     * unlocked sets the icons to indicate that the wallet is connected and
     * unlocked.
     */
    unlocked() {
        const i = this.icons;
        Doc.hide(i.locked, i.nowallet, i.sleeping, i.disabled);
        Doc.show(i.unlocked);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_READY);
    }
    /* nowallet sets the icons to indicate that no wallet exists. */
    nowallet() {
        const i = this.icons;
        Doc.hide(i.locked, i.unlocked, i.sleeping, i.syncing, i.disabled);
        Doc.show(i.nowallet);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_NO_WALLET);
    }
    /* set the icons to indicate that the wallet is disabled */
    disabled() {
        const i = this.icons;
        Doc.hide(i.locked, i.unlocked, i.sleeping, i.syncing, i.nowallet, i.nopeers);
        Doc.show(i.disabled);
        i.disabled.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_DISABLED_MSG);
    }
    setSyncing(wallet) {
        const syncIcon = this.icons.syncing;
        if (!wallet || !wallet.running || wallet.disabled) {
            Doc.hide(syncIcon);
            return;
        }
        if (wallet.peerCount === 0) {
            Doc.show(this.icons.nopeers);
            Doc.hide(syncIcon); // potentially misleading with no peers
            return;
        }
        Doc.hide(this.icons.nopeers);
        if (!wallet.synced) {
            Doc.show(syncIcon);
            syncIcon.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_WALLET_SYNC_PROGRESS, { syncProgress: (wallet.syncProgress * 100).toFixed(1) });
            return;
        }
        Doc.hide(syncIcon);
    }
    /* reads the core.Wallet state and sets the icon visibility. */
    readWallet(wallet) {
        this.setSyncing(wallet);
        if (!wallet)
            return this.nowallet();
        switch (true) {
            case (wallet.disabled):
                this.disabled();
                break;
            case (!wallet.running):
                this.sleeping();
                break;
            case (!wallet.open):
                this.locked();
                break;
            case (wallet.open):
                this.unlocked();
                break;
            default:
                console.error('wallet in unknown state', wallet);
        }
    }
}
/*
 * AniToggle is a small toggle switch, defined in HTML with the element
 * <div class="anitoggle"></div>. The animations are defined in the anitoggle
 * CSS class. AniToggle triggers the callback on click events, but does not
 * update toggle appearance, so the caller must call the setState method from
 * the callback or elsewhere if the newState
 * is accepted.
 */
class AniToggle {
    constructor(toggle, errorEl, initialState, callback) {
        this.toggle = toggle;
        if (toggle.children.length === 0)
            toggle.appendChild(document.createElement('div'));
        Doc.bind(toggle, 'click', (e) => __awaiter(this, void 0, void 0, function* () {
            e.stopPropagation();
            Doc.hide(errorEl);
            const newState = !toggle.classList.contains('on');
            this.toggling = true;
            try {
                yield callback(newState);
            }
            catch (e) {
                this.toggling = false;
                Doc.show(errorEl);
                errorEl.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_API_ERROR, { msg: e.msg || String(e) });
                return;
            }
            this.toggling = false;
        }));
        this.setState(initialState);
    }
    setState(state) {
        if (state)
            this.toggle.classList.add('on');
        else
            this.toggle.classList.remove('on');
    }
}
/* sleep can be used by async functions to pause for a specified period. */
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}
const aYear = 31536000000;
const aMonth = 2592000000;
const aDay = 86400000;
const anHour = 3600000;
const aMinute = 60000;
/* timeMod returns the quotient and remainder of t / dur. */
function timeMod(t, dur) {
    const n = Math.floor(t / dur);
    return [n, t - n * dur];
}
function formatSigFigsWithFormatters(intFormatter, sigFigFormatter, n, maxDecimals, locales) {
    var _a, _b;
    if (n >= 1000)
        return intFormatter.format(n);
    const s = sigFigFormatter.format(n);
    if (typeof maxDecimals !== 'number')
        return s;
    const fractional = (_b = (_a = sigFigFormatter.formatToParts(n).filter((part) => part.type === 'fraction')[0]) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : '';
    if (fractional.length <= maxDecimals)
        return s;
    return fullPrecisionFormatter(maxDecimals, locales).format(n);
}
if (true) {
    // Code will only appear in dev build.
    // https://webpack.js.org/guides/production/
    window.testFormatFourSigFigs = () => {
        const tests = [
            ['en-US', '1.234567', undefined, '1.235'],
            ['en-US', '1.234567', 2, '1.23'],
            ['en-US', '1234', undefined, '1,234.0'],
            ['en-US', '12', undefined, '12.00'],
            ['fr-FR', '123.45678', undefined, '123,5'],
            ['fr-FR', '1234.5', undefined, '1â€¯234,5'],
            // For Arabic, https://www.saitak.com/number is useful, but seems to use
            // slightly different unicode points and no thousands separator. I think
            // the Arabic decimal separator is supposed to be more like a point, not
            // a comma, but Google Chrome uses U+066B (Arabic Decimal Separator),
            // which looks like a comma to me. Â¯\_(ãƒ„)_/Â¯
            ['ar-EG', '123.45678', undefined, 'Ù¡Ù¢Ù£Ù«Ù¥'],
            ['ar-EG', '1234', undefined, 'Ù¡Ù¬Ù¢Ù£Ù¤Ù«Ù '],
            ['ar-EG', '0.12345', 3, 'Ù Ù«Ù¡Ù¢Ù£']
        ];
        // Reproduce the NumberFormats with ONLY our desired language.
        for (const [code, unformatted, maxDecimals, expected] of tests) {
            const intFormatter = new Intl.NumberFormat(code, {
                minimumFractionDigits: 1,
                maximumFractionDigits: 1
            });
            const sigFigFormatter = new Intl.NumberFormat(code, {
                minimumSignificantDigits: 4,
                maximumSignificantDigits: 4
            });
            for (const k in decimalFormatters)
                delete decimalFormatters[k]; // cleanup
            for (const k in fullPrecisionFormatters)
                delete fullPrecisionFormatters[k]; // cleanup
            const s = formatSigFigsWithFormatters(intFormatter, sigFigFormatter, parseFloatDefault(unformatted), maxDecimals, code);
            if (s !== expected)
                console.log(`TEST FAILED: f('${code}', ${unformatted}, ${maxDecimals}) => '${s}' != '${expected}'}`);
            else
                console.log(`âœ”ï¸ f('${code}', ${unformatted}, ${maxDecimals}) => ${s} âœ”ï¸`);
        }
    };
    window.testFormatRateFullPrecision = () => {
        const tests = [
            // Two utxo assets with a conventional rate of 0.15. Conventional rate
            // step is 100 / 1e8 = 1e-6, so there should be 6 decimal digits.
            [1.5e7, 100, 1e8, 1e8, '0.150000'],
            // USDC quote -> utxo base with a rate of $10 / 1 XYZ. USDC has an
            // conversion factor of 1e6, so $10 encodes to 1e7, 1 XYZ encodes to 1e8,
            // encoded rate is 1e7 / 1e8 * 1e8 = 1e7, bFactor / qFactor is 1e2.
            // The conventional rate step is 200 / 1e8 * 1e2 = 2e-4, so using
            // rateStepDigits, we should get 4 decimal digits.
            [1e7, 200, 1e6, 1e8, '10.0000'],
            // Set a rate of 1 atom USDC for 0.01 BTC. That atomic rate will be 1 /
            // 1e6 = 1e-6. The encoded rate will be 1e-6 * 1e8 = 1e2. As long as our
            // rate step divides evenly into 100, this should work. The conventional
            // rate is 1e-6 / 1e-2 = 1e-4, so expect 4 decimal digits.
            [1e2, 100, 1e6, 1e8, '0.0001'],
            // DCR-ETH, expect 6 decimals.
            [1.5e7, 1000, 1e9, 1e8, '0.015000'],
            [1e6, 1000, 1e9, 1e8, '0.001000'],
            [1e3, 1000, 1e9, 1e8, '0.000001'],
            [100001000, 1000, 1e9, 1e8, '0.100001'],
            [1000001000, 1000, 1e9, 1e8, '1.000001'],
            // DCR-USDC, expect 3 decimals.
            [1.5e7, 1000, 1e6, 1e8, '15.000'],
            [1e6, 1000, 1e6, 1e8, '1.000'],
            [1e3, 1000, 1e6, 1e8, '0.001'],
            [101000, 1000, 1e6, 1e8, '0.101'],
            [1001000, 1000, 1e6, 1e8, '1.001'],
            // UTXO assets but with a rate step that's not a perfect power of 10.
            // For a rate step of 500, a min rate would be e.g. rate step = 500.
            // 5e2 / 1e8 = 5e-6 = 0.000005
            [5e2, 500, 1e8, 1e8, '0.000005']
        ];
        for (const [encRate, rateStep, qFactor, bFactor, expEncoding] of tests) {
            for (const k in fullPrecisionFormatters)
                delete fullPrecisionFormatters[k]; // cleanup
            const bui = { conventional: { conversionFactor: bFactor } };
            const qui = { conventional: { conversionFactor: qFactor } };
            const enc = Doc.formatRateFullPrecision(encRate, bui, qui, rateStep);
            if (enc !== expEncoding)
                console.log(`TEST FAILED: f(${encRate}, ${bFactor}, ${qFactor}, ${rateStep}) => ${enc} != ${expEncoding}`);
            else
                console.log(`âœ”ï¸ f(${encRate}, ${bFactor}, ${qFactor}, ${rateStep}) => ${enc} âœ”ï¸`);
        }
    };
}
class NumberInput {
    constructor(input, opts) {
        var _a, _b, _c;
        this.input = input;
        this.prec = (_a = opts.prec) !== null && _a !== void 0 ? _a : 0;
        this.fmt = opts.sigFigs ? toFourSigFigs : toPrecision;
        this.changed = (_b = opts.changed) !== null && _b !== void 0 ? _b : (() => { });
        this.set = opts.set;
        this.min = (_c = opts.min) !== null && _c !== void 0 ? _c : 0;
        Doc.bind(input, 'change', () => { this.inputChanged(); });
    }
    inputChanged() {
        const { changed } = this;
        if (changed)
            changed(this.value());
    }
    setValue(v) {
        this.input.value = String(v);
        v = this.value();
        if (this.set)
            this.set(v, this.input.value);
    }
    value() {
        const { input, min, prec, fmt } = this;
        const rawV = Math.max(parseFloatDefault(input.value, min !== null && min !== void 0 ? min : 0), min !== null && min !== void 0 ? min : 0);
        const [v, s] = fmt(rawV, prec !== null && prec !== void 0 ? prec : 0);
        input.value = s;
        return v;
    }
}
class IncrementalInput extends NumberInput {
    constructor(box, opts) {
        var _a;
        super(Doc.safeSelector(box, 'input'), opts);
        this.opts = opts;
        this.inc = (_a = opts.inc) !== null && _a !== void 0 ? _a : 1;
        const up = Doc.safeSelector(box, '.ico-arrowup');
        const down = Doc.safeSelector(box, '.ico-arrowdown');
        Doc.bind(up, 'click', () => { this.increment(1); });
        Doc.bind(down, 'click', () => { this.increment(-1); });
    }
    setIncrementAndMinimum(inc, min) {
        this.inc = inc;
        this.min = min;
    }
    increment(sign) {
        const { inc, min, input } = this;
        input.value = String(Math.max(this.value() + sign * inc, min));
        this.inputChanged();
    }
}
class MiniSlider {
    constructor(box, changed) {
        this.changed = changed;
        this.r = 0;
        const color = document.createElement('div');
        color.dataset.tmpl = 'color';
        box.appendChild(color);
        const track = this.track = document.createElement('div');
        track.dataset.tmpl = 'track';
        color.appendChild(track);
        const ball = this.ball = document.createElement('div');
        ball.dataset.tmpl = 'ball';
        track.appendChild(ball);
        Doc.bind(box, 'mousedown', (e) => {
            if (e.button !== 0)
                return;
            e.preventDefault();
            e.stopPropagation();
            const startX = e.pageX;
            const w = track.clientWidth;
            const startLeft = this.r * w;
            const left = (ee) => Math.max(Math.min(startLeft + (ee.pageX - startX), w), 0);
            const trackMouse = (ee) => {
                ee.preventDefault();
                const l = left(ee);
                this.r = l / w;
                ball.style.left = `${this.r * 100}%`;
                this.changed(this.r);
            };
            const mouseUp = (ee) => {
                trackMouse(ee);
                Doc.unbind(document, 'mousemove', trackMouse);
                Doc.unbind(document, 'mouseup', mouseUp);
            };
            Doc.bind(document, 'mousemove', trackMouse);
            Doc.bind(document, 'mouseup', mouseUp);
        });
        Doc.bind(box, 'click', (e) => {
            if (e.button !== 0)
                return;
            const x = e.pageX;
            const m = Doc.layoutMetrics(track);
            this.r = clamp((x - m.bodyLeft) / m.width, 0, 1);
            ball.style.left = `${this.r * m.width}px`;
            this.changed(this.r);
        });
    }
    setValue(r) {
        this.r = clamp(r, 0, 1);
        this.ball.style.left = `${this.r * 100}%`;
    }
}
function toPrecision(v, prec) {
    const ord = Math.pow(10, prec !== null && prec !== void 0 ? prec : 0);
    v = Math.round(v * ord) / ord;
    let s = v.toFixed(prec);
    if (prec > 0) {
        while (s.endsWith('0'))
            s = s.substring(0, s.length - 1);
        if (s.endsWith('.'))
            s = s.substring(0, s.length - 1);
    }
    return [v, s];
}
function toFourSigFigs(v, maxPrec) {
    const ord = Math.floor(Math.log10(Math.abs(v)));
    if (ord >= 3)
        return [Math.round(v), v.toFixed(0)];
    const prec = Math.min(4 - ord, maxPrec);
    return toPrecision(v, prec);
}
function parseFloatDefault(inputValue, defaultValue) {
    const v = parseFloat((inputValue !== null && inputValue !== void 0 ? inputValue : '').replace(/,/g, ''));
    if (!isNaN(v))
        return v;
    return defaultValue !== null && defaultValue !== void 0 ? defaultValue : 0;
}
/* clamp returns v if min <= v <= max, else min or max. */
function clamp(v, min, max) {
    if (v < min)
        return min;
    if (v > max)
        return max;
    return v;
}
function setupCopyBtn(txt, textEl, btnEl, color) {
    return __awaiter(this, void 0, void 0, function* () {
        try {
            yield navigator.clipboard.writeText(txt);
        }
        catch (err) {
            console.error('Unable to copy: ', err);
        }
        const textOriginalColor = textEl.style.color;
        const btnOriginalColor = btnEl.style.color;
        textEl.style.color = color;
        btnEl.style.color = color;
        setTimeout(() => {
            textEl.style.color = textOriginalColor;
            btnEl.style.color = btnOriginalColor;
        }, 350);
    });
}


/***/ }),

/***/ "./src/js/forms.ts":
/*!*************************!*\
  !*** ./src/js/forms.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AccelerateOrderForm": () => (/* binding */ AccelerateOrderForm),
/* harmony export */   "AppPassResetForm": () => (/* binding */ AppPassResetForm),
/* harmony export */   "CEXConfigurationForm": () => (/* binding */ CEXConfigurationForm),
/* harmony export */   "CertificatePicker": () => (/* binding */ CertificatePicker),
/* harmony export */   "ConfirmRegistrationForm": () => (/* binding */ ConfirmRegistrationForm),
/* harmony export */   "DEXAddressForm": () => (/* binding */ DEXAddressForm),
/* harmony export */   "DepositAddress": () => (/* binding */ DepositAddress),
/* harmony export */   "DiscoverAccountForm": () => (/* binding */ DiscoverAccountForm),
/* harmony export */   "FeeAssetSelectionForm": () => (/* binding */ FeeAssetSelectionForm),
/* harmony export */   "Forms": () => (/* binding */ Forms),
/* harmony export */   "LoginForm": () => (/* binding */ LoginForm),
/* harmony export */   "NewWalletForm": () => (/* binding */ NewWalletForm),
/* harmony export */   "TokenApprovalForm": () => (/* binding */ TokenApprovalForm),
/* harmony export */   "WalletConfigForm": () => (/* binding */ WalletConfigForm),
/* harmony export */   "WalletWaitForm": () => (/* binding */ WalletWaitForm),
/* harmony export */   "bind": () => (/* binding */ bind),
/* harmony export */   "showSuccess": () => (/* binding */ showSuccess),
/* harmony export */   "slideSwap": () => (/* binding */ slideSwap)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./account */ "./src/js/account.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};










class Forms {
    constructor(formsDiv, cfg) {
        this.formsDiv = formsDiv;
        this.closed = cfg === null || cfg === void 0 ? void 0 : cfg.closed;
        formsDiv.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { this.close(); });
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(formsDiv, 'mousedown', (e) => {
            if (!this.currentForm)
                return;
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                this.close();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                this.close();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
    }
    /* showForm shows a modal form with a little animation. */
    show(form) {
        return __awaiter(this, void 0, void 0, function* () {
            this.currentForm = form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(...Array.from(this.formsDiv.children));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.formsDiv, form);
            const shift = (this.formsDiv.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    close() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.formsDiv);
        if (this.closed)
            this.closed();
        this.currentForm = undefined;
    }
    exit() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
}
/*
 * NewWalletForm should be used with the "newWalletForm" template. The enclosing
 * <form> element should be the first argument of the constructor.
 */
class NewWalletForm {
    constructor(form, success, backFunc) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        if (backFunc) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.goBack);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.goBack, 'click', () => { backFunc(); });
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.walletTabTmpl);
        page.walletTabTmpl.removeAttribute('id');
        // WalletConfigForm will set the global app variable.
        this.subform = new WalletConfigForm(page.walletSettings, true);
        this.walletCfgGuide = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'walletCfgGuide');
        bind(form, page.submitAdd, () => this.submit());
        bind(form, page.oneBttn, () => this.submit());
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            walletstate: (note) => { this.reportWalletState(note.wallet); },
            walletsync: (note) => { if (this.parentSyncer)
                this.parentSyncer((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[note.assetID]); },
            createwallet: (note) => { this.reportCreationUpdate(note); }
        });
    }
    /*
     * reportWalletState should be called when a 'walletstate' notification is
     * received.
     * TODO: Let form classes register for notifications.
     */
    reportWalletState(w) {
        if (this.parentSyncer)
            this.parentSyncer(w);
    }
    /*
     * reportWalletState should be called when a 'createwallet' notification is
     * received.
     */
    reportCreationUpdate(note) {
        if (this.createUpdater)
            this.createUpdater(note);
    }
    createWallet(assetID, walletType, parentForm) {
        return __awaiter(this, void 0, void 0, function* () {
            const createForm = {
                assetID: assetID,
                pass: this.page.newWalletPass.value || '',
                config: this.subform.map(assetID),
                walletType: walletType,
                parentForm: parentForm
            };
            const ani = new _charts__WEBPACK_IMPORTED_MODULE_4__.Wave(this.form, { backgroundColor: true });
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/newwallet', createForm);
            ani.stop();
            return res;
        });
    }
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const newWalletPass = page.newWalletPass;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.newWalletErr);
            const { asset, parentAsset } = this.current;
            const selectedDef = this.current.selectedDef;
            let parentForm;
            let walletType = selectedDef.type;
            if (parentAsset) {
                walletType = asset.token.definition.type;
                parentForm = {
                    assetID: parentAsset.id,
                    config: this.subform.map(parentAsset.id),
                    walletType: selectedDef.type
                };
            }
            // Register the selected asset.
            const res = yield this.createWallet(asset.id, walletType, parentForm);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                this.setError(res.msg);
                return;
            }
            newWalletPass.value = '';
            if (parentAsset)
                yield this.runParentSync();
            else
                this.success(this.current.asset.id);
        });
    }
    /*
     * runParentSync shows a syncing sub-dialog that tracks the parent asset's
     * syncProgress and informs the user that the token wallet will be created
     * after sync is complete.
     */
    runParentSync() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, current: { parentAsset, asset } } = this;
            if (!parentAsset)
                return;
            page.parentSyncPct.textContent = '0';
            page.parentName.textContent = parentAsset.name;
            page.parentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
            page.childName.textContent = asset.name;
            page.childLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mainForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.parentSyncing);
            try {
                yield this.syncParent(parentAsset);
                this.success(this.current.asset.id);
            }
            catch (error) {
                this.setError(error.message || error);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mainForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.parentSyncing);
        });
    }
    /*
     * syncParent monitors the sync progress of a token's parent asset, generating
     * an Error if the token wallet creation does not complete successfully.
     */
    syncParent(parentAsset) {
        const { page, current: { asset } } = this;
        return new Promise((resolve, reject) => {
            // First, check if it's already synced.
            const w = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[parentAsset.id].wallet;
            if (w && w.synced)
                return resolve();
            // Not synced, so create a syncer to update the parent sync pane.
            this.parentSyncer = (w) => {
                if (w.assetID !== parentAsset.id)
                    return;
                page.parentSyncPct.textContent = (w.syncProgress * 100).toFixed(1);
            };
            // Handle the async result.
            this.createUpdater = (note) => {
                if (note.assetID !== asset.id)
                    return;
                switch (note.topic) {
                    case 'QueuedCreationFailed':
                        reject(new Error(`${note.subject}: ${note.details}`));
                        break;
                    case 'QueuedCreationSuccess':
                        resolve();
                        break;
                    default:
                        return;
                }
                this.parentSyncer = null;
                this.createUpdater = null;
            };
        });
    }
    /* setAsset sets the current asset of the NewWalletForm */
    setAsset(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.parseAsset(assetID))
                return; // nothing to change
            const page = this.page;
            const tabs = page.walletTypeTabs;
            const { winfo, asset, parentAsset } = this.current;
            page.assetName.textContent = winfo.name;
            page.newWalletPass.value = '';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tabs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tabs, page.newWalletErr, page.tokenMsgBox);
            this.page.assetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            if (parentAsset) {
                page.tokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                page.tokenParentName.textContent = parentAsset.name;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.tokenMsgBox);
            }
            const pinfo = parentAsset ? parentAsset.info : null;
            const walletDefs = pinfo ? pinfo.availablewallets : winfo.availablewallets ? winfo.availablewallets : [winfo.definition];
            if (walletDefs.length > 1) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tabs);
                for (const wDef of walletDefs) {
                    const tab = page.walletTabTmpl.cloneNode(true);
                    tab.dataset.tooltip = wDef.description;
                    tab.textContent = wDef.tab;
                    tabs.appendChild(tab);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tab, 'click', () => {
                        for (const t of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].kids(tabs))
                            t.classList.remove('selected');
                        tab.classList.add('selected');
                        this.update(wDef);
                    });
                }
                (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().bindTooltips(tabs);
                const first = tabs.firstChild;
                first.classList.add('selected');
            }
            yield this.update(this.current.selectedDef);
            if (asset.walletCreationPending)
                yield this.runParentSync();
        });
    }
    /*
    * parseAsset parses the current data for the asset ID.
    */
    parseAsset(assetID) {
        if (this.current && this.current.asset.id === assetID)
            return false;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const token = asset.token;
        if (!token) {
            if (!asset.info)
                throw Error('this non-token asset has no wallet info!');
            this.current = { asset, winfo: asset.info, selectedDef: asset.info.availablewallets[0] };
            return true;
        }
        const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.assets[token.parentID];
        if (parentAsset.wallet) {
            // If the parent asset already has a wallet, there's no need to configure
            // the parent too. Just configure the token.
            this.current = { asset, winfo: token, selectedDef: token.definition };
            return true;
        }
        if (!parentAsset.info)
            throw Error('this parent has no wallet info!');
        this.current = { asset, parentAsset, winfo: token, selectedDef: parentAsset.info.availablewallets[0] };
        return true;
    }
    update(walletDef) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.current.selectedDef = walletDef;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.walletPassAndSubmitBttn, page.oneBttnBox, page.newWalletPassBox);
            const guideLink = walletDef.guidelink;
            const configOpts = walletDef.configopts || [];
            // If a config represents a wallet's birthday, we update the default
            // selection to the current date if this installation of the client
            // generated a seed.
            configOpts.map((opt) => {
                if (opt.isBirthdayConfig && (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().seedGenTime > 0) {
                    opt.default = toUnixDate(new Date());
                }
                return opt;
            });
            // Either this is a walletDef for a token's uncreated parent asset, or this
            // is the definition for the token.
            let containsRequired = false;
            for (const opt of configOpts) {
                if (opt.required) {
                    containsRequired = true;
                    break;
                }
            }
            const { asset, parentAsset, winfo } = this.current;
            const displayCreateBtn = walletDef.seeded || Boolean(asset.token);
            if (displayCreateBtn && !containsRequired) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.walletSettingsHeader);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.oneBttnBox);
            }
            else if (displayCreateBtn) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletPassAndSubmitBttn, page.walletSettingsHeader);
                page.newWalletPass.value = '';
                page.submitAdd.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_CREATE);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletPassAndSubmitBttn, page.walletSettingsHeader);
                if (!walletDef.noauth)
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.newWalletPassBox);
                page.submitAdd.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ADD);
            }
            if (parentAsset) {
                const parentAndTokenOpts = JSON.parse(JSON.stringify(configOpts));
                // Add the regAsset field to the configurations so proper logos will be displayed
                // next to them, and map can filter them out. The opts are copied here so the originals
                // do not have the regAsset field added to them.
                for (const opt of parentAndTokenOpts)
                    opt.regAsset = parentAsset.id;
                const tokenOpts = winfo.definition.configopts || [];
                if (tokenOpts.length > 0) {
                    const tokenOptsCopy = JSON.parse(JSON.stringify(tokenOpts));
                    for (const opt of tokenOptsCopy)
                        opt.regAsset = asset.id;
                    parentAndTokenOpts.push(...tokenOptsCopy);
                }
                this.subform.update(asset.id, parentAndTokenOpts, false);
            }
            else
                this.subform.update(asset.id, configOpts, false);
            this.setGuideLink(guideLink);
            // A seeded or token wallet is internal to Bison Wallet and as such does
            // not have an external config file to select.
            if (walletDef.seeded || Boolean(this.current.asset.token))
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.subform.fileSelector);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.subform.fileSelector);
            yield this.loadDefaults();
        });
    }
    setGuideLink(guideLink) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.walletCfgGuide);
        if (guideLink !== '') {
            this.walletCfgGuide.href = guideLink;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.walletCfgGuide);
        }
    }
    /* setError sets and shows the in-form error message. */
    setError(errMsg) {
        return __awaiter(this, void 0, void 0, function* () {
            this.page.newWalletErr.textContent = errMsg;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.newWalletErr);
        });
    }
    /*
     * loadDefaults attempts to load the ExchangeWallet configuration from the
     * default wallet config path on the server and will auto-fill the page on
     * the subform if settings are found.
     */
    loadDefaults() {
        return __awaiter(this, void 0, void 0, function* () {
            // No default config files for seeded assets right now.
            const { asset, parentAsset, selectedDef } = this.current;
            if (!selectedDef.configpath)
                return;
            let configID = asset.id;
            if (parentAsset) {
                if (selectedDef.seeded)
                    return;
                configID = parentAsset.id;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/defaultwalletcfg', {
                assetID: configID,
                type: selectedDef.type
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                this.setError(res.msg);
                return;
            }
            this.subform.setLoadedConfig(res.config);
        });
    }
}
let dynamicInputCounter = 0;
/*
 * WalletConfigForm is a dynamically generated sub-form for setting
 * asset-specific wallet configuration options.
*/
class WalletConfigForm {
    constructor(form, sectionize) {
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        this.form = form;
        // A configElement is a div containing an input and its label.
        this.configElements = [];
        // configOpts is the wallet options provided by core.
        this.configOpts = [];
        this.sectionize = sectionize;
        // Get template elements
        this.allSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'allSettings');
        this.dynamicOpts = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'dynamicOpts');
        this.textInputTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'textInput');
        this.textInputTmpl.remove();
        this.dateInputTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'dateInput');
        this.dateInputTmpl.remove();
        this.checkboxTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'checkbox');
        this.checkboxTmpl.remove();
        this.repeatableTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'repeatableInput');
        this.repeatableTmpl.remove();
        this.fileSelector = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'fileSelector');
        this.fileInput = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'fileInput');
        this.errMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'errMsg');
        this.showOther = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'showOther');
        this.showIcon = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'showIcon');
        this.hideIcon = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'hideIcon');
        this.showHideMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'showHideMsg');
        this.otherSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'otherSettings');
        this.loadedSettingsMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'loadedSettingsMsg');
        this.loadedSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'loadedSettings');
        this.defaultSettingsMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'defaultSettingsMsg');
        this.defaultSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'defaultSettings');
        if (!sectionize)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showOther);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.fileSelector, 'click', () => this.fileInput.click());
        // config file upload
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.fileInput, 'change', () => __awaiter(this, void 0, void 0, function* () { return this.fileInputChanged(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.showOther, 'click', () => {
            this.setOtherSettingsViz(this.hideIcon.classList.contains('d-hide'));
        });
    }
    /*
     * fileInputChanged will read the selected file and attempt to load the
     * configuration settings. All loaded settings will be made visible for
     * inspection by the user.
     */
    fileInputChanged() {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.errMsg);
            if (!this.fileInput.value)
                return;
            const files = this.fileInput.files;
            if (!files || files.length === 0)
                return;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const config = yield files[0].text();
            if (!config)
                return;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/parseconfig', {
                configtext: config
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                this.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.errMsg);
                return;
            }
            if (Object.keys(res.map).length === 0)
                return;
            this.dynamicOpts.append(...this.setConfig(res.map));
            this.reorder(this.dynamicOpts);
            const [loadedOpts, defaultOpts] = [this.loadedSettings.children.length, this.defaultSettings.children.length];
            if (loadedOpts === 0)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.loadedSettings, this.loadedSettingsMsg);
            if (defaultOpts === 0)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.defaultSettings, this.defaultSettingsMsg);
            if (loadedOpts + defaultOpts === 0)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showOther, this.otherSettings);
        });
    }
    addOpt(box, opt, insertAfter, skipRepeatN) {
        var _a;
        let el;
        if (opt.isboolean)
            el = this.checkboxTmpl.cloneNode(true);
        else if (opt.isdate)
            el = this.dateInputTmpl.cloneNode(true);
        else if (opt.repeatable) {
            el = this.repeatableTmpl.cloneNode(true);
            el.classList.add('repeatable');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(el, 'add'), 'click', () => {
                this.addOpt(box, opt, el, true);
            });
            if (!skipRepeatN)
                for (let i = 0; i < (opt.repeatN ? opt.repeatN - 1 : 0); i++)
                    this.addOpt(box, opt, insertAfter, true);
        }
        else
            el = this.textInputTmpl.cloneNode(true);
        const hiddenFields = ((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().extensionWallet(this.assetID)) === null || _a === void 0 ? void 0 : _a.hiddenFields) || [];
        if (hiddenFields.indexOf(opt.key) !== -1)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(el);
        this.configElements.push([opt, el]);
        const input = el.querySelector('input');
        input.dataset.configKey = opt.key;
        // We need to generate a unique ID only for the <input id> => <label for>
        // matching.
        dynamicInputCounter++;
        const elID = 'wcfg-' + String(dynamicInputCounter);
        input.id = elID;
        const label = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'label');
        label.htmlFor = elID; // 'for' attribute, but 'for' is a keyword
        label.prepend(opt.displayname);
        if (opt.regAsset !== undefined) {
            const logo = new window.Image(15, 15);
            logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(opt.regAsset || -1);
            label.prepend(logo);
        }
        if (insertAfter)
            insertAfter.after(el);
        else
            box.appendChild(el);
        if (opt.noecho) {
            input.type = 'password';
            input.autocomplete = 'off';
        }
        if (opt.description)
            label.dataset.tooltip = opt.description;
        if (opt.isboolean)
            input.checked = opt.default;
        else if (opt.isdate) {
            const getMinMaxVal = (minMax) => {
                if (!minMax)
                    return '';
                if (minMax === 'now')
                    return dateToString(new Date());
                return dateToString(new Date(minMax * 1000));
            };
            input.max = getMinMaxVal(opt.max);
            input.min = getMinMaxVal(opt.min);
            const date = opt.default ? new Date(opt.default * 1000) : new Date();
            // UI shows Dates in valueAsDate as UTC, but user interprets local. Set a
            // local date string so the UI displays what the user expects. alt:
            // input.valueAsDate = dateApplyOffset(date)
            input.value = dateToString(date);
        }
        else
            input.value = opt.default !== null ? opt.default : '';
        input.disabled = Boolean(opt.disablewhenactive && this.assetHasActiveOrders);
        return el;
    }
    /*
     * update creates the dynamic form.
     */
    update(assetID, configOpts, activeOrders) {
        this.assetHasActiveOrders = activeOrders;
        this.configElements = [];
        this.configOpts = configOpts || [];
        this.assetID = assetID;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.dynamicOpts, this.defaultSettings, this.loadedSettings);
        // If there are no options, just hide the entire form.
        if (this.configOpts.length === 0)
            return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.form);
        this.setOtherSettingsViz(false);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.loadedSettingsMsg, this.loadedSettings, this.defaultSettingsMsg, this.defaultSettings, this.errMsg);
        const defaultedOpts = [];
        for (const opt of this.configOpts) {
            if (this.sectionize && opt.default !== null)
                defaultedOpts.push(opt);
            else
                this.addOpt(this.dynamicOpts, opt);
        }
        if (defaultedOpts.length) {
            for (const opt of defaultedOpts)
                this.addOpt(this.defaultSettings, opt);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.showOther, this.defaultSettingsMsg, this.defaultSettings);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showOther);
        }
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().bindTooltips(this.allSettings);
        if (this.dynamicOpts.children.length)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.dynamicOpts);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.dynamicOpts);
    }
    /*
     * setOtherSettingsViz sets the visibility of the additional settings section.
     */
    setOtherSettingsViz(visible) {
        if (visible) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showIcon);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.hideIcon, this.otherSettings);
            this.showHideMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_HIDE_ADDITIONAL_SETTINGS);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.hideIcon, this.otherSettings);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.showIcon);
        this.showHideMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_SHOW_ADDITIONAL_SETTINGS);
    }
    /*
     * setConfig looks for inputs with configOpt keys matching the cfg object, and
     * sets the inputs value to the corresponding cfg value. A list of matching
     * configElements is returned.
     */
    setConfig(cfg) {
        const finds = [];
        const handledRepeatables = {};
        const removes = [];
        for (const r of [...this.configElements]) {
            const [opt, el] = r;
            const v = cfg[opt.key];
            if (v === undefined)
                continue;
            if (opt.repeatable) {
                if (handledRepeatables[opt.key]) {
                    el.remove();
                    removes.push(r);
                    continue;
                }
                handledRepeatables[opt.key] = true;
                const vals = v.split(opt.repeatable);
                const firstVal = vals[0];
                finds.push(el);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'input').value = firstVal;
                // Add repeatN - 1 empty elements to the reconfig form. Add them before
                // the populated inputs just because of the way we're using the
                // insertAfter argument to addOpt.
                for (let i = 1; i < (opt.repeatN || 1); i++)
                    finds.push(this.addOpt(el.parentElement, opt, el, true));
                for (let i = 1; i < vals.length; i++) {
                    const newEl = this.addOpt(el.parentElement, opt, el, true);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(newEl, 'input').value = vals[i];
                    finds.push(newEl);
                }
                continue;
            }
            finds.push(el);
            const input = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'input');
            if (opt.isboolean)
                input.checked = isTruthyString(v);
            else if (opt.isdate) {
                input.value = dateToString(new Date(parseInt(v) * 1000));
                // alt: input.valueAsDate = dateApplyOffset(...)
            }
            else
                input.value = v;
        }
        for (const r of removes) {
            const i = this.configElements.indexOf(r);
            if (i >= 0)
                this.configElements.splice(i, 1);
        }
        return finds;
    }
    /*
     * setLoadedConfig sets the input values for the entries in cfg, and moves
     * them to the loadedSettings box.
     */
    setLoadedConfig(cfg) {
        const finds = this.setConfig(cfg);
        if (!this.sectionize || finds.length === 0)
            return;
        this.loadedSettings.append(...finds);
        this.reorder(this.loadedSettings);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.loadedSettings, this.loadedSettingsMsg);
        if (this.defaultSettings.children.length === 0)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.defaultSettings, this.defaultSettingsMsg);
    }
    /*
     * map reads all inputs and constructs an object from the configOpt keys and
     * values.
     */
    map(assetID) {
        const config = {};
        for (const [opt, el] of this.configElements) {
            const input = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'input');
            if (opt.regAsset !== undefined && opt.regAsset !== assetID)
                continue;
            if (opt.isboolean && opt.key) {
                config[opt.key] = input.checked ? '1' : '0';
            }
            else if (opt.isdate && opt.key) {
                // Force local time interpretation by appending a time to the date
                // string, otherwise the Date constructor considers it UTC.
                const minDate = input.min ? toUnixDate(new Date(input.min + 'T00:00')) : Number.MIN_SAFE_INTEGER;
                const maxDate = input.max ? toUnixDate(new Date(input.max + 'T00:00')) : Number.MAX_SAFE_INTEGER;
                let date = input.value ? toUnixDate(new Date(input.value + 'T00:00')) : 0;
                if (date < minDate)
                    date = minDate;
                else if (date > maxDate)
                    date = maxDate;
                config[opt.key] = String(date);
            }
            else if (input.value) {
                if (opt.repeatable && config[opt.key])
                    config[opt.key] += opt.repeatable + input.value;
                else
                    config[opt.key] = input.value;
            }
        }
        return config;
    }
    /*
     * reorder sorts the configElements in the box by the order of the
     * server-provided configOpts array.
     */
    reorder(box) {
        const inputs = {};
        box.querySelectorAll('input').forEach((input) => {
            const k = input.dataset.configKey;
            if (!k)
                return; // TS2538
            const els = [];
            for (const [opt, el] of this.configElements)
                if (opt.key === k)
                    els.push(el);
            inputs[k] = els;
        });
        for (const opt of this.configOpts) {
            const els = inputs[opt.key] || [];
            for (const el of els)
                box.append(el);
        }
    }
}
/*
 * ConfirmRegistrationForm should be used with the "confirmRegistrationForm"
 * template.
 */
class ConfirmRegistrationForm {
    constructor(form, success, goBack) {
        this.form = form;
        this.success = success;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        this.certFile = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.goBack, 'click', () => goBack());
        bind(form, this.page.submit, () => this.submitForm());
    }
    setExchange(xc, certFile) {
        this.xc = xc;
        this.certFile = certFile;
        this.page.host.textContent = xc.host;
    }
    setAsset(assetID, tier, fees) {
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const { conversionFactor, unit } = asset.unitInfo.conventional;
        this.bondAssetID = asset.id;
        this.tier = tier;
        this.fees = fees;
        const page = this.page;
        const bondAsset = this.xc.bondAssets[asset.symbol];
        const bondLock = bondAsset.amount * tier * _account__WEBPACK_IMPORTED_MODULE_5__.bondReserveMultiplier;
        const bondLockConventional = bondLock / conversionFactor;
        page.tradingTier.textContent = String(tier);
        page.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
        page.bondLock.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLockConventional);
        page.bondUnit.textContent = unit;
        const r = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.bondLockUSDBox);
        if (r)
            page.bondLockUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLockConventional * r);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.bondLockUSDBox);
        if (fees)
            page.feeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(fees / conversionFactor);
        page.reservesUnit.textContent = unit;
    }
    setFees(assetID, fees) {
        this.fees = fees;
        const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID].unitInfo.conventional.conversionFactor;
        this.page.feeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(fees / conversionFactor);
    }
    /* Form expands into its space quickly from the lower-right as it fades in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(400, prog => {
                form.style.transform = `scale(${prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
                const offset = `${(1 - prog) * 500}px`;
                form.style.top = offset;
                form.style.left = offset;
            });
        });
    }
    /*
     * submitForm is called when the form is submitted.
     */
    submitForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, bondAssetID, xc, certFile, tier } = this;
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[bondAssetID];
            if (!asset) {
                page.regErr.innerText = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_SELECT_WALLET_FOR_FEE_PAYMENT);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.regErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.regErr);
            const bondAsset = xc.bondAssets[asset.wallet.symbol];
            const dexAddr = xc.host;
            let form;
            let url;
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[xc.host] || (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[xc.host].viewOnly) {
                form = {
                    addr: dexAddr,
                    cert: certFile,
                    bond: bondAsset.amount * tier,
                    asset: bondAsset.id
                };
                url = '/api/postbond';
            }
            else {
                form = {
                    host: dexAddr,
                    targetTier: tier,
                    bondAssetID: bondAssetID
                };
                url = '/api/updatebondoptions';
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)(url, form);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.regErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.regErr);
                return;
            }
            this.success();
        });
    }
}
/*
 * FeeAssetSelectionForm should be used with the "regAssetForm" template.
 */
class FeeAssetSelectionForm {
    constructor(form, success) {
        this.form = form;
        this.certFile = '';
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.currentBondTmpl, page.bondAssetTmpl, page.marketTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tradingTierInput, 'input', () => { this.setTier(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tradingTierInput, 'keyup', (e) => { if (e.key === 'Enter')
            this.acceptTier(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.submitTradingTier, 'click', () => { this.acceptTier(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tierUp, 'click', () => { this.incrementTier(true); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tierDown, 'click', () => { this.incrementTier(false); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.goBackToAssets, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.tradingTierForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.whatsABond, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.assetForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.whatsABondPanel);
        });
        const hideWhatsABond = () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.whatsABondPanel);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.bondGotIt, 'click', () => { hideWhatsABond(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.whatsABondBack, 'click', () => { hideWhatsABond(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.usePrepaidBond, 'click', () => { this.showPrepaidBondForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ppbGoBack, 'click', () => { this.hidePrepaidBondForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.submitPrepaidBond, 'click', () => { this.submitPrepaidBond(); });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            createwallet: (note) => {
                if (note.topic === 'QueuedCreationSuccess')
                    this.walletCreated(note.assetID);
            }
        });
    }
    setTierError(errMsg) {
        this.page.tradingTierErr.textContent = errMsg;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.tradingTierErr);
    }
    setAssetError(errMsg) {
        this.page.regAssetErr.textContent = errMsg;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.regAssetErr);
    }
    clearErrors() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.regAssetErr, this.page.tradingTierErr);
    }
    setExchange(xc, certFile) {
        this.xc = xc;
        this.certFile = certFile;
        this.assetRows = {};
        this.marketRows = [];
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.assetForm, page.tradingTierForm, page.whatsABondPanel, page.prepaidBonds);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.bondAssets, page.markets);
        this.clearErrors();
        const addBondRow = (assetID, bondAsset) => {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            if (!asset)
                return;
            const { unitInfo: { conventional: { unit, conversionFactor } }, name, symbol } = asset;
            const tr = page.bondAssetTmpl.cloneNode(true);
            page.bondAssets.appendChild(tr);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            tmpl.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            tmpl.name.textContent = name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tr, 'click', () => { this.assetSelected(assetID); });
            tmpl.feeSymbol.textContent = unit;
            const bondSizeConventional = bondAsset.amount / conversionFactor;
            tmpl.feeAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondSizeConventional);
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(fiatRate, tmpl.fiatBox);
            if (fiatRate)
                tmpl.fiatBondAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondSizeConventional * fiatRate);
            this.assetRows[assetID] = { ready: tmpl.ready };
        };
        const addMarketRow = (mkt) => {
            const { baseid: baseID, quoteid: quoteID } = mkt;
            const [b, q] = [(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[quoteID]];
            if (!b || !q)
                return;
            const tr = page.marketTmpl.cloneNode(true);
            page.markets.appendChild(tr);
            const { symbol: baseSymbol, unitInfo: bui } = xc.assets[baseID];
            const { symbol: quoteSymbol, unitInfo: qui } = xc.assets[quoteID];
            for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(tr, '[data-base-ticker]'))
                el.textContent = bui.conventional.unit;
            for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(tr, '[data-quote-ticker]'))
                el.textContent = qui.conventional.unit;
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            tmpl.baseLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(baseSymbol);
            tmpl.quoteLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(quoteSymbol);
            const setTier = (tier) => {
                const { parcelsize: parcelSize, lotsize: lotSize } = mkt;
                const conventionalLotSize = lotSize / bui.conventional.conversionFactor;
                const startingLimit = conventionalLotSize * parcelSize * _account__WEBPACK_IMPORTED_MODULE_5__.perTierBaseParcelLimit * tier;
                const privilegedLimit = conventionalLotSize * parcelSize * _account__WEBPACK_IMPORTED_MODULE_5__.perTierBaseParcelLimit * _account__WEBPACK_IMPORTED_MODULE_5__.parcelLimitScoreMultiplier * tier;
                tmpl.tradeLimitLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(startingLimit);
                tmpl.tradeLimitHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(privilegedLimit);
                const baseFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[baseID];
                if (baseFiatRate) {
                    tmpl.fiatTradeLimitLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(startingLimit * baseFiatRate);
                    tmpl.fiatTradeLimitHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(privilegedLimit * baseFiatRate);
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(baseFiatRate, page.fiatTradeLowBox, page.fiatTradeHighBox);
            };
            setTier((0,_account__WEBPACK_IMPORTED_MODULE_5__.strongTier)(xc.auth) || 1);
            this.marketRows.push({ mkt, tmpl, setTier });
        };
        for (const { symbol, id: assetID } of Object.values(xc.assets || {})) {
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID])
                continue;
            const bondAsset = xc.bondAssets[symbol];
            if (bondAsset)
                addBondRow(assetID, bondAsset);
        }
        for (const mkt of Object.values(xc.markets || {}))
            addMarketRow(mkt);
        // page.host.textContent = xc.host
        page.tradingTierInput.value = xc.auth.targetTier ? String(xc.auth.targetTier) : '1';
        if (this.validBondAssetSelected(xc))
            this.assetSelected(xc.auth.bondAssetID);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
    }
    validBondAssetSelected(xc) {
        if (xc.viewOnly)
            return false;
        const { targetTier, bondAssetID } = xc.auth;
        if (targetTier < 1)
            return false;
        const a = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[bondAssetID];
        return a && Boolean(xc.bondAssets[a.symbol]);
    }
    /*
     * walletCreated should be called when an asynchronous wallet creation
     * completes successfully.
     */
    walletCreated(assetID) {
        const a = this.assetRows[assetID];
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        setReadyMessage(a.ready, asset);
    }
    refresh() {
        this.setExchange(this.xc, this.certFile);
    }
    assetSelected(assetID) {
        this.selectedAssetID = assetID;
        this.setTier();
        const { page: { assetForm, tradingTierForm, tradingTierInput } } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(assetForm);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tradingTierForm);
        tradingTierInput.focus();
    }
    setTier() {
        var _a;
        const { page, xc: { bondAssets }, selectedAssetID: assetID } = this;
        const { symbol, unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const { conventional: { conversionFactor, unit } } = ui;
        const bondAsset = bondAssets[symbol];
        const raw = (_a = page.tradingTierInput.value) !== null && _a !== void 0 ? _a : '';
        if (!raw)
            return;
        const tier = parseInt(raw);
        if (isNaN(tier)) {
            this.setTierError(_locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_TIER_VALUE));
            return;
        }
        page.tradingTierInput.value = String(tier);
        page.bondSizeDisplay.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondAsset.amount, ui);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.tradingTierForm, '[data-tier]'))
            el.textContent = String(tier);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.tradingTierForm, '[data-bond-asset-ticker]'))
            el.textContent = unit;
        const bondLock = bondAsset.amount * tier * _account__WEBPACK_IMPORTED_MODULE_5__.bondReserveMultiplier;
        page.bondLockDisplay.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLock, ui);
        const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
        if (fiatRate)
            page.fiatLockDisplay.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLock / conversionFactor * fiatRate);
        for (const m of Object.values(this.marketRows))
            m.setTier(tier);
        const currentBondAmts = {};
        for (const [assetIDStr, { wallet }] of Object.entries((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets)) {
            if (!wallet)
                continue;
            const { balance: { bondlocked, bondReserves } } = wallet;
            const bonded = bondlocked + bondReserves;
            if (bonded > 0)
                currentBondAmts[parseInt(assetIDStr)] = bonded;
        }
        const haveLock = Object.keys(currentBondAmts).length > 0;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(haveLock, page.currentBondBox);
        if (haveLock) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.currentBonds);
            for (const [assetIDStr, bondLocked] of Object.entries(currentBondAmts)) {
                const assetID = parseInt(assetIDStr);
                const { unitInfo: ui, symbol, name } = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
                const { conventional: { conversionFactor, unit } } = ui;
                const tr = page.currentBondTmpl.cloneNode(true);
                page.currentBonds.appendChild(tr);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
                tmpl.icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
                tmpl.name.textContent = name;
                tmpl.amt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLocked, ui);
                tmpl.ticker.textContent = unit;
                tmpl.name.textContent = name;
                const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tmpl.fiatBox);
                if (fiatRate)
                    tmpl.fiatAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLocked / conversionFactor * fiatRate);
            }
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(fiatRate, page.fiatLockBox);
    }
    acceptTier() {
        var _a;
        const { page, selectedAssetID: assetID } = this;
        this.clearErrors();
        const raw = (_a = page.tradingTierInput.value) !== null && _a !== void 0 ? _a : '';
        if (!raw)
            return;
        const tier = parseInt(raw);
        if (isNaN(tier)) {
            this.setTierError(_locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_TIER_VALUE));
            return;
        }
        this.success(assetID, tier);
    }
    incrementTier(up) {
        var _a;
        const { page: { tradingTierInput: input } } = this;
        input.value = String(Math.max(1, (parseInt((_a = input.value) !== null && _a !== void 0 ? _a : '') || 1) + (up ? 1 : -1)));
        this.setTier();
    }
    /*
     * Animation to make the elements sort of expand into their space from the
     * bottom as they fade in.
     */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, form } = this;
            const extraMargin = 75;
            const extraTop = 50;
            const regAssetElements = Array.from(page.bondAssets.children);
            form.style.opacity = '0';
            const aniLen = 350;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(aniLen, prog => {
                for (const el of regAssetElements) {
                    el.style.marginTop = `${(1 - prog) * extraMargin}px`;
                    el.style.transform = `scale(${prog})`;
                }
                form.style.opacity = Math.pow(prog, 4).toFixed(1);
                form.style.top = `${(1 - prog) * extraTop}px`;
            }, 'easeOut');
        });
    }
    showPrepaidBondForm() {
        const { page } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.assetForm, page.prepaidBondErr);
        page.prepaidBondCode.value = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.prepaidBonds);
    }
    hidePrepaidBondForm() {
        const { page } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.prepaidBonds);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
    }
    submitPrepaidBond() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, xc: { host } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.prepaidBondErr);
            const code = page.prepaidBondCode.value;
            if (!code) {
                page.prepaidBondErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_VALUE);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.prepaidBondErr);
                return;
            }
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/redeemprepaidbond', { host, code, cert: this.certFile });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.prepaidBondErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.prepaidBondErr);
                return;
            }
            this.success(_registry__WEBPACK_IMPORTED_MODULE_6__.PrepaidBondID, res.tier);
        });
    }
}
/*
 * setReadyMessage sets an asset's status message on the FeeAssetSelectionForm.
 */
function setReadyMessage(el, asset) {
    if (asset.wallet)
        el.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_WALLET_READY);
    else if (asset.walletCreationPending)
        el.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_WALLET_PENDING);
    else
        el.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_SETUP_NEEDED);
    el.classList.remove('readygreen', 'setuporange');
    el.classList.add(asset.wallet ? 'readygreen' : 'setuporange');
}
/*
 * WalletWaitForm is a form used to track the wallet sync status and balance
 * in preparation for posting a bond.
 */
class WalletWaitForm {
    constructor(form, success, goBack) {
        this.form = form;
        this.success = success;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        this.assetID = -1;
        this.progressCache = [];
        this.progressed = false;
        this.funded = false;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.goBack, 'click', () => {
            this.assetID = -1;
            goBack();
        });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            walletstate: (note) => this.reportWalletState(note.wallet),
            walletsync: (note) => {
                if (note.assetID !== this.assetID)
                    return;
                const w = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[note.assetID];
                this.reportProgress(w.synced, w.syncProgress);
            },
            balance: (note) => this.reportBalance(note.assetID)
        });
    }
    /* setExchange sets the exchange for which the fee is being paid. */
    setExchange(xc) {
        this.xc = xc;
    }
    /* setWallet must be called before showing the WalletWaitForm. */
    setWallet(assetID, bondFeeBuffer, tier) {
        this.assetID = assetID;
        this.progressCache = [];
        this.progressed = false;
        this.funded = false;
        this.bondFeeBuffer = bondFeeBuffer; // in case we're a token, parent's balance must cover
        this.parentAssetSynced = false;
        const page = this.page;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const { symbol, unitInfo: ui, wallet: { balance: bal, address, synced, syncProgress }, token } = asset;
        this.parentID = token === null || token === void 0 ? void 0 : token.parentID;
        const bondAsset = this.bondAsset = this.xc.bondAssets[symbol];
        const symbolize = (el, asset) => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(el);
            el.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset));
        };
        for (const span of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(this.form, '.unit'))
            symbolize(span, asset);
        page.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
        page.depoAddr.textContent = address;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncUncheck, page.syncCheck, page.balUncheck, page.balCheck, page.syncRemainBox, page.bondCostBreakdown);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balanceBox);
        let bondLock = 2 * bondAsset.amount * tier;
        if (bondFeeBuffer > 0) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.bondCostBreakdown);
            page.bondLockNoFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLock, ui);
            page.bondLockFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondFeeBuffer, ui);
            bondLock += bondFeeBuffer;
            const need = Math.max(bondLock - bal.available + bal.reservesDeficit, 0);
            page.totalForBond.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(need, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sendEnough); // generic msg when no fee info available when
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txFeeBox, page.sendEnoughForToken, page.txFeeBalanceBox); // for tokens
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sendEnoughWithEst); // non-tokens
            if (token) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txFeeBox, page.sendEnoughForToken, page.txFeeBalanceBox);
                const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[token.parentID];
                page.txFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondFeeBuffer, parentAsset.unitInfo);
                page.parentFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondFeeBuffer, parentAsset.unitInfo);
                page.tokenFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(need, ui);
                symbolize(page.txFeeUnit, parentAsset);
                symbolize(page.parentUnit, parentAsset);
                symbolize(page.parentBalUnit, parentAsset);
                page.parentBal.textContent = parentAsset.wallet ? _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(parentAsset.wallet.balance.available, parentAsset.unitInfo) : '0';
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendEnoughWithEst);
            }
            page.fee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLock, ui);
        }
        else { // show some generic message with no amounts, this shouldn't happen... show wallet error?
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendEnough);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(synced ? page.syncCheck : syncProgress >= 1 ? page.syncSpinner : page.syncUncheck);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(bal.available >= 2 * bondAsset.amount + bondFeeBuffer ? page.balCheck : page.balUncheck);
        page.progress.textContent = (syncProgress * 100).toFixed(1);
        if (synced) {
            this.progressed = true;
        }
        this.reportBalance(assetID);
    }
    /*
     * reportWalletState sets the progress and balance, ultimately calling the
     * success function if conditions are met.
     */
    reportWalletState(wallet) {
        if (this.progressed && this.funded)
            return;
        if (wallet.assetID === this.assetID)
            this.reportProgress(wallet.synced, wallet.syncProgress);
        this.reportBalance(wallet.assetID);
    }
    /*
     * reportBalance sets the balance display and calls success if we go over the
     * threshold.
     */
    reportBalance(assetID) {
        if (this.funded || this.assetID === -1)
            return;
        if (assetID !== this.assetID && assetID !== this.parentID)
            return;
        const page = this.page;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[this.assetID];
        const avail = asset.wallet.balance.available;
        page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(avail, asset.unitInfo);
        if (asset.token) {
            const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[asset.token.parentID];
            const parentAvail = parentAsset.wallet.balance.available;
            page.parentBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(parentAvail, parentAsset.unitInfo);
            if (parentAvail < this.bondFeeBuffer)
                return;
        }
        // NOTE: when/if we allow one-time bond post (no maintenance) from the UI we
        // may allow to proceed as long as they have enough for tx fees. For now,
        // the balance check box will remain unchecked and we will not proceed.
        if (avail < 2 * this.bondAsset.amount + this.bondFeeBuffer)
            return;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balCheck);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.balUncheck, page.balanceBox, page.sendEnough);
        this.funded = true;
        if (this.progressed)
            this.success();
    }
    /*
     * reportProgress sets the progress display and calls success if we are fully
     * synced.
     */
    reportProgress(synced, prog) {
        const page = this.page;
        if (synced) {
            page.progress.textContent = '100';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncUncheck, page.syncRemainBox, page.syncSpinner);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncCheck);
            this.progressed = true;
            if (this.funded)
                this.success();
            return;
        }
        else if (prog === 1) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncUncheck);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncSpinner);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncSpinner);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncUncheck);
        }
        page.progress.textContent = (prog * 100).toFixed(1);
        if (prog >= 0.999) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncRemaining);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncFinishingUp);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncRemainBox);
            // The final stage of wallet sync process can take a while (it might hang
            // at 99.9% for many minutes, indexing addresses for example), the simplest
            // way to handle it is to keep displaying "finishing up" message until the
            // sync is finished, since we can't reasonably show it progressing over time.
            page.syncFinishingUp.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_WALLET_SYNC_FINISHING_UP);
            return;
        }
        // Before we get to 99.9% the remaining time estimate must be based on more
        // than one progress report. We'll cache up to the last 20 and look at the
        // difference between the first and last to make the estimate.
        const cacheSize = 20;
        const cache = this.progressCache;
        cache.push({
            stamp: new Date().getTime(),
            progress: prog
        });
        if (cache.length < 2) {
            // Can't meaningfully estimate remaining until we have at least 2 data points.
            return;
        }
        while (cache.length > cacheSize)
            cache.shift();
        const [first, last] = [cache[0], cache[cache.length - 1]];
        const progDelta = last.progress - first.progress;
        if (progDelta === 0) {
            // Having no progress for a while likely means we are experiencing network
            // issues, can't reasonably estimate time remaining in this case.
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncFinishingUp);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncRemaining);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncRemainBox);
        const timeDelta = last.stamp - first.stamp;
        const progRate = progDelta / timeDelta;
        const toGoProg = 1 - last.progress;
        const toGoTime = toGoProg / progRate;
        page.syncRemain.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatDuration(toGoTime);
    }
}
/*
 * AccelerateOrderForm is used to submit an acceleration request for an order.
 */
class AccelerateOrderForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.accelerateSubmit, 'click', () => {
            this.submit();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.submitEarlyConfirm, 'click', () => {
            this.sendAccelerateRequest();
        });
    }
    /*
     * displayEarlyAccelerationMsg displays a message asking for confirmation
     * when the user tries to submit an acceleration transaction very soon after
     * the swap transaction was broadcast, or very soon after a previous
     * acceleration.
     */
    displayEarlyAccelerationMsg() {
        const page = this.page;
        // this is checked in submit, but another check is needed for ts compiler
        if (!this.earlyAcceleration)
            return;
        page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        if (this.earlyAcceleration.wasAcceleration) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.recentAccelerationMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.recentSwapMsg);
            page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.recentSwapMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.recentAccelerationMsg);
            page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.configureAccelerationDiv, page.accelerateErr);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.earlyAccelerationDiv);
    }
    // sendAccelerateRequest makes an accelerate order request to the client
    // backend.
    sendAccelerateRequest() {
        return __awaiter(this, void 0, void 0, function* () {
            const order = this.order;
            const page = this.page;
            const req = {
                orderID: order.id,
                newRate: this.acceleratedRate
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.accelerateMainDiv);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/accelerateorder', req);
            loaded();
            if ((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.accelerateTxID.textContent = res.txID;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.accelerateMainDiv, page.preAccelerateErr, page.accelerateErr);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateMsgDiv, page.accelerateSuccess);
                this.success();
            }
            else {
                page.accelerateErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ORDER_ACCELERATION_ERR_MSG, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.earlyAccelerationDiv);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateErr, page.configureAccelerationDiv);
            }
        });
    }
    // submit is called when the submit button is clicked.
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.earlyAcceleration) {
                this.displayEarlyAccelerationMsg();
            }
            else {
                this.sendAccelerateRequest();
            }
        });
    }
    // refresh should be called before the form is displayed. It makes a
    // preaccelerate request to the client backend and sets up the form
    // based on the results.
    refresh(order) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.order = order;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/preaccelerate', order.id);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.preAccelerateErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ORDER_ACCELERATION_ERR_MSG, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.accelerateMainDiv, page.accelerateSuccess);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateMsgDiv, page.preAccelerateErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.accelerateMsgDiv, page.preAccelerateErr, page.accelerateErr, page.feeEstimateDiv, page.earlyAccelerationDiv);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateMainDiv, page.accelerateSuccess, page.configureAccelerationDiv);
            const preAccelerate = res.preAccelerate;
            this.earlyAcceleration = preAccelerate.earlyAcceleration;
            this.currencyUnit = preAccelerate.suggestedRange.yUnit;
            page.accelerateAvgFeeRate.textContent = `${preAccelerate.swapRate} ${preAccelerate.suggestedRange.yUnit}`;
            page.accelerateCurrentFeeRate.textContent = `${preAccelerate.suggestedRate} ${preAccelerate.suggestedRange.yUnit}`;
            this.acceleratedRate = preAccelerate.suggestedRange.start.y;
            const selected = () => { };
            const roundY = true;
            const updateRate = (_, newY) => { this.acceleratedRate = newY; };
            const rangeHandler = new _opts__WEBPACK_IMPORTED_MODULE_7__.XYRangeHandler(preAccelerate.suggestedRange, preAccelerate.suggestedRange.start.x, {
                updated: updateRate, changed: () => this.updateAccelerationEstimate(), selected, roundY
            });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.sliderContainer);
            page.sliderContainer.appendChild(rangeHandler.control);
            this.updateAccelerationEstimate();
        });
    }
    // updateAccelerationEstimate makes an accelerate estimate request to the
    // client backend using the currently selected rate on the slider, and
    // displays the results.
    updateAccelerationEstimate() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const order = this.order;
            const req = {
                orderID: order.id,
                newRate: this.acceleratedRate
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.sliderContainer);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/accelerationestimate', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.accelerateErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ORDER_ACCELERATION_FEE_ERR_MSG, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateErr);
                return;
            }
            page.feeRateEstimate.textContent = `${this.acceleratedRate} ${this.currencyUnit}`;
            let assetID;
            let assetSymbol;
            if (order.sell) {
                assetID = order.baseID;
                assetSymbol = order.baseSymbol;
            }
            else {
                assetID = order.quoteID;
                assetSymbol = order.quoteSymbol;
            }
            const unitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().unitInfo(assetID);
            page.feeEstimate.textContent = `${res.fee / unitInfo.conventional.conversionFactor} ${assetSymbol}`;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.feeEstimateDiv);
        });
    }
}
/* DEXAddressForm accepts a DEX address and performs account discovery. */
class DEXAddressForm {
    constructor(form, success, dexToUpdate) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        this.certPicker = new CertificatePicker(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.skipRegistration, 'change', () => this.showOrHideSubmitBttn());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showCustom, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showCustom);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.customBox, page.auth);
        });
        this.knownExchanges = Array.from(page.knownXCs.querySelectorAll('.known-exchange'));
        for (const div of this.knownExchanges) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'click', () => {
                const host = div.dataset.host;
                for (const d of this.knownExchanges)
                    d.classList.remove('selected');
                return this.checkDEX(host);
            });
        }
        bind(form, page.submit, () => this.checkDEX());
        if (dexToUpdate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addDexHdr, page.skipRegistrationBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.updateDexHdr);
            this.dexToUpdate = dexToUpdate;
        }
        this.refresh();
    }
    refresh() {
        const page = this.page;
        page.addr.value = '';
        this.certPicker.clearCertFile();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.err);
        if (this.knownExchanges.length === 0 || this.dexToUpdate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.customBox, page.auth);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showCustom, page.knownXCs, page.pickServerMsg, page.addCustomMsg);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.customBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showCustom);
        }
        for (const div of this.knownExchanges)
            div.classList.remove('selected');
        this.showOrHideSubmitBttn();
    }
    /**
     * Show or hide appPWBox depending on if password is required. Show the
     * submit button if connecting a custom server or password is required).
     */
    showOrHideSubmitBttn() {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.customBox), page.auth);
    }
    skipRegistration() {
        var _a;
        return (_a = this.page.skipRegistration.checked) !== null && _a !== void 0 ? _a : false;
    }
    /* Just a small size tweak and fade-in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(550, prog => {
                form.style.transform = `scale(${0.9 + 0.1 * prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
            }, 'easeOut');
        });
    }
    checkDEX(addr) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.err);
            addr = addr || page.addr.value;
            if (addr === '') {
                page.err.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_EMPTY_DEX_ADDRESS_MSG);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.err);
                return;
            }
            const cert = yield this.certPicker.file();
            const skipRegistration = this.skipRegistration();
            let endpoint, req;
            if (this.dexToUpdate) {
                endpoint = '/api/updatedexhost';
                req = {
                    newHost: addr,
                    cert: cert,
                    oldHost: this.dexToUpdate
                };
            }
            else {
                endpoint = skipRegistration ? '/api/adddex' : '/api/discoveracct';
                req = {
                    addr: addr,
                    cert: cert
                };
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)(endpoint, req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                if (String(res.msg).includes('certificate required')) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.needCert);
                }
                else {
                    page.err.textContent = res.msg;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.err);
                }
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            if (!this.dexToUpdate && (skipRegistration || res.paid || Object.keys(res.xc.auth.pendingBonds).length > 0)) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('markets');
                return;
            }
            this.success(res.xc, cert);
        });
    }
}
/* DiscoverAccountForm performs account discovery for a pre-selected DEX. */
class DiscoverAccountForm {
    constructor(form, addr, success) {
        this.form = form;
        this.addr = addr;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        page.dexHost.textContent = addr;
        bind(form, page.submit, () => this.checkDEX());
    }
    /* Just a small size tweak and fade-in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(550, prog => {
                form.style.transform = `scale(${0.9 + 0.1 * prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
            }, 'easeOut');
        });
    }
    checkDEX() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.err);
            const req = {
                addr: this.addr
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/discoveracct', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.err.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.err);
                return;
            }
            if (res.paid) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('markets');
                return;
            }
            this.success(res.xc);
        });
    }
}
/* LoginForm is used to sign into the app. */
class LoginForm {
    constructor(form, success) {
        this.success = success;
        this.form = form;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        bind(form, page.submit, () => { this.submit(); });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            login: (note) => { this.handleLoginNote(note); }
        });
    }
    handleLoginNote(n) {
        if (n.details === '')
            return;
        const loginMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel(this.form, 'loaderMsg');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(loginMsg);
        if (loginMsg)
            loginMsg.textContent = n.details;
    }
    focus() {
        this.page.pw.focus();
    }
    refresh() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.errMsg);
        this.page.pw.value = '';
    }
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
            const pw = page.pw.value || '';
            if (pw === '') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.errMsg, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG));
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/login', { pass: pw });
            loaded();
            page.pw.value = '';
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.errMsg, res.msg);
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            res.notes = res.notes || [];
            res.notes.reverse();
            res.pokes = res.pokes || [];
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loggedIn(res.notes, res.pokes);
            this.success();
        });
    }
    /* Just a small size tweak and fade-in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(550, prog => {
                form.style.transform = `scale(${0.9 + 0.1 * prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
            }, 'easeOut');
        });
    }
}
const traitNewAddresser = 1 << 1;
/*
 * DepositAddress displays a deposit address, a QR code, and a button to
 * generate a new address (if supported).
 */
class DepositAddress {
    constructor(form) {
        this.form = form;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.unifiedReceiverTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.newDepAddrBttn, 'click', () => __awaiter(this, void 0, void 0, function* () { this.newDepositAddress(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyAddressBtn, 'click', () => { this.copyAddress(); });
    }
    /* Display a deposit address. */
    setAsset(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            this.assetID = assetID;
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.depositErr, page.depositTokenMsgBox);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            page.depositLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            const wallet = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[assetID];
            page.depositName.textContent = asset.unitInfo.conventional.unit;
            if (asset.token) {
                const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[asset.token.parentID];
                page.depositTokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                page.depositTokenParentName.textContent = parentAsset.name;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.depositTokenMsgBox);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis((wallet.traits & traitNewAddresser) !== 0, page.newDepAddrBttnBox);
            this.setAddress(wallet.address);
        });
    }
    setAddress(addr) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.unifiedReceivers);
        if (addr.startsWith('unified:')) {
            const receivers = JSON.parse(addr.substring('unified:'.length));
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.unifiedReceivers);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unifiedReceivers);
            const defaultReceiverType = 'unified';
            for (const [recvType, recv] of Object.entries(receivers)) {
                const div = page.unifiedReceiverTmpl.cloneNode(true);
                page.unifiedReceivers.appendChild(div);
                div.textContent = recvType;
                div.dataset.type = recvType;
                if (recvType === defaultReceiverType)
                    div.classList.add('selected');
                // tmpl.addr.textContent = recv
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'click', () => {
                    for (const bttn of Array.from(page.unifiedReceivers.children))
                        bttn.classList.toggle('selected', bttn.dataset.type === recvType);
                    this.setCentralAddress(recv);
                });
            }
            addr = receivers.unified;
        }
        this.setCentralAddress(addr);
    }
    setCentralAddress(addr) {
        const page = this.page;
        page.depositAddress.textContent = addr;
        page.qrcode.src = `/generateqrcode?address=${addr}`;
    }
    /* Fetch a new address from the wallet. */
    newDepositAddress() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, assetID, form } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.depositErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/depositaddress', {
                assetID: assetID
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.depositErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.depositErr);
                return;
            }
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[assetID].address = res.address;
            this.setAddress(res.address);
        });
    }
    copyAddress() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            navigator.clipboard.writeText(page.depositAddress.textContent || '')
                .then(() => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.copyAlert);
                setTimeout(() => {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.copyAlert);
                }, 800);
            })
                .catch((reason) => {
                console.error('Unable to copy: ', reason);
            });
        });
    }
}
// AppPassResetForm is used to reset the app apssword using the app seed.
class AppPassResetForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        bind(form, page.resetAppPWSubmitBtn, () => this.resetAppPW());
    }
    resetAppPW() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const newAppPW = page.newAppPassword.value || '';
            const confirmNewAppPW = page.confirmNewAppPassword.value;
            if (newAppPW === '') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.appPWResetErrMsg, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG));
                return;
            }
            if (newAppPW !== confirmNewAppPW) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.appPWResetErrMsg, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_PASSWORD_NOT_MATCH));
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/resetapppassword', {
                newPass: newAppPW,
                seed: page.seedInput.value
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.appPWResetErrMsg, res.msg);
                return;
            }
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.appPWResetErrMsg))
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.appPWResetErrMsg);
            page.appPWResetSuccessMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_PASSWORD_RESET_SUCCESS_MSG);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWResetSuccessMsg);
            setTimeout(() => this.success(), 3000); // allow time to view the message
        });
    }
    focus() {
        this.page.newAppPassword.focus();
    }
    refresh() {
        const page = this.page;
        page.newAppPassword.value = '';
        page.confirmNewAppPassword.value = '';
        page.seedInput.value = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.appPWResetSuccessMsg, page.appPWResetErrMsg);
    }
}
class CertificatePicker {
    constructor(parent) {
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(parent);
        page.selectedCert.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NONE_SELECTED);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.certFile, 'change', () => this.onCertFileChange());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.removeCert, 'click', () => this.clearCertFile());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addCert, 'click', () => page.certFile.click());
    }
    /**
     * onCertFileChange when the input certFile changed, read the file
     * and setting cert name into text of selectedCert to display on the view
     */
    onCertFileChange() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const files = page.certFile.files;
            if (!files || !files.length)
                return;
            page.selectedCert.textContent = files[0].name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.removeCert);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addCert);
        });
    }
    /* clearCertFile cleanup certFile value and selectedCert text */
    clearCertFile() {
        const page = this.page;
        page.certFile.value = '';
        page.selectedCert.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NONE_SELECTED);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.removeCert);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.addCert);
    }
    file() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            if (page.certFile.value) {
                const files = page.certFile.files;
                if (files && files.length) {
                    return yield files[0].text();
                }
            }
            return '';
        });
    }
}
class TokenApprovalForm {
    constructor(parent, success) {
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(parent);
        this.success = success;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.submit, 'click', () => { this.approve(); });
    }
    setAsset(assetID, host) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            this.assetID = assetID;
            this.host = host;
            const tokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const parentID = this.parentID = (_a = tokenAsset.token) === null || _a === void 0 ? void 0 : _a.parentID;
            const { page } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.submissionElements);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txMsg, page.errMsg, page.addressBox, page.balanceBox, page.addressBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.tokenSymbol);
            page.tokenSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(tokenAsset, true));
            const protocolVersion = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[host].assets[assetID].version;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/approvetokenfee', {
                assetID: tokenAsset.id,
                version: protocolVersion,
                approving: true
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
            }
            else {
                const { unitInfo: ui, wallet: { address, balance: { available: avail } }, name: parentName } = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[parentID];
                const txFee = this.txFee = res.txFee;
                let feeText = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(txFee, ui)} ${ui.conventional.unit}`;
                const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[parentID];
                if (rate) {
                    feeText += ` (${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(txFee, rate, ui)} USD)`;
                }
                page.feeEstimate.textContent = feeText;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balanceBox);
                page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(avail, ui);
                page.parentTicker.textContent = ui.conventional.unit;
                page.parentName.textContent = parentName;
                if (avail < txFee) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.addressBox);
                    page.address.textContent = address;
                }
            }
        });
    }
    /*
     * approve calls the /api/approvetoken endpoint.
     */
    approve() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, assetID, host, success } = this;
            const path = '/api/approvetoken';
            const tokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)(path, {
                assetID: tokenAsset.id,
                dexAddr: host
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
                return;
            }
            page.txid.innerText = res.txID;
            const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[tokenAsset.id];
            if (assetExplorer && assetExplorer[(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.net]) {
                page.txid.href = assetExplorer[(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.net](res.txID);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.submissionElements, page.balanceBox, page.addressBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txMsg);
            if (success)
                success();
        });
    }
    handleBalanceNote(n) {
        const { page, parentID, txFee } = this;
        if (n.assetID !== parentID)
            return;
        page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.balance.available, (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[parentID].unitInfo);
        if (n.balance.available >= txFee) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addressBox);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
    }
}
class CEXConfigurationForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.cexSubmit, 'click', () => this.submit());
    }
    setCEX(cexName) {
        this.cexName = cexName;
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_9__.setCexElements)(this.form, cexName);
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cexConfigPrompt, page.cexConnectErrBox, page.cexFormErr);
        page.cexApiKeyInput.value = '';
        page.cexSecretInput.value = '';
        const cexStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().mmStatus.cexes[cexName];
        const connectErr = cexStatus === null || cexStatus === void 0 ? void 0 : cexStatus.connectErr;
        if (connectErr) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexConnectErrBox);
            page.cexConnectErr.textContent = connectErr;
            page.cexApiKeyInput.value = cexStatus.config.apiKey;
            page.cexSecretInput.value = cexStatus.config.apiSecret;
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexConfigPrompt);
        }
    }
    /*
    * handleCEXSubmit handles clicks on the CEX configuration submission button.
    */
    submit() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, cexName, form } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cexFormErr);
            const apiKey = page.cexApiKeyInput.value;
            const apiSecret = page.cexSecretInput.value;
            if (!apiKey || !apiSecret) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexFormErr);
                page.cexFormErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG);
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(form);
            try {
                const res = yield _mmutil__WEBPACK_IMPORTED_MODULE_9__.MM.updateCEXConfig({
                    name: cexName,
                    apiKey: apiKey,
                    apiSecret: apiSecret
                });
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                    throw res;
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchMMStatus();
                this.success(cexName);
            }
            catch (e) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexFormErr);
                page.cexFormErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_API_ERROR, { msg: (_a = e.msg) !== null && _a !== void 0 ? _a : String(e) });
                return;
            }
            finally {
                loaded();
            }
        });
    }
}
const animationLength = 300;
/* Swap form1 for form2 with an animation. */
function slideSwap(form1, form2) {
    return __awaiter(this, void 0, void 0, function* () {
        const shift = document.body.offsetWidth / 2;
        yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
            form1.style.right = `${progress * shift}px`;
        }, 'easeInHard');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form1);
        form1.style.right = '0';
        form2.style.right = String(-shift);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form2);
        if (form2.querySelector('input')) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(form2, 'input').focus();
        }
        yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
            form2.style.right = `${-shift + progress * shift}px`;
        }, 'easeOutHard');
        form2.style.right = '0';
    });
}
function showSuccess(page, msg) {
    page.successMessage.textContent = msg;
    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, page.checkmarkForm);
    page.checkmarkForm.style.right = '0';
    page.checkmark.style.fontSize = '0px';
    const [startR, startG, startB] = _state__WEBPACK_IMPORTED_MODULE_2__["default"].isDark() ? [223, 226, 225] : [51, 51, 51];
    const [endR, endG, endB] = [16, 163, 16];
    const [diffR, diffG, diffB] = [endR - startR, endG - startG, endB - startB];
    return new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(1200, (prog) => {
        page.checkmark.style.fontSize = `${prog * 80}px`;
        page.checkmark.style.color = `rgb(${startR + prog * diffR}, ${startG + prog * diffG}, ${startB + prog * diffB})`;
    }, 'easeOutElastic');
}
/*
 * bind binds the click and submit events and prevents page reloading on
 * submission.
 */
function bind(form, submitBttn, handler) {
    const wrapper = (e) => {
        if (e.preventDefault)
            e.preventDefault();
        handler(e);
    };
    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(submitBttn, 'click', wrapper);
    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(form, 'submit', wrapper);
}
// isTruthyString will be true if the provided string is recognized as a
// value representing true.
function isTruthyString(s) {
    return s === '1' || s.toLowerCase() === 'true';
}
// toUnixDate converts a javascript date object to a unix date, which is
// the number of *seconds* since the start of the epoch.
function toUnixDate(date) {
    return Math.floor(date.getTime() / 1000);
}
// dateApplyOffset shifts a date by the timezone offset. This is used to make
// UTC dates show the local date. This can be used to prepare a Date so
// toISOString generates a local date string. This is also used to trick an html
// input element to show the local date when setting the valueAsDate field. When
// reading the date back to JS, the value field should be interpreted as local
// using the "T00:00" suffix, or the Date in valueAsDate should be shifted in
// the opposite direction.
function dateApplyOffset(date) {
    return new Date(date.getTime() - date.getTimezoneOffset() * 60 * 1000);
}
// dateToString converts a javascript date object to a YYYY-MM-DD format string,
// in the local time zone.
function dateToString(date) {
    return dateApplyOffset(date).toISOString().split('T')[0];
    // Another common hack:
    // date.toLocaleString("sv-SE", { year: "numeric", month: "2-digit", day: "2-digit" })
}


/***/ }),

/***/ "./src/js/http.ts":
/*!************************!*\
  !*** ./src/js/http.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Errors": () => (/* binding */ Errors),
/* harmony export */   "getJSON": () => (/* binding */ getJSON),
/* harmony export */   "postJSON": () => (/* binding */ postJSON),
/* harmony export */   "requestJSON": () => (/* binding */ requestJSON)
/* harmony export */ });
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/*
 * requestJSON encodes the object and sends the JSON to the specified address.
 */
function requestJSON(method, addr, reqBody) {
    return __awaiter(this, void 0, void 0, function* () {
        try {
            const response = yield window.fetch(addr, {
                method: method,
                headers: new window.Headers({ 'content-type': 'application/json' }),
                // credentials: "same-origin",
                body: reqBody
            });
            if (response.status !== 200) {
                throw response;
            }
            const obj = yield response.json();
            obj.requestSuccessful = true;
            return obj;
        }
        catch (response) {
            response.requestSuccessful = false;
            response.msg = yield response.text();
            return response;
        }
    });
}
/*
 * postJSON sends a POST request with JSON-formatted data and returns the
 * response.
 */
function postJSON(addr, data) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestJSON('POST', addr, JSON.stringify(data));
    });
}
/*
 * getJSON sends a GET request and returns the response.
 */
function getJSON(addr) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestJSON('GET', addr);
    });
}
var Errors;
(function (Errors) {
    Errors[Errors["walletErr"] = 0] = "walletErr";
    Errors[Errors["walletAuthErr"] = 1] = "walletAuthErr";
    Errors[Errors["walletBalanceErr"] = 2] = "walletBalanceErr";
    Errors[Errors["dupeDEXErr"] = 3] = "dupeDEXErr";
    Errors[Errors["assetSupportErr"] = 4] = "assetSupportErr";
    Errors[Errors["registerErr"] = 5] = "registerErr";
    Errors[Errors["signatureErr"] = 6] = "signatureErr";
    Errors[Errors["zeroFeeErr"] = 7] = "zeroFeeErr";
    Errors[Errors["feeMismatchErr"] = 8] = "feeMismatchErr";
    Errors[Errors["feeSendErr"] = 9] = "feeSendErr";
    Errors[Errors["passwordErr"] = 10] = "passwordErr";
    Errors[Errors["emptyHostErr"] = 11] = "emptyHostErr";
    Errors[Errors["connectionErr"] = 12] = "connectionErr";
    Errors[Errors["acctKeyErr"] = 13] = "acctKeyErr";
    Errors[Errors["unknownOrderErr"] = 14] = "unknownOrderErr";
    Errors[Errors["orderParamsErr"] = 15] = "orderParamsErr";
    Errors[Errors["dbErr"] = 16] = "dbErr";
    Errors[Errors["authErr"] = 17] = "authErr";
    Errors[Errors["connectWalletErr"] = 18] = "connectWalletErr";
    Errors[Errors["missingWalletErr"] = 19] = "missingWalletErr";
    Errors[Errors["encryptionErr"] = 20] = "encryptionErr";
    Errors[Errors["decodeErr"] = 21] = "decodeErr";
    Errors[Errors["accountVerificationErr"] = 22] = "accountVerificationErr";
    Errors[Errors["accountProofErr"] = 23] = "accountProofErr";
    Errors[Errors["parseKeyErr"] = 24] = "parseKeyErr";
    Errors[Errors["marketErr"] = 25] = "marketErr";
    Errors[Errors["addressParseErr"] = 26] = "addressParseErr";
    Errors[Errors["addrErr"] = 27] = "addrErr";
    Errors[Errors["fileReadErr"] = 28] = "fileReadErr";
    Errors[Errors["unknownDEXErr"] = 29] = "unknownDEXErr";
    Errors[Errors["accountRetrieveErr"] = 30] = "accountRetrieveErr";
    Errors[Errors["accountDisableErr"] = 31] = "accountDisableErr";
    Errors[Errors["suspendedAcctErr"] = 32] = "suspendedAcctErr";
    Errors[Errors["existenceCheckErr"] = 33] = "existenceCheckErr";
    Errors[Errors["createWalletErr"] = 34] = "createWalletErr";
    Errors[Errors["activeOrdersErr"] = 35] = "activeOrdersErr";
    Errors[Errors["newAddrErr"] = 36] = "newAddrErr";
})(Errors || (Errors = {}));


/***/ }),

/***/ "./src/js/init.ts":
/*!************************!*\
  !*** ./src/js/init.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ InitPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







/*
 * InitPage is the page handler for the /init view. InitPage is essentially a
 * form handler. There are no non-form elements on /init. InitPage additionally
 * has a role caching the initialization password. A couple of notes about
 * InitPage.
 *   1) There is no going backwards. Once you set a password, you can't go back
 *      to the password form. If you refresh, you won't end up on /init, so
 *      won't have access to the QuickConfigForm or SeedBackupForm . Once you
 *      submit your auto-config choices, you can't change them. This has
 *      implications for coding and UI. There are no "go back" or "close form"
 *      elements.
 *   2) The user can preclude auto-config and seed backup by clicking an
 *      available header link after password init, e.g. Wallets, in the page
 *      header. NOTE: Regardless of what the user does after setting the app
 *      pass, they will receive a notification reminding them to back up their
 *      seed. Perhaps it would be better to somehow delay that message until
 *      they choose to ignore the seed backup dialog, but having more reminders
 *      is also okay.
 */
class InitPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body) {
        super();
        this.body = body;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.initForm = new AppInitForm(page.appPWForm, (pw, hosts, mnemonic) => { this.appInited(pw, hosts, mnemonic); });
        this.quickConfigForm = new QuickConfigForm(page.quickConfigForm, () => this.quickConfigDone());
        this.seedBackupForm = new SeedBackupForm(page.seedBackupForm, () => this.seedBackedUp());
    }
    appInited(pw, hosts, mnemonic) {
        return __awaiter(this, void 0, void 0, function* () {
            this.mnemonic = mnemonic;
            const page = this.page;
            yield this.quickConfigForm.update(pw, hosts);
            if (mnemonic)
                this.seedBackupForm.update(mnemonic);
            (0,_forms__WEBPACK_IMPORTED_MODULE_4__.slideSwap)(page.appPWForm, page.quickConfigForm);
        });
    }
    quickConfigDone() {
        if (!this.mnemonic)
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('wallets');
        else
            (0,_forms__WEBPACK_IMPORTED_MODULE_4__.slideSwap)(this.page.quickConfigForm, this.page.seedBackupForm);
    }
    seedBackedUp() {
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('wallets');
    }
}
/*
 * The AppInitForm handles the form that sets the app password, accepts an
 * optional seed, and initializes the app.
 */
class AppInitForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.appPWSubmit, () => this.setAppPass());
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.toggleSeedInput, () => {
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.seedInputBox)) {
                page.toggleSeedInputIcon.classList.remove('ico-plus');
                page.toggleSeedInputIcon.classList.add('ico-minus');
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.seedInputBox);
            }
            else {
                page.toggleSeedInputIcon.classList.remove('ico-minus');
                page.toggleSeedInputIcon.classList.add('ico-plus');
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.seedInputBox);
            }
        });
    }
    /* Set the application password. Attached to form submission. */
    setAppPass() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.appPWErrMsg);
            const pw = page.appPW.value || '';
            const pwAgain = page.appPWAgain.value;
            if (pw === '') {
                page.appPWErrMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWErrMsg);
                return;
            }
            if (pw !== pwAgain) {
                page.appPWErrMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_PASSWORD_NOT_MATCH);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWErrMsg);
                return;
            }
            page.appPW.value = '';
            page.appPWAgain.value = '';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            // const seed = page.seedInput.value?.replace(/\s+/g, '') // strip whitespace
            const seed = (_a = page.seedInput.value) !== null && _a !== void 0 ? _a : '';
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/init', {
                pass: pw,
                seed: seed
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.appPWErrMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWErrMsg);
                return;
            }
            this.success(pw, res.hosts, res.mnemonic);
        });
    }
}
let rowIDCounter = 0;
/*
 * QuickConfigForm handles the form that allows users to quickly configure
 * view-only servers and native wallets (that don't require any configuration).
 */
class QuickConfigForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.qcServerTmpl, page.qcWalletTmpl);
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.quickConfigSubmit, () => { this.submit(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.qcErrAck, () => { this.success(); });
    }
    update(pw, hosts) {
        return __awaiter(this, void 0, void 0, function* () {
            this.pw = pw;
            const page = this.page;
            this.servers = [];
            for (const host of hosts) {
                const row = page.qcServerTmpl.cloneNode(true);
                page.qcServersBox.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                rowIDCounter++;
                const rowID = `qcsrow${rowIDCounter}`;
                row.htmlFor = rowID;
                tmpl.checkbox.id = rowID;
                tmpl.host.textContent = host;
                this.servers.push({ host, checkbox: tmpl.checkbox });
            }
            const u = yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            this.wallets = [];
            for (const a of Object.values(u.assets)) {
                if (a.token)
                    continue;
                const winfo = a.info;
                let autoConfigurable = null;
                for (const wDef of winfo.availablewallets) {
                    if (!wDef.seeded)
                        continue;
                    if (wDef.configopts && wDef.configopts.some((opt) => opt.required))
                        continue;
                    autoConfigurable = wDef;
                    break;
                }
                if (!autoConfigurable)
                    continue;
                const row = page.qcWalletTmpl.cloneNode(true);
                page.qcWalletsBox.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                rowIDCounter++;
                const rowID = `qcwrow${rowIDCounter}`;
                row.htmlFor = rowID;
                tmpl.checkbox.id = rowID;
                tmpl.icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(a.symbol);
                tmpl.name.textContent = a.name;
                this.wallets.push({
                    asset: a,
                    type: autoConfigurable.type,
                    checkbox: tmpl.checkbox
                });
            }
        });
    }
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            const [failedHosts, failedWallets] = [[], []];
            const ani = new _charts__WEBPACK_IMPORTED_MODULE_5__.Wave(this.form, { backgroundColor: true, message: '...' });
            ani.opts.message = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ADDING_SERVERS);
            const connectServer = (srvRow) => __awaiter(this, void 0, void 0, function* () {
                if (!srvRow.checkbox.checked)
                    return;
                const req = {
                    addr: srvRow.host,
                    appPW: this.pw
                };
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/adddex', req); // DRAFT NOTE: ignore errors ok?
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                    failedHosts.push(srvRow.host);
            });
            yield Promise.all(this.servers.map(connectServer));
            ani.opts.message = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_CREATING_WALLETS);
            const createWallet = (walletRow) => __awaiter(this, void 0, void 0, function* () {
                var _a;
                const { asset: a, type, checkbox } = walletRow;
                if (!checkbox.checked)
                    return;
                const config = {};
                const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletDefinition(a.id, type);
                for (const opt of ((_a = walletDef.configopts) !== null && _a !== void 0 ? _a : [])) {
                    if (!opt.default)
                        continue;
                    if (opt.isboolean) {
                        config[opt.key] = opt.default ? '1' : '0';
                        continue;
                    }
                    if (opt.repeatable && config[opt.key])
                        config[opt.key] += opt.repeatable + opt.default;
                    else
                        config[opt.key] = String(opt.default);
                }
                const createForm = {
                    assetID: a.id,
                    appPass: this.pw,
                    config: config,
                    walletType: type
                };
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/newwallet', createForm);
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                    failedWallets.push(a.name);
            });
            yield Promise.all(this.wallets.map(createWallet));
            ani.stop();
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser(); // Calls updateMenuItemsDisplay internally
            if (failedWallets.length + failedHosts.length === 0)
                return this.success();
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qcChoices);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.qcErrors);
            if (failedHosts.length) {
                for (const host of failedHosts) {
                    page.qcServerErrorList.appendChild(document.createTextNode(host));
                    page.qcServerErrorList.appendChild(document.createElement('br'));
                }
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qcServerErrors);
            if (failedWallets.length) {
                for (const name of failedWallets) {
                    page.qcWalletErrorList.appendChild(document.createTextNode(name));
                    page.qcWalletErrorList.appendChild(document.createElement('br'));
                }
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qcWalletErrors);
        });
    }
}
/*
 * SeedBackupForm handles the form that allows the user to back up their seed
 * during initialization.
 */
class SeedBackupForm {
    constructor(form, success) {
        this.form = form;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.seedAck, () => success());
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.showSeed, () => this.showSeed());
    }
    update(mnemonic) {
        this.mnemonic = mnemonic;
    }
    showSeed() {
        const page = this.page;
        page.mnemonic.textContent = this.mnemonic; // `${words.slice(0, 5).join(' ')}\n${words.slice(5, 10).join(' ')}\n${words.slice(10,15).join(' ')}`
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sbWanna);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sbSeed);
    }
}


/***/ }),

/***/ "./src/js/locales.ts":
/*!***************************!*\
  !*** ./src/js/locales.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ID_ACCOUNT_DISABLED_MSG": () => (/* binding */ ID_ACCOUNT_DISABLED_MSG),
/* harmony export */   "ID_ACCOUNT_SUSPENDED": () => (/* binding */ ID_ACCOUNT_SUSPENDED),
/* harmony export */   "ID_ACCT_UNDEFINED": () => (/* binding */ ID_ACCT_UNDEFINED),
/* harmony export */   "ID_ACTIVE_ORDERS_ERR_MSG": () => (/* binding */ ID_ACTIVE_ORDERS_ERR_MSG),
/* harmony export */   "ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG": () => (/* binding */ ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG),
/* harmony export */   "ID_ADD": () => (/* binding */ ID_ADD),
/* harmony export */   "ID_ADDED": () => (/* binding */ ID_ADDED),
/* harmony export */   "ID_ADDING_SERVERS": () => (/* binding */ ID_ADDING_SERVERS),
/* harmony export */   "ID_API_ERROR": () => (/* binding */ ID_API_ERROR),
/* harmony export */   "ID_ARCHIVED_RECORDS_PATH": () => (/* binding */ ID_ARCHIVED_RECORDS_PATH),
/* harmony export */   "ID_ARCHIVED_SETTINGS": () => (/* binding */ ID_ARCHIVED_SETTINGS),
/* harmony export */   "ID_AVAILABLE": () => (/* binding */ ID_AVAILABLE),
/* harmony export */   "ID_AVAILABLE_TITLE": () => (/* binding */ ID_AVAILABLE_TITLE),
/* harmony export */   "ID_BONDED": () => (/* binding */ ID_BONDED),
/* harmony export */   "ID_BOND_RESERVES": () => (/* binding */ ID_BOND_RESERVES),
/* harmony export */   "ID_BOND_RESERVES_MSG": () => (/* binding */ ID_BOND_RESERVES_MSG),
/* harmony export */   "ID_BOOKED": () => (/* binding */ ID_BOOKED),
/* harmony export */   "ID_BOTTYPE_ARB_MM": () => (/* binding */ ID_BOTTYPE_ARB_MM),
/* harmony export */   "ID_BOTTYPE_BASIC_MM": () => (/* binding */ ID_BOTTYPE_BASIC_MM),
/* harmony export */   "ID_BOTTYPE_SIMPLE_ARB": () => (/* binding */ ID_BOTTYPE_SIMPLE_ARB),
/* harmony export */   "ID_BROWSER_NTFN_BONDS": () => (/* binding */ ID_BROWSER_NTFN_BONDS),
/* harmony export */   "ID_BROWSER_NTFN_CONNECTIONS": () => (/* binding */ ID_BROWSER_NTFN_CONNECTIONS),
/* harmony export */   "ID_BROWSER_NTFN_ENABLED": () => (/* binding */ ID_BROWSER_NTFN_ENABLED),
/* harmony export */   "ID_BROWSER_NTFN_MATCHES": () => (/* binding */ ID_BROWSER_NTFN_MATCHES),
/* harmony export */   "ID_BROWSER_NTFN_ORDERS": () => (/* binding */ ID_BROWSER_NTFN_ORDERS),
/* harmony export */   "ID_BUY": () => (/* binding */ ID_BUY),
/* harmony export */   "ID_BUYING": () => (/* binding */ ID_BUYING),
/* harmony export */   "ID_CALCULATING": () => (/* binding */ ID_CALCULATING),
/* harmony export */   "ID_CANCELED": () => (/* binding */ ID_CANCELED),
/* harmony export */   "ID_CANCELING": () => (/* binding */ ID_CANCELING),
/* harmony export */   "ID_CANCEL_ORDER": () => (/* binding */ ID_CANCEL_ORDER),
/* harmony export */   "ID_CANDLES_LOADING": () => (/* binding */ ID_CANDLES_LOADING),
/* harmony export */   "ID_CAUSES_SELF_MATCH": () => (/* binding */ ID_CAUSES_SELF_MATCH),
/* harmony export */   "ID_CEXBALANCE_ERR": () => (/* binding */ ID_CEXBALANCE_ERR),
/* harmony export */   "ID_CEX_BALANCES": () => (/* binding */ ID_CEX_BALANCES),
/* harmony export */   "ID_CEX_ORDERBOOK_UNSYNCED": () => (/* binding */ ID_CEX_ORDERBOOK_UNSYNCED),
/* harmony export */   "ID_CEX_TOO_SHALLOW": () => (/* binding */ ID_CEX_TOO_SHALLOW),
/* harmony export */   "ID_CEX_TRADE_ERROR": () => (/* binding */ ID_CEX_TRADE_ERROR),
/* harmony export */   "ID_CEX_UNDERFUNDED": () => (/* binding */ ID_CEX_UNDERFUNDED),
/* harmony export */   "ID_CHANGE_WALLET_TYPE": () => (/* binding */ ID_CHANGE_WALLET_TYPE),
/* harmony export */   "ID_COMPLETE": () => (/* binding */ ID_COMPLETE),
/* harmony export */   "ID_CONFIRMATIONS": () => (/* binding */ ID_CONFIRMATIONS),
/* harmony export */   "ID_CONNECTED": () => (/* binding */ ID_CONNECTED),
/* harmony export */   "ID_CONNECTION_FAILED": () => (/* binding */ ID_CONNECTION_FAILED),
/* harmony export */   "ID_CONNECT_WALLET_ERR_MSG": () => (/* binding */ ID_CONNECT_WALLET_ERR_MSG),
/* harmony export */   "ID_CREATE": () => (/* binding */ ID_CREATE),
/* harmony export */   "ID_CREATE_ASSET_WALLET_MSG": () => (/* binding */ ID_CREATE_ASSET_WALLET_MSG),
/* harmony export */   "ID_CREATING_WALLETS": () => (/* binding */ ID_CREATING_WALLETS),
/* harmony export */   "ID_DEFAULT": () => (/* binding */ ID_DEFAULT),
/* harmony export */   "ID_DELETE_ARCHIVED_RECORDS_RESULT": () => (/* binding */ ID_DELETE_ARCHIVED_RECORDS_RESULT),
/* harmony export */   "ID_DEPOSIT_ERROR": () => (/* binding */ ID_DEPOSIT_ERROR),
/* harmony export */   "ID_DEPTH_LOADING": () => (/* binding */ ID_DEPTH_LOADING),
/* harmony export */   "ID_DETERMINE_PLACEMENTS_ERROR": () => (/* binding */ ID_DETERMINE_PLACEMENTS_ERROR),
/* harmony export */   "ID_DEX_DISABLED_MSG": () => (/* binding */ ID_DEX_DISABLED_MSG),
/* harmony export */   "ID_DEX_UNDERFUNDED": () => (/* binding */ ID_DEX_UNDERFUNDED),
/* harmony export */   "ID_DISABLED_MSG": () => (/* binding */ ID_DISABLED_MSG),
/* harmony export */   "ID_DISABLE_ACCOUNT": () => (/* binding */ ID_DISABLE_ACCOUNT),
/* harmony export */   "ID_DISCONNECTED": () => (/* binding */ ID_DISCONNECTED),
/* harmony export */   "ID_DISCOVERED": () => (/* binding */ ID_DISCOVERED),
/* harmony export */   "ID_EMPTY_DEX_ADDRESS_MSG": () => (/* binding */ ID_EMPTY_DEX_ADDRESS_MSG),
/* harmony export */   "ID_ENABLE_ACCOUNT": () => (/* binding */ ID_ENABLE_ACCOUNT),
/* harmony export */   "ID_EPOCH": () => (/* binding */ ID_EPOCH),
/* harmony export */   "ID_ESTIMATE_UNAVAILABLE": () => (/* binding */ ID_ESTIMATE_UNAVAILABLE),
/* harmony export */   "ID_EXECUTED": () => (/* binding */ ID_EXECUTED),
/* harmony export */   "ID_FEE_BALANCE": () => (/* binding */ ID_FEE_BALANCE),
/* harmony export */   "ID_HIDE_ADDITIONAL_SETTINGS": () => (/* binding */ ID_HIDE_ADDITIONAL_SETTINGS),
/* harmony export */   "ID_IMMATURE": () => (/* binding */ ID_IMMATURE),
/* harmony export */   "ID_IMMATURE_BAL_MSG": () => (/* binding */ ID_IMMATURE_BAL_MSG),
/* harmony export */   "ID_IMMATURE_TITLE": () => (/* binding */ ID_IMMATURE_TITLE),
/* harmony export */   "ID_INVALID_ADDRESS_MSG": () => (/* binding */ ID_INVALID_ADDRESS_MSG),
/* harmony export */   "ID_INVALID_CERTIFICATE": () => (/* binding */ ID_INVALID_CERTIFICATE),
/* harmony export */   "ID_INVALID_COMPS_VALUE": () => (/* binding */ ID_INVALID_COMPS_VALUE),
/* harmony export */   "ID_INVALID_DATE_ERR_MSG": () => (/* binding */ ID_INVALID_DATE_ERR_MSG),
/* harmony export */   "ID_INVALID_TIER_VALUE": () => (/* binding */ ID_INVALID_TIER_VALUE),
/* harmony export */   "ID_INVALID_VALUE": () => (/* binding */ ID_INVALID_VALUE),
/* harmony export */   "ID_KEEP_WALLET_PASS": () => (/* binding */ ID_KEEP_WALLET_PASS),
/* harmony export */   "ID_KEEP_WALLET_TYPE": () => (/* binding */ ID_KEEP_WALLET_TYPE),
/* harmony export */   "ID_LIMIT_ORDER": () => (/* binding */ ID_LIMIT_ORDER),
/* harmony export */   "ID_LIMIT_ORDER_IMMEDIATE_TIF": () => (/* binding */ ID_LIMIT_ORDER_IMMEDIATE_TIF),
/* harmony export */   "ID_LOCKED": () => (/* binding */ ID_LOCKED),
/* harmony export */   "ID_LOCKED_BAL_MSG": () => (/* binding */ ID_LOCKED_BAL_MSG),
/* harmony export */   "ID_LOCKED_BOND_BAL_MSG": () => (/* binding */ ID_LOCKED_BOND_BAL_MSG),
/* harmony export */   "ID_LOCKED_ORDER_BAL_MSG": () => (/* binding */ ID_LOCKED_ORDER_BAL_MSG),
/* harmony export */   "ID_LOCKED_SWAPPING_BAL_MSG": () => (/* binding */ ID_LOCKED_SWAPPING_BAL_MSG),
/* harmony export */   "ID_LOCKED_TITLE": () => (/* binding */ ID_LOCKED_TITLE),
/* harmony export */   "ID_LOT": () => (/* binding */ ID_LOT),
/* harmony export */   "ID_LOTS": () => (/* binding */ ID_LOTS),
/* harmony export */   "ID_MAKER": () => (/* binding */ ID_MAKER),
/* harmony export */   "ID_MARKET_ORDER": () => (/* binding */ ID_MARKET_ORDER),
/* harmony export */   "ID_MATCH_BUFFER": () => (/* binding */ ID_MATCH_BUFFER),
/* harmony export */   "ID_MATCH_STATUS_COMPLETE": () => (/* binding */ ID_MATCH_STATUS_COMPLETE),
/* harmony export */   "ID_MATCH_STATUS_MAKER_REDEEMED": () => (/* binding */ ID_MATCH_STATUS_MAKER_REDEEMED),
/* harmony export */   "ID_MATCH_STATUS_MAKER_SWAP_CAST": () => (/* binding */ ID_MATCH_STATUS_MAKER_SWAP_CAST),
/* harmony export */   "ID_MATCH_STATUS_NEWLY_MATCHED": () => (/* binding */ ID_MATCH_STATUS_NEWLY_MATCHED),
/* harmony export */   "ID_MATCH_STATUS_REDEEM_PENDING": () => (/* binding */ ID_MATCH_STATUS_REDEEM_PENDING),
/* harmony export */   "ID_MATCH_STATUS_REDEMPTION_CONFIRMED": () => (/* binding */ ID_MATCH_STATUS_REDEMPTION_CONFIRMED),
/* harmony export */   "ID_MATCH_STATUS_REDEMPTION_SENT": () => (/* binding */ ID_MATCH_STATUS_REDEMPTION_SENT),
/* harmony export */   "ID_MATCH_STATUS_REFUNDED": () => (/* binding */ ID_MATCH_STATUS_REFUNDED),
/* harmony export */   "ID_MATCH_STATUS_REFUND_PENDING": () => (/* binding */ ID_MATCH_STATUS_REFUND_PENDING),
/* harmony export */   "ID_MATCH_STATUS_REVOKED": () => (/* binding */ ID_MATCH_STATUS_REVOKED),
/* harmony export */   "ID_MATCH_STATUS_TAKER_SWAP_CAST": () => (/* binding */ ID_MATCH_STATUS_TAKER_SWAP_CAST),
/* harmony export */   "ID_MAX": () => (/* binding */ ID_MAX),
/* harmony export */   "ID_MISSING_CEX_CREDS": () => (/* binding */ ID_MISSING_CEX_CREDS),
/* harmony export */   "ID_NEW_WALLET_PASS": () => (/* binding */ ID_NEW_WALLET_PASS),
/* harmony export */   "ID_NEW_WALLET_SUCCESS": () => (/* binding */ ID_NEW_WALLET_SUCCESS),
/* harmony export */   "ID_NONE_SELECTED": () => (/* binding */ ID_NONE_SELECTED),
/* harmony export */   "ID_NOT_SUPPORTED": () => (/* binding */ ID_NOT_SUPPORTED),
/* harmony export */   "ID_NO_APP_PASS_ERROR_MSG": () => (/* binding */ ID_NO_APP_PASS_ERROR_MSG),
/* harmony export */   "ID_NO_ARCHIVED_RECORDS": () => (/* binding */ ID_NO_ARCHIVED_RECORDS),
/* harmony export */   "ID_NO_ASSET_WALLET": () => (/* binding */ ID_NO_ASSET_WALLET),
/* harmony export */   "ID_NO_BOTTYPE": () => (/* binding */ ID_NO_BOTTYPE),
/* harmony export */   "ID_NO_CEX": () => (/* binding */ ID_NO_CEX),
/* harmony export */   "ID_NO_CODE_PROVIDED": () => (/* binding */ ID_NO_CODE_PROVIDED),
/* harmony export */   "ID_NO_MATCH": () => (/* binding */ ID_NO_MATCH),
/* harmony export */   "ID_NO_PASS_ERROR_MSG": () => (/* binding */ ID_NO_PASS_ERROR_MSG),
/* harmony export */   "ID_NO_PLACEMENTS": () => (/* binding */ ID_NO_PLACEMENTS),
/* harmony export */   "ID_NO_PRICE_SOURCE": () => (/* binding */ ID_NO_PRICE_SOURCE),
/* harmony export */   "ID_NO_WALLET": () => (/* binding */ ID_NO_WALLET),
/* harmony export */   "ID_NO_WALLET_MSG": () => (/* binding */ ID_NO_WALLET_MSG),
/* harmony export */   "ID_NO_ZERO": () => (/* binding */ ID_NO_ZERO),
/* harmony export */   "ID_NO_ZERO_QUANTITY": () => (/* binding */ ID_NO_ZERO_QUANTITY),
/* harmony export */   "ID_NO_ZERO_RATE": () => (/* binding */ ID_NO_ZERO_RATE),
/* harmony export */   "ID_OFF": () => (/* binding */ ID_OFF),
/* harmony export */   "ID_OPEN_WALLET_ERR_MSG": () => (/* binding */ ID_OPEN_WALLET_ERR_MSG),
/* harmony export */   "ID_ORDER": () => (/* binding */ ID_ORDER),
/* harmony export */   "ID_ORDER_ACCELERATION_ERR_MSG": () => (/* binding */ ID_ORDER_ACCELERATION_ERR_MSG),
/* harmony export */   "ID_ORDER_ACCELERATION_FEE_ERR_MSG": () => (/* binding */ ID_ORDER_ACCELERATION_FEE_ERR_MSG),
/* harmony export */   "ID_ORDER_BUTTON_BUY_BALANCE_ERROR": () => (/* binding */ ID_ORDER_BUTTON_BUY_BALANCE_ERROR),
/* harmony export */   "ID_ORDER_BUTTON_QTY_ERROR": () => (/* binding */ ID_ORDER_BUTTON_QTY_ERROR),
/* harmony export */   "ID_ORDER_BUTTON_QTY_RATE_ERROR": () => (/* binding */ ID_ORDER_BUTTON_QTY_RATE_ERROR),
/* harmony export */   "ID_ORDER_BUTTON_SELL_BALANCE_ERROR": () => (/* binding */ ID_ORDER_BUTTON_SELL_BALANCE_ERROR),
/* harmony export */   "ID_ORDER_PREVIEW": () => (/* binding */ ID_ORDER_PREVIEW),
/* harmony export */   "ID_ORDER_REPORT_TITLE": () => (/* binding */ ID_ORDER_REPORT_TITLE),
/* harmony export */   "ID_ORDER_SUBMITTING": () => (/* binding */ ID_ORDER_SUBMITTING),
/* harmony export */   "ID_PASSWORD_NOT_MATCH": () => (/* binding */ ID_PASSWORD_NOT_MATCH),
/* harmony export */   "ID_PASSWORD_RESET_SUCCESS_MSG": () => (/* binding */ ID_PASSWORD_RESET_SUCCESS_MSG),
/* harmony export */   "ID_PENDING": () => (/* binding */ ID_PENDING),
/* harmony export */   "ID_PLACE_BUY_ORDERS_ERROR": () => (/* binding */ ID_PLACE_BUY_ORDERS_ERROR),
/* harmony export */   "ID_PLACE_SELL_ORDERS_ERROR": () => (/* binding */ ID_PLACE_SELL_ORDERS_ERROR),
/* harmony export */   "ID_READY": () => (/* binding */ ID_READY),
/* harmony export */   "ID_RECONFIG_SUCCESS": () => (/* binding */ ID_RECONFIG_SUCCESS),
/* harmony export */   "ID_REFUND_IMMINENT": () => (/* binding */ ID_REFUND_IMMINENT),
/* harmony export */   "ID_REFUND_WILL_HAPPEN_AFTER": () => (/* binding */ ID_REFUND_WILL_HAPPEN_AFTER),
/* harmony export */   "ID_REGISTRATION_FEE_SUCCESS": () => (/* binding */ ID_REGISTRATION_FEE_SUCCESS),
/* harmony export */   "ID_RESCAN_STARTED": () => (/* binding */ ID_RESCAN_STARTED),
/* harmony export */   "ID_RESERVES_DEFICIT": () => (/* binding */ ID_RESERVES_DEFICIT),
/* harmony export */   "ID_RESERVES_DEFICIT_MSG": () => (/* binding */ ID_RESERVES_DEFICIT_MSG),
/* harmony export */   "ID_REVOKED": () => (/* binding */ ID_REVOKED),
/* harmony export */   "ID_SELECT_WALLET_FOR_FEE_PAYMENT": () => (/* binding */ ID_SELECT_WALLET_FOR_FEE_PAYMENT),
/* harmony export */   "ID_SELL": () => (/* binding */ ID_SELL),
/* harmony export */   "ID_SELLING": () => (/* binding */ ID_SELLING),
/* harmony export */   "ID_SEND_SUCCESS": () => (/* binding */ ID_SEND_SUCCESS),
/* harmony export */   "ID_SETTLING": () => (/* binding */ ID_SETTLING),
/* harmony export */   "ID_SETUP_NEEDED": () => (/* binding */ ID_SETUP_NEEDED),
/* harmony export */   "ID_SETUP_WALLET": () => (/* binding */ ID_SETUP_WALLET),
/* harmony export */   "ID_SET_BUTTON_BUY": () => (/* binding */ ID_SET_BUTTON_BUY),
/* harmony export */   "ID_SET_BUTTON_SELL": () => (/* binding */ ID_SET_BUTTON_SELL),
/* harmony export */   "ID_SHIELDED": () => (/* binding */ ID_SHIELDED),
/* harmony export */   "ID_SHIELDED_MSG": () => (/* binding */ ID_SHIELDED_MSG),
/* harmony export */   "ID_SHOW_ADDITIONAL_SETTINGS": () => (/* binding */ ID_SHOW_ADDITIONAL_SETTINGS),
/* harmony export */   "ID_SWAPPING": () => (/* binding */ ID_SWAPPING),
/* harmony export */   "ID_SWAP_OR_SEND_TOOLTIP": () => (/* binding */ ID_SWAP_OR_SEND_TOOLTIP),
/* harmony export */   "ID_TAKER": () => (/* binding */ ID_TAKER),
/* harmony export */   "ID_TAKER_FOUND_MAKER_REDEMPTION": () => (/* binding */ ID_TAKER_FOUND_MAKER_REDEMPTION),
/* harmony export */   "ID_TICKETS_PURCHASED": () => (/* binding */ ID_TICKETS_PURCHASED),
/* harmony export */   "ID_TICKET_STATUS_EXPIRED": () => (/* binding */ ID_TICKET_STATUS_EXPIRED),
/* harmony export */   "ID_TICKET_STATUS_IMMATURE": () => (/* binding */ ID_TICKET_STATUS_IMMATURE),
/* harmony export */   "ID_TICKET_STATUS_LIVE": () => (/* binding */ ID_TICKET_STATUS_LIVE),
/* harmony export */   "ID_TICKET_STATUS_MISSED": () => (/* binding */ ID_TICKET_STATUS_MISSED),
/* harmony export */   "ID_TICKET_STATUS_REVOKED": () => (/* binding */ ID_TICKET_STATUS_REVOKED),
/* harmony export */   "ID_TICKET_STATUS_UNKNOWN": () => (/* binding */ ID_TICKET_STATUS_UNKNOWN),
/* harmony export */   "ID_TICKET_STATUS_UNMINED": () => (/* binding */ ID_TICKET_STATUS_UNMINED),
/* harmony export */   "ID_TICKET_STATUS_UNSPENT": () => (/* binding */ ID_TICKET_STATUS_UNSPENT),
/* harmony export */   "ID_TICKET_STATUS_VOTED": () => (/* binding */ ID_TICKET_STATUS_VOTED),
/* harmony export */   "ID_TRADE": () => (/* binding */ ID_TRADE),
/* harmony export */   "ID_TRADING_TIER_UPDATED": () => (/* binding */ ID_TRADING_TIER_UPDATED),
/* harmony export */   "ID_TRANSPARENT": () => (/* binding */ ID_TRANSPARENT),
/* harmony export */   "ID_TXFEE_ERR_MSG": () => (/* binding */ ID_TXFEE_ERR_MSG),
/* harmony export */   "ID_TXFEE_UNSUPPORTED": () => (/* binding */ ID_TXFEE_UNSUPPORTED),
/* harmony export */   "ID_TX_TYPE_ACCELERATION": () => (/* binding */ ID_TX_TYPE_ACCELERATION),
/* harmony export */   "ID_TX_TYPE_APPROVE_TOKEN": () => (/* binding */ ID_TX_TYPE_APPROVE_TOKEN),
/* harmony export */   "ID_TX_TYPE_CREATE_BOND": () => (/* binding */ ID_TX_TYPE_CREATE_BOND),
/* harmony export */   "ID_TX_TYPE_MIX": () => (/* binding */ ID_TX_TYPE_MIX),
/* harmony export */   "ID_TX_TYPE_RECEIVE": () => (/* binding */ ID_TX_TYPE_RECEIVE),
/* harmony export */   "ID_TX_TYPE_REDEEM": () => (/* binding */ ID_TX_TYPE_REDEEM),
/* harmony export */   "ID_TX_TYPE_REDEEM_BOND": () => (/* binding */ ID_TX_TYPE_REDEEM_BOND),
/* harmony export */   "ID_TX_TYPE_REFUND": () => (/* binding */ ID_TX_TYPE_REFUND),
/* harmony export */   "ID_TX_TYPE_REVOKE_TOKEN_APPROVAL": () => (/* binding */ ID_TX_TYPE_REVOKE_TOKEN_APPROVAL),
/* harmony export */   "ID_TX_TYPE_SELF_TRANSFER": () => (/* binding */ ID_TX_TYPE_SELF_TRANSFER),
/* harmony export */   "ID_TX_TYPE_SEND": () => (/* binding */ ID_TX_TYPE_SEND),
/* harmony export */   "ID_TX_TYPE_SPLIT": () => (/* binding */ ID_TX_TYPE_SPLIT),
/* harmony export */   "ID_TX_TYPE_SWAP": () => (/* binding */ ID_TX_TYPE_SWAP),
/* harmony export */   "ID_TX_TYPE_SWAP_OR_SEND": () => (/* binding */ ID_TX_TYPE_SWAP_OR_SEND),
/* harmony export */   "ID_TX_TYPE_TICKET_PURCHASE": () => (/* binding */ ID_TX_TYPE_TICKET_PURCHASE),
/* harmony export */   "ID_TX_TYPE_TICKET_REVOCATION": () => (/* binding */ ID_TX_TYPE_TICKET_REVOCATION),
/* harmony export */   "ID_TX_TYPE_TICKET_VOTE": () => (/* binding */ ID_TX_TYPE_TICKET_VOTE),
/* harmony export */   "ID_TX_TYPE_UNKNOWN": () => (/* binding */ ID_TX_TYPE_UNKNOWN),
/* harmony export */   "ID_UNAVAILABLE": () => (/* binding */ ID_UNAVAILABLE),
/* harmony export */   "ID_UNKNOWN": () => (/* binding */ ID_UNKNOWN),
/* harmony export */   "ID_UNSUPPORTED_ASSET_INFO_ERR_MSG": () => (/* binding */ ID_UNSUPPORTED_ASSET_INFO_ERR_MSG),
/* harmony export */   "ID_USER_LIMIT_TOO_LOW": () => (/* binding */ ID_USER_LIMIT_TOO_LOW),
/* harmony export */   "ID_VERSION_NOT_SUPPORTED": () => (/* binding */ ID_VERSION_NOT_SUPPORTED),
/* harmony export */   "ID_WAITING_FOR_CONFS": () => (/* binding */ ID_WAITING_FOR_CONFS),
/* harmony export */   "ID_WALLET_DISABLED_MSG": () => (/* binding */ ID_WALLET_DISABLED_MSG),
/* harmony export */   "ID_WALLET_ENABLED_MSG": () => (/* binding */ ID_WALLET_ENABLED_MSG),
/* harmony export */   "ID_WALLET_NOT_SYNCED": () => (/* binding */ ID_WALLET_NOT_SYNCED),
/* harmony export */   "ID_WALLET_NO_PEERS": () => (/* binding */ ID_WALLET_NO_PEERS),
/* harmony export */   "ID_WALLET_PENDING": () => (/* binding */ ID_WALLET_PENDING),
/* harmony export */   "ID_WALLET_READY": () => (/* binding */ ID_WALLET_READY),
/* harmony export */   "ID_WALLET_RECOVERY_SUPPORT_MSG": () => (/* binding */ ID_WALLET_RECOVERY_SUPPORT_MSG),
/* harmony export */   "ID_WALLET_SYNC_FINISHING_UP": () => (/* binding */ ID_WALLET_SYNC_FINISHING_UP),
/* harmony export */   "ID_WALLET_SYNC_PROGRESS": () => (/* binding */ ID_WALLET_SYNC_PROGRESS),
/* harmony export */   "ID_WALLET_UNLOCKED": () => (/* binding */ ID_WALLET_UNLOCKED),
/* harmony export */   "ID_WITHDRAW_ERROR": () => (/* binding */ ID_WITHDRAW_ERROR),
/* harmony export */   "loadLocale": () => (/* binding */ loadLocale),
/* harmony export */   "prep": () => (/* binding */ prep)
/* harmony export */ });
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


const ID_NO_PASS_ERROR_MSG = 'NO_PASS_ERROR_MSG';
const ID_NO_APP_PASS_ERROR_MSG = 'NO_APP_PASS_ERROR_MSG';
const ID_SET_BUTTON_BUY = 'SET_BUTTON_BUY';
const ID_SET_BUTTON_SELL = 'SET_BUTTON_SELL';
const ID_OFF = 'OFF';
const ID_MAX = 'MAX';
const ID_READY = 'READY';
const ID_NO_WALLET = 'NO_WALLET';
const ID_DISABLED_MSG = 'DISABLED_MSG';
const ID_WALLET_SYNC_PROGRESS = 'WALLET_SYNC_PROGRESS';
const ID_HIDE_ADDITIONAL_SETTINGS = 'HIDE_ADDITIONAL_SETTINGS';
const ID_SHOW_ADDITIONAL_SETTINGS = 'SHOW_ADDITIONAL_SETTINGS';
const ID_BUY = 'BUY';
const ID_SELL = 'SELL';
const ID_NOT_SUPPORTED = 'NOT_SUPPORTED';
const ID_VERSION_NOT_SUPPORTED = 'VERSION_NOT_SUPPORTED';
const ID_CONNECTION_FAILED = 'CONNECTION_FAILED';
const ID_ORDER_PREVIEW = 'ORDER_PREVIEW';
const ID_CALCULATING = 'CALCULATING';
const ID_ESTIMATE_UNAVAILABLE = 'ESTIMATE_UNAVAILABLE';
const ID_NO_ZERO_RATE = 'NO_ZERO_RATE';
const ID_NO_ZERO_QUANTITY = 'NO_ZERO_QUANTITY';
const ID_TRADE = 'TRADE';
const ID_NO_ASSET_WALLET = 'NO_ASSET_WALLET';
const ID_EXECUTED = 'EXECUTED';
const ID_BOOKED = 'BOOKED';
const ID_CANCELING = 'CANCELING';
const ID_PASSWORD_NOT_MATCH = 'PASSWORD_NOT_MATCH';
const ID_ACCT_UNDEFINED = 'ACCT_UNDEFINED';
const ID_KEEP_WALLET_PASS = 'KEEP_WALLET_PASS';
const ID_NEW_WALLET_PASS = 'NEW_WALLET_PASS';
const ID_LOT = 'LOT';
const ID_LOTS = 'LOTS';
const ID_UNKNOWN = 'UNKNOWN';
const ID_EPOCH = 'EPOCH';
const ID_ORDER_SUBMITTING = 'ORDER_SUBMITTING';
const ID_SETTLING = 'SETTLING';
const ID_NO_MATCH = 'NO_MATCH';
const ID_CANCELED = 'CANCELED';
const ID_REVOKED = 'REVOKED';
const ID_WAITING_FOR_CONFS = 'WAITING_FOR_CONFS';
const ID_NONE_SELECTED = 'NONE_SELECTED';
const ID_REGISTRATION_FEE_SUCCESS = 'REGISTRATION_FEE_SUCCESS';
const ID_API_ERROR = 'API_ERROR';
const ID_ADD = 'ADD';
const ID_CREATE = 'CREATE';
const ID_SETUP_WALLET = 'SETUP_WALLET';
const ID_WALLET_READY = 'WALLET_READY';
const ID_CHANGE_WALLET_TYPE = 'CHANGE_WALLET_TYPE';
const ID_KEEP_WALLET_TYPE = 'KEEP_WALLET_TYPE';
const ID_WALLET_PENDING = 'WALLET_PENDING';
const ID_SETUP_NEEDED = 'SETUP_NEEDED';
const ID_SEND_SUCCESS = 'SEND_SUCCESS';
const ID_RECONFIG_SUCCESS = 'RECONFIG_SUCCESS';
const ID_RESCAN_STARTED = 'RESCAN_STARTED';
const ID_NEW_WALLET_SUCCESS = 'NEW_WALLET_SUCCESS';
const ID_WALLET_UNLOCKED = 'WALLET_UNLOCKED';
const ID_SELLING = 'SELLING';
const ID_BUYING = 'BUYING';
const ID_WALLET_DISABLED_MSG = 'WALLET_DISABLED';
const ID_WALLET_ENABLED_MSG = 'WALLET_ENABLED';
const ID_ACTIVE_ORDERS_ERR_MSG = 'ACTIVE_ORDERS_ERR_MSG';
const ID_AVAILABLE = 'AVAILABLE';
const ID_LOCKED = 'LOCKED';
const ID_IMMATURE = 'IMMATURE';
const ID_FEE_BALANCE = 'FEE_BALANCE';
const ID_CANDLES_LOADING = 'CANDLES_LOADING';
const ID_DEPTH_LOADING = 'DEPTH_LOADING';
const ID_INVALID_ADDRESS_MSG = 'INVALID_ADDRESS_MSG';
const ID_TXFEE_UNSUPPORTED = 'TXFEE_UNSUPPORTED';
const ID_TXFEE_ERR_MSG = 'TXFEE_ERR_MSG';
const ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG = 'ACTIVE_ORDERS_LOGOUT_ERR_MSG';
const ID_INVALID_DATE_ERR_MSG = 'INVALID_DATE_ERR_MSG';
const ID_NO_ARCHIVED_RECORDS = 'NO_ARCHIVED_RECORDS';
const ID_DELETE_ARCHIVED_RECORDS_RESULT = 'DELETE_ARCHIVED_RECORDS_RESULT';
const ID_ARCHIVED_RECORDS_PATH = 'ARCHIVED_RECORDS_PATH';
const ID_DEFAULT = 'DEFAULT';
const ID_ADDED = 'ADDED';
const ID_DISCOVERED = 'DISCOVERED';
const ID_UNSUPPORTED_ASSET_INFO_ERR_MSG = 'UNSUPPORTED_ASSET_INFO_ERR_MSG';
const ID_LIMIT_ORDER = 'LIMIT_ORDER';
const ID_LIMIT_ORDER_IMMEDIATE_TIF = 'LIMIT_ORDER_IMMEDIATE_TIF';
const ID_MARKET_ORDER = 'MARKET_ORDER';
const ID_CANCEL_ORDER = 'CANCEL_ORDER';
const ID_MATCH_STATUS_NEWLY_MATCHED = 'MATCH_STATUS_NEWLY_MATCHED';
const ID_MATCH_STATUS_MAKER_SWAP_CAST = 'MATCH_STATUS_MAKER_SWAP_CAST';
const ID_MATCH_STATUS_TAKER_SWAP_CAST = 'MATCH_STATUS_TAKER_SWAP_CAST';
const ID_MATCH_STATUS_MAKER_REDEEMED = 'MATCH_STATUS_MAKER_REDEEMED';
const ID_MATCH_STATUS_REDEMPTION_SENT = 'MATCH_STATUS_REDEMPTION_SENT';
const ID_MATCH_STATUS_REDEMPTION_CONFIRMED = 'MATCH_REDEMPTION_CONFIRMED';
const ID_MATCH_STATUS_REVOKED = 'MATCH_STATUS_REVOKED';
const ID_MATCH_STATUS_REFUNDED = 'MATCH_STATUS_REFUNDED';
const ID_MATCH_STATUS_REFUND_PENDING = 'MATCH_STATUS_REFUND_PENDING';
const ID_MATCH_STATUS_REDEEM_PENDING = 'MATCH_STATUS_REDEEM_PENDING';
const ID_MATCH_STATUS_COMPLETE = 'MATCH_STATUS_COMPLETE';
const ID_TAKER_FOUND_MAKER_REDEMPTION = 'TAKER_FOUND_MAKER_REDEMPTION';
const ID_OPEN_WALLET_ERR_MSG = 'OPEN_WALLET_ERR_MSG';
const ID_ORDER_ACCELERATION_FEE_ERR_MSG = 'ORDER_ACCELERATION_FEE_ERR_MSG';
const ID_ORDER_ACCELERATION_ERR_MSG = 'ORDER_ACCELERATION_ERR_MSG';
const ID_CONNECTED = 'CONNECTED';
const ID_DISCONNECTED = 'DISCONNECTED';
const ID_INVALID_CERTIFICATE = 'INVALID_CERTIFICATE';
const ID_CONFIRMATIONS = 'CONFIRMATIONS';
const ID_TAKER = 'TAKER';
const ID_MAKER = 'MAKER';
const ID_EMPTY_DEX_ADDRESS_MSG = 'EMPTY_DEX_ADDRESS_MSG';
const ID_SELECT_WALLET_FOR_FEE_PAYMENT = 'SELECT_WALLET_FOR_FEE_PAYMENT';
const ID_UNAVAILABLE = 'UNAVAILABLE';
const ID_WALLET_SYNC_FINISHING_UP = 'WALLET_SYNC_FINISHING_UP';
const ID_CONNECT_WALLET_ERR_MSG = 'CONNECTING_WALLET_ERR_MSG';
const ID_REFUND_IMMINENT = 'REFUND_IMMINENT';
const ID_REFUND_WILL_HAPPEN_AFTER = 'REFUND_WILL_HAPPEN_AFTER';
const ID_AVAILABLE_TITLE = 'AVAILABLE_TITLE';
const ID_LOCKED_TITLE = 'LOCKED_TITLE';
const ID_IMMATURE_TITLE = 'IMMATURE_TITLE';
const ID_SWAPPING = 'SWAPPING';
const ID_BONDED = 'BONDED';
const ID_LOCKED_BAL_MSG = 'LOCKED_BAL_MSG';
const ID_IMMATURE_BAL_MSG = 'IMMATURE_BAL_MSG';
const ID_LOCKED_SWAPPING_BAL_MSG = 'LOCKED_SWAPPING_BAL_MSG';
const ID_LOCKED_BOND_BAL_MSG = 'LOCKED_BOND_BAL_MSG';
const ID_RESERVES_DEFICIT = 'RESERVES_DEFICIT';
const ID_RESERVES_DEFICIT_MSG = 'RESERVES_DEFICIT_MSG';
const ID_BOND_RESERVES = 'BOND_RESERVES';
const ID_BOND_RESERVES_MSG = 'BOND_RESERVES_MSG';
const ID_SHIELDED = 'SHIELDED';
const ID_TRANSPARENT = 'TRANSPARENT';
const ID_SHIELDED_MSG = 'SHIELDED_MSG';
const ID_ORDER = 'ORDER';
const ID_LOCKED_ORDER_BAL_MSG = 'LOCKED_ORDER_BAL_MSG';
const ID_CREATING_WALLETS = 'CREATING_WALLETS';
const ID_ADDING_SERVERS = 'ADDING_SERVER';
const ID_WALLET_RECOVERY_SUPPORT_MSG = 'WALLET_RECOVERY_SUPPORT_MSG';
const ID_TICKETS_PURCHASED = 'TICKETS_PURCHASED';
const ID_TICKET_STATUS_UNKNOWN = 'TICKET_STATUS_UNKNOWN';
const ID_TICKET_STATUS_UNMINED = 'TICKET_STATUS_UNMINED';
const ID_TICKET_STATUS_IMMATURE = 'TICKET_STATUS_IMMATURE';
const ID_TICKET_STATUS_LIVE = 'TICKET_STATUS_LIVE';
const ID_TICKET_STATUS_VOTED = 'TICKET_STATUS_VOTED';
const ID_TICKET_STATUS_MISSED = 'TICKET_STATUS_MISSED';
const ID_TICKET_STATUS_EXPIRED = 'TICKET_STATUS_EXPIRED';
const ID_TICKET_STATUS_UNSPENT = 'TICKET_STATUS_UNSPENT';
const ID_TICKET_STATUS_REVOKED = 'TICKET_STATUS_REVOKED';
const ID_PASSWORD_RESET_SUCCESS_MSG = 'PASSWORD_RESET_SUCCESS_MSG';
const ID_BROWSER_NTFN_ENABLED = 'BROWSER_NTFN_ENABLED';
const ID_BROWSER_NTFN_ORDERS = 'BROWSER_NTFN_ORDERS';
const ID_BROWSER_NTFN_MATCHES = 'BROWSER_NTFN_MATCHES';
const ID_BROWSER_NTFN_BONDS = 'BROWSER_NTFN_BONDS';
const ID_BROWSER_NTFN_CONNECTIONS = 'BROWSER_NTFN_CONNECTIONS';
const ID_ORDER_BUTTON_BUY_BALANCE_ERROR = 'ORDER_BUTTON_BUY_BALANCE_ERROR';
const ID_ORDER_BUTTON_SELL_BALANCE_ERROR = 'ORDER_BUTTON_SELL_BALANCE_ERROR';
const ID_ORDER_BUTTON_QTY_ERROR = 'ORDER_BUTTON_QTY_ERROR';
const ID_ORDER_BUTTON_QTY_RATE_ERROR = 'ORDER_BUTTON_QTY_RATE_ERROR';
const ID_CREATE_ASSET_WALLET_MSG = 'CREATE_ASSET_WALLET_MSG';
const ID_NO_WALLET_MSG = 'NO_WALLET_MSG';
const ID_TRADING_TIER_UPDATED = 'TRADING_TIER_UPDATED';
const ID_INVALID_TIER_VALUE = 'INVALID_TIER_VALUE';
const ID_INVALID_COMPS_VALUE = 'INVALID_COMPS_VALUE';
const ID_TX_TYPE_UNKNOWN = 'TX_TYPE_UNKNOWN';
const ID_TX_TYPE_SEND = 'TX_TYPE_SEND';
const ID_TX_TYPE_RECEIVE = 'TX_TYPE_RECEIVE';
const ID_TX_TYPE_SWAP = 'TX_TYPE_SWAP';
const ID_TX_TYPE_REDEEM = 'TX_TYPE_REDEEM';
const ID_TX_TYPE_REFUND = 'TX_TYPE_REFUND';
const ID_TX_TYPE_SPLIT = 'TX_TYPE_SPLIT';
const ID_TX_TYPE_CREATE_BOND = 'TX_TYPE_CREATE_BOND';
const ID_TX_TYPE_REDEEM_BOND = 'TX_TYPE_REDEEM_BOND';
const ID_TX_TYPE_APPROVE_TOKEN = 'TX_TYPE_APPROVE_TOKEN';
const ID_TX_TYPE_ACCELERATION = 'TX_TYPE_ACCELERATION';
const ID_TX_TYPE_SELF_TRANSFER = 'TX_TYPE_SELF_TRANSFER';
const ID_TX_TYPE_REVOKE_TOKEN_APPROVAL = 'TX_TYPE_REVOKE_TOKEN_APPROVAL';
const ID_TX_TYPE_TICKET_PURCHASE = 'TX_TYPE_TICKET_PURCHASE';
const ID_TX_TYPE_TICKET_VOTE = 'TX_TYPE_TICKET_VOTE';
const ID_TX_TYPE_TICKET_REVOCATION = 'TX_TYPE_TICKET_REVOCATION';
const ID_TX_TYPE_SWAP_OR_SEND = 'TX_TYPE_SWAP_OR_SEND';
const ID_TX_TYPE_MIX = 'TX_TYPE_MIX';
const ID_SWAP_OR_SEND_TOOLTIP = 'SWAP_OR_SEND_TOOLTIP';
const ID_MISSING_CEX_CREDS = 'MISSING_CEX_CREDS';
const ID_MATCH_BUFFER = 'MATCH_BUFFER';
const ID_NO_PLACEMENTS = 'NO_PLACEMENTS';
const ID_INVALID_VALUE = 'INVALID_VALUE';
const ID_NO_ZERO = 'NO_ZERO';
const ID_BOTTYPE_BASIC_MM = 'BOTTYPE_BASIC_MM';
const ID_BOTTYPE_ARB_MM = 'BOTTYPE_ARB_MM';
const ID_BOTTYPE_SIMPLE_ARB = 'BOTTYPE_SIMPLE_ARB';
const ID_NO_BOTTYPE = 'NO_BOTTYPE';
const ID_NO_CEX = 'NO_CEX';
const ID_CEXBALANCE_ERR = 'CEXBALANCE_ERR';
const ID_PENDING = 'PENDING';
const ID_COMPLETE = 'COMPLETE';
const ID_ARCHIVED_SETTINGS = 'ARCHIVED_SETTINGS';
const ID_NO_CODE_PROVIDED = 'NO_CODE_PROVIDED';
const ID_ENABLE_ACCOUNT = 'ENABLE_ACCOUNT';
const ID_DISABLE_ACCOUNT = 'DISABLE_ACCOUNT';
const ID_ACCOUNT_DISABLED_MSG = 'ACCOUNT_DISABLED_MSG';
const ID_DEX_DISABLED_MSG = 'DEX_DISABLED_MSG';
const ID_WALLET_NOT_SYNCED = 'WALLET_NOT_SYNCED';
const ID_WALLET_NO_PEERS = 'WALLET_NO_PEERS';
const ID_DEPOSIT_ERROR = 'DEPOSIT_ERROR';
const ID_WITHDRAW_ERROR = 'WITHDRAW_ERROR';
const ID_DEX_UNDERFUNDED = 'DEX_UNDERFUNDED';
const ID_CEX_UNDERFUNDED = 'CEX_UNDERFUNDED';
const ID_CEX_TOO_SHALLOW = 'CEX_TOO_SHALLOW';
const ID_ACCOUNT_SUSPENDED = 'ACCOUNT_SUSPENDED';
const ID_USER_LIMIT_TOO_LOW = 'USER_LIMIT_TOO_LOW';
const ID_NO_PRICE_SOURCE = 'NO_PRICE_SOURCE';
const ID_CEX_ORDERBOOK_UNSYNCED = 'CEX_ORDERBOOK_UNSYNCED';
const ID_DETERMINE_PLACEMENTS_ERROR = 'DETERMINE_PLACEMENTS_ERROR';
const ID_PLACE_BUY_ORDERS_ERROR = 'PLACE_BUY_ORDERS_ERROR';
const ID_PLACE_SELL_ORDERS_ERROR = 'PLACE_SELL_ORDERS_ERROR';
const ID_CEX_TRADE_ERROR = 'CEX_TRADE_ERROR';
const ID_ORDER_REPORT_TITLE = 'ORDER_REPORT_TITLE';
const ID_CEX_BALANCES = 'CEX_BALANCES';
const ID_CAUSES_SELF_MATCH = 'CAUSES_SELF_MATCH';
let locale;
function loadLocale(lang, commitHash, skipCache) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!skipCache) {
            const specs = _state__WEBPACK_IMPORTED_MODULE_0__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeSpecsKey);
            if (specs && specs.lang === lang && specs.commitHash === commitHash) {
                locale = _state__WEBPACK_IMPORTED_MODULE_0__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeKey);
                return;
            }
        }
        locale = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/locale', lang);
        _state__WEBPACK_IMPORTED_MODULE_0__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeSpecsKey, { lang, commitHash });
        _state__WEBPACK_IMPORTED_MODULE_0__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeKey, locale);
    });
}
/* prep will format the message to the current locale. */
function prep(k, args) {
    return stringTemplateParser(locale[k], args || {});
}
window.clearLocale = () => {
    _state__WEBPACK_IMPORTED_MODULE_0__["default"].removeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeSpecsKey);
    _state__WEBPACK_IMPORTED_MODULE_0__["default"].removeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeKey);
};
/*
 * stringTemplateParser is a template string matcher, where expression is any
 * text. It switches what is inside double brackets (e.g. 'buy {{ asset }}')
 * for the value described into args. args is an object with keys
 * equal to the placeholder keys. (e.g. {"asset": "dcr"}).
 * So that will be switched for: 'asset dcr'.
 */
function stringTemplateParser(expression, args) {
    // templateMatcher matches any text which:
    // is some {{ text }} between two brackets, and a space between them.
    // It is global, therefore it will change all occurrences found.
    // text can be anything, but brackets '{}' and space '\s'
    const templateMatcher = /{{\s?([^{}\s]*)\s?}}/g;
    return expression.replace(templateMatcher, (_, value) => args[value]);
}


/***/ }),

/***/ "./src/js/login.ts":
/*!*************************!*\
  !*** ./src/js/login.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ LoginPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/*
  LoginPage holds the form for login and password reset.
*/
class LoginPage extends _basepage__WEBPACK_IMPORTED_MODULE_2__["default"] {
    constructor(body) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].idDescendants(body);
        this.loginForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.LoginForm(page.loginForm, () => { this.loggedIn(); });
        const prepAndDisplayLoginForm = () => {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.resetAppPWForm);
            this.loginForm.refresh();
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.loginForm);
            this.loginForm.focus();
        };
        prepAndDisplayLoginForm();
        this.appPassResetForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.AppPassResetForm(page.resetAppPWForm, () => { prepAndDisplayLoginForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.forgotPassBtn, 'click', () => {
            this.appPassResetForm.refresh();
            (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.loginForm, page.resetAppPWForm);
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.resetPassFormCloser, 'click', () => { prepAndDisplayLoginForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_1__["default"].mouseInElement(e, page.resetAppPWForm) && _doc__WEBPACK_IMPORTED_MODULE_1__["default"].isDisplayed(page.resetAppPWForm)) {
                prepAndDisplayLoginForm();
            }
        });
    }
    /* login submits the sign-in form and parses the result. */
    loggedIn() {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('wallets');
        });
    }
}


/***/ }),

/***/ "./src/js/markets.ts":
/*!***************************!*\
  !*** ./src/js/markets.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketsPage),
/* harmony export */   "marketID": () => (/* binding */ marketID)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderbook__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./orderbook */ "./src/js/orderbook.ts");
/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./account */ "./src/js/account.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _ws__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ws */ "./src/js/ws.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};














const bind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind;
const bookRoute = 'book';
const bookOrderRoute = 'book_order';
const unbookOrderRoute = 'unbook_order';
const updateRemainingRoute = 'update_remaining';
const epochOrderRoute = 'epoch_order';
const candlesRoute = 'candles';
const candleUpdateRoute = 'candle_update';
const unmarketRoute = 'unmarket';
const epochMatchSummaryRoute = 'epoch_match_summary';
const anHour = 60 * 60 * 1000; // milliseconds
const maxUserOrdersShown = 10;
const buyBtnClass = 'buygreen-bg';
const sellBtnClass = 'sellred-bg';
const fiveMinBinKey = '5m';
const oneHrBinKey = '1h';
const percentFormatter = new Intl.NumberFormat(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
    minimumFractionDigits: 1,
    maximumFractionDigits: 2
});
const parentIDNone = 0xFFFFFFFF;
class MarketsPage extends _basepage__WEBPACK_IMPORTED_MODULE_2__["default"] {
    constructor(main, pageParams) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(main);
        this.main = main;
        if (!this.main.parentElement)
            return; // Not gonna happen, but TypeScript cares.
        // There may be multiple pending updates to the max order. This makes sure
        // that the screen is updated with the most recent one.
        this.maxOrderUpdateCounter = 0;
        this.metaOrders = {};
        this.recentMatches = [];
        this.preorderCache = {};
        this.depthLines = {
            hover: [],
            input: []
        };
        this.hovers = [];
        // 'Recent Matches' list sort key and direction.
        this.recentMatchesSortKey = 'age';
        this.recentMatchesSortDirection = -1;
        // store original title so we can re-append it when updating market value.
        this.ogTitle = document.title;
        this.forms = new _forms__WEBPACK_IMPORTED_MODULE_7__.Forms(page.forms);
        const depthReporters = {
            click: (x) => { this.reportDepthClick(x); },
            volume: (r) => { this.reportDepthVolume(r); },
            mouse: (r) => { this.reportDepthMouse(r); },
            zoom: (z) => { this.reportDepthZoom(z); }
        };
        this.depthChart = new _charts__WEBPACK_IMPORTED_MODULE_5__.DepthChart(page.depthChart, depthReporters, _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].depthZoomLK));
        const candleReporters = {
            mouse: c => { this.reportMouseCandle(c); }
        };
        this.candleChart = new _charts__WEBPACK_IMPORTED_MODULE_5__.CandleChart(page.candlesChart, candleReporters);
        const success = () => { };
        // Do not call cleanTemplates before creating the AccelerateOrderForm
        this.accelerateOrderForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.AccelerateOrderForm(page.accelerateForm, success);
        this.approveTokenForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.TokenApprovalForm(page.approveTokenForm);
        // Set user's last known candle duration.
        this.candleDur = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastCandleDurationLK) || oneHrBinKey;
        // Setup the register to trade button.
        // TODO: Use dexsettings page?
        const registerBttn = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(page.notRegistered, 'registerBttn');
        bind(registerBttn, 'click', () => {
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loadPage('register', { host: this.market.dex.host });
        });
        // Set up the BalanceWidget.
        {
            page.walletInfoTmpl.removeAttribute('id');
            const bWidget = page.walletInfoTmpl;
            const qWidget = page.walletInfoTmpl.cloneNode(true);
            bWidget.after(qWidget);
            const wgt = this.balanceWgt = new BalanceWidget(bWidget, qWidget);
            const baseIcons = wgt.base.stateIcons.icons;
            const quoteIcons = wgt.quote.stateIcons.icons;
            bind(wgt.base.tmpl.connect, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(wgt.quote.tmpl.connect, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(wgt.base.tmpl.expired, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(wgt.quote.tmpl.expired, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(baseIcons.sleeping, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(quoteIcons.sleeping, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(baseIcons.locked, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(quoteIcons.locked, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(baseIcons.disabled, 'click', () => { this.showToggleWalletStatus(this.market.base); });
            bind(quoteIcons.disabled, 'click', () => { this.showToggleWalletStatus(this.market.quote); });
            bind(wgt.base.tmpl.newWalletBttn, 'click', () => { this.showCreate(this.market.base); });
            bind(wgt.quote.tmpl.newWalletBttn, 'click', () => { this.showCreate(this.market.quote); });
            bind(wgt.base.tmpl.walletAddr, 'click', () => { this.showDeposit(this.market.base.id); });
            bind(wgt.quote.tmpl.walletAddr, 'click', () => { this.showDeposit(this.market.quote.id); });
            bind(wgt.base.tmpl.wantProviders, 'click', () => { this.showCustomProviderDialog(this.market.base.id); });
            bind(wgt.quote.tmpl.wantProviders, 'click', () => { this.showCustomProviderDialog(this.market.quote.id); });
            this.depositAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.DepositAddress(page.deposit);
        }
        this.mm = new _mmutil__WEBPACK_IMPORTED_MODULE_13__.RunningMarketMakerDisplay(page.mmRunning, this.forms, page.orderReportForm, 'markets');
        this.reputationMeter = new _account__WEBPACK_IMPORTED_MODULE_4__.ReputationMeter(page.reputationMeter);
        // Bind toggle wallet status form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.toggleWalletStatusConfirm, page.toggleWalletStatusSubmit, () => __awaiter(this, void 0, void 0, function* () { this.toggleWalletStatus(); }));
        // Prepare templates for the buy and sell tables and the user's order table.
        (0,_opts__WEBPACK_IMPORTED_MODULE_12__.setOptionTemplates)(page);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.orderRowTmpl, page.durBttnTemplate, page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl, page.userOrderTmpl, page.recentMatchesTemplate);
        // Buttons to show token approval form
        bind(page.approveBaseBttn, 'click', () => { this.showTokenApprovalForm(true); });
        bind(page.approveQuoteBttn, 'click', () => { this.showTokenApprovalForm(false); });
        const toggleTradingTier = (show) => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!show, page.showTradingTier);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(show, page.tradingLimits, page.hideTradingTier);
        };
        bind(page.showTradingTier, 'click', () => { toggleTradingTier(true); });
        bind(page.hideTradingTier, 'click', () => { toggleTradingTier(false); });
        const toggleTradingReputation = (show) => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!show, page.showTradingReputation);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(show, page.reputationMeter, page.hideTradingReputation);
        };
        bind(page.showTradingReputation, 'click', () => { toggleTradingReputation(true); });
        bind(page.hideTradingReputation, 'click', () => { toggleTradingReputation(false); });
        // Buttons to set order type and side.
        bind(page.buyBttn, 'click', () => { this.setBuy(); });
        bind(page.sellBttn, 'click', () => { this.setSell(); });
        bind(page.limitBttn, 'click', () => {
            swapBttns(page.marketBttn, page.limitBttn);
            this.setOrderVisibility();
            if (!page.rateField.value)
                return;
            this.depthLines.input = [{
                    rate: (0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.rateField.value, 0),
                    color: this.isSell() ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine
                }];
            this.drawChartLines();
        });
        bind(page.marketBttn, 'click', () => {
            swapBttns(page.limitBttn, page.marketBttn);
            this.setOrderVisibility();
            this.setMarketBuyOrderEstimate();
            this.depthLines.input = [];
            this.drawChartLines();
        });
        bind(page.maxOrd, 'click', () => {
            if (this.isSell()) {
                const maxSell = this.market.maxSell;
                if (!maxSell)
                    return;
                page.lotField.value = String(maxSell.swap.lots);
            }
            else {
                const maxBuy = this.market.maxBuys[this.adjustedRate()];
                if (!maxBuy)
                    return;
                page.lotField.value = String(maxBuy.swap.lots);
            }
            this.lotChanged();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].disableMouseWheel(page.rateField, page.lotField, page.qtyField, page.mktBuyField);
        // Handle the full orderbook sent on the 'book' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(bookRoute, (data) => { this.handleBookRoute(data); });
        // Handle the new order for the order book on the 'book_order' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(bookOrderRoute, (data) => { this.handleBookOrderRoute(data); });
        // Remove the order sent on the 'unbook_order' route from the orderbook.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(unbookOrderRoute, (data) => { this.handleUnbookOrderRoute(data); });
        // Update the remaining quantity on a booked order.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(updateRemainingRoute, (data) => { this.handleUpdateRemainingRoute(data); });
        // Handle the new order for the order book on the 'epoch_order' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(epochOrderRoute, (data) => { this.handleEpochOrderRoute(data); });
        // Handle the initial candlestick data on the 'candles' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(candlesRoute, (data) => { this.handleCandlesRoute(data); });
        // Handle the candles update on the 'candles' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(candleUpdateRoute, (data) => { this.handleCandleUpdateRoute(data); });
        // Handle the recent matches update on the 'epoch_report' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(epochMatchSummaryRoute, (data) => { this.handleEpochMatchSummary(data); });
        // Create a wallet
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.NewWalletForm(page.newWalletForm, () => __awaiter(this, void 0, void 0, function* () { this.createWallet(); }));
        // Main order form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.orderForm, page.submitBttn, () => __awaiter(this, void 0, void 0, function* () { this.stepSubmit(); }));
        // Order verification form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.verifyForm, page.vSubmit, () => __awaiter(this, void 0, void 0, function* () { this.submitOrder(); }));
        // Cancel order form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.cancelForm, page.cancelSubmit, () => __awaiter(this, void 0, void 0, function* () { this.submitCancel(); }));
        // Order detail view.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.vFeeDetails, 'click', () => this.forms.show(page.vDetailPane));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.closeDetailPane, 'click', () => this.showVerifyForm());
        // // Bind active orders list's header sort events.
        page.recentMatchesTable.querySelectorAll('[data-ordercol]')
            .forEach((th) => bind(th, 'click', () => setRecentMatchesSortCol(th.dataset.ordercol || '')));
        const setRecentMatchesSortCol = (key) => {
            // First unset header's current sorted col classes.
            unsetRecentMatchesSortColClasses();
            if (this.recentMatchesSortKey === key) {
                this.recentMatchesSortDirection *= -1;
            }
            else {
                this.recentMatchesSortKey = key;
                this.recentMatchesSortDirection = 1;
            }
            this.refreshRecentMatchesTable();
            setRecentMatchesSortColClasses();
        };
        // sortClassByDirection receives a sort direction and return a class based on it.
        const sortClassByDirection = (element) => {
            if (element === 1)
                return 'sorted-asc';
            return 'sorted-dsc';
        };
        const unsetRecentMatchesSortColClasses = () => {
            page.recentMatchesTable.querySelectorAll('[data-ordercol]')
                .forEach(th => th.classList.remove('sorted-asc', 'sorted-dsc'));
        };
        const setRecentMatchesSortColClasses = () => {
            const key = this.recentMatchesSortKey;
            const sortCls = sortClassByDirection(this.recentMatchesSortDirection);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(page.recentMatchesTable, `[data-ordercol=${key}]`).classList.add(sortCls);
        };
        // Set default's sorted col header classes.
        setRecentMatchesSortColClasses();
        const closePopups = () => {
            this.forms.close();
        };
        // If the user clicks outside of a form, it should close the page overlay.
        bind(page.forms, 'mousedown', (e) => {
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.vDetailPane) && !_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, page.vDetailPane))
                return this.showVerifyForm();
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                closePopups();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                closePopups();
            }
        };
        bind(document, 'keyup', this.keyup);
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { closePopups(); });
        });
        // Event listeners for interactions with the various input fields.
        bind(page.lotField, ['change', 'keyup'], () => { this.lotChanged(); });
        bind(page.qtyField, 'change', () => { this.quantityChanged(true); });
        bind(page.qtyField, 'keyup', () => { this.quantityChanged(false); });
        bind(page.mktBuyField, ['change', 'keyup'], () => { this.marketBuyChanged(); });
        bind(page.rateField, 'change', () => { this.rateFieldChanged(); });
        bind(page.rateField, 'keyup', () => { this.previewQuoteAmt(true); });
        // Market search input bindings.
        bind(page.marketSearchV1, ['change', 'keyup'], () => { this.filterMarkets(); });
        // Acknowledge the order disclaimer.
        const setDisclaimerAckViz = (acked) => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!acked, page.disclaimer, page.disclaimerAck);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(acked, page.showDisclaimer);
        };
        bind(page.disclaimerAck, 'click', () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].orderDisclaimerAckedLK, true);
            setDisclaimerAckViz(true);
        });
        bind(page.showDisclaimer, 'click', () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].orderDisclaimerAckedLK, false);
            setDisclaimerAckViz(false);
        });
        setDisclaimerAckViz(_state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].orderDisclaimerAckedLK));
        const clearChartLines = () => {
            this.depthLines.hover = [];
            this.drawChartLines();
        };
        bind(page.buyRows, 'mouseleave', clearChartLines);
        bind(page.sellRows, 'mouseleave', clearChartLines);
        bind(page.userOrders, 'mouseleave', () => {
            this.activeMarkerRate = null;
            this.setDepthMarkers();
        });
        const stats0 = page.marketStats;
        const stats1 = stats0.cloneNode(true);
        stats1.classList.add('listopen');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(stats0, stats1);
        stats1.removeAttribute('id');
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().headerSpace.appendChild(stats1);
        this.stats = [{ row: stats0, tmpl: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(stats0) }, { row: stats1, tmpl: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(stats1) }];
        const closeMarketsList = () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].leftMarketDockLK, '0');
            page.leftMarketDock.classList.remove('default');
            page.leftMarketDock.classList.add('stashed');
            for (const s of this.stats)
                s.row.classList.remove('listopen');
        };
        const openMarketsList = () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].leftMarketDockLK, '1');
            page.leftMarketDock.classList.remove('default', 'stashed');
            for (const s of this.stats)
                s.row.classList.add('listopen');
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.leftHider, 'click', () => closeMarketsList());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.marketReopener, 'click', () => openMarketsList());
        for (const s of this.stats) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(s.tmpl.marketSelect, 'click', () => {
                if (page.leftMarketDock.clientWidth === 0)
                    openMarketsList();
                else
                    closeMarketsList();
            });
        }
        this.marketList = new MarketList(page.marketListV1);
        // Prepare the list of markets.
        for (const row of this.marketList.markets) {
            bind(row.node, 'click', () => {
                var _a, _b, _c, _d;
                // return early if the market is already set
                const { quoteid: quoteID, baseid: baseID, xc: { host } } = row.mkt;
                if (((_b = (_a = this.market) === null || _a === void 0 ? void 0 : _a.base) === null || _b === void 0 ? void 0 : _b.id) === baseID && ((_d = (_c = this.market) === null || _c === void 0 ? void 0 : _c.quote) === null || _d === void 0 ? void 0 : _d.id) === quoteID)
                    return;
                this.startLoadingAnimations();
                this.setMarket(host, baseID, quoteID);
            });
        }
        if (_state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].leftMarketDockLK) !== '1') { // It is shown by default, hiding if necessary.
            closeMarketsList();
        }
        // Notification filters.
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().registerNoteFeeder({
            order: (note) => { this.handleOrderNote(note); },
            match: (note) => { this.handleMatchNote(note); },
            epoch: (note) => { this.handleEpochNote(note); },
            conn: (note) => { this.handleConnNote(note); },
            balance: (note) => { this.handleBalanceNote(note); },
            bondpost: (note) => { this.handleBondUpdate(note); },
            spots: (note) => { this.handlePriceUpdate(note); },
            walletstate: (note) => { this.handleWalletState(note); },
            reputation: () => { this.updateReputation(); },
            feepayment: () => { this.updateReputation(); },
            runstats: (note) => {
                this.mm.update();
                if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host)
                    return;
                if (Boolean(this.mmRunning) !== Boolean(note.stats)) {
                    this.mmRunning = Boolean(note.stats);
                    this.resolveOrderFormVisibility();
                }
            },
            epochreport: (note) => {
                if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host)
                    return;
                this.mm.handleEpochReportNote(note);
            },
            cexproblems: (note) => {
                if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host)
                    return;
                this.mm.handleCexProblemsNote(note);
            },
            runevent: (note) => {
                if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host)
                    return;
                this.mm.update();
            }
        });
        this.loadingAnimations = {};
        this.startLoadingAnimations();
        // Start a ticker to update time-since values.
        this.secondTicker = window.setInterval(() => {
            var _a;
            for (const mord of Object.values(this.metaOrders)) {
                mord.details.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(mord.ord.submitTime);
            }
            for (const td of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.recentMatchesLiveList, '[data-tmpl=age]')) {
                td.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseFloat((_a = td.dataset.sinceStamp) !== null && _a !== void 0 ? _a : '0'));
            }
        }, 1000);
        this.init(pageParams);
    }
    init(pageParams) {
        return __awaiter(this, void 0, void 0, function* () {
            // Fetch the first market in the list, or the users last selected market, if
            // it exists.
            let selected;
            if (pageParams === null || pageParams === void 0 ? void 0 : pageParams.host) {
                selected = makeMarket(pageParams.host, parseInt(pageParams.baseID), parseInt(pageParams.quoteID));
            }
            else {
                selected = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastMarketLK);
            }
            if (!selected || !this.marketList.exists(selected.host, selected.base, selected.quote)) {
                const first = this.marketList.first();
                if (first)
                    selected = { host: first.mkt.xc.host, base: first.mkt.baseid, quote: first.mkt.quoteid };
            }
            if (selected)
                this.setMarket(selected.host, selected.base, selected.quote);
            else
                this.balanceWgt.setBalanceVisibility(false); // no market to display balance widget for.
            // set the initial state for the registration status
            this.setRegistrationStatusVisibility();
        });
    }
    startLoadingAnimations() {
        const { page, loadingAnimations: anis, depthChart, candleChart } = this;
        depthChart.canvas.classList.add('invisible');
        candleChart.canvas.classList.add('invisible');
        if (anis.candles)
            anis.candles.stop();
        anis.candles = new _charts__WEBPACK_IMPORTED_MODULE_5__.Wave(page.candlesChart, { message: _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CANDLES_LOADING) });
        if (anis.depth)
            anis.depth.stop();
        anis.depth = new _charts__WEBPACK_IMPORTED_MODULE_5__.Wave(page.depthChart, { message: _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_DEPTH_LOADING) });
    }
    /* isSell is true if the user has selected sell in the order options. */
    isSell() {
        return this.page.sellBttn.classList.contains('selected');
    }
    /* isLimit is true if the user has selected the "limit order" tab. */
    isLimit() {
        return this.page.limitBttn.classList.contains('selected');
    }
    setBuy() {
        const { page } = this;
        swapBttns(page.sellBttn, page.buyBttn);
        page.submitBttn.classList.remove(sellBtnClass);
        page.submitBttn.classList.add(buyBtnClass);
        page.maxLbl.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BUY);
        this.setOrderBttnText();
        this.setOrderVisibility();
        this.drawChartLines();
        if (!this.isLimit()) {
            this.marketBuyChanged();
        }
        else {
            this.currentOrder = this.parseOrder();
            this.updateOrderBttnState();
        }
    }
    setSell() {
        const { page } = this;
        swapBttns(page.buyBttn, page.sellBttn);
        page.submitBttn.classList.add(sellBtnClass);
        page.submitBttn.classList.remove(buyBtnClass);
        page.maxLbl.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SELL);
        this.setOrderBttnText();
        this.setOrderVisibility();
        this.drawChartLines();
        this.currentOrder = this.parseOrder();
        this.updateOrderBttnState();
    }
    /* hasPendingBonds is true if there are pending bonds */
    hasPendingBonds() {
        return Object.keys(this.market.dex.auth.pendingBonds || []).length > 0;
    }
    /* setCurrMarketPrice updates the current market price on the stats displays
       and the orderbook display. */
    setCurrMarketPrice() {
        const selected = this.market;
        if (!selected)
            return;
        // Get an up-to-date Market.
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[selected.dex.host];
        const mkt = xc.markets[selected.cfg.name];
        if (!mkt.spot)
            return;
        for (const s of this.stats) {
            const { unitInfo: { conventional: { conversionFactor: cFactor, unit } } } = xc.assets[mkt.baseid];
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[mkt.baseid];
            if (fiatRate) {
                s.tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.spot.vol24 / cFactor * fiatRate);
                s.tmpl.volUnit.textContent = 'USD';
            }
            else {
                s.tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.spot.vol24 / cFactor);
                s.tmpl.volUnit.textContent = unit;
            }
            setPriceAndChange(s.tmpl, xc, mkt);
        }
        this.page.obPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.spot.rate / this.market.rateConversionFactor);
        this.page.obPrice.classList.remove('sellcolor', 'buycolor');
        this.page.obPrice.classList.add(mkt.spot.change24 >= 0 ? 'buycolor' : 'sellcolor');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(mkt.spot.change24 >= 0, this.page.obUp);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(mkt.spot.change24 < 0, this.page.obDown);
    }
    /* setMarketDetails updates the currency names on the stats displays. */
    setMarketDetails() {
        if (!this.market)
            return;
        for (const s of this.stats) {
            const { baseCfg: ba, quoteCfg: qa } = this.market;
            s.tmpl.baseIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(ba.symbol);
            s.tmpl.quoteIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(qa.symbol);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(s.tmpl.baseSymbol, s.tmpl.quoteSymbol);
            s.tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(ba, true));
            s.tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(qa, true));
        }
    }
    /* setHighLow calculates the high and low rates over the last 24 hours. */
    setHighLow() {
        var _a;
        let [high, low] = [0, 0];
        const spot = this.market.cfg.spot;
        // Use spot values for 24 hours high and low rates if it is available. We
        // will default to setting it from candles if it's not.
        if (spot && spot.low24 && spot.high24) {
            high = spot.high24;
            low = spot.low24;
        }
        else {
            const cache = (_a = this.market) === null || _a === void 0 ? void 0 : _a.candleCaches[fiveMinBinKey];
            if (!cache) {
                if (this.candleDur !== fiveMinBinKey) {
                    this.requestCandles(fiveMinBinKey);
                    return;
                }
                for (const s of this.stats) {
                    s.tmpl.high.textContent = '-';
                    s.tmpl.low.textContent = '-';
                }
                return;
            }
            // Set high and low rates from candles.
            const aDayAgo = new Date().getTime() - 86400000;
            for (let i = cache.candles.length - 1; i >= 0; i--) {
                const c = cache.candles[i];
                if (c.endStamp < aDayAgo)
                    break;
                if (low === 0 || (c.lowRate > 0 && c.lowRate < low))
                    low = c.lowRate;
                if (c.highRate > high)
                    high = c.highRate;
            }
        }
        const baseID = this.market.base.id;
        const quoteID = this.market.quote.id;
        const dex = this.market.dex;
        for (const s of this.stats) {
            s.tmpl.high.textContent = high > 0 ? _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().conventionalRate(baseID, quoteID, high, dex)) : '-';
            s.tmpl.low.textContent = low > 0 ? _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().conventionalRate(baseID, quoteID, low, dex)) : '-';
        }
    }
    /* assetsAreSupported is true if all the assets of the current market are
     * supported
     */
    assetsAreSupported() {
        var _a, _b, _c, _d;
        const { market: { base, quote, baseCfg, quoteCfg } } = this;
        if (!base || !quote) {
            const symbol = base ? quoteCfg.symbol : baseCfg.symbol;
            return {
                isSupported: false,
                text: _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NOT_SUPPORTED, { asset: symbol.toUpperCase() })
            };
        }
        // check if versions are supported. If asset is a token, we check if its
        // parent supports the version.
        const bVers = (base.token ? (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[base.token.parentID].info) === null || _a === void 0 ? void 0 : _a.versions : (_b = base.info) === null || _b === void 0 ? void 0 : _b.versions);
        const qVers = (quote.token ? (_c = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quote.token.parentID].info) === null || _c === void 0 ? void 0 : _c.versions : (_d = quote.info) === null || _d === void 0 ? void 0 : _d.versions);
        // if none them are token, just check if own asset is supported.
        let text = '';
        if (!bVers.includes(baseCfg.version)) {
            text = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_VERSION_NOT_SUPPORTED, { asset: base.symbol.toUpperCase(), version: baseCfg.version + '' });
        }
        else if (!qVers.includes(quoteCfg.version)) {
            text = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_VERSION_NOT_SUPPORTED, { asset: quote.symbol.toUpperCase(), version: quoteCfg.version + '' });
        }
        return {
            isSupported: bVers.includes(baseCfg.version) && qVers.includes(quoteCfg.version),
            text
        };
    }
    /*
     * setOrderVisibility sets which form is visible based on the specified
     * options.
     */
    setOrderVisibility() {
        const page = this.page;
        if (this.isLimit()) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.priceBox, page.tifBox, page.qtyBox, page.maxBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mktBuyBox);
            this.previewQuoteAmt(true);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.tifBox, page.maxBox, page.priceBox);
            if (this.isSell()) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mktBuyBox);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.qtyBox);
                this.previewQuoteAmt(true);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mktBuyBox);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qtyBox);
                this.previewQuoteAmt(false);
            }
        }
        this.updateOrderBttnState();
    }
    /* resolveOrderFormVisibility displays or hides the 'orderForm' based on
     * a set of conditions to be met.
     */
    resolveOrderFormVisibility() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const showOrderForm = () => __awaiter(this, void 0, void 0, function* () {
                if (!this.assetsAreSupported().isSupported)
                    return false; // assets not supported
                if (!this.market || this.market.dex.auth.effectiveTier < 1)
                    return false; // acct suspended or not registered
                const { baseAssetApprovalStatus, quoteAssetApprovalStatus } = this.tokenAssetApprovalStatuses();
                if (baseAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved || quoteAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved)
                    return false;
                const { base, quote } = this.market;
                const hasWallets = base && (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[base.id].wallet && quote && (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quote.id].wallet;
                if (!hasWallets)
                    return false;
                if (this.mmRunning)
                    return false;
                return true;
            });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(yield showOrderForm(), page.orderForm, page.orderTypeBttns);
            if (this.market) {
                const { auth: { effectiveTier, pendingStrength } } = this.market.dex;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(effectiveTier > 0 || pendingStrength > 0, page.reputationAndTradingTierBox);
            }
            const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().mmStatus;
            if (mmStatus && this.mmRunning === undefined && this.market.base && this.market.quote) {
                const { base: { id: baseID }, quote: { id: quoteID }, dex: { host } } = this.market;
                const botStatus = mmStatus.bots.find(({ config: cfg }) => cfg.baseID === baseID && cfg.quoteID === quoteID && cfg.host === host);
                this.mmRunning = Boolean(botStatus === null || botStatus === void 0 ? void 0 : botStatus.running);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(this.mmRunning, page.mmRunning);
            if (this.mmRunning)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.orderForm, page.orderTypeBttns);
        });
    }
    /* setLoaderMsgVisibility displays a message in case a dex asset is not
     * supported
     */
    setLoaderMsgVisibility() {
        const { page } = this;
        const { isSupported, text } = this.assetsAreSupported();
        if (isSupported) {
            // make sure to hide the loader msg
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.loaderMsg);
            return;
        }
        page.loaderMsg.textContent = text;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.loaderMsg);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.notRegistered);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noWallet);
    }
    /*
     * showTokenApprovalForm displays the form used to give allowance to the
     * swap contract of a token.
     */
    showTokenApprovalForm(isBase) {
        return __awaiter(this, void 0, void 0, function* () {
            const assetID = isBase ? this.market.base.id : this.market.quote.id;
            this.approveTokenForm.setAsset(assetID, this.market.dex.host);
            this.forms.show(this.page.approveTokenForm);
        });
    }
    /*
     * tokenAssetApprovalStatuses returns the approval status of the base and
     * quote assets. If the asset is not a token, it is considered approved.
     */
    tokenAssetApprovalStatuses() {
        var _a, _b;
        const { market: { base, quote } } = this;
        let baseAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved;
        let quoteAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved;
        if (base === null || base === void 0 ? void 0 : base.token) {
            const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[base.id];
            const baseVersion = this.market.dex.assets[base.id].version;
            if (((_a = baseAsset === null || baseAsset === void 0 ? void 0 : baseAsset.wallet) === null || _a === void 0 ? void 0 : _a.approved) && baseAsset.wallet.approved[baseVersion] !== undefined) {
                baseAssetApprovalStatus = baseAsset.wallet.approved[baseVersion];
            }
        }
        if (quote === null || quote === void 0 ? void 0 : quote.token) {
            const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quote.id];
            const quoteVersion = this.market.dex.assets[quote.id].version;
            if (((_b = quoteAsset === null || quoteAsset === void 0 ? void 0 : quoteAsset.wallet) === null || _b === void 0 ? void 0 : _b.approved) && quoteAsset.wallet.approved[quoteVersion] !== undefined) {
                quoteAssetApprovalStatus = quoteAsset.wallet.approved[quoteVersion];
            }
        }
        return {
            baseAssetApprovalStatus,
            quoteAssetApprovalStatus
        };
    }
    /*
     * setTokenApprovalVisibility sets the visibility of the token approval
     * panel elements.
     */
    setTokenApprovalVisibility() {
        const { page } = this;
        const { baseAssetApprovalStatus, quoteAssetApprovalStatus } = this.tokenAssetApprovalStatuses();
        if (baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.tokenApproval);
            page.sellBttn.removeAttribute('disabled');
            page.buyBttn.removeAttribute('disabled');
            return;
        }
        if (baseAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            page.sellBttn.setAttribute('disabled', 'disabled');
            page.buyBttn.removeAttribute('disabled');
            this.setBuy();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approvalRequiredSell);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approvalRequiredBuy, page.approvalRequiredBoth);
        }
        if (baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            page.buyBttn.setAttribute('disabled', 'disabled');
            page.sellBttn.removeAttribute('disabled');
            this.setSell();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approvalRequiredBuy);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approvalRequiredSell, page.approvalRequiredBoth);
        }
        // If they are both unapproved tokens, the order form will not be shown.
        if (baseAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approvalRequiredBoth);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approvalRequiredSell, page.approvalRequiredBuy);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.tokenApproval);
        page.approvalPendingBaseSymbol.textContent = page.baseTokenAsset.textContent = this.market.base.symbol.toUpperCase();
        page.approvalPendingQuoteSymbol.textContent = page.quoteTokenAsset.textContent = this.market.quote.symbol.toUpperCase();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.NotApproved, page.approveBaseBttn);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.NotApproved, page.approveQuoteBttn);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Pending, page.approvalPendingBase);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Pending, page.approvalPendingQuote);
    }
    /* setRegistrationStatusView sets the text content and class for the
     * registration status view
     */
    setRegistrationStatusView(titleContent, confStatusMsg, titleClass) {
        const page = this.page;
        page.regStatusTitle.textContent = titleContent;
        page.regStatusConfsDisplay.textContent = confStatusMsg;
        page.registrationStatus.classList.remove('completed', 'error', 'waiting');
        page.registrationStatus.classList.add(titleClass);
    }
    /*
     * updateRegistrationStatusView updates the view based on the current
     * registration status
     */
    updateRegistrationStatusView() {
        const { page, market: { dex } } = this;
        page.regStatusDex.textContent = dex.host;
        page.postingBondsDex.textContent = dex.host;
        if (dex.auth.effectiveTier >= 1) {
            this.setRegistrationStatusView(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_REGISTRATION_FEE_SUCCESS), '', 'completed');
            return;
        }
        const confStatuses = (dex.auth.pendingBonds || []).map(pending => {
            const confirmationsRequired = dex.bondAssets[pending.symbol].confs;
            return `${pending.confs} / ${confirmationsRequired}`;
        });
        const confStatusMsg = confStatuses.join(', ');
        this.setRegistrationStatusView(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_WAITING_FOR_CONFS), confStatusMsg, 'waiting');
    }
    /*
     * setRegistrationStatusVisibility toggles the registration status view based
     * on the dex data.
     */
    setRegistrationStatusVisibility() {
        const { page, market } = this;
        if (!market || !market.dex)
            return;
        // If dex is not connected to server, is not possible to know the
        // registration status.
        if (market.dex.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
            return;
        this.updateRegistrationStatusView();
        const showSection = (section) => {
            const elements = [page.registrationStatus, page.bondRequired, page.bondCreationPending, page.notRegistered];
            for (const el of elements) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(el === section, el);
            }
        };
        if (market.dex.auth.effectiveTier >= 1) {
            const toggle = () => __awaiter(this, void 0, void 0, function* () {
                showSection(undefined);
                this.resolveOrderFormVisibility();
            });
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.orderForm)) {
                // wait a couple of seconds before showing the form so the success
                // message is shown to the user
                setTimeout(toggle, 5000);
                return;
            }
            toggle();
        }
        else if (market.dex.viewOnly) {
            page.unregisteredDex.textContent = market.dex.host;
            showSection(page.notRegistered);
        }
        else if (this.hasPendingBonds()) {
            showSection(page.registrationStatus);
        }
        else if (market.dex.auth.targetTier > 0) {
            showSection(page.bondCreationPending);
        }
        else {
            page.acctTier.textContent = `${market.dex.auth.effectiveTier}`;
            page.dexSettingsLink.href = `/dexsettings/${market.dex.host}`;
            showSection(page.bondRequired);
        }
    }
    setOrderBttnText() {
        if (this.isSell()) {
            this.page.submitBttn.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SET_BUTTON_SELL, { asset: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].shortSymbol(this.market.baseCfg.unitInfo.conventional.unit) });
        }
        else
            this.page.submitBttn.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SET_BUTTON_BUY, { asset: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].shortSymbol(this.market.baseCfg.unitInfo.conventional.unit) });
    }
    setOrderBttnEnabled(isEnabled, disabledTooltipMsg) {
        const btn = this.page.submitBttn;
        if (isEnabled) {
            btn.removeAttribute('disabled');
            btn.removeAttribute('title');
        }
        else {
            btn.setAttribute('disabled', 'true');
            if (disabledTooltipMsg)
                btn.setAttribute('title', disabledTooltipMsg);
        }
    }
    updateOrderBttnState() {
        const { market: mkt, currentOrder: { qty: orderQty, rate: orderRate, isLimit, sell } } = this;
        const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[this.market.base.id].wallet;
        const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.quote.id].wallet;
        if (!baseWallet || !quoteWallet)
            return;
        if (orderQty <= 0 || orderQty < mkt.cfg.lotsize) {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_ERROR));
            return;
        }
        // Market orders
        if (!isLimit) {
            if (sell) {
                this.setOrderBttnEnabled(orderQty <= baseWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
            }
            else {
                this.setOrderBttnEnabled(orderQty <= quoteWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
            }
            return;
        }
        if (!orderRate) {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_RATE_ERROR));
            return;
        }
        // Limit sell
        if (sell) {
            if (baseWallet.balance.available < mkt.cfg.lotsize) {
                this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
                return;
            }
            if (mkt.maxSell) {
                this.setOrderBttnEnabled(orderQty <= mkt.maxSell.swap.value, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
            }
            return;
        }
        // Limit buy
        const rate = this.adjustedRate();
        const aLot = mkt.cfg.lotsize * (rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor);
        if (quoteWallet.balance.available < aLot) {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
            return;
        }
        if (mkt.maxBuys[rate]) {
            const enable = orderQty <= mkt.maxBuys[rate].swap.lots * mkt.cfg.lotsize;
            this.setOrderBttnEnabled(enable, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
        }
    }
    setCandleDurBttns() {
        const { page, market } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.durBttnBox);
        for (const dur of market.dex.candleDurs) {
            const bttn = page.durBttnTemplate.cloneNode(true);
            bttn.textContent = dur;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(bttn, 'click', () => this.candleDurationSelected(dur));
            page.durBttnBox.appendChild(bttn);
        }
        // load candlesticks here since we are resetting page.durBttnBox above.
        this.loadCandles();
    }
    /* setMarket sets the currently displayed market. */
    setMarket(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            const dex = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().user.exchanges[host];
            const page = this.page;
            window.cexBook = () => __awaiter(this, void 0, void 0, function* () {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/cexbook', { host, baseID, quoteID });
                console.log(res.book);
            });
            // reset form inputs
            page.lotField.value = '';
            page.qtyField.value = '';
            page.rateField.value = '';
            // clear depth chart and orderbook.
            this.depthChart.clear();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.buyRows);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.sellRows);
            // Clear recent matches for the previous market. This will be set when we
            // receive the order book subscription response.
            this.recentMatches = [];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.recentMatchesLiveList);
            // Hide the balance widget
            this.balanceWgt.setBalanceVisibility(false);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.notRegistered, page.bondRequired, page.noWallet);
            // If we have not yet connected, there is no dex.assets or any other
            // exchange data, so just put up a message and wait for the connection to be
            // established, at which time handleConnNote will refresh and reload.
            if (!dex || !dex.markets || dex.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected) {
                let errMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CONNECTION_FAILED);
                if (dex.disabled)
                    errMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_DEX_DISABLED_MSG);
                page.chartErrMsg.textContent = errMsg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.chartErrMsg);
                return;
            }
            for (const s of this.stats)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(s.row);
            const baseCfg = dex.assets[baseID];
            const quoteCfg = dex.assets[quoteID];
            const [bui, qui] = [(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(baseID, dex), (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(quoteID, dex)];
            const rateConversionFactor = _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.maxOrd, page.chartErrMsg);
            if (this.maxEstimateTimer) {
                window.clearTimeout(this.maxEstimateTimer);
                this.maxEstimateTimer = null;
            }
            const mktId = marketID(baseCfg.symbol, quoteCfg.symbol);
            const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[baseID];
            const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quoteID];
            const mkt = {
                dex: dex,
                sid: mktId,
                cfg: dex.markets[mktId],
                // app().assets is a map of core.SupportedAsset type, which can be found at
                // client/core/types.go.
                base: baseAsset,
                quote: quoteAsset,
                baseUnitInfo: bui,
                quoteUnitInfo: qui,
                maxSell: null,
                maxBuys: {},
                maxSellRequested: false,
                candleCaches: {},
                baseCfg,
                quoteCfg,
                rateConversionFactor,
                sellBalance: 0,
                buyBalance: 0,
                bookLoaded: false
            };
            this.market = mkt;
            this.mm.setMarket(host, baseID, quoteID);
            this.mmRunning = undefined;
            page.lotSize.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(mkt.cfg.lotsize, mkt.baseUnitInfo);
            page.rateStep.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(mkt.cfg.ratestep / rateConversionFactor);
            this.displayMessageIfMissingWallet();
            this.balanceWgt.setWallets(host, baseID, quoteID);
            this.setMarketDetails();
            this.setCurrMarketPrice();
            // if (!dex.candleDurs || dex.candleDurs.length === 0) this.currentChart = depthChart
            // depth chart
            _ws__WEBPACK_IMPORTED_MODULE_9__["default"].request('loadmarket', makeMarket(host, baseID, quoteID));
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastMarketLK, {
                host: host,
                base: baseID,
                quote: quoteID
            });
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().updateMarketElements(this.main, baseID, quoteID, dex);
            this.marketList.select(host, baseID, quoteID);
            this.setLoaderMsgVisibility();
            this.setTokenApprovalVisibility();
            this.setRegistrationStatusVisibility();
            this.resolveOrderFormVisibility();
            this.setOrderBttnText();
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_RATE_ERROR));
            this.setCandleDurBttns();
            this.previewQuoteAmt(false);
            this.updateTitle();
            this.reputationMeter.setHost(dex.host);
            this.updateReputation();
            this.loadUserOrders();
        });
    }
    /*
      displayMessageForMissingWallet displays a custom message on the market's
      view if one or more of the selected market's wallet is missing.
    */
    displayMessageIfMissingWallet() {
        var _a, _b, _c, _d;
        const page = this.page;
        const mkt = this.market;
        const baseSym = mkt.baseCfg.symbol.toLocaleUpperCase();
        const quoteSym = mkt.quoteCfg.symbol.toLocaleUpperCase();
        let noWalletMsg = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noWallet);
        if (!((_a = mkt.base) === null || _a === void 0 ? void 0 : _a.wallet) && !((_b = mkt.quote) === null || _b === void 0 ? void 0 : _b.wallet))
            noWalletMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_WALLET_MSG, { asset1: baseSym, asset2: quoteSym });
        else if (!((_c = mkt.base) === null || _c === void 0 ? void 0 : _c.wallet))
            noWalletMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CREATE_ASSET_WALLET_MSG, { asset: baseSym });
        else if (!((_d = mkt.quote) === null || _d === void 0 ? void 0 : _d.wallet))
            noWalletMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CREATE_ASSET_WALLET_MSG, { asset: quoteSym });
        else
            return;
        page.noWallet.textContent = noWalletMsg;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noWallet);
    }
    /*
     * reportDepthClick is a callback used by the DepthChart when the user clicks
     * on the chart area. The rate field is set to the x-value of the click.
     */
    reportDepthClick(r) {
        this.page.rateField.value = String(r);
        this.rateFieldChanged();
    }
    /*
     * reportDepthVolume accepts a volume report from the DepthChart and sets the
     * values in the chart legend.
     */
    reportDepthVolume(r) {
        const page = this.page;
        const { baseUnitInfo: b, quoteUnitInfo: q } = this.market;
        // DepthChart reports volumes in conventional units. We'll still use
        // formatCoinValue for formatting though.
        page.sellBookedBase.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.sellBase * b.conventional.conversionFactor, b);
        page.sellBookedQuote.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.sellQuote * q.conventional.conversionFactor, q);
        page.buyBookedBase.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.buyBase * b.conventional.conversionFactor, b);
        page.buyBookedQuote.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.buyQuote * q.conventional.conversionFactor, q);
    }
    /*
     * reportDepthMouse accepts information about the mouse position on the chart
     * area.
     */
    reportDepthMouse(r) {
        while (this.hovers.length)
            this.hovers.shift().classList.remove('hover');
        const page = this.page;
        if (!r) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.depthLegend);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.depthLegend);
        // If the user is hovered to within a small percent (based on chart width)
        // of a user order, highlight that order's row.
        for (const { div, ord } of Object.values(this.metaOrders)) {
            if (ord.status !== _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked)
                continue;
            if (r.hoverMarkers.indexOf(ord.rate) > -1) {
                div.classList.add('hover');
                this.hovers.push(div);
            }
        }
        page.hoverPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.rate);
        page.hoverVolume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.depth);
        page.hoverVolume.style.color = r.dotColor;
    }
    /*
     * reportDepthZoom accepts information about the current depth chart zoom
     * level. This information is saved to disk so that the zoom level can be
     * maintained across reloads.
     */
    reportDepthZoom(zoom) {
        _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].depthZoomLK, zoom);
    }
    reportMouseCandle(candle) {
        const page = this.page;
        if (!candle) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.candlesLegend);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.candlesLegend);
        page.candleStart.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.startRate / this.market.rateConversionFactor);
        page.candleEnd.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.endRate / this.market.rateConversionFactor);
        page.candleHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.highRate / this.market.rateConversionFactor);
        page.candleLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.lowRate / this.market.rateConversionFactor);
        page.candleVol.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.matchVolume, this.market.baseUnitInfo);
    }
    /*
     * parseOrder pulls the order information from the form fields. Data is not
     * validated in any way.
     */
    parseOrder() {
        const page = this.page;
        let qtyField = page.qtyField;
        const limit = this.isLimit();
        const sell = this.isSell();
        const market = this.market;
        let qtyConv = market.baseUnitInfo.conventional.conversionFactor;
        if (!limit && !sell) {
            qtyField = page.mktBuyField;
            qtyConv = market.quoteUnitInfo.conventional.conversionFactor;
        }
        return {
            host: market.dex.host,
            isLimit: limit,
            sell: sell,
            base: market.base.id,
            quote: market.quote.id,
            qty: convertToAtoms(qtyField.value || '', qtyConv),
            rate: convertToAtoms(page.rateField.value || '', market.rateConversionFactor),
            tifnow: page.tifNow.checked || false,
            options: {}
        };
    }
    /**
     * previewQuoteAmt shows quote amount when rate or quantity input are changed
     */
    previewQuoteAmt(show) {
        const page = this.page;
        if (!this.market.base || !this.market.quote)
            return; // Not a supported asset
        const order = this.currentOrder = this.parseOrder();
        const adjusted = this.adjustedRate();
        page.orderErr.textContent = '';
        if (adjusted) {
            if (order.sell)
                this.preSell();
            else
                this.preBuy();
        }
        this.depthLines.input = [];
        if (adjusted && this.isLimit()) {
            this.depthLines.input = [{
                    rate: order.rate / this.market.rateConversionFactor,
                    color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine
                }];
        }
        this.drawChartLines();
        if (!show || !adjusted || !order.qty) {
            page.orderPreview.textContent = '';
            this.drawChartLines();
            return;
        }
        const { unitInfo: { conventional: { unit } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[order.quote];
        const quoteQty = order.qty * order.rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
        const total = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteQty, this.market.quoteUnitInfo);
        page.orderPreview.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_PREVIEW, { total, asset: unit });
        if (this.isSell())
            this.preSell();
        else
            this.preBuy();
    }
    /**
     * preSell populates the max order message for the largest available sell.
     */
    preSell() {
        const mkt = this.market;
        const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.base.id].wallet;
        if (baseWallet.balance.available < mkt.cfg.lotsize) {
            this.setMaxOrder(null);
            this.updateOrderBttnState();
            return;
        }
        if (mkt.maxSell) {
            this.setMaxOrder(mkt.maxSell.swap);
            this.updateOrderBttnState();
            return;
        }
        if (mkt.maxSellRequested)
            return;
        mkt.maxSellRequested = true;
        // We only fetch pre-sell once per balance update, so don't delay.
        this.scheduleMaxEstimate('/api/maxsell', {}, 0, (res) => {
            mkt.maxSellRequested = false;
            mkt.maxSell = res.maxSell;
            mkt.sellBalance = baseWallet.balance.available;
            this.setMaxOrder(res.maxSell.swap);
            this.updateOrderBttnState();
        });
    }
    /**
     * preBuy populates the max order message for the largest available buy.
     */
    preBuy() {
        const mkt = this.market;
        const rate = this.adjustedRate();
        const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.quote.id].wallet;
        if (!quoteWallet)
            return;
        const aLot = mkt.cfg.lotsize * (rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor);
        if (quoteWallet.balance.available < aLot) {
            this.setMaxOrder(null);
            this.updateOrderBttnState();
            return;
        }
        if (mkt.maxBuys[rate]) {
            this.setMaxOrder(mkt.maxBuys[rate].swap);
            this.updateOrderBttnState();
            return;
        }
        // 0 delay for first fetch after balance update or market change, otherwise
        // meter these at 1 / sec.
        const delay = Object.keys(mkt.maxBuys).length ? 350 : 0;
        this.scheduleMaxEstimate('/api/maxbuy', { rate }, delay, (res) => {
            mkt.maxBuys[rate] = res.maxBuy;
            mkt.buyBalance = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.quote.id].wallet.balance.available;
            this.setMaxOrder(res.maxBuy.swap);
            this.updateOrderBttnState();
        });
    }
    /**
     * scheduleMaxEstimate shows the loading icon and schedules a call to an order
     * estimate api endpoint. If another call to scheduleMaxEstimate is made before
     * this one is fired (after delay), this call will be canceled.
     */
    scheduleMaxEstimate(path, args, delay, success) {
        const page = this.page;
        if (!this.maxLoaded)
            this.maxLoaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.maxOrd);
        const [bid, qid] = [this.market.base.id, this.market.quote.id];
        const [bWallet, qWallet] = [(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[bid].wallet, (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[qid].wallet];
        if (!bWallet || !bWallet.running || !qWallet || !qWallet.running)
            return;
        if (this.maxEstimateTimer)
            window.clearTimeout(this.maxEstimateTimer);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxOrd, page.maxLotBox);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.maxAboveZero, page.maxZeroNoFees, page.maxZeroNoBal);
        page.maxFromLots.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CALCULATING);
        page.maxFromLotsLbl.textContent = '';
        this.maxOrderUpdateCounter++;
        const counter = this.maxOrderUpdateCounter;
        this.maxEstimateTimer = window.setTimeout(() => __awaiter(this, void 0, void 0, function* () {
            this.maxEstimateTimer = null;
            if (counter !== this.maxOrderUpdateCounter)
                return;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)(path, Object.assign({ host: this.market.dex.host, base: bid, quote: qid }, args));
            if (counter !== this.maxOrderUpdateCounter)
                return;
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                console.warn('max order estimate not available:', res);
                page.maxFromLots.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ESTIMATE_UNAVAILABLE);
                if (this.maxLoaded) {
                    this.maxLoaded();
                    this.maxLoaded = null;
                }
                return;
            }
            success(res);
        }), delay);
    }
    /* setMaxOrder sets the max order text. */
    setMaxOrder(maxOrder) {
        const page = this.page;
        if (this.maxLoaded) {
            this.maxLoaded();
            this.maxLoaded = null;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxOrd, page.maxLotBox);
        const sell = this.isSell();
        let lots = 0;
        if (maxOrder)
            lots = maxOrder.lots;
        page.maxFromLots.textContent = lots.toString();
        // XXX add plural into format details, so we don't need this
        page.maxFromLotsLbl.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(lots === 1 ? _locales__WEBPACK_IMPORTED_MODULE_10__.ID_LOT : _locales__WEBPACK_IMPORTED_MODULE_10__.ID_LOTS);
        if (!maxOrder)
            return;
        const fromAsset = sell ? this.market.base : this.market.quote;
        if (lots === 0) {
            // If we have a maxOrder, see if we can guess why we have no lots.
            let lotSize = this.market.cfg.lotsize;
            if (!sell) {
                const conversionRate = this.anyRate()[1];
                if (conversionRate === 0)
                    return;
                lotSize = lotSize * conversionRate;
            }
            const haveQty = fromAsset.wallet.balance.available / lotSize > 0;
            if (haveQty) {
                if (fromAsset.token) {
                    const { wallet: { balance: { available: feeAvail } }, unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[fromAsset.token.parentID];
                    if (feeAvail < maxOrder.feeReservesPerLot) {
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxZeroNoFees);
                        page.maxZeroNoFeesTicker.textContent = unitInfo.conventional.unit;
                        page.maxZeroMinFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(maxOrder.feeReservesPerLot, unitInfo);
                    }
                    // It looks like we should be able to afford it, but maybe some fees we're not seeing.
                    // Show nothing.
                    return;
                }
                // Not a token. Maybe we have enough for the swap but not for fees.
                const fundedLots = fromAsset.wallet.balance.available / (lotSize + maxOrder.feeReservesPerLot);
                if (fundedLots > 0)
                    return; // Not sure why. Could be split txs or utxos. Just show nothing.
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxZeroNoBal);
            page.maxZeroNoBalTicker.textContent = fromAsset.unitInfo.conventional.unit;
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxAboveZero);
        page.maxFromAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(maxOrder.value || 0, fromAsset.unitInfo);
        page.maxFromTicker.textContent = fromAsset.unitInfo.conventional.unit;
        // Could subtract the maxOrder.redemptionFees here.
        // The qty conversion doesn't fit well with the new design.
        // TODO: Make this work somehow?
        // const toConversion = sell ? this.adjustedRate() / OrderUtil.RateEncodingFactor : OrderUtil.RateEncodingFactor / this.adjustedRate()
        // page.maxToAmt.textContent = Doc.formatCoinValue((maxOrder.value || 0) * toConversion, toAsset.unitInfo)
        // page.maxToTicker.textContent = toAsset.symbol.toUpperCase()
    }
    /*
     * validateOrder performs some basic order sanity checks, returning boolean
     * true if the order appears valid.
     */
    validateOrder(order) {
        const { page, market: { cfg: { minimumRate }, rateConversionFactor } } = this;
        if (order.isLimit) {
            if (!order.rate) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
                page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ZERO_RATE);
                return false;
            }
            if (order.rate < minimumRate) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
                const [r, minRate] = [order.rate / rateConversionFactor, minimumRate / rateConversionFactor];
                page.orderErr.textContent = `rate is lower than the market's minimum rate. ${r} < ${minRate}`;
                return false;
            }
        }
        if (!order.qty) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
            page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ZERO_QUANTITY);
            return false;
        }
        return true;
    }
    /* handleBook accepts the data sent in the 'book' notification. */
    handleBook(data) {
        var _a;
        const { cfg, baseUnitInfo, quoteUnitInfo, baseCfg, quoteCfg } = this.market;
        this.book = new _orderbook__WEBPACK_IMPORTED_MODULE_3__["default"](data, baseCfg.symbol, quoteCfg.symbol);
        this.loadTable();
        for (const order of (data.book.epoch || [])) {
            if (order.rate > 0)
                this.book.add(order);
            this.addTableOrder(order);
        }
        if (!this.book) {
            this.depthChart.clear();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.buyRows);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.sellRows);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.epochLine);
        if (this.loadingAnimations.depth)
            this.loadingAnimations.depth.stop();
        this.depthChart.canvas.classList.remove('invisible');
        this.depthChart.set(this.book, cfg.lotsize, cfg.ratestep, baseUnitInfo, quoteUnitInfo);
        this.recentMatches = (_a = data.book.recentMatches) !== null && _a !== void 0 ? _a : [];
        this.refreshRecentMatchesTable();
    }
    /*
     * midGapConventional is the same as midGap, but returns the mid-gap rate as
     * the conventional ratio. This is used to convert from a conventional
     * quantity from base to quote or vice-versa, or for display purposes.
     */
    midGapConventional() {
        const gap = this.midGap();
        if (!gap)
            return gap;
        const { baseUnitInfo: b, quoteUnitInfo: q } = this.market;
        return gap * b.conventional.conversionFactor / q.conventional.conversionFactor;
    }
    /*
     * midGap returns the value in the middle of the best buy and best sell. If
     * either one of the buy or sell sides are empty, midGap returns the best rate
     * from the other side. If both sides are empty, midGap returns the value
     * null. The rate returned is the atomic ratio, used for conversion. For a
     * conventional rate for display or to convert conventional units, use
     * midGapConventional
     */
    midGap() {
        const book = this.book;
        if (!book)
            return;
        if (book.buys && book.buys.length) {
            if (book.sells && book.sells.length) {
                return (book.buys[0].msgRate + book.sells[0].msgRate) / 2 / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
            }
            return book.buys[0].msgRate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
        }
        if (book.sells && book.sells.length) {
            return book.sells[0].msgRate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
        }
        return null;
    }
    /*
     * setMarketBuyOrderEstimate sets the "min. buy" display for the current
     * market.
     */
    setMarketBuyOrderEstimate() {
        const market = this.market;
        const lotSize = market.cfg.lotsize;
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().user.exchanges[market.dex.host];
        const buffer = xc.markets[market.sid].buybuffer;
        const gap = this.midGapConventional();
        if (gap) {
            this.page.minMktBuy.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(lotSize * buffer * gap, market.baseUnitInfo);
        }
    }
    maxUserOrderCount() {
        const { dex: { host }, cfg: { name: mktID } } = this.market;
        return Math.max(maxUserOrdersShown, (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().orders(host, mktID).length);
    }
    loadUserOrders() {
        return __awaiter(this, void 0, void 0, function* () {
            const { base: b, quote: q, dex: { host }, cfg: { name: mktID } } = this.market;
            for (const oid in this.metaOrders)
                delete this.metaOrders[oid];
            if (!b || !q)
                return this.resolveUserOrders([]); // unsupported asset
            const activeOrders = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().orders(host, mktID);
            if (activeOrders.length >= maxUserOrdersShown)
                return this.resolveUserOrders(activeOrders);
            const filter = {
                hosts: [host],
                market: { baseID: b.id, quoteID: q.id },
                n: this.maxUserOrderCount()
            };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/orders', filter);
            const orders = res.orders || [];
            // Make sure all active orders are in there. The /orders API sorts by time,
            // so if there is are 10 cancelled/executed orders newer than an old active
            // order, the active order wouldn't be included in the result.
            for (const activeOrd of activeOrders)
                if (!orders.some((dbOrd) => dbOrd.id === activeOrd.id))
                    orders.push(activeOrd);
            return this.resolveUserOrders(res.orders || []);
        });
    }
    /* refreshActiveOrders refreshes the user's active order list. */
    refreshActiveOrders() {
        const orders = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().orders(this.market.dex.host, marketID(this.market.baseCfg.symbol, this.market.quoteCfg.symbol));
        return this.resolveUserOrders(orders);
    }
    resolveUserOrders(orders) {
        const { page, metaOrders, market } = this;
        const cfg = market.cfg;
        const orderIsActive = (ord) => ord.status < _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusExecuted || _orderutil__WEBPACK_IMPORTED_MODULE_8__.hasActiveMatches(ord);
        for (const ord of orders)
            metaOrders[ord.id] = { ord: ord };
        let sortedOrders = Object.keys(metaOrders).map((oid) => metaOrders[oid]);
        sortedOrders.sort((a, b) => {
            const [aActive, bActive] = [orderIsActive(a.ord), orderIsActive(b.ord)];
            if (aActive && !bActive)
                return -1;
            else if (!aActive && bActive)
                return 1;
            return b.ord.submitTime - a.ord.submitTime;
        });
        const n = this.maxUserOrderCount();
        if (sortedOrders.length > n) {
            sortedOrders = sortedOrders.slice(0, n);
        }
        for (const oid in metaOrders)
            delete metaOrders[oid];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.userOrders);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(sortedOrders === null || sortedOrders === void 0 ? void 0 : sortedOrders.length, page.userOrders);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!(sortedOrders === null || sortedOrders === void 0 ? void 0 : sortedOrders.length), page.userNoOrders);
        let unreadyOrders = false;
        for (const mord of sortedOrders) {
            const div = page.userOrderTmpl.cloneNode(true);
            page.userOrders.appendChild(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            const header = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tmpl.header);
            const details = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tmpl.details);
            mord.div = div;
            mord.header = header;
            mord.details = details;
            const ord = mord.ord;
            const orderID = ord.id;
            const isActive = orderIsActive(ord);
            // No need to track in-flight orders here. We've already added it to
            // display.
            if (orderID)
                metaOrders[orderID] = mord;
            if (!ord.readyToTick && _orderutil__WEBPACK_IMPORTED_MODULE_8__.hasActiveMatches(ord)) {
                tmpl.header.classList.add('unready-user-order');
                unreadyOrders = true;
            }
            header.sideLight.classList.add(ord.sell ? 'sell' : 'buy');
            if (!isActive)
                header.sideLight.classList.add('inactive');
            details.side.textContent = mord.header.side.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_8__.sellString(ord);
            details.side.classList.add(ord.sell ? 'sellcolor' : 'buycolor');
            header.side.classList.add(ord.sell ? 'sellcolor' : 'buycolor');
            details.qty.textContent = mord.header.qty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, market.baseUnitInfo);
            let rateStr;
            if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Market)
                rateStr = this.marketOrderRateString(ord, market);
            else
                rateStr = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatRateFullPrecision(ord.rate, market.baseUnitInfo, market.quoteUnitInfo, cfg.ratestep);
            details.rate.textContent = mord.header.rate.textContent = rateStr;
            header.baseSymbol.textContent = market.baseUnitInfo.conventional.unit;
            details.type.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_8__.orderTypeText(ord.type);
            this.updateMetaOrder(mord);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'mouseenter', () => {
                this.activeMarkerRate = ord.rate;
                this.setDepthMarkers();
            });
            const showCancel = (e) => {
                e.stopPropagation();
                this.showCancel(div, orderID);
            };
            const showAccelerate = (e) => {
                e.stopPropagation();
                this.showAccelerate(ord);
            };
            if (!orderID) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(details.accelerateBttn);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(details.cancelBttn);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(details.link);
            }
            else {
                if (_orderutil__WEBPACK_IMPORTED_MODULE_8__.isCancellable(ord)) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(details.cancelBttn);
                    bind(details.cancelBttn, 'click', (e) => { showCancel(e); });
                }
                bind(details.accelerateBttn, 'click', (e) => { showAccelerate(e); });
                if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(ord)) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(details.accelerateBttn);
                }
                details.link.href = `order/${orderID}`;
                (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindInternalNavigation(div);
            }
            let currentFloater;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.header, 'click', () => {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(tmpl.details)) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.details);
                    header.expander.classList.add('ico-arrowdown');
                    header.expander.classList.remove('ico-arrowup');
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.details);
                header.expander.classList.remove('ico-arrowdown');
                header.expander.classList.add('ico-arrowup');
                if (currentFloater)
                    currentFloater.remove();
            });
            /**
             * We'll show the button menu when they hover over the header. To avoid
             * pushing the layout around, we'll show the buttons as an absolutely
             * positioned copy of the button menu.
             */
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.header, 'mouseenter', () => {
                // Don't show the copy if the details are already displayed.
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(tmpl.details))
                    return;
                if (currentFloater)
                    currentFloater.remove();
                // Create and position the element based on the position of the header.
                const floater = document.createElement('div');
                currentFloater = floater;
                document.body.appendChild(floater);
                floater.className = 'user-order-floaty-menu';
                const m = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(tmpl.header);
                const y = m.bodyTop + m.height;
                floater.style.top = `${y - 1}px`; // - 1 to hide border on header div
                floater.style.left = `${m.bodyLeft}px`;
                // Get the updated version of the order
                const mord = this.metaOrders[orderID];
                const ord = mord.ord;
                const addButton = (baseBttn, cb) => {
                    const icon = baseBttn.cloneNode(true);
                    floater.appendChild(icon);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(icon);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(icon, 'click', (e) => { cb(e); });
                };
                if (_orderutil__WEBPACK_IMPORTED_MODULE_8__.isCancellable(ord))
                    addButton(details.cancelBttn, (e) => { showCancel(e); });
                if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(ord))
                    addButton(details.accelerateBttn, (e) => { showAccelerate(e); });
                floater.appendChild(details.link.cloneNode(true));
                const ogScrollY = page.orderScroller.scrollTop;
                // Set up the hover interactions.
                const moved = (e) => {
                    // If the user scrolled, reposition the float menu. This keeps the
                    // menu from following us around, which can prevent removal below.
                    const yShift = page.orderScroller.scrollTop - ogScrollY;
                    floater.style.top = `${y + yShift}px`;
                    if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, floater) || _doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, div))
                        return;
                    floater.remove();
                    currentFloater = null;
                    document.removeEventListener('mousemove', moved);
                    page.orderScroller.removeEventListener('scroll', moved);
                };
                document.addEventListener('mousemove', moved);
                page.orderScroller.addEventListener('scroll', moved);
            });
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(div);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(unreadyOrders, page.unreadyOrdersMsg);
        this.setDepthMarkers();
    }
    /*
     marketOrderRateString uses the market config rate step to format the average
     market order rate.
    */
    marketOrderRateString(ord, mkt) {
        var _a;
        if (!((_a = ord.matches) === null || _a === void 0 ? void 0 : _a.length))
            return _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_MARKET_ORDER);
        let rateStr = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatRateFullPrecision(_orderutil__WEBPACK_IMPORTED_MODULE_8__.averageRate(ord), mkt.baseUnitInfo, mkt.quoteUnitInfo, mkt.cfg.ratestep);
        if (ord.matches.length > 1)
            rateStr = '~ ' + rateStr; // ~ only makes sense if the order has more than one match
        return rateStr;
    }
    /*
    * updateMetaOrder sets the td contents of the user's order table row.
    */
    updateMetaOrder(mord) {
        const { header, details, ord } = mord;
        if (ord.status <= _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked || _orderutil__WEBPACK_IMPORTED_MODULE_8__.hasActiveMatches(ord))
            header.activeLight.classList.add('active');
        else
            header.activeLight.classList.remove('active');
        details.status.textContent = header.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_8__.statusString(ord);
        details.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(ord.submitTime);
        details.filled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_8__.filled(ord) / ord.qty * 100).toFixed(1)}%`;
        details.settled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_8__.settled(ord) / ord.qty * 100).toFixed(1)}%`;
    }
    /* setMarkers sets the depth chart markers for booked orders. */
    setDepthMarkers() {
        const markers = {
            buys: [],
            sells: []
        };
        const rateFactor = this.market.rateConversionFactor;
        for (const { ord } of Object.values(this.metaOrders)) {
            if (ord.rate && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked) {
                if (ord.sell) {
                    markers.sells.push({
                        rate: ord.rate / rateFactor,
                        active: ord.rate === this.activeMarkerRate
                    });
                }
                else {
                    markers.buys.push({
                        rate: ord.rate / rateFactor,
                        active: ord.rate === this.activeMarkerRate
                    });
                }
            }
        }
        this.depthChart.setMarkers(markers);
        if (this.book)
            this.depthChart.draw();
    }
    /* updateTitle update the browser title based on the midgap value and the
     * selected assets.
     */
    updateTitle() {
        // gets first price value from buy or from sell, so we can show it on
        // title.
        const midGapValue = this.midGapConventional();
        const { baseUnitInfo: { conventional: { unit: bUnit } }, quoteUnitInfo: { conventional: { unit: qUnit } } } = this.market;
        if (!midGapValue)
            document.title = `${bUnit}${qUnit} | ${this.ogTitle}`;
        else
            document.title = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(midGapValue)} | ${bUnit}${qUnit} | ${this.ogTitle}`; // more than 6 numbers it gets too big for the title.
    }
    /* handleBookRoute is the handler for the 'book' notification, which is sent
     * in response to a new market subscription. The data received will contain
     * the entire order book.
     */
    handleBookRoute(note) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleBookRoute:', note);
        const mktBook = note.payload;
        const { baseCfg: b, quoteCfg: q, dex: { host } } = this.market;
        if (mktBook.base !== b.id || mktBook.quote !== q.id || note.host !== host)
            return; // user already changed markets
        this.handleBook(mktBook);
        this.market.bookLoaded = true;
        this.updateTitle();
        this.setMarketBuyOrderEstimate();
    }
    /* handleBookOrderRoute is the handler for 'book_order' notifications. */
    handleBookOrderRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleBookOrderRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const order = data.payload;
        if (order.rate > 0)
            this.book.add(order);
        this.addTableOrder(order);
        this.updateTitle();
        this.depthChart.draw();
    }
    /* handleUnbookOrderRoute is the handler for 'unbook_order' notifications. */
    handleUnbookOrderRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleUnbookOrderRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const order = data.payload;
        this.book.remove(order.token);
        this.removeTableOrder(order);
        this.updateTitle();
        this.depthChart.draw();
    }
    /*
     * handleUpdateRemainingRoute is the handler for 'update_remaining'
     * notifications.
     */
    handleUpdateRemainingRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleUpdateRemainingRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const update = data.payload;
        this.book.updateRemaining(update.token, update.qty, update.qtyAtomic);
        this.updateTableOrder(update);
        this.depthChart.draw();
    }
    /* handleEpochOrderRoute is the handler for 'epoch_order' notifications. */
    handleEpochOrderRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleEpochOrderRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const order = data.payload;
        if (order.msgRate > 0)
            this.book.add(order); // No cancels or market orders
        if (order.qtyAtomic > 0)
            this.addTableOrder(order); // No cancel orders
        this.depthChart.draw();
    }
    /* handleCandlesRoute is the handler for 'candles' notifications. */
    handleCandlesRoute(data) {
        if (this.candlesLoading) {
            clearTimeout(this.candlesLoading.timer);
            this.candlesLoading.loaded();
            this.candlesLoading = null;
        }
        if (data.host !== this.market.dex.host || data.marketID !== this.market.cfg.name)
            return;
        const dur = data.payload.dur;
        this.market.candleCaches[dur] = data.payload;
        this.setHighLow();
        if (this.candleDur !== dur)
            return;
        if (this.loadingAnimations.candles)
            this.loadingAnimations.candles.stop();
        this.candleChart.canvas.classList.remove('invisible');
        this.candleChart.setCandles(data.payload, this.market.cfg, this.market.baseUnitInfo, this.market.quoteUnitInfo);
    }
    handleEpochMatchSummary(data) {
        this.addRecentMatches(data.payload.matchSummaries);
        this.refreshRecentMatchesTable();
    }
    /* handleCandleUpdateRoute is the handler for 'candle_update' notifications. */
    handleCandleUpdateRoute(data) {
        if (data.host !== this.market.dex.host)
            return;
        const { dur, candle } = data.payload;
        const cache = this.market.candleCaches[dur];
        if (!cache)
            return; // must not have seen the 'candles' notification yet?
        const candles = cache.candles;
        if (candles.length === 0)
            candles.push(candle);
        else {
            const last = candles[candles.length - 1];
            if (last.startStamp === candle.startStamp)
                candles[candles.length - 1] = candle;
            else
                candles.push(candle);
        }
        if (this.candleDur !== dur)
            return;
        this.candleChart.draw();
    }
    /*
     * showToggleWalletStatus displays the toggleWalletStatusConfirm form to
     * enable a wallet.
     */
    showToggleWalletStatus(asset) {
        const page = this.page;
        this.openAsset = asset;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr, page.walletStatusDisable, page.disableWalletMsg);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletStatusEnable, page.enableWalletMsg);
        this.forms.show(page.toggleWalletStatusConfirm);
    }
    /*
     * toggleWalletStatus toggle wallets status to enabled.
     */
    toggleWalletStatus() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr);
            const url = '/api/togglewalletstatus';
            const req = {
                assetID: this.openAsset.id,
                disable: false
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.toggleWalletStatusConfirm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)(url, req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                page.toggleWalletStatusErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.toggleWalletStatusErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
            this.balanceWgt.updateAsset(this.openAsset.id);
        });
    }
    /* showVerify shows the form to accept the currently parsed order information
     * and confirm submission of the order to the dex.
     */
    showVerify() {
        this.preorderCache = {};
        const page = this.page;
        const order = this.currentOrder = this.parseOrder();
        const isSell = order.sell;
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[order.base];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[order.quote];
        const toAsset = isSell ? quoteAsset : baseAsset;
        const fromAsset = isSell ? baseAsset : quoteAsset;
        const setIcon = (icon) => {
            switch (icon.dataset.icon) {
                case 'from':
                    if (fromAsset.token) {
                        const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[fromAsset.token.parentID];
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                    }
                    else {
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(fromAsset.symbol);
                    }
                    break;
                case 'to':
                    if (toAsset.token) {
                        const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[toAsset.token.parentID];
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                    }
                    else {
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(toAsset.symbol);
                    }
            }
        };
        // Set the to and from icons in the fee details pane.
        for (const icon of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.vDetailPane, '[data-icon]')) {
            setIcon(icon);
        }
        // Set the to and from icons in the fee summary pane.
        for (const icon of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.vFeeSummary, '[data-icon]')) {
            setIcon(icon);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderErr);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorder);
        page.vBuySell.textContent = isSell ? _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SELLING) : _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BUYING);
        const buySellStr = isSell ? _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SELL) : _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BUY);
        page.vSideSubmit.textContent = buySellStr;
        page.vOrderHost.textContent = order.host;
        if (order.isLimit) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.verifyLimit);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.verifyMarket);
            const orderDesc = `Limit ${buySellStr} Order`;
            page.vOrderType.textContent = order.tifnow ? orderDesc + ' (immediate)' : orderDesc;
            page.vRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(order.rate / this.market.rateConversionFactor);
            page.vQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(order.qty, baseAsset.unitInfo);
            const total = order.rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor * order.qty;
            page.vTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(total, quoteAsset.unitInfo);
            // Format total fiat value.
            this.showFiatValue(quoteAsset.id, total, page.vFiatTotal);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.verifyLimit);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.verifyMarket);
            page.vOrderType.textContent = `Market ${buySellStr} Order`;
            const ui = order.sell ? this.market.baseUnitInfo : this.market.quoteUnitInfo;
            page.vmFromTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(order.qty, ui);
            page.vmFromAsset.textContent = fromAsset.symbol.toUpperCase();
            // Format fromAsset fiat value.
            this.showFiatValue(fromAsset.id, order.qty, page.vmFromTotalFiat);
            const gap = this.midGap();
            if (gap) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vMarketEstimate);
                const received = order.sell ? order.qty * gap : order.qty / gap;
                page.vmToTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(received, toAsset.unitInfo);
                page.vmToAsset.textContent = toAsset.symbol.toUpperCase();
                // Format received value to fiat equivalent.
                this.showFiatValue(toAsset.id, received, page.vmTotalFiat);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vMarketEstimate);
            }
        }
        // Visually differentiate between buy/sell orders.
        if (isSell) {
            page.vHeader.classList.add(sellBtnClass);
            page.vHeader.classList.remove(buyBtnClass);
            page.vSubmit.classList.add(sellBtnClass);
            page.vSubmit.classList.remove(buyBtnClass);
        }
        else {
            page.vHeader.classList.add(buyBtnClass);
            page.vHeader.classList.remove(sellBtnClass);
            page.vSubmit.classList.add(buyBtnClass);
            page.vSubmit.classList.remove(sellBtnClass);
        }
        this.showVerifyForm();
        if (baseAsset.wallet.open && quoteAsset.wallet.open)
            this.preOrder(order);
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorder);
            this.unlockWalletsForEstimates();
        }
    }
    // showFiatValue displays the fiat equivalent for an order quantity.
    showFiatValue(assetID, qty, display) {
        if (display) {
            const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[assetID];
            display.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(qty, rate, (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(assetID));
            if (rate)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(display.parentElement);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(display.parentElement);
        }
    }
    /* showVerifyForm displays form to verify an order */
    showVerifyForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vErr);
            this.forms.show(page.verifyForm);
        });
    }
    /*
     * unlockWalletsForEstimates unlocks any locked wallets with the provided
     * password.
     */
    unlockWalletsForEstimates() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.verifyForm);
            yield this.unlockMarketWallets();
            loaded();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorder);
            this.preOrder(this.parseOrder());
        });
    }
    unlockWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/openwallet', { assetID });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                throw Error('error unlocking wallet ' + res.msg);
            }
            this.balanceWgt.updateAsset(assetID);
        });
    }
    /*
     * unlockMarketWallets unlocks both the base and quote wallets for the current
     * market, if locked.
     */
    unlockMarketWallets() {
        return __awaiter(this, void 0, void 0, function* () {
            const { base, quote } = this.market;
            const assetIDs = [];
            if (!base.wallet.open)
                assetIDs.push(base.id);
            if (!quote.wallet.open)
                assetIDs.push(quote.id);
            for (const assetID of assetIDs) {
                this.unlockWallet(assetID);
            }
        });
    }
    /* fetchPreorder fetches the pre-order estimates and options. */
    fetchPreorder(order) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const cacheKey = JSON.stringify(order.options);
            const cached = this.preorderCache[cacheKey];
            if (cached)
                return cached;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.verifyForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/preorder', wireOrder(order));
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res))
                return { err: res.msg };
            this.preorderCache[cacheKey] = res.estimate;
            return res.estimate;
        });
    }
    /*
     * setPreorderErr sets and displays the pre-order error message and hides the
     * pre-order details box.
     */
    setPreorderErr(msg) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorder);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorderErr);
        page.vPreorderErrTip.dataset.tooltip = msg;
    }
    showPreOrderAdvancedOptions() {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showAdvancedOptions);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.hideAdvancedOptions, page.vOtherOrderOpts);
    }
    hidePreOrderAdvancedOptions() {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.hideAdvancedOptions, page.vOtherOrderOpts);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showAdvancedOptions);
    }
    reloadOrderOpts(order, swap, redeem, changed) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.vDefaultOrderOpts, page.vOtherOrderOpts);
        const addOption = (opt, isSwap) => {
            const el = _orderutil__WEBPACK_IMPORTED_MODULE_8__.optionElement(opt, order, changed, isSwap);
            if (opt.showByDefault)
                page.vDefaultOrderOpts.appendChild(el);
            else
                page.vOtherOrderOpts.appendChild(el);
        };
        for (const opt of swap.options || [])
            addOption(opt, true);
        for (const opt of redeem.options || [])
            addOption(opt, false);
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(page.vDefaultOrderOpts);
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(page.vOtherOrderOpts);
    }
    /* preOrder loads the options and fetches pre-order estimates */
    preOrder(order) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            // Add swap options.
            const refreshPreorder = () => __awaiter(this, void 0, void 0, function* () {
                const res = yield this.fetchPreorder(order);
                if (res.err)
                    return this.setPreorderErr(res.err);
                const est = res;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderErr);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorder);
                const { swap, redeem } = est;
                swap.options = swap.options || [];
                redeem.options = redeem.options || [];
                this.setFeeEstimates(swap, redeem, order);
                const changed = () => __awaiter(this, void 0, void 0, function* () {
                    yield refreshPreorder();
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(400, progress => {
                        page.vFeeSummary.style.backgroundColor = `rgba(128, 128, 128, ${0.5 - 0.5 * progress})`;
                    });
                });
                // bind show or hide advanced pre order options.
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showAdvancedOptions, 'click', () => { this.showPreOrderAdvancedOptions(); });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.hideAdvancedOptions, 'click', () => { this.hidePreOrderAdvancedOptions(); });
                this.reloadOrderOpts(order, swap, redeem, changed);
            });
            refreshPreorder();
        });
    }
    /* setFeeEstimates sets all of the pre-order estimate fields */
    setFeeEstimates(swap, redeem, order) {
        const { page, market } = this;
        if (!swap.estimate || !redeem.estimate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderEstimates);
            return; // preOrder may return just options, no fee estimates
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorderEstimates);
        const { baseUnitInfo, quoteUnitInfo, rateConversionFactor } = market;
        const fmtPct = (value) => {
            if (value < 0.05)
                return '< 0.1';
            return percentFormatter.format(value);
        };
        // If the asset is a token, in order to calculate the fee as a percentage
        // of the total order, we try to  use the fiat rates to find out the
        // exchange rate between the token and parent assets.
        // Initially these are set to 1, which we would use if the asset is not a
        // token and no conversion is needed.
        let baseExchangeRate = 1;
        let quoteExchangeRate = 1;
        let baseFeeAssetUI = baseUnitInfo;
        let quoteFeeAssetUI = quoteUnitInfo;
        if (market.base.token) {
            const parent = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[market.base.token.parentID];
            baseFeeAssetUI = parent.unitInfo;
            const tokenFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[market.base.id];
            const parentFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[parent.id];
            if (tokenFiatRate && parentFiatRate) {
                const conventionalRate = parentFiatRate / tokenFiatRate;
                baseExchangeRate = conventionalRate * baseUnitInfo.conventional.conversionFactor / parent.unitInfo.conventional.conversionFactor;
            }
            else {
                baseExchangeRate = 0;
            }
        }
        if (market.quote.token) {
            const parent = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[market.quote.token.parentID];
            quoteFeeAssetUI = parent.unitInfo;
            const tokenFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[market.quote.id];
            const parentFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[parent.id];
            if (tokenFiatRate && parentFiatRate) {
                const conventionalRate = parentFiatRate / tokenFiatRate;
                quoteExchangeRate = conventionalRate * quoteUnitInfo.conventional.conversionFactor / parent.unitInfo.conventional.conversionFactor;
            }
            else {
                quoteExchangeRate = 0;
            }
        }
        let [toFeeAssetUI, fromFeeAssetUI] = [baseFeeAssetUI, quoteFeeAssetUI];
        let [toExchangeRate, fromExchangeRate] = [baseExchangeRate, quoteExchangeRate];
        if (this.currentOrder.sell) {
            [fromFeeAssetUI, toFeeAssetUI] = [toFeeAssetUI, fromFeeAssetUI];
            [fromExchangeRate, toExchangeRate] = [toExchangeRate, fromExchangeRate];
        }
        const swapped = swap.estimate.value || 0;
        const swappedInParentUnits = fromExchangeRate > 0 ? swapped / fromExchangeRate : swapped;
        // Set swap fee estimates in the details pane.
        const bestSwapPct = swap.estimate.realisticBestCase / swappedInParentUnits * 100;
        page.vSwapFeesLowPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(bestSwapPct)}%)`;
        page.vSwapFeesLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(swap.estimate.realisticBestCase, fromFeeAssetUI);
        const worstSwapPct = swap.estimate.realisticWorstCase / swappedInParentUnits * 100;
        page.vSwapFeesHighPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(worstSwapPct)}%)`;
        page.vSwapFeesHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(swap.estimate.realisticWorstCase, fromFeeAssetUI);
        const swapFeesMaxPct = swap.estimate.maxFees / swappedInParentUnits * 100;
        page.vSwapFeesMaxPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(swapFeesMaxPct)}%)`;
        page.vSwapFeesMax.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(swap.estimate.maxFees, fromFeeAssetUI);
        // Set redemption fee estimates in the details pane.
        const midGap = this.midGap();
        const estRate = midGap || order.rate / rateConversionFactor;
        const received = order.sell ? swapped * estRate : swapped / estRate;
        const receivedInParentUnits = toExchangeRate > 0 ? received / toExchangeRate : received;
        const bestRedeemPct = redeem.estimate.realisticBestCase / receivedInParentUnits * 100;
        page.vRedeemFeesLowPct.textContent = toExchangeRate <= 0 ? '' : `(${fmtPct(bestRedeemPct)}%)`;
        page.vRedeemFeesLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(redeem.estimate.realisticBestCase, toFeeAssetUI);
        const worstRedeemPct = redeem.estimate.realisticWorstCase / receivedInParentUnits * 100;
        page.vRedeemFeesHighPct.textContent = toExchangeRate <= 0 ? '' : `(${fmtPct(worstRedeemPct)}%)`;
        page.vRedeemFeesHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(redeem.estimate.realisticWorstCase, toFeeAssetUI);
        if (baseExchangeRate && quoteExchangeRate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vFeeSummaryPct);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vFeeSummary);
            page.vFeeSummaryLow.textContent = fmtPct(bestSwapPct + bestRedeemPct);
            page.vFeeSummaryHigh.textContent = fmtPct(worstSwapPct + worstRedeemPct);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vFeeSummaryPct);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vFeeSummary);
            page.summarySwapFeesLow.textContent = page.vSwapFeesLow.textContent;
            page.summarySwapFeesHigh.textContent = page.vSwapFeesHigh.textContent;
            page.summaryRedeemFeesLow.textContent = page.vRedeemFeesLow.textContent;
            page.summaryRedeemFeesHigh.textContent = page.vRedeemFeesHigh.textContent;
        }
    }
    submitCancel() {
        return __awaiter(this, void 0, void 0, function* () {
            // this will be the page.cancelSubmit button (evt.currentTarget)
            const page = this.page;
            const cancelData = this.cancelData;
            const order = cancelData.order;
            const req = {
                orderID: order.id
            };
            // Toggle the loader and submit button.
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.cancelSubmit);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/cancel', req);
            loaded();
            // Display error on confirmation modal.
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                page.cancelErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cancelErr);
                return;
            }
            // Hide confirmation modal only on success.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(cancelData.bttn, page.forms);
            order.cancelling = true;
        });
    }
    /* showCancel shows a form to confirm submission of a cancel order. */
    showCancel(row, orderID) {
        const ord = this.metaOrders[orderID].ord;
        const page = this.page;
        const remaining = ord.qty - ord.filled;
        const asset = _orderutil__WEBPACK_IMPORTED_MODULE_8__.isMarketBuy(ord) ? this.market.quote : this.market.base;
        page.cancelRemain.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(remaining, asset.unitInfo);
        page.cancelUnit.textContent = asset.symbol.toUpperCase();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cancelErr);
        this.forms.show(page.cancelForm);
        this.cancelData = {
            bttn: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(row, 'cancelBttn'),
            order: ord
        };
    }
    /* showAccelerate shows the accelerate order form. */
    showAccelerate(order) {
        const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(this.main);
        this.accelerateOrderForm.refresh(order);
        loaded();
        this.forms.show(this.page.accelerateForm);
    }
    /* showCreate shows the new wallet creation form. */
    showCreate(asset) {
        const page = this.page;
        this.currentCreate = asset;
        this.newWalletForm.setAsset(asset.id);
        this.forms.show(page.newWalletForm);
    }
    /*
     * stepSubmit will examine the current state of wallets and step the user
     * through the process of order submission.
     * NOTE: I expect this process will be streamlined soon such that the wallets
     * will attempt to be unlocked in the order submission process, negating the
     * need to unlock ahead of time.
     */
    stepSubmit() {
        const page = this.page;
        const market = this.market;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.orderErr);
        if (!this.validateOrder(this.parseOrder()))
            return;
        const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().walletMap[market.base.id];
        const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().walletMap[market.quote.id];
        if (!baseWallet) {
            page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ASSET_WALLET, { asset: market.base.symbol });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
            return;
        }
        if (!quoteWallet) {
            page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ASSET_WALLET, { asset: market.quote.symbol });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
            return;
        }
        this.showVerify();
    }
    /* Display a deposit address. */
    showDeposit(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            this.depositAddrForm.setAsset(assetID);
            this.forms.show(this.page.deposit);
        });
    }
    showCustomProviderDialog(assetID) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loadPage('wallets', { promptProvider: assetID, goBack: 'markets' });
    }
    /*
     * handlePriceUpdate is the handler for the 'spots' notification.
     */
    handlePriceUpdate(note) {
        if (!this.market)
            return; // This note can arrive before the market is set.
        if (note.host === this.market.dex.host && note.spots[this.market.cfg.name]) {
            this.setCurrMarketPrice();
        }
        this.marketList.updateSpots(note);
    }
    handleWalletState(note) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.market)
                return; // This note can arrive before the market is set.
            // if (note.topic !== 'TokenApproval') return
            if (note.wallet.assetID !== ((_a = this.market.base) === null || _a === void 0 ? void 0 : _a.id) && note.wallet.assetID !== ((_b = this.market.quote) === null || _b === void 0 ? void 0 : _b.id))
                return;
            this.setTokenApprovalVisibility();
            this.resolveOrderFormVisibility();
        });
    }
    /*
     * handleBondUpdate is the handler for the 'bondpost' notification type.
     * This is used to update the registration status of the current exchange.
     */
    handleBondUpdate(note) {
        return __awaiter(this, void 0, void 0, function* () {
            const dexAddr = note.dex;
            if (!this.market)
                return; // This note can arrive before the market is set.
            if (dexAddr !== this.market.dex.host)
                return;
            // If we just finished legacy registration, we need to update the Exchange.
            // TODO: Use tier change notification once available.
            if (note.topic === 'AccountRegistered')
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchUser();
            // Update local copy of Exchange.
            this.market.dex = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[dexAddr];
            this.setRegistrationStatusVisibility();
            this.updateReputation();
        });
    }
    updateReputation() {
        const { page, market: { dex: { host }, cfg: mkt, baseCfg: { unitInfo: bui }, quoteCfg: { unitInfo: qui } } } = this;
        const { auth } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[host];
        page.parcelSizeLots.textContent = String(mkt.parcelsize);
        page.marketLimitBase.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.parcelsize * mkt.lotsize / bui.conventional.conversionFactor);
        page.marketLimitBaseUnit.textContent = bui.conventional.unit;
        page.marketLimitQuoteUnit.textContent = qui.conventional.unit;
        const conversionRate = this.anyRate()[1];
        if (conversionRate) {
            const quoteLot = mkt.lotsize * conversionRate;
            page.marketLimitQuote.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.parcelsize * quoteLot / qui.conventional.conversionFactor);
        }
        else
            page.marketLimitQuote.textContent = '-';
        const tier = (0,_account__WEBPACK_IMPORTED_MODULE_4__.strongTier)(auth);
        page.tradingTier.textContent = String(tier);
        const [usedParcels, parcelLimit] = (0,_account__WEBPACK_IMPORTED_MODULE_4__.tradingLimits)(host);
        page.tradingLimit.textContent = (parcelLimit * mkt.parcelsize).toFixed(2);
        page.limitUsage.textContent = parcelLimit > 0 ? (usedParcels / parcelLimit * 100).toFixed(1) : '0';
        page.orderLimitRemain.textContent = ((parcelLimit - usedParcels) * mkt.parcelsize).toFixed(1);
        page.orderTradingTier.textContent = String(tier);
        this.reputationMeter.update();
    }
    /*
     * anyRate finds the best rate from any of, in order of priority, the order
     * book, the server's reported spot rate, or the fiat exchange rates. A
     * 3-tuple of message-rate encoding, a conversion rate, and a conventional
     * rate is generated.
     */
    anyRate() {
        const { cfg: { spot }, baseCfg: { id: baseID }, quoteCfg: { id: quoteID }, rateConversionFactor, bookLoaded } = this.market;
        if (bookLoaded) {
            const midGap = this.midGap();
            if (midGap)
                return [midGap * _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor, midGap, this.midGapConventional() || 0];
        }
        if (spot && spot.rate)
            return [spot.rate, spot.rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor, spot.rate / rateConversionFactor];
        const [baseUSD, quoteUSD] = [(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[quoteID]];
        if (baseUSD && quoteUSD) {
            const conventionalRate = baseUSD / quoteUSD;
            const msgRate = conventionalRate * rateConversionFactor;
            const conversionRate = msgRate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
            return [msgRate, conversionRate, conventionalRate];
        }
        return [0, 0, 0];
    }
    handleMatchNote(note) {
        const mord = this.metaOrders[note.orderID];
        const match = note.match;
        if (!mord)
            return this.refreshActiveOrders();
        else if (mord.ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Market && match.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.NewlyMatched) { // Update the average market rate display.
            // Fetch and use the updated order.
            const ord = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().order(note.orderID);
            if (ord)
                mord.details.rate.textContent = mord.header.rate.textContent = this.marketOrderRateString(ord, this.market);
        }
        if ((match.side === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MatchSideMaker && match.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MakerRedeemed) ||
            (match.side === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MatchSideTaker && match.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MatchComplete))
            this.updateReputation();
        if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(mord.ord))
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(mord.details.accelerateBttn);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(mord.details.accelerateBttn);
    }
    /*
     * handleOrderNote is the handler for the 'order'-type notification, which are
     * used to update a user's order's status.
     */
    handleOrderNote(note) {
        const ord = note.order;
        const mord = this.metaOrders[ord.id];
        // - If metaOrder doesn't exist for the given order it means it was created
        //  via bwctl and the GUI isn't aware of it or it was an inflight order.
        //  refreshActiveOrders must be called to grab this order.
        // - If an OrderLoaded notification is recieved, it means an order that was
        //   previously not "ready to tick" (due to its wallets not being connected
        //   and unlocked) has now become ready to tick. The active orders section
        //   needs to be refreshed.
        const wasInflight = note.topic === 'AsyncOrderFailure' || note.topic === 'AsyncOrderSubmitted';
        if (!mord || wasInflight || (note.topic === 'OrderLoaded' && ord.readyToTick)) {
            return this.refreshActiveOrders();
        }
        const oldStatus = mord.ord.status;
        mord.ord = ord;
        if (note.topic === 'MissedCancel')
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(mord.details.cancelBttn);
        if (ord.filled === ord.qty)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(mord.details.cancelBttn);
        if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(ord))
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(mord.details.accelerateBttn);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(mord.details.accelerateBttn);
        this.updateMetaOrder(mord);
        // Only reset markers if there is a change, since the chart is redrawn.
        if ((oldStatus === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusEpoch && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked) ||
            (oldStatus === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked && ord.status > _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked)) {
            this.setDepthMarkers();
            this.updateReputation();
            this.mm.readBook();
        }
    }
    /*
     * handleEpochNote handles notifications signalling the start of a new epoch.
     */
    handleEpochNote(note) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleEpochNote:', note);
        if (!this.market)
            return; // This note can arrive before the market is set.
        if (note.host !== this.market.dex.host || note.marketID !== this.market.sid)
            return;
        if (this.book) {
            this.book.setEpoch(note.epoch);
            this.depthChart.draw();
        }
        this.clearOrderTableEpochs();
        for (const { ord, details, header } of Object.values(this.metaOrders)) {
            const alreadyMatched = note.epoch > ord.epoch;
            switch (true) {
                case ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Limit && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusEpoch && alreadyMatched: {
                    const status = ord.tif === _orderutil__WEBPACK_IMPORTED_MODULE_8__.ImmediateTiF ? _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_EXECUTED) : _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BOOKED);
                    details.status.textContent = header.status.textContent = status;
                    ord.status = ord.tif === _orderutil__WEBPACK_IMPORTED_MODULE_8__.ImmediateTiF ? _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusExecuted : _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked;
                    break;
                }
                case ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Market && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusEpoch:
                    // Technically don't know if this should be 'executed' or 'settling'.
                    details.status.textContent = header.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_EXECUTED);
                    ord.status = _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusExecuted;
                    break;
            }
        }
    }
    /*
     * recentMatchesSortCompare returns sort compare function according to the active
     * sort key and direction.
     */
    recentMatchesSortCompare() {
        switch (this.recentMatchesSortKey) {
            case 'rate':
                return (a, b) => this.recentMatchesSortDirection * (a.rate - b.rate);
            case 'qty':
                return (a, b) => this.recentMatchesSortDirection * (a.qty - b.qty);
            case 'age':
                return (a, b) => this.recentMatchesSortDirection * (a.stamp - b.stamp);
        }
    }
    refreshRecentMatchesTable() {
        const page = this.page;
        const recentMatches = this.recentMatches;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.recentMatchesLiveList);
        if (!recentMatches)
            return;
        const compare = this.recentMatchesSortCompare();
        recentMatches.sort(compare);
        for (const match of recentMatches) {
            const row = page.recentMatchesTemplate.cloneNode(true);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(row);
            tmpl.rate.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.rate / this.market.rateConversionFactor);
            tmpl.qty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, this.market.baseUnitInfo);
            tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(match.stamp);
            tmpl.age.dataset.sinceStamp = String(match.stamp);
            row.classList.add(match.sell ? 'sellcolor' : 'buycolor');
            page.recentMatchesLiveList.append(row);
        }
    }
    addRecentMatches(matches) {
        this.recentMatches = [...matches, ...this.recentMatches].slice(0, 100);
    }
    /* handleBalanceNote handles notifications updating a wallet's balance. */
    handleBalanceNote(note) {
        this.approveTokenForm.handleBalanceNote(note);
        this.preorderCache = {}; // invalidate previous preorder results
        // if connection to dex server fails, it is not possible to retrieve
        // markets.
        const mkt = this.market;
        if (!mkt || !mkt.dex || mkt.dex.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
            return;
        this.mm.handleBalanceNote(note);
        const wgt = this.balanceWgt;
        // Display the widget if the balance note is for its base or quote wallet.
        if ((note.assetID === wgt.base.id || note.assetID === wgt.quote.id))
            wgt.setBalanceVisibility(true);
        // If there's a balance update, refresh the max order section.
        const avail = note.balance.available;
        switch (note.assetID) {
            case mkt.baseCfg.id:
                // If we're not showing the max order panel yet, don't do anything.
                if (!mkt.maxSell)
                    break;
                if (typeof mkt.sellBalance === 'number' && mkt.sellBalance !== avail)
                    mkt.maxSell = null;
                if (this.isSell())
                    this.preSell();
                break;
            case mkt.quoteCfg.id:
                if (!Object.keys(mkt.maxBuys).length)
                    break;
                if (typeof mkt.buyBalance === 'number' && mkt.buyBalance !== avail)
                    mkt.maxBuys = {};
                if (!this.isSell())
                    this.preBuy();
        }
    }
    /*
     * submitOrder is attached to the affirmative button on the order validation
     * form. Clicking the button is the last step in the order submission process.
     */
    submitOrder() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.orderErr, page.vErr);
            const order = this.currentOrder;
            const req = { order: wireOrder(order) };
            if (!this.validateOrder(order))
                return;
            // Show loader and hide submit button.
            page.vSubmit.classList.add('d-hide');
            page.vLoader.classList.remove('d-hide');
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/tradeasync', req);
            // Hide loader and show submit button.
            page.vSubmit.classList.remove('d-hide');
            page.vLoader.classList.add('d-hide');
            // If error, display error on confirmation modal.
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                page.vErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vErr);
                return;
            }
            // Hide confirmation modal only on success.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            this.refreshActiveOrders();
        });
    }
    /*
     * createWallet is attached to successful submission of the wallet creation
     * form. createWallet is only called once the form is submitted and a success
     * response is received from the client.
     */
    createWallet() {
        return __awaiter(this, void 0, void 0, function* () {
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchUser();
            if (!user)
                return;
            const asset = user.assets[this.currentCreate.id];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
            const mkt = this.market;
            if (mkt.baseCfg.id === asset.id)
                mkt.base = asset;
            else if (mkt.quoteCfg.id === asset.id)
                mkt.quote = asset;
            this.balanceWgt.updateAsset(asset.id);
            this.displayMessageIfMissingWallet();
            this.resolveOrderFormVisibility();
        });
    }
    /* lotChanged is attached to the keyup and change events of the lots input. */
    lotChanged() {
        const page = this.page;
        const lots = parseInt(page.lotField.value || '0');
        if (lots <= 0) {
            page.lotField.value = page.lotField.value === '' ? '' : '0';
            page.qtyField.value = '';
            this.previewQuoteAmt(false);
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_ERROR));
            return;
        }
        const lotSize = this.market.cfg.lotsize;
        const orderQty = lots * lotSize;
        page.lotField.value = String(lots);
        // Conversion factor must be a multiple of 10.
        page.qtyField.value = String(orderQty / this.market.baseUnitInfo.conventional.conversionFactor);
        if (!this.isLimit() && this.isSell()) {
            const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[this.market.base.id].wallet;
            this.setOrderBttnEnabled(orderQty <= baseWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
        }
        this.previewQuoteAmt(true);
    }
    /*
     * quantityChanged is attached to the keyup and change events of the quantity
     * input.
     */
    quantityChanged(finalize) {
        const page = this.page;
        const order = this.currentOrder = this.parseOrder();
        if (order.qty < 0) {
            page.lotField.value = '0';
            page.qtyField.value = '';
            this.previewQuoteAmt(false);
            return;
        }
        const lotSize = this.market.cfg.lotsize;
        const lots = Math.floor(order.qty / lotSize);
        const adjusted = order.qty = this.currentOrder.qty = lots * lotSize;
        page.lotField.value = String(lots);
        if (!order.isLimit && !order.sell)
            return;
        // Conversion factor must be a multiple of 10.
        if (finalize)
            page.qtyField.value = String(adjusted / this.market.baseUnitInfo.conventional.conversionFactor);
        this.previewQuoteAmt(true);
    }
    /*
     * marketBuyChanged is attached to the keyup and change events of the quantity
     * input for the market-buy form.
     */
    marketBuyChanged() {
        const page = this.page;
        const qty = convertToAtoms(page.mktBuyField.value || '', this.market.quoteUnitInfo.conventional.conversionFactor);
        const gap = this.midGap();
        if (qty > 0) {
            const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[this.market.quote.id].wallet;
            this.setOrderBttnEnabled(qty <= quoteWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
        }
        else {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_ERROR));
        }
        if (!gap || !qty) {
            page.mktBuyLots.textContent = '0';
            page.mktBuyScore.textContent = '0';
            return;
        }
        const lotSize = this.market.cfg.lotsize;
        const received = qty / gap;
        const lots = (received / lotSize);
        page.mktBuyLots.textContent = lots.toFixed(1);
        page.mktBuyScore.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(received, this.market.baseUnitInfo);
    }
    /*
     * rateFieldChanged is attached to the keyup and change events of the rate
     * input.
     */
    rateFieldChanged() {
        // Truncate to rate step. If it is a market buy order, do not adjust.
        const adjusted = this.adjustedRate();
        if (adjusted <= 0) {
            this.depthLines.input = [];
            this.drawChartLines();
            this.page.rateField.value = '0';
            this.previewQuoteAmt(true);
            this.updateOrderBttnState();
            return;
        }
        const order = this.currentOrder = this.parseOrder();
        const r = adjusted / this.market.rateConversionFactor;
        this.page.rateField.value = String(r);
        this.depthLines.input = [{
                rate: r,
                color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine
            }];
        this.drawChartLines();
        this.previewQuoteAmt(true);
        this.updateOrderBttnState();
    }
    /*
     * adjustedRate is the current rate field rate, rounded down to a
     * multiple of rateStep.
     */
    adjustedRate() {
        const v = this.page.rateField.value;
        if (!v)
            return NaN;
        const rate = convertToAtoms(v, this.market.rateConversionFactor);
        const rateStep = this.market.cfg.ratestep;
        return rate - (rate % rateStep);
    }
    /* loadTable reloads the table from the current order book information. */
    loadTable() {
        this.loadTableSide(true);
        this.loadTableSide(false);
    }
    /* binOrdersByRateAndEpoch takes a list of sorted orders and returns the
       same orders grouped into arrays. The orders are grouped by their rate
       and whether or not they are epoch queue orders. Epoch queue orders
       will come after non epoch queue orders with the same rate. */
    binOrdersByRateAndEpoch(orders) {
        if (!orders || !orders.length)
            return [];
        const bins = [];
        let currEpochBin = [];
        let currNonEpochBin = [];
        let currRate = orders[0].msgRate;
        if (orders[0].epoch)
            currEpochBin.push(orders[0]);
        else
            currNonEpochBin.push(orders[0]);
        for (let i = 1; i < orders.length; i++) {
            if (orders[i].msgRate !== currRate) {
                bins.push(currNonEpochBin);
                bins.push(currEpochBin);
                currEpochBin = [];
                currNonEpochBin = [];
                currRate = orders[i].msgRate;
            }
            if (orders[i].epoch)
                currEpochBin.push(orders[i]);
            else
                currNonEpochBin.push(orders[i]);
        }
        bins.push(currNonEpochBin);
        bins.push(currEpochBin);
        return bins.filter(bin => bin.length > 0);
    }
    /* loadTables loads the order book side into its table. */
    loadTableSide(sell) {
        const bookSide = sell ? this.book.sells : this.book.buys;
        const tbody = sell ? this.page.sellRows : this.page.buyRows;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tbody);
        if (!bookSide || !bookSide.length)
            return;
        const orderBins = this.binOrdersByRateAndEpoch(bookSide);
        orderBins.forEach(bin => { tbody.appendChild(this.orderTableRow(bin)); });
    }
    /* addTableOrder adds a single order to the appropriate table. */
    addTableOrder(order) {
        const tbody = order.sell ? this.page.sellRows : this.page.buyRows;
        let row = tbody.firstChild;
        // Handle market order differently.
        if (order.rate === 0) {
            if (order.qtyAtomic === 0)
                return; // a cancel order. TODO: maybe make an indicator on the target order, maybe gray out
            // This is a market order.
            if (row && row.manager.getRate() === 0) {
                row.manager.insertOrder(order);
            }
            else {
                row = this.orderTableRow([order]);
                tbody.insertBefore(row, tbody.firstChild);
            }
            return;
        }
        // Must be a limit order. Sort by rate. Skip the market order row.
        if (row && row.manager.getRate() === 0)
            row = row.nextSibling;
        while (row) {
            if (row.manager.compare(order) === 0) {
                row.manager.insertOrder(order);
                return;
            }
            else if (row.manager.compare(order) > 0) {
                const tr = this.orderTableRow([order]);
                tbody.insertBefore(tr, row);
                return;
            }
            row = row.nextSibling;
        }
        const tr = this.orderTableRow([order]);
        tbody.appendChild(tr);
    }
    /* removeTableOrder removes a single order from its table. */
    removeTableOrder(order) {
        const token = order.token;
        for (const tbody of [this.page.sellRows, this.page.buyRows]) {
            for (const tr of Array.from(tbody.children)) {
                if (tr.manager.removeOrder(token)) {
                    return;
                }
            }
        }
    }
    /* updateTableOrder looks for the order in the table and updates the qty */
    updateTableOrder(u) {
        for (const tbody of [this.page.sellRows, this.page.buyRows]) {
            for (const tr of Array.from(tbody.children)) {
                if (tr.manager.updateOrderQty(u)) {
                    return;
                }
            }
        }
    }
    /*
     * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired.
     */
    clearOrderTableEpochs() {
        this.clearOrderTableEpochSide(this.page.sellRows);
        this.clearOrderTableEpochSide(this.page.buyRows);
    }
    /*
     * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired
     * for a single side.
     */
    clearOrderTableEpochSide(tbody) {
        for (const tr of (Array.from(tbody.children))) {
            tr.manager.removeEpochOrders();
        }
    }
    /*
     * orderTableRow creates a new <tr> element to insert into an order table.
       Takes a bin of orders with the same rate, and displays the total quantity.
     */
    orderTableRow(orderBin) {
        const tr = this.page.orderRowTmpl.cloneNode(true);
        const { baseUnitInfo, quoteUnitInfo, rateConversionFactor, cfg: { ratestep: rateStep } } = this.market;
        const manager = new OrderTableRowManager(tr, orderBin, baseUnitInfo, quoteUnitInfo, rateStep);
        tr.manager = manager;
        bind(tr, 'click', () => {
            this.reportDepthClick(tr.manager.getRate() / rateConversionFactor);
        });
        if (tr.manager.getRate() !== 0) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tr, 'mouseenter', () => {
                const chart = this.depthChart;
                this.depthLines.hover = [{
                        rate: tr.manager.getRate() / rateConversionFactor,
                        color: tr.manager.isSell() ? chart.theme.sellLine : chart.theme.buyLine
                    }];
                this.drawChartLines();
            });
        }
        return tr;
    }
    /* handleConnNote handles the 'conn' notification.
     */
    handleConnNote(note) {
        return __awaiter(this, void 0, void 0, function* () {
            this.marketList.setConnectionStatus(note);
            if (note.connectionStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected) {
                // Having been disconnected from a DEX server, anything may have changed,
                // or this may be the first opportunity to get the server's config, so
                // fetch it all before reloading the markets page.
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchUser();
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loadPage('markets');
            }
        });
    }
    /*
     * filterMarkets sets the display of markets in the markets list based on the
     * value of the search input.
     */
    filterMarkets() {
        var _a;
        const filterTxt = (_a = this.page.marketSearchV1.value) === null || _a === void 0 ? void 0 : _a.toLowerCase();
        const filter = filterTxt ? (mkt) => mkt.name.includes(filterTxt) : () => true;
        this.marketList.setFilter(filter);
    }
    /* drawChartLines draws the hover and input lines on the chart. */
    drawChartLines() {
        this.depthChart.setLines([...this.depthLines.hover, ...this.depthLines.input]);
        this.depthChart.draw();
    }
    /* candleDurationSelected sets the candleDur and loads the candles. It will
    default to the oneHrBinKey if dur is not valid. */
    candleDurationSelected(dur) {
        var _a, _b;
        if (!((_b = (_a = this.market) === null || _a === void 0 ? void 0 : _a.dex) === null || _b === void 0 ? void 0 : _b.candleDurs.includes(dur)))
            dur = oneHrBinKey;
        this.candleDur = dur;
        this.loadCandles();
        _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastCandleDurationLK, dur);
    }
    /*
     * loadCandles loads the candles for the current candleDur. If a cache is already
     * active, the cache will be used without a loadcandles request.
     */
    loadCandles() {
        for (const bttn of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].kids(this.page.durBttnBox)) {
            if (bttn.textContent === this.candleDur)
                bttn.classList.add('selected');
            else
                bttn.classList.remove('selected');
        }
        const { candleCaches, cfg, baseUnitInfo, quoteUnitInfo } = this.market;
        const cache = candleCaches[this.candleDur];
        if (cache) {
            // this.depthChart.hide()
            // this.candleChart.show()
            this.candleChart.setCandles(cache, cfg, baseUnitInfo, quoteUnitInfo);
            return;
        }
        this.requestCandles();
    }
    /* requestCandles sends the loadcandles request. It accepts an optional candle
     * duration which will be requested if it is provided.
     */
    requestCandles(candleDur) {
        this.candlesLoading = {
            loaded: () => { },
            timer: window.setTimeout(() => {
                if (this.candlesLoading) {
                    this.candlesLoading = null;
                    console.error('candles not received');
                }
            }, 10000)
        };
        const { dex, baseCfg, quoteCfg } = this.market;
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].request('loadcandles', { host: dex.host, base: baseCfg.id, quote: quoteCfg.id, dur: candleDur || this.candleDur });
    }
    /*
     * unload is called by the Application when the user navigates away from
     * the /markets page.
     */
    unload() {
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].request(unmarketRoute, {});
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(bookRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(bookOrderRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(unbookOrderRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(updateRemainingRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(epochOrderRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(candlesRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(candleUpdateRoute);
        this.depthChart.unattach();
        this.candleChart.unattach();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
        clearInterval(this.secondTicker);
    }
}
/*
 *  MarketList represents the list of exchanges and markets on the left side of
 * markets view. The MarketList provides utilities for adjusting the visibility
 * and sort order of markets.
 */
class MarketList {
    constructor(div) {
        this.div = div;
        this.rowTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel(div, 'marketTmplV1');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(this.rowTmpl);
        this.reloadMarketsPane();
    }
    updateSpots(note) {
        for (const row of this.markets) {
            if (row.mkt.xc.host !== note.host)
                continue;
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[row.mkt.xc.host];
            const mkt = xc.markets[row.mkt.name];
            setPriceAndChange(row.tmpl, xc, mkt);
        }
    }
    reloadMarketsPane() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.div);
        this.markets = [];
        const addMarket = (mkt) => {
            const bui = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(mkt.baseid, mkt.xc);
            const qui = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(mkt.quoteid, mkt.xc);
            const rateConversionFactor = _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor;
            const row = new MarketRow(this.rowTmpl, mkt, rateConversionFactor);
            this.div.appendChild(row.node);
            return row;
        };
        for (const mkt of sortedMarkets())
            this.markets.push(addMarket(mkt));
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(this.div);
    }
    find(host, baseID, quoteID) {
        for (const row of this.markets) {
            if (row.mkt.xc.host === host && row.mkt.baseid === baseID && row.mkt.quoteid === quoteID)
                return row;
        }
        return null;
    }
    /* exists will be true if the specified market exists. */
    exists(host, baseID, quoteID) {
        return this.find(host, baseID, quoteID) !== null;
    }
    /* first gets the first market from the first exchange, alphabetically. */
    first() {
        return this.markets[0];
    }
    /* select sets the specified market as selected. */
    select(host, baseID, quoteID) {
        const row = this.find(host, baseID, quoteID);
        if (!row)
            return console.error(`select: no market row for ${host}, ${baseID}-${quoteID}`);
        for (const mkt of this.markets)
            mkt.node.classList.remove('selected');
        this.selected = row;
        this.selected.node.classList.add('selected');
    }
    /* setConnectionStatus sets the visibility of the disconnected icon based
     * on the core.ConnEventNote.
     */
    setConnectionStatus(note) {
        for (const row of this.markets) {
            if (row.mkt.xc.host !== note.host)
                continue;
            if (note.connectionStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(row.tmpl.disconnectedIco);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(row.tmpl.disconnectedIco);
        }
    }
    /*
     * setFilter sets the visibility of market rows based on the provided filter.
     */
    setFilter(filter) {
        for (const row of this.markets) {
            if (filter(row))
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(row.node);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(row.node);
        }
    }
}
/*
 * MarketRow represents one row in the MarketList. A MarketRow is a subsection
 * of the ExchangeSection.
 */
class MarketRow {
    constructor(template, mkt, rateConversionFactor) {
        this.mkt = mkt;
        this.name = mkt.name;
        this.baseID = mkt.baseid;
        this.quoteID = mkt.quoteid;
        this.lotSize = mkt.lotsize;
        this.rateConversionFactor = rateConversionFactor;
        this.node = template.cloneNode(true);
        const tmpl = this.tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(this.node);
        tmpl.baseIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(mkt.basesymbol);
        tmpl.quoteIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(mkt.quotesymbol);
        tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(mkt.xc.assets[mkt.baseid], true));
        tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(mkt.xc.assets[mkt.quoteid], true));
        tmpl.baseName.textContent = mkt.baseName;
        tmpl.host.textContent = mkt.xc.host;
        tmpl.host.style.color = hostColor(mkt.xc.host);
        tmpl.host.dataset.tooltip = mkt.xc.host;
        setPriceAndChange(tmpl, mkt.xc, mkt);
        if (this.mkt.xc.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.disconnectedIco);
    }
}
/*
 * BalanceWidget is a display of balance information. Because the wallet can be
 * in any number of states, and because every exchange has different funding
 * coin confirmation requirements, the BalanceWidget displays a number of state
 * indicators and buttons, as well as tabulated balance data with rows for
 * locked and immature balance.
 */
class BalanceWidget {
    constructor(base, quote) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(base, quote);
        const btmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(base);
        this.base = {
            id: 0,
            parentID: parentIDNone,
            cfg: null,
            node: base,
            tmpl: btmpl,
            iconBox: btmpl.walletState,
            stateIcons: new _doc__WEBPACK_IMPORTED_MODULE_0__.WalletIcons(btmpl.walletState)
        };
        btmpl.balanceRowTmpl.remove();
        const qtmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(quote);
        this.quote = {
            id: 0,
            parentID: parentIDNone,
            cfg: null,
            node: quote,
            tmpl: qtmpl,
            iconBox: qtmpl.walletState,
            stateIcons: new _doc__WEBPACK_IMPORTED_MODULE_0__.WalletIcons(qtmpl.walletState)
        };
        qtmpl.balanceRowTmpl.remove();
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().registerNoteFeeder({
            balance: (note) => { this.updateAsset(note.assetID); },
            walletstate: (note) => { this.updateAsset(note.wallet.assetID); },
            walletsync: (note) => { this.updateAsset(note.assetID); },
            createwallet: (note) => { this.updateAsset(note.assetID); }
        });
    }
    setBalanceVisibility(connected) {
        if (connected)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.base.node, this.quote.node);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.base.node, this.quote.node);
    }
    /*
     * setWallet sets the balance widget to display data for specified market and
     * will display the widget.
     */
    setWallets(host, baseID, quoteID) {
        const parentID = (assetID) => {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[assetID];
            if (asset === null || asset === void 0 ? void 0 : asset.token)
                return asset.token.parentID;
            return parentIDNone;
        };
        this.dex = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().user.exchanges[host];
        this.base.id = baseID;
        this.base.parentID = parentID(baseID);
        this.base.cfg = this.dex.assets[baseID];
        this.quote.id = quoteID;
        this.quote.parentID = parentID(quoteID);
        this.quote.cfg = this.dex.assets[quoteID];
        this.updateWallet(this.base);
        this.updateWallet(this.quote);
        this.setBalanceVisibility(this.dex.connectionStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected);
    }
    /*
     * updateWallet updates the displayed wallet information based on the
     * core.Wallet state.
     */
    updateWallet(side) {
        const { cfg, tmpl, iconBox, stateIcons, id: assetID } = side;
        if (!cfg)
            return; // no wallet set yet
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[assetID];
        // Just hide everything to start.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.newWalletRow, tmpl.expired, tmpl.unsupported, tmpl.connect, tmpl.spinner, tmpl.walletState, tmpl.balanceRows, tmpl.walletAddr, tmpl.wantProvidersBox);
        this.checkNeedsProvider(assetID, tmpl.wantProvidersBox);
        tmpl.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(cfg.symbol);
        tmpl.addWalletSymbol.textContent = cfg.symbol.toUpperCase();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.symbol);
        // Handle an unsupported asset.
        if (!asset) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.unsupported);
            return;
        }
        tmpl.symbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset, true));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(iconBox);
        const wallet = asset.wallet;
        stateIcons.readWallet(wallet);
        // Handle no wallet configured.
        if (!wallet) {
            if (asset.walletCreationPending) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.spinner);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.newWalletRow);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.walletAddr);
        // Parent asset
        const bal = wallet.balance;
        // Handle not connected and no balance known for the DEX.
        if (!bal && !wallet.running && !wallet.disabled) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.connect);
            return;
        }
        // If there is no balance, but the wallet is connected, show the loading
        // icon while we fetch an update.
        if (!bal) {
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchBalance(assetID);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.spinner);
            return;
        }
        // We have a wallet and a DEX-specific balance. Set all of the fields.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.balanceRows);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.balanceRows);
        const addRow = (title, bal, ui, icon) => {
            const row = tmpl.balanceRowTmpl.cloneNode(true);
            tmpl.balanceRows.appendChild(row);
            const balTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            balTmpl.title.textContent = title;
            balTmpl.bal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bal, ui);
            if (icon) {
                balTmpl.bal.append(icon);
                side.parentBal = balTmpl.bal;
            }
        };
        addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_AVAILABLE), bal.available, asset.unitInfo);
        addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_LOCKED), bal.locked + bal.contractlocked + bal.bondlocked, asset.unitInfo);
        addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_IMMATURE), bal.immature, asset.unitInfo);
        if (asset.token) {
            const { wallet: { balance }, unitInfo, symbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[asset.token.parentID];
            const icon = document.createElement('img');
            icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            icon.classList.add('micro-icon', 'ms-1');
            addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_FEE_BALANCE), balance.available, unitInfo, icon);
        }
        // If the current balance update time is older than an hour, show the
        // expiration icon. Request a balance update, if possible.
        const expired = new Date().getTime() - new Date(bal.stamp).getTime() > anHour;
        if (expired && !wallet.disabled) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.expired);
            if (wallet.running)
                (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchBalance(assetID);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.expired);
    }
    checkNeedsProvider(assetID, el) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().needsCustomProvider(assetID), el);
        });
    }
    /* updateParent updates the side's parent asset balance. */
    updateParent(side) {
        var _a;
        const { wallet: { balance }, unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[side.parentID];
        // firstChild is the text node set before the img child node in addRow.
        if ((_a = side.parentBal) === null || _a === void 0 ? void 0 : _a.firstChild)
            side.parentBal.firstChild.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(balance.available, unitInfo);
    }
    /*
     * updateAsset updates the info for one side of the existing market. If the
     * specified asset ID is not one of the current market's base or quote assets,
     * it is silently ignored.
     */
    updateAsset(assetID) {
        if (assetID === this.base.id)
            this.updateWallet(this.base);
        else if (assetID === this.quote.id)
            this.updateWallet(this.quote);
        if (assetID === this.base.parentID)
            this.updateParent(this.base);
        if (assetID === this.quote.parentID)
            this.updateParent(this.quote);
    }
}
/* makeMarket creates a market object that specifies basic market details. */
function makeMarket(host, base, quote) {
    return {
        host: host,
        base: base,
        quote: quote
    };
}
/* marketID creates a DEX-compatible market name from the ticker symbols. */
function marketID(b, q) { return `${b}_${q}`; }
/* convertToAtoms converts the float string to the basic unit of a coin. */
function convertToAtoms(s, conversionFactor) {
    if (!s)
        return 0;
    return Math.round(parseFloat(s) * conversionFactor);
}
/* swapBttns changes the 'selected' class of the buttons. */
function swapBttns(before, now) {
    before.classList.remove('selected');
    now.classList.add('selected');
}
/*
 * wireOrder prepares a copy of the order with the options field converted to a
 * string -> string map.
 */
function wireOrder(order) {
    const stringyOptions = {};
    for (const [k, v] of Object.entries(order.options))
        stringyOptions[k] = JSON.stringify(v);
    return Object.assign({}, order, { options: stringyOptions });
}
// OrderTableRowManager manages the data within a row in an order table. Each row
// represents all the orders in the order book with the same rate, but orders that
// are booked or still in the epoch queue are displayed in separate rows.
class OrderTableRowManager {
    constructor(tableRow, orderBin, baseUnitInfo, quoteUnitInfo, rateStep) {
        this.tableRow = tableRow;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tableRow);
        this.orderBin = orderBin;
        this.sell = orderBin[0].sell;
        this.msgRate = orderBin[0].msgRate;
        this.epoch = !!orderBin[0].epoch;
        this.baseUnitInfo = baseUnitInfo;
        const rateText = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatRateFullPrecision(this.msgRate, baseUnitInfo, quoteUnitInfo, rateStep);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(this.isEpoch(), this.page.epoch);
        if (this.msgRate === 0) {
            page.rate.innerText = 'market';
        }
        else {
            const cssClass = this.isSell() ? 'sellcolor' : 'buycolor';
            page.rate.innerText = rateText;
            page.rate.classList.add(cssClass);
        }
        this.updateQtyNumOrdersEl();
    }
    // updateQtyNumOrdersEl populates the quantity element in the row, and also
    // displays the number of orders if there is more than one order in the order
    // bin.
    updateQtyNumOrdersEl() {
        const { page, orderBin } = this;
        const qty = orderBin.reduce((total, curr) => total + curr.qtyAtomic, 0);
        const numOrders = orderBin.length;
        page.qty.innerText = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(qty, this.baseUnitInfo);
        if (numOrders > 1) {
            page.numOrders.removeAttribute('hidden');
            page.numOrders.innerText = String(numOrders);
            page.numOrders.title = `quantity is comprised of ${numOrders} orders`;
        }
        else {
            page.numOrders.setAttribute('hidden', 'true');
        }
    }
    // insertOrder adds an order to the order bin and updates the row elements
    // accordingly.
    insertOrder(order) {
        this.orderBin.push(order);
        this.updateQtyNumOrdersEl();
    }
    // updateOrderQuantity updates the quantity of the order identified by a token,
    // if it exists in the row, and updates the row elements accordingly. The function
    // returns true if the order is in the bin, and false otherwise.
    updateOrderQty(update) {
        const { token, qty, qtyAtomic } = update;
        for (let i = 0; i < this.orderBin.length; i++) {
            if (this.orderBin[i].token === token) {
                this.orderBin[i].qty = qty;
                this.orderBin[i].qtyAtomic = qtyAtomic;
                this.updateQtyNumOrdersEl();
                return true;
            }
        }
        return false;
    }
    // removeOrder removes the order identified by the token, if it exists in the row,
    // and updates the row elements accordingly. If the order bin is empty, the row is
    // removed from the screen. The function returns true if an order was removed, and
    // false otherwise.
    removeOrder(token) {
        const index = this.orderBin.findIndex(order => order.token === token);
        if (index < 0)
            return false;
        this.orderBin.splice(index, 1);
        if (!this.orderBin.length)
            this.tableRow.remove();
        else
            this.updateQtyNumOrdersEl();
        return true;
    }
    // removeEpochOrders removes all the orders from the row that are not in the
    // new epoch's epoch queue and updates the elements accordingly.
    removeEpochOrders(newEpoch) {
        this.orderBin = this.orderBin.filter((order) => {
            return !(order.epoch && order.epoch !== newEpoch);
        });
        if (!this.orderBin.length)
            this.tableRow.remove();
        else
            this.updateQtyNumOrdersEl();
    }
    // getRate returns the rate of the orders in the row.
    getRate() {
        return this.msgRate;
    }
    // isEpoch returns whether the orders in this row are in the epoch queue.
    isEpoch() {
        return this.epoch;
    }
    // isSell returns whether the orders in this row are sell orders.
    isSell() {
        return this.sell;
    }
    // compare takes an order and returns 0 if the order belongs in this row,
    // 1 if the order should go after this row in the table, and -1 if it should
    // be before this row in the table. Sell orders are displayed in ascending order,
    // buy orders are displayed in descending order, and epoch orders always come
    // after booked orders.
    compare(order) {
        if (this.getRate() === order.msgRate && this.isEpoch() === !!order.epoch) {
            return 0;
        }
        else if (this.getRate() !== order.msgRate) {
            return (this.getRate() > order.msgRate) === order.sell ? 1 : -1;
        }
        else {
            return this.isEpoch() ? 1 : -1;
        }
    }
}
function sortedMarkets() {
    const mkts = [];
    const assets = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets;
    const convertMarkets = (xc, mkts) => {
        return mkts.map((mkt) => {
            const a = assets[mkt.baseid];
            const baseName = a ? a.name : mkt.basesymbol;
            const bui = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(mkt.baseid, xc);
            return Object.assign({ xc, baseName, bui }, mkt);
        });
    };
    for (const xc of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges))
        mkts.push(...convertMarkets(xc, Object.values(xc.markets || {})));
    mkts.sort((a, b) => {
        if (!a.spot) {
            if (b.spot)
                return 1; // put b first, since we have the spot
            // no spots. compare market name then host name
            if (a.name === b.name)
                return a.xc.host.localeCompare(b.xc.host);
            return a.name.localeCompare(b.name);
        }
        else if (!b.spot)
            return -1; // put a first, since we have the spot
        const [aLots, bLots] = [a.spot.vol24 / a.lotsize, b.spot.vol24 / b.lotsize];
        return bLots - aLots; // whoever has more volume by lot count
    });
    return mkts;
}
function setPriceAndChange(tmpl, xc, mkt) {
    if (!mkt.spot)
        return;
    tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().conventionalRate(mkt.baseid, mkt.quoteid, mkt.spot.rate, xc));
    const sign = mkt.spot.change24 > 0 ? '+' : '';
    tmpl.change.classList.remove('buycolor', 'sellcolor');
    tmpl.change.classList.add(mkt.spot.change24 >= 0 ? 'buycolor' : 'sellcolor');
    tmpl.change.textContent = `${sign}${(mkt.spot.change24 * 100).toFixed(1)}%`;
}
const hues = [1 / 2, 1 / 4, 3 / 4, 1 / 8, 5 / 8, 3 / 8, 7 / 8];
function generateHue(idx) {
    const h = hues[idx % hues.length];
    return `hsl(${h * 360}, 35%, 50%)`;
}
function hostColor(host) {
    const hosts = Object.keys((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges);
    hosts.sort();
    return generateHue(hosts.indexOf(host));
}


/***/ }),

/***/ "./src/js/mm.ts":
/*!**********************!*\
  !*** ./src/js/mm.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};








const mediumBreakpoint = 768;
const newSlider = () => {
    return {
        left: {
            cex: 0,
            dex: 0
        },
        right: {
            cex: 0,
            dex: 0
        },
        cexRange: 0,
        dexRange: 0
    };
};
function parseFundingOptions(f) {
    const { cex: { avail: cexAvail, req: cexReq }, dex: { avail: dexAvail, req: dexReq }, transferable } = f;
    let proposedDex = Math.min(dexAvail, dexReq);
    let proposedCex = Math.min(cexAvail, cexReq);
    let slider;
    if (f.fundedAndNotBalanced) {
        // We have everything we need, but not where we need it, and we can
        // deposit and withdraw.
        if (dexAvail > dexReq) {
            // We have too much dex-side, so we'll have to draw on dex to balance
            // cex's shortcomings.
            const cexShort = cexReq - cexAvail;
            const dexRemain = dexAvail - dexReq;
            if (dexRemain < cexShort) {
                // We did something really bad with math to get here.
                throw Error('bad math has us with dex surplus + cex underfund invalid remains');
            }
            proposedDex += cexShort + transferable;
        }
        else {
            // We don't have enough on dex, but we have enough on cex to cover the
            // short.
            const dexShort = dexReq - dexAvail;
            const cexRemain = cexAvail - cexReq;
            if (cexRemain < dexShort) {
                throw Error('bad math got us with cex surplus + dex underfund invalid remains');
            }
            proposedCex += dexShort + transferable;
        }
    }
    else if (f.fundedAndBalanced) {
        // This asset is fully funded, but the user may choose to fund order
        // reserves either cex or dex.
        if (transferable > 0) {
            const dexRemain = dexAvail - dexReq;
            const cexRemain = cexAvail - cexReq;
            slider = newSlider();
            if (cexRemain > transferable && dexRemain > transferable) {
                // Either one could fully fund order reserves. Let the user choose.
                slider.left.cex = transferable + cexReq;
                slider.left.dex = dexReq;
                slider.right.cex = cexReq;
                slider.right.dex = transferable + dexReq;
            }
            else if (dexRemain < transferable && cexRemain < transferable) {
                // => implied that cexRemain + dexRemain > transferable.
                // CEX can contribute SOME and DEX can contribute SOME.
                slider.left.cex = transferable - dexRemain + cexReq;
                slider.left.dex = dexRemain + dexReq;
                slider.right.cex = cexRemain + cexReq;
                slider.right.dex = transferable - cexRemain + dexReq;
            }
            else if (dexRemain > transferable) {
                // So DEX has enough to cover reserves, but CEX could potentially
                // constribute SOME. NOT ALL.
                slider.left.cex = cexReq;
                slider.left.dex = transferable + dexReq;
                slider.right.cex = cexRemain + cexReq;
                slider.right.dex = transferable - cexRemain + dexReq;
            }
            else {
                // CEX has enough to cover reserves, but DEX could contribute SOME,
                // NOT ALL.
                slider.left.cex = transferable - dexRemain + cexReq;
                slider.left.dex = dexRemain + dexReq;
                slider.right.cex = transferable + cexReq;
                slider.right.dex = dexReq;
            }
            // We prefer the slider right in the center.
            slider.cexRange = slider.right.cex - slider.left.cex;
            slider.dexRange = slider.right.dex - slider.left.dex;
            proposedDex = slider.left.dex + (slider.dexRange / 2);
            proposedCex = slider.left.cex + (slider.cexRange / 2);
        }
    }
    else { // starved
        if (cexAvail < cexReq) {
            proposedDex = Math.min(dexAvail, dexReq + transferable + (cexReq - cexAvail));
        }
        else if (dexAvail < dexReq) {
            proposedCex = Math.min(cexAvail, cexReq + transferable + (dexReq - dexAvail));
        }
        else { // just transferable wasn't covered
            proposedDex = Math.min(dexAvail, dexReq + transferable);
            proposedCex = Math.min(cexAvail, dexReq + cexReq + transferable - proposedDex);
        }
    }
    return [proposedDex, proposedCex, slider];
}
class MarketMakerPage extends _basepage__WEBPACK_IMPORTED_MODULE_3__["default"] {
    constructor(main) {
        super();
        this.bots = {};
        this.sortedBots = [];
        this.cexes = {};
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].idDescendants(main);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].cleanTemplates(page.botTmpl, page.botRowTmpl, page.exchangeRowTmpl);
        this.forms = new _forms__WEBPACK_IMPORTED_MODULE_5__.Forms(page.forms);
        this.cexConfigForm = new _forms__WEBPACK_IMPORTED_MODULE_5__.CEXConfigurationForm(page.cexConfigForm, (cexName) => this.cexConfigured(cexName));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.newBot, 'click', () => { this.newBot(); });
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.archivedLogsBtn, 'click', () => { (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmarchives'); });
        this.twoColumn = window.innerWidth >= mediumBreakpoint;
        const ro = new ResizeObserver(() => { this.resized(); });
        ro.observe(main);
        for (const [cexName, dinfo] of Object.entries(_mmutil__WEBPACK_IMPORTED_MODULE_1__.CEXDisplayInfos)) {
            const tr = page.exchangeRowTmpl.cloneNode(true);
            page.cexRows.appendChild(tr);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(tr);
            const configure = () => {
                this.cexConfigForm.setCEX(cexName);
                this.forms.show(page.cexConfigForm);
            };
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.configureBttn, 'click', configure);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.reconfigBttn, 'click', configure);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.errConfigureBttn, 'click', configure);
            const row = this.cexes[cexName] = { tr, tmpl, dinfo, cexName };
            this.updateCexRow(row);
        }
        this.setup();
    }
    resized() {
        const useTwoColumn = window.innerWidth >= 768;
        if (useTwoColumn !== this.twoColumn) {
            this.twoColumn = useTwoColumn;
            this.clearBotBoxes();
            for (const { div } of this.sortedBots)
                this.appendBotBox(div);
        }
    }
    setup() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus;
            const botConfigs = mmStatus.bots.map((s) => s.config);
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().registerNoteFeeder({
                runstats: (note) => { this.handleRunStatsNote(note); },
                runevent: (note) => {
                    const bot = this.bots[(0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(note.host, note.baseID, note.quoteID)];
                    if (bot)
                        return bot.handleRunStats();
                },
                epochreport: (note) => {
                    const bot = this.bots[(0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(note.host, note.baseID, note.quoteID)];
                    if (bot)
                        bot.handleEpochReportNote(note);
                },
                cexproblems: (note) => {
                    const bot = this.bots[(0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(note.host, note.baseID, note.quoteID)];
                    if (bot)
                        bot.handleCexProblemsNote(note);
                },
                cexnote: (note) => { this.handleCEXNote(note); }
                // TODO bot start-stop notification
            });
            const noBots = !botConfigs || botConfigs.length === 0;
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(noBots, page.noBots);
            if (noBots)
                return;
            page.noBots.remove();
            const sortedBots = [...mmStatus.bots].sort((a, b) => {
                var _a, _b, _c, _d;
                if (a.running && !b.running)
                    return -1;
                if (b.running && !a.running)
                    return 1;
                // If none are running, just do something to get a resonably reproducible
                // sort.
                if (!a.running && !b.running)
                    return (a.config.baseID + a.config.quoteID) - (b.config.baseID + b.config.quoteID);
                // Both are running. Sort by run time.
                return ((_b = (_a = b.runStats) === null || _a === void 0 ? void 0 : _a.startTime) !== null && _b !== void 0 ? _b : 0) - ((_d = (_c = a.runStats) === null || _c === void 0 ? void 0 : _c.startTime) !== null && _d !== void 0 ? _d : 0);
            });
            const startupBalanceCache = {};
            for (const botStatus of sortedBots)
                this.addBot(botStatus, startupBalanceCache);
        });
    }
    handleCEXNote(n) {
        return __awaiter(this, void 0, void 0, function* () {
            switch (n.topic) {
                case 'BalanceUpdate':
                    return this.handleCEXBalanceUpdate(n.cexName /* , n.note */);
            }
        });
    }
    handleCEXBalanceUpdate(cexName /* , note: CEXBalanceUpdate */) {
        return __awaiter(this, void 0, void 0, function* () {
            const cexRow = this.cexes[cexName];
            if (cexRow)
                this.updateCexRow(cexRow);
        });
    }
    handleRunStatsNote(note) {
        return __awaiter(this, void 0, void 0, function* () {
            const { baseID, quoteID, host } = note;
            const bot = this.bots[(0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(host, baseID, quoteID)];
            if (bot)
                return bot.handleRunStats();
            this.addBot((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().botStatus(host, baseID, quoteID));
        });
    }
    unload() {
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].unbind(document, 'keyup', this.keyup);
    }
    addBot(botStatus, startupBalanceCache) {
        var _a;
        const { page, bots, sortedBots } = this;
        // Make sure the market still exists.
        const { config: { baseID, quoteID, host } } = botStatus;
        const [baseSymbol, quoteSymbol] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID].symbol, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID].symbol];
        const mktID = `${baseSymbol}_${quoteSymbol}`;
        if (!((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host]) === null || _a === void 0 ? void 0 : _a.markets[mktID]))
            return;
        const bot = new Bot(this, botStatus, startupBalanceCache);
        page.botRows.appendChild(bot.row.tr);
        sortedBots.push(bot);
        bots[bot.id] = bot;
        this.appendBotBox(bot.div);
    }
    appendBotBox(div) {
        const { page: { boxZero, boxOne }, twoColumn } = this;
        const useZeroth = !twoColumn || (boxZero.children.length + boxOne.children.length) % 2 === 0;
        const box = useZeroth ? boxZero : boxOne;
        box.append(div);
    }
    clearBotBoxes() {
        const { page: { boxOne, boxZero } } = this;
        while (boxZero.children.length > 1)
            boxZero.removeChild(boxZero.lastChild);
        while (boxOne.children.length > 0)
            boxOne.removeChild(boxOne.lastChild);
    }
    showBot(botID) {
        const { sortedBots } = this;
        const idx = sortedBots.findIndex((bot) => bot.id === botID);
        sortedBots.splice(idx, 1);
        sortedBots.unshift(this.bots[botID]);
        this.clearBotBoxes();
        for (const { div } of sortedBots)
            this.appendBotBox(div);
        const div = this.bots[botID].div;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].animate(250, (p) => {
            div.style.opacity = `${p}`;
            div.style.transform = `scale(${0.8 + 0.2 * p})`;
        });
    }
    newBot() {
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmsettings');
    }
    cexConfigured(cexName) {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchMMStatus();
            this.updateCexRow(this.cexes[cexName]);
            this.forms.close();
        });
    }
    updateCexRow(row) {
        const { tmpl, dinfo, cexName } = row;
        tmpl.logo.src = dinfo.logo;
        tmpl.name.textContent = dinfo.name;
        const status = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!status, tmpl.unconfigured);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(status && !status.connectErr, tmpl.configured);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(status === null || status === void 0 ? void 0 : status.connectErr, tmpl.connectErrBox);
        if (status === null || status === void 0 ? void 0 : status.connectErr) {
            tmpl.connectErr.textContent = 'connection error';
            tmpl.connectErr.dataset.tooltip = status.connectErr;
        }
        tmpl.logo.classList.toggle('greyscale', !status);
        if (!status)
            return;
        let usdBal = 0;
        const cexSymbolAdded = {}; // avoid double counting tokens or counting both eth and weth
        for (const [assetIDStr, bal] of Object.entries(status.balances)) {
            const assetID = parseInt(assetIDStr);
            const cexSymbol = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bipCEXSymbol(assetID);
            if (cexSymbolAdded[cexSymbol])
                continue;
            cexSymbolAdded[cexSymbol] = true;
            const { unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[assetID];
            if (fiatRate)
                usdBal += fiatRate * (bal.available + bal.locked) / unitInfo.conventional.conversionFactor;
        }
        tmpl.usdBalance.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(usdBal);
    }
    percentageBalanceStr(assetID, balance, percentage) {
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
        const unitInfo = asset.unitInfo;
        const assetValue = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue((balance * percentage) / 100, unitInfo);
        return `${_doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(percentage)}% - ${assetValue} ${asset.symbol.toUpperCase()}`;
    }
    /*
     * walletBalanceStr returns a string like "50% - 0.0001 BTC" representing
     * the percentage of a wallet's balance selected in the market maker setting,
     * and the amount of that asset in the wallet.
     */
    walletBalanceStr(assetID, percentage) {
        const { wallet: { balance: { available } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
        return this.percentageBalanceStr(assetID, available, percentage);
    }
}
class Bot extends _mmutil__WEBPACK_IMPORTED_MODULE_1__.BotMarket {
    constructor(pg, status, startupBalanceCache) {
        super(status.config);
        startupBalanceCache = startupBalanceCache !== null && startupBalanceCache !== void 0 ? startupBalanceCache : {};
        this.pg = pg;
        const { baseID, quoteID, host, botType, nBuyPlacements, nSellPlacements, cexName } = this;
        this.id = (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(host, baseID, quoteID);
        const div = this.div = pg.page.botTmpl.cloneNode(true);
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(div);
        this.runDisplay = new _mmutil__WEBPACK_IMPORTED_MODULE_1__.RunningMarketMakerDisplay(page.onBox, pg.forms, pg.page.orderReportForm, 'mm');
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.setMarketElements)(div, baseID, quoteID, host);
        if (cexName)
            (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.setCexElements)(div, cexName);
        if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeArbMM) {
            page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BOTTYPE_ARB_MM);
        }
        else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb) {
            page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BOTTYPE_SIMPLE_ARB);
        }
        else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicMM) {
            page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BOTTYPE_BASIC_MM);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb, page.placementsChartBox, page.baseTokenSwapFeesBox);
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb) {
            this.placementsChart = new _mmutil__WEBPACK_IMPORTED_MODULE_1__.PlacementsChart(page.placementsChart);
            page.buyPlacementCount.textContent = String(nBuyPlacements);
            page.sellPlacementCount.textContent = String(nSellPlacements);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.startBttn, 'click', () => this.start());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.allocationBttn, 'click', () => this.allocate());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.reconfigureBttn, 'click', () => this.reconfigure());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.goBackFromAllocation, 'click', () => this.hideAllocationDialog());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.marketLink, 'click', () => (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('markets', { host, baseID, quoteID }));
        this.baseAllocSlider = new _doc__WEBPACK_IMPORTED_MODULE_2__.MiniSlider(page.baseAllocSlider, () => { });
        this.quoteAllocSlider = new _doc__WEBPACK_IMPORTED_MODULE_2__.MiniSlider(page.quoteAllocSlider, () => { });
        const tr = pg.page.botRowTmpl.cloneNode(true);
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.setMarketElements)(tr, baseID, quoteID, host);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(tr);
        this.row = { tr, tmpl };
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.allocateBttn, 'click', (e) => {
            e.stopPropagation();
            this.allocate();
            pg.showBot(this.id);
        });
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tr, 'click', () => pg.showBot(this.id));
        this.initialize(startupBalanceCache);
    }
    initialize(startupBalanceCache) {
        const _super = Object.create(null, {
            initialize: { get: () => super.initialize }
        });
        return __awaiter(this, void 0, void 0, function* () {
            yield _super.initialize.call(this, startupBalanceCache);
            this.runDisplay.setBotMarket(this);
            const { page, host, cexName, botType, div, cfg: { arbMarketMakingConfig, basicMarketMakingConfig }, mktID, baseFactor, quoteFactor, marketReport: { baseFiatRate } } = this;
            if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb) {
                let buyPlacements = [];
                let sellPlacements = [];
                let profit = 0;
                if (arbMarketMakingConfig) {
                    buyPlacements = arbMarketMakingConfig.buyPlacements.map((p) => ({ lots: p.lots, gapFactor: p.multiplier }));
                    sellPlacements = arbMarketMakingConfig.sellPlacements.map((p) => ({ lots: p.lots, gapFactor: p.multiplier }));
                    profit = arbMarketMakingConfig.profit;
                }
                else if (basicMarketMakingConfig) {
                    buyPlacements = basicMarketMakingConfig.buyPlacements;
                    sellPlacements = basicMarketMakingConfig.sellPlacements;
                    let bestBuy;
                    let bestSell;
                    if (buyPlacements.length > 0)
                        bestBuy = buyPlacements.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
                    if (sellPlacements.length > 0)
                        bestSell = sellPlacements.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
                    if (bestBuy && bestSell) {
                        profit = (bestBuy.gapFactor + bestSell.gapFactor) / 2;
                    }
                    else if (bestBuy) {
                        profit = bestBuy.gapFactor;
                    }
                    else if (bestSell) {
                        profit = bestSell.gapFactor;
                    }
                }
                const marketConfig = { cexName: cexName, botType, baseFiatRate: baseFiatRate, dict: { profit, buyPlacements, sellPlacements } };
                this.placementsChart.setMarket(marketConfig);
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicMM, page.cexDataBox);
            if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicMM) {
                const cex = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
                if (cex) {
                    const mkt = cex.markets ? cex.markets[mktID] : undefined;
                    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(mkt === null || mkt === void 0 ? void 0 : mkt.day, page.cexDataBox);
                    if (mkt === null || mkt === void 0 ? void 0 : mkt.day) {
                        const day = mkt.day;
                        page.cexPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(day.lastPrice);
                        page.cexVol.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(baseFiatRate * day.vol);
                    }
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(Boolean(cexName), ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(div, '[data-cex-show]'));
            const { spot } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].markets[mktID];
            if (spot) {
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.dexDataBox);
                const c = _orderutil__WEBPACK_IMPORTED_MODULE_4__.RateEncodingFactor / baseFactor * quoteFactor;
                page.dexPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(spot.rate / c);
                page.dexVol.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(spot.vol24 / baseFactor * baseFiatRate);
            }
            this.updateDisplay();
            this.updateTableRow();
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.loadingBg);
        });
    }
    updateTableRow() {
        const { row: { tmpl } } = this;
        const { running, runStats } = this.status();
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(running, tmpl.profitLossBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!running, tmpl.allocateBttnBox);
        if (runStats) {
            tmpl.profitLoss.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(runStats.profitLoss.profit, 2);
        }
    }
    updateDisplay() {
        const { page, marketReport: { baseFiatRate, quoteFiatRate }, baseFeeFiatRate, quoteFeeFiatRate } = this;
        if ([baseFiatRate, quoteFiatRate, baseFeeFiatRate, quoteFeeFiatRate].some((r) => !r)) {
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.onBox, page.offBox);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.noFiatDisplay);
            return;
        }
        const { running } = this.status();
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(running, page.onBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!running, page.offBox);
        if (running)
            this.updateRunningDisplay();
        else
            this.updateIdleDisplay();
    }
    updateRunningDisplay() {
        this.runDisplay.update();
    }
    updateIdleDisplay() {
        const { page, proj: { alloc, qProj, bProj }, baseID, quoteID, cexName, bui, qui, baseFeeID, quoteFeeID, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor, marketReport: { baseFiatRate, quoteFiatRate }, cfg: { uiConfig: { baseConfig, quoteConfig } }, quoteFeeUI, baseFeeUI } = this;
        page.baseAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(alloc[baseID], bui);
        const baseUSD = alloc[baseID] / baseFactor * baseFiatRate;
        let totalUSD = baseUSD;
        page.baseAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(baseUSD);
        page.baseBookAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bProj.book * baseFactor, bui);
        page.baseOrderReservesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bProj.orderReserves * baseFactor, bui);
        page.baseOrderReservesPct.textContent = String(Math.round(baseConfig.orderReservesFactor * 100));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, page.baseCexAllocBox);
        if (cexName)
            page.baseCexAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bProj.cex * baseFactor, bui);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID === baseID, page.baseBookingFeesAllocBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID !== baseID, page.baseTokenFeesAllocBox);
        if (baseFeeID === baseID) {
            const bookingFees = baseID === quoteFeeID ? bProj.bookingFees + qProj.bookingFees : bProj.bookingFees;
            page.baseBookingFeesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bookingFees * baseFeeFactor, baseFeeUI);
        }
        else {
            const feeAlloc = alloc[baseFeeID];
            page.baseTokenFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(feeAlloc, baseFeeUI);
            const baseFeeUSD = feeAlloc / baseFeeFactor * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[baseFeeID];
            totalUSD += baseFeeUSD;
            page.baseTokenAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(baseFeeUSD);
            const withQuote = baseFeeID === quoteFeeID;
            const bookingFees = bProj.bookingFees + (withQuote ? qProj.bookingFees : 0);
            page.baseTokenBookingFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bookingFees * baseFeeFactor, baseFeeUI);
            page.baseTokenSwapFeeN.textContent = String(baseConfig.swapFeeN + (withQuote ? quoteConfig.swapFeeN : 0));
            const swapReserves = bProj.swapFeeReserves + (withQuote ? qProj.swapFeeReserves : 0);
            page.baseTokenSwapFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(swapReserves * baseFeeFactor, baseFeeUI);
        }
        page.quoteAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(alloc[quoteID], qui);
        const quoteUSD = alloc[quoteID] / quoteFactor * quoteFiatRate;
        totalUSD += quoteUSD;
        page.quoteAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(quoteUSD);
        page.quoteBookAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.book * quoteFactor, qui);
        page.quoteOrderReservesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.orderReserves * quoteFactor, qui);
        page.quoteOrderReservesPct.textContent = String(Math.round(quoteConfig.orderReservesFactor * 100));
        page.quoteSlippageAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.slippageBuffer * quoteFactor, qui);
        page.slippageBufferFactor.textContent = String(Math.round(quoteConfig.slippageBufferFactor * 100));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, page.quoteCexAllocBox);
        if (cexName)
            page.quoteCexAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.cex * quoteFactor, qui);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteID === quoteFeeID, page.quoteBookingFeesAllocBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteFeeID !== quoteID && quoteFeeID !== baseFeeID, page.quoteTokenFeesAllocBox);
        if (quoteID === quoteFeeID) {
            const bookingFees = quoteID === baseFeeID ? bProj.bookingFees + qProj.bookingFees : qProj.bookingFees;
            page.quoteBookingFeesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bookingFees * quoteFeeFactor, quoteFeeUI);
        }
        else if (quoteFeeID !== baseFeeID) {
            page.quoteTokenFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(alloc[quoteFeeID], quoteFeeUI);
            const quoteFeeUSD = alloc[quoteFeeID] / quoteFeeFactor * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[quoteFeeID];
            totalUSD += quoteFeeUSD;
            page.quoteTokenAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(quoteFeeUSD);
            page.quoteTokenBookingFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.bookingFees * quoteFeeFactor, quoteFeeUI);
            page.quoteTokenSwapFeeN.textContent = String(quoteConfig.swapFeeN);
            page.quoteTokenSwapFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.swapFeeReserves * quoteFeeFactor, quoteFeeUI);
        }
        page.totalAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(totalUSD);
    }
    /*
     * allocate opens a dialog to choose funding sources (if applicable) and
     * confirm allocations and start the bot.
     */
    allocate() {
        var _a, _b, _c;
        const f = this.fundingState();
        const { page, marketReport: { baseFiatRate, quoteFiatRate }, baseID, quoteID, baseFeeID, quoteFeeID, baseFeeFiatRate, quoteFeeFiatRate, cexName, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor, host, mktID } = this;
        const [proposedDexBase, proposedCexBase, baseSlider] = parseFundingOptions(f.base);
        const [proposedDexQuote, proposedCexQuote, quoteSlider] = parseFundingOptions(f.quote);
        const alloc = this.alloc = {
            dex: {
                [baseID]: proposedDexBase * baseFactor,
                [quoteID]: proposedDexQuote * quoteFactor
            },
            cex: {
                [baseID]: proposedCexBase * baseFactor,
                [quoteID]: proposedCexQuote * quoteFactor
            }
        };
        alloc.dex[baseFeeID] = Math.min(((_a = alloc.dex[baseFeeID]) !== null && _a !== void 0 ? _a : 0) + (f.base.fees.req * baseFeeFactor), f.base.fees.avail * baseFeeFactor);
        alloc.dex[quoteFeeID] = Math.min(((_b = alloc.dex[quoteFeeID]) !== null && _b !== void 0 ? _b : 0) + (f.quote.fees.req * quoteFeeFactor), f.quote.fees.avail * quoteFeeFactor);
        let totalUSD = (alloc.dex[baseID] / baseFactor * baseFiatRate) + (alloc.dex[quoteID] / quoteFactor * quoteFiatRate);
        totalUSD += (alloc.cex[baseID] / baseFactor * baseFiatRate) + (alloc.cex[quoteID] / quoteFactor * quoteFiatRate);
        if (baseFeeID !== baseID)
            totalUSD += alloc.dex[baseFeeID] / baseFeeFactor * baseFeeFiatRate;
        if (quoteFeeID !== quoteID && quoteFeeID !== baseFeeID)
            totalUSD += alloc.dex[quoteFeeID] / quoteFeeFactor * quoteFeeFiatRate;
        page.allocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(totalUSD);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(page.allocationDialog, '[data-cex-only]'));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.fundedAndBalanced, page.fundedAndBalancedBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.base.transferable + f.quote.transferable > 0, page.hasTransferable);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.fundedAndNotBalanced, page.fundedAndNotBalancedBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.starved, page.starvedBox);
        page.startBttn.classList.toggle('go', f.fundedAndBalanced);
        page.startBttn.classList.toggle('warning', !f.fundedAndBalanced);
        page.proposedDexBaseAlloc.classList.toggle('text-warning', !(f.base.fundedAndBalanced || f.base.fundedAndNotBalanced));
        page.proposedDexQuoteAlloc.classList.toggle('text-warning', !(f.quote.fundedAndBalanced || f.quote.fundedAndNotBalanced));
        const setBaseProposal = (dex, cex) => {
            page.proposedDexBaseAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex);
            page.proposedDexBaseAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex * baseFiatRate);
            page.proposedCexBaseAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex);
            page.proposedCexBaseAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex * baseFiatRate);
        };
        setBaseProposal(proposedDexBase, proposedCexBase);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseSlider, page.baseAllocSlider);
        if (baseSlider) {
            const dexRange = baseSlider.right.dex - baseSlider.left.dex;
            const cexRange = baseSlider.right.cex - baseSlider.left.cex;
            this.baseAllocSlider.setValue(0.5);
            this.baseAllocSlider.changed = (r) => {
                const dexAlloc = baseSlider.left.dex + r * dexRange;
                const cexAlloc = baseSlider.left.cex + r * cexRange;
                alloc.dex[baseID] = dexAlloc * baseFactor;
                alloc.cex[baseID] = cexAlloc * baseFactor;
                setBaseProposal(dexAlloc, cexAlloc);
            };
        }
        const setQuoteProposal = (dex, cex) => {
            page.proposedDexQuoteAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex);
            page.proposedDexQuoteAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex * quoteFiatRate);
            page.proposedCexQuoteAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex);
            page.proposedCexQuoteAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex * quoteFiatRate);
        };
        setQuoteProposal(proposedDexQuote, proposedCexQuote);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteSlider, page.quoteAllocSlider);
        if (quoteSlider) {
            const dexRange = quoteSlider.right.dex - quoteSlider.left.dex;
            const cexRange = quoteSlider.right.cex - quoteSlider.left.cex;
            this.quoteAllocSlider.setValue(0.5);
            this.quoteAllocSlider.changed = (r) => {
                const dexAlloc = quoteSlider.left.dex + r * dexRange;
                const cexAlloc = quoteSlider.left.cex + r * cexRange;
                alloc.dex[quoteID] = dexAlloc * quoteFactor;
                alloc.cex[quoteID] = cexAlloc * quoteFactor;
                setQuoteProposal(dexAlloc, cexAlloc);
            };
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID !== baseID, ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(page.allocationDialog, '[data-base-token-fees]'));
        if (baseFeeID !== baseID) {
            const reqFees = f.base.fees.req + (baseFeeID === quoteFeeID ? f.quote.fees.req : 0);
            const proposedFees = Math.min(reqFees, f.base.fees.avail);
            page.proposedDexBaseFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees);
            page.proposedDexBaseFeeAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees * baseFeeFiatRate);
            page.proposedDexBaseFeeAlloc.classList.toggle('text-warning', !f.base.fees.funded);
        }
        const needQuoteTokenFees = quoteFeeID !== quoteID && quoteFeeID !== baseFeeID;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(needQuoteTokenFees, ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(page.allocationDialog, '[data-quote-token-fees]'));
        if (needQuoteTokenFees) {
            const proposedFees = Math.min(f.quote.fees.req, f.quote.fees.avail);
            page.proposedDexQuoteFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees);
            page.proposedDexQuoteFeeAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees * quoteFeeFiatRate);
            page.proposedDexQuoteFeeAlloc.classList.toggle('text-warning', !f.quote.fees.funded);
        }
        const mkt = (_c = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host]) === null || _c === void 0 ? void 0 : _c.markets[mktID];
        let existingOrders = false;
        if (mkt && mkt.orders) {
            for (let i = 0; i < mkt.orders.length; i++) {
                if (mkt.orders[i].status <= _orderutil__WEBPACK_IMPORTED_MODULE_4__.StatusBooked) {
                    existingOrders = true;
                    break;
                }
            }
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(existingOrders, page.existingOrdersBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.allocationDialog);
        const closeDialog = (e) => {
            if (_doc__WEBPACK_IMPORTED_MODULE_2__["default"].mouseInElement(e, page.allocationDialog))
                return;
            this.hideAllocationDialog();
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].unbind(document, 'click', closeDialog);
        };
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(document, 'click', closeDialog);
    }
    hideAllocationDialog() {
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(this.page.allocationDialog);
    }
    start() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, alloc, baseID, quoteID, host, cexName, cfg: { uiConfig: { cexRebalance } } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.errMsg);
            if (cexName && !((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName]) === null || _a === void 0 ? void 0 : _a.connected)) {
                page.errMsg.textContent = `${cexName} not connected`;
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.errMsg);
                return;
            }
            // round allocations values.
            for (const m of [alloc.dex, alloc.cex]) {
                for (const [assetID, v] of Object.entries(m))
                    m[parseInt(assetID)] = Math.round(v);
            }
            const startConfig = {
                baseID: baseID,
                quoteID: quoteID,
                host: host,
                alloc: alloc
            };
            if (cexName && cexRebalance)
                startConfig.autoRebalance = this.autoRebalanceSettings();
            try {
                (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().log('mm', 'starting mm bot', startConfig);
                const res = yield _mmutil__WEBPACK_IMPORTED_MODULE_1__.MM.startBot(startConfig);
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res))
                    throw res;
            }
            catch (e) {
                page.errMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_API_ERROR, e);
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.errMsg);
                return;
            }
            this.hideAllocationDialog();
        });
    }
    autoRebalanceSettings() {
        const { proj: { bProj, qProj, alloc }, baseFeeID, quoteFeeID, cfg: { uiConfig: { baseConfig, quoteConfig } }, baseID, quoteID, cexName, mktID } = this;
        const totalBase = alloc[baseID];
        let dexMinBase = bProj.book;
        if (baseID === baseFeeID)
            dexMinBase += bProj.bookingFees;
        if (baseID === quoteFeeID)
            dexMinBase += qProj.bookingFees;
        let dexMinQuote = qProj.book;
        if (quoteID === quoteFeeID)
            dexMinQuote += qProj.bookingFees;
        if (quoteID === baseFeeID)
            dexMinQuote += bProj.bookingFees;
        const maxBase = Math.max(totalBase - dexMinBase, totalBase - bProj.cex);
        const totalQuote = alloc[quoteID];
        const maxQuote = Math.max(totalQuote - dexMinQuote, totalQuote - qProj.cex);
        if (maxBase < 0 || maxQuote < 0) {
            throw Error(`rebalance math doesn't work: ${JSON.stringify({ bProj, qProj, maxBase, maxQuote })}`);
        }
        const cex = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
        const mkt = cex.markets[mktID];
        const [minB, maxB] = [mkt.baseMinWithdraw, Math.max(mkt.baseMinWithdraw * 2, maxBase)];
        const minBaseTransfer = Math.round(minB + baseConfig.transferFactor * (maxB - minB));
        const [minQ, maxQ] = [mkt.quoteMinWithdraw, Math.max(mkt.quoteMinWithdraw * 2, maxQuote)];
        const minQuoteTransfer = Math.round(minQ + quoteConfig.transferFactor * (maxQ - minQ));
        return { minBaseTransfer, minQuoteTransfer };
    }
    reconfigure() {
        const { host, baseID, quoteID, cexName, botType } = this;
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmsettings', { host, baseID, quoteID, cexName, botType });
    }
    handleEpochReportNote(note) {
        this.runDisplay.handleEpochReportNote(note);
    }
    handleCexProblemsNote(note) {
        this.runDisplay.handleCexProblemsNote(note);
    }
    handleRunStats() {
        this.updateDisplay();
        this.updateTableRow();
        this.runDisplay.readBook();
    }
}


/***/ }),

/***/ "./src/js/mmarchives.ts":
/*!******************************!*\
  !*** ./src/js/mmarchives.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerArchivesPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class MarketMakerArchivesPage extends _basepage__WEBPACK_IMPORTED_MODULE_3__["default"] {
    constructor(main) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].idDescendants(main);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].cleanTemplates(page.runTableRowTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.backButton, 'click', () => { (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm'); });
        this.setup();
    }
    setup() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.getJSON)('/api/archivedmmruns');
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res)) {
                console.error('failed to get archived mm runs', res);
                // TODO: show error
                return;
            }
            const runs = res.runs;
            for (let i = 0; i < runs.length; i++) {
                const { startTime, market: { baseID, quoteID, host } } = runs[i];
                const row = this.page.runTableRowTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(row);
                tmpl.startTime.textContent = new Date(startTime * 1000).toLocaleString();
                (0,_mmutil__WEBPACK_IMPORTED_MODULE_4__.setMarketElements)(row, baseID, quoteID, host);
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.logs, 'click', () => {
                    (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmlogs', { baseID, quoteID, host, startTime, returnPage: 'mmarchives' });
                });
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.settings, 'click', () => {
                    (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmsettings', { host, baseID, quoteID });
                });
                this.page.runTableBody.appendChild(row);
            }
        });
    }
}


/***/ }),

/***/ "./src/js/mmlogs.ts":
/*!**************************!*\
  !*** ./src/js/mmlogs.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerLogsPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _wallets__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./wallets */ "./src/js/wallets.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









let net = 0;
const logsBatchSize = 50;
function eventPassesFilter(e, filters) {
    if (e.dexOrderEvent) {
        if (e.dexOrderEvent.sell)
            return filters.dexSells;
        return filters.dexBuys;
    }
    if (e.cexOrderEvent) {
        if (e.cexOrderEvent.sell)
            return filters.cexSells;
        return filters.cexBuys;
    }
    if (e.depositEvent)
        return filters.deposits;
    if (e.withdrawalEvent)
        return filters.withdrawals;
    return false;
}
class MarketMakerLogsPage extends _basepage__WEBPACK_IMPORTED_MODULE_4__["default"] {
    constructor(main, params) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].idDescendants(main);
        net = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().user.net;
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].cleanTemplates(page.eventTableRowTmpl, page.dexOrderTxRowTmpl, page.performanceTableRowTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(this.page.backButton, 'click', () => { var _a; (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage((_a = params.returnPage) !== null && _a !== void 0 ? _a : 'mm'); });
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(this.page.filterButton, 'click', () => { this.applyFilters(); });
        if (params === null || params === void 0 ? void 0 : params.host) {
            const url = new URL(window.location.href);
            url.searchParams.set('host', params.host);
            url.searchParams.set('baseID', String(params.baseID));
            url.searchParams.set('quoteID', String(params.quoteID));
            url.searchParams.set('startTime', String(params.startTime));
            window.history.replaceState(Object.assign({ page: 'mmsettings' }, params), '', url);
        }
        else {
            const urlParams = new URLSearchParams(window.location.search);
            if (!params)
                params = {};
            params.host = urlParams.get('host') || '';
            params.baseID = parseInt(urlParams.get('baseID') || '0');
            params.quoteID = parseInt(urlParams.get('quoteID') || '0');
            params.startTime = parseInt(urlParams.get('startTime') || '0');
        }
        const { baseID, quoteID, host, startTime } = params;
        this.startTime = startTime;
        this.forms = new _forms__WEBPACK_IMPORTED_MODULE_1__.Forms(page.forms);
        this.events = {};
        this.statsRows = {};
        this.mkt = { baseID: baseID, quoteID: quoteID, host };
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setMarketElements)(main, baseID, quoteID, host);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(main, 'scroll', () => {
            if (this.loading)
                return;
            if (this.doneScrolling)
                return;
            const belowBottom = page.eventsTable.offsetHeight - main.offsetHeight - main.scrollTop;
            if (belowBottom < 0) {
                this.nextPage();
            }
        });
        this.setup(host, baseID, quoteID);
    }
    nextPage() {
        return __awaiter(this, void 0, void 0, function* () {
            this.loading = true;
            const [events, updatedLogs, overview] = yield this.getRunLogs();
            const assets = this.mktAssets();
            for (const event of events) {
                if (this.events[event.id])
                    continue;
                const row = this.newEventRow(event, false, assets);
                this.events[event.id] = [event, row];
            }
            this.populateStats(overview.profitLoss, overview.endTime);
            this.updateExistingRows(updatedLogs);
            this.loading = false;
        });
    }
    getRunLogs() {
        return __awaiter(this, void 0, void 0, function* () {
            const { mkt, startTime } = this;
            const req = { market: mkt, startTime, n: logsBatchSize, filters: this.filters, refID: this.refID };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/mmrunlogs', req);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res)) {
                console.error('failed to get bot logs', res);
            }
            if (res.logs.length <= 1) {
                this.doneScrolling = true;
            }
            if (res.logs.length > 0) {
                this.refID = res.logs[res.logs.length - 1].id;
            }
            return [res.logs, res.updatedLogs || [], res.overview];
        });
    }
    applyFilters() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.filters = {
                dexSells: !!page.dexSellsCheckbox.checked,
                dexBuys: !!page.dexBuysCheckbox.checked,
                cexSells: !!page.cexSellsCheckbox.checked,
                cexBuys: !!page.cexBuysCheckbox.checked,
                deposits: !!page.depositsCheckbox.checked,
                withdrawals: !!page.withdrawalsCheckbox.checked
            };
            this.refID = undefined;
            const [events, , overview] = yield this.getRunLogs();
            this.populateTable(events);
            this.populateStats(overview.profitLoss, overview.endTime);
        });
    }
    setFilters() {
        const page = this.page;
        page.dexSellsCheckbox.checked = true;
        page.dexBuysCheckbox.checked = true;
        page.cexSellsCheckbox.checked = true;
        page.cexBuysCheckbox.checked = true;
        page.depositsCheckbox.checked = true;
        page.withdrawalsCheckbox.checked = true;
        this.filters = {
            dexSells: true,
            dexBuys: true,
            cexSells: true,
            cexBuys: true,
            deposits: true,
            withdrawals: true
        };
    }
    setup(host, baseID, quoteID) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.setFilters();
            const { startTime } = this;
            let profitLoss;
            let endTime = 0;
            const botStatus = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotStatus)(host, baseID, quoteID);
            const [events, , overview] = yield this.getRunLogs();
            if (((_a = botStatus === null || botStatus === void 0 ? void 0 : botStatus.runStats) === null || _a === void 0 ? void 0 : _a.startTime) === startTime) {
                this.liveBot = true;
                this.fiatRates = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap;
                profitLoss = botStatus.runStats.profitLoss;
            }
            else {
                this.fiatRates = overview.finalState.fiatRates;
                profitLoss = overview.profitLoss;
                endTime = overview.endTime;
            }
            this.populateStats(profitLoss, endTime);
            const assets = this.mktAssets();
            const parentHeader = page.sumUSDHeader.parentElement;
            for (const asset of assets) {
                const th = document.createElement('th');
                th.textContent = `${asset.symbol.toUpperCase()} Delta`;
                if (parentHeader) {
                    parentHeader.insertBefore(th, page.sumUSDHeader);
                }
            }
            this.populateTable(events);
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().registerNoteFeeder({
                runevent: (note) => { this.handleRunEventNote(note); },
                runstats: (note) => { this.handleRunStatsNote(note); }
            });
        });
    }
    handleRunEventNote(note) {
        const { baseID, quoteID, host } = this.mkt;
        if (note.host !== host || note.baseID !== baseID || note.quoteID !== quoteID)
            return;
        if (!eventPassesFilter(note.event, this.filters))
            return;
        const event = note.event;
        const cachedEvent = this.events[event.id];
        if (cachedEvent) {
            this.setRowContents(cachedEvent[1], event, this.mktAssets());
            cachedEvent[0] = event;
            return;
        }
        const row = this.newEventRow(event, true, this.mktAssets());
        this.events[event.id] = [event, row];
    }
    handleRunStatsNote(note) {
        const { mkt: { baseID, quoteID, host }, startTime } = this;
        if (note.host !== host ||
            note.baseID !== baseID ||
            note.quoteID !== quoteID)
            return;
        if (!note.stats || note.stats.startTime !== startTime)
            return;
        this.populateStats(note.stats.profitLoss, 0);
    }
    populateStats(pl, endTime) {
        const page = this.page;
        page.startTime.textContent = new Date(this.startTime * 1000).toLocaleString();
        if (endTime === 0) {
            _doc__WEBPACK_IMPORTED_MODULE_3__["default"].hide(page.endTimeRow);
        }
        else {
            page.endTime.textContent = new Date(endTime * 1000).toLocaleString();
        }
        for (const assetID in pl.diffs) {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[parseInt(assetID)];
            let row = this.statsRows[assetID];
            if (!row) {
                row = page.performanceTableRowTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
                tmpl.logo.src = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].logoPath(asset.symbol);
                tmpl.ticker.textContent = asset.symbol.toUpperCase();
                this.statsRows[assetID] = row;
                page.performanceTableBody.appendChild(row);
            }
            const diff = pl.diffs[assetID];
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
            tmpl.diff.textContent = diff.fmt;
            tmpl.usdDiff.textContent = diff.fmtUSD;
            tmpl.fiatRate.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatFiatValue(this.fiatRates[asset.id])} USD`;
        }
        page.profitLoss.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatFiatValue(pl.profit)} USD`;
    }
    mktAssets() {
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.mkt.baseID];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.mkt.quoteID];
        const assets = [baseAsset, quoteAsset];
        const assetIDs = { [baseAsset.id]: true, [quoteAsset.id]: true };
        if (baseAsset.token && !assetIDs[baseAsset.token.parentID]) {
            const baseTokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseAsset.token.parentID];
            assetIDs[baseTokenAsset.id] = true;
            assets.push(baseTokenAsset);
        }
        if (quoteAsset.token && !assetIDs[quoteAsset.token.parentID]) {
            const quoteTokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteAsset.token.parentID];
            assets.push(quoteTokenAsset);
        }
        return assets;
    }
    updateExistingRows(updatedLogs) {
        for (const event of updatedLogs) {
            const cachedEvent = this.events[event.id];
            if (!cachedEvent)
                continue;
            this.setRowContents(cachedEvent[1], event, this.mktAssets());
            cachedEvent[0] = event;
        }
    }
    populateTable(events) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].empty(page.eventsTableBody);
        this.events = {};
        this.doneScrolling = false;
        const assets = this.mktAssets();
        for (const event of events) {
            const row = this.newEventRow(event, false, assets);
            this.events[event.id] = [event, row];
        }
    }
    setRowContents(row, event, assets) {
        var _a;
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
        tmpl.time.textContent = (new Date(event.timestamp * 1000)).toLocaleString();
        tmpl.eventType.textContent = this.eventType(event);
        let id;
        if (event.depositEvent) {
            id = event.depositEvent.transaction.id;
        }
        else if (event.withdrawalEvent) {
            id = event.withdrawalEvent.id;
        }
        else if (event.dexOrderEvent) {
            id = event.dexOrderEvent.id;
        }
        else if (event.cexOrderEvent) {
            id = event.cexOrderEvent.id;
        }
        if (id) {
            tmpl.eventID.textContent = trimStringWithEllipsis(id, 30);
            tmpl.eventID.setAttribute('title', id);
        }
        let usd = 0;
        for (const asset of assets) {
            const be = event.balanceEffects;
            const sum = sumBalanceEffects(asset.id, be);
            const tmplID = `sum${asset.symbol.toUpperCase()}`;
            let el;
            if (tmpl[tmplID]) {
                el = tmpl[tmplID];
            }
            else {
                el = document.createElement('td');
                el.dataset.tmpl = tmplID;
                const parent = tmpl.sumUSD.parentElement;
                if (parent) {
                    parent.insertBefore(el, tmpl.sumUSD);
                }
            }
            el.textContent = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(sum, asset.unitInfo);
            const factor = asset.unitInfo.conventional.conversionFactor;
            usd += (_a = sum / factor * this.fiatRates[asset.id]) !== null && _a !== void 0 ? _a : 0;
        }
        tmpl.sumUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatFourSigFigs(usd);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(tmpl.details, 'click', () => { this.showEventDetails(event.id); });
    }
    newEventRow(event, prepend, assets) {
        const page = this.page;
        const row = page.eventTableRowTmpl.cloneNode(true);
        row.id = event.id.toString();
        this.setRowContents(row, event, assets);
        if (prepend) {
            page.eventsTableBody.insertBefore(row, page.eventsTableBody.firstChild);
        }
        else {
            page.eventsTableBody.appendChild(row);
        }
        return row;
    }
    eventType(event) {
        if (event.depositEvent) {
            return 'Deposit';
        }
        else if (event.withdrawalEvent) {
            return 'Withdrawal';
        }
        else if (event.dexOrderEvent) {
            return event.dexOrderEvent.sell ? 'DEX Sell' : 'DEX Buy';
        }
        else if (event.cexOrderEvent) {
            return event.cexOrderEvent.sell ? 'CEX Sell' : 'CEX Buy';
        }
        return '';
    }
    showDexOrderEventDetails(event) {
        const { page, mkt: { baseID, quoteID } } = this;
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        const [bui, qui] = [baseAsset.unitInfo, quoteAsset.unitInfo];
        const [baseTicker, quoteTicker] = [bui.conventional.unit, qui.conventional.unit];
        if (this.dexOrderIDCopyListener !== undefined) {
            page.copyDexOrderID.removeEventListener('click', this.dexOrderIDCopyListener);
        }
        this.dexOrderIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.id, page.dexOrderID, page.copyDexOrderID, '#1e7d11'); };
        page.copyDexOrderID.addEventListener('click', this.dexOrderIDCopyListener);
        page.dexOrderID.textContent = trimStringWithEllipsis(event.id, 20);
        page.dexOrderID.setAttribute('title', event.id);
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, event.rate);
        page.dexOrderRate.textContent = `${rate} ${baseTicker}/${quoteTicker}`;
        page.dexOrderQty.textContent = `${event.qty / bui.conventional.conversionFactor} ${baseTicker}`;
        if (event.sell) {
            page.dexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_SELL);
        }
        else {
            page.dexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BUY);
        }
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].empty(page.dexOrderTxsTableBody);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].setVis(event.transactions && event.transactions.length > 0, page.dexOrderTxsTable);
        const txAsset = (txType, sell) => {
            switch (txType) {
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeSwap:
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeRefund:
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeSplit:
                    return sell ? baseAsset : quoteAsset;
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeRedeem:
                    return sell ? quoteAsset : baseAsset;
            }
        };
        for (let i = 0; event.transactions && i < event.transactions.length; i++) {
            const tx = event.transactions[i];
            const row = page.dexOrderTxRowTmpl.cloneNode(true);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
            tmpl.id.textContent = trimStringWithEllipsis(tx.id, 20);
            tmpl.id.setAttribute('title', tx.id);
            tmpl.type.textContent = _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeString(tx.type);
            const asset = txAsset(tx.type, event.sell);
            if (!asset) {
                console.error('unexpected tx type in dex order event', tx.type);
                continue;
            }
            const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[asset.id];
            if (assetExplorer && assetExplorer[net]) {
                tmpl.explorerLink.href = assetExplorer[net](tx.id);
            }
            tmpl.amt.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(tx.amount, asset.unitInfo)} ${asset.unitInfo.conventional.unit.toLowerCase()}`;
            tmpl.fees.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(tx.fees, asset.unitInfo)} ${asset.unitInfo.conventional.unit.toLowerCase()}`;
            page.dexOrderTxsTableBody.appendChild(row);
        }
        this.forms.show(page.dexOrderDetailsForm);
    }
    showCexOrderEventDetails(event) {
        const { page, mkt: { baseID, quoteID } } = this;
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        const [bui, qui] = [baseAsset.unitInfo, quoteAsset.unitInfo];
        const [baseTicker, quoteTicker] = [bui.conventional.unit, qui.conventional.unit];
        page.cexOrderID.textContent = trimStringWithEllipsis(event.id, 20);
        if (this.cexOrderIDCopyListener !== undefined) {
            page.copyCexOrderID.removeEventListener('click', this.cexOrderIDCopyListener);
        }
        this.cexOrderIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.id, page.cexOrderID, page.copyCexOrderID, '#1e7d11'); };
        page.copyCexOrderID.addEventListener('click', this.cexOrderIDCopyListener);
        page.cexOrderID.setAttribute('title', event.id);
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, event.rate);
        page.cexOrderRate.textContent = `${rate} ${baseTicker}/${quoteTicker}`;
        page.cexOrderQty.textContent = `${event.qty / bui.conventional.conversionFactor} ${baseTicker}`;
        if (event.sell) {
            page.cexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_SELL);
        }
        else {
            page.cexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BUY);
        }
        page.cexOrderBaseFilled.textContent = `${event.baseFilled / bui.conventional.conversionFactor} ${baseTicker}`;
        page.cexOrderQuoteFilled.textContent = `${event.quoteFilled / qui.conventional.conversionFactor} ${quoteTicker}`;
        this.forms.show(page.cexOrderDetailsForm);
    }
    showDepositEventDetails(event, pending) {
        const page = this.page;
        page.depositID.textContent = trimStringWithEllipsis(event.transaction.id, 20);
        if (this.depositIDCopyListener !== undefined) {
            page.copyDepositID.removeEventListener('click', this.depositIDCopyListener);
        }
        this.depositIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.transaction.id, page.depositID, page.copyDepositID, '#1e7d11'); };
        page.copyDepositID.addEventListener('click', this.depositIDCopyListener);
        page.depositID.setAttribute('title', event.transaction.id);
        const unitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[event.assetID].unitInfo;
        const unit = unitInfo.conventional.unit;
        page.depositAmt.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.transaction.amount, unitInfo)} ${unit}`;
        page.depositFees.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.transaction.fees, unitInfo)} ${unit}`;
        page.depositStatus.textContent = pending ? _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_PENDING) : _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_COMPLETE);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].setVis(!pending, page.depositCreditSection);
        if (!pending) {
            page.depositCredit.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.cexCredit, unitInfo)} ${unit}`;
        }
        this.forms.show(page.depositDetailsForm);
    }
    showWithdrawalEventDetails(event, pending) {
        const page = this.page;
        page.withdrawalID.textContent = trimStringWithEllipsis(event.id, 20);
        if (this.withdrawalIDCopyListener !== undefined) {
            page.copyWithdrawalID.removeEventListener('click', this.withdrawalIDCopyListener);
        }
        this.withdrawalIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.id, page.withdrawalID, page.copyWithdrawalID, '#1e7d11'); };
        page.copyWithdrawalID.addEventListener('click', this.withdrawalIDCopyListener);
        page.withdrawalID.setAttribute('title', event.id);
        const unitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[event.assetID].unitInfo;
        const unit = unitInfo.conventional.unit;
        page.withdrawalAmt.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.cexDebit, unitInfo)} ${unit}`;
        page.withdrawalStatus.textContent = pending ? _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_PENDING) : _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_COMPLETE);
        if (event.transaction) {
            page.withdrawalTxID.textContent = trimStringWithEllipsis(event.transaction.id, 20);
            page.withdrawalTxID.setAttribute('title', event.transaction.id);
            page.withdrawalReceived.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.transaction.amount, unitInfo)} ${unit}`;
        }
        this.forms.show(page.withdrawalDetailsForm);
    }
    showEventDetails(eventID) {
        const [event] = this.events[eventID];
        if (event.dexOrderEvent)
            this.showDexOrderEventDetails(event.dexOrderEvent);
        if (event.cexOrderEvent)
            this.showCexOrderEventDetails(event.cexOrderEvent);
        if (event.depositEvent)
            this.showDepositEventDetails(event.depositEvent, event.pending);
        if (event.withdrawalEvent)
            this.showWithdrawalEventDetails(event.withdrawalEvent, event.pending);
    }
}
function trimStringWithEllipsis(str, maxLen) {
    if (str.length <= maxLen)
        return str;
    return `${str.substring(0, maxLen / 2)}...${str.substring(str.length - maxLen / 2)}`;
}
function sumBalanceEffects(assetID, be) {
    let sum = 0;
    if (be.settled[assetID])
        sum += be.settled[assetID];
    if (be.pending[assetID])
        sum += be.pending[assetID];
    if (be.locked[assetID])
        sum += be.locked[assetID];
    if (be.reserved[assetID])
        sum += be.reserved[assetID];
    return sum;
}


/***/ }),

/***/ "./src/js/mmsettings.ts":
/*!******************************!*\
  !*** ./src/js/mmsettings.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerSettingsPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









const specLK = 'lastMMSpecs';
const lastBotsLK = 'lastBots';
const lastArbExchangeLK = 'lastArbExchange';
const arbMMRowCacheKey = 'arbmm';
const defaultSwapReserves = {
    n: 50,
    prec: 0,
    inc: 10,
    minR: 0,
    maxR: 1000,
    range: 1000
};
const defaultOrderReserves = {
    factor: 1.0,
    minR: 0,
    maxR: 3,
    range: 3,
    prec: 3
};
const defaultTransfer = {
    factor: 0.1,
    minR: 0,
    maxR: 1,
    range: 1
};
const defaultSlippage = {
    factor: 0.05,
    minR: 0,
    maxR: 0.3,
    range: 0.3,
    prec: 3
};
const defaultDriftTolerance = {
    value: 0.002,
    minV: 0,
    maxV: 0.02,
    range: 0.02,
    prec: 5
};
const defaultOrderPersistence = {
    value: 20,
    minV: 0,
    maxV: 40,
    range: 40,
    prec: 0
};
const defaultProfit = {
    prec: 3,
    value: 0.01,
    minV: 0.001,
    maxV: 0.1,
    range: 0.1 - 0.001
};
const defaultLevelSpacing = {
    prec: 3,
    value: 0.005,
    minV: 0.001,
    maxV: 0.02,
    range: 0.02 - 0.0001
};
const defaultMatchBuffer = {
    value: 0,
    prec: 3,
    minV: 0,
    maxV: 1,
    range: 1
};
const defaultLevelsPerSide = {
    prec: 0,
    inc: 1,
    value: 1,
    minV: 1
};
const defaultLotsPerLevel = {
    prec: 0,
    value: 1,
    minV: 1,
    usdIncrement: 100
};
const defaultUSDPerSide = {
    prec: 2
};
const defaultMarketMakingConfig = {
    gapStrategy: _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus,
    sellPlacements: [],
    buyPlacements: [],
    driftTolerance: defaultDriftTolerance.value,
    profit: 0.02,
    orderPersistence: defaultOrderPersistence.value,
    cexRebalance: true,
    simpleArbLots: 1
};
const defaultBotAssetConfig = {
    swapFeeN: defaultSwapReserves.n,
    orderReservesFactor: defaultOrderReserves.factor,
    slippageBufferFactor: defaultSlippage.factor,
    transferFactor: defaultTransfer.factor
};
class MarketMakerSettingsPage extends _basepage__WEBPACK_IMPORTED_MODULE_3__["default"] {
    constructor(main, specs) {
        super();
        this.placementsCache = {};
        this.opts = {};
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].idDescendants(main);
        this.forms = new _forms__WEBPACK_IMPORTED_MODULE_6__.Forms(page.forms, {
            closed: () => {
                var _a, _b;
                if (!((_a = this.specs) === null || _a === void 0 ? void 0 : _a.host) || !((_b = this.specs) === null || _b === void 0 ? void 0 : _b.botType))
                    (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm');
            }
        });
        this.placementsChart = new _mmutil__WEBPACK_IMPORTED_MODULE_5__.PlacementsChart(page.placementsChart);
        this.approveTokenForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.TokenApprovalForm(page.approveTokenForm, () => { this.submitBotType(); });
        this.walletAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.DepositAddress(page.walletAddrForm);
        this.cexConfigForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.CEXConfigurationForm(page.cexConfigForm, (cexName) => this.cexConfigured(cexName));
        page.quotePane = page.basePane.cloneNode(true);
        page.assetPaneBox.appendChild(page.quotePane);
        this.basePane = new AssetPane(this, page.basePane);
        this.quotePane = new AssetPane(this, page.quotePane);
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().headerSpace.appendChild(page.mmTitle);
        (0,_opts__WEBPACK_IMPORTED_MODULE_4__.setOptionTemplates)(page);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].cleanTemplates(page.orderOptTmpl, page.booleanOptTmpl, page.rangeOptTmpl, page.placementRowTmpl, page.oracleTmpl, page.cexOptTmpl, page.arbBttnTmpl, page.marketRowTmpl, page.needRegTmpl);
        page.basePane.removeAttribute('id'); // don't remove from layout
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.resetButton, 'click', () => { this.setOriginalValues(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.updateButton, 'click', () => { this.saveSettings(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.createButton, 'click', () => __awaiter(this, void 0, void 0, function* () { this.saveSettings(); }));
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.deleteBttn, 'click', () => { this.delete(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_6__.bind)(page.botTypeForm, page.botTypeSubmit, () => { this.submitBotType(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.noMarketBttn, 'click', () => { this.showMarketSelectForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.botTypeHeader, 'click', () => { this.reshowBotTypeForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.botTypeChangeMarket, 'click', () => { this.showMarketSelectForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.marketHeader, 'click', () => { this.showMarketSelectForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.marketFilterInput, 'input', () => { this.sortMarketRows(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.cexRebalanceCheckbox, 'change', () => { this.autoRebalanceChanged(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToAdvanced, 'click', () => { this.showAdvancedConfig(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToQuickConfig, 'click', () => { this.switchToQuickConfig(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.qcMatchBuffer, 'change', () => { this.matchBufferChanged(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToUSDPerSide, 'click', () => { this.changeSideCommitmentDialog(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToLotsPerLevel, 'click', () => { this.changeSideCommitmentDialog(); });
        // Gap Strategy
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.gapStrategySelect, 'change', () => {
            if (!page.gapStrategySelect.value)
                return;
            const gapStrategy = page.gapStrategySelect.value;
            this.clearPlacements(this.updatedConfig.gapStrategy);
            this.loadCachedPlacements(gapStrategy);
            this.updatedConfig.gapStrategy = gapStrategy;
            this.setGapFactorLabels(gapStrategy);
            this.updateModifiedMarkers();
        });
        // Buy/Sell placements
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addBuyPlacementBtn, 'click', () => {
            this.addPlacement(true, null);
            page.addBuyPlacementLots.value = '';
            page.addBuyPlacementGapFactor.value = '';
            this.updateModifiedMarkers();
            this.placementsChart.render();
            this.updateAllocations();
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addSellPlacementBtn, 'click', () => {
            this.addPlacement(false, null);
            page.addSellPlacementLots.value = '';
            page.addSellPlacementGapFactor.value = '';
            this.updateModifiedMarkers();
            this.placementsChart.render();
            this.updateAllocations();
        });
        this.driftTolerance = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.driftToleranceInput, {
            prec: defaultDriftTolerance.prec - 2,
            sigFigs: true,
            min: 0,
            changed: (rawV) => {
                const { minV, range, prec } = defaultDriftTolerance;
                const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(rawV / 100, prec);
                this.driftToleranceSlider.setValue((v - minV) / range);
                this.updatedConfig.driftTolerance = v;
            }
        });
        this.driftToleranceSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.driftToleranceSlider, (r) => {
            const { minV, range, prec } = defaultDriftTolerance;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(minV + r * range, prec);
            this.updatedConfig.driftTolerance = v;
            this.driftTolerance.setValue(v * 100);
        });
        this.orderPersistence = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.orderPersistence, {
            changed: (v) => {
                const { minV, range } = defaultOrderPersistence;
                this.updatedConfig.orderPersistence = v;
                this.orderPersistenceSlider.setValue((v - minV) / range);
            }
        });
        this.orderPersistenceSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.orderPersistenceSlider, (r) => {
            const { minV, range, prec } = defaultOrderPersistence;
            const rawV = minV + r * range;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(rawV, prec);
            this.updatedConfig.orderPersistence = v;
            this.orderPersistence.setValue(v);
        });
        this.qcProfit = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.qcProfit, {
            prec: defaultProfit.prec - 2,
            sigFigs: true,
            min: defaultProfit.minV * 100,
            changed: (vPct) => {
                const { minV, range } = defaultProfit;
                const v = vPct / 100;
                this.updatedConfig.profit = v;
                page.profitInput.value = this.qcProfit.input.value;
                this.qcProfitSlider.setValue((v - minV) / range);
                this.quickConfigUpdated();
            }
        });
        this.qcProfitSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.qcProfitSlider, (r) => {
            const { minV, range, prec } = defaultProfit;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)((minV + r * range) * 100, prec);
            this.updatedConfig.profit = v / 100;
            this.qcProfit.setValue(v);
            page.profitInput.value = this.qcProfit.input.value;
            this.quickConfigUpdated();
        });
        this.qcLevelSpacing = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.qcLevelSpacing, {
            prec: defaultLevelSpacing.prec - 2,
            sigFigs: true,
            min: defaultLevelSpacing.minV * 100,
            changed: (vPct) => {
                const { minV, range } = defaultLevelSpacing;
                this.qcLevelSpacingSlider.setValue((vPct / 100 - minV) / range);
                this.quickConfigUpdated();
            }
        });
        this.qcLevelSpacingSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.qcLevelSpacingSlider, (r) => {
            const { minV, range } = defaultLevelSpacing;
            this.qcLevelSpacing.setValue(minV + r * range * 100);
            this.quickConfigUpdated();
        });
        this.qcMatchBuffer = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.qcMatchBuffer, {
            prec: defaultMatchBuffer.prec - 2,
            sigFigs: true,
            min: defaultMatchBuffer.minV * 100,
            changed: (vPct) => {
                const { minV, range } = defaultMatchBuffer;
                this.qcMatchBufferSlider.setValue((vPct / 100 - minV) / range);
                this.quickConfigUpdated();
            }
        });
        this.qcMatchBufferSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.qcMatchBufferSlider, (r) => {
            const { minV, range } = defaultMatchBuffer;
            this.qcMatchBuffer.setValue(minV + r * range * 100);
            this.quickConfigUpdated();
        });
        this.qcLevelsPerSide = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.qcLevelsPerSide, {
            prec: defaultLevelsPerSide.prec,
            min: defaultLevelsPerSide.minV,
            inc: defaultLevelsPerSide.inc,
            changed: (v) => {
                this.qcUSDPerSide.setValue(this.lotSizeUSD() * v * this.qcLotsPerLevel.value());
                this.quickConfigUpdated();
            }
        });
        this.qcLotsPerLevel = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.qcLotsPerLevel, {
            prec: defaultLotsPerLevel.prec,
            min: defaultLotsPerLevel.minV,
            inc: 1,
            changed: (v) => {
                this.qcUSDPerSide.setValue(this.lotSizeUSD() * v * this.qcLevelsPerSide.value());
                page.qcUSDPerSideEcho.textContent = this.qcUSDPerSide.input.value;
                this.quickConfigUpdated();
            },
            set: (v) => {
                const [, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(v * this.qcLevelsPerSide.value() * this.lotSizeUSD(), 2);
                page.qcUSDPerSideEcho.textContent = s;
                page.qcLotsPerLevelEcho.textContent = s;
            }
        });
        this.qcUSDPerSide = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.qcUSDPerSide, {
            prec: defaultUSDPerSide.prec,
            min: 1,
            inc: 1,
            changed: (v) => {
                this.qcLotsPerLevel.setValue(v / this.qcLevelsPerSide.value() / this.lotSizeUSD());
                page.qcLotsPerLevelEcho.textContent = this.qcLotsPerLevel.input.value;
                this.quickConfigUpdated();
            },
            set: (v, s) => {
                page.qcUSDPerSideEcho.textContent = s;
                page.qcLotsPerLevelEcho.textContent = String(Math.round(v / this.lotSizeUSD()));
            }
        });
        const maybeSubmitBuyRow = (e) => {
            if (e.key !== 'Enter')
                return;
            if (!isNaN(parseFloat(page.addBuyPlacementGapFactor.value || '')) &&
                !isNaN(parseFloat(page.addBuyPlacementLots.value || ''))) {
                page.addBuyPlacementBtn.click();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addBuyPlacementGapFactor, 'keyup', (e) => { maybeSubmitBuyRow(e); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addBuyPlacementLots, 'keyup', (e) => { maybeSubmitBuyRow(e); });
        const maybeSubmitSellRow = (e) => {
            if (e.key !== 'Enter')
                return;
            if (!isNaN(parseFloat(page.addSellPlacementGapFactor.value || '')) &&
                !isNaN(parseFloat(page.addSellPlacementLots.value || ''))) {
                page.addSellPlacementBtn.click();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addSellPlacementGapFactor, 'keyup', (e) => { maybeSubmitSellRow(e); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addSellPlacementLots, 'keyup', (e) => { maybeSubmitSellRow(e); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.profitInput, 'change', () => {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.profitInputErr);
            const showError = (errID) => {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.profitInputErr);
                page.profitInputErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(errID);
            };
            const profit = parseFloat(page.profitInput.value || '') / 100;
            if (isNaN(profit))
                return showError(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_INVALID_VALUE);
            if (profit === 0)
                return showError(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_ZERO);
            this.updatedConfig.profit = profit;
            this.updateModifiedMarkers();
        });
        this.botTypeSelectors = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].applySelector(page.botTypeForm, '[data-bot-type]');
        for (const div of this.botTypeSelectors) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(div, 'click', () => {
                if (div.classList.contains('disabled'))
                    return;
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.botTypeErr);
                page.cexSelection.classList.toggle('disabled', div.dataset.botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM);
                this.setBotTypeSelected(div.dataset.botType);
            });
        }
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.NewWalletForm(page.newWalletForm, () => __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchUser();
            this.submitBotType();
        }));
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().registerNoteFeeder({
            balance: (note) => { this.handleBalanceNote(note); }
        });
        this.initialize(specs);
    }
    unload() {
        this.forms.exit();
    }
    initialize(specs) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            this.setupCEXes();
            this.initializeMarketRows();
            const isRefresh = specs && Object.keys(specs).length === 0;
            if (isRefresh)
                specs = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(specLK);
            if (!specs || !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[specs.baseID] || !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[specs.quoteID]) {
                this.showMarketSelectForm();
                return;
            }
            // If we have specs specifying only a market, make sure the cex name and
            // bot type are set.
            if (specs && !specs.botType) {
                const botCfg = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotConfig)(specs.host, specs.baseID, specs.quoteID);
                specs.cexName = (_a = botCfg === null || botCfg === void 0 ? void 0 : botCfg.cexName) !== null && _a !== void 0 ? _a : '';
                specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM;
                if (botCfg === null || botCfg === void 0 ? void 0 : botCfg.arbMarketMakingConfig)
                    specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM;
                else if (botCfg === null || botCfg === void 0 ? void 0 : botCfg.simpleArbConfig)
                    specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb;
            }
            // Must be a reconfig.
            this.specs = specs;
            yield this.fetchCEXBalances(specs);
            this.configureUI();
        });
    }
    configureUI() {
        var _a, _b, _c, _d, _e;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, specs } = this;
            const { host, baseID, quoteID, cexName, botType } = specs;
            const [{ symbol: baseSymbol, token: baseToken }, { symbol: quoteSymbol, token: quoteToken }] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]];
            this.mktID = `${baseSymbol}_${quoteSymbol}`;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.botSettingsContainer, page.marketBox, page.updateButton, page.resetButton, page.createButton, page.noMarket, page.missingFiatRates);
            if ([baseID, quoteID, (_a = baseToken === null || baseToken === void 0 ? void 0 : baseToken.parentID) !== null && _a !== void 0 ? _a : baseID, (_b = quoteToken === null || quoteToken === void 0 ? void 0 : quoteToken.parentID) !== null && _b !== void 0 ? _b : quoteID].some((assetID) => !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[assetID])) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.missingFiatRates);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.marketLoading);
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(specLK, specs);
            const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus;
            const viewOnly = isViewOnly(specs, mmStatus);
            let botCfg = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotConfig)(host, baseID, quoteID);
            if (botCfg) {
                const oldBotType = botCfg.arbMarketMakingConfig ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM : botCfg.basicMarketMakingConfig ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM : _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb;
                if (oldBotType !== botType)
                    botCfg = undefined;
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botCfg, page.deleteBttnBox);
            const oldCfg = this.originalConfig = Object.assign({}, defaultMarketMakingConfig, {
                disabled: viewOnly,
                baseOptions: this.defaultWalletOptions(baseID),
                quoteOptions: this.defaultWalletOptions(quoteID),
                buyPlacements: [],
                sellPlacements: [],
                baseConfig: Object.assign({}, defaultBotAssetConfig),
                quoteConfig: Object.assign({}, defaultBotAssetConfig)
            });
            if (botCfg) {
                const { basicMarketMakingConfig: mmCfg, arbMarketMakingConfig: arbMMCfg, simpleArbConfig: arbCfg, uiConfig: { cexRebalance } } = botCfg;
                this.creatingNewBot = false;
                // This is kinda sloppy, but we'll copy any relevant issues from the
                // old config into the originalConfig.
                const idx = oldCfg; // typescript
                for (const [k, v] of Object.entries(botCfg))
                    if (idx[k] !== undefined)
                        idx[k] = v;
                oldCfg.baseConfig = Object.assign({}, defaultBotAssetConfig, botCfg.uiConfig.baseConfig);
                oldCfg.quoteConfig = Object.assign({}, defaultBotAssetConfig, botCfg.uiConfig.quoteConfig);
                oldCfg.baseOptions = botCfg.baseWalletOptions || {};
                oldCfg.quoteOptions = botCfg.quoteWalletOptions || {};
                oldCfg.cexRebalance = cexRebalance;
                if (mmCfg) {
                    oldCfg.buyPlacements = mmCfg.buyPlacements;
                    oldCfg.sellPlacements = mmCfg.sellPlacements;
                    oldCfg.driftTolerance = mmCfg.driftTolerance;
                    oldCfg.gapStrategy = mmCfg.gapStrategy;
                }
                else if (arbMMCfg) {
                    const { buyPlacements, sellPlacements } = arbMMCfg;
                    oldCfg.buyPlacements = Array.from(buyPlacements, (p) => { return { lots: p.lots, gapFactor: p.multiplier }; });
                    oldCfg.sellPlacements = Array.from(sellPlacements, (p) => { return { lots: p.lots, gapFactor: p.multiplier }; });
                    oldCfg.profit = arbMMCfg.profit;
                    oldCfg.driftTolerance = arbMMCfg.driftTolerance;
                    oldCfg.orderPersistence = arbMMCfg.orderPersistence;
                }
                else if (arbCfg) {
                    // TODO: expose maxActiveArbs
                    oldCfg.profit = arbCfg.profitTrigger;
                    oldCfg.orderPersistence = arbCfg.numEpochsLeaveOpen;
                    oldCfg.simpleArbLots = (_c = botCfg.uiConfig.simpleArbLots) !== null && _c !== void 0 ? _c : 1;
                }
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!viewOnly, page.updateButton, page.resetButton);
            }
            else {
                this.creatingNewBot = true;
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!viewOnly, page.createButton);
            }
            // Now that we've updated the originalConfig, we'll copy it.
            this.updatedConfig = JSON.parse(JSON.stringify(oldCfg));
            switch (botType) {
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM:
                    page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_BOTTYPE_BASIC_MM);
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM:
                    page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_BOTTYPE_ARB_MM);
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb:
                    page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_BOTTYPE_SIMPLE_ARB);
            }
            (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setMarketElements)(document.body, baseID, quoteID, host);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb, page.driftToleranceBox, page.switchToAdvanced);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(Boolean(cexName), ..._doc__WEBPACK_IMPORTED_MODULE_1__["default"].applySelector(document.body, '[data-cex-show]'));
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(viewOnly, page.viewOnlyRunning);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(cexName, page.cexRebalanceSettings);
            if (cexName)
                (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setCexElements)(document.body, cexName);
            yield this.fetchMarketReport();
            const lotSizeUSD = this.lotSizeUSD();
            this.lotsPerLevelIncrement = Math.round(Math.max(1, defaultLotsPerLevel.usdIncrement / lotSizeUSD));
            this.qcLotsPerLevel.inc = this.lotsPerLevelIncrement;
            this.qcUSDPerSide.inc = this.lotsPerLevelIncrement * lotSizeUSD;
            this.qcUSDPerSide.min = lotSizeUSD;
            this.basePane.setAsset(baseID, false);
            this.quotePane.setAsset(quoteID, true);
            const { marketReport: { baseFiatRate } } = this;
            this.placementsChart.setMarket({ cexName: cexName, botType, baseFiatRate, dict: this.updatedConfig });
            // If this is a new bot, show the quick config form.
            const isQuickPlacements = !botCfg || this.isQuickPlacements(this.updatedConfig.buyPlacements, this.updatedConfig.sellPlacements);
            const gapStrategy = (_e = (_d = botCfg === null || botCfg === void 0 ? void 0 : botCfg.basicMarketMakingConfig) === null || _d === void 0 ? void 0 : _d.gapStrategy) !== null && _e !== void 0 ? _e : _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus;
            page.gapStrategySelect.value = gapStrategy;
            if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb || (isQuickPlacements && gapStrategy === _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus))
                this.showQuickConfig();
            else
                this.showAdvancedConfig();
            this.setOriginalValues();
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.marketLoading);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botSettingsContainer, page.marketBox);
        });
    }
    initializeMarketRows() {
        this.marketRows = [];
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(this.page.marketSelect);
        for (const { host, markets, assets, auth: { effectiveTier, pendingStrength } } of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges)) {
            if (effectiveTier + pendingStrength === 0) {
                const { needRegTmpl, needRegBox } = this.page;
                const bttn = needRegTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(bttn);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(bttn, 'click', () => { (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('register', { host, backTo: 'mmsettings' }); });
                tmpl.host.textContent = host;
                needRegBox.appendChild(bttn);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(needRegBox);
                continue;
            }
            for (const { name, baseid: baseID, quoteid: quoteID, spot, basesymbol: baseSymbol, quotesymbol: quoteSymbol } of Object.values(markets)) {
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID] || !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID])
                    continue;
                const tr = this.page.marketRowTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tr);
                const mr = { tr, tmpl, host: host, name, baseID, quoteID, spot: spot, arbs: [] };
                this.marketRows.push(mr);
                this.page.marketSelect.appendChild(tr);
                tmpl.baseIcon.src = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(baseSymbol);
                tmpl.quoteIcon.src = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(quoteSymbol);
                tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(assets[baseID], true));
                tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(assets[quoteID], true));
                tmpl.host.textContent = host;
                const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
                for (const [cexName, dinfo] of Object.entries(_mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos)) {
                    if (cexHasMarket(cexName)) {
                        const img = this.page.arbBttnTmpl.cloneNode(true);
                        img.src = dinfo.logo;
                        tmpl.arbs.appendChild(img);
                        mr.arbs.push(cexName);
                    }
                }
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(tr, 'click', () => { this.showBotTypeForm(host, baseID, quoteID); });
            }
        }
        if (this.marketRows.length === 0) {
            const { marketSelectionTable, marketFilterBox, noMarkets } = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(marketSelectionTable, marketFilterBox);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(noMarkets);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(this.page.noMarkets);
        const fiatRates = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap;
        this.marketRows.sort((a, b) => {
            var _a, _b, _c, _d;
            let [volA, volB] = [(_b = (_a = a.spot) === null || _a === void 0 ? void 0 : _a.vol24) !== null && _b !== void 0 ? _b : 0, (_d = (_c = b.spot) === null || _c === void 0 ? void 0 : _c.vol24) !== null && _d !== void 0 ? _d : 0];
            if (fiatRates[a.baseID] && fiatRates[b.baseID]) {
                volA *= fiatRates[a.baseID];
                volB *= fiatRates[b.baseID];
            }
            return volB - volA;
        });
    }
    runningBotInventory(assetID) {
        return (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.runningBotInventory)(assetID);
    }
    adjustedBalances(baseWallet, quoteWallet) {
        const { cexBaseBalance, cexQuoteBalance } = this;
        const [bInv, qInv] = [this.runningBotInventory(baseWallet.assetID), this.runningBotInventory(quoteWallet.assetID)];
        const [cexBaseAvail, cexQuoteAvail] = [((cexBaseBalance === null || cexBaseBalance === void 0 ? void 0 : cexBaseBalance.available) || 0) - bInv.cex.total, ((cexQuoteBalance === null || cexQuoteBalance === void 0 ? void 0 : cexQuoteBalance.available) || 0) - qInv.cex.total];
        const [dexBaseAvail, dexQuoteAvail] = [baseWallet.balance.available - bInv.dex.total, quoteWallet.balance.available - qInv.dex.total];
        const baseAvail = dexBaseAvail + cexBaseAvail;
        const quoteAvail = dexQuoteAvail + cexQuoteAvail;
        return { baseAvail, quoteAvail, dexBaseAvail, dexQuoteAvail, cexBaseAvail, cexQuoteAvail };
    }
    lotSizeUSD() {
        const { specs: { host, baseID }, mktID, marketReport: { baseFiatRate } } = this;
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host];
        const market = xc.markets[mktID];
        const { lotsize: lotSize } = market;
        const { unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        return lotSize / ui.conventional.conversionFactor * baseFiatRate;
    }
    /*
      * marketStuff is just a bunch of useful properties for the current specs
      * gathered in one place and with preferable names.
      */
    marketStuff() {
        const { page, specs: { host, baseID, quoteID, cexName, botType }, basePane, quotePane, marketReport: { baseFiatRate, quoteFiatRate, baseFees, quoteFees }, lotsPerLevelIncrement, updatedConfig: cfg, originalConfig: oldCfg, mktID } = this;
        const { symbol: baseSymbol, unitInfo: bui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        const { symbol: quoteSymbol, unitInfo: qui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host];
        const market = xc.markets[mktID];
        const { lotsize: lotSize, spot } = market;
        const lotSizeUSD = lotSize / bui.conventional.conversionFactor * baseFiatRate;
        const atomicRate = 1 / bui.conventional.conversionFactor * baseFiatRate / quoteFiatRate * qui.conventional.conversionFactor;
        const xcRate = {
            conv: quoteFiatRate / baseFiatRate,
            atomic: atomicRate,
            msg: Math.round(atomicRate * _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor),
            spot
        };
        let [dexBaseLots, dexQuoteLots] = [cfg.simpleArbLots, cfg.simpleArbLots];
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            dexBaseLots = this.updatedConfig.sellPlacements.reduce((lots, p) => lots + p.lots, 0);
            dexQuoteLots = this.updatedConfig.buyPlacements.reduce((lots, p) => lots + p.lots, 0);
        }
        const quoteLot = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.calculateQuoteLot)(lotSize, baseID, quoteID, spot);
        const walletStuff = this.walletStuff();
        const { baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker } = walletStuff;
        const { commit, fees } = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.feesAndCommit)(baseID, quoteID, baseFees, quoteFees, lotSize, dexBaseLots, dexQuoteLots, baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker, cfg.baseConfig.orderReservesFactor, cfg.quoteConfig.orderReservesFactor);
        return Object.assign({ page, cfg, oldCfg, host, xc, baseID, quoteID, botType, cexName, baseFiatRate, quoteFiatRate,
            xcRate, baseSymbol, quoteSymbol, mktID, lotSize, lotSizeUSD, lotsPerLevelIncrement,
            quoteLot, commit, basePane, quotePane, fees }, walletStuff);
    }
    walletStuff() {
        const { specs: { baseID, quoteID } } = this;
        const [baseWallet, quoteWallet] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteID]];
        const [{ token: baseToken, unitInfo: bui }, { token: quoteToken, unitInfo: qui }] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]];
        const baseFeeAssetID = baseToken ? baseToken.parentID : baseID;
        const quoteFeeAssetID = quoteToken ? quoteToken.parentID : quoteID;
        const [baseFeeUI, quoteFeeUI] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseFeeAssetID].unitInfo, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteFeeAssetID].unitInfo];
        const traitAccountLocker = 1 << 14;
        const baseIsAccountLocker = (baseWallet.traits & traitAccountLocker) > 0;
        const quoteIsAccountLocker = (quoteWallet.traits & traitAccountLocker) > 0;
        return Object.assign({ baseWallet, quoteWallet, baseFeeUI, quoteFeeUI, baseToken, quoteToken,
            bui, qui, baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker }, this.adjustedBalances(baseWallet, quoteWallet));
    }
    showAdvancedConfig() {
        const { page } = this;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.advancedConfig);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.quickConfig);
        this.placementsChart.render();
    }
    isQuickPlacements(buyPlacements, sellPlacements) {
        if (buyPlacements.length === 0 || buyPlacements.length !== sellPlacements.length)
            return false;
        for (let i = 0; i < buyPlacements.length; i++) {
            if (buyPlacements[i].gapFactor !== sellPlacements[i].gapFactor)
                return false;
            if (buyPlacements[i].lots !== sellPlacements[i].lots)
                return false;
        }
        return true;
    }
    switchToQuickConfig() {
        const { cfg, botType, lotSizeUSD } = this.marketStuff();
        const { buyPlacements: buys, sellPlacements: sells } = cfg;
        // If we have both buys and sells, get the best approximation quick config
        // approximation.
        if (buys.length > 0 && sells.length > 0) {
            const bestBuy = buys.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
            const bestSell = sells.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
            const placementCount = buys.length + sells.length;
            const levelsPerSide = Math.max(1, Math.floor((placementCount) / 2));
            if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
                cfg.profit = (bestBuy.gapFactor + bestSell.gapFactor) / 2;
                const worstBuy = buys.reduce((prev, curr) => curr.gapFactor > prev.gapFactor ? curr : prev);
                const worstSell = sells.reduce((prev, curr) => curr.gapFactor > prev.gapFactor ? curr : prev);
                const range = ((worstBuy.gapFactor - bestBuy.gapFactor) + (worstSell.gapFactor - bestSell.gapFactor)) / 2;
                const inc = range / (levelsPerSide - 1);
                this.qcProfit.setValue(cfg.profit * 100);
                this.qcProfitSlider.setValue((cfg.profit - defaultProfit.minV) / defaultProfit.range);
                this.qcLevelSpacing.setValue(inc * 100);
                this.qcLevelSpacingSlider.setValue((inc - defaultLevelSpacing.minV) / defaultLevelSpacing.range);
            }
            else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM) {
                const multSum = buys.reduce((v, p) => v + p.gapFactor, 0) + sells.reduce((v, p) => v + p.gapFactor, 0);
                const buffer = ((multSum / placementCount) - 1) || defaultMatchBuffer.value;
                this.qcMatchBuffer.setValue(buffer * 100);
                this.qcMatchBufferSlider.setValue((buffer - defaultMatchBuffer.minV) / defaultMatchBuffer.range);
            }
            const lots = buys.reduce((v, p) => v + p.lots, 0) + sells.reduce((v, p) => v + p.lots, 0);
            const lotsPerLevel = Math.max(1, Math.round(lots / 2 / levelsPerSide));
            this.qcLotsPerLevel.setValue(lotsPerLevel);
            this.qcUSDPerSide.setValue(lotsPerLevel * levelsPerSide * lotSizeUSD);
            this.qcLevelsPerSide.setValue(levelsPerSide);
        }
        else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            this.qcLotsPerLevel.setValue(cfg.simpleArbLots);
        }
        this.showQuickConfig();
        this.quickConfigUpdated();
    }
    showQuickConfig() {
        const { page, lotSizeUSD, botType, lotsPerLevelIncrement } = this.marketStuff();
        if (!this.qcLevelsPerSide.input.value) {
            this.qcLevelsPerSide.setValue(defaultLevelsPerSide.value);
            this.qcUSDPerSide.setValue(defaultLevelsPerSide.value * (this.qcLotsPerLevel.value() || lotsPerLevelIncrement) * lotSizeUSD);
        }
        if (!this.qcLotsPerLevel.input.value) {
            this.qcLotsPerLevel.setValue(lotsPerLevelIncrement);
            this.qcUSDPerSide.setValue(lotSizeUSD * lotsPerLevelIncrement * this.qcLevelsPerSide.value());
        }
        if (!page.qcLevelSpacing.value) {
            this.qcLevelSpacing.setValue(defaultLevelSpacing.value * 100);
            this.qcLevelSpacingSlider.setValue((defaultLevelSpacing.value - defaultLevelSpacing.minV) / defaultLevelSpacing.range);
        }
        if (!page.qcMatchBuffer.value)
            page.qcMatchBuffer.value = String(defaultMatchBuffer.value * 100);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.advancedConfig);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.quickConfig);
        this.showInputsForBot(botType);
    }
    showInputsForBot(botType) {
        const { page, opts: { usingUSDPerSide } } = this;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.matchMultiplierBox, page.placementsChartBox, page.placementChartLegend, page.lotsPerLevelLabel, page.levelSpacingBox, page.arbLotsLabel, page.qcLevelPerSideBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(usingUSDPerSide, page.qcUSDPerSideBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!usingUSDPerSide, page.qcLotsBox);
        switch (botType) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM:
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.qcLevelPerSideBox, page.matchMultiplierBox, page.placementsChartBox, page.placementChartLegend, page.lotsPerLevelLabel);
                break;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM:
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.qcLevelPerSideBox, page.levelSpacingBox, page.placementsChartBox, page.lotsPerLevelLabel);
                break;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb:
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.arbLotsLabel);
        }
    }
    quickConfigUpdated() {
        var _a, _b, _c;
        const { page, cfg, botType, cexName } = this.marketStuff();
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.qcError);
        const setError = (msg) => {
            page.qcError.textContent = msg;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.qcError);
        };
        const levelsPerSide = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb ? 1 : this.qcLevelsPerSide.value();
        if (isNaN(levelsPerSide)) {
            setError('invalid value for levels per side');
        }
        const lotsPerLevel = this.qcLotsPerLevel.value();
        if (isNaN(lotsPerLevel)) {
            setError('invalid value for lots per level');
        }
        const profit = parseFloat((_a = page.qcProfit.value) !== null && _a !== void 0 ? _a : '') / 100;
        if (isNaN(profit)) {
            setError('invalid value for profit');
        }
        const levelSpacing = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM ? parseFloat((_b = page.qcLevelSpacing.value) !== null && _b !== void 0 ? _b : '') / 100 : 0;
        if (isNaN(levelSpacing)) {
            setError('invalid value for level spacing');
        }
        const matchBuffer = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM ? parseFloat((_c = page.qcMatchBuffer.value) !== null && _c !== void 0 ? _c : '') / 100 : 0;
        if (isNaN(matchBuffer)) {
            setError('invalid value for match buffer');
        }
        const multiplier = matchBuffer + 1;
        const levelSpacingDisabled = levelsPerSide === 1;
        page.levelSpacingBox.classList.toggle('disabled', levelSpacingDisabled);
        page.qcLevelSpacing.disabled = levelSpacingDisabled;
        cfg.simpleArbLots = lotsPerLevel;
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            this.clearPlacements(cexName ? arbMMRowCacheKey : cfg.gapStrategy);
            for (let levelN = 0; levelN < levelsPerSide; levelN++) {
                const placement = { lots: lotsPerLevel };
                placement.gapFactor = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM ? profit + levelSpacing * levelN : multiplier;
                cfg.buyPlacements.push(placement);
                cfg.sellPlacements.push(placement);
                // Add rows in the advanced config table.
                this.addPlacement(true, placement);
                this.addPlacement(false, placement);
            }
            this.placementsChart.render();
        }
        this.updateAllocations();
    }
    updateAllocations() {
        this.updateBaseAllocations();
        this.updateQuoteAllocations();
    }
    updateBaseAllocations() {
        const { commit, lotSize, basePane, fees } = this.marketStuff();
        basePane.updateInventory(commit.dex.base.lots, commit.dex.quote.lots, lotSize, commit.dex.base.val, commit.cex.base.val, fees.base);
        basePane.updateCommitTotal();
    }
    updateQuoteAllocations() {
        const { commit, quoteLot: lotSize, quotePane, fees } = this.marketStuff();
        quotePane.updateInventory(commit.dex.quote.lots, commit.dex.base.lots, lotSize, commit.dex.quote.val, commit.cex.quote.val, fees.quote);
        quotePane.updateCommitTotal();
    }
    matchBufferChanged() {
        var _a;
        const { page } = this;
        page.qcMatchBuffer.value = Math.max(0, parseFloat((_a = page.qcMatchBuffer.value) !== null && _a !== void 0 ? _a : '') || defaultMatchBuffer.value * 100).toFixed(2);
        this.quickConfigUpdated();
    }
    showAddress(assetID) {
        this.walletAddrForm.setAsset(assetID);
        this.forms.show(this.page.walletAddrForm);
    }
    changeSideCommitmentDialog() {
        const { page, opts } = this;
        opts.usingUSDPerSide = !opts.usingUSDPerSide;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(opts.usingUSDPerSide, page.qcUSDPerSideBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!opts.usingUSDPerSide, page.qcLotsBox);
    }
    showBotTypeForm(host, baseID, quoteID, botType, configuredCEX) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page } = this;
            this.formSpecs = { host, baseID, quoteID, botType: '' };
            const viewOnly = isViewOnly(this.formSpecs, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus);
            if (viewOnly) {
                const botCfg = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotConfig)(host, baseID, quoteID);
                const specs = this.specs = this.formSpecs;
                switch (true) {
                    case Boolean(botCfg === null || botCfg === void 0 ? void 0 : botCfg.simpleArbConfig):
                        specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb;
                        break;
                    case Boolean(botCfg === null || botCfg === void 0 ? void 0 : botCfg.arbMarketMakingConfig):
                        specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM;
                        break;
                    default:
                        specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM;
                }
                specs.cexName = botCfg === null || botCfg === void 0 ? void 0 : botCfg.cexName;
                yield this.fetchCEXBalances(this.formSpecs);
                yield this.configureUI();
                this.forms.close();
                return;
            }
            (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setMarketElements)(page.botTypeForm, baseID, quoteID, host);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.botTypeBaseSymbol, page.botTypeQuoteSymbol);
            const [b, q] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]];
            page.botTypeBaseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(b, true));
            page.botTypeQuoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(q, true));
            for (const div of this.botTypeSelectors)
                div.classList.remove('selected');
            for (const { div } of Object.values(this.formCexes))
                div.classList.remove('selected');
            this.setCEXAvailability(baseID, quoteID);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.noCexesConfigured, page.noCexMarket, page.noCexMarketConfigureMore, page.botTypeErr);
            const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
            const supportingCexes = {};
            for (const cex of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes)) {
                if (cexHasMarket(cex.config.name))
                    supportingCexes[cex.config.name] = cex.config;
            }
            const nCexes = Object.keys(supportingCexes).length;
            const arbEnabled = nCexes > 0;
            for (const div of this.botTypeSelectors)
                div.classList.toggle('disabled', div.dataset.botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM && !arbEnabled);
            if (Object.keys((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes).length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noCexesConfigured);
                this.setBotTypeSelected(_mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM);
            }
            else {
                const lastBots = (_state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastBotsLK) || {});
                const lastBot = lastBots[`${baseID}_${quoteID}_${host}`];
                let cex;
                botType = botType !== null && botType !== void 0 ? botType : (lastBot ? lastBot.botType : _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM);
                if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
                    // Four ways to auto-select a cex.
                    // 1. Coming back from the cex configuration form.
                    if (configuredCEX)
                        cex = supportingCexes[configuredCEX];
                    // 2. We have a saved configuration.
                    if (!cex && lastBot)
                        cex = supportingCexes[(_a = lastBot.cexName) !== null && _a !== void 0 ? _a : ''];
                    // 3. The last exchange that the user selected.
                    if (!cex) {
                        const lastCEX = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastArbExchangeLK);
                        if (lastCEX)
                            cex = supportingCexes[lastCEX];
                    }
                    // 4. Any supporting cex.
                    if (!cex && nCexes > 0)
                        cex = Object.values(supportingCexes)[0];
                }
                if (cex) {
                    page.cexSelection.classList.remove('disabled');
                    this.setBotTypeSelected(botType !== null && botType !== void 0 ? botType : (lastBot ? lastBot.botType : _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM));
                    this.selectFormCEX(cex.name);
                }
                else {
                    page.cexSelection.classList.add('disabled');
                    _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noCexMarket);
                    this.setBotTypeSelected(_mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM);
                    // If there are unconfigured cexes, show configureMore message.
                    const unconfigured = Object.keys(_mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos).filter((cexName) => !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName]);
                    const allConfigured = unconfigured.length === 0 || (unconfigured.length === 1 && (unconfigured[0] === 'Binance' || unconfigured[0] === 'BinanceUS'));
                    if (!allConfigured)
                        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noCexMarketConfigureMore);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.cexSelection);
            // Check if we have any cexes configured.
            this.forms.show(page.botTypeForm);
        });
    }
    reshowBotTypeForm() {
        if (isViewOnly(this.specs, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus))
            this.showMarketSelectForm();
        const { baseID, quoteID, host, cexName, botType } = this.specs;
        this.showBotTypeForm(host, baseID, quoteID, botType, cexName);
    }
    setBotTypeSelected(selectedType) {
        var _a;
        const { formSpecs: { baseID, quoteID, host }, botTypeSelectors, formCexes } = this;
        for (const { classList, dataset: { botType } } of botTypeSelectors)
            classList.toggle('selected', botType === selectedType);
        // If we don't have a cex selected, attempt to select one
        if (selectedType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM)
            return;
        const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus;
        if (Object.keys(mmStatus.cexes).length === 0)
            return;
        const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
        // If there is one currently selected and it supports this market, leave it.
        const selecteds = Object.values(formCexes).filter((cex) => cex.div.classList.contains('selected'));
        if (selecteds.length && cexHasMarket(selecteds[0].name))
            return;
        // See if we have a saved configuration.
        const lastBots = (_state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastBotsLK) || {});
        const lastBot = lastBots[`${baseID}_${quoteID}_${host}`];
        if (lastBot) {
            const cex = mmStatus.cexes[(_a = lastBot.cexName) !== null && _a !== void 0 ? _a : ''];
            if (cex && cexHasMarket(cex.config.name)) {
                this.selectFormCEX(cex.config.name);
                return;
            }
        }
        // 2. The last exchange that the user selected.
        const lastCEX = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastArbExchangeLK);
        if (lastCEX) {
            const cex = mmStatus.cexes[lastCEX];
            if (cex && cexHasMarket(cex.config.name)) {
                this.selectFormCEX(cex.config.name);
                return;
            }
        }
        // 3. Any supporting cex.
        const cexes = Object.values(mmStatus.cexes).filter((cex) => cexHasMarket(cex.config.name));
        if (cexes.length)
            this.selectFormCEX(cexes[0].config.name);
    }
    showMarketSelectForm() {
        this.page.marketFilterInput.value = '';
        this.sortMarketRows();
        this.forms.show(this.page.marketSelectForm);
    }
    sortMarketRows() {
        var _a;
        const page = this.page;
        const filter = (_a = page.marketFilterInput.value) === null || _a === void 0 ? void 0 : _a.toLowerCase();
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.marketSelect);
        for (const mr of this.marketRows) {
            mr.tr.classList.remove('selected');
            if (filter && !mr.name.includes(filter))
                continue;
            page.marketSelect.appendChild(mr.tr);
        }
    }
    handleBalanceNote(n) {
        this.approveTokenForm.handleBalanceNote(n);
        if (!this.marketReport)
            return;
        const { baseID, quoteID, quoteToken, baseToken } = this.marketStuff();
        if (n.assetID === baseID || n.assetID === (baseToken === null || baseToken === void 0 ? void 0 : baseToken.parentID)) {
            this.basePane.updateBalances();
        }
        else if (n.assetID === quoteID || n.assetID === (quoteToken === null || quoteToken === void 0 ? void 0 : quoteToken.parentID)) {
            this.quotePane.updateBalances();
        }
    }
    autoRebalanceChanged() {
        var _a, _b;
        const { page, updatedConfig: cfg } = this;
        cfg.cexRebalance = (_b = (_a = page.cexRebalanceCheckbox) === null || _a === void 0 ? void 0 : _a.checked) !== null && _b !== void 0 ? _b : false;
        this.updateAllocations();
    }
    submitBotType() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loading(this.page.botTypeForm);
            try {
                yield this.submitBotWithValidation();
            }
            finally {
                loaded();
            }
        });
    }
    submitBotWithValidation() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            // check for wallets
            const { page, forms, formSpecs: { baseID, quoteID, host } } = this;
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseID]) {
                this.newWalletForm.setAsset(baseID);
                forms.show(this.page.newWalletForm);
                return;
            }
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteID]) {
                this.newWalletForm.setAsset(quoteID);
                forms.show(this.page.newWalletForm);
                return;
            }
            // Are tokens approved?
            const [bApproval, qApproval] = tokenAssetApprovalStatuses(host, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]);
            if (bApproval === _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.NotApproved) {
                this.approveTokenForm.setAsset(baseID, host);
                forms.show(page.approveTokenForm);
                return;
            }
            if (qApproval === _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.NotApproved) {
                this.approveTokenForm.setAsset(quoteID, host);
                forms.show(page.approveTokenForm);
                return;
            }
            const { botTypeSelectors } = this;
            const selecteds = botTypeSelectors.filter((div) => div.classList.contains('selected'));
            if (selecteds.length < 1) {
                page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_BOTTYPE);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                return;
            }
            const botType = this.formSpecs.botType = (_a = selecteds[0].dataset.botType) !== null && _a !== void 0 ? _a : '';
            if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
                const selecteds = Object.values(this.formCexes).filter((cex) => cex.div.classList.contains('selected'));
                if (selecteds.length < 1) {
                    page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_CEX);
                    _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                    return;
                }
                const cexName = selecteds[0].name;
                this.formSpecs.cexName = cexName;
                yield this.fetchCEXBalances(this.formSpecs);
            }
            this.specs = this.formSpecs;
            this.configureUI();
            this.forms.close();
        });
    }
    fetchCEXBalances(specs) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page } = this;
            const { baseID, quoteID, cexName, botType } = specs;
            if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM || !cexName)
                return;
            try {
                // This won't work if we implement live reconfiguration, because locked
                // funds would need to be considered.
                this.cexBaseBalance = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.cexBalance(cexName, baseID);
            }
            catch (e) {
                page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_CEXBALANCE_ERR, { cexName, assetID: String(baseID), err: String(e) });
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                throw e;
            }
            try {
                this.cexQuoteBalance = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.cexBalance(cexName, quoteID);
            }
            catch (e) {
                page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_CEXBALANCE_ERR, { cexName, assetID: String(quoteID), err: String(e) });
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                throw e;
            }
        });
    }
    defaultWalletOptions(assetID) {
        const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().currentWalletDefinition(assetID);
        if (!walletDef.multifundingopts) {
            return {};
        }
        const options = {};
        for (const opt of walletDef.multifundingopts) {
            if (opt.quoteAssetOnly && assetID !== this.specs.quoteID) {
                continue;
            }
            options[opt.key] = `${opt.default}`;
        }
        return options;
    }
    /*
     * updateModifiedMarkers checks each of the input elements on the page and
     * if the current value does not match the original value (since the last
     * save), then the input will have a colored border.
     */
    updateModifiedMarkers() {
        if (this.creatingNewBot)
            return;
        const { page, originalConfig: oldCfg, updatedConfig: newCfg } = this;
        // Gap strategy input
        const gapStrategyModified = oldCfg.gapStrategy !== newCfg.gapStrategy;
        page.gapStrategySelect.classList.toggle('modified', gapStrategyModified);
        const profitModified = oldCfg.profit !== newCfg.profit;
        page.profitInput.classList.toggle('modified', profitModified);
        // Buy placements Input
        let buyPlacementsModified = false;
        if (oldCfg.buyPlacements.length !== newCfg.buyPlacements.length) {
            buyPlacementsModified = true;
        }
        else {
            for (let i = 0; i < oldCfg.buyPlacements.length; i++) {
                if (oldCfg.buyPlacements[i].lots !== newCfg.buyPlacements[i].lots ||
                    oldCfg.buyPlacements[i].gapFactor !== newCfg.buyPlacements[i].gapFactor) {
                    buyPlacementsModified = true;
                    break;
                }
            }
        }
        page.buyPlacementsTableWrapper.classList.toggle('modified', buyPlacementsModified);
        // Sell placements input
        let sellPlacementsModified = false;
        if (oldCfg.sellPlacements.length !== newCfg.sellPlacements.length) {
            sellPlacementsModified = true;
        }
        else {
            for (let i = 0; i < oldCfg.sellPlacements.length; i++) {
                if (oldCfg.sellPlacements[i].lots !== newCfg.sellPlacements[i].lots ||
                    oldCfg.sellPlacements[i].gapFactor !== newCfg.sellPlacements[i].gapFactor) {
                    sellPlacementsModified = true;
                    break;
                }
            }
        }
        page.sellPlacementsTableWrapper.classList.toggle('modified', sellPlacementsModified);
    }
    /*
     * gapFactorHeaderUnit returns the header on the placements table and the
     * units in the gap factor rows needed for each gap strategy.
     */
    gapFactorHeaderUnit(gapStrategy) {
        switch (gapStrategy) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier:
                return ['Multiplier', 'x'];
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolute:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolutePlus: {
                const rateUnit = `${(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.specs.quoteID].symbol}/${(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.specs.baseID].symbol}`;
                return ['Rate', rateUnit];
            }
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercent:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus:
                return ['Percent', '%'];
            default:
                throw new Error(`Unknown gap strategy ${gapStrategy}`);
        }
    }
    /*
     * checkGapFactorRange returns an error string if the value input for a
     * gap factor is valid for the currently selected gap strategy.
     */
    checkGapFactorRange(gapFactor, value) {
        switch (gapFactor) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier:
                if (value < 1 || value > 100) {
                    return 'Multiplier must be between 1 and 100';
                }
                return null;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolute:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolutePlus:
                if (value <= 0) {
                    return 'Rate must be greater than 0';
                }
                return null;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercent:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus:
                if (value <= 0 || value > 10) {
                    return 'Percent must be between 0 and 10';
                }
                return null;
            default: {
                throw new Error(`Unknown gap factor ${gapFactor}`);
            }
        }
    }
    /*
     * convertGapFactor converts between the displayed gap factor in the
     * placement tables and the number that is passed to the market maker.
     * For gap strategies that involve a percentage it converts between the
     * decimal value required by the backend and a percentage displayed to
     * the user.
     */
    convertGapFactor(gapFactor, gapStrategy, toDisplay) {
        switch (gapStrategy) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolute:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolutePlus:
                return gapFactor;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercent:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus:
                if (toDisplay) {
                    return gapFactor * 100;
                }
                return gapFactor / 100;
            default:
                throw new Error(`Unknown gap factor ${gapStrategy}`);
        }
    }
    /*
     * addPlacement adds a row to a placement table. This is called both when
     * the page is initially loaded, and when the "add" button is pressed on
     * the placement table. initialLoadPlacement is non-nil if this is being
     * called on the initial load.
     */
    addPlacement(isBuy, initialLoadPlacement, gapStrategy) {
        const { page, updatedConfig: cfg } = this;
        let tableBody = page.sellPlacementsTableBody;
        let addPlacementRow = page.addSellPlacementRow;
        let lotsElement = page.addSellPlacementLots;
        let gapFactorElement = page.addSellPlacementGapFactor;
        let errElement = page.sellPlacementsErr;
        if (isBuy) {
            tableBody = page.buyPlacementsTableBody;
            addPlacementRow = page.addBuyPlacementRow;
            lotsElement = page.addBuyPlacementLots;
            gapFactorElement = page.addBuyPlacementGapFactor;
            errElement = page.buyPlacementsErr;
        }
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(errElement);
        // updateArrowVis updates the visibility of the move up/down arrows in
        // each row of the placement table. The up arrow is not shown on the
        // top row, and the down arrow is not shown on the bottom row. They
        // are all hidden if market making is running.
        const updateArrowVis = () => {
            for (let i = 0; i < tableBody.children.length - 1; i++) {
                const row = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tableBody.children[i]);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(i !== 0, row.upBtn);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(i !== tableBody.children.length - 2, row.downBtn);
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(errElement);
        const setErr = (err) => {
            errElement.textContent = err;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(errElement);
        };
        let lots;
        let actualGapFactor;
        let displayedGapFactor;
        if (!gapStrategy)
            gapStrategy = this.specs.cexName ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier : cfg.gapStrategy;
        const placements = isBuy ? cfg.buyPlacements : cfg.sellPlacements;
        const unit = this.gapFactorHeaderUnit(gapStrategy)[1];
        if (initialLoadPlacement) {
            lots = initialLoadPlacement.lots;
            actualGapFactor = initialLoadPlacement.gapFactor;
            displayedGapFactor = this.convertGapFactor(actualGapFactor, gapStrategy, true);
        }
        else {
            lots = parseInt(lotsElement.value || '0');
            displayedGapFactor = parseFloat(gapFactorElement.value || '0');
            actualGapFactor = this.convertGapFactor(displayedGapFactor, gapStrategy, false);
            if (lots === 0) {
                setErr('Lots must be greater than 0');
                return;
            }
            const gapFactorErr = this.checkGapFactorRange(gapStrategy, displayedGapFactor);
            if (gapFactorErr) {
                setErr(gapFactorErr);
                return;
            }
            if (placements.find((placement) => placement.gapFactor === actualGapFactor)) {
                setErr('Duplicate placement');
                return;
            }
            placements.push({ lots, gapFactor: actualGapFactor });
        }
        const newRow = page.placementRowTmpl.cloneNode(true);
        const newRowTmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(newRow);
        newRowTmpl.priority.textContent = `${tableBody.children.length}`;
        newRowTmpl.lots.textContent = `${lots}`;
        newRowTmpl.gapFactor.textContent = `${displayedGapFactor} ${unit}`;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(newRowTmpl.removeBtn, 'click', () => {
            const index = placements.findIndex((placement) => {
                return placement.lots === lots && placement.gapFactor === actualGapFactor;
            });
            if (index === -1)
                return;
            placements.splice(index, 1);
            newRow.remove();
            updateArrowVis();
            this.updateModifiedMarkers();
            this.placementsChart.render();
            this.updateAllocations();
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(newRowTmpl.upBtn, 'click', () => {
            const index = placements.findIndex((p) => p.lots === lots && p.gapFactor === actualGapFactor);
            if (index === 0)
                return;
            const prevPlacement = placements[index - 1];
            placements[index - 1] = placements[index];
            placements[index] = prevPlacement;
            newRowTmpl.priority.textContent = `${index}`;
            newRow.remove();
            tableBody.insertBefore(newRow, tableBody.children[index - 1]);
            const movedDownTmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tableBody.children[index]);
            movedDownTmpl.priority.textContent = `${index + 1}`;
            updateArrowVis();
            this.updateModifiedMarkers();
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(newRowTmpl.downBtn, 'click', () => {
            const index = placements.findIndex((p) => p.lots === lots && p.gapFactor === actualGapFactor);
            if (index === placements.length - 1)
                return;
            const nextPlacement = placements[index + 1];
            placements[index + 1] = placements[index];
            placements[index] = nextPlacement;
            newRowTmpl.priority.textContent = `${index + 2}`;
            newRow.remove();
            tableBody.insertBefore(newRow, tableBody.children[index + 1]);
            const movedUpTmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tableBody.children[index]);
            movedUpTmpl.priority.textContent = `${index + 1}`;
            updateArrowVis();
            this.updateModifiedMarkers();
        });
        tableBody.insertBefore(newRow, addPlacementRow);
        updateArrowVis();
    }
    setArbMMLabels() {
        this.page.buyGapFactorHdr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_MATCH_BUFFER);
        this.page.sellGapFactorHdr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_MATCH_BUFFER);
    }
    /*
     * setGapFactorLabels sets the headers on the gap factor column of each
     * placement table.
     */
    setGapFactorLabels(gapStrategy) {
        const page = this.page;
        const header = this.gapFactorHeaderUnit(gapStrategy)[0];
        page.buyGapFactorHdr.textContent = header;
        page.sellGapFactorHdr.textContent = header;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.percentPlusInfo, page.percentInfo, page.absolutePlusInfo, page.absoluteInfo, page.multiplierInfo);
        switch (gapStrategy) {
            case 'percent-plus':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.percentPlusInfo);
            case 'percent':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.percentInfo);
            case 'absolute-plus':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.absolutePlusInfo);
            case 'absolute':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.absoluteInfo);
            case 'multiplier':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.multiplierInfo);
        }
    }
    clearPlacements(cacheKey) {
        const { page, updatedConfig: cfg } = this;
        while (page.buyPlacementsTableBody.children.length > 1) {
            page.buyPlacementsTableBody.children[0].remove();
        }
        while (page.sellPlacementsTableBody.children.length > 1) {
            page.sellPlacementsTableBody.children[0].remove();
        }
        this.placementsCache[cacheKey] = [cfg.buyPlacements, cfg.sellPlacements];
        cfg.buyPlacements.splice(0, cfg.buyPlacements.length);
        cfg.sellPlacements.splice(0, cfg.sellPlacements.length);
    }
    loadCachedPlacements(cacheKey) {
        const c = this.placementsCache[cacheKey];
        if (!c)
            return;
        const { updatedConfig: cfg } = this;
        cfg.buyPlacements.splice(0, cfg.buyPlacements.length);
        cfg.sellPlacements.splice(0, cfg.sellPlacements.length);
        cfg.buyPlacements.push(...c[0]);
        cfg.sellPlacements.push(...c[1]);
        const gapStrategy = cacheKey === arbMMRowCacheKey ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier : cacheKey;
        for (const p of cfg.buyPlacements)
            this.addPlacement(true, p, gapStrategy);
        for (const p of cfg.sellPlacements)
            this.addPlacement(false, p, gapStrategy);
    }
    /*
     * setOriginalValues sets the updatedConfig field to be equal to the
     * and sets the values displayed buy each field input to be equal
     * to the values since the last save.
     */
    setOriginalValues() {
        var _a, _b, _c;
        const { page, originalConfig: oldCfg, updatedConfig: cfg, specs: { cexName, botType } } = this;
        this.clearPlacements(cexName ? arbMMRowCacheKey : cfg.gapStrategy);
        const assign = (to, from) => {
            for (const [k, v] of Object.entries(from)) {
                if (Array.isArray(v)) {
                    to[k].splice(0, to[k].length);
                    for (const i of v)
                        to[k].push(i);
                }
                else if (typeof v === 'object')
                    Object.assign(to[k], v);
                else
                    to[k] = from[k];
            }
        };
        assign(cfg, JSON.parse(JSON.stringify(oldCfg)));
        const tol = (_a = cfg.driftTolerance) !== null && _a !== void 0 ? _a : defaultDriftTolerance.value;
        this.driftTolerance.setValue(tol * 100);
        this.driftToleranceSlider.setValue(tol / defaultDriftTolerance.maxV);
        const persist = (_b = cfg.orderPersistence) !== null && _b !== void 0 ? _b : defaultOrderPersistence.value;
        this.orderPersistence.setValue(persist);
        this.orderPersistenceSlider.setValue(persist / defaultOrderPersistence.maxV);
        const profit = (_c = cfg.profit) !== null && _c !== void 0 ? _c : defaultProfit.value;
        page.profitInput.value = String(profit * 100);
        this.qcProfit.setValue(profit * 100);
        this.qcProfitSlider.setValue((profit - defaultProfit.minV) / defaultProfit.range);
        if (cexName) {
            page.cexRebalanceCheckbox.checked = cfg.cexRebalance;
            this.autoRebalanceChanged();
        }
        // Gap strategy
        if (!page.gapStrategySelect.options)
            return;
        Array.from(page.gapStrategySelect.options).forEach((opt) => { opt.selected = opt.value === cfg.gapStrategy; });
        this.setGapFactorLabels(cfg.gapStrategy);
        if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.gapStrategyBox);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.profitSelectorBox, page.orderPersistenceBox);
            this.setGapFactorLabels(page.gapStrategySelect.value || '');
        }
        else if (cexName && (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName]) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.gapStrategyBox);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.profitSelectorBox, page.orderPersistenceBox);
            this.setArbMMLabels();
        }
        // Buy/Sell placements
        oldCfg.buyPlacements.forEach((p) => { this.addPlacement(true, p); });
        oldCfg.sellPlacements.forEach((p) => { this.addPlacement(false, p); });
        this.basePane.setupWalletSettings();
        this.quotePane.setupWalletSettings();
        this.updateModifiedMarkers();
        if (_doc__WEBPACK_IMPORTED_MODULE_1__["default"].isDisplayed(page.quickConfig))
            this.switchToQuickConfig();
    }
    /*
     * validateFields validates configuration values and optionally shows error
     * messages.
     */
    validateFields(showErrors) {
        let ok = true;
        const { page, specs: { botType }, updatedConfig: { sellPlacements, buyPlacements, profit } } = this;
        const setError = (errEl, errID) => {
            ok = false;
            if (!showErrors)
                return;
            errEl.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(errID);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(errEl);
        };
        if (showErrors) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.buyPlacementsErr, page.sellPlacementsErr, page.profitInputErr);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb && buyPlacements.length + sellPlacements.length === 0) {
            setError(page.buyPlacementsErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_PLACEMENTS);
            setError(page.sellPlacementsErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_PLACEMENTS);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
            if (isNaN(profit))
                setError(page.profitInputErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_INVALID_VALUE);
            else if (profit === 0)
                setError(page.profitInputErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_ZERO);
        }
        return ok;
    }
    /*
     * saveSettings updates the settings in the backend, and sets the originalConfig
     * to be equal to the updatedConfig.
     */
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            // Make a copy and delete either the basic mm config or the arb-mm config,
            // depending on whether a cex is selected.
            if (!this.validateFields(true))
                return;
            const { cfg, baseID, quoteID, host, botType, cexName } = this.marketStuff();
            const botCfg = {
                host: host,
                baseID: baseID,
                quoteID: quoteID,
                cexName: cexName !== null && cexName !== void 0 ? cexName : '',
                uiConfig: {
                    simpleArbLots: cfg.simpleArbLots,
                    baseConfig: cfg.baseConfig,
                    quoteConfig: cfg.quoteConfig,
                    cexRebalance: cfg.cexRebalance
                },
                baseWalletOptions: cfg.baseOptions,
                quoteWalletOptions: cfg.quoteOptions
            };
            switch (botType) {
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM:
                    botCfg.basicMarketMakingConfig = this.basicMMConfig();
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM:
                    botCfg.arbMarketMakingConfig = this.arbMMConfig();
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb:
                    botCfg.simpleArbConfig = this.basicArbConfig();
            }
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().log('mm', 'saving bot config', botCfg);
            yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.updateBotConfig(botCfg);
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchMMStatus();
            this.originalConfig = JSON.parse(JSON.stringify(cfg));
            this.updateModifiedMarkers();
            const lastBots = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastBotsLK) || {};
            lastBots[`${baseID}_${quoteID}_${host}`] = this.specs;
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(lastBotsLK, lastBots);
            if (cexName)
                _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(lastArbExchangeLK, cexName);
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm');
        });
    }
    delete() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, specs: { host, baseID, quoteID } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.deleteErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loading(page.botSettingsContainer);
            const resp = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.removeBotConfig(host, baseID, quoteID);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(resp)) {
                page.deleteErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_API_ERROR, { msg: resp.msg });
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.deleteErr);
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchMMStatus();
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm');
        });
    }
    /*
     * arbMMConfig parses the configuration for the arb-mm bot. Only one of
     * arbMMConfig or basicMMConfig should be used when updating the bot
     * configuration. Which is used depends on if the user has configured and
     * selected a CEX or not.
     */
    arbMMConfig() {
        const { updatedConfig: cfg } = this;
        const arbCfg = {
            buyPlacements: [],
            sellPlacements: [],
            profit: cfg.profit,
            driftTolerance: cfg.driftTolerance,
            orderPersistence: cfg.orderPersistence
        };
        for (const p of cfg.buyPlacements)
            arbCfg.buyPlacements.push({ lots: p.lots, multiplier: p.gapFactor });
        for (const p of cfg.sellPlacements)
            arbCfg.sellPlacements.push({ lots: p.lots, multiplier: p.gapFactor });
        return arbCfg;
    }
    basicArbConfig() {
        const { updatedConfig: cfg } = this;
        const arbCfg = {
            profitTrigger: cfg.profit,
            maxActiveArbs: 100,
            numEpochsLeaveOpen: cfg.orderPersistence
        };
        return arbCfg;
    }
    /*
     * basicMMConfig parses the configuration for the basic marketmaker. Only of
     * of basidMMConfig or arbMMConfig should be used when updating the bot
     * configuration.
     */
    basicMMConfig() {
        const { updatedConfig: cfg } = this;
        const mmCfg = {
            gapStrategy: cfg.gapStrategy,
            sellPlacements: cfg.sellPlacements,
            buyPlacements: cfg.buyPlacements,
            driftTolerance: cfg.driftTolerance
        };
        return mmCfg;
    }
    /*
     * fetchOracles fetches the current oracle rates and fiat rates, and displays
     * them on the screen.
     */
    fetchMarketReport() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, specs: { host, baseID, quoteID } } = this;
            const res = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.report(host, baseID, quoteID);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.oraclesLoading, page.oraclesTable, page.noOracles);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res)) {
                page.oraclesErrMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.oraclesErr);
                return;
            }
            const r = this.marketReport = res.report;
            if (!r.oracles || r.oracles.length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noOracles);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.noOracles);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.oracles);
                for (const o of (_a = r.oracles) !== null && _a !== void 0 ? _a : []) {
                    const tr = page.oracleTmpl.cloneNode(true);
                    page.oracles.appendChild(tr);
                    const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tr);
                    tmpl.logo.src = 'img/' + o.host + '.png';
                    tmpl.host.textContent = ExchangeNames[o.host];
                    tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(o.usdVol);
                    tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs((o.bestBuy + o.bestSell) / 2);
                }
                page.avgPrice.textContent = r.price ? _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(r.price) : '0';
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.oraclesTable);
            }
            if (r.baseFiatRate > 0) {
                page.baseFiatRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(r.baseFiatRate);
            }
            else {
                page.baseFiatRate.textContent = 'N/A';
            }
            if (r.quoteFiatRate > 0) {
                page.quoteFiatRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(r.quoteFiatRate);
            }
            else {
                page.quoteFiatRate.textContent = 'N/A';
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.fiatRates);
        });
    }
    /*
     * handleCEXSubmit handles clicks on the CEX configuration submission button.
     */
    cexConfigured(cexName) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, formSpecs: { host, baseID, quoteID } } = this;
            const dinfo = _mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos[cexName];
            for (const { baseID, quoteID, tmpl, arbs } of this.marketRows) {
                if (arbs.indexOf(cexName) !== -1)
                    continue;
                const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
                if (cexHasMarket(cexName)) {
                    const img = page.arbBttnTmpl.cloneNode(true);
                    img.src = dinfo.logo;
                    tmpl.arbs.appendChild(img);
                    arbs.push(cexName);
                }
            }
            this.setCEXAvailability(baseID, quoteID, cexName);
            this.showBotTypeForm(host, baseID, quoteID, _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM, cexName);
        });
    }
    /*
     * setupCEXes should be called during initialization.
     */
    setupCEXes() {
        this.formCexes = {};
        for (const name of Object.keys(_mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos))
            this.addCEX(name);
    }
    /*
     * setCEXAvailability sets the coloring and messaging of the CEX selection
     * buttons.
     */
    setCEXAvailability(baseID, quoteID, selectedCEX) {
        const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
        for (const { name, div, tmpl } of Object.values(this.formCexes)) {
            const has = cexHasMarket(name);
            const cexStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[name];
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(tmpl.unavailable, tmpl.needsconfig, tmpl.disconnected);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(Boolean(cexStatus), tmpl.reconfig);
            tmpl.logo.classList.remove('greyscal');
            div.classList.toggle('configured', Boolean(cexStatus) && !cexStatus.connectErr);
            if (!cexStatus) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(tmpl.needsconfig);
            }
            else if (cexStatus.connectErr) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(tmpl.disconnected);
            }
            else if (!has) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(tmpl.unavailable);
                tmpl.logo.classList.add('greyscal');
            }
            else if (name === selectedCEX)
                this.selectFormCEX(name);
        }
    }
    selectFormCEX(cexName) {
        for (const { name, div } of Object.values(this.formCexes)) {
            div.classList.toggle('selected', name === cexName);
        }
    }
    addCEX(cexName) {
        const dinfo = _mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos[cexName];
        const div = this.page.cexOptTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
        tmpl.name.textContent = dinfo.name;
        tmpl.logo.src = dinfo.logo;
        this.page.cexSelection.appendChild(div);
        this.formCexes[cexName] = { name: cexName, div, tmpl };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(div, 'click', () => {
            const cexStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
            if (!cexStatus || cexStatus.connectErr) {
                this.showCEXConfigForm(cexName);
                return;
            }
            const cex = this.formCexes[cexName];
            if (cex.div.classList.contains('selected')) { // unselect
                for (const cex of Object.values(this.formCexes))
                    cex.div.classList.remove('selected');
                const { baseID, quoteID } = this.formSpecs;
                this.setCEXAvailability(baseID, quoteID);
                return;
            }
            for (const cex of Object.values(this.formCexes))
                cex.div.classList.toggle('selected', cex.name === cexName);
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(tmpl.reconfig, 'click', (e) => {
            e.stopPropagation();
            this.showCEXConfigForm(cexName);
        });
    }
    showCEXConfigForm(cexName) {
        const page = this.page;
        this.cexConfigForm.setCEX(cexName);
        this.forms.show(page.cexConfigForm);
    }
    /*
     * cexMarketSupportFilter returns a lookup CEXes that have a matching market
     * for the currently selected base and quote assets.
     */
    cexMarketSupportFilter(baseID, quoteID) {
        var _a;
        const cexes = {};
        for (const [cexName, cexStatus] of Object.entries((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes)) {
            for (const { baseID: b, quoteID: q } of Object.values((_a = cexStatus.markets) !== null && _a !== void 0 ? _a : [])) {
                if (b === baseID && q === quoteID) {
                    cexes[cexName] = true;
                    break;
                }
            }
        }
        return (cexName) => Boolean(cexes[cexName]);
    }
}
function isViewOnly(specs, mmStatus) {
    const botStatus = mmStatus.bots.find(({ config: cfg }) => cfg.host === specs.host && cfg.baseID === specs.baseID && cfg.quoteID === specs.quoteID);
    return Boolean(botStatus === null || botStatus === void 0 ? void 0 : botStatus.running);
}
const ExchangeNames = {
    'binance.com': 'Binance',
    'coinbase.com': 'Coinbase',
    'bittrex.com': 'Bittrex',
    'hitbtc.com': 'HitBTC',
    'exmo.com': 'EXMO'
};
function tokenAssetApprovalStatuses(host, b, q) {
    var _a, _b;
    let baseAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.Approved;
    let quoteAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.Approved;
    if (b === null || b === void 0 ? void 0 : b.token) {
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[b.id];
        const baseVersion = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].assets[b.id].version;
        if (((_a = baseAsset === null || baseAsset === void 0 ? void 0 : baseAsset.wallet) === null || _a === void 0 ? void 0 : _a.approved) && baseAsset.wallet.approved[baseVersion] !== undefined) {
            baseAssetApprovalStatus = baseAsset.wallet.approved[baseVersion];
        }
    }
    if (q === null || q === void 0 ? void 0 : q.token) {
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[q.id];
        const quoteVersion = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].assets[q.id].version;
        if (((_b = quoteAsset === null || quoteAsset === void 0 ? void 0 : quoteAsset.wallet) === null || _b === void 0 ? void 0 : _b.approved) && quoteAsset.wallet.approved[quoteVersion] !== undefined) {
            quoteAssetApprovalStatus = quoteAsset.wallet.approved[quoteVersion];
        }
    }
    return [
        baseAssetApprovalStatus,
        quoteAssetApprovalStatus
    ];
}
class AssetPane {
    constructor(pg, div) {
        this.pg = pg;
        this.div = div;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
        this.nSwapFees = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.nSwapFees, {
            prec: defaultSwapReserves.prec,
            inc: defaultSwapReserves.inc,
            changed: (v) => {
                const { minR, range } = defaultSwapReserves;
                this.cfg.swapFeeN = v;
                this.nSwapFeesSlider.setValue((v - minR) / range);
                this.pg.updateAllocations();
            }
        });
        this.nSwapFeesSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.nSwapFeesSlider, (r) => {
            const { minR, range, prec } = defaultSwapReserves;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(minR + r * range, prec);
            this.cfg.swapFeeN = v;
            this.nSwapFees.setValue(v);
            this.pg.updateAllocations();
        });
        this.orderReserves = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.orderReservesFactor, {
            prec: defaultOrderReserves.prec,
            min: 0,
            changed: (v) => {
                const { minR, range } = defaultOrderReserves;
                this.cfg.orderReservesFactor = v;
                this.orderReservesSlider.setValue((v - minR) / range);
                this.pg.updateAllocations();
            }
        });
        this.orderReservesSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.orderReservesSlider, (r) => {
            const { minR, range, prec } = defaultOrderReserves;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(minR + r * range, prec);
            this.orderReserves.setValue(v);
            this.cfg.orderReservesFactor = v;
            this.pg.updateAllocations();
        });
        this.slippageBuffer = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.slippageBufferFactor, {
            prec: defaultSlippage.prec,
            min: 0,
            changed: (v) => {
                const { minR, range } = defaultSlippage;
                this.cfg.slippageBufferFactor = v;
                this.slippageBufferSlider.setValue((v - minR) / range);
                this.pg.updateAllocations();
            }
        });
        this.slippageBufferSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.slippageBufferSlider, (r) => {
            const { minR, range, prec } = defaultSlippage;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(minR + r * range, prec);
            this.slippageBuffer.setValue(minR + r * range);
            this.cfg.slippageBufferFactor = v;
            this.pg.updateAllocations();
        });
        this.minTransfer = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.minTransfer, {
            sigFigs: true,
            min: 0,
            changed: (v) => {
                const { cfg } = this;
                const totalInventory = this.commit();
                const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min * 2, totalInventory)];
                cfg.transferFactor = (v - minV) / (maxV - minV);
                this.minTransferSlider.setValue(cfg.transferFactor);
            }
        });
        this.minTransferSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.minTransferSlider, (r) => {
            const { cfg } = this;
            const totalInventory = this.commit();
            const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min, totalInventory)];
            cfg.transferFactor = r;
            this.minTransfer.setValue(minV + r * (maxV - minV));
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.showBalance, 'click', () => { pg.showAddress(this.assetID); });
    }
    // lot size can change if this is the quote asset, keep it updated.
    setLotSize(lotSize) {
        const { ui } = this;
        this.lotSize = lotSize;
        this.lotSizeConv = lotSize / ui.conventional.conversionFactor;
    }
    setAsset(assetID, isQuote) {
        var _a, _b;
        this.assetID = assetID;
        this.isQuote = isQuote;
        const cfg = this.cfg = isQuote ? this.pg.updatedConfig.quoteConfig : this.pg.updatedConfig.baseConfig;
        const { page, div, pg: { specs: { botType, baseID, cexName }, mktID, updatedConfig: { baseOptions, quoteOptions } } } = this;
        const { symbol, name, token, unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
        this.ui = ui;
        this.walletConfig = assetID === baseID ? baseOptions : quoteOptions;
        const { conventional: { unit: ticker } } = ui;
        this.feeAssetID = token ? token.parentID : assetID;
        const { unitInfo: feeUI, name: feeName, symbol: feeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.feeAssetID];
        this.feeUI = feeUI;
        this.inv = { book: 0, bookingFees: 0, swapFeeReserves: 0, cex: 0, orderReserves: 0, slippageBuffer: 0 };
        this.isToken = Boolean(token);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(this.isToken, page.feeTotalBox, page.feeReservesBox, page.feeBalances);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(isQuote, page.slippageBufferBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setSrc(div, '[data-logo]', _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(symbol));
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-name]', name);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-ticker]', ticker);
        const { conventional: { unit: feeTicker } } = feeUI;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-fee-ticker]', feeTicker);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-fee-name]', feeName);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setSrc(div, '[data-fee-logo]', _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(feeSymbol));
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM, page.cexMinInvBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb, page.orderReservesBox);
        this.nSwapFees.setValue((_a = cfg.swapFeeN) !== null && _a !== void 0 ? _a : defaultSwapReserves.n);
        this.nSwapFeesSlider.setValue(cfg.swapFeeN / defaultSwapReserves.maxR);
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)((_b = cfg.orderReservesFactor) !== null && _b !== void 0 ? _b : defaultOrderReserves.factor, defaultOrderReserves.prec);
            this.orderReserves.setValue(v);
            this.orderReservesSlider.setValue((v - defaultOrderReserves.minR) / defaultOrderReserves.range);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
            this.minTransfer.prec = Math.log10(ui.conventional.conversionFactor);
            const mkt = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName].markets[mktID];
            this.minTransfer.min = ((isQuote ? mkt.quoteMinWithdraw : mkt.baseMinWithdraw) / ui.conventional.conversionFactor);
        }
        this.slippageBuffer.setValue(cfg.slippageBufferFactor);
        const { minR, range } = defaultSlippage;
        this.slippageBufferSlider.setValue((cfg.slippageBufferFactor - minR) / range);
        this.setupWalletSettings();
        this.updateBalances();
    }
    commit() {
        const { inv, isToken } = this;
        let commit = inv.book + inv.cex + inv.orderReserves + inv.slippageBuffer;
        if (!isToken)
            commit += inv.bookingFees + inv.swapFeeReserves;
        return commit;
    }
    updateInventory(lots, counterLots, lotSize, dexCommit, cexCommit, fees) {
        this.setLotSize(lotSize);
        const { page, cfg, lotSizeConv, inv, ui, feeUI, isToken, isQuote, pg: { specs: { cexName, botType } } } = this;
        page.bookLots.textContent = String(lots);
        page.bookLotSize.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(lotSizeConv);
        inv.book = lots * lotSizeConv;
        page.bookCommitment.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.book);
        const feesPerLotConv = fees.bookingFeesPerLot / feeUI.conventional.conversionFactor;
        page.bookingFeesPerLot.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feesPerLotConv);
        page.swapReservesFactor.textContent = fees.swapReservesFactor.toFixed(2);
        page.bookingFeesLots.textContent = String(lots);
        inv.bookingFees = fees.bookingFees / feeUI.conventional.conversionFactor;
        page.bookingFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.bookingFees);
        if (cexName) {
            inv.cex = cexCommit / ui.conventional.conversionFactor;
            page.cexMinInv.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.cex);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            const totalInventory = Math.max(cexCommit, dexCommit) / ui.conventional.conversionFactor;
            page.orderReservesBasis.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(totalInventory);
            const orderReserves = totalInventory * cfg.orderReservesFactor;
            inv.orderReserves = orderReserves;
            page.orderReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(orderReserves);
        }
        if (isToken) {
            const feesPerSwapConv = fees.tokenFeesPerSwap / feeUI.conventional.conversionFactor;
            page.feeReservesPerSwap.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feesPerSwapConv);
            inv.swapFeeReserves = feesPerSwapConv * cfg.swapFeeN;
            page.feeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.swapFeeReserves);
        }
        if (isQuote) {
            const basis = inv.book + inv.cex + inv.orderReserves;
            page.slippageBufferBasis.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(basis * ui.conventional.conversionFactor, ui);
            inv.slippageBuffer = basis * cfg.slippageBufferFactor;
            page.slippageBuffer.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(inv.slippageBuffer * ui.conventional.conversionFactor, ui);
        }
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(fees.bookingFeesPerCounterLot > 0, page.redemptionFeesBox);
        if (fees.bookingFeesPerCounterLot > 0) {
            const feesPerLotConv = fees.bookingFeesPerCounterLot / feeUI.conventional.conversionFactor;
            page.redemptionFeesPerLot.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feesPerLotConv);
            page.redemptionFeesLots.textContent = String(counterLots);
            page.redeemReservesFactor.textContent = fees.redeemReservesFactor.toFixed(2);
        }
        this.updateCommitTotal();
        this.updateTokenFees();
        this.updateRebalance();
    }
    updateCommitTotal() {
        const { page, assetID, ui } = this;
        const commit = this.commit();
        page.commitTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(Math.round(commit * ui.conventional.conversionFactor), ui);
        page.commitTotalFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(commit * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[assetID]);
    }
    updateTokenFees() {
        const { page, inv, feeAssetID, feeUI, isToken } = this;
        if (!isToken)
            return;
        const feeReserves = inv.bookingFees + inv.swapFeeReserves;
        page.feeTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(feeReserves * feeUI.conventional.conversionFactor, feeUI);
        page.feeTotalFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feeReserves * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[feeAssetID]);
    }
    updateRebalance() {
        const { page, cfg, pg: { updatedConfig: { cexRebalance }, specs: { cexName } } } = this;
        const showRebalance = cexName && cexRebalance;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(showRebalance, page.rebalanceOpts);
        if (!showRebalance)
            return;
        const totalInventory = this.commit();
        const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min * 2, totalInventory)];
        const rangeV = maxV - minV;
        this.minTransfer.setValue(minV + cfg.transferFactor * rangeV);
        this.minTransferSlider.setValue((cfg.transferFactor - defaultTransfer.minR) / defaultTransfer.range);
    }
    setupWalletSettings() {
        const { page, assetID, walletConfig } = this;
        const walletSettings = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().currentWalletDefinition(assetID);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.walletSettings);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!walletSettings.multifundingopts, page.walletSettingsNone);
        if (!walletSettings.multifundingopts)
            return;
        const optToDiv = {};
        const dependentOpts = {};
        const addDependentOpt = (optKey, optSetting, dependentOn) => {
            if (!dependentOpts[dependentOn])
                dependentOpts[dependentOn] = [];
            dependentOpts[dependentOn].push(optKey);
            optToDiv[optKey] = optSetting;
        };
        const setDependentOptsVis = (parentOptKey, vis) => {
            const optKeys = dependentOpts[parentOptKey];
            if (!optKeys)
                return;
            for (const optKey of optKeys)
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(vis, optToDiv[optKey]);
        };
        const addOpt = (opt) => {
            if (opt.quoteAssetOnly && !this.isQuote)
                return;
            const currVal = walletConfig[opt.key];
            let div;
            if (opt.isboolean) {
                div = page.boolSettingTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
                tmpl.name.textContent = opt.displayname;
                tmpl.input.checked = currVal === 'true';
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(tmpl.input, 'change', () => {
                    walletConfig[opt.key] = tmpl.input.checked ? 'true' : 'false';
                    setDependentOptsVis(opt.key, Boolean(tmpl.input.checked));
                });
                if (opt.description)
                    tmpl.tooltip.dataset.tooltip = opt.description;
            }
            else if (opt.xyRange) {
                const { start, end, xUnit } = opt.xyRange;
                const range = end.x - start.x;
                div = page.rangeSettingTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
                tmpl.name.textContent = opt.displayname;
                if (opt.description)
                    tmpl.tooltip.dataset.tooltip = opt.description;
                if (xUnit)
                    tmpl.unit.textContent = xUnit;
                else
                    _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(tmpl.unit);
                const input = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(tmpl.value, {
                    prec: 1,
                    changed: (rawV) => {
                        const [v, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(rawV, 1);
                        walletConfig[opt.key] = s;
                        slider.setValue((v - start.x) / range);
                    }
                });
                const slider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(tmpl.slider, (r) => {
                    const rawV = start.x + r * range;
                    const [v, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(rawV, 1);
                    walletConfig[opt.key] = s;
                    input.setValue(v);
                });
                // TODO: default value should be smaller or none for base asset.
                const [v, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)((0,_doc__WEBPACK_IMPORTED_MODULE_1__.parseFloatDefault)(currVal, start.x), 3);
                walletConfig[opt.key] = s;
                slider.setValue((v - start.x) / range);
                input.setValue(v);
                tmpl.value.textContent = s;
            }
            if (!div)
                return console.error("don't know how to handle opt", opt);
            page.walletSettings.appendChild(div);
            if (opt.dependsOn) {
                addDependentOpt(opt.key, div, opt.dependsOn);
                const parentOptVal = walletConfig[opt.dependsOn];
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(parentOptVal === 'true', div);
            }
        };
        if (walletSettings.multifundingopts && walletSettings.multifundingopts.length > 0) {
            for (const opt of walletSettings.multifundingopts)
                addOpt(opt);
        }
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().bindTooltips(page.walletSettings);
    }
    updateBalances() {
        const { page, assetID, ui, feeAssetID, feeUI, pg: { specs: { cexName, baseID }, cexBaseBalance, cexQuoteBalance } } = this;
        const { balance: { available } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[assetID];
        const botInv = this.pg.runningBotInventory(assetID);
        const dexAvail = available - botInv.dex.total;
        let cexAvail = 0;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(cexName, page.balanceBreakdown);
        if (cexName) {
            page.dexAvail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(dexAvail / ui.conventional.conversionFactor);
            const { available: cexRawAvail } = assetID === baseID ? cexBaseBalance : cexQuoteBalance;
            cexAvail = cexRawAvail - botInv.cex.total;
            page.cexAvail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(cexAvail / ui.conventional.conversionFactor);
        }
        page.avail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs((dexAvail + cexAvail) / ui.conventional.conversionFactor);
        if (assetID === feeAssetID)
            return;
        const { balance: { available: feeAvail } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[feeAssetID];
        page.feeAvail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feeAvail / feeUI.conventional.conversionFactor);
    }
}


/***/ }),

/***/ "./src/js/mmutil.ts":
/*!**************************!*\
  !*** ./src/js/mmutil.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BotMarket": () => (/* binding */ BotMarket),
/* harmony export */   "CEXDisplayInfos": () => (/* binding */ CEXDisplayInfos),
/* harmony export */   "GapStrategyAbsolute": () => (/* binding */ GapStrategyAbsolute),
/* harmony export */   "GapStrategyAbsolutePlus": () => (/* binding */ GapStrategyAbsolutePlus),
/* harmony export */   "GapStrategyMultiplier": () => (/* binding */ GapStrategyMultiplier),
/* harmony export */   "GapStrategyPercent": () => (/* binding */ GapStrategyPercent),
/* harmony export */   "GapStrategyPercentPlus": () => (/* binding */ GapStrategyPercentPlus),
/* harmony export */   "MM": () => (/* binding */ MM),
/* harmony export */   "PlacementsChart": () => (/* binding */ PlacementsChart),
/* harmony export */   "RunningMarketMakerDisplay": () => (/* binding */ RunningMarketMakerDisplay),
/* harmony export */   "botTypeArbMM": () => (/* binding */ botTypeArbMM),
/* harmony export */   "botTypeBasicArb": () => (/* binding */ botTypeBasicArb),
/* harmony export */   "botTypeBasicMM": () => (/* binding */ botTypeBasicMM),
/* harmony export */   "calculateQuoteLot": () => (/* binding */ calculateQuoteLot),
/* harmony export */   "feesAndCommit": () => (/* binding */ feesAndCommit),
/* harmony export */   "hostedMarketID": () => (/* binding */ hostedMarketID),
/* harmony export */   "liveBotConfig": () => (/* binding */ liveBotConfig),
/* harmony export */   "liveBotStatus": () => (/* binding */ liveBotStatus),
/* harmony export */   "runningBotInventory": () => (/* binding */ runningBotInventory),
/* harmony export */   "setCexElements": () => (/* binding */ setCexElements),
/* harmony export */   "setMarketElements": () => (/* binding */ setMarketElements)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






const GapStrategyMultiplier = 'multiplier';
const GapStrategyAbsolute = 'absolute';
const GapStrategyAbsolutePlus = 'absolute-plus';
const GapStrategyPercent = 'percent';
const GapStrategyPercentPlus = 'percent-plus';
const botTypeBasicMM = 'basicMM';
const botTypeArbMM = 'arbMM';
const botTypeBasicArb = 'basicArb';
const CEXDisplayInfos = {
    'Binance': {
        name: 'Binance',
        logo: '/img/binance.com.png'
    },
    'BinanceUS': {
        name: 'Binance U.S.',
        logo: '/img/binance.us.png'
    }
};
/*
 * MarketMakerBot is the front end representation of the server's
 * mm.MarketMaker. MarketMakerBot is a singleton assigned to MM below.
 */
class MarketMakerBot {
    constructor() {
        this.cexBalanceCache = {};
    }
    /*
     * updateBotConfig appends or updates the specified BotConfig.
     */
    updateBotConfig(cfg) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/updatebotconfig', cfg);
        });
    }
    /*
     * updateCEXConfig appends or updates the specified CEXConfig.
     */
    updateCEXConfig(cfg) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/updatecexconfig', cfg);
        });
    }
    removeBotConfig(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/removebotconfig', { host, baseID, quoteID });
        });
    }
    report(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/marketreport', { host, baseID, quoteID });
        });
    }
    startBot(config) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/startmarketmakingbot', { config });
        });
    }
    stopBot(market) {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/stopmarketmakingbot', { market });
        });
    }
    status() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.getJSON)('/api/marketmakingstatus')).status;
        });
    }
    // botStats returns the RunStats for a running bot with the specified parameters.
    botStats(baseID, quoteID, host, startTime) {
        for (const botStatus of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots)) {
            if (!botStatus.runStats)
                continue;
            const runStats = botStatus.runStats;
            const cfg = botStatus.config;
            if (cfg.baseID === baseID && cfg.quoteID === quoteID && cfg.host === host && runStats.startTime === startTime) {
                return runStats;
            }
        }
    }
    cachedCexBalance(cexName, assetID) {
        var _a;
        return (_a = this.cexBalanceCache[cexName]) === null || _a === void 0 ? void 0 : _a[assetID];
    }
    cexBalance(cexName, assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.cexBalanceCache[cexName])
                this.cexBalanceCache[cexName] = {};
            const cexBalance = (yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/cexbalance', { cexName, assetID })).cexBalance;
            this.cexBalanceCache[cexName][assetID] = cexBalance;
            return cexBalance;
        });
    }
}
// MM is the front end representation of the server's mm.MarketMaker.
const MM = new MarketMakerBot();
function runningBotInventory(assetID) {
    return (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.reduce((v, { runStats, running }) => {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v;
        if (!running || !runStats)
            return v;
        const { dexBalances: d, cexBalances: c } = runStats;
        v.cex.locked += (_b = (_a = c[assetID]) === null || _a === void 0 ? void 0 : _a.locked) !== null && _b !== void 0 ? _b : 0;
        v.cex.locked += (_d = (_c = c[assetID]) === null || _c === void 0 ? void 0 : _c.reserved) !== null && _d !== void 0 ? _d : 0;
        v.cex.avail += (_f = (_e = c[assetID]) === null || _e === void 0 ? void 0 : _e.available) !== null && _f !== void 0 ? _f : 0;
        v.cex.total = v.cex.avail + v.cex.locked;
        v.dex.locked += (_h = (_g = d[assetID]) === null || _g === void 0 ? void 0 : _g.locked) !== null && _h !== void 0 ? _h : 0;
        v.dex.locked += (_k = (_j = d[assetID]) === null || _j === void 0 ? void 0 : _j.reserved) !== null && _k !== void 0 ? _k : 0;
        v.dex.avail += (_m = (_l = d[assetID]) === null || _l === void 0 ? void 0 : _l.available) !== null && _m !== void 0 ? _m : 0;
        v.dex.total = v.dex.avail + v.dex.locked;
        v.avail += ((_p = (_o = d[assetID]) === null || _o === void 0 ? void 0 : _o.available) !== null && _p !== void 0 ? _p : 0) + ((_r = (_q = c[assetID]) === null || _q === void 0 ? void 0 : _q.available) !== null && _r !== void 0 ? _r : 0);
        v.locked += ((_t = (_s = d[assetID]) === null || _s === void 0 ? void 0 : _s.locked) !== null && _t !== void 0 ? _t : 0) + ((_v = (_u = c[assetID]) === null || _u === void 0 ? void 0 : _u.locked) !== null && _v !== void 0 ? _v : 0);
        return v;
    }, { avail: 0, locked: 0, cex: { avail: 0, locked: 0, total: 0 }, dex: { avail: 0, locked: 0, total: 0 } });
}
function setMarketElements(ancestor, baseID, quoteID, host) {
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-host]', host);
    const { unitInfo: bui, name: baseName, symbol: baseSymbol, token: baseToken } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-name]', baseName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-base-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(baseSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-ticker]', bui.conventional.unit);
    const { unitInfo: baseFeeUI, name: baseFeeName, symbol: baseFeeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseToken ? baseToken.parentID : baseID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-fee-name]', baseFeeName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-base-fee-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(baseFeeSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-fee-ticker]', baseFeeUI.conventional.unit);
    const { unitInfo: qui, name: quoteName, symbol: quoteSymbol, token: quoteToken } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-name]', quoteName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-quote-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(quoteSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-ticker]', qui.conventional.unit);
    const { unitInfo: quoteFeeUI, name: quoteFeeName, symbol: quoteFeeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteToken ? quoteToken.parentID : quoteID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-fee-name]', quoteFeeName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-quote-fee-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(quoteFeeSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-fee-ticker]', quoteFeeUI.conventional.unit);
}
function setCexElements(ancestor, cexName) {
    const dinfo = CEXDisplayInfos[cexName];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-cex-name]', dinfo.name);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-cex-logo]', dinfo.logo);
    for (const img of _doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(ancestor, '[data-cex-logo]'))
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(img);
}
function calculateQuoteLot(lotSize, baseID, quoteID, spot) {
    const baseRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[baseID];
    const quoteRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[quoteID];
    const { unitInfo: { conventional: { conversionFactor: bFactor } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
    const { unitInfo: { conventional: { conversionFactor: qFactor } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
    if (baseRate && quoteRate) {
        return lotSize * baseRate / quoteRate * qFactor / bFactor;
    }
    else if (spot) {
        return lotSize * spot.rate / _orderutil__WEBPACK_IMPORTED_MODULE_3__.RateEncodingFactor;
    }
    return qFactor;
}
class PlacementsChart extends _charts__WEBPACK_IMPORTED_MODULE_4__.Chart {
    constructor(parent) {
        super(parent, {
            resize: () => this.resized(),
            click: ( /* e: MouseEvent */) => { },
            zoom: ( /* bigger: boolean */) => { }
        });
    }
    resized() {
        this.render();
    }
    draw() { }
    setMarket(cfg) {
        this.cfg = cfg;
        const { loadedCEX, cfg: { cexName } } = this;
        if (cexName && cexName !== loadedCEX) {
            this.loadedCEX = cexName;
            this.cexLogo = new Image();
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.cexLogo, 'load', () => { this.render(); });
            this.cexLogo.src = CEXDisplayInfos[cexName || ''].logo;
        }
        this.render();
    }
    render() {
        const { ctx, canvas, theme, cfg } = this;
        if (canvas.width === 0 || !cfg)
            return;
        const { dict: { buyPlacements, sellPlacements, profit }, baseFiatRate, botType } = cfg;
        if (botType === botTypeBasicArb)
            return;
        this.clear();
        const drawDashedLine = (x0, y0, x1, y1, color) => {
            ctx.save();
            ctx.setLineDash([3, 5]);
            ctx.lineWidth = 1.5;
            ctx.strokeStyle = color;
            this.line(x0, y0, x1, y1);
            ctx.restore();
        };
        const isBasicMM = botType === botTypeBasicMM;
        const cx = canvas.width / 2;
        const [cexGapL, cexGapR] = isBasicMM ? [cx, cx] : [0.48 * canvas.width, 0.52 * canvas.width];
        const buyLots = buyPlacements.reduce((v, p) => v + p.lots, 0);
        const sellLots = sellPlacements.reduce((v, p) => v + p.lots, 0);
        const maxLots = Math.max(buyLots, sellLots);
        let widest = 0;
        let fauxSpacer = 0;
        if (isBasicMM) {
            const leftmost = buyPlacements.reduce((v, p) => Math.max(v, p.gapFactor), 0);
            const rightmost = sellPlacements.reduce((v, p) => Math.max(v, p.gapFactor), 0);
            widest = Math.max(leftmost, rightmost);
        }
        else {
            // For arb-mm, we don't know how the orders will be spaced because it
            // depends on the vwap. But we're just trying to capture the general sense
            // of how the parameters will affect order placement, so we'll fake it.
            // Higher match buffer values will lead to orders with less favorable
            // rates, e.g. the spacing will be larger.
            const ps = [...buyPlacements, ...sellPlacements];
            const matchBuffer = ps.reduce((sum, p) => sum + p.gapFactor, 0) / ps.length;
            fauxSpacer = 0.01 * (1 + matchBuffer);
            widest = Math.min(10, Math.max(buyPlacements.length, sellPlacements.length)) * fauxSpacer; // arb-mm
        }
        // Make the range 15% on each side, which will include profit + placements,
        // unless they have orders with larger gap factors.
        const minRange = profit + widest;
        const defaultRange = 0.155;
        const range = Math.max(minRange * 1.05, defaultRange);
        // Increase data height logarithmically up to 1,000,000 USD.
        const maxCommitUSD = maxLots * baseFiatRate;
        const regionHeight = 0.2 + 0.7 * Math.log((0,_doc__WEBPACK_IMPORTED_MODULE_2__.clamp)(maxCommitUSD, 0, 1e6)) / Math.log(1e6);
        // Draw a region in the middle representing the cex gap.
        const plotRegion = new _charts__WEBPACK_IMPORTED_MODULE_4__.Region(ctx, new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(0, canvas.width, 0, canvas.height));
        if (isBasicMM) {
            drawDashedLine(cx, 0, cx, canvas.height, theme.gapLine);
        }
        else { // arb-mm
            plotRegion.plot(new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(0, 1, 0, 1), (ctx, tools) => {
                const [y0, y1] = [tools.y(0), tools.y(1)];
                drawDashedLine(cexGapL, y0, cexGapL, y1, theme.gapLine);
                drawDashedLine(cexGapR, y0, cexGapR, y1, theme.gapLine);
                const y = tools.y(0.95);
                ctx.drawImage(this.cexLogo, cx - 8, y, 16, 16);
                this.applyLabelStyle(18);
                ctx.fillText('Î´', cx, y + 29);
            });
        }
        const plotSide = (isBuy, placements) => {
            if (!(placements === null || placements === void 0 ? void 0 : placements.length))
                return;
            const [xMin, xMax] = isBuy ? [0, cexGapL] : [cexGapR, canvas.width];
            const reg = new _charts__WEBPACK_IMPORTED_MODULE_4__.Region(ctx, new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(xMin, xMax, canvas.height * (1 - regionHeight), canvas.height));
            const [l, r] = isBuy ? [-range, 0] : [0, range];
            reg.plot(new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(l, r, 0, maxLots), (ctx, tools) => {
                ctx.lineWidth = 2.5;
                ctx.strokeStyle = isBuy ? theme.buyLine : theme.sellLine;
                ctx.fillStyle = isBuy ? theme.buyFill : theme.sellFill;
                ctx.beginPath();
                const sideFactor = isBuy ? -1 : 1;
                const firstPt = placements[0];
                const y0 = tools.y(0);
                const firstX = tools.x((isBasicMM ? firstPt.gapFactor : profit + fauxSpacer) * sideFactor);
                ctx.moveTo(firstX, y0);
                let cumulativeLots = 0;
                for (let i = 0; i < placements.length; i++) {
                    const p = placements[i];
                    // For arb-mm, we don't know exactly
                    const rawX = isBasicMM ? p.gapFactor : profit + (i + 1) * fauxSpacer;
                    const x = tools.x(rawX * sideFactor);
                    ctx.lineTo(x, tools.y(cumulativeLots));
                    cumulativeLots += p.lots;
                    ctx.lineTo(x, tools.y(cumulativeLots));
                }
                const xInfinity = isBuy ? canvas.width * -0.1 : canvas.width * 1.1;
                ctx.lineTo(xInfinity, tools.y(cumulativeLots));
                ctx.stroke();
                ctx.lineTo(xInfinity, y0);
                ctx.lineTo(firstX, y0);
                ctx.closePath();
                ctx.globalAlpha = 0.25;
                ctx.fill();
            }, true);
        };
        plotSide(false, sellPlacements);
        plotSide(true, buyPlacements);
    }
}
function hostedMarketID(host, baseID, quoteID) {
    return `${host}-${baseID}-${quoteID}`; // same as MarketWithHost.String()
}
function liveBotConfig(host, baseID, quoteID) {
    const s = liveBotStatus(host, baseID, quoteID);
    if (s)
        return s.config;
}
function liveBotStatus(host, baseID, quoteID) {
    const statuses = ((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots || []).filter((s) => {
        return s.config.baseID === baseID && s.config.quoteID === quoteID && s.config.host === host;
    });
    if (statuses.length)
        return statuses[0];
}
function sumLots(lots, p) {
    return lots + p.lots;
}
function emptyProjection() {
    return { book: 0, bookingFees: 0, swapFeeReserves: 0, cex: 0, orderReserves: 0, slippageBuffer: 0 };
}
class BotMarket {
    constructor(cfg) {
        const host = this.host = cfg.host;
        const baseID = this.baseID = cfg.baseID;
        const quoteID = this.quoteID = cfg.quoteID;
        this.cexName = cfg.cexName;
        const status = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.find(({ config: c }) => c.baseID === baseID && c.quoteID === quoteID && c.host === host);
        if (!status)
            throw Error('where\'s the bot status?');
        this.cfg = status.config;
        const { token: baseToken, symbol: baseSymbol, unitInfo: bui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        this.baseSymbol = baseSymbol;
        this.baseTicker = bui.conventional.unit;
        this.bui = bui;
        this.baseFactor = bui.conventional.conversionFactor;
        this.baseToken = baseToken;
        const baseFeeID = this.baseFeeID = baseToken ? baseToken.parentID : baseID;
        const { unitInfo: baseFeeUI, symbol: baseFeeSymbol, wallet: baseWallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.baseFeeID];
        const traitAccountLocker = 1 << 14;
        this.baseIsAccountLocker = (baseWallet.traits & traitAccountLocker) > 0;
        this.baseFeeUI = baseFeeUI;
        this.baseFeeTicker = baseFeeUI.conventional.unit;
        this.baseFeeSymbol = baseFeeSymbol;
        this.baseFeeFactor = this.baseFeeUI.conventional.conversionFactor;
        const { token: quoteToken, symbol: quoteSymbol, unitInfo: qui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        this.quoteSymbol = quoteSymbol;
        this.quoteTicker = qui.conventional.unit;
        this.qui = qui;
        this.quoteFactor = qui.conventional.conversionFactor;
        this.quoteToken = quoteToken;
        const quoteFeeID = this.quoteFeeID = quoteToken ? quoteToken.parentID : quoteID;
        const { unitInfo: quoteFeeUI, symbol: quoteFeeSymbol, wallet: quoteWallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.quoteFeeID];
        this.quoteIsAccountLocker = (quoteWallet.traits & traitAccountLocker) > 0;
        this.quoteFeeUI = quoteFeeUI;
        this.quoteFeeTicker = quoteFeeUI.conventional.unit;
        this.quoteFeeSymbol = quoteFeeSymbol;
        this.quoteFeeFactor = this.quoteFeeUI.conventional.conversionFactor;
        this.id = hostedMarketID(host, baseID, quoteID);
        this.mktID = `${baseSymbol}_${quoteSymbol}`;
        const { markets } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host];
        const { lotsize: lotSize, ratestep: rateStep } = markets[this.mktID];
        this.lotSize = lotSize;
        this.lotSizeConv = lotSize / bui.conventional.conversionFactor;
        this.rateStep = rateStep;
        this.quoteLot = calculateQuoteLot(lotSize, baseID, quoteID);
        this.quoteLotConv = this.quoteLot / qui.conventional.conversionFactor;
        this.baseFeeFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[baseFeeID];
        this.quoteFeeFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[quoteFeeID];
        if (cfg.arbMarketMakingConfig) {
            this.botType = botTypeArbMM;
            this.baseLots = cfg.arbMarketMakingConfig.sellPlacements.reduce(sumLots, 0);
            this.quoteLots = cfg.arbMarketMakingConfig.buyPlacements.reduce(sumLots, 0);
            this.nBuyPlacements = cfg.arbMarketMakingConfig.buyPlacements.length;
            this.nSellPlacements = cfg.arbMarketMakingConfig.sellPlacements.length;
        }
        else if (cfg.simpleArbConfig) {
            this.botType = botTypeBasicArb;
            this.baseLots = cfg.uiConfig.simpleArbLots;
            this.quoteLots = cfg.uiConfig.simpleArbLots;
        }
        else if (cfg.basicMarketMakingConfig) { // basicmm
            this.botType = botTypeBasicMM;
            this.baseLots = cfg.basicMarketMakingConfig.sellPlacements.reduce(sumLots, 0);
            this.quoteLots = cfg.basicMarketMakingConfig.buyPlacements.reduce(sumLots, 0);
            this.nBuyPlacements = cfg.basicMarketMakingConfig.buyPlacements.length;
            this.nSellPlacements = cfg.basicMarketMakingConfig.sellPlacements.length;
        }
    }
    initialize(startupBalanceCache) {
        return __awaiter(this, void 0, void 0, function* () {
            const { host, baseID, quoteID, lotSizeConv, quoteLotConv, cexName } = this;
            const res = yield MM.report(host, baseID, quoteID);
            const r = this.marketReport = res.report;
            this.lotSizeUSD = lotSizeConv * r.baseFiatRate;
            this.quoteLotUSD = quoteLotConv * r.quoteFiatRate;
            this.proj = this.projectedAllocations();
            if (cexName) {
                const b = startupBalanceCache[baseID] = startupBalanceCache[baseID] || MM.cexBalance(cexName, baseID);
                const q = startupBalanceCache[quoteID] = startupBalanceCache[quoteID] || MM.cexBalance(cexName, quoteID);
                this.cexBaseBalance = yield b;
                this.cexQuoteBalance = yield q;
            }
        });
    }
    status() {
        const { baseID, quoteID } = this;
        const botStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.find((s) => s.config.baseID === baseID && s.config.quoteID === quoteID);
        if (!botStatus)
            return { botCfg: {}, running: false, runStats: {} };
        const { config: botCfg, running, runStats, latestEpoch, cexProblems } = botStatus;
        return { botCfg, running, runStats, latestEpoch, cexProblems };
    }
    /*
    * adjustedBalances calculates the user's available balances and fee-asset
    * balances for a market, with consideration for currently running bots.
    */
    adjustedBalances() {
        const { baseID, quoteID, baseFeeID, quoteFeeID, cexBaseBalance, cexQuoteBalance, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor } = this;
        const [baseWallet, quoteWallet] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteID]];
        const [bInv, qInv] = [runningBotInventory(baseID), runningBotInventory(quoteID)];
        // In these available balance calcs, only subtract the available balance of
        // running bots, since the locked/reserved/immature is already subtracted
        // from the wallet's total available balance.
        const [cexBaseAvail, cexQuoteAvail] = [((cexBaseBalance === null || cexBaseBalance === void 0 ? void 0 : cexBaseBalance.available) || 0) - bInv.cex.avail, ((cexQuoteBalance === null || cexQuoteBalance === void 0 ? void 0 : cexQuoteBalance.available) || 0) - qInv.cex.avail];
        const [dexBaseAvail, dexQuoteAvail] = [baseWallet.balance.available - bInv.dex.avail, quoteWallet.balance.available - qInv.dex.avail];
        const baseAvail = dexBaseAvail + cexBaseAvail;
        const quoteAvail = dexQuoteAvail + cexQuoteAvail;
        const baseFeeWallet = baseFeeID === baseID ? baseWallet : (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseFeeID];
        const quoteFeeWallet = quoteFeeID === quoteID ? quoteWallet : (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteFeeID];
        let [baseFeeAvail, dexBaseFeeAvail, cexBaseFeeAvail] = [baseAvail, dexBaseAvail, cexBaseAvail];
        if (baseFeeID !== baseID) {
            const bFeeInv = runningBotInventory(baseID);
            dexBaseFeeAvail = baseFeeWallet.balance.available - bFeeInv.dex.total;
            cexBaseFeeAvail = ((cexBaseBalance === null || cexBaseBalance === void 0 ? void 0 : cexBaseBalance.available) || 0) - bFeeInv.cex.total;
            baseFeeAvail = dexBaseFeeAvail + cexBaseFeeAvail;
        }
        let [quoteFeeAvail, dexQuoteFeeAvail, cexQuoteFeeAvail] = [quoteAvail, dexQuoteAvail, cexQuoteAvail];
        if (quoteFeeID !== quoteID) {
            const qFeeInv = runningBotInventory(quoteID);
            dexQuoteFeeAvail = quoteFeeWallet.balance.available - qFeeInv.dex.total;
            cexQuoteFeeAvail = ((cexQuoteBalance === null || cexQuoteBalance === void 0 ? void 0 : cexQuoteBalance.available) || 0) - qFeeInv.cex.total;
            quoteFeeAvail = dexQuoteFeeAvail + cexQuoteFeeAvail;
        }
        return {
            baseAvail: baseAvail / baseFactor,
            quoteAvail: quoteAvail / quoteFactor,
            dexBaseAvail: dexBaseAvail / baseFactor,
            dexQuoteAvail: dexQuoteAvail / quoteFactor,
            cexBaseAvail: cexBaseAvail / baseFactor,
            cexQuoteAvail: cexQuoteAvail / quoteFactor,
            baseFeeAvail: baseFeeAvail / baseFeeFactor,
            quoteFeeAvail: quoteFeeAvail / quoteFeeFactor,
            dexBaseFeeAvail: dexBaseFeeAvail / baseFeeFactor,
            dexQuoteFeeAvail: dexQuoteFeeAvail / quoteFeeFactor,
            cexBaseFeeAvail: cexBaseFeeAvail / baseFeeFactor,
            cexQuoteFeeAvail: cexQuoteFeeAvail / quoteFeeFactor
        };
    }
    /*
     * feesAndCommit generates a snapshot of current market fees, as well as a
     * "commit", which is the funding dedicated to being on order. The commit
     * values do not include booking fees, order reserves, etc. just the order
     * quantity.
     */
    feesAndCommit() {
        const { baseID, quoteID, marketReport: { baseFees, quoteFees }, lotSize, baseLots, quoteLots, baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker, cfg: { uiConfig: { baseConfig, quoteConfig } } } = this;
        return feesAndCommit(baseID, quoteID, baseFees, quoteFees, lotSize, baseLots, quoteLots, baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker, baseConfig.orderReservesFactor, quoteConfig.orderReservesFactor);
    }
    /*
     * projectedAllocations calculates the required asset allocations from the
     * user's configuration settings and the current market state.
     */
    projectedAllocations() {
        const { cfg: { uiConfig: { quoteConfig, baseConfig } }, baseFactor, quoteFactor, baseID, quoteID, lotSizeConv, quoteLotConv, baseFeeFactor, quoteFeeFactor, baseFeeID, quoteFeeID, baseToken, quoteToken, cexName } = this;
        const { commit, fees } = this.feesAndCommit();
        const bProj = emptyProjection();
        const qProj = emptyProjection();
        bProj.book = commit.dex.base.lots * lotSizeConv;
        qProj.book = commit.cex.base.lots * quoteLotConv;
        bProj.orderReserves = Math.max(commit.cex.base.val, commit.dex.base.val) * baseConfig.orderReservesFactor / baseFactor;
        qProj.orderReserves = Math.max(commit.cex.quote.val, commit.dex.quote.val) * quoteConfig.orderReservesFactor / quoteFactor;
        if (cexName) {
            bProj.cex = commit.cex.base.lots * lotSizeConv;
            qProj.cex = commit.cex.quote.lots * quoteLotConv;
        }
        bProj.bookingFees = fees.base.bookingFees / baseFeeFactor;
        qProj.bookingFees = fees.quote.bookingFees / quoteFeeFactor;
        if (baseToken)
            bProj.swapFeeReserves = fees.base.tokenFeesPerSwap * baseConfig.swapFeeN / baseFeeFactor;
        if (quoteToken)
            qProj.swapFeeReserves = fees.quote.tokenFeesPerSwap * quoteConfig.swapFeeN / quoteFeeFactor;
        qProj.slippageBuffer = (qProj.book + qProj.cex + qProj.orderReserves) * quoteConfig.slippageBufferFactor;
        const alloc = {};
        const addAlloc = (assetID, amt) => { var _a; alloc[assetID] = ((_a = alloc[assetID]) !== null && _a !== void 0 ? _a : 0) + amt; };
        addAlloc(baseID, Math.round((bProj.book + bProj.cex + bProj.orderReserves) * baseFactor));
        addAlloc(baseFeeID, Math.round((bProj.bookingFees + bProj.swapFeeReserves) * baseFeeFactor));
        addAlloc(quoteID, Math.round((qProj.book + qProj.cex + qProj.orderReserves + qProj.slippageBuffer) * quoteFactor));
        addAlloc(quoteFeeID, Math.round((qProj.bookingFees + qProj.swapFeeReserves) * quoteFeeFactor));
        return { qProj, bProj, alloc };
    }
    /*
     * fundingState examines the projected allocations and the user's wallet
     * balances to determine whether the user can fund the bot fully, unbalanced,
     * or starved, and what funding source options might be available.
     */
    fundingState() {
        const { proj: { bProj, qProj }, baseID, quoteID, baseFeeID, quoteFeeID, cfg: { uiConfig: { cexRebalance } }, cexName } = this;
        const { baseAvail, quoteAvail, dexBaseAvail, dexQuoteAvail, cexBaseAvail, cexQuoteAvail, dexBaseFeeAvail, dexQuoteFeeAvail } = this.adjustedBalances();
        const canRebalance = Boolean(cexName && cexRebalance);
        // Three possible states.
        // 1. We have the funding in the projection, and its in the right places.
        //    Give them some options for which wallet to pull order reserves from,
        //    but they can start immediately..
        // 2. We have the funding, but it's in the wrong place or the wrong asset,
        //    but we have deposits and withdraws enabled. We can offer them the
        //    option to start in an unbalanced state.
        // 3. We don't have the funds. We offer them an option to start in a
        //    starved state.
        const cexMinBaseAlloc = bProj.cex;
        let [dexMinBaseAlloc, transferableBaseAlloc, dexBaseFeeReq] = [bProj.book, 0, 0];
        // Only add booking fees if this is the fee asset.
        if (baseID === baseFeeID)
            dexMinBaseAlloc += bProj.bookingFees;
        // Base asset is a token.
        else
            dexBaseFeeReq += bProj.bookingFees + bProj.swapFeeReserves;
        // If we can rebalance, the order reserves could potentially be withdrawn.
        if (canRebalance)
            transferableBaseAlloc += bProj.orderReserves;
        // If we can't rebalance, order reserves are required in dex balance.
        else
            dexMinBaseAlloc += bProj.orderReserves;
        // Handle the special case where the base asset it the quote asset's fee
        // asset.
        if (baseID === quoteFeeID) {
            if (canRebalance)
                transferableBaseAlloc += qProj.bookingFees + qProj.swapFeeReserves;
            else
                dexMinBaseAlloc += qProj.bookingFees + qProj.swapFeeReserves;
        }
        let [dexMinQuoteAlloc, cexMinQuoteAlloc, transferableQuoteAlloc, dexQuoteFeeReq] = [qProj.book, qProj.cex, 0, 0];
        if (quoteID === quoteFeeID)
            dexMinQuoteAlloc += qProj.bookingFees;
        else
            dexQuoteFeeReq += qProj.bookingFees + qProj.swapFeeReserves;
        if (canRebalance)
            transferableQuoteAlloc += qProj.orderReserves + qProj.slippageBuffer;
        else {
            // The slippage reserves reserves should be split between cex and dex.
            dexMinQuoteAlloc += qProj.orderReserves;
            const basis = qProj.book + qProj.cex + qProj.orderReserves;
            dexMinQuoteAlloc += (qProj.book + qProj.orderReserves) / basis * qProj.slippageBuffer;
            cexMinQuoteAlloc += qProj.cex / basis * qProj.slippageBuffer;
        }
        if (quoteID === baseFeeID) {
            if (canRebalance)
                transferableQuoteAlloc += bProj.bookingFees + bProj.swapFeeReserves;
            else
                dexMinQuoteAlloc += bProj.bookingFees + bProj.swapFeeReserves;
        }
        const dexBaseFunded = dexBaseAvail >= dexMinBaseAlloc;
        const cexBaseFunded = cexBaseAvail >= cexMinBaseAlloc;
        const dexQuoteFunded = dexQuoteAvail >= dexMinQuoteAlloc;
        const cexQuoteFunded = cexQuoteAvail >= cexMinQuoteAlloc;
        const totalBaseReq = dexMinBaseAlloc + cexMinBaseAlloc + transferableBaseAlloc;
        const totalQuoteReq = dexMinQuoteAlloc + cexMinQuoteAlloc + transferableQuoteAlloc;
        const baseFundedAndBalanced = dexBaseFunded && cexBaseFunded && baseAvail >= totalBaseReq;
        const quoteFundedAndBalanced = dexQuoteFunded && cexQuoteFunded && quoteAvail >= totalQuoteReq;
        const baseFeesFunded = dexBaseFeeAvail >= dexBaseFeeReq;
        const quoteFeesFunded = dexQuoteFeeAvail >= dexQuoteFeeReq;
        const fundedAndBalanced = baseFundedAndBalanced && quoteFundedAndBalanced && baseFeesFunded && quoteFeesFunded;
        // Are we funded but not balanced, but able to rebalance with a cex?
        let fundedAndNotBalanced = !fundedAndBalanced;
        if (!fundedAndBalanced) {
            const ordersFunded = baseAvail >= totalBaseReq && quoteAvail >= totalQuoteReq;
            const feesFunded = baseFeesFunded && quoteFeesFunded;
            fundedAndNotBalanced = ordersFunded && feesFunded && canRebalance;
        }
        return {
            base: {
                dex: {
                    avail: dexBaseAvail,
                    req: dexMinBaseAlloc,
                    funded: dexBaseFunded
                },
                cex: {
                    avail: cexBaseAvail,
                    req: cexMinBaseAlloc,
                    funded: cexBaseFunded
                },
                transferable: transferableBaseAlloc,
                fees: {
                    avail: dexBaseFeeAvail,
                    req: dexBaseFeeReq,
                    funded: baseFeesFunded
                },
                fundedAndBalanced: baseFundedAndBalanced,
                fundedAndNotBalanced: !baseFundedAndBalanced && baseAvail >= totalBaseReq && canRebalance
            },
            quote: {
                dex: {
                    avail: dexQuoteAvail,
                    req: dexMinQuoteAlloc,
                    funded: dexQuoteFunded
                },
                cex: {
                    avail: cexQuoteAvail,
                    req: cexMinQuoteAlloc,
                    funded: cexQuoteFunded
                },
                transferable: transferableQuoteAlloc,
                fees: {
                    avail: dexQuoteFeeAvail,
                    req: dexQuoteFeeReq,
                    funded: quoteFeesFunded
                },
                fundedAndBalanced: quoteFundedAndBalanced,
                fundedAndNotBalanced: !quoteFundedAndBalanced && quoteAvail >= totalQuoteReq && canRebalance
            },
            fundedAndBalanced,
            fundedAndNotBalanced,
            starved: !fundedAndBalanced && !fundedAndNotBalanced
        };
    }
}
class RunningMarketMakerDisplay {
    constructor(div, forms, orderReportForm, page) {
        this.div = div;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(div);
        this.orderReportFormEl = orderReportForm;
        this.orderReportForm = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].idDescendants(orderReportForm);
        this.dexBalancesRowTmpl = this.orderReportForm.dexBalancesRowTmpl;
        this.placementRowTmpl = this.orderReportForm.placementRowTmpl;
        this.placementAmtRowTmpl = this.orderReportForm.placementAmtRowTmpl;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].cleanTemplates(this.dexBalancesRowTmpl, this.placementRowTmpl, this.placementAmtRowTmpl);
        this.forms = forms;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.page.stopBttn, 'click', () => this.stop());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.page.runLogsBttn, 'click', () => {
            const { mkt: { baseID, quoteID, host }, startTime } = this;
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmlogs', { baseID, quoteID, host, startTime, returnPage: page });
        });
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.page.buyOrdersBttn, 'click', () => this.showOrderReport('buys'));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.page.sellOrdersBttn, 'click', () => this.showOrderReport('sells'));
    }
    stop() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, mkt: { host, baseID, quoteID } } = this;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loading(page.stopBttn);
            yield MM.stopBot({ host, baseID: baseID, quoteID: quoteID });
            loaded();
        });
    }
    setMarket(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            const botStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.find(({ config: c }) => c.baseID === baseID && c.quoteID === quoteID && c.host === host);
            if (!botStatus)
                return;
            const mkt = new BotMarket(botStatus.config);
            yield mkt.initialize({});
            this.setBotMarket(mkt);
        });
    }
    setBotMarket(mkt) {
        var _a, _b, _c, _d, _e;
        return __awaiter(this, void 0, void 0, function* () {
            this.mkt = mkt;
            const { page, div, mkt: { host, baseID, quoteID, baseFeeID, quoteFeeID, cexName, baseFeeSymbol, quoteFeeSymbol, baseFeeTicker, quoteFeeTicker, cfg, baseFactor, quoteFactor } } = this;
            setMarketElements(div, baseID, quoteID, host);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID !== baseID, page.baseFeeReservesBox);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteFeeID !== quoteID, page.quoteFeeReservesBox);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(Boolean(cexName), ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(div, '[data-cex-show]'));
            page.baseFeeLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(baseFeeSymbol);
            page.baseFeeTicker.textContent = baseFeeTicker;
            page.quoteFeeLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(quoteFeeSymbol);
            page.quoteFeeTicker.textContent = quoteFeeTicker;
            const basicCfg = cfg.basicMarketMakingConfig;
            const gapStrategy = (_a = basicCfg === null || basicCfg === void 0 ? void 0 : basicCfg.gapStrategy) !== null && _a !== void 0 ? _a : GapStrategyPercent;
            let gapFactor = (_e = (_c = (_b = cfg.arbMarketMakingConfig) === null || _b === void 0 ? void 0 : _b.profit) !== null && _c !== void 0 ? _c : (_d = cfg.simpleArbConfig) === null || _d === void 0 ? void 0 : _d.profitTrigger) !== null && _e !== void 0 ? _e : 0;
            if (basicCfg) {
                const buys = [...basicCfg.buyPlacements].sort((a, b) => a.gapFactor - b.gapFactor);
                const sells = [...basicCfg.sellPlacements].sort((a, b) => a.gapFactor - b.gapFactor);
                if (buys.length > 0) {
                    if (sells.length > 0) {
                        gapFactor = (buys[0].gapFactor + sells[0].gapFactor) / 2;
                    }
                    else {
                        gapFactor = buys[0].gapFactor;
                    }
                }
                else
                    gapFactor = sells[0].gapFactor;
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.profitLabel, page.gapLabel, page.multiplierLabel, page.profitUnit, page.gapUnit, page.multiplierUnit);
            switch (gapStrategy) {
                case GapStrategyPercent:
                case GapStrategyPercentPlus:
                    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.profitLabel, page.profitUnit);
                    page.gapFactor.textContent = (gapFactor * 100).toFixed(2);
                    break;
                case GapStrategyMultiplier:
                    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.multiplierLabel, page.multiplierUnit);
                    page.gapFactor.textContent = (gapFactor * 100).toFixed(2);
                    break;
                default:
                    page.gapFactor.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(gapFactor / _orderutil__WEBPACK_IMPORTED_MODULE_3__.RateEncodingFactor * baseFactor / quoteFactor);
            }
            this.update();
            this.readBook();
        });
    }
    handleBalanceNote(n) {
        if (!this.mkt)
            return;
        const { baseID, quoteID, baseFeeID, quoteFeeID } = this.mkt;
        if (n.assetID !== baseID && n.assetID !== baseFeeID && n.assetID !== quoteID && n.assetID !== quoteFeeID)
            return;
        this.update();
    }
    handleEpochReportNote(n) {
        if (!this.mkt)
            return;
        const { baseID, quoteID, host } = this.mkt;
        if (n.baseID !== baseID || n.quoteID !== quoteID || n.host !== host)
            return;
        if (!n.report)
            return;
        this.latestEpoch = n.report;
        if (this.forms.currentForm === this.orderReportFormEl) {
            const orderReport = this.displayedSide === 'buys' ? n.report.buysReport : n.report.sellsReport;
            if (orderReport)
                this.updateOrderReport(orderReport, this.displayedSide, n.report.epochNum);
            else
                this.forms.close();
        }
        this.update();
    }
    handleCexProblemsNote(n) {
        if (!this.mkt)
            return;
        const { baseID, quoteID, host } = this.mkt;
        if (n.baseID !== baseID || n.quoteID !== quoteID || n.host !== host)
            return;
        this.cexProblems = n.problems;
        this.update();
    }
    setTicker() {
        this.page.runTime.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hmsSince(this.startTime);
    }
    update() {
        var _a, _b, _c, _d;
        const { div, page, mkt: { baseID, quoteID, baseFeeID, quoteFeeID, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor, marketReport: { baseFiatRate, quoteFiatRate } } } = this;
        // Get fresh stats
        const { botCfg: { cexName, basicMarketMakingConfig: bmmCfg }, runStats, latestEpoch, cexProblems } = this.mkt.status();
        if (latestEpoch)
            this.latestEpoch = latestEpoch;
        if (cexProblems)
            this.cexProblems = cexProblems;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.stats, page.cexRow, page.pendingDepositBox, page.pendingWithdrawalBox);
        if (!runStats) {
            if (this.ticker) {
                clearInterval(this.ticker);
                this.ticker = undefined;
            }
            return;
        }
        else if (!this.ticker) {
            this.startTime = runStats.startTime;
            this.setTicker();
            this.ticker = setInterval(() => this.setTicker(), 1000);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.stats);
        setSignedValue(runStats.profitLoss.profitRatio * 100, page.profit, page.profitSign, 2);
        setSignedValue(runStats.profitLoss.profit, page.profitLoss, page.plSign, 2);
        this.startTime = runStats.startTime;
        const summedBalance = (b) => {
            if (!b)
                return 0;
            return b.available + b.locked + b.pending + b.reserved;
        };
        const dexBaseInv = summedBalance(runStats.dexBalances[baseID]) / baseFactor;
        page.walletBaseInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexBaseInv);
        page.walletBaseInvFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexBaseInv * baseFiatRate, 2);
        const dexQuoteInv = summedBalance(runStats.dexBalances[quoteID]) / quoteFactor;
        page.walletQuoteInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexQuoteInv);
        page.walletQuoteInvFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexQuoteInv * quoteFiatRate, 2);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, page.cexRow);
        if (cexName) {
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.pendingDepositBox, page.pendingWithdrawalBox);
            setCexElements(div, cexName);
            const cexBaseInv = summedBalance(runStats.cexBalances[baseID]) / baseFactor;
            page.cexBaseInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexBaseInv);
            page.cexBaseInventoryFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexBaseInv * baseFiatRate, 2);
            const cexQuoteInv = summedBalance(runStats.cexBalances[quoteID]) / quoteFactor;
            page.cexQuoteInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexQuoteInv);
            page.cexQuoteInventoryFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexQuoteInv * quoteFiatRate, 2);
        }
        if (baseFeeID !== baseID) {
            const feeBalance = summedBalance(runStats.dexBalances[baseFeeID]) / baseFeeFactor;
            page.baseFeeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(feeBalance);
        }
        if (quoteFeeID !== quoteID) {
            const feeBalance = summedBalance(runStats.dexBalances[quoteFeeID]) / quoteFeeFactor;
            page.quoteFeeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(feeBalance);
        }
        page.pendingDeposits.textContent = String(Math.round(runStats.pendingDeposits));
        page.pendingWithdrawals.textContent = String(Math.round(runStats.pendingWithdrawals));
        page.completedMatches.textContent = String(Math.round(runStats.completedMatches));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(runStats.tradedUSD, page.tradedUSDBox);
        if (runStats.tradedUSD > 0)
            page.tradedUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(runStats.tradedUSD);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFiatRate, page.roundTripFeesBox);
        if (baseFiatRate)
            page.roundTripFeesUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs((((_a = runStats.feeGap) === null || _a === void 0 ? void 0 : _a.roundTripFees) / baseFactor * baseFiatRate) || 0);
        const basisPrice = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, ((_b = runStats.feeGap) === null || _b === void 0 ? void 0 : _b.basisPrice) || 0);
        page.basisPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(basisPrice);
        const displayFeeGap = !bmmCfg || bmmCfg.gapStrategy === GapStrategyAbsolutePlus || bmmCfg.gapStrategy === GapStrategyPercentPlus;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(displayFeeGap, page.feeGapBox);
        if (displayFeeGap) {
            const feeGap = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, ((_c = runStats.feeGap) === null || _c === void 0 ? void 0 : _c.feeGap) || 0);
            page.feeGap.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(feeGap);
            page.feeGapPct.textContent = (feeGap / basisPrice * 100 || 0).toFixed(2);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(bmmCfg, page.gapStrategyBox);
        if (bmmCfg)
            page.gapStrategy.textContent = bmmCfg.gapStrategy;
        const remoteGap = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, ((_d = runStats.feeGap) === null || _d === void 0 ? void 0 : _d.remoteGap) || 0);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(remoteGap, page.remoteGapBox);
        if (remoteGap) {
            page.remoteGap.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(remoteGap);
            page.remoteGapPct.textContent = (remoteGap / basisPrice * 100 || 0).toFixed(2);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(latestEpoch === null || latestEpoch === void 0 ? void 0 : latestEpoch.buysReport, page.buyOrdersReportBox);
        if (latestEpoch === null || latestEpoch === void 0 ? void 0 : latestEpoch.buysReport) {
            const allPlaced = allOrdersPlaced(latestEpoch.buysReport);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(allPlaced, page.buyOrdersSuccess);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!allPlaced, page.buyOrdersFailed);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(latestEpoch === null || latestEpoch === void 0 ? void 0 : latestEpoch.sellsReport, page.sellOrdersReportBox);
        if (latestEpoch === null || latestEpoch === void 0 ? void 0 : latestEpoch.sellsReport) {
            const allPlaced = allOrdersPlaced(latestEpoch.sellsReport);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(allPlaced, page.sellOrdersSuccess);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!allPlaced, page.sellOrdersFailed);
        }
        const preOrderProblemMessages = botProblemMessages(latestEpoch === null || latestEpoch === void 0 ? void 0 : latestEpoch.preOrderProblems, this.mkt.cexName, this.mkt.host);
        const cexErrorMessages = cexProblemMessages(this.cexProblems);
        const allMessages = [...preOrderProblemMessages, ...cexErrorMessages];
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(allMessages.length > 0, page.preOrderProblemsBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].empty(page.preOrderProblemsBox);
        for (const msg of allMessages) {
            const spanEl = document.createElement('span');
            spanEl.textContent = `- ${msg}`;
            page.preOrderProblemsBox.appendChild(spanEl);
        }
    }
    updateOrderReport(report, side, epochNum) {
        const form = this.orderReportForm;
        const sideTxt = side === 'buys' ? _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_BUY) : _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SELL);
        form.orderReportTitle.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ORDER_REPORT_TITLE, { side: sideTxt, epochNum: `${epochNum}` });
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(report.error, form.orderReportError);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!report.error, form.orderReportDetails);
        if (report.error) {
            const problemMessages = botProblemMessages(report.error, this.mkt.cexName, this.mkt.host);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].empty(form.orderReportError);
            for (const msg of problemMessages) {
                const spanEl = document.createElement('span');
                spanEl.textContent = `- ${msg}`;
                form.orderReportError.appendChild(spanEl);
            }
            return;
        }
        form.cexLogo.src = CEXDisplayInfos[this.mkt.cexName].logo;
        form.cexBalancesTitle.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CEX_BALANCES, { cexName: CEXDisplayInfos[this.mkt.cexName].name });
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].empty(form.dexBalancesBody, form.placementsBody);
        const createRow = (assetID) => {
            const row = this.dexBalancesRowTmpl.cloneNode(true);
            const rowTmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(row);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
            rowTmpl.asset.textContent = asset.symbol.toUpperCase();
            rowTmpl.assetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(asset.symbol);
            const unitInfo = asset.unitInfo;
            const available = report.availableDexBals[assetID] ? report.availableDexBals[assetID].available : 0;
            const required = report.requiredDexBals[assetID] ? report.requiredDexBals[assetID] : 0;
            const remaining = report.remainingDexBals[assetID] ? report.remainingDexBals[assetID] : 0;
            const pending = report.availableDexBals[assetID] ? report.availableDexBals[assetID].pending : 0;
            const locked = report.availableDexBals[assetID] ? report.availableDexBals[assetID].locked : 0;
            const used = report.usedDexBals[assetID] ? report.usedDexBals[assetID] : 0;
            rowTmpl.available.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(available, unitInfo);
            rowTmpl.locked.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(locked, unitInfo);
            rowTmpl.required.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(required, unitInfo);
            rowTmpl.remaining.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(remaining, unitInfo);
            rowTmpl.pending.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(pending, unitInfo);
            rowTmpl.used.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(used, unitInfo);
            const deficiency = safeSub(required, available);
            rowTmpl.deficiency.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(deficiency, unitInfo);
            if (deficiency > 0)
                rowTmpl.deficiency.classList.add('text-danger');
            const deficiencyWithPending = safeSub(deficiency, pending);
            rowTmpl.deficiencyWithPending.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(deficiencyWithPending, unitInfo);
            if (deficiencyWithPending > 0)
                rowTmpl.deficiencyWithPending.classList.add('text-danger');
            return [row, deficiency];
        };
        const setDeficiencyVisibility = (deficiency, rows) => {
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(deficiency, form.dexDeficiencyHeader, form.dexDeficiencyWithPendingHeader);
            for (const row of rows) {
                const rowTmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(row);
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(deficiency, rowTmpl.deficiency, rowTmpl.deficiencyWithPending);
            }
        };
        const assetIDs = [this.mkt.baseID, this.mkt.quoteID];
        if (!assetIDs.includes(this.mkt.baseFeeID))
            assetIDs.push(this.mkt.baseFeeID);
        if (!assetIDs.includes(this.mkt.quoteFeeID))
            assetIDs.push(this.mkt.quoteFeeID);
        let totalDeficiency = 0;
        const rows = [];
        for (const assetID of assetIDs) {
            const [row, deficiency] = createRow(assetID);
            totalDeficiency += deficiency;
            form.dexBalancesBody.appendChild(row);
            rows.push(row);
        }
        setDeficiencyVisibility(totalDeficiency > 0, rows);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(this.mkt.cexName, form.cexBalancesTable, form.counterTradeRateHeader);
        let cexAsset;
        if (this.mkt.cexName) {
            const cexAssetID = side === 'buys' ? this.mkt.baseID : this.mkt.quoteID;
            cexAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[cexAssetID];
            form.cexAsset.textContent = cexAsset.symbol.toUpperCase();
            form.cexAssetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(cexAsset.symbol);
            const availableCexBal = report.availableCexBal ? report.availableCexBal.available : 0;
            const requiredCexBal = report.requiredCexBal ? report.requiredCexBal : 0;
            const remainingCexBal = report.remainingCexBal ? report.remainingCexBal : 0;
            const pendingCexBal = report.availableCexBal ? report.availableCexBal.pending : 0;
            const reservedCexBal = report.availableCexBal ? report.availableCexBal.reserved : 0;
            const usedCexBal = report.usedCexBal ? report.usedCexBal : 0;
            const deficiencyCexBal = safeSub(requiredCexBal, availableCexBal);
            const deficiencyWithPendingCexBal = safeSub(deficiencyCexBal, pendingCexBal);
            form.cexAvailable.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(availableCexBal, cexAsset.unitInfo);
            form.cexLocked.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(reservedCexBal, cexAsset.unitInfo);
            form.cexRequired.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(requiredCexBal, cexAsset.unitInfo);
            form.cexRemaining.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(remainingCexBal, cexAsset.unitInfo);
            form.cexPending.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(pendingCexBal, cexAsset.unitInfo);
            form.cexUsed.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(usedCexBal, cexAsset.unitInfo);
            const deficient = deficiencyCexBal > 0;
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(deficient, form.cexDeficiencyHeader, form.cexDeficiencyWithPendingHeader, form.cexDeficiency, form.cexDeficiencyWithPending);
            if (deficient) {
                form.cexDeficiency.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(deficiencyCexBal, cexAsset.unitInfo);
                form.cexDeficiencyWithPending.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(deficiencyWithPendingCexBal, cexAsset.unitInfo);
            }
        }
        let anyErrors = false;
        for (const placement of report.placements)
            if (placement.error) {
                anyErrors = true;
                break;
            }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(anyErrors, form.errorHeader);
        const createPlacementRow = (placement, priority) => {
            const row = this.placementRowTmpl.cloneNode(true);
            const rowTmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(row);
            const baseUI = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.mkt.baseID].unitInfo;
            const quoteUI = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.mkt.quoteID].unitInfo;
            rowTmpl.priority.textContent = String(priority);
            rowTmpl.rate.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatRateFullPrecision(placement.rate, baseUI, quoteUI, this.mkt.rateStep);
            rowTmpl.lots.textContent = String(placement.lots);
            rowTmpl.standingLots.textContent = String(placement.standingLots);
            rowTmpl.orderedLots.textContent = String(placement.orderedLots);
            if (placement.standingLots + placement.orderedLots < placement.lots) {
                rowTmpl.lots.classList.add('text-danger');
                rowTmpl.standingLots.classList.add('text-danger');
                rowTmpl.orderedLots.classList.add('text-danger');
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(placement.counterTradeRate > 0, rowTmpl.counterTradeRate);
            rowTmpl.counterTradeRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatRateFullPrecision(placement.counterTradeRate, baseUI, quoteUI, this.mkt.rateStep);
            for (const assetID of assetIDs) {
                const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
                const unitInfo = asset.unitInfo;
                const requiredAmt = placement.requiredDex[assetID] ? placement.requiredDex[assetID] : 0;
                const usedAmt = placement.usedDex[assetID] ? placement.usedDex[assetID] : 0;
                const requiredRow = this.placementAmtRowTmpl.cloneNode(true);
                const requiredRowTmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(requiredRow);
                const usedRow = this.placementAmtRowTmpl.cloneNode(true);
                const usedRowTmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(usedRow);
                requiredRowTmpl.amt.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(requiredAmt, unitInfo);
                requiredRowTmpl.assetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(asset.symbol);
                requiredRowTmpl.assetSymbol.textContent = asset.symbol.toUpperCase();
                usedRowTmpl.amt.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(usedAmt, unitInfo);
                usedRowTmpl.assetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(asset.symbol);
                usedRowTmpl.assetSymbol.textContent = asset.symbol.toUpperCase();
                rowTmpl.requiredDEX.appendChild(requiredRow);
                rowTmpl.usedDEX.appendChild(usedRow);
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(this.mkt.cexName, rowTmpl.requiredCEX, rowTmpl.usedCEX);
            if (this.mkt.cexName) {
                const requiredAmt = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(placement.requiredCex, cexAsset.unitInfo);
                rowTmpl.requiredCEX.textContent = `${requiredAmt} ${cexAsset.symbol.toUpperCase()}`;
                const usedAmt = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue(placement.usedCex, cexAsset.unitInfo);
                rowTmpl.usedCEX.textContent = `${usedAmt} ${cexAsset.symbol.toUpperCase()}`;
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(anyErrors, rowTmpl.error);
            if (placement.error) {
                const errMessages = botProblemMessages(placement.error, this.mkt.cexName, this.mkt.host);
                rowTmpl.error.textContent = errMessages.join('\n');
            }
            return row;
        };
        for (let i = 0; i < report.placements.length; i++) {
            form.placementsBody.appendChild(createPlacementRow(report.placements[i], i + 1));
        }
    }
    showOrderReport(side) {
        if (!this.latestEpoch)
            return;
        const report = side === 'buys' ? this.latestEpoch.buysReport : this.latestEpoch.sellsReport;
        if (!report)
            return;
        this.updateOrderReport(report, side, this.latestEpoch.epochNum);
        this.displayedSide = side;
        this.forms.show(this.orderReportFormEl);
    }
    readBook() {
        if (!this.mkt)
            return;
        const { page, mkt: { host, mktID } } = this;
        const orders = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].markets[mktID].orders || [];
        page.nBookedOrders.textContent = String(orders.filter((ord) => ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_3__.StatusBooked).length);
    }
}
function allOrdersPlaced(report) {
    if (report.error)
        return false;
    for (let i = 0; i < report.placements.length; i++) {
        const placement = report.placements[i];
        if (placement.orderedLots + placement.standingLots < placement.lots)
            return false;
        if (placement.error)
            return false;
    }
    return true;
}
function setSignedValue(v, vEl, signEl, maxDecimals) {
    vEl.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(v, maxDecimals);
    signEl.classList.toggle('ico-plus', v > 0);
    signEl.classList.toggle('text-good', v > 0);
    // signEl.classList.toggle('ico-minus', v < 0)
}
function feesAndCommit(baseID, quoteID, baseFees, quoteFees, lotSize, baseLots, quoteLots, baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker, baseOrderReservesFactor, quoteOrderReservesFactor) {
    const quoteLot = calculateQuoteLot(lotSize, baseID, quoteID);
    const [cexBaseLots, cexQuoteLots] = [quoteLots, baseLots];
    const commit = {
        dex: {
            base: {
                lots: baseLots,
                val: baseLots * lotSize
            },
            quote: {
                lots: quoteLots,
                val: quoteLots * quoteLot
            }
        },
        cex: {
            base: {
                lots: cexBaseLots,
                val: cexBaseLots * lotSize
            },
            quote: {
                lots: cexQuoteLots,
                val: cexQuoteLots * quoteLot
            }
        }
    };
    let baseTokenFeesPerSwap = 0;
    let baseRedeemReservesPerLot = 0;
    if (baseID !== baseFeeID) { // token
        baseTokenFeesPerSwap += baseFees.estimated.swap;
        if (baseFeeID === quoteFeeID)
            baseTokenFeesPerSwap += quoteFees.estimated.redeem;
    }
    let baseBookingFeesPerLot = baseFees.max.swap;
    if (baseID === quoteFeeID)
        baseBookingFeesPerLot += quoteFees.max.redeem;
    if (baseIsAccountLocker) {
        baseBookingFeesPerLot += baseFees.max.refund;
        if (!quoteIsAccountLocker && baseFeeID !== quoteFeeID)
            baseRedeemReservesPerLot = baseFees.max.redeem;
    }
    let quoteTokenFeesPerSwap = 0;
    let quoteRedeemReservesPerLot = 0;
    if (quoteID !== quoteFeeID) {
        quoteTokenFeesPerSwap += quoteFees.estimated.swap;
        if (quoteFeeID === baseFeeID)
            quoteTokenFeesPerSwap += baseFees.estimated.redeem;
    }
    let quoteBookingFeesPerLot = quoteFees.max.swap;
    if (quoteID === baseFeeID)
        quoteBookingFeesPerLot += baseFees.max.redeem;
    if (quoteIsAccountLocker) {
        quoteBookingFeesPerLot += quoteFees.max.refund;
        if (!baseIsAccountLocker && quoteFeeID !== baseFeeID)
            quoteRedeemReservesPerLot = quoteFees.max.redeem;
    }
    const baseReservesFactor = 1 + baseOrderReservesFactor;
    const quoteReservesFactor = 1 + quoteOrderReservesFactor;
    const baseBookingFees = (baseBookingFeesPerLot * baseLots) * baseReservesFactor;
    const baseRedeemFees = (baseRedeemReservesPerLot * quoteLots) * quoteReservesFactor;
    const quoteBookingFees = (quoteBookingFeesPerLot * quoteLots) * quoteReservesFactor;
    const quoteRedeemFees = (quoteRedeemReservesPerLot * baseLots) * baseReservesFactor;
    const fees = {
        base: Object.assign(Object.assign({}, baseFees), { bookingFeesPerLot: baseBookingFeesPerLot, bookingFeesPerCounterLot: baseRedeemReservesPerLot, bookingFees: baseBookingFees + baseRedeemFees, swapReservesFactor: baseReservesFactor, redeemReservesFactor: quoteReservesFactor, tokenFeesPerSwap: baseTokenFeesPerSwap }),
        quote: Object.assign(Object.assign({}, quoteFees), { bookingFeesPerLot: quoteBookingFeesPerLot, bookingFeesPerCounterLot: quoteRedeemReservesPerLot, bookingFees: quoteBookingFees + quoteRedeemFees, swapReservesFactor: quoteReservesFactor, redeemReservesFactor: baseReservesFactor, tokenFeesPerSwap: quoteTokenFeesPerSwap })
    };
    return { commit, fees };
}
function botProblemMessages(problems, cexName, dexHost) {
    if (!problems)
        return [];
    const msgs = [];
    if (problems.walletNotSynced) {
        for (const [assetID, notSynced] of Object.entries(problems.walletNotSynced)) {
            if (notSynced) {
                msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_NOT_SYNCED, { assetSymbol: (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[Number(assetID)].symbol.toUpperCase() }));
            }
        }
    }
    if (problems.noWalletPeers) {
        for (const [assetID, noPeers] of Object.entries(problems.noWalletPeers)) {
            if (noPeers) {
                msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_NO_PEERS, { assetSymbol: (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[Number(assetID)].symbol.toUpperCase() }));
            }
        }
    }
    if (problems.accountSuspended) {
        msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ACCOUNT_SUSPENDED, { dexHost: dexHost }));
    }
    if (problems.userLimitTooLow) {
        msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_USER_LIMIT_TOO_LOW, { dexHost: dexHost }));
    }
    if (problems.noPriceSource) {
        msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NO_PRICE_SOURCE));
    }
    if (problems.cexOrderbookUnsynced) {
        msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CEX_ORDERBOOK_UNSYNCED, { cexName: cexName }));
    }
    if (problems.causesSelfMatch) {
        msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CAUSES_SELF_MATCH));
    }
    return msgs;
}
function cexProblemMessages(problems) {
    if (!problems)
        return [];
    const msgs = [];
    if (problems.depositErr) {
        for (const [assetID, depositErr] of Object.entries(problems.depositErr)) {
            msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_DEPOSIT_ERROR, {
                assetSymbol: (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[Number(assetID)].symbol.toUpperCase(),
                time: new Date(depositErr.stamp * 1000).toLocaleString(),
                error: depositErr.error
            }));
        }
    }
    if (problems.withdrawErr) {
        for (const [assetID, withdrawErr] of Object.entries(problems.withdrawErr)) {
            msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WITHDRAW_ERROR, {
                assetSymbol: (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[Number(assetID)].symbol.toUpperCase(),
                time: new Date(withdrawErr.stamp * 1000).toLocaleString(),
                error: withdrawErr.error
            }));
        }
    }
    if (problems.tradeErr) {
        msgs.push(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CEX_TRADE_ERROR, {
            time: new Date(problems.tradeErr.stamp * 1000).toLocaleString(),
            error: problems.tradeErr.error
        }));
    }
    return msgs;
}
function safeSub(a, b) {
    return a - b > 0 ? a - b : 0;
}
window.mmstatus = function () {
    return MM.status();
};


/***/ }),

/***/ "./src/js/notifications.ts":
/*!*********************************!*\
  !*** ./src/js/notifications.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DATA": () => (/* binding */ DATA),
/* harmony export */   "ERROR": () => (/* binding */ ERROR),
/* harmony export */   "IGNORE": () => (/* binding */ IGNORE),
/* harmony export */   "Notifier": () => (/* binding */ Notifier),
/* harmony export */   "POKE": () => (/* binding */ POKE),
/* harmony export */   "SUCCESS": () => (/* binding */ SUCCESS),
/* harmony export */   "WARNING": () => (/* binding */ WARNING),
/* harmony export */   "defaultDesktopNtfnSettings": () => (/* binding */ defaultDesktopNtfnSettings),
/* harmony export */   "desktopNotify": () => (/* binding */ desktopNotify),
/* harmony export */   "desktopNtfnLabels": () => (/* binding */ desktopNtfnLabels),
/* harmony export */   "fetchDesktopNtfnSettings": () => (/* binding */ fetchDesktopNtfnSettings),
/* harmony export */   "insertRichNote": () => (/* binding */ insertRichNote),
/* harmony export */   "make": () => (/* binding */ make),
/* harmony export */   "plainNote": () => (/* binding */ plainNote),
/* harmony export */   "updateNtfnSetting": () => (/* binding */ updateNtfnSetting)
/* harmony export */ });
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




const IGNORE = 0;
const DATA = 1;
const POKE = 2;
const SUCCESS = 3;
const WARNING = 4;
const ERROR = 5;
/*
 * make constructs a new notification. The notification structure is a mirror of
 * the structure of notifications sent from the web server.
 * NOTE: I'm hoping to make this function obsolete, since errors generated in
 * javascript should usually be displayed/cached somewhere better. For example,
 * if the error is generated during submission of a form, the error should be
 * displayed on or near the form itself, not in the notifications.
 */
function make(subject, details, severity) {
    return {
        subject: subject,
        details: details,
        severity: severity,
        stamp: new Date().getTime(),
        acked: false,
        type: 'internal',
        topic: 'internal',
        id: ''
    };
}
const NoteTypeOrder = 'order';
const NoteTypeMatch = 'match';
const NoteTypeBondPost = 'bondpost';
const NoteTypeConnEvent = 'conn';
function desktopNtfnSettingsKey() {
    return `desktop_notifications-${window.location.host}`;
}
const desktopNtfnLabels = {
    [NoteTypeOrder]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ORDERS,
    [NoteTypeMatch]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_MATCHES,
    [NoteTypeBondPost]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_BONDS,
    [NoteTypeConnEvent]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_CONNECTIONS
};
const defaultDesktopNtfnSettings = {
    [NoteTypeOrder]: true,
    [NoteTypeMatch]: true,
    [NoteTypeBondPost]: true,
    [NoteTypeConnEvent]: true
};
let desktopNtfnSettings;
// BrowserNotifier is a wrapper around the browser's notification API.
class BrowserNotifier {
    static ntfnPermissionGranted() {
        return window.Notification.permission === 'granted';
    }
    static ntfnPermissionDenied() {
        return window.Notification.permission === 'denied';
    }
    static requestNtfnPermission() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!('Notification' in window)) {
                return;
            }
            if (BrowserNotifier.ntfnPermissionGranted()) {
                BrowserNotifier.sendDesktopNotification(_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ENABLED));
            }
            else if (!BrowserNotifier.ntfnPermissionDenied()) {
                yield Notification.requestPermission();
                BrowserNotifier.sendDesktopNotification(_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ENABLED));
            }
        });
    }
    static sendDesktopNotification(title, body) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!BrowserNotifier.ntfnPermissionGranted())
                return;
            const ntfn = new window.Notification(title, {
                body: body,
                icon: '/img/softened-icon.png'
            });
            return ntfn;
        });
    }
}
// OSDesktopNotifier manages OS desktop notifications via the same interface
// as BrowserNotifier, but sends notifications using an underlying Go
// notification library exposed to the webview.
class OSDesktopNotifier {
    static ntfnPermissionGranted() {
        return true;
    }
    static ntfnPermissionDenied() {
        return false;
    }
    static requestNtfnPermission() {
        return __awaiter(this, void 0, void 0, function* () {
            yield OSDesktopNotifier.sendDesktopNotification(_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ENABLED));
            return Promise.resolve();
        });
    }
    static sendDesktopNotification(title, body) {
        return __awaiter(this, void 0, void 0, function* () {
            // webview/linux or webview/windows
            if (isDesktopWebview())
                yield window.sendOSNotification(title, body);
            // webkit/darwin
            // See: client/cmd/bisonw-desktop/app_darwin.go#L673-#L697
            else if (isDesktopWebkit())
                yield window.webkit.messageHandlers.bwHandler.postMessage(['sendOSNotification', title, body]);
            else
                console.error('sendDesktopNotification: unknown environment');
        });
    }
}
// isDesktopWebview checks if we are running in webview
function isDesktopWebview() {
    return window.isWebview !== undefined;
}
// isDesktopDarwin returns true if we are running in a webview on darwin
// It tests for the existence of the bwHandler webkit message handler.
function isDesktopWebkit() {
    var _a, _b;
    return ((_b = (_a = window.webkit) === null || _a === void 0 ? void 0 : _a.messageHandlers) === null || _b === void 0 ? void 0 : _b.bwHandler) !== undefined;
}
// determine whether we're running in a webview or in browser, and export
// the appropriate notifier accordingly.
const Notifier = isDesktopWebview() || isDesktopWebkit() ? OSDesktopNotifier : BrowserNotifier;
function desktopNotify(note) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!desktopNtfnSettings.browserNtfnEnabled || !desktopNtfnSettings[note.type])
            return;
        yield Notifier.sendDesktopNotification(note.subject, plainNote(note.details));
    });
}
function fetchDesktopNtfnSettings() {
    var _a;
    if (desktopNtfnSettings !== undefined) {
        return desktopNtfnSettings;
    }
    const k = desktopNtfnSettingsKey();
    desktopNtfnSettings = ((_a = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(k)) !== null && _a !== void 0 ? _a : {});
    return desktopNtfnSettings;
}
function updateNtfnSetting(noteType, enabled) {
    fetchDesktopNtfnSettings();
    desktopNtfnSettings[noteType] = enabled;
    _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(desktopNtfnSettingsKey(), desktopNtfnSettings);
}
const coinExplorerTokenRe = /\{\{\{([^|]+)\|([^}]+)\}\}\}/g;
const orderTokenRe = /\{\{\{order\|([^}]+)\}\}\}/g;
/*
 * insertRichNote replaces tx and order hash tokens in the input string with
 * <a> elements that link to the asset's chain explorer and order details
 * view, and inserts the resulting HTML into the supplied parent element.
 */
function insertRichNote(parent, inputString) {
    const s = inputString.replace(orderTokenRe, (_match, orderToken) => {
        const link = document.createElement('a');
        link.setAttribute('href', '/order/' + orderToken);
        link.setAttribute('class', 'subtlelink');
        link.textContent = orderToken.slice(0, 8);
        return link.outerHTML;
    }).replace(coinExplorerTokenRe, (_match, assetID, hash) => {
        const link = document.createElement('a');
        link.setAttribute('data-explorer-coin', hash);
        link.setAttribute('target', '_blank');
        link.textContent = hash.slice(0, 8);
        (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_2__.setCoinHref)(assetID, link);
        return link.outerHTML;
    });
    const els = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].noderize(s).body;
    while (els.firstChild)
        parent.appendChild(els.firstChild);
}
/*
 * plainNote replaces tx and order hash tokens tokens in the input string with
 * shortened hashes, for rendering in browser notifications and popups.
 */
function plainNote(inputString) {
    const replacedString = inputString.replace(coinExplorerTokenRe, (_match, _assetID, hash) => {
        return hash.slice(0, 8);
    });
    return replacedString;
}


/***/ }),

/***/ "./src/js/opts.ts":
/*!************************!*\
  !*** ./src/js/opts.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BooleanOption": () => (/* binding */ BooleanOption),
/* harmony export */   "Option": () => (/* binding */ Option),
/* harmony export */   "XYRangeHandler": () => (/* binding */ XYRangeHandler),
/* harmony export */   "XYRangeOption": () => (/* binding */ XYRangeOption),
/* harmony export */   "setOptionTemplates": () => (/* binding */ setOptionTemplates)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");

// Having the caller set these vars on load using an exported function makes
// life easier.
let orderOptTmpl, booleanOptTmpl, rangeOptTmpl;
// setOptionTemplates sets the package vars for the templates and application.
function setOptionTemplates(page) {
    [booleanOptTmpl, rangeOptTmpl, orderOptTmpl] = [page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl];
}
const threeSigFigs = new Intl.NumberFormat(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
    minimumSignificantDigits: 3,
    maximumSignificantDigits: 3
});
/*
 * Option is a base class for option elements. Option stores some common
 * parameters and monitors the toggle switch, calling the child class's
 * enable/disable methods when the user manually turns the option on or off.
 */
class Option {
    constructor(opt, symbol, report) {
        this.opt = opt;
        const node = this.node = orderOptTmpl.cloneNode(true);
        const tmpl = this.tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(node);
        tmpl.optName.textContent = opt.displayname;
        tmpl.tooltip.dataset.tooltip = opt.description;
        // const isBaseChain = (isSwapOption && order.sell) || (!isSwapOption && !order.sell)
        // const symbol = isBaseChain ? this.baseSymbol() : this.quoteSymbol()
        if (symbol)
            tmpl.chainIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.chainIcon);
        this.on = false;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(node, 'click', () => {
            if (this.on)
                return;
            this.on = true;
            node.classList.add('selected');
            report.enable();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.toggle, 'click', e => {
            if (!this.on)
                return;
            e.stopPropagation();
            this.on = false;
            node.classList.remove('selected');
            report.disable();
        });
    }
}
/*
 * BooleanOption is a simple on/off option with a short summary of it's effects.
 * BooleanOrderOption is the handler for a *BooleanConfig from client/asset.
 */
class BooleanOption extends Option {
    constructor(opt, symbol, dict, changed) {
        super(opt, symbol, {
            enable: () => this.enable(),
            disable: () => this.disable()
        });
        this.dict = dict;
        this.changed = () => changed();
        if (opt.boolean === undefined)
            throw Error('not a boolean opt');
        const cfg = opt.boolean;
        const control = this.control = booleanOptTmpl.cloneNode(true);
        // Append to parent's options div.
        this.tmpl.controls.appendChild(control);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(control);
        tmpl.reason.textContent = cfg.reason;
        this.on = typeof dict[opt.key] !== 'undefined' ? dict[opt.key] : opt.default;
        if (this.on)
            this.node.classList.add('selected');
    }
    store() {
        if (this.on === this.opt.default)
            delete this.dict[this.opt.key];
        else
            this.dict[this.opt.key] = this.on;
        this.changed();
    }
    enable() {
        this.store();
    }
    disable() {
        this.store();
    }
}
/*
 * XYRangeOption is an order option that contains an XYRangeHandler. The logic
 * for handling the slider to is defined in XYRangeHandler so that the slider
 * can be used without being contained in an order option.
 */
class XYRangeOption extends Option {
    constructor(opt, symbol, dict, changed) {
        super(opt, symbol, {
            enable: () => this.enable(),
            disable: () => this.disable()
        });
        this.dict = dict;
        this.changed = changed;
        if (opt.xyRange === undefined)
            throw Error('not an xy range opt');
        const cfg = opt.xyRange;
        const setVal = dict[opt.key];
        this.on = typeof setVal !== 'undefined';
        if (this.on) {
            this.node.classList.add('selected');
            this.x = setVal;
        }
        else {
            this.x = opt.default;
        }
        const selected = () => { this.node.classList.add('selected'); };
        this.handler = new XYRangeHandler(cfg, this.x, { changed, selected, settingsDict: dict, settingsKey: opt.key });
        this.tmpl.controls.appendChild(this.handler.control);
    }
    enable() {
        this.dict[this.opt.key] = this.x;
        this.changed();
    }
    disable() {
        delete this.dict[this.opt.key];
        this.changed();
    }
    setValue(x) {
        this.handler.setValue(x);
        this.on = true;
        this.node.classList.add('selected');
    }
}
/*
 * XYRangeHandler is the handler for an *XYRange from client/asset. XYRange
 * has a slider which allows adjusting the x and y, linearly between two limits.
 * The user can also manually enter values for x or y.
 */
class XYRangeHandler {
    constructor(range, initVal, opts) {
        var _a, _b, _c, _d;
        const control = this.control = rangeOptTmpl.cloneNode(true);
        const tmpl = this.tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(control);
        tmpl.rangeLblStart.textContent = range.start.label;
        tmpl.rangeLblEnd.textContent = range.end.label;
        tmpl.xUnit.textContent = range.xUnit;
        tmpl.yUnit.textContent = range.yUnit;
        this.range = range;
        this.initVal = initVal;
        this.settingsDict = opts.settingsDict;
        this.settingsKey = (_a = opts.settingsKey) !== null && _a !== void 0 ? _a : '';
        this.roundX = Boolean(opts.roundX);
        this.roundY = Boolean(opts.roundY);
        this.setDisabled(Boolean(opts.disabled));
        this.changed = (_b = opts.changed) !== null && _b !== void 0 ? _b : (() => { });
        this.selected = (_c = opts.selected) !== null && _c !== void 0 ? _c : (() => { });
        this.updated = (_d = opts.updated) !== null && _d !== void 0 ? _d : (() => { });
        this.convert = opts.convert || ((x) => x);
        const { slider, handle } = tmpl;
        const rangeX = range.end.x - range.start.x;
        const rangeY = range.end.y - range.start.y;
        const normalizeX = (x) => (x - range.start.x) / rangeX;
        // r, x, and y will be updated by the various input event handlers. r is
        // x (or y) normalized on its range, e.g. [x_min, x_max] -> [0, 1]
        this.r = normalizeX(initVal);
        this.scrollingX = this.x = initVal;
        this.y = this.r * rangeY + range.start.y;
        this.accept(this.scrollingX, { skipUpdate: true });
        // Set up the handlers for the x and y text input fields.
        const clickOutX = (e) => {
            if (this.disabled)
                return;
            if (e.type !== 'change' && e.target === tmpl.xInput)
                return;
            const s = tmpl.xInput.value;
            if (s) {
                const xx = parseFloat(s);
                if (!isNaN(xx)) {
                    this.scrollingX = clamp(xx, range.start.x, range.end.x);
                    this.r = normalizeX(this.scrollingX);
                    this.y = this.r * rangeY + range.start.y;
                    this.accept(this.scrollingX);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.xInput);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.x);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'click', clickOutX);
            this.changed();
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.x, 'click', e => {
            if (this.disabled)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.x);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.xInput);
            tmpl.xInput.focus();
            tmpl.xInput.value = threeSigFigs.format(this.scrollingX);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'click', clickOutX);
            e.stopPropagation();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.xInput, 'change', clickOutX);
        const clickOutY = (e) => {
            if (this.disabled)
                return;
            if (e.type !== 'change' && e.target === tmpl.yInput)
                return;
            const s = tmpl.yInput.value;
            if (s) {
                const yy = parseFloat(s);
                if (!isNaN(yy)) {
                    this.y = clamp(yy, range.start.y, range.end.y);
                    this.r = (this.y - range.start.y) / rangeY;
                    this.scrollingX = range.start.x + this.r * rangeX;
                    this.accept(this.scrollingX);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.yInput);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.y);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'click', clickOutY);
            this.changed();
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.y, 'click', e => {
            if (this.disabled)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.y);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.yInput);
            tmpl.yInput.focus();
            tmpl.yInput.value = threeSigFigs.format(this.y);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'click', clickOutY);
            e.stopPropagation();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.yInput, 'change', clickOutY);
        // Read the slider.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(handle, 'mousedown', (e) => {
            if (this.disabled)
                return;
            if (e.button !== 0)
                return;
            e.preventDefault();
            e.stopPropagation();
            this.selected();
            const startX = e.pageX;
            const w = slider.clientWidth - handle.offsetWidth;
            const startLeft = normalizeX(this.scrollingX) * w;
            const left = (ee) => Math.max(Math.min(startLeft + (ee.pageX - startX), w), 0);
            const trackMouse = (ee, emit) => {
                ee.preventDefault();
                this.r = left(ee) / w;
                this.scrollingX = this.r * rangeX + range.start.x;
                this.y = this.r * rangeY + range.start.y;
                this.accept(this.scrollingX, { skipChange: !emit });
            };
            const mouseUp = (ee) => {
                trackMouse(ee, true);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'mousemove', trackMouse);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'mouseup', mouseUp);
                this.changed();
            };
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'mousemove', trackMouse);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'mouseup', mouseUp);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.sliderBox, 'click', (e) => {
            if (this.disabled)
                return;
            if (e.button !== 0)
                return;
            const x = e.pageX;
            const m = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(tmpl.slider);
            this.r = clamp((x - m.bodyLeft) / m.width, 0, 1);
            this.scrollingX = this.r * rangeX + range.start.x;
            this.y = this.r * rangeY + range.start.y;
            this.accept(this.scrollingX);
        });
    }
    setDisabled(disabled) {
        this.control.classList.toggle('disabled', disabled);
        this.disabled = disabled;
    }
    setXLabel(s) {
        this.tmpl.x.textContent = s;
    }
    setYLabel(s) {
        this.tmpl.y.textContent = s;
    }
    accept(x, cfg) {
        const tmpl = this.tmpl;
        if (this.roundX)
            x = Math.round(x);
        if (this.roundY)
            this.y = Math.round(this.y);
        tmpl.x.textContent = threeSigFigs.format(x);
        tmpl.y.textContent = threeSigFigs.format(this.y);
        if (this.roundY)
            tmpl.y.textContent = `${this.y}`;
        const rEffective = clamp(this.r, 0, 1);
        tmpl.handle.style.left = `calc(${rEffective * 100}% - ${rEffective * 14}px)`;
        this.x = x;
        this.scrollingX = x;
        cfg = cfg !== null && cfg !== void 0 ? cfg : {};
        if (this.settingsDict)
            this.settingsDict[this.settingsKey] = this.convert(this.x, this.y);
        if (!cfg.skipUpdate) {
            this.updated(x, this.y);
            if (!cfg.skipChange)
                this.changed();
        }
    }
    setValue(x, skipUpdate) {
        const range = this.range;
        this.r = (x - range.start.x) / (range.end.x - range.start.x);
        this.y = range.start.y + this.r * (range.end.y - range.start.y);
        this.accept(x, { skipUpdate });
    }
    modified() {
        return this.x !== this.initVal;
    }
    reset() {
        this.setValue(this.initVal, true);
    }
}
const clamp = (v, min, max) => v < min ? min : v > max ? max : v;


/***/ }),

/***/ "./src/js/order.ts":
/*!*************************!*\
  !*** ./src/js/order.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ OrderPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









// lockTimeMakerMs must match the value returned from LockTimeMaker func in
// bisonw.
const lockTimeMakerMs = 20 * 60 * 60 * 1000;
// lockTimeTakerMs must match the value returned from LockTimeTaker func in
// bisonw.
const lockTimeTakerMs = 8 * 60 * 60 * 1000;
const animationLength = 500;
class OrderPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(main) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(main);
        this.stampers = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(main, '[data-stamp]');
        // Find the order
        this.orderID = main.dataset.oid || '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.matchCardTmpl);
        const setStamp = () => {
            for (const span of this.stampers) {
                span.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseInt(span.dataset.stamp || ''));
            }
        };
        setStamp();
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => {
                if (this.refreshOnPopupClose) {
                    window.location.replace(window.location.href);
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            });
        });
        // Some static elements on this page contain assets that can be linked
        // to blockchain explorers (such as Etherscan) so users can easily
        // examine funding/acceleration coins data there. We'd need to set up
        // such hyperlinks here.
        main.querySelectorAll('[data-explorer-id]').forEach((link) => {
            const assetID = parseInt(link.dataset.explorerId || '');
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.setCoinHref)(assetID, link);
        });
        if (page.cancelBttn) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.cancelBttn, 'click', () => {
                this.showForm(page.cancelForm);
            });
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.accelerateBttn, 'click', () => {
            this.showAccelerateForm();
        });
        const success = () => {
            this.refreshOnPopupClose = true;
        };
        // Do not call cleanTemplates before creating the AccelerateOrderForm
        (0,_opts__WEBPACK_IMPORTED_MODULE_7__.setOptionTemplates)(page);
        this.accelerateOrderForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.AccelerateOrderForm(page.accelerateForm, success);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl);
        // If the user clicks outside of a form, it should close the page overlay.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                if (this.refreshOnPopupClose) {
                    window.location.reload();
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            }
        });
        // Cancel order form
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.cancelForm, page.cancelSubmit, () => __awaiter(this, void 0, void 0, function* () { this.submitCancel(); }));
        this.secondTicker = window.setInterval(() => {
            setStamp();
        }, 10000); // update every 10 seconds
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            order: (note) => { this.handleOrderNote(note); },
            match: (note) => { this.handleMatchNote(note); }
        });
        this.start();
    }
    start() {
        return __awaiter(this, void 0, void 0, function* () {
            let ord = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().order(this.orderID);
            // app().order can only access active orders. If the order is not active,
            // we'll need to get the data from the database.
            if (ord)
                this.order = ord;
            else {
                ord = yield this.fetchOrder();
            }
            // Swap out the dot-notation symbols with token-aware symbols.
            this.page.mktBaseSymbol.replaceWith(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[ord.baseID]));
            this.page.mktQuoteSymbol.replaceWith(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[ord.quoteID]));
            this.setAccelerationButtonVis();
            this.showMatchCards();
        });
    }
    unload() {
        clearInterval(this.secondTicker);
    }
    /* fetchOrder fetches the order from the client. */
    fetchOrder() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/order', this.orderID);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                throw res.msg;
            this.order = res.order;
            return this.order;
        });
    }
    /*
     * setImmutableMatchCardElements sets the match card elements that are never
     * changed.
     */
    setImmutableMatchCardElements(matchCard, match) {
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(matchCard);
        tmpl.matchID.textContent = match.matchID;
        const time = new Date(match.stamp);
        tmpl.matchTime.textContent = time.toLocaleTimeString(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
        tmpl.matchTimeAgo.dataset.stamp = match.stamp.toString();
        tmpl.matchTimeAgo.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(match.stamp);
        this.stampers.push(tmpl.matchTimeAgo);
        const orderPortion = _orderutil__WEBPACK_IMPORTED_MODULE_2__.orderPortion(this.order, match);
        const baseSymbol = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bipSymbol(this.order.baseID);
        const quoteSymbol = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bipSymbol(this.order.quoteID);
        const baseUnitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().unitInfo(this.order.baseID);
        const quoteUnitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().unitInfo(this.order.quoteID);
        const [bUnit, qUnit] = [baseUnitInfo.conventional.unit.toLowerCase(), quoteUnitInfo.conventional.unit.toLowerCase()];
        const quoteAmount = _orderutil__WEBPACK_IMPORTED_MODULE_2__.baseToQuote(match.rate, match.qty);
        if (match.isCancel) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.cancelInfoDiv);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.infoDiv, tmpl.status, tmpl.statusHdr);
            if (this.order.sell) {
                tmpl.cancelAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, baseUnitInfo);
                tmpl.cancelIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.baseID);
            }
            else {
                tmpl.cancelAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteAmount, quoteUnitInfo);
                tmpl.cancelIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.quoteID);
            }
            tmpl.cancelOrderPortion.textContent = orderPortion;
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.infoDiv);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.cancelInfoDiv);
        tmpl.orderPortion.textContent = orderPortion;
        if (match.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) {
            tmpl.side.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_MAKER);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.makerSwapYou, tmpl.makerRedeemYou, tmpl.takerSwapThem, tmpl.takerRedeemThem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.takerSwapYou, tmpl.takerRedeemYou, tmpl.makerSwapThem, tmpl.makerRedeemThem);
        }
        else {
            tmpl.side.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TAKER);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapYou, tmpl.makerRedeemYou, tmpl.takerSwapThem, tmpl.takerRedeemThem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.takerSwapYou, tmpl.takerRedeemYou, tmpl.makerSwapThem, tmpl.makerRedeemThem);
        }
        if ((match.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker && this.order.sell) ||
            (match.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Taker && !this.order.sell)) {
            tmpl.makerSwapAsset.textContent = bUnit;
            tmpl.takerSwapAsset.textContent = qUnit;
            tmpl.makerRedeemAsset.textContent = qUnit;
            tmpl.takerRedeemAsset.textContent = bUnit;
        }
        else {
            tmpl.makerSwapAsset.textContent = qUnit;
            tmpl.takerSwapAsset.textContent = bUnit;
            tmpl.makerRedeemAsset.textContent = bUnit;
            tmpl.takerRedeemAsset.textContent = qUnit;
        }
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().conventionalRate(this.order.baseID, this.order.quoteID, match.rate);
        tmpl.rate.textContent = `${rate} ${bUnit}/${qUnit}`;
        if (this.order.sell) {
            tmpl.refundAsset.textContent = baseSymbol;
            tmpl.fromAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, baseUnitInfo);
            tmpl.toAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteAmount, quoteUnitInfo);
            tmpl.fromIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.baseID);
            tmpl.toIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.quoteID);
        }
        else {
            tmpl.refundAsset.textContent = quoteSymbol;
            tmpl.fromAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteAmount, quoteUnitInfo);
            tmpl.toAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, baseUnitInfo);
            tmpl.fromIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.quoteID);
            tmpl.toIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.baseID);
        }
    }
    /*
     * setMutableMatchCardElements sets the match card elements which may get
     * updated on each update to the match.
     */
    setMutableMatchCardElements(matchCard, m) {
        if (m.isCancel)
            return;
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(matchCard);
        tmpl.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_2__.matchStatusString(m);
        const tryShowCoin = (pendingEl, coinLink, coin) => {
            if (!coin) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(coinLink);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(pendingEl);
                return;
            }
            coinLink.textContent = (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.formatCoinID)(coin.stringID);
            coinLink.dataset.explorerCoin = coin.stringID;
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.setCoinHref)(coin.assetID, coinLink);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(coinLink);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(pendingEl);
        };
        tryShowCoin(tmpl.makerSwapPending, tmpl.makerSwapCoin, makerSwapCoin(m));
        tryShowCoin(tmpl.takerSwapPending, tmpl.takerSwapCoin, takerSwapCoin(m));
        tryShowCoin(tmpl.makerRedeemPending, tmpl.makerRedeemCoin, makerRedeemCoin(m));
        tryShowCoin(tmpl.takerRedeemPending, tmpl.takerRedeemCoin, takerRedeemCoin(m));
        if (!m.refund) {
            // Special messaging for pending refunds.
            let lockTime = lockTimeMakerMs;
            if (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Taker)
                lockTime = lockTimeTakerMs;
            const refundAfter = new Date(m.stamp + lockTime);
            if (Date.now() > refundAfter.getTime())
                tmpl.refundPending.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_REFUND_IMMINENT);
            else {
                const refundAfterStr = refundAfter.toLocaleTimeString(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                tmpl.refundPending.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_REFUND_WILL_HAPPEN_AFTER, { refundAfterTime: refundAfterStr });
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.refundCoin);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.refundPending);
        }
        else {
            tmpl.refundCoin.textContent = (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.formatCoinID)(m.refund.stringID);
            tmpl.refundCoin.dataset.explorerCoin = m.refund.stringID;
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.setCoinHref)(m.refund.assetID, tmpl.refundCoin);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.refundCoin);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.refundPending);
        }
        if (m.status === _orderutil__WEBPACK_IMPORTED_MODULE_2__.MakerSwapCast && !m.revoked && !m.refund) {
            const c = makerSwapCoin(m);
            tmpl.makerSwapMsg.textContent = confirmationString(c);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.takerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.makerSwapMsg);
        }
        else if (m.status === _orderutil__WEBPACK_IMPORTED_MODULE_2__.TakerSwapCast && !m.revoked && !m.refund) {
            const c = takerSwapCoin(m);
            tmpl.takerSwapMsg.textContent = confirmationString(c);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.takerSwapMsg);
        }
        else if (inConfirmingMakerRedeem(m) && !m.revoked && !m.refund) {
            tmpl.makerRedeemMsg.textContent = confirmationString(m.redeem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.takerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.makerRedeemMsg);
        }
        else if (inConfirmingTakerRedeem(m) && !m.revoked && !m.refund) {
            tmpl.takerRedeemMsg.textContent = confirmationString(m.redeem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.makerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.takerRedeemMsg);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg);
        }
        if (!m.revoked) {
            // Match is still following the usual success-path, it is desirable for the
            // user to see it in full (even if to learn how atomic swap is supposed to
            // work).
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerSwapCoin(m) || m.active, tmpl.makerSwap);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerSwapCoin(m) || m.active, tmpl.takerSwap);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerRedeemCoin(m) || m.active, tmpl.makerRedeem);
            // When maker isn't aware of taker redeem coin, once the match becomes inactive
            // (nothing else maker is expected to do in this match) just hide taker redeem.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerRedeemCoin(m) || m.active, tmpl.takerRedeem);
            // Refunding isn't a usual part of success-path, but don't rule it out.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(m.refund, tmpl.refund);
        }
        else {
            // Match diverged from the usual success-path, since this could have happened
            // at any step it is hard (maybe impossible) to predict the final state this
            // match will end up in, so show only steps that already happened plus all
            // the possibilities on the next step ahead.
            // If we don't have swap coins after revocation, we won't show the pending message.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerSwapCoin(m), tmpl.makerSwap);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerSwapCoin(m), tmpl.takerSwap);
            const takerRefundsAfter = new Date(m.stamp + lockTimeTakerMs);
            const takerLockTimeExpired = Date.now() > takerRefundsAfter.getTime();
            // When match is revoked and both swaps are present, maker redeem might still show up:
            // - as maker, we'll try to redeem until taker locktime expires (if taker refunds
            //   we won't be able to redeem; even if taker hasn't refunded just yet - it
            //   becomes too dangerous to redeem after taker locktime expired because maker
            //   reveals his secret when redeeming, and taker might be able to submit both
            //   redeem and refund transactions before maker's redeem gets mined), so we'll
            //   have to show redeem pending element until maker redeem shows up, or until
            //   we give up on redeeming due to taker locktime expiry.
            // - as taker, we should expect maker redeeming any time, so we'll have to show
            //   redeem pending element until maker redeem shows up, or until we refund.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerRedeemCoin(m) || (takerSwapCoin(m) && m.active && !m.refund && !takerLockTimeExpired), tmpl.makerRedeem);
            // When maker isn't aware of taker redeem coin, once the match becomes inactive
            // (nothing else maker is expected to do in this match) just hide taker redeem.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerRedeemCoin(m) || (makerRedeemCoin(m) && m.active && !m.refund), tmpl.takerRedeem);
            // As taker, show refund placeholder only if we have outstanding swap to refund.
            // There is no need to wait for anything else, we can show refund placeholder
            // (to inform the user that it is likely to happen) right after match revocation.
            let expectingRefund = Boolean(takerSwapCoin(m)); // as taker
            if (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) {
                // As maker, show refund placeholder only if we have outstanding swap to refund.
                // If we don't have taker swap there is no need to wait for anything else, we
                // can show refund placeholder (to inform the user that it is likely to happen)
                // right after match revocation.
                expectingRefund = Boolean(makerSwapCoin(m));
                // If we discover taker swap we'll be trying to redeem it (instead of trying
                // to refund our own swap) until taker refunds, so start showing refund
                // placeholder only after taker is expected to start his refund process in
                // this case.
                if (takerSwapCoin(m)) {
                    expectingRefund = expectingRefund && takerLockTimeExpired;
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(m.refund || (m.active && !m.redeem && !m.counterRedeem && expectingRefund), tmpl.refund);
        }
    }
    /*
     * addNewMatchCard adds a new card to the list of match cards.
     */
    addNewMatchCard(match) {
        const page = this.page;
        const matchCard = page.matchCardTmpl.cloneNode(true);
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().bindUrlHandlers(matchCard);
        matchCard.dataset.matchID = match.matchID;
        this.setImmutableMatchCardElements(matchCard, match);
        this.setMutableMatchCardElements(matchCard, match);
        page.matchBox.appendChild(matchCard);
    }
    /*
     * showMatchCards creates cards for each match in the order.
     */
    showMatchCards() {
        const order = this.order;
        if (!order)
            return;
        if (!order.matches)
            return;
        order.matches.sort((a, b) => a.stamp - b.stamp);
        order.matches.forEach((match) => this.addNewMatchCard(match));
    }
    /* showCancel shows a form to confirm submission of a cancel order. */
    showCancel() {
        const order = this.order;
        const page = this.page;
        const remaining = order.qty - order.filled;
        const asset = _orderutil__WEBPACK_IMPORTED_MODULE_2__.isMarketBuy(order) ? (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[order.quoteID] : (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[order.baseID];
        page.cancelRemain.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(remaining, asset.unitInfo);
        page.cancelUnit.textContent = asset.unitInfo.conventional.unit.toUpperCase();
        this.showForm(page.cancelForm);
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            this.currentForm = form;
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cancelForm, page.accelerateForm);
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0px';
        });
    }
    /* submitCancel submits a cancellation for the order. */
    submitCancel() {
        return __awaiter(this, void 0, void 0, function* () {
            // this will be the page.cancelSubmit button (evt.currentTarget)
            const page = this.page;
            const order = this.order;
            const req = {
                orderID: order.id
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.cancelForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/cancel', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                return;
            page.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CANCELING);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            order.cancelling = true;
        });
    }
    /*
     * setAccelerationButtonVis shows the acceleration button if the order can
     * be accelerated.
     */
    setAccelerationButtonVis() {
        const order = this.order;
        if (!order)
            return;
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().canAccelerateOrder(order), page.accelerateBttn, page.actionsLabel);
    }
    /* showAccelerateForm shows a form to accelerate an order */
    showAccelerateForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.page.accelerateBttn);
            this.accelerateOrderForm.refresh(this.order);
            loaded();
            this.showForm(this.page.accelerateForm);
        });
    }
    /*
     * handleOrderNote is the handler for the 'order'-type notification, which are
     * used to update an order's status.
     */
    handleOrderNote(note) {
        const page = this.page;
        const order = note.order;
        if (order.id !== this.orderID)
            return;
        this.order = order;
        const bttn = page.cancelBttn;
        if (bttn && order.status > _orderutil__WEBPACK_IMPORTED_MODULE_2__.StatusBooked)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(bttn);
        page.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_2__.statusString(order);
        for (const m of order.matches || [])
            this.processMatch(m);
        this.setAccelerationButtonVis();
    }
    /* handleMatchNote handles a 'match' notification. */
    handleMatchNote(note) {
        if (note.orderID !== this.orderID)
            return;
        this.processMatch(note.match);
        this.setAccelerationButtonVis();
    }
    /*
     * processMatch synchronizes a match's card with a match received in a
     * 'order' or 'match' notification.
     */
    processMatch(m) {
        let card = null;
        for (const div of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(this.page.matchBox, '.match-card')) {
            if (div.dataset.matchID === m.matchID) {
                card = div;
                break;
            }
        }
        if (card) {
            this.setMutableMatchCardElements(card, m);
        }
        else {
            this.addNewMatchCard(m);
        }
    }
}
/*
 * confirmationString is a string describing the state of confirmations for a
 * coin.
 * */
function confirmationString(coin) {
    if (!coin.confs || coin.confs.required === 0)
        return '';
    return `${coin.confs.count} / ${coin.confs.required} ${_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CONFIRMATIONS)}`;
}
// makerSwapCoin return's the maker's swap coin.
function makerSwapCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.swap : m.counterSwap;
}
// takerSwapCoin return's the taker's swap coin.
function takerSwapCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.counterSwap : m.swap;
}
// makerRedeemCoin return's the maker's redeem coin.
function makerRedeemCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.redeem : m.counterRedeem;
}
// takerRedeemCoin return's the taker's redeem coin.
function takerRedeemCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.counterRedeem : m.redeem;
}
/*
* inConfirmingMakerRedeem will be true if we are the maker, and we are waiting
* on confirmations for our own redeem.
*/
function inConfirmingMakerRedeem(m) {
    return m.status < _orderutil__WEBPACK_IMPORTED_MODULE_2__.MatchConfirmed && m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker && m.status >= _orderutil__WEBPACK_IMPORTED_MODULE_2__.MakerRedeemed;
}
/*
* inConfirmingTakerRedeem will be true if we are the taker, and we are waiting
* on confirmations for our own redeem.
*/
function inConfirmingTakerRedeem(m) {
    return m.status < _orderutil__WEBPACK_IMPORTED_MODULE_2__.MatchConfirmed && m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Taker && m.status >= _orderutil__WEBPACK_IMPORTED_MODULE_2__.MatchComplete;
}


/***/ }),

/***/ "./src/js/orderbook.ts":
/*!*****************************!*\
  !*** ./src/js/orderbook.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ OrderBook)
/* harmony export */ });
class OrderBook {
    constructor(mktBook, baseSymbol, quoteSymbol) {
        this.base = mktBook.base;
        this.baseSymbol = baseSymbol;
        this.quote = mktBook.quote;
        this.quoteSymbol = quoteSymbol;
        // Books are sorted mid-gap first.
        this.buys = mktBook.book.buys || [];
        this.sells = mktBook.book.sells || [];
    }
    /* add adds an order to the order book. */
    add(ord) {
        if (ord.qtyAtomic === 0) {
            // TODO: Somebody, for the love of god, figure out why the hell this helps
            // with the ghost orders problem. As far as I know, this order is a booked
            // order that had more than one match in an epoch and completely filled.
            // Because the first match didn't exhaust the order, there would be a
            // 'update_remaining' notification scheduled for the order. But by the
            // time OrderRouter generates the notification long after matching, the
            // order has zero qty left to fill. It's all good though, kinda, because
            // the notification is quickly followed with an 'unbook_order'
            // notification. I have tried my damnedest to catch an update_remaining
            // note without an accompanying unbook_order note, and have thus failed.
            // Yet, this fix somehow seems to work. It's infuriating, tbh.
            window.log('zeroqty', 'zero quantity order encountered', ord);
            return;
        }
        const side = ord.sell ? this.sells : this.buys;
        side.splice(findIdx(side, ord.rate, !ord.sell), 0, ord);
    }
    /* remove removes an order from the order book. */
    remove(token) {
        if (this.removeFromSide(this.sells, token))
            return;
        this.removeFromSide(this.buys, token);
    }
    /* removeFromSide removes an order from the list of orders. */
    removeFromSide(side, token) {
        const [ord, i] = this.findOrder(side, token);
        if (ord) {
            side.splice(i, 1);
            return true;
        }
        return false;
    }
    /* findOrder finds an order in a specified side */
    findOrder(side, token) {
        for (let i = 0; i < side.length; i++) {
            if (side[i].token === token) {
                return [side[i], i];
            }
        }
        return [null, -1];
    }
    /* updates the remaining quantity of an order. */
    updateRemaining(token, qty, qtyAtomic) {
        if (this.updateRemainingSide(this.sells, token, qty, qtyAtomic))
            return;
        this.updateRemainingSide(this.buys, token, qty, qtyAtomic);
    }
    /*
     * updateRemainingSide looks for the order in the side and updates the
     * quantity, returning true on success, false if order not found.
     */
    updateRemainingSide(side, token, qty, qtyAtomic) {
        const ord = this.findOrder(side, token)[0];
        if (ord) {
            ord.qty = qty;
            ord.qtyAtomic = qtyAtomic;
            return true;
        }
        return false;
    }
    /*
     * setEpoch sets the current epoch and clear any orders from previous epochs.
     */
    setEpoch(epochIdx) {
        const approve = (ord) => ord.epoch === undefined || ord.epoch === 0 || ord.epoch === epochIdx;
        this.sells = this.sells.filter(approve);
        this.buys = this.buys.filter(approve);
    }
    /* empty will return true if both the buys and sells lists are empty. */
    empty() {
        return !this.sells.length && !this.buys.length;
    }
    /* count is the total count of both buy and sell orders. */
    count() {
        return this.sells.length + this.buys.length;
    }
    /* bestGapOrder will return the best non-epoch order if one exists, or the
     * best epoch order if there are only epoch orders, or null if there are no
     * orders.
     */
    bestGapOrder(side) {
        let best = null;
        for (const ord of side) {
            if (!ord.epoch)
                return ord;
            if (!best) {
                best = ord;
            }
        }
        return best;
    }
    bestGapBuy() {
        return this.bestGapOrder(this.buys);
    }
    bestGapSell() {
        return this.bestGapOrder(this.sells);
    }
}
/*
 * findIdx find the index at which to insert the order into the list of orders.
 */
function findIdx(side, rate, less) {
    for (let i = 0; i < side.length; i++) {
        if ((side[i].rate < rate) === less)
            return i;
    }
    return side.length;
}


/***/ }),

/***/ "./src/js/orders.ts":
/*!**************************!*\
  !*** ./src/js/orders.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ OrdersPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






const orderBatchSize = 50;
const animationLength = 500;
class OrdersPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(main) {
        super();
        this.main = main;
        // if offset is '', there are no more orders available to auto-load for
        // never-ending scrolling.
        this.offset = '';
        this.loading = false;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(main);
        this.orderTmpl = page.rowTmpl;
        this.orderTmpl.remove();
        // filterState will store arrays of strings. The assets and statuses
        // sub-filters will need to be converted to ints for JSON encoding.
        const filterState = this.filterState = {
            hosts: [],
            assets: [],
            statuses: []
        };
        const search = new URLSearchParams(window.location.search);
        const readFilter = (form, filterKey) => {
            const v = search.get(filterKey);
            if (!v || v.length === 0)
                return;
            const subFilter = v.split(',');
            if (v) {
                filterState[filterKey] = subFilter; // Kinda janky
            }
            form.querySelectorAll('input').forEach(bttn => {
                if (subFilter.indexOf(bttn.value) >= 0)
                    bttn.checked = true;
            });
        };
        readFilter(page.hostFilter, 'hosts');
        readFilter(page.assetFilter, 'assets');
        readFilter(page.statusFilter, 'statuses');
        const applyButtons = [];
        const monitorFilter = (form, filterKey) => {
            const applyBttn = form.querySelector('.apply-bttn');
            applyButtons.push(applyBttn);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(applyBttn, 'click', () => {
                this.submitFilter();
                applyButtons.forEach(bttn => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(bttn));
            });
            form.querySelectorAll('input').forEach(bttn => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(bttn, 'change', () => {
                    const subFilter = parseSubFilter(form);
                    if (compareSubFilter(subFilter, filterState[filterKey])) {
                        // Same as currently loaded. Hide the apply button.
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(applyBttn);
                    }
                    else {
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(applyBttn);
                    }
                });
            });
        };
        monitorFilter(page.hostFilter, 'hosts');
        monitorFilter(page.assetFilter, 'assets');
        monitorFilter(page.statusFilter, 'statuses');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.main, 'scroll', () => {
            if (this.loading)
                return;
            const belowBottom = page.ordersTable.offsetHeight - this.main.offsetHeight - this.main.scrollTop;
            if (belowBottom < 0) {
                this.nextPage();
            }
        });
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            });
        });
        // If the user clicks outside of a form, it should close the page overlay.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            }
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportOrders, 'click', () => {
            this.exportOrders();
        });
        page.showArchivedDateField.addEventListener('change', () => {
            if (page.showArchivedDateField.checked)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.archivedDateField);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.archivedDateField, page.deleteArchivedRecordsErr);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.deleteArchivedRecords, 'click', () => {
            const page = this.page;
            page.showArchivedDateField.checked = false;
            page.saveMatchesToFile.checked = false;
            page.saveOrdersToFile.checked = false;
            page.deleteArchivedRecordsErr.textContent = '';
            page.archivedRecordsLocation.textContent = '';
            page.deleteArchivedRecordsMsg.textContent = '';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.deleteArchivedResult, page.deleteArchivedRecordsErr, page.deleteArchivedRecordsMsg, page.archivedRecordsLocation, page.archivedDateField);
            this.showForm(page.deleteArchivedRecordsForm);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.deleteArchivedRecordsSubmit, 'click', () => {
            let date = 0;
            if (page.showArchivedDateField.checked) {
                date = Date.parse(page.olderThan.value || '');
                if (isNaN(date) || date <= 0) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.deleteArchivedRecordsErr, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_DATE_ERR_MSG));
                    return;
                }
            }
            this.deleteArchivedRecords(date);
        });
        this.submitFilter();
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            this.currentForm = form;
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.deleteArchivedRecordsForm);
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0px';
        });
    }
    /* setOrders empties the order table and appends the specified orders. */
    setOrders(orders) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.tableBody);
        this.appendOrders(orders);
    }
    /* appendOrders appends orders to the orders table. */
    appendOrders(orders) {
        const tbody = this.page.tableBody;
        for (const ord of orders) {
            const tr = this.orderTmpl.cloneNode(true);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            let fromSymbol, toSymbol, fromUnit, toUnit, fromQty;
            let toQty = '';
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().exchanges[ord.host] || undefined;
            if ((!(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().assets[ord.baseID] && !xc.assets[ord.baseID]) || (!(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().assets[ord.quoteID] && !xc.assets[ord.quoteID]))
                continue;
            const [baseUnitInfo, quoteUnitInfo] = [(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().unitInfo(ord.baseID, xc), (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().unitInfo(ord.quoteID, xc)];
            if (ord.sell) {
                [fromSymbol, toSymbol] = [ord.baseSymbol, ord.quoteSymbol];
                [fromUnit, toUnit] = [baseUnitInfo.conventional.unit, quoteUnitInfo.conventional.unit];
                fromQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Limit) {
                    toQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_2__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                }
            }
            else {
                [fromSymbol, toSymbol] = [ord.quoteSymbol, ord.baseSymbol];
                [fromUnit, toUnit] = [quoteUnitInfo.conventional.unit, baseUnitInfo.conventional.unit];
                if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Market) {
                    fromQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                }
                else {
                    fromQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_2__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                    toQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                }
            }
            const mktID = `${baseUnitInfo.conventional.unit}-${quoteUnitInfo.conventional.unit}`;
            tmpl.host.textContent = `${mktID} @ ${ord.host}`;
            tmpl.fromQty.textContent = fromQty;
            tmpl.fromLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(fromSymbol);
            tmpl.fromSymbol.textContent = fromUnit;
            tmpl.toQty.textContent = toQty;
            tmpl.toLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(toSymbol);
            tmpl.toSymbol.textContent = toUnit;
            tmpl.type.textContent = `${_orderutil__WEBPACK_IMPORTED_MODULE_2__.typeString(ord)} ${_orderutil__WEBPACK_IMPORTED_MODULE_2__.sellString(ord)}`;
            let rate = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue((0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().conventionalRate(ord.baseID, ord.quoteID, ord.rate, xc));
            if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Market)
                rate = _orderutil__WEBPACK_IMPORTED_MODULE_2__.averageMarketOrderRateString(ord);
            tmpl.rate.textContent = rate;
            tmpl.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_2__.statusString(ord);
            tmpl.filled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_2__.filled(ord) / ord.qty * 100).toFixed(1)}%`;
            tmpl.settled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_2__.settled(ord) / ord.qty * 100).toFixed(1)}%`;
            const dateTime = new Date(ord.submitTime).toLocaleString();
            tmpl.timeAgo.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(ord.submitTime)} ago`;
            tmpl.time.textContent = dateTime;
            const link = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(tr, 'link');
            link.href = `order/${ord.id}`;
            (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().bindInternalNavigation(tr);
            tbody.appendChild(tr);
        }
        if (orders.length === orderBatchSize) {
            this.offset = orders[orders.length - 1].id;
        }
        else {
            this.offset = '';
        }
    }
    /* submitFilter submits the current filter and reloads the order table. */
    submitFilter() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.offset = '';
            const filterState = this.filterState;
            filterState.hosts = parseSubFilter(page.hostFilter);
            filterState.assets = parseSubFilter(page.assetFilter).map((s) => parseInt(s));
            filterState.statuses = parseSubFilter(page.statusFilter).map((s) => parseInt(s));
            this.setOrders(yield this.fetchOrders());
        });
    }
    /* fetchOrders fetches orders using the current filter. */
    fetchOrders() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().loading(this.main);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/orders', this.currentFilter());
            loaded();
            return res.orders;
        });
    }
    /* exportOrders downloads a csv of the user's orders based on the current filter. */
    exportOrders() {
        this.offset = '';
        const filterState = this.currentFilter();
        const url = new URL(window.location.href);
        const search = new URLSearchParams('');
        const setQuery = (k) => {
            const subFilter = filterState[k];
            subFilter.forEach((v) => {
                search.append(k, v);
            });
        };
        setQuery('hosts');
        setQuery('assets');
        setQuery('statuses');
        url.search = search.toString();
        url.pathname = '/orders/export';
        window.open(url.toString());
    }
    /* deleteArchivedRecords removes the user's archived orders and matches
     * created before user specified date time in millisecond. Deleted archived
     * records are saved to a CSV file if the user specify so.
     */
    deleteArchivedRecords(olderThanMs) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const saveMatchesToFIle = page.saveMatchesToFile.checked || false;
            const saveOrdersToFile = page.saveOrdersToFile.checked || false;
            const reqBody = {
                olderThanMs: olderThanMs,
                saveMatchesToFile: saveMatchesToFIle,
                saveOrdersToFile: saveOrdersToFile
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().loading(this.main);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/deletearchivedrecords', reqBody);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().checkResponse(res)) {
                return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.deleteArchivedRecordsErr, res.msg);
            }
            if (res.archivedRecordsDeleted > 0) {
                page.deleteArchivedRecordsMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_DELETE_ARCHIVED_RECORDS_RESULT, { nRecords: res.archivedRecordsDeleted });
                if (saveMatchesToFIle || saveOrdersToFile) {
                    page.archivedRecordsLocation.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ARCHIVED_RECORDS_PATH, { path: res.archivedRecordsPath });
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.archivedRecordsLocation);
                }
                // Update the order page.
                this.submitFilter();
            }
            else {
                page.deleteArchivedRecordsMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_ARCHIVED_RECORDS);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.deleteArchivedResult, page.deleteArchivedRecordsMsg);
        });
    }
    /*
     * currentFilter converts the local filter type (which is all strings) to the
     * server's filter type.
     */
    currentFilter() {
        var _a, _b;
        const filterState = this.filterState;
        return {
            hosts: filterState.hosts,
            assets: (_a = filterState.assets) === null || _a === void 0 ? void 0 : _a.map((s) => parseInt(s)),
            statuses: (_b = filterState.statuses) === null || _b === void 0 ? void 0 : _b.map((s) => parseInt(s)),
            n: orderBatchSize,
            offset: this.offset
        };
    }
    /*
     * nextPage resubmits the filter with the offset set to the last loaded order.
     */
    nextPage() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.offset === '' || this.loading)
                return;
            this.loading = true;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.orderLoader);
            const orders = yield this.fetchOrders();
            this.loading = false;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.orderLoader);
            this.appendOrders(orders);
        });
    }
}
/*
 * parseSubFilter parses a bool-map from the checkbox inputs in the specified
 * ancestor element.
 */
function parseSubFilter(form) {
    const entries = [];
    form.querySelectorAll('input').forEach(box => {
        if (box.checked)
            entries.push(box.value);
    });
    return entries;
}
/* compareSubFilter compares the two filter arrays for unordered equivalence. */
function compareSubFilter(filter1, filter2) {
    if (filter1.length !== filter2.length)
        return false;
    for (const entry of filter1) {
        if (filter2.indexOf(entry) === -1)
            return false;
    }
    return true;
}


/***/ }),

/***/ "./src/js/orderutil.ts":
/*!*****************************!*\
  !*** ./src/js/orderutil.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Cancel": () => (/* binding */ Cancel),
/* harmony export */   "ImmediateTiF": () => (/* binding */ ImmediateTiF),
/* harmony export */   "Limit": () => (/* binding */ Limit),
/* harmony export */   "Maker": () => (/* binding */ Maker),
/* harmony export */   "MakerRedeemed": () => (/* binding */ MakerRedeemed),
/* harmony export */   "MakerSwapCast": () => (/* binding */ MakerSwapCast),
/* harmony export */   "Market": () => (/* binding */ Market),
/* harmony export */   "MatchComplete": () => (/* binding */ MatchComplete),
/* harmony export */   "MatchConfirmed": () => (/* binding */ MatchConfirmed),
/* harmony export */   "MatchSideMaker": () => (/* binding */ MatchSideMaker),
/* harmony export */   "MatchSideTaker": () => (/* binding */ MatchSideTaker),
/* harmony export */   "NewlyMatched": () => (/* binding */ NewlyMatched),
/* harmony export */   "OrderTypeCancel": () => (/* binding */ OrderTypeCancel),
/* harmony export */   "OrderTypeLimit": () => (/* binding */ OrderTypeLimit),
/* harmony export */   "OrderTypeMarket": () => (/* binding */ OrderTypeMarket),
/* harmony export */   "RateEncodingFactor": () => (/* binding */ RateEncodingFactor),
/* harmony export */   "StandingTiF": () => (/* binding */ StandingTiF),
/* harmony export */   "StatusBooked": () => (/* binding */ StatusBooked),
/* harmony export */   "StatusCanceled": () => (/* binding */ StatusCanceled),
/* harmony export */   "StatusEpoch": () => (/* binding */ StatusEpoch),
/* harmony export */   "StatusExecuted": () => (/* binding */ StatusExecuted),
/* harmony export */   "StatusRevoked": () => (/* binding */ StatusRevoked),
/* harmony export */   "StatusUnknown": () => (/* binding */ StatusUnknown),
/* harmony export */   "Taker": () => (/* binding */ Taker),
/* harmony export */   "TakerSwapCast": () => (/* binding */ TakerSwapCast),
/* harmony export */   "averageMarketOrderRateString": () => (/* binding */ averageMarketOrderRateString),
/* harmony export */   "averageRate": () => (/* binding */ averageRate),
/* harmony export */   "baseToQuote": () => (/* binding */ baseToQuote),
/* harmony export */   "filled": () => (/* binding */ filled),
/* harmony export */   "hasActiveMatches": () => (/* binding */ hasActiveMatches),
/* harmony export */   "isCancellable": () => (/* binding */ isCancellable),
/* harmony export */   "isMarketBuy": () => (/* binding */ isMarketBuy),
/* harmony export */   "matchStatusString": () => (/* binding */ matchStatusString),
/* harmony export */   "optionElement": () => (/* binding */ optionElement),
/* harmony export */   "orderPortion": () => (/* binding */ orderPortion),
/* harmony export */   "orderTypeText": () => (/* binding */ orderTypeText),
/* harmony export */   "sellString": () => (/* binding */ sellString),
/* harmony export */   "settled": () => (/* binding */ settled),
/* harmony export */   "statusString": () => (/* binding */ statusString),
/* harmony export */   "typeString": () => (/* binding */ typeString)
/* harmony export */ });
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");




const Limit = 1; // TODO: Delete for the versions below
const Market = 2; // TODO: Delete for the versions below
const Cancel = 3; // TODO: Delete for the versions below
const OrderTypeLimit = 1;
const OrderTypeMarket = 2;
const OrderTypeCancel = 3;
/* The time-in-force specifiers are a mirror of dex/order.TimeInForce. */
const ImmediateTiF = 0;
const StandingTiF = 1;
/* The order statuses are a mirror of dex/order.OrderStatus. */
const StatusUnknown = 0;
const StatusEpoch = 1;
const StatusBooked = 2;
const StatusExecuted = 3;
const StatusCanceled = 4;
const StatusRevoked = 5;
/* The match statuses are a mirror of dex/order.MatchStatus. */
const NewlyMatched = 0;
const MakerSwapCast = 1;
const TakerSwapCast = 2;
const MakerRedeemed = 3;
const MatchComplete = 4;
const MatchConfirmed = 5;
/* The match sides are a mirror of dex/order.MatchSide. */
const Maker = 0; // TODO: Delete for the versions below
const Taker = 1; // TODO: Delete for the versions below
const MatchSideMaker = 0;
const MatchSideTaker = 1;
/*
 * RateEncodingFactor is used when encoding an atomic exchange rate as an
 * integer. See docs on message-rate encoding @
 * https://github.com/decred/dcrdex/blob/master/spec/comm.mediawiki#Rate_Encoding
 */
const RateEncodingFactor = 1e8;
function sellString(ord) {
    const key = ord.sell ? _locales__WEBPACK_IMPORTED_MODULE_0__.ID_SELL : _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BUY;
    const lang = document.documentElement.lang.toLowerCase();
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(key).toLocaleLowerCase(lang);
}
function typeString(ord) {
    return ord.type === Limit ? (ord.tif === ImmediateTiF ? _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_LIMIT_ORDER_IMMEDIATE_TIF) : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_LIMIT_ORDER)) : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MARKET_ORDER);
}
/* isMarketBuy will return true if the order is a market buy order. */
function isMarketBuy(ord) {
    return ord.type === Market && !ord.sell;
}
/*
 * hasActiveMatches returns true if the order has matches that have not completed
 * settlement yet.
 */
function hasActiveMatches(order) {
    if (!order.matches)
        return false;
    for (const match of order.matches) {
        if (match.active)
            return true;
    }
    return false;
}
/**
 * statusString converts the order status to a string.
 *
 * IMPORTANT: we have similar function in Golang, it must match this one exactly,
 * when updating make sure to update both!
 */
function statusString(order) {
    if (!order.id)
        return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_ORDER_SUBMITTING); // order ID is empty.
    const isLive = hasActiveMatches(order);
    switch (order.status) {
        case StatusUnknown: return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNKNOWN);
        case StatusEpoch: return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_EPOCH);
        case StatusBooked:
            if (order.cancelling)
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_CANCELING);
            return isLive ? `${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BOOKED)}/${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING)}` : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BOOKED);
        case StatusExecuted:
            if (isLive)
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING);
            if (order.filled === 0 && order.type !== Cancel)
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_NO_MATCH);
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_EXECUTED);
        case StatusCanceled:
            return isLive ? `${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_CANCELED)}/${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING)}` : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_CANCELED);
        case StatusRevoked:
            return isLive ? `${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_REVOKED)}/${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING)}` : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_REVOKED);
    }
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNKNOWN);
}
/* filled sums the quantities of non-cancel matches available. */
function filled(order) {
    if (!order.matches)
        return 0;
    const qty = isMarketBuy(order) ? (m) => m.qty * m.rate / RateEncodingFactor : (m) => m.qty;
    return order.matches.reduce((filled, match) => {
        if (match.isCancel)
            return filled;
        return filled + qty(match);
    }, 0);
}
/* settled sums the quantities of the matches that have completed. */
function settled(order) {
    if (!order.matches)
        return 0;
    const qty = isMarketBuy(order) ? (m) => m.qty * m.rate / RateEncodingFactor : (m) => m.qty;
    return order.matches.reduce((settled, match) => {
        if (match.isCancel)
            return settled;
        const redeemed = (match.side === Maker && match.status >= MakerRedeemed) ||
            (match.side === Taker && match.status >= MatchComplete);
        return redeemed ? settled + qty(match) : settled;
    }, 0);
}
/* averageRateString returns a formatting string containing the average rate of
the matches that have been filled for a market order. */
function averageMarketOrderRateString(ord) {
    var _a;
    if (!((_a = ord.matches) === null || _a === void 0 ? void 0 : _a.length))
        return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MARKET_ORDER);
    let rateStr = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue((0,_registry__WEBPACK_IMPORTED_MODULE_1__.app)().conventionalRate(ord.baseID, ord.quoteID, averageRate(ord)));
    if (ord.matches.length > 1)
        rateStr = '~ ' + rateStr; // "~" only makes sense if the order has more than one match.
    return rateStr;
}
/* averageRate returns a the average rate of the matches that have been filled
in an order. */
function averageRate(ord) {
    var _a;
    if (!((_a = ord.matches) === null || _a === void 0 ? void 0 : _a.length))
        return 0;
    let rateProduct = 0;
    let baseQty = 0;
    for (const m of ord.matches) {
        baseQty += m.qty;
        rateProduct += (m.rate * m.qty); // order ~ 1e16
    }
    return rateProduct / baseQty;
}
/* baseToQuote returns the quantity of the quote asset. */
function baseToQuote(rate, base) {
    return rate * base / RateEncodingFactor;
}
/* orderPortion returns a string stating the percentage of the order a match
   makes up. */
function orderPortion(order, match) {
    let matchQty = match.qty;
    if (isMarketBuy(order)) {
        matchQty = baseToQuote(match.rate, match.qty);
    }
    return ((matchQty / order.qty) * 100).toFixed(1) + ' %';
}
/*
 * matchStatusString is a string used to create a displayable string describing
 * describing the match status.
 */
function matchStatusString(m) {
    if (m.revoked) {
        // When revoked, match status is less important than pending action if still
        // active, or the outcome if inactive.
        if (m.active) {
            if (m.redeem)
                return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_SENT); // must require confirmation if active
            // If maker and we have not redeemed, waiting to refund, assuming it's not
            // revoked while waiting for confs on an unspent/unexpired taker swap.
            if (m.side === Maker)
                return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REFUND_PENDING);
            // As taker, resolution depends on maker's actions while waiting to refund.
            if (m.counterRedeem)
                return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEEM_PENDING); // this should be very brief if we see the maker's redeem
            return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REFUND_PENDING); // may switch to redeem if maker redeems on the sly
        }
        if (m.refund) {
            return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REFUNDED);
        }
        if (m.redeem) {
            return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_CONFIRMED);
        }
        return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_COMPLETE); // i.e. we sent no swap
    }
    switch (m.status) {
        case NewlyMatched:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_NEWLY_MATCHED);
        case MakerSwapCast:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_MAKER_SWAP_CAST);
        case TakerSwapCast:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_TAKER_SWAP_CAST);
        case MakerRedeemed:
            if (m.side === Maker) {
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_SENT);
            }
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_MAKER_REDEEMED);
        case MatchComplete:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_SENT);
        case MatchConfirmed:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_CONFIRMED);
    }
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNKNOWN);
}
// revokedMatchStatus is a helper function that returns the revoked match status
// string.
function revokedMatchStatus(matchStatus) {
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REVOKED, { status: _locales__WEBPACK_IMPORTED_MODULE_0__.prep(matchStatus) });
}
/*
 * optionElement is a getter for an element matching the *OrderOption from
 * client/asset. change is a function with no arguments that is called when the
 * returned option's value has changed.
 */
function optionElement(opt, order, change, isSwap) {
    const isBaseChain = (isSwap && order.sell) || (!isSwap && !order.sell);
    const symbol = isBaseChain ? dexAssetSymbol(order.host, order.base) : dexAssetSymbol(order.host, order.quote);
    switch (true) {
        case !!opt.boolean:
            return new _opts__WEBPACK_IMPORTED_MODULE_2__.BooleanOption(opt, symbol, order.options, change).node;
        case !!opt.xyRange:
            return new _opts__WEBPACK_IMPORTED_MODULE_2__.XYRangeOption(opt, symbol, order.options, change).node;
        default:
            console.error('no option type specified', opt);
    }
    console.error('unknown option type', opt);
    return document.createElement('div');
}
function dexAssetSymbol(host, assetID) {
    return (0,_registry__WEBPACK_IMPORTED_MODULE_1__.app)().exchanges[host].assets[assetID].symbol;
}
function isCancellable(ord) {
    return ord.type === Limit && ord.tif === StandingTiF && ord.status < StatusExecuted;
}
function orderTypeText(ordType) {
    switch (ordType) {
        case OrderTypeLimit:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_LIMIT_ORDER);
        case OrderTypeMarket:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MARKET_ORDER);
        default: // OrderTypeCancel
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_CANCEL_ORDER);
    }
}


/***/ }),

/***/ "./src/js/register.ts":
/*!****************************!*\
  !*** ./src/js/register.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ RegistrationPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class RegistrationPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body, data) {
        super();
        this.body = body;
        this.data = data;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        if (data.host && page.dexAddrForm.classList.contains('selected')) {
            page.dexAddrForm.classList.remove('selected');
            page.discoverAcctForm.classList.add('selected');
            page.discoverAcctForm.dataset.host = data.host;
        }
        // Hide the form closers for the registration process except for the
        // password reset form closer.
        for (const el of body.querySelectorAll('.form-closer'))
            if (el !== page.resetPassFormCloser)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(el);
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.NewWalletForm(page.newWalletForm, assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier), () => this.animateRegAsset(page.newWalletForm));
        // ADD DEX
        this.dexAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DEXAddressForm(page.dexAddrForm, (xc, certFile) => __awaiter(this, void 0, void 0, function* () {
            this.requestFeepayment(page.dexAddrForm, xc, certFile);
        }));
        const addr = page.discoverAcctForm.dataset.host;
        if (addr) {
            this.discoverAcctForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DiscoverAccountForm(page.discoverAcctForm, addr, (xc) => __awaiter(this, void 0, void 0, function* () {
                this.requestFeepayment(page.discoverAcctForm, xc, '');
            }));
        }
        // SELECT REG ASSET
        this.regAssetForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.FeeAssetSelectionForm(page.regAssetForm, (assetID, tier) => __awaiter(this, void 0, void 0, function* () {
            if (assetID === _registry__WEBPACK_IMPORTED_MODULE_4__.PrepaidBondID) {
                this.registerDEXSuccess();
                return;
            }
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().assets[assetID];
            const wallet = asset.wallet;
            if (wallet) {
                const bondAsset = this.xc.bondAssets[asset.symbol];
                const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.regAssetForm);
                this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
                if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + bondsFeeBuffer) {
                    this.animateConfirmForm(page.regAssetForm);
                    return;
                }
                this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
                (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.regAssetForm, page.walletWait);
                return;
            }
            this.confirmRegisterForm.tier = tier;
            this.newWalletForm.setAsset(assetID);
            (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.regAssetForm, page.newWalletForm);
        }));
        this.walletWaitForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.WalletWaitForm(page.walletWait, () => {
            this.animateConfirmForm(page.walletWait);
        }, () => { this.animateRegAsset(page.walletWait); });
        // SUBMIT DEX REGISTRATION
        this.confirmRegisterForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.ConfirmRegistrationForm(page.confirmRegForm, () => {
            this.registerDEXSuccess();
        }, () => {
            this.animateRegAsset(page.confirmRegForm);
        });
        const currentForm = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(page.forms, ':scope > form.selected');
        currentForm.classList.remove('selected');
        switch (currentForm) {
            case page.dexAddrForm:
                this.dexAddrForm.animate();
                break;
            case page.discoverAcctForm:
                this.discoverAcctForm.animate();
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(currentForm);
        // There's nothing on the page.discoverAcctForm except to receive user pass
        // before attempting to discover user account and there's no need to have
        // them click another button when we can carry on without user interaction.
        if (currentForm === page.discoverAcctForm) {
            this.discoverAcctForm.page.submit.click();
        }
        if ((0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().authed)
            this.auth();
    }
    // auth should be called once user is known to be authed with the server.
    auth() {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().fetchUser();
        });
    }
    requestFeepayment(oldForm, xc, certFile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.xc = xc;
            this.confirmRegisterForm.setExchange(xc, certFile);
            this.walletWaitForm.setExchange(xc);
            this.regAssetForm.setExchange(xc, certFile);
            this.animateRegAsset(oldForm);
        });
    }
    /* Swap in the asset selection form and run the animation. */
    animateRegAsset(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            this.regAssetForm.animate();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.regAssetForm);
        });
    }
    /* Swap in the confirmation form and run the animation. */
    animateConfirmForm(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            this.confirmRegisterForm.animate();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.confirmRegForm);
        });
    }
    // Retrieve an estimate for the tx fee needed to create new bond reserves.
    getBondsFeeBuffer(assetID, form) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/bondsfeebuffer', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().checkResponse(res)) {
                return 0;
            }
            return res.feeBuffer;
        });
    }
    /* gets the contents of the cert file */
    getCertFile() {
        return __awaiter(this, void 0, void 0, function* () {
            let cert = '';
            if (this.dexAddrForm.page.certFile.value) {
                const files = this.dexAddrForm.page.certFile.files;
                if (files && files.length)
                    cert = yield files[0].text();
            }
            return cert;
        });
    }
    /* Called after successful registration to a DEX. */
    registerDEXSuccess() {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().fetchUser();
            (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().updateMenuItemsDisplay();
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().loadPage(this.data.backTo || 'markets');
        });
    }
    newWalletCreated(assetID, tier) {
        return __awaiter(this, void 0, void 0, function* () {
            this.regAssetForm.refresh();
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().fetchUser();
            if (!user)
                return;
            const page = this.page;
            const asset = user.assets[assetID];
            const wallet = asset.wallet;
            const bondAmt = this.xc.bondAssets[asset.symbol].amount;
            const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.newWalletForm);
            this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
            this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
            if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {
                yield this.animateConfirmForm(page.newWalletForm);
                return;
            }
            yield (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.newWalletForm, page.walletWait);
        });
    }
}


/***/ }),

/***/ "./src/js/registry.ts":
/*!****************************!*\
  !*** ./src/js/registry.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ApprovalStatus": () => (/* binding */ ApprovalStatus),
/* harmony export */   "ConnectionStatus": () => (/* binding */ ConnectionStatus),
/* harmony export */   "PeerSource": () => (/* binding */ PeerSource),
/* harmony export */   "PrepaidBondID": () => (/* binding */ PrepaidBondID),
/* harmony export */   "app": () => (/* binding */ app),
/* harmony export */   "registerApplication": () => (/* binding */ registerApplication)
/* harmony export */ });
var ConnectionStatus;
(function (ConnectionStatus) {
    ConnectionStatus[ConnectionStatus["Disconnected"] = 0] = "Disconnected";
    ConnectionStatus[ConnectionStatus["Connected"] = 1] = "Connected";
    ConnectionStatus[ConnectionStatus["InvalidCert"] = 2] = "InvalidCert";
})(ConnectionStatus || (ConnectionStatus = {}));
var ApprovalStatus;
(function (ApprovalStatus) {
    ApprovalStatus[ApprovalStatus["Approved"] = 0] = "Approved";
    ApprovalStatus[ApprovalStatus["Pending"] = 1] = "Pending";
    ApprovalStatus[ApprovalStatus["NotApproved"] = 2] = "NotApproved";
})(ApprovalStatus || (ApprovalStatus = {}));
// changing the order of the elements in this enum will affect
// the sorting of the peers table in wallets.ts.
var PeerSource;
(function (PeerSource) {
    PeerSource[PeerSource["WalletDefault"] = 0] = "WalletDefault";
    PeerSource[PeerSource["UserAdded"] = 1] = "UserAdded";
    PeerSource[PeerSource["Discovered"] = 2] = "Discovered";
})(PeerSource || (PeerSource = {}));
const PrepaidBondID = 2147483647;
// TODO: Define an interface for Application?
let application;
function registerApplication(a) {
    application = a;
}
function app() {
    return application;
}


/***/ }),

/***/ "./src/js/settings.ts":
/*!****************************!*\
  !*** ./src/js/settings.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ SettingsPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
/* harmony import */ var _notifications__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./notifications */ "./src/js/notifications.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __rest = (undefined && undefined.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};









const animationLength = 300;
class SettingsPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body) {
        super();
        this.body = body;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.forms = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, ':scope > form');
        this.fiatRateSources = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.fiatRateSources, 'input[type=checkbox]');
        page.darkMode.checked = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].darkModeLK) === '1';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.darkMode, 'click', () => {
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].darkModeLK, page.darkMode.checked || false ? '1' : '0');
            if (page.darkMode.checked) {
                document.body.classList.add('dark');
            }
            else {
                document.body.classList.remove('dark');
            }
        });
        page.showPokes.checked = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].popupsLK) === '1';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showPokes, 'click', () => {
            const show = page.showPokes.checked || false;
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].popupsLK, show ? '1' : '0');
            (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().showPopups = show;
        });
        page.commitHash.textContent = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().commitHash.substring(0, 7);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addADex, 'click', () => {
            this.dexAddrForm.refresh();
            this.showForm(page.dexAddrForm);
        });
        this.fiatRateSources.forEach(src => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(src, 'change', () => __awaiter(this, void 0, void 0, function* () {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/toggleratesource', {
                    disable: !src.checked,
                    source: src.value
                });
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                    src.checked = !src.checked;
                }
                // Update asset rate values and disable conversion status.
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
            }));
        });
        // Asset selection
        this.regAssetForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.FeeAssetSelectionForm(page.regAssetForm, (assetID, tier) => __awaiter(this, void 0, void 0, function* () {
            if (assetID === _registry__WEBPACK_IMPORTED_MODULE_8__.PrepaidBondID) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
                window.location.reload();
                return;
            }
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().assets[assetID];
            const wallet = asset.wallet;
            if (wallet) {
                const bondAsset = this.currentDEX.bondAssets[asset.symbol];
                const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.regAssetForm);
                this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
                if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + bondsFeeBuffer) {
                    this.animateConfirmForm(page.regAssetForm);
                    return;
                }
                this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
                this.slideSwap(page.walletWait);
                return;
            }
            this.confirmRegisterForm.setAsset(assetID, tier, 0);
            this.newWalletForm.setAsset(assetID);
            this.slideSwap(page.newWalletForm);
        }));
        // Approve fee payment
        this.confirmRegisterForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.ConfirmRegistrationForm(page.confirmRegForm, () => {
            this.registerDEXSuccess();
        }, () => {
            this.animateRegAsset(page.confirmRegForm);
        });
        // Create a new wallet
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.NewWalletForm(page.newWalletForm, assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier), () => this.animateRegAsset(page.newWalletForm));
        this.walletWaitForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.WalletWaitForm(page.walletWait, () => {
            this.animateConfirmForm(page.walletWait);
        }, () => { this.animateRegAsset(page.walletWait); });
        // Enter an address for a new DEX
        this.dexAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.DEXAddressForm(page.dexAddrForm, (xc, certFile) => __awaiter(this, void 0, void 0, function* () {
            this.currentDEX = xc;
            this.confirmRegisterForm.setExchange(xc, certFile);
            this.walletWaitForm.setExchange(xc);
            this.regAssetForm.setExchange(xc, certFile);
            this.animateRegAsset(page.dexAddrForm);
        }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.importAccount, 'click', () => this.prepareAccountImport(page.authorizeAccountImportForm));
        _forms__WEBPACK_IMPORTED_MODULE_4__.bind(page.authorizeAccountImportForm, page.authorizeImportAccountConfirm, () => this.importAccount());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.changeAppPW, 'click', () => this.showForm(page.changeAppPWForm));
        _forms__WEBPACK_IMPORTED_MODULE_4__.bind(page.changeAppPWForm, page.submitNewPW, () => this.changeAppPW());
        this.appPassResetForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.AppPassResetForm(page.resetAppPWForm, () => __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loadPage('login');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
        }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.resetAppPW, 'click', () => {
            this.appPassResetForm.refresh();
            this.showForm(page.resetAppPWForm);
            this.appPassResetForm.focus();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.accountFile, 'change', () => this.onAccountFileChange());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.removeAccount, 'click', () => this.clearAccountFile());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addAccount, 'click', () => page.accountFile.click());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportSeed, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.exportSeedErr);
            this.showForm(page.exportSeedAuth);
        });
        _forms__WEBPACK_IMPORTED_MODULE_4__.bind(page.exportSeedAuth, page.exportSeedSubmit, () => this.submitExportSeedReq());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.gameCodeLink, 'click', () => this.showForm(page.gameCodeForm));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.gameCodeSubmit, 'click', () => this.submitGameCode());
        const closePopups = () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            page.exportSeedPW.value = '';
            page.legacySeed.textContent = '';
            page.mnemonic.textContent = '';
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                closePopups();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                closePopups();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { closePopups(); });
        });
        this.renderDesktopNtfnSettings();
    }
    updateNtfnSetting(e) {
        const checkbox = e.target;
        const noteType = checkbox.getAttribute('name');
        if (noteType === null)
            return;
        const enabled = checkbox.checked;
        (0,_notifications__WEBPACK_IMPORTED_MODULE_7__.updateNtfnSetting)(noteType, enabled);
    }
    getBrowserNtfnSettings() {
        const permissions = (0,_notifications__WEBPACK_IMPORTED_MODULE_7__.fetchDesktopNtfnSettings)();
        return permissions;
    }
    renderDesktopNtfnSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const ntfnSettings = this.getBrowserNtfnSettings();
            const labels = _notifications__WEBPACK_IMPORTED_MODULE_7__.desktopNtfnLabels;
            const tmpl = page.browserNtfnCheckboxTemplate;
            tmpl.removeAttribute('id');
            const container = page.browserNtfnCheckboxContainer;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.browserNtfnCheckboxContainer);
            Object.keys(labels).forEach((noteType) => {
                const html = tmpl.cloneNode(true);
                const enabled = ntfnSettings[noteType];
                const checkbox = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(html, 'checkbox');
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(html, 'label').textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(labels[noteType]);
                checkbox.setAttribute('name', noteType);
                if (enabled)
                    checkbox.setAttribute('checked', 'checked');
                container.appendChild(html);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(checkbox, 'click', this.updateNtfnSetting);
            });
            const enabledCheckbox = page.browserNtfnEnabled;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(enabledCheckbox, 'click', (e) => __awaiter(this, void 0, void 0, function* () {
                if (_notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionDenied())
                    return;
                const checkbox = e.target;
                if (checkbox.checked) {
                    yield _notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.requestNtfnPermission();
                    checkbox.checked = !_notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionDenied();
                }
                this.updateNtfnSetting(e);
                checkbox.dispatchEvent(new Event('change'));
            }));
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(enabledCheckbox, 'change', (e) => {
                const checkbox = e.target;
                const permDenied = _notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionDenied();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(checkbox.checked, page.browserNtfnCheckboxContainer);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(permDenied, page.browserNtfnBlockedMsg);
                checkbox.disabled = permDenied;
            });
            enabledCheckbox.checked = (_notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionGranted() && ntfnSettings.browserNtfnEnabled);
            enabledCheckbox.dispatchEvent(new Event('change'));
        });
    }
    /*
     * slideSwap animates the replacement of the currently shown form with the
     * newForm and sets this.currentForm.
     */
    slideSwap(newForm) {
        _forms__WEBPACK_IMPORTED_MODULE_4__.slideSwap(this.currentForm, newForm);
        this.currentForm = newForm;
    }
    // Retrieve an estimate for the tx fee needed to create new bond reserves.
    getBondsFeeBuffer(assetID, form) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/bondsfeebuffer', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                return 0;
            }
            return res.feeBuffer;
        });
    }
    newWalletCreated(assetID, tier) {
        return __awaiter(this, void 0, void 0, function* () {
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
            if (!user)
                return;
            const page = this.page;
            const asset = user.assets[assetID];
            const wallet = asset.wallet;
            const bondAmt = this.currentDEX.bondAssets[asset.symbol].amount;
            const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.newWalletForm);
            this.confirmRegisterForm.setFees(assetID, bondsFeeBuffer);
            if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {
                yield this.animateConfirmForm(page.newWalletForm);
                return;
            }
            this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
            this.slideSwap(page.walletWait);
        });
    }
    onAccountFileChange() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const files = page.accountFile.files;
            if (!files || !files.length)
                return;
            page.selectedAccount.textContent = files[0].name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.removeAccount);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addAccount);
        });
    }
    /* clearAccountFile cleanup accountFile value and selectedAccount text */
    clearAccountFile() {
        const page = this.page;
        page.accountFile.value = '';
        page.selectedAccount.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NONE_SELECTED);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.removeAccount);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.addAccount);
    }
    prepareAccountImport(authorizeAccountImportForm) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            page.importAccountErr.textContent = '';
            this.showForm(authorizeAccountImportForm);
        });
    }
    // importAccount imports the account
    importAccount() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            let accountString = '';
            if (page.accountFile.value) {
                const files = page.accountFile.files;
                if (!files || !files.length) {
                    console.error('importAccount: no file specified');
                    return;
                }
                accountString = yield files[0].text();
            }
            let account;
            try {
                account = JSON.parse(accountString);
            }
            catch (e) {
                page.importAccountErr.textContent = e.message;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.importAccountErr);
                return;
            }
            if (typeof account === 'undefined') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.importAccountErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ACCT_UNDEFINED));
                return;
            }
            const { bonds = [] } = account, acctInf = __rest(account, ["bonds"]);
            const req = {
                account: acctInf,
                bonds: bonds
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/importaccount', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.importAccountErr, res.msg);
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            // Initial method of displaying imported account.
            window.location.reload();
        });
    }
    submitExportSeedReq() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const pw = page.exportSeedPW.value;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/exportseed', { pass: pw });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.exportSeedErr, res.msg);
                return;
            }
            page.exportSeedPW.value = '';
            if (res.seed.length === 128 && res.seed.split(' ').length === 1) {
                page.legacySeed.textContent = res.seed.match(/.{1,32}/g).map((chunk) => { var _a; return (_a = chunk.match(/.{1,8}/g)) === null || _a === void 0 ? void 0 : _a.join(' '); }).join('\n');
            }
            else
                page.mnemonic.textContent = res.seed;
            this.showForm(page.authorizeSeedDisplay);
        });
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.currentForm = form;
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    /* gets the contents of the cert file */
    getCertFile() {
        return __awaiter(this, void 0, void 0, function* () {
            let cert = '';
            if (this.dexAddrForm.page.certFile.value) {
                const files = this.dexAddrForm.page.certFile.files;
                if (files && files.length)
                    cert = yield files[0].text();
            }
            return cert;
        });
    }
    /* Called after successful registration to a DEX. */
    registerDEXSuccess() {
        return __awaiter(this, void 0, void 0, function* () {
            window.location.reload();
        });
    }
    /* Change application password  */
    changeAppPW() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.changePWErrMsg);
            const clearValues = () => {
                page.appPW.value = '';
                page.newAppPW.value = '';
                page.confirmNewPW.value = '';
            };
            // Ensure password fields are nonempty.
            if (!page.appPW.value || !page.newAppPW.value || !page.confirmNewPW.value) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.changePWErrMsg, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NO_APP_PASS_ERROR_MSG));
                clearValues();
                return;
            }
            // Ensure password confirmation matches.
            if (page.newAppPW.value !== page.confirmNewPW.value) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.changePWErrMsg, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_PASSWORD_NOT_MATCH));
                clearValues();
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(page.changeAppPW);
            const req = {
                appPW: page.appPW.value,
                newAppPW: page.newAppPW.value
            };
            clearValues();
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/changeapppass', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.changePWErrMsg, res.msg);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
        });
    }
    /*
     * unload is called by the Application when the user navigates away from
     * the /settings page.
     */
    unload() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
    /* Swap in the asset selection form and run the animation. */
    animateRegAsset(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            const form = this.page.regAssetForm;
            this.currentForm = form;
            this.regAssetForm.animate();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form);
        });
    }
    /* Swap in the confirmation form and run the animation. */
    animateConfirmForm(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            this.confirmRegisterForm.animate();
            const form = this.page.confirmRegForm;
            this.currentForm = form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form);
        });
    }
    submitGameCode() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.gameCodeErr);
            const code = page.gameCodeInput.value;
            if (!code) {
                page.gameCodeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NO_CODE_PROVIDED);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.gameCodeErr);
                return;
            }
            const msg = page.gameCodeMsg.value || '';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(page.gameCodeForm);
            const resp = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/redeemgamecode', { code, msg });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(resp)) {
                page.gameCodeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_API_ERROR, { msg: resp.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.gameCodeErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.gameCodeSuccess);
            page.gameRedeemTx.dataset.explorerCoin = resp.coinString;
            const dcrBipID = 42;
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_6__.setCoinHref)(dcrBipID, page.gameRedeemTx);
            page.gameRedeemTx.textContent = resp.coinString;
            const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().unitInfo(dcrBipID);
            page.gameRedeemValue.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(resp.win, ui);
        });
    }
}


/***/ }),

/***/ "./src/js/state.ts":
/*!*************************!*\
  !*** ./src/js/state.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// State is a set of static methods for working with the user state. It has
// utilities for setting and retrieving cookies and storing user configuration
// to localStorage.
class State {
    static setCookie(cname, cvalue) {
        const d = new Date();
        // Set cookie to expire in ten years.
        d.setTime(d.getTime() + (86400 * 365 * 10 * 1000));
        const expires = 'expires=' + d.toUTCString();
        document.cookie = cname + '=' + cvalue + ';' + expires + ';path=/';
    }
    /*
     * getCookie returns the value at the specified cookie name, otherwise null.
     */
    static getCookie(cname) {
        for (const cstr of document.cookie.split(';')) {
            const [k, v] = cstr.split('=');
            if (k.trim() === cname)
                return v;
        }
        return null;
    }
    /*
     * removeCookie tells the browser to stop using cookie. It's not enough to simply
     * erase cookie value because browser will still send it to the server (with empty
     * value), and that's not what server expects.
     */
    static removeCookie(cKey) {
        document.cookie = `${cKey}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;`;
    }
    /*
     * isDark returns true if the dark-mode cookie is currently set to '1' = true.
     */
    static isDark() {
        return State.fetchLocal(State.darkModeLK) === '1';
    }
    /* storeLocal puts the key-value pair into Window.localStorage. */
    static storeLocal(k, v) {
        window.localStorage.setItem(k, JSON.stringify(v));
    }
    /*
    * fetchLocal the value associated with the key in Window.localStorage, or
    * null if the no value exists for the key.
    */
    static fetchLocal(k) {
        const v = window.localStorage.getItem(k);
        if (v !== null) {
            return JSON.parse(v);
        }
        return null;
    }
    /* removeLocal removes the key-value pair from Window.localStorage. */
    static removeLocal(k) {
        window.localStorage.removeItem(k);
    }
}
// Cookie keys.
State.darkModeLK = 'darkMode';
State.authCK = 'dexauth';
State.pwKeyCK = 'sessionkey';
// Local storage keys (for data that we don't need at the server).
State.popupsLK = 'popups';
State.loggersLK = 'loggers';
State.recordersLK = 'recorders';
State.lastMarketLK = 'selectedMarket';
State.depthZoomLK = 'depthZoom';
State.lastMMMarketLK = 'mmMarket';
State.optionsExpansionLK = 'mmOptsExpand';
State.leftMarketDockLK = 'leftmarketdock';
State.selectedAssetLK = 'selectedasset';
State.notificationsLK = 'notifications'; // DEPRECATED before v1
State.orderDisclaimerAckedLK = 'ordAck';
State.lastCandleDurationLK = 'lastCandleDuration';
State.localeSpecsKey = 'localeSpecsLK';
State.localeKey = 'localeLK';
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (State);
// Setting defaults here, unless specific cookie (or local storage) value was already chosen by the user.
if (State.fetchLocal(State.darkModeLK) === null)
    State.storeLocal(State.darkModeLK, '1');
if (State.fetchLocal(State.popupsLK) === null)
    State.storeLocal(State.popupsLK, '1');
if (State.fetchLocal(State.leftMarketDockLK) === null)
    State.storeLocal(State.leftMarketDockLK, '1');


/***/ }),

/***/ "./src/js/wallets.ts":
/*!***************************!*\
  !*** ./src/js/wallets.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ WalletsPage),
/* harmony export */   "ticketStatusExpired": () => (/* binding */ ticketStatusExpired),
/* harmony export */   "ticketStatusImmature": () => (/* binding */ ticketStatusImmature),
/* harmony export */   "ticketStatusLive": () => (/* binding */ ticketStatusLive),
/* harmony export */   "ticketStatusMissed": () => (/* binding */ ticketStatusMissed),
/* harmony export */   "ticketStatusRevoked": () => (/* binding */ ticketStatusRevoked),
/* harmony export */   "ticketStatusTranslationKeys": () => (/* binding */ ticketStatusTranslationKeys),
/* harmony export */   "ticketStatusUnknown": () => (/* binding */ ticketStatusUnknown),
/* harmony export */   "ticketStatusUnmined": () => (/* binding */ ticketStatusUnmined),
/* harmony export */   "ticketStatusUnspent": () => (/* binding */ ticketStatusUnspent),
/* harmony export */   "ticketStatusVoted": () => (/* binding */ ticketStatusVoted),
/* harmony export */   "txTypeAcceleration": () => (/* binding */ txTypeAcceleration),
/* harmony export */   "txTypeApproveToken": () => (/* binding */ txTypeApproveToken),
/* harmony export */   "txTypeCreateBond": () => (/* binding */ txTypeCreateBond),
/* harmony export */   "txTypeMixing": () => (/* binding */ txTypeMixing),
/* harmony export */   "txTypeReceive": () => (/* binding */ txTypeReceive),
/* harmony export */   "txTypeRedeem": () => (/* binding */ txTypeRedeem),
/* harmony export */   "txTypeRedeemBond": () => (/* binding */ txTypeRedeemBond),
/* harmony export */   "txTypeRefund": () => (/* binding */ txTypeRefund),
/* harmony export */   "txTypeRevokeTokenApproval": () => (/* binding */ txTypeRevokeTokenApproval),
/* harmony export */   "txTypeSelfSend": () => (/* binding */ txTypeSelfSend),
/* harmony export */   "txTypeSend": () => (/* binding */ txTypeSend),
/* harmony export */   "txTypeSplit": () => (/* binding */ txTypeSplit),
/* harmony export */   "txTypeString": () => (/* binding */ txTypeString),
/* harmony export */   "txTypeSwap": () => (/* binding */ txTypeSwap),
/* harmony export */   "txTypeSwapOrSend": () => (/* binding */ txTypeSwapOrSend),
/* harmony export */   "txTypeTicketPurchase": () => (/* binding */ txTypeTicketPurchase),
/* harmony export */   "txTypeTicketRevocation": () => (/* binding */ txTypeTicketRevocation),
/* harmony export */   "txTypeTicketVote": () => (/* binding */ txTypeTicketVote),
/* harmony export */   "txTypeUnknown": () => (/* binding */ txTypeUnknown)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









const animationLength = 300;
const traitRescanner = 1;
const traitLogFiler = 1 << 2;
const traitRecoverer = 1 << 5;
const traitWithdrawer = 1 << 6;
const traitRestorer = 1 << 8;
const traitTxFeeEstimator = 1 << 9;
const traitPeerManager = 1 << 10;
const traitTokenApprover = 1 << 13;
const traitTicketBuyer = 1 << 15;
const traitHistorian = 1 << 16;
const traitFundsMixer = 1 << 17;
const traitsExtraOpts = traitLogFiler | traitRecoverer | traitRestorer | traitRescanner | traitPeerManager | traitTokenApprover;
const ticketStatusUnknown = 0;
const ticketStatusUnmined = 1;
const ticketStatusImmature = 2;
const ticketStatusLive = 3;
const ticketStatusVoted = 4;
const ticketStatusMissed = 5;
const ticketStatusExpired = 6;
const ticketStatusUnspent = 7;
const ticketStatusRevoked = 8;
const ticketStatusTranslationKeys = [
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_UNKNOWN,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_UNMINED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_IMMATURE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_LIVE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_VOTED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_MISSED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_EXPIRED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_UNSPENT,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_REVOKED
];
const txTypeUnknown = 0;
const txTypeSend = 1;
const txTypeReceive = 2;
const txTypeSwap = 3;
const txTypeRedeem = 4;
const txTypeRefund = 5;
const txTypeSplit = 6;
const txTypeCreateBond = 7;
const txTypeRedeemBond = 8;
const txTypeApproveToken = 9;
const txTypeAcceleration = 10;
const txTypeSelfSend = 11;
const txTypeRevokeTokenApproval = 12;
const txTypeTicketPurchase = 13;
const txTypeTicketVote = 14;
const txTypeTicketRevocation = 15;
const txTypeSwapOrSend = 16;
const txTypeMixing = 17;
const positiveTxTypes = [
    txTypeReceive,
    txTypeRedeem,
    txTypeRefund,
    txTypeRedeemBond,
    txTypeTicketVote,
    txTypeTicketRevocation
];
const negativeTxTypes = [
    txTypeSend,
    txTypeSwap,
    txTypeCreateBond,
    txTypeTicketPurchase,
    txTypeSwapOrSend
];
const noAmtTxTypes = [
    txTypeSplit,
    txTypeApproveToken,
    txTypeAcceleration,
    txTypeRevokeTokenApproval
];
function txTypeSignAndClass(txType) {
    if (positiveTxTypes.includes(txType))
        return ['+', 'positive-tx'];
    if (negativeTxTypes.includes(txType))
        return ['-', 'negative-tx'];
    return ['', ''];
}
const txTypeTranslationKeys = [
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_UNKNOWN,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SEND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_RECEIVE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SWAP,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REDEEM,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REFUND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SPLIT,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_CREATE_BOND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REDEEM_BOND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_APPROVE_TOKEN,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_ACCELERATION,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SELF_TRANSFER,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REVOKE_TOKEN_APPROVAL,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_TICKET_PURCHASE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_TICKET_VOTE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_TICKET_REVOCATION,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SWAP_OR_SEND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_MIX
];
function txTypeString(txType) {
    return _locales__WEBPACK_IMPORTED_MODULE_5__.prep(txTypeTranslationKeys[txType]);
}
const ticketPageSize = 10;
const scanStartMempool = -1;
let net = 0;
class WalletsPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body, data) {
        super();
        this.body = body;
        this.data = data;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.stampers = [];
        net = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.net;
        const setStamp = () => {
            for (const span of this.stampers) {
                if (span.dataset.stamp) {
                    span.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseInt(span.dataset.stamp || '') * 1000);
                }
            }
        };
        this.secondTicker = window.setInterval(() => {
            setStamp();
        }, 10000); // update every 10 seconds
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.restoreInfoCard, page.connectedIconTmpl, page.disconnectedIconTmpl, page.removeIconTmpl);
        this.restoreInfoCard = page.restoreInfoCard.cloneNode(true);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.connectedIconTmpl, page.disconnectedIconTmpl, page.removeIconTmpl);
        this.forms = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, ':scope > form');
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { this.closePopups(); });
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.cancelForce, 'click', () => { this.closePopups(); });
        this.selectedAssetID = -1;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.iconSelectTmpl, page.balanceDetailRow, page.recentOrderTmpl, page.vspRowTmpl, page.ticketHistoryRowTmpl, page.votingChoiceTmpl, page.votingAgendaTmpl, page.tspendTmpl, page.tkeyTmpl, page.txHistoryRowTmpl, page.txHistoryDateRowTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.createWallet, 'click', () => this.showNewWallet(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.connectBttn, 'click', () => this.doConnect(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.send, 'click', () => this.showSendForm(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.receive, 'click', () => this.showDeposit(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.unlockBttn, 'click', () => this.openWallet(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.lockBttn, 'click', () => this.lock(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.reconfigureBttn, 'click', () => this.showReconfig(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.needsProviderBttn, 'click', () => this.showReconfig(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.rescanWallet, 'click', () => this.rescanWallet(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.earlierTxs, 'click', () => this.loadEarlierTxs());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyTxIDBtn, 'click', () => { var _a; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_a = this.currTx) === null || _a === void 0 ? void 0 : _a.id) || '', page.txDetailsID, page.copyTxIDBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyRecipientBtn, 'click', () => { var _a; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_a = this.currTx) === null || _a === void 0 ? void 0 : _a.recipient) || '', page.txDetailsRecipient, page.copyRecipientBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyBondIDBtn, 'click', () => { var _a, _b; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_b = (_a = this.currTx) === null || _a === void 0 ? void 0 : _a.bondInfo) === null || _b === void 0 ? void 0 : _b.bondID) || '', page.txDetailsBondID, page.copyBondIDBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyBondAccountIDBtn, 'click', () => { var _a, _b; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_b = (_a = this.currTx) === null || _a === void 0 ? void 0 : _a.bondInfo) === null || _b === void 0 ? void 0 : _b.accountID) || '', page.txDetailsBondAccountID, page.copyBondAccountIDBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.hideMixTxsCheckbox, 'change', () => { this.showTxHistory(this.selectedAssetID); });
        // Bind the new wallet form.
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.NewWalletForm(page.newWalletForm, (assetID) => {
            const fmtParams = { assetName: (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].name };
            this.assetUpdated(assetID, page.newWalletForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NEW_WALLET_SUCCESS, fmtParams));
            this.sortAssetButtons();
            this.updateTicketBuyer(assetID);
            this.updatePrivacy(assetID);
        });
        // Bind the wallet reconfig form.
        this.reconfigForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.WalletConfigForm(page.reconfigInputs, false);
        this.walletCfgGuide = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(page.reconfigForm, 'walletCfgGuide');
        // Bind the send form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.sendForm, page.submitSendForm, () => __awaiter(this, void 0, void 0, function* () { this.stepSend(); }));
        // Send confirmation form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.vSendForm, page.vSend, () => __awaiter(this, void 0, void 0, function* () { this.send(); }));
        // Bind the wallet reconfiguration submission.
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.reconfigForm, page.submitReconfig, () => this.reconfig());
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => this.closePopups());
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                this.closePopups();
            }
        });
        this.mixerToggle = new _doc__WEBPACK_IMPORTED_MODULE_0__.AniToggle(page.toggleMixer, page.mixingErr, false, (newState) => { return this.updateMixerState(newState); });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.forms))
                    this.closePopups();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.downloadLogs, 'click', () => __awaiter(this, void 0, void 0, function* () { this.downloadLogs(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.displayExportWalletAuth(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.recoverWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showRecoverWallet(); }));
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.exportWalletAuth, page.exportWalletAuthSubmit, () => __awaiter(this, void 0, void 0, function* () { this.exportWalletAuthSubmit(); }));
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.recoverWalletConfirm, page.recoverWalletSubmit, () => { this.recoverWallet(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.confirmForce, page.confirmForceSubmit, () => __awaiter(this, void 0, void 0, function* () { this.confirmForceSubmit(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.disableWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showToggleWalletStatus(true); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.enableWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showToggleWalletStatus(false); }));
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.toggleWalletStatusConfirm, page.toggleWalletStatusSubmit, () => __awaiter(this, void 0, void 0, function* () { this.toggleWalletStatus(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.managePeers, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showManagePeersForm(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addPeerSubmit, 'click', () => __awaiter(this, void 0, void 0, function* () { this.submitAddPeer(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.unapproveTokenAllowance, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showUnapproveTokenAllowanceTableForm(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.unapproveTokenSubmit, 'click', () => __awaiter(this, void 0, void 0, function* () { this.submitUnapproveTokenAllowance(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showVSPs, 'click', () => { this.showVSPPicker(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.vspDisplay, 'click', () => { this.showVSPPicker(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.vspPicker, page.customVspSubmit, () => __awaiter(this, void 0, void 0, function* () { this.setCustomVSP(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.purchaseTicketsBttn, 'click', () => { this.showPurchaseTicketsDialog(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.purchaseTicketsForm, page.purchaserSubmit, () => { this.purchaseTickets(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.purchaserInput, 'change', () => { this.purchaserInputChanged(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ticketHistory, 'click', () => { this.showTicketHistory(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ticketHistoryNextPage, 'click', () => { this.nextTicketPage(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ticketHistoryPrevPage, 'click', () => { this.prevTicketPage(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.setVotes, 'click', () => { this.showSetVotesDialog(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.purchaseTicketsErrCloser, 'click', () => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.purchaseTicketsErrBox); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.privacyInfoBttn, 'click', () => { this.showForm(page.mixingInfo); });
        // New deposit address button.
        this.depositAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DepositAddress(page.deposit);
        // Clicking on the available amount on the Send form populates the
        // amount field.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.walletBal, 'click', () => { this.populateMaxSend(); });
        // Display fiat value for current send amount.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.sendAmt, 'input', () => {
            const { unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            const amt = (0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.sendAmt.value);
            const conversionFactor = ui.conventional.conversionFactor;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, amt * conversionFactor, (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[this.selectedAssetID], ui);
        });
        // Clicking on maxSend on the send form should populate the amount field.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.maxSend, 'click', () => { this.populateMaxSend(); });
        // Validate send address on input.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.sendAddr, 'input', () => __awaiter(this, void 0, void 0, function* () {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            page.sendAddr.classList.remove('border-danger', 'border-success');
            const addr = page.sendAddr.value || '';
            if (!asset || addr === '')
                return;
            const valid = yield this.validateSendAddress(addr, asset.id);
            if (valid)
                page.sendAddr.classList.add('border-success');
            else
                page.sendAddr.classList.add('border-danger');
        }));
        // A link on the wallet reconfiguration form to show/hide the password field.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showChangePW, 'click', () => {
            this.changeWalletPW = !this.changeWalletPW;
            this.setPWSettingViz(this.changeWalletPW);
        });
        // Changing the type of wallet.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.changeWalletTypeSelect, 'change', () => {
            this.changeWalletType();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showChangeType, 'click', () => {
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.changeWalletType)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.changeWalletType, page.changeTypeHideIcon);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.changeTypeShowIcon);
                page.changeTypeMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_KEEP_WALLET_TYPE);
            }
            else
                this.showReconfig(this.selectedAssetID, { skipAnimation: true });
        });
        (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().registerNoteFeeder({
            fiatrateupdate: (note) => { this.handleRatesNote(note); },
            balance: (note) => { this.handleBalanceNote(note); },
            walletstate: (note) => { this.handleWalletStateNote(note); },
            walletconfig: (note) => { this.handleWalletStateNote(note); },
            walletsync: (note) => { this.updateSyncAndPeers(note.assetID); },
            createwallet: (note) => { this.handleCreateWalletNote(note); },
            walletnote: (note) => { this.handleCustomWalletNote(note); }
        });
        const firstAsset = this.sortAssetButtons();
        let selectedAsset = firstAsset.id;
        const assetIDStr = _state__WEBPACK_IMPORTED_MODULE_4__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_4__["default"].selectedAssetLK);
        if (assetIDStr)
            selectedAsset = Number(assetIDStr);
        this.setSelectedAsset(selectedAsset);
        setInterval(() => {
            for (const row of this.page.txHistoryTableBody.children) {
                const age = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(row, 'age');
                age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseInt(age.dataset.timestamp));
            }
        }, 5000);
    }
    closePopups() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
        this.currTx = undefined;
        if (this.animation)
            this.animation.stop();
    }
    safePost(path, args) {
        return __awaiter(this, void 0, void 0, function* () {
            const assetID = this.selectedAssetID;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(path, args);
            if (assetID !== this.selectedAssetID)
                throw Error('asset changed during request. aborting');
            return res;
        });
    }
    // stepSend makes a request to get an estimated fee and displays the confirm
    // send form.
    stepSend() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vSendErr, page.sendErr, page.vSendEstimates, page.txFeeNotAvailable);
            const assetID = parseInt(page.sendForm.dataset.assetID || '');
            const token = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].token;
            const subtract = page.subtractCheckBox.checked || false;
            const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID).conventional.conversionFactor;
            const value = Math.round((0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.sendAmt.value, 0) * conversionFactor);
            const addr = page.sendAddr.value || '';
            if (addr === '')
                return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: addr }));
            const { wallet, unitInfo: ui, symbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            // txfee will not be available if wallet is not a fee estimator or the
            // request failed.
            let txfee = 0;
            if ((wallet.traits & traitTxFeeEstimator) !== 0) {
                const open = {
                    addr: page.sendAddr.value,
                    assetID: assetID,
                    subtract: subtract,
                    value: value
                };
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.sendForm);
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/txfee', open);
                loaded();
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                    page.txFeeNotAvailable.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TXFEE_ERR_MSG, { err: res.msg });
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txFeeNotAvailable);
                    // We still want to ensure user address is valid before proceeding to send
                    // confirm form if there's an error while calculating the transaction fee.
                    const valid = yield this.validateSendAddress(addr, assetID);
                    if (!valid)
                        return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: addr || '' }));
                }
                else if (res.ok) {
                    if (!res.validaddress)
                        return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: page.sendAddr.value || '' }));
                    txfee = res.txfee;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vSendEstimates);
                }
            }
            else {
                // Validate only the send address for assets that are not fee estimators.
                const valid = yield this.validateSendAddress(addr, assetID);
                if (!valid)
                    return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: addr || '' }));
            }
            page.vSendSymbol.textContent = symbol.toUpperCase();
            page.vSendLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            if (token) {
                const { unitInfo: feeUI, symbol: feeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID];
                page.vSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(txfee, feeUI) + ' ' + feeSymbol;
            }
            else {
                page.vSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(txfee, ui);
            }
            const xcRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.vSendFeeFiat, txfee, xcRate, ui);
            page.vSendDestinationAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(value - txfee, ui);
            page.vTotalSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(value, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.vTotalSendFiat, value, xcRate, ui);
            page.vSendAddr.textContent = page.sendAddr.value || '';
            const bal = wallet.balance.available - value;
            page.balanceAfterSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(bal, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.balanceAfterSendFiat, bal, xcRate, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approxSign);
            // NOTE: All tokens take this route because they cannot pay the fee.
            if (!subtract) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approxSign);
                page.vSendDestinationAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(value, ui);
                let totalSend = value;
                if (!token)
                    totalSend += txfee;
                page.vTotalSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(totalSend, ui);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.vTotalSendFiat, totalSend, xcRate, ui);
                let bal = wallet.balance.available - value;
                if (!token)
                    bal -= txfee;
                // handle edge cases where bal is not enough to cover totalSend.
                // we don't want a minus display of user bal.
                if (bal <= 0) {
                    page.balanceAfterSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(0, ui);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.balanceAfterSendFiat, 0, xcRate, ui);
                }
                else {
                    page.balanceAfterSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(bal, ui);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.balanceAfterSendFiat, bal, xcRate, ui);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sendForm);
            yield this.showForm(page.vSendForm);
        });
    }
    // cancelSend displays the send form if user wants to make modification.
    cancelSend() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vSendForm, page.sendErr);
            yield this.showForm(page.sendForm);
        });
    }
    /*
     * validateSendAddress validates the provided address for an asset.
     */
    validateSendAddress(addr, assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const resp = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/validateaddress', { addr: addr, assetID: assetID });
            return (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(resp);
        });
    }
    /*
     * setPWSettingViz sets the visibility of the password field section.
     */
    setPWSettingViz(visible) {
        const page = this.page;
        if (visible) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showIcon);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.hideIcon, page.changePW);
            page.switchPWMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_KEEP_WALLET_PASS);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.hideIcon, page.changePW);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showIcon);
        page.switchPWMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NEW_WALLET_PASS);
    }
    /*
     * assetVersionUsedByDEXes returns a map of the versions of the
     * currently selected asset to the DEXes that use that version.
     */
    assetVersionUsedByDEXes() {
        const assetID = this.selectedAssetID;
        const versionToDEXes = {};
        const exchanges = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().exchanges;
        for (const host in exchanges) {
            const exchange = exchanges[host];
            const exchangeAsset = exchange.assets[assetID];
            if (!exchangeAsset)
                continue;
            if (!versionToDEXes[exchangeAsset.version]) {
                versionToDEXes[exchangeAsset.version] = [];
            }
            versionToDEXes[exchangeAsset.version].push(exchange.host);
        }
        return versionToDEXes;
    }
    /*
     * submitUnapproveTokenAllowance submits a request to the server to
     * unapprove a version of the currently selected token's swap contract.
     */
    submitUnapproveTokenAllowance() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const path = '/api/unapprovetoken';
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(path, {
                assetID: this.selectedAssetID,
                version: this.unapprovingTokenVersion
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.unapproveTokenErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenErr);
                return;
            }
            const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[this.selectedAssetID];
            if (assetExplorer && assetExplorer[net]) {
                page.unapproveTokenTxID.href = assetExplorer[net](res.txID);
            }
            page.unapproveTokenTxID.textContent = res.txID;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.unapproveTokenSubmissionElements, page.unapproveTokenErr);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenTxMsg);
        });
    }
    /*
     * showUnapproveTokenAllowanceForm displays the form for unapproving
     * a specific version of the currently selected token's swap contract.
     */
    showUnapproveTokenAllowanceForm(version) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.unapprovingTokenVersion = version;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenSubmissionElements);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.unapproveTokenTxMsg, page.unapproveTokenErr);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            if (!asset || !asset.token)
                return;
            const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[asset.token.parentID];
            if (!parentAsset)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.tokenAllowanceRemoveSymbol);
            page.tokenAllowanceRemoveSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset, true));
            page.tokenAllowanceRemoveVersion.textContent = version.toString();
            const path = '/api/approvetokenfee';
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(path, {
                assetID: this.selectedAssetID,
                version: version,
                approving: false
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.unapproveTokenErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenErr);
            }
            else {
                let feeText = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(res.txFee, parentAsset.unitInfo)} ${parentAsset.unitInfo.conventional.unit}`;
                const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[parentAsset.id];
                if (rate) {
                    feeText += ` (${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(res.txFee, rate, parentAsset.unitInfo)} USD)`;
                }
                page.unapprovalFeeEstimate.textContent = feeText;
            }
            this.showForm(page.unapproveTokenForm);
        });
    }
    /*
     * showUnapproveTokenAllowanceTableForm displays a table showing each of the
     * versions of a token's swap contract that have been approved and allows the
     * user to unapprove any of them.
     */
    showUnapproveTokenAllowanceTableForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            if (!asset || !asset.wallet || !asset.wallet.approved)
                return;
            while (page.tokenVersionBody.firstChild) {
                page.tokenVersionBody.removeChild(page.tokenVersionBody.firstChild);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.tokenVersionTableAssetSymbol);
            page.tokenVersionTableAssetSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset, true));
            const versionToDEXes = this.assetVersionUsedByDEXes();
            let showTable = false;
            for (let i = 0; i <= asset.wallet.version; i++) {
                const approvalStatus = asset.wallet.approved[i];
                if (approvalStatus === undefined || approvalStatus !== _registry__WEBPACK_IMPORTED_MODULE_7__.ApprovalStatus.Approved) {
                    continue;
                }
                showTable = true;
                const row = page.tokenVersionRow.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                tmpl.version.textContent = i.toString();
                if (versionToDEXes[i]) {
                    tmpl.usedBy.textContent = versionToDEXes[i].join(', ');
                }
                const removeIcon = this.page.removeIconTmpl.cloneNode(true);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(removeIcon, 'click', () => {
                    this.showUnapproveTokenAllowanceForm(i);
                });
                tmpl.remove.appendChild(removeIcon);
                page.tokenVersionBody.appendChild(row);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(showTable, page.tokenVersionTable);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!showTable, page.tokenVersionNone);
            this.showForm(page.unapproveTokenTableForm);
        });
    }
    /*
     * updateWalletPeers retrieves the wallet peers and displays them in the
     * wallet peers table.
     */
    updateWalletPeersTable() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.peerSpinner);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/getwalletpeers', {
                assetID: this.selectedAssetID
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.managePeersErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.managePeersErr);
                return;
            }
            while (page.peersTableBody.firstChild) {
                page.peersTableBody.removeChild(page.peersTableBody.firstChild);
            }
            const peers = res.peers || [];
            peers.sort((a, b) => {
                return a.source - b.source;
            });
            const defaultText = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_DEFAULT);
            const addedText = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ADDED);
            const discoveredText = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_DISCOVERED);
            peers.forEach((peer) => {
                const row = page.peerTableRow.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                tmpl.addr.textContent = peer.addr;
                switch (peer.source) {
                    case _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.WalletDefault:
                        tmpl.source.textContent = defaultText;
                        break;
                    case _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.UserAdded:
                        tmpl.source.textContent = addedText;
                        break;
                    case _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.Discovered:
                        tmpl.source.textContent = discoveredText;
                        break;
                }
                let connectionIcon;
                if (peer.connected) {
                    connectionIcon = this.page.connectedIconTmpl.cloneNode(true);
                }
                else {
                    connectionIcon = this.page.disconnectedIconTmpl.cloneNode(true);
                }
                tmpl.connected.appendChild(connectionIcon);
                if (peer.source === _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.UserAdded) {
                    const removeIcon = this.page.removeIconTmpl.cloneNode(true);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(removeIcon, 'click', () => __awaiter(this, void 0, void 0, function* () {
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.managePeersErr);
                        const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/removewalletpeer', {
                            assetID: this.selectedAssetID,
                            addr: peer.addr
                        });
                        if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                            page.managePeersErr.textContent = res.msg;
                            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.managePeersErr);
                            return;
                        }
                        this.spinUntilPeersUpdate();
                    }));
                    tmpl.remove.appendChild(removeIcon);
                }
                page.peersTableBody.appendChild(row);
            });
        });
    }
    // showManagePeersForm displays the manage peers form.
    showManagePeersForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            yield this.updateWalletPeersTable();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.managePeersErr);
            this.showForm(page.managePeersForm);
        });
    }
    // submitAddPeers sends a request for the the wallet to connect to a new
    // peer.
    submitAddPeer() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.managePeersErr);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/addwalletpeer', {
                assetID: this.selectedAssetID,
                addr: page.addPeerInput.value
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.managePeersErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.managePeersErr);
                return;
            }
            this.spinUntilPeersUpdate();
            page.addPeerInput.value = '';
        });
    }
    /*
     * spinUntilPeersUpdate will show the spinner on the manage peers fork.
     * If it is still showing after 10 seconds, the peers table will be updated
     * instead of waiting for a notification.
     */
    spinUntilPeersUpdate() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.peerSpinner);
            setTimeout(() => {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.peerSpinner)) {
                    this.updateWalletPeersTable();
                }
            }, 10000);
        });
    }
    /*
     * showToggleWalletStatus displays the toggleWalletStatusConfirm form with
     * relevant help message.
     */
    showToggleWalletStatus(disable) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr, page.walletStatusDisable, page.disableWalletMsg, page.walletStatusEnable, page.enableWalletMsg);
        if (disable)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletStatusDisable, page.disableWalletMsg);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletStatusEnable, page.enableWalletMsg);
        this.showForm(page.toggleWalletStatusConfirm);
    }
    /*
     * toggleWalletStatus toggles a wallets status to either disabled or enabled.
     */
    toggleWalletStatus() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            const disable = !asset.wallet.disabled;
            const url = '/api/togglewalletstatus';
            const req = {
                assetID: this.selectedAssetID,
                disable: disable
            };
            const fmtParams = { assetName: asset.name };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.toggleWalletStatusConfirm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                if (res.code === _http__WEBPACK_IMPORTED_MODULE_2__.Errors.activeOrdersErr)
                    page.toggleWalletStatusErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ACTIVE_ORDERS_ERR_MSG, fmtParams);
                else
                    page.toggleWalletStatusErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.toggleWalletStatusErr);
                return;
            }
            let successMsg = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_DISABLED_MSG, fmtParams);
            if (!disable)
                successMsg = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_ENABLED_MSG, fmtParams);
            this.assetUpdated(this.selectedAssetID, page.toggleWalletStatusConfirm, successMsg);
        });
    }
    /*
     * showBox shows the box with a fade-in animation.
     */
    showBox(box, focuser) {
        return __awaiter(this, void 0, void 0, function* () {
            box.style.opacity = '0';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(box);
            if (focuser)
                focuser.focus();
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                box.style.opacity = `${progress}`;
            }, 'easeOut');
            box.style.opacity = '1';
            this.displayed = box;
        });
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.currentForm = form;
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    showSuccess(msg) {
        return __awaiter(this, void 0, void 0, function* () {
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            this.currentForm = this.page.checkmarkForm;
            this.animation = (0,_forms__WEBPACK_IMPORTED_MODULE_3__.showSuccess)(this.page, msg);
            yield this.animation.wait();
            this.animation = new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(1500, () => { }, '', () => {
                if (this.currentForm === this.page.checkmarkForm)
                    this.closePopups();
            });
        });
    }
    /* Show the new wallet form. */
    showNewWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const box = page.newWalletForm;
            this.newWalletForm.setAsset(assetID);
            const defaultsLoaded = this.newWalletForm.loadDefaults();
            yield this.showForm(box);
            yield defaultsLoaded;
        });
    }
    // sortAssetButtons displays supported assets, sorted. Returns first asset in the
    // list.
    sortAssetButtons() {
        const page = this.page;
        this.assetButtons = {};
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.assetSelect);
        const sortedAssets = [...Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets)];
        sortedAssets.sort((a, b) => {
            if (a.wallet && !b.wallet)
                return -1;
            if (!a.wallet && b.wallet)
                return 1;
            if (!a.wallet && !b.wallet)
                return a.symbol === 'dcr' ? -1 : 1;
            const [aBal, bBal] = [a.wallet.balance, b.wallet.balance];
            const [aTotal, bTotal] = [aBal.available + aBal.immature + aBal.locked, bBal.available + bBal.immature + bBal.locked];
            if (aTotal === 0 && bTotal === 0)
                return a.symbol.localeCompare(b.symbol);
            else if (aTotal === 0)
                return 1;
            else if (aTotal === 0)
                return -1;
            const [aFiat, bFiat] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[a.id], (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[b.id]];
            if (aFiat && !bFiat)
                return -1;
            if (!aFiat && bFiat)
                return 1;
            return bFiat * bTotal - aFiat * aTotal;
        });
        for (const a of sortedAssets) {
            const bttn = page.iconSelectTmpl.cloneNode(true);
            page.assetSelect.appendChild(bttn);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(bttn);
            this.assetButtons[a.id] = { tmpl, bttn };
            this.updateAssetButton(a.id);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(bttn, 'click', () => {
                this.setSelectedAsset(a.id);
                _state__WEBPACK_IMPORTED_MODULE_4__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_4__["default"].selectedAssetLK, String(a.id));
            });
        }
        page.assetSelect.classList.remove('invisible');
        return sortedAssets[0];
    }
    updateAssetButton(assetID) {
        var _a, _b;
        const a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
        const { bttn, tmpl } = this.assetButtons[assetID];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.fiatBox, tmpl.noWallet);
        bttn.classList.add('nowallet');
        (_a = tmpl.img).src || (_a.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(a.symbol)); // don't initiate GET if already set (e.g. update on some notification)
        const symbolParts = a.symbol.split('.');
        if (symbolParts.length === 2) {
            const parentSymbol = symbolParts[1];
            tmpl.parentImg.classList.remove('d-hide');
            (_b = tmpl.parentImg).src || (_b.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentSymbol));
        }
        if (this.selectedAssetID === assetID)
            bttn.classList.add('selected');
        tmpl.name.textContent = a.name;
        if (a.wallet) {
            bttn.classList.remove('nowallet');
            const { wallet: { balance: b }, unitInfo: ui } = a;
            const totalBalance = b.available + b.locked + b.immature;
            const [s, unit] = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestUnitsFourSigFigs(totalBalance, ui);
            tmpl.balance.textContent = s;
            tmpl.unit.textContent = unit;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.balanceBox);
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[a.id];
            if (fiatRate) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.fiatBox);
                tmpl.fiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(totalBalance / ui.conventional.conversionFactor * fiatRate);
            }
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.noWallet);
    }
    setSelectedAsset(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const { assetSelect } = this.page;
            for (const b of assetSelect.children)
                b.classList.remove('selected');
            this.assetButtons[assetID].bttn.classList.add('selected');
            this.selectedAssetID = assetID;
            this.page.hideMixTxsCheckbox.checked = true;
            this.updateDisplayedAsset(assetID);
            this.showAvailableMarkets(assetID);
            const a = this.showRecentActivity(assetID);
            const b = this.showTxHistory(assetID);
            const c = this.updateTicketBuyer(assetID);
            const d = this.updatePrivacy(assetID);
            for (const p of [a, b, c, d])
                yield p;
        });
    }
    updateDisplayedAsset(assetID) {
        if (assetID !== this.selectedAssetID)
            return;
        const { symbol, wallet, name, token, unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
        const { page, body } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(body, '[data-asset-name]', name);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(body, '[data-ticker]', unitInfo.conventional.unit);
        page.assetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.balanceBox, page.fiatBalanceBox, page.createWallet, page.walletDetails, page.sendReceive, page.connectBttnBox, page.statusLocked, page.statusReady, page.statusOff, page.unlockBttnBox, page.lockBttnBox, page.connectBttnBox, page.peerCountBox, page.syncProgressBox, page.statusDisabled, page.tokenInfoBox, page.needsProviderBox, page.feeStateBox, page.txSyncBox, page.txProgress, page.txFindingAddrs);
        this.checkNeedsProvider(assetID);
        if (token) {
            const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID];
            page.tokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
            page.tokenParentName.textContent = parentAsset.name;
            page.contractAddress.textContent = token.contractAddress;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.tokenInfoBox);
        }
        if (wallet) {
            this.updateDisplayedAssetBalance();
            const { feeState, running, disabled, type: walletType } = wallet;
            const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletDefinition(assetID, walletType);
            page.walletType.textContent = walletDef.tab;
            if (feeState)
                this.updateFeeState(feeState);
            if (disabled)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusDisabled); // wallet is disabled
            else if (running) {
                this.updateSyncAndPeers(wallet.assetID);
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusOff, page.connectBttnBox); // wallet not running
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.createWallet); // no wallet
        page.walletDetailsBox.classList.remove('invisible');
    }
    updateSyncAndPeers(assetID) {
        const { page, selectedAssetID } = this;
        if (assetID !== selectedAssetID)
            return;
        const { peerCount, syncProgress, syncStatus, encrypted, open, running } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[assetID];
        if (!running)
            return;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendReceive, page.peerCountBox, page.syncProgressBox);
        page.peerCount.textContent = String(peerCount);
        page.syncProgress.textContent = `${(syncProgress * 100).toFixed(1)}%`;
        if (open) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusReady);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().haveActiveOrders(assetID) && encrypted)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.lockBttnBox);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusLocked, page.unlockBttnBox); // wallet not unlocked
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(syncStatus.txs !== undefined, page.txSyncBox);
        if (syncStatus.txs !== undefined) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txProgress, page.txFindingAddrs);
            if (syncStatus.txs === 0 && syncStatus.blocks >= syncStatus.targetHeight)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txFindingAddrs);
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txProgress);
                const prog = syncStatus.txs / syncStatus.targetHeight;
                page.txProgress.textContent = `${(prog * 100).toFixed(1)}%`;
            }
        }
    }
    updateFeeState(feeState) {
        const { page, selectedAssetID: assetID } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.feeStateBox);
        const { unitInfo: ui, token } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
        const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
        if (!fiatRate)
            return;
        const feeAssetID = token ? token.parentID : assetID;
        const feeFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[feeAssetID];
        if (token && !feeFiatRate)
            return;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.feeStateBox);
        const feeUI = token ? (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID].unitInfo : ui;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestRateElement(page.feeStateNetRate, feeAssetID, feeState.rate, feeUI);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestValueElement(page.feeStateSendFees, feeAssetID, feeState.send, feeUI);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestValueElement(page.feeStateSwapFees, feeAssetID, feeState.swap, feeUI);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestValueElement(page.feeStateRedeemFees, feeAssetID, feeState.redeem, feeUI);
        page.feeStateXcRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(fiatRate);
        const sendFiat = feeState.send / feeUI.conventional.conversionFactor * feeFiatRate;
        page.feeStateSendFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(sendFiat);
        const swapFiat = feeState.swap / feeUI.conventional.conversionFactor * feeFiatRate;
        page.feeStateSwapFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(swapFiat);
        const redeemFiat = feeState.redeem / feeUI.conventional.conversionFactor * feeFiatRate;
        page.feeStateRedeemFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(redeemFiat);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.feeStateBox);
    }
    checkNeedsProvider(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const needs = yield (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().needsCustomProvider(assetID);
            const { page: { needsProviderBox: box, needsProviderBttn: bttn } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(needs, box);
            if (!needs)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(bttn);
        });
    }
    updateTicketBuyer(assetID) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            this.ticketPage = {
                number: 0,
                history: [],
                scanned: false
            };
            const { wallet, unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.stakingBox, page.pickVSP, page.stakingSummary, page.stakingErr, page.vspDisplayBox, page.ticketPriceBox, page.purchaseTicketsBox, page.stakingRpcSpvMsg, page.ticketsDisabled);
            if (!(wallet === null || wallet === void 0 ? void 0 : wallet.running) || (wallet.traits & traitTicketBuyer) === 0)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingBox);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.stakingBox);
            const res = yield this.safePost('/api/stakestatus', assetID);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                // Look for common error for RPC + SPV wallet.
                if (res.msg.includes('disconnected from consensus RPC')) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingRpcSpvMsg);
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingErr);
                page.stakingErr.textContent = res.msg;
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingSummary, page.ticketPriceBox);
            const stakeStatus = res.status;
            this.stakeStatus = stakeStatus;
            page.stakingAgendaCount.textContent = String(stakeStatus.stances.agendas.length);
            page.stakingTspendCount.textContent = String(stakeStatus.stances.tspends.length);
            page.purchaserCurrentPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(stakeStatus.ticketPrice / ui.conventional.conversionFactor);
            page.purchaserBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(wallet.balance.available, ui);
            this.updateTicketStats(stakeStatus.stats, ui, stakeStatus.ticketPrice, stakeStatus.votingSubsidy);
            // If this is an extension wallet, we'll might to disable all controls.
            const disableStaking = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(this.selectedAssetID)) === null || _a === void 0 ? void 0 : _a.disableStaking;
            if (disableStaking) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.setVotes, page.showVSPs);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.ticketsDisabled);
                page.extensionModeAppName.textContent = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.extensionModeConfig.name;
                return;
            }
            this.setVSPViz(stakeStatus.vsp);
        });
    }
    setVSPViz(vsp) {
        const { page, stakeStatus } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vspDisplayBox);
        if (vsp) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vspDisplayBox, page.purchaseTicketsBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.pickVSP);
            page.vspURL.textContent = vsp;
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!stakeStatus.isRPC, page.pickVSP);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(stakeStatus.isRPC, page.purchaseTicketsBox);
    }
    updateTicketStats(stats, ui, ticketPrice, votingSubsidy) {
        const { page, stakeStatus } = this;
        stakeStatus.stats = stats;
        if (ticketPrice)
            stakeStatus.ticketPrice = ticketPrice;
        if (votingSubsidy)
            stakeStatus.votingSubsidy = votingSubsidy;
        const liveTicketCount = stakeStatus.tickets.filter((tkt) => tkt.status <= ticketStatusLive && tkt.status >= ticketStatusUnmined).length;
        page.stakingTicketCount.textContent = String(liveTicketCount);
        page.immatureTicketCount.textContent = String(stats.mempool);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(stats.mempool > 0, page.immatureTicketCountBox);
        page.queuedTicketCount.textContent = String(stats.queued);
        page.formQueuedTix.textContent = String(stats.queued);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(stats.queued > 0, page.formQueueTixBox, page.queuedTicketCountBox);
        page.totalTicketCount.textContent = String(stats.ticketCount);
        page.totalTicketRewards.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(stats.totalRewards / ui.conventional.conversionFactor);
        page.totalTicketVotes.textContent = String(stats.votes);
        if (ticketPrice)
            page.ticketPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(ticketPrice / ui.conventional.conversionFactor);
        if (votingSubsidy)
            page.votingSubsidy.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(votingSubsidy / ui.conventional.conversionFactor);
    }
    showVSPPicker() {
        return __awaiter(this, void 0, void 0, function* () {
            const assetID = this.selectedAssetID;
            const page = this.page;
            this.showForm(page.vspPicker);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.vspPickerList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.stakingErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.vspPicker);
            const res = yield this.safePost('/api/listvsps', assetID);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingErr);
                page.stakingErr.textContent = res.msg;
                return;
            }
            const vsps = res.vsps;
            for (const vsp of vsps) {
                const row = page.vspRowTmpl.cloneNode(true);
                page.vspPickerList.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                tmpl.url.textContent = vsp.url;
                tmpl.feeRate.textContent = vsp.feePercentage.toFixed(2);
                tmpl.voting.textContent = String(vsp.voting);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.stakingErr);
                    this.setVSP(assetID, vsp);
                });
            }
        });
    }
    showPurchaseTicketsDialog() {
        const page = this.page;
        page.purchaserInput.value = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.purchaserErr);
        this.showForm(this.page.purchaseTicketsForm);
        page.purchaserInput.focus();
    }
    purchaserInputChanged() {
        const page = this.page;
        const n = parseInt(page.purchaserInput.value || '0');
        if (n <= 1) {
            page.purchaserInput.value = '1';
            return;
        }
        page.purchaserInput.value = String(n);
    }
    purchaseTickets() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, selectedAssetID: assetID } = this;
            // DRAFT NOTE: The user will get an actual ticket count somewhere in the
            // range 1 <= tickets_purchased <= n. See notes in
            // (*spvWallet).PurchaseTickets.
            // How do we handle this at the UI. Or do we handle it all in the backend
            // somehow?
            const n = parseInt(page.purchaserInput.value || '0');
            if (n < 1)
                return;
            // TODO: Add confirmation dialog.
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.purchaseTicketsForm);
            const res = yield this.safePost('/api/purchasetickets', { assetID, n });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.purchaserErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.purchaserErr);
                return;
            }
            this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKETS_PURCHASED, { n: n.toLocaleString(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages()) }));
        });
    }
    processTicketPurchaseUpdate(walletNote) {
        const { stakeStatus, selectedAssetID, page } = this;
        const { assetID } = walletNote;
        const { err, remaining, tickets, stats } = walletNote.payload;
        if (assetID !== selectedAssetID)
            return;
        if (err) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.purchaseTicketsErrBox);
            page.purchaseTicketsErr.textContent = err;
            return;
        }
        if (tickets)
            stakeStatus.tickets = tickets.concat(stakeStatus.tickets);
        if (stats)
            this.updateTicketStats(stats, (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].unitInfo);
        stakeStatus.stats.queued = remaining;
        page.queuedTicketCount.textContent = String(remaining);
        page.formQueuedTix.textContent = String(remaining);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(remaining > 0, page.queuedTicketCountBox);
    }
    setVSP(assetID, vsp) {
        return __awaiter(this, void 0, void 0, function* () {
            this.closePopups();
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.stakingBox);
            const res = yield this.safePost('/api/setvsp', { assetID, url: vsp.url });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingErr);
                page.stakingErr.textContent = res.msg;
                return;
            }
            this.setVSPViz(vsp.url);
        });
    }
    setCustomVSP() {
        const assetID = this.selectedAssetID;
        const vsp = { url: this.page.customVspUrl.value };
        this.setVSP(assetID, vsp);
    }
    pageOfTickets(pgNum) {
        const { stakeStatus, ticketPage } = this;
        let startOffset = pgNum * ticketPageSize;
        const pageOfTickets = [];
        if (startOffset < stakeStatus.tickets.length) {
            pageOfTickets.push(...stakeStatus.tickets.slice(startOffset, startOffset + ticketPageSize));
            if (pageOfTickets.length < ticketPageSize) {
                const need = ticketPageSize - pageOfTickets.length;
                pageOfTickets.push(...ticketPage.history.slice(0, need));
            }
        }
        else {
            startOffset -= stakeStatus.tickets.length;
            pageOfTickets.push(...ticketPage.history.slice(startOffset, startOffset + ticketPageSize));
        }
        return pageOfTickets;
    }
    displayTicketPage(pageNumber, pageOfTickets) {
        const { page, selectedAssetID: assetID } = this;
        const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID);
        const coinLink = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[assetID][(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.net];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.ticketHistoryRows);
        page.ticketHistoryPage.textContent = String(pageNumber);
        for (const { tx, status } of pageOfTickets) {
            const tr = page.ticketHistoryRowTmpl.cloneNode(true);
            page.ticketHistoryRows.appendChild(tr);
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindUrlHandlers(tr);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(tx.stamp * 1000);
            tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(tx.ticketPrice, ui);
            tmpl.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(ticketStatusTranslationKeys[status]);
            tmpl.hashStart.textContent = tx.hash.slice(0, 6);
            tmpl.hashEnd.textContent = tx.hash.slice(-6);
            tmpl.detailsLinkUrl.setAttribute('href', coinLink(tx.hash));
        }
    }
    ticketPageN(pageNumber) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, stakeStatus, ticketPage, selectedAssetID: assetID } = this;
            const pageOfTickets = this.pageOfTickets(pageNumber);
            if (pageOfTickets.length < ticketPageSize && !ticketPage.scanned) {
                const n = ticketPageSize - pageOfTickets.length;
                const lastList = ticketPage.history.length > 0 ? ticketPage.history : stakeStatus.tickets;
                const scanStart = lastList.length > 0 ? lastList[lastList.length - 1].tx.blockHeight : scanStartMempool;
                const skipN = lastList.filter((tkt) => tkt.tx.blockHeight === scanStart).length;
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.ticketHistoryForm);
                const res = yield this.safePost('/api/ticketpage', { assetID, scanStart, n, skipN });
                loaded();
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                    console.error('error fetching ticket page', res.msg);
                    return;
                }
                this.ticketPage.history.push(...res.tickets);
                pageOfTickets.push(...res.tickets);
                if (res.tickets.length < n)
                    this.ticketPage.scanned = true;
            }
            const totalTix = stakeStatus.tickets.length + ticketPage.history.length;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(totalTix >= ticketPageSize, page.ticketHistoryPagination);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(totalTix > 0, page.ticketHistoryTable);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(totalTix === 0, page.noTicketsMessage);
            if (pageOfTickets.length === 0) {
                // Probably ended with a page of size ticketPageSize, so didn't know we
                // had hit the end until the user clicked the arrow and we went looking
                // for the next. Would be good to figure out a way to hide the arrow in
                // that case.
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.ticketHistoryNextPage);
                return;
            }
            this.displayTicketPage(pageNumber, pageOfTickets);
            ticketPage.number = pageNumber;
            const atEnd = pageNumber * ticketPageSize + pageOfTickets.length === totalTix;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!atEnd || !ticketPage.scanned, page.ticketHistoryNextPage);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(pageNumber > 0, page.ticketHistoryPrevPage);
        });
    }
    showTicketHistory() {
        return __awaiter(this, void 0, void 0, function* () {
            this.showForm(this.page.ticketHistoryForm);
            yield this.ticketPageN(this.ticketPage.number);
        });
    }
    nextTicketPage() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.ticketPageN(this.ticketPage.number + 1);
        });
    }
    prevTicketPage() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.ticketPageN(this.ticketPage.number - 1);
        });
    }
    showSetVotesDialog() {
        var _a;
        const { page, stakeStatus, selectedAssetID: assetID } = this;
        const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.votingFormErr);
        const coinLink = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[assetID][(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.net];
        const upperCase = (s) => s.charAt(0).toUpperCase() + s.slice(1);
        const setVotes = (req) => __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.votingFormErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.votingForm);
            const res = yield this.safePost('/api/setvotes', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.votingFormErr);
                page.votingFormErr.textContent = res.msg;
                throw Error(res.msg);
            }
        });
        const setAgendaChoice = (agendaID, choiceID) => __awaiter(this, void 0, void 0, function* () {
            yield setVotes({ assetID, choices: { [agendaID]: choiceID } });
            for (const agenda of stakeStatus.stances.agendas)
                if (agenda.id === agendaID)
                    agenda.currentChoice = choiceID;
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.votingAgendas);
        for (const agenda of stakeStatus.stances.agendas) {
            const div = page.votingAgendaTmpl.cloneNode(true);
            page.votingAgendas.appendChild(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            tmpl.description.textContent = agenda.description;
            for (const choice of agenda.choices) {
                const div = page.votingChoiceTmpl.cloneNode(true);
                tmpl.choices.appendChild(div);
                const choiceTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
                choiceTmpl.id.textContent = upperCase(choice.id);
                choiceTmpl.id.dataset.tooltip = choice.description;
                choiceTmpl.radio.value = choice.id;
                choiceTmpl.radio.name = agenda.id;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(choiceTmpl.radio, 'change', () => {
                    if (!choiceTmpl.radio.checked)
                        return;
                    setAgendaChoice(agenda.id, choice.id);
                });
                if (choice.id === agenda.currentChoice)
                    choiceTmpl.radio.checked = true;
            }
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindTooltips(tmpl.choices);
        }
        const setTspendVote = (txHash, policyID) => __awaiter(this, void 0, void 0, function* () {
            yield setVotes({ assetID, tSpendPolicy: { [txHash]: policyID } });
            for (const tspend of stakeStatus.stances.tspends)
                if (tspend.hash === txHash)
                    tspend.currentPolicy = policyID;
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.votingTspends);
        for (const tspend of stakeStatus.stances.tspends) {
            const div = page.tspendTmpl.cloneNode(true);
            page.votingTspends.appendChild(div);
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindUrlHandlers(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            for (const opt of [tmpl.yes, tmpl.no]) {
                opt.name = tspend.hash;
                if (tspend.currentPolicy === opt.value)
                    opt.checked = true;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(opt, 'change', () => {
                    var _a;
                    if (!opt.checked)
                        return;
                    setTspendVote(tspend.hash, (_a = opt.value) !== null && _a !== void 0 ? _a : '');
                });
            }
            if (tspend.value > 0)
                tmpl.value.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(tspend.value / ui.conventional.conversionFactor);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.value);
            tmpl.hash.textContent = tspend.hash;
            tmpl.explorerLink.setAttribute('href', coinLink(tspend.hash));
        }
        const setTKeyPolicy = (key, policy) => __awaiter(this, void 0, void 0, function* () {
            yield setVotes({ assetID, treasuryPolicy: { [key]: policy } });
            for (const tkey of stakeStatus.stances.treasuryKeys)
                if (tkey.key === key)
                    tkey.policy = policy;
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.votingTKeys);
        for (const keyPolicy of ((_a = stakeStatus.stances.treasuryKeys) !== null && _a !== void 0 ? _a : [])) {
            const div = page.tkeyTmpl.cloneNode(true);
            page.votingTKeys.appendChild(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            for (const opt of [tmpl.yes, tmpl.no]) {
                opt.name = keyPolicy.key;
                if (keyPolicy.policy === opt.value)
                    opt.checked = true;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(opt, 'change', () => {
                    var _a;
                    if (!opt.checked)
                        return;
                    setTKeyPolicy(keyPolicy.key, (_a = opt.value) !== null && _a !== void 0 ? _a : '');
                });
            }
            tmpl.key.textContent = keyPolicy.key;
        }
        this.showForm(page.votingForm);
    }
    updatePrivacy(assetID) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const disablePrivacy = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(assetID)) === null || _a === void 0 ? void 0 : _a.disablePrivacy;
            this.mixing = false;
            const { wallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mixingBox, page.mixerOff, page.mixerOn);
            // TODO: Show special messaging if the asset supports mixing but not this
            // wallet type.
            if (disablePrivacy || !(wallet === null || wallet === void 0 ? void 0 : wallet.running) || (wallet.traits & traitFundsMixer) === 0)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixingBox, page.mixerLoading);
            const res = yield this.safePost('/api/mixingstats', { assetID });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mixerLoading);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixingErr);
                page.mixingErr.textContent = res.msg;
                return;
            }
            this.mixing = res.stats.enabled;
            if (this.mixing)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixerOn);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixerOff);
            this.mixerToggle.setState(this.mixing);
        });
    }
    updateMixerState(on) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mixingErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.mixingBox);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/configuremixer', { assetID: this.selectedAssetID, enabled: on });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.mixingErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_API_ERROR, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixingErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(on, page.mixerOn);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!on, page.mixerOff);
            this.mixerToggle.setState(on);
        });
    }
    updateDisplayedAssetBalance() {
        var _a, _b, _c;
        const page = this.page;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
        const { wallet, unitInfo: ui, id: assetID } = asset;
        const bal = wallet.balance;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balanceBox, page.walletDetails);
        const totalLocked = bal.locked + bal.contractlocked + bal.bondlocked;
        const totalBalance = bal.available + totalLocked + bal.immature;
        page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(totalBalance, ui);
        page.balanceUnit.textContent = ui.conventional.unit;
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
        if (rate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.fiatBalanceBox);
            page.fiatBalance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(totalBalance, rate, ui);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.balanceDetailBox);
        const addBalanceRow = (cat, bal, tooltipMsg) => {
            const row = page.balanceDetailRow.cloneNode(true);
            page.balanceDetailBox.appendChild(row);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            tmpl.name.textContent = cat;
            if (tooltipMsg) {
                tmpl.tooltipMsg.dataset.tooltip = tooltipMsg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.tooltipMsg);
            }
            tmpl.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bal, ui);
            return row;
        };
        let lastSubLockedRow;
        let lastPrimaryRow;
        const addPrimaryBalance = (cat, bal, tooltipMsg) => {
            lastSubLockedRow = undefined;
            lastPrimaryRow = addBalanceRow(cat, bal, tooltipMsg);
        };
        const addSubBalance = (cat, bal, tooltipMsg) => {
            lastSubLockedRow = addBalanceRow(cat, bal, tooltipMsg);
            lastSubLockedRow.classList.add('sub');
        };
        const setRowClasses = () => {
            if (!lastSubLockedRow)
                return;
            lastPrimaryRow.classList.add('itemized');
            lastSubLockedRow.classList.add('last');
        };
        addPrimaryBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_AVAILABLE_TITLE), bal.available, '');
        if (((_a = bal.other) === null || _a === void 0 ? void 0 : _a.Shielded) !== undefined) {
            const transparent = bal.available - bal.other.Shielded.amt;
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TRANSPARENT), transparent);
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SHIELDED), bal.other.Shielded.amt);
        }
        setRowClasses();
        addPrimaryBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_TITLE), totalLocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_BAL_MSG));
        if (bal.orderlocked > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ORDER), bal.orderlocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_ORDER_BAL_MSG));
        if (bal.contractlocked > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SWAPPING), bal.contractlocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_SWAPPING_BAL_MSG));
        if (bal.bondlocked > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_BONDED), bal.bondlocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_BOND_BAL_MSG));
        if (bal.bondReserves > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_BOND_RESERVES), bal.bondReserves, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_BOND_RESERVES_MSG));
        if (((_b = bal === null || bal === void 0 ? void 0 : bal.other) === null || _b === void 0 ? void 0 : _b.Staked) !== undefined)
            addSubBalance('Staked', bal.other.Staked.amt);
        setRowClasses();
        if (bal.immature)
            addPrimaryBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_IMMATURE_TITLE), bal.immature, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_IMMATURE_BAL_MSG));
        if (((_c = bal === null || bal === void 0 ? void 0 : bal.other) === null || _c === void 0 ? void 0 : _c.Unmixed) !== undefined)
            addSubBalance('Unmixed', bal.other.Unmixed.amt);
        setRowClasses();
        // TODO: handle reserves deficit with a notification.
        // if (bal.reservesDeficit > 0) addPrimaryBalance(intl.prep(intl.ID_RESERVES_DEFICIT), bal.reservesDeficit, intl.prep(intl.ID_RESERVES_DEFICIT_MSG))
        page.purchaserBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bal.available / ui.conventional.conversionFactor);
        (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindTooltips(page.balanceDetailBox);
    }
    showAvailableMarkets(assetID) {
        const page = this.page;
        const exchanges = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.exchanges;
        const markets = [];
        for (const xc of Object.values(exchanges)) {
            if (!xc.markets)
                continue;
            for (const mkt of Object.values(xc.markets)) {
                if (mkt.baseid === assetID || mkt.quoteid === assetID)
                    markets.push([xc.host, xc, mkt]);
            }
        }
        const spotVolume = (assetID, mkt) => {
            const spot = mkt.spot;
            if (!spot)
                return 0;
            const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID).conventional.conversionFactor;
            const volume = assetID === mkt.baseid ? spot.vol24 : spot.vol24 * spot.rate / _orderutil__WEBPACK_IMPORTED_MODULE_6__.RateEncodingFactor;
            return volume / conversionFactor;
        };
        markets.sort((a, b) => {
            const [hostA, , mktA] = a;
            const [hostB, , mktB] = b;
            if (!mktA.spot && !mktB.spot)
                return hostA.localeCompare(hostB);
            return spotVolume(assetID, mktB) - spotVolume(assetID, mktA);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.availableMarkets);
        for (const [host, xc, mkt] of markets) {
            const { spot, baseid, basesymbol, quoteid, quotesymbol } = mkt;
            const row = page.marketRow.cloneNode(true);
            page.availableMarkets.appendChild(row);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            tmpl.host.textContent = host;
            tmpl.baseLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(basesymbol);
            tmpl.quoteLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(quotesymbol);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.baseSymbol, tmpl.quoteSymbol);
            tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(xc.assets[baseid], true));
            tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(xc.assets[quoteid], true));
            if (spot) {
                const convRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().conventionalRate(baseid, quoteid, spot.rate, exchanges[host]);
                tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(convRate);
                const fmtSymbol = (s) => s.split('.')[0].toUpperCase();
                tmpl.priceQuoteUnit.textContent = fmtSymbol(quotesymbol);
                tmpl.priceBaseUnit.textContent = fmtSymbol(basesymbol);
                tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(spotVolume(assetID, mkt));
                tmpl.volumeUnit.textContent = assetID === baseid ? fmtSymbol(basesymbol) : fmtSymbol(quotesymbol);
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.priceBox, tmpl.volumeBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loadPage('markets', { host, baseID: baseid, quoteID: quoteid }));
        }
        page.marketsOverviewBox.classList.remove('invisible');
    }
    showRecentActivity(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.orderActivityBox);
            const filter = {
                n: 20,
                assets: [assetID],
                hosts: [],
                statuses: []
            };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/orders', filter);
            loaded();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noActivity, page.orderActivity);
            if (!res.orders || res.orders.length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noActivity);
                page.orderActivityBox.classList.remove('invisible');
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderActivity);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.recentOrders);
            for (const ord of res.orders) {
                const row = page.recentOrderTmpl.cloneNode(true);
                page.recentOrders.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                let from, to;
                const [baseUnitInfo, quoteUnitInfo] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(ord.baseID), (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(ord.quoteID)];
                if (ord.sell) {
                    [from, to] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.quoteID]];
                    tmpl.fromQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_6__.Limit) {
                        tmpl.toQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_6__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                    }
                }
                else {
                    [from, to] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.quoteID], (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.baseID]];
                    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_6__.Market) {
                        tmpl.fromQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                    }
                    else {
                        tmpl.fromQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_6__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                        tmpl.toQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                    }
                }
                tmpl.fromLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(from.symbol);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.fromSymbol, tmpl.toSymbol);
                tmpl.fromSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(from, true));
                tmpl.toLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(to.symbol);
                tmpl.toSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(to, true));
                tmpl.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_6__.statusString(ord);
                tmpl.filled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_6__.filled(ord) / ord.qty * 100).toFixed(1)}%`;
                tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(ord.submitTime);
                tmpl.link.href = `order/${ord.id}`;
                (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindInternalNavigation(row);
            }
            page.orderActivityBox.classList.remove('invisible');
        });
    }
    updateTxHistoryRow(row, tx, assetID) {
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
        let amtAssetID = assetID;
        let feesAssetID = assetID;
        if (tx.tokenID) {
            amtAssetID = tx.tokenID;
            if (assetID !== tx.tokenID)
                feesAssetID = assetID;
            else {
                const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
                if (asset.token)
                    feesAssetID = asset.token.parentID;
                else
                    console.error(`unable to determine fee asset for tx ${tx.id}`);
            }
        }
        const amtAssetUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(amtAssetID);
        const feesAssetUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(feesAssetID);
        tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(tx.timestamp * 1000);
        tmpl.age.dataset.timestamp = String(tx.timestamp * 1000);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.timestamp === 0, tmpl.pending);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.timestamp !== 0, tmpl.age);
        if (tx.timestamp > 0)
            tmpl.age.dataset.stamp = String(tx.timestamp);
        let txType = txTypeString(tx.type);
        if (tx.tokenID && tx.tokenID !== assetID) {
            const tokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[tx.tokenID];
            const tokenSymbol = tokenAsset.unitInfo.conventional.unit;
            txType = `${tokenSymbol} ${txType}`;
        }
        tmpl.type.textContent = txType;
        tmpl.id.textContent = trimStringWithEllipsis(tx.id, 12);
        tmpl.id.setAttribute('title', tx.id);
        tmpl.fees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.fees, feesAssetUI);
        if (noAmtTxTypes.includes(tx.type)) {
            tmpl.amount.textContent = '-';
        }
        else {
            const [u, c] = txTypeSignAndClass(tx.type);
            const amt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.amount, amtAssetUI);
            tmpl.amount.textContent = `${u}${amt}`;
            if (c !== '')
                tmpl.amount.classList.add(c);
        }
    }
    txHistoryRow(tx, assetID) {
        const row = this.page.txHistoryRowTmpl.cloneNode(true);
        row.dataset.txid = tx.id;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => this.showTxDetailsPopup(tx.id));
        this.updateTxHistoryRow(row, tx, assetID);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
        this.stampers.push(tmpl.age);
        return row;
    }
    txHistoryDateRow(date) {
        const row = this.page.txHistoryDateRowTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
        tmpl.date.textContent = date;
        return row;
    }
    setTxDetailsPopupElements(tx) {
        const page = this.page;
        // Block explorer
        const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[this.selectedAssetID];
        if (assetExplorer && assetExplorer[net]) {
            page.txViewBlockExplorer.href = assetExplorer[net](tx.id);
        }
        // Tx type
        let txType = txTypeString(tx.type);
        if (tx.tokenID && tx.tokenID !== this.selectedAssetID) {
            const tokenSymbol = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[tx.tokenID].symbol.split('.')[0].toUpperCase();
            txType = `${tokenSymbol} ${txType}`;
        }
        page.txDetailsType.textContent = txType;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.type === txTypeSwapOrSend, page.txTypeTooltip);
        page.txTypeTooltip.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SWAP_OR_SEND_TOOLTIP);
        // Amount
        if (noAmtTxTypes.includes(tx.type)) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsAmtSection);
        }
        else {
            let assetID = this.selectedAssetID;
            if (tx.tokenID)
                assetID = tx.tokenID;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsAmtSection);
            const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID);
            const amt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.amount, ui);
            const [s, c] = txTypeSignAndClass(tx.type);
            page.txDetailsAmount.textContent = `${s}${amt} ${ui.conventional.unit}`;
            if (c !== '')
                page.txDetailsAmount.classList.add(c);
        }
        // Fee
        let feeAsset = this.selectedAssetID;
        if (tx.tokenID !== undefined) {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[tx.tokenID];
            if (asset.token) {
                feeAsset = asset.token.parentID;
            }
            else {
                console.error(`wallet transaction ${tx.id} is supposed to be a token tx, but asset ${tx.tokenID} is not a token`);
            }
        }
        const feeUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(feeAsset);
        const fee = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.fees, feeUI);
        page.txDetailsFee.textContent = `${fee} ${feeUI.conventional.unit}`;
        // Time / block number
        page.txDetailsBlockNumber.textContent = `${tx.blockNumber}`;
        const date = new Date(tx.timestamp * 1000);
        const dateStr = date.toLocaleDateString();
        const timeStr = date.toLocaleTimeString();
        page.txDetailsTimestamp.textContent = `${dateStr} ${timeStr}`;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.blockNumber === 0, page.timestampPending, page.blockNumberPending);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.blockNumber !== 0, page.txDetailsBlockNumber, page.txDetailsTimestamp);
        // Tx ID
        page.txDetailsID.textContent = trimStringWithEllipsis(tx.id, 20);
        page.txDetailsID.setAttribute('title', tx.id);
        // Recipient
        if (tx.recipient) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsRecipientSection);
            page.txDetailsRecipient.textContent = trimStringWithEllipsis(tx.recipient, 20);
            page.txDetailsRecipient.setAttribute('title', tx.recipient);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsRecipientSection);
        }
        // Bond Info
        if (tx.bondInfo) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsBondIDSection, page.txDetailsBondLocktimeSection);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.bondInfo.accountID !== '', page.txDetailsBondAccountIDSection);
            page.txDetailsBondID.textContent = trimStringWithEllipsis(tx.bondInfo.bondID, 20);
            page.txDetailsBondID.setAttribute('title', tx.bondInfo.bondID);
            const date = new Date(tx.bondInfo.lockTime * 1000);
            const dateStr = date.toLocaleDateString();
            const timeStr = date.toLocaleTimeString();
            page.txDetailsBondLocktime.textContent = `${dateStr} ${timeStr}`;
            page.txDetailsBondAccountID.textContent = trimStringWithEllipsis(tx.bondInfo.accountID, 20);
            page.txDetailsBondAccountID.setAttribute('title', tx.bondInfo.accountID);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsBondIDSection, page.txDetailsBondLocktimeSection, page.txDetailsBondAccountIDSection);
        }
        // Nonce
        if (tx.additionalData && tx.additionalData.Nonce) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsNonceSection);
            page.txDetailsNonce.textContent = `${tx.additionalData.Nonce}`;
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsNonceSection);
        }
    }
    showTxDetailsPopup(id) {
        const tx = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().getWalletTx(this.selectedAssetID, id);
        if (!tx) {
            console.error(`wallet transaction ${id} not found`);
            return;
        }
        this.currTx = tx;
        this.setTxDetailsPopupElements(tx);
        this.showForm(this.page.txDetails);
    }
    txHistoryTableNewestDate() {
        if (this.page.txHistoryTableBody.children.length >= 1) {
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(this.page.txHistoryTableBody.children[0]);
            return tmpl.date.textContent || '';
        }
        return '';
    }
    txDate(tx) {
        if (tx.timestamp === 0) {
            return (new Date()).toLocaleDateString();
        }
        return (new Date(tx.timestamp * 1000)).toLocaleDateString();
    }
    handleTxNote(tx, newTx) {
        var _a;
        const w = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID].wallet;
        const hideMixing = (w.traits & traitFundsMixer) !== 0 && !!this.page.hideMixTxs.checked;
        if (hideMixing && tx.type === txTypeMixing)
            return;
        if (newTx) {
            if (!this.oldestTx) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.txHistoryTable);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noTxHistory);
                this.page.txHistoryTableBody.appendChild(this.txHistoryDateRow(this.txDate(tx)));
                this.page.txHistoryTableBody.appendChild(this.txHistoryRow(tx, this.selectedAssetID));
                this.oldestTx = tx;
            }
            else if (this.txDate(tx) !== this.txHistoryTableNewestDate()) {
                this.page.txHistoryTableBody.insertBefore(this.txHistoryRow(tx, this.selectedAssetID), this.page.txHistoryTableBody.children[0]);
                this.page.txHistoryTableBody.insertBefore(this.txHistoryDateRow(this.txDate(tx)), this.page.txHistoryTableBody.children[0]);
            }
            else {
                this.page.txHistoryTableBody.insertBefore(this.txHistoryRow(tx, this.selectedAssetID), this.page.txHistoryTableBody.children[1]);
            }
            return;
        }
        for (const row of this.page.txHistoryTableBody.children) {
            const peRow = row;
            if (peRow.dataset.txid === tx.id) {
                this.updateTxHistoryRow(peRow, tx, this.selectedAssetID);
                break;
            }
        }
        if (tx.id === ((_a = this.currTx) === null || _a === void 0 ? void 0 : _a.id)) {
            this.setTxDetailsPopupElements(tx);
        }
    }
    getTxHistory(assetID, hideMixTxs, after) {
        return __awaiter(this, void 0, void 0, function* () {
            let numToFetch = 10;
            if (hideMixTxs)
                numToFetch = 15;
            const res = { txs: [], lastTx: false };
            let ref = after;
            for (let i = 0; i < 40; i++) {
                const currRes = yield (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().txHistory(assetID, numToFetch, ref);
                if (currRes.txs.length > 0) {
                    ref = currRes.txs[currRes.txs.length - 1].id;
                }
                let txs = currRes.txs;
                if (hideMixTxs) {
                    txs = txs.filter((tx) => tx.type !== txTypeMixing);
                }
                if (res.txs.length + txs.length > 10) {
                    const numToPush = 10 - res.txs.length;
                    res.txs.push(...txs.slice(0, numToPush));
                }
                else {
                    if (currRes.lastTx)
                        res.lastTx = true;
                    res.txs.push(...txs);
                }
                if (res.txs.length >= 10 || currRes.lastTx)
                    break;
            }
            return res;
        });
    }
    showTxHistory(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            let txRes;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txHistoryTable, page.txHistoryBox, page.noTxHistory, page.earlierTxs, page.txHistoryNotAvailable, page.hideMixTxs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.txHistoryTableBody);
            const w = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].wallet;
            if (!w || w.disabled || (w.traits & traitHistorian) === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txHistoryNotAvailable);
                return;
            }
            this.oldestTx = undefined;
            const isMixing = (w.traits & traitFundsMixer) !== 0;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(isMixing, page.hideMixTxs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txHistoryBox);
            try {
                const hideMixing = isMixing && !!page.hideMixTxsCheckbox.checked;
                txRes = yield this.getTxHistory(assetID, hideMixing);
            }
            catch (err) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noTxHistory);
                return;
            }
            if (txRes.txs.length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noTxHistory);
                return;
            }
            let oldestDate = this.txDate(txRes.txs[0]);
            page.txHistoryTableBody.appendChild(this.txHistoryDateRow(oldestDate));
            for (const tx of txRes.txs) {
                const date = this.txDate(tx);
                if (date !== oldestDate) {
                    oldestDate = date;
                    page.txHistoryTableBody.appendChild(this.txHistoryDateRow(date));
                }
                const row = this.txHistoryRow(tx, assetID);
                page.txHistoryTableBody.appendChild(row);
            }
            this.oldestTx = txRes.txs[txRes.txs.length - 1];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txHistoryTable);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!txRes.lastTx, page.earlierTxs);
        });
    }
    loadEarlierTxs() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.oldestTx)
                return;
            const page = this.page;
            let txRes;
            const w = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID].wallet;
            const hideMixing = (w.traits & traitFundsMixer) !== 0 && !!page.hideMixTxsCheckbox.checked;
            try {
                txRes = yield this.getTxHistory(this.selectedAssetID, hideMixing, this.oldestTx.id);
            }
            catch (err) {
                console.error(err);
                return;
            }
            let oldestDate = this.txDate(this.oldestTx);
            for (const tx of txRes.txs) {
                const date = this.txDate(tx);
                if (date !== oldestDate) {
                    oldestDate = date;
                    page.txHistoryTableBody.appendChild(this.txHistoryDateRow(date));
                }
                const row = this.txHistoryRow(tx, this.selectedAssetID);
                page.txHistoryTableBody.appendChild(row);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!txRes.lastTx, page.earlierTxs);
            if (txRes.txs.length > 0) {
                this.oldestTx = txRes.txs[txRes.txs.length - 1];
            }
        });
    }
    rescanWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.reconfigErr);
            const url = '/api/rescanwallet';
            const req = { assetID: assetID };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if (res.code === _http__WEBPACK_IMPORTED_MODULE_2__.Errors.activeOrdersErr) {
                this.forceUrl = url;
                this.forceReq = req;
                this.showConfirmForce();
                return;
            }
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.reconfigErr, res.msg);
                return;
            }
            this.assetUpdated(assetID, page.reconfigForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_RESCAN_STARTED));
        });
    }
    showConfirmForce() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.confirmForceErr);
        this.showForm(this.page.confirmForce);
    }
    showRecoverWallet() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.recoverWalletErr);
        this.showForm(this.page.recoverWalletConfirm);
    }
    /* Show the open wallet form if the password is not cached, and otherwise
     * attempt to open the wallet.
     */
    openWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const open = {
                assetID: assetID
            };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/openwallet', open);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                console.error('openwallet error', res);
                return;
            }
            this.assetUpdated(assetID, undefined, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_UNLOCKED));
        });
    }
    /* Show the form used to change wallet configuration settings. */
    showReconfig(assetID, cfg) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.changeWalletType, page.changeTypeHideIcon, page.reconfigErr, page.showChangeType, page.changeTypeHideIcon, page.reconfigErr, page.enableWallet, page.disableWallet);
            // Hide update password section by default
            this.changeWalletPW = false;
            this.setPWSettingViz(this.changeWalletPW);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            const currentDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().currentWalletDefinition(assetID);
            const walletDefs = asset.token ? [asset.token.definition] : asset.info ? asset.info.availablewallets : [];
            const disableWalletType = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(assetID)) === null || _a === void 0 ? void 0 : _a.disableWalletType;
            if (walletDefs.length > 1 && !disableWalletType) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.changeWalletTypeSelect);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showChangeType, page.changeTypeShowIcon);
                page.changeTypeMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CHANGE_WALLET_TYPE);
                for (const wDef of walletDefs) {
                    const option = document.createElement('option');
                    if (wDef.type === currentDef.type)
                        option.selected = true;
                    option.value = option.textContent = wDef.type;
                    page.changeWalletTypeSelect.appendChild(option);
                }
            }
            if (cfg === null || cfg === void 0 ? void 0 : cfg.elevateProviders) {
                for (const opt of (currentDef.configopts))
                    if (opt.key === 'providers')
                        opt.required = true;
            }
            const wallet = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitLogFiler, page.downloadLogs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitRecoverer, page.recoverWallet);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitRestorer, page.exportWallet);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitRescanner, page.rescanWallet);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitPeerManager && !wallet.disabled, page.managePeers);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitTokenApprover && !wallet.disabled, page.unapproveTokenAllowance);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitsExtraOpts, page.otherActionsLabel);
            if (wallet.disabled)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.enableWallet);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.disableWallet);
            this.showOrHideRecoverySupportMsg(wallet, currentDef.seeded);
            page.recfgAssetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            page.recfgAssetName.textContent = asset.name;
            if (!(cfg === null || cfg === void 0 ? void 0 : cfg.skipAnimation))
                this.showForm(page.reconfigForm);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.reconfigForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/walletsettings', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.reconfigErr, res.msg);
                return;
            }
            const assetHasActiveOrders = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().haveActiveOrders(assetID);
            this.reconfigForm.update(asset.id, currentDef.configopts || [], assetHasActiveOrders);
            this.setGuideLink(currentDef.guidelink);
            this.reconfigForm.setConfig(res.map);
            this.updateDisplayedReconfigFields(currentDef);
        });
    }
    showOrHideRecoverySupportMsg(wallet, seeded) {
        this.setRecoverySupportMsgViz(seeded && !wallet.running && !wallet.disabled && Boolean(wallet.traits & traitRecoverer), wallet.symbol);
    }
    setRecoverySupportMsgViz(viz, symbol) {
        const page = this.page;
        if (viz) {
            page.reconfigSupportMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_RECOVERY_SUPPORT_MSG, { walletSymbol: symbol.toLocaleUpperCase() });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.reconfigSupportMsg);
            page.submitReconfig.setAttribute('disabled', '');
            page.submitReconfig.classList.add('grey');
            return;
        }
        page.submitReconfig.removeAttribute('disabled');
        page.submitReconfig.classList.remove('grey');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.reconfigSupportMsg);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.reconfigSupportMsg);
    }
    changeWalletType() {
        const page = this.page;
        const walletType = page.changeWalletTypeSelect.value || '';
        const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletDefinition(this.selectedAssetID, walletType);
        this.reconfigForm.update(this.selectedAssetID, walletDef.configopts || [], false);
        const wallet = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[this.selectedAssetID];
        const currentDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().currentWalletDefinition(this.selectedAssetID);
        if (walletDef.type !== currentDef.type)
            this.setRecoverySupportMsgViz(false, wallet.symbol);
        else
            this.showOrHideRecoverySupportMsg(wallet, walletDef.seeded);
        this.setGuideLink(walletDef.guidelink);
        this.updateDisplayedReconfigFields(walletDef);
    }
    setGuideLink(guideLink) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.walletCfgGuide);
        if (guideLink !== '') {
            this.walletCfgGuide.href = guideLink;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.walletCfgGuide);
        }
    }
    updateDisplayedReconfigFields(walletDef) {
        var _a;
        const disablePassword = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(this.selectedAssetID)) === null || _a === void 0 ? void 0 : _a.disablePassword;
        if (walletDef.seeded || walletDef.type === 'token' || disablePassword) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.showChangePW, this.reconfigForm.fileSelector);
            this.changeWalletPW = false;
            this.setPWSettingViz(false);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.showChangePW, this.reconfigForm.fileSelector);
    }
    /* Display a deposit address. */
    showDeposit(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            this.depositAddrForm.setAsset(assetID);
            this.showForm(this.page.deposit);
        });
    }
    /* Show the form to either send or withdraw funds. */
    showSendForm(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const box = page.sendForm;
            const { wallet, unitInfo: ui, symbol, token } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleSubtract);
            page.subtractCheckBox.checked = false;
            const isWithdrawer = (wallet.traits & traitWithdrawer) !== 0;
            if (isWithdrawer) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.toggleSubtract);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sendErr, page.maxSendDisplay, page.sendTokenMsgBox);
            page.sendAddr.classList.remove('border-danger', 'border-success');
            page.sendAddr.value = '';
            page.sendAmt.value = '';
            const xcRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, 0, xcRate, ui);
            page.walletBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(wallet.balance.available, ui);
            page.sendLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            page.sendName.textContent = ui.conventional.unit;
            if (token) {
                const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID];
                page.sendTokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                page.sendTokenParentName.textContent = parentAsset.name;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendTokenMsgBox);
            }
            // page.sendFee.textContent = wallet.feerate
            // page.sendUnit.textContent = wallet.units
            if (wallet.balance.available > 0 && (wallet.traits & traitTxFeeEstimator) !== 0) {
                const feeReq = {
                    assetID: assetID,
                    subtract: isWithdrawer,
                    maxWithdraw: true,
                    value: wallet.balance.available
                };
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(this.body);
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/txfee', feeReq);
                loaded();
                if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                    let canSend = wallet.balance.available;
                    if (!token) {
                        canSend -= res.txfee;
                        if (canSend < 0)
                            canSend = 0;
                    }
                    this.maxSend = canSend;
                    page.maxSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(canSend, ui);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.maxSendFiat, canSend, xcRate, ui);
                    if (token) {
                        const feeUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID].unitInfo;
                        page.maxSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(res.txfee, feeUI) + ' ' + feeUI.conventional.unit;
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.maxSendFeeFiat, res.txfee, (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[token.parentID], feeUI);
                    }
                    else {
                        page.maxSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(res.txfee, ui);
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.maxSendFeeFiat, res.txfee, xcRate, ui);
                    }
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxSendDisplay);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, 0, xcRate, ui);
            page.walletBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(wallet.balance.available, ui);
            box.dataset.assetID = String(assetID);
            this.showForm(box);
        });
    }
    /* doConnect connects to a wallet via the connectwallet API route. */
    doConnect(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/connectwallet', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                const { symbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
                const page = this.page;
                page.errorModalMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CONNECT_WALLET_ERR_MSG, { assetName: symbol, errMsg: res.msg });
                this.showForm(page.errorModal);
            }
            this.updateDisplayedAsset(assetID);
        });
    }
    assetUpdated(assetID, oldForm, successMsg) {
        if (assetID !== this.selectedAssetID)
            return;
        this.updateDisplayedAsset(assetID);
        if (oldForm && Object.is(this.currentForm, oldForm)) {
            if (successMsg)
                this.showSuccess(successMsg);
            else
                this.closePopups();
        }
    }
    /* populateMaxSend populates the amount field with the max amount the wallet
       can send. The max send amount can be the maximum amount based on our
       pre-estimation or the asset's wallet balance.
    */
    populateMaxSend() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const { id: assetID, unitInfo: ui, wallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            // Populate send amount with max send value and ensure we don't check
            // subtract checkbox for assets that don't have a withdraw method.
            const xcRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
            if ((wallet.traits & traitWithdrawer) === 0) {
                page.sendAmt.value = String(this.maxSend / ui.conventional.conversionFactor);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, this.maxSend, xcRate, ui);
                page.subtractCheckBox.checked = false;
            }
            else {
                const amt = wallet.balance.available;
                page.sendAmt.value = String(amt / ui.conventional.conversionFactor);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, amt, xcRate, ui);
                page.subtractCheckBox.checked = true;
            }
        });
    }
    /* send submits the send form to the API. */
    send() {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const assetID = parseInt((_a = page.sendForm.dataset.assetID) !== null && _a !== void 0 ? _a : '');
            const subtract = (_b = page.subtractCheckBox.checked) !== null && _b !== void 0 ? _b : false;
            const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID).conventional.conversionFactor;
            const pw = page.vSendPw.value || '';
            page.vSendPw.value = '';
            if (pw === '') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.vSendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NO_PASS_ERROR_MSG));
                return;
            }
            const open = {
                assetID: assetID,
                address: page.sendAddr.value,
                subtract: subtract,
                value: Math.round((0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.sendAmt.value) * conversionFactor),
                pw: pw
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.vSendForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/send', open);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.vSendErr, res.msg);
                return;
            }
            const name = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].name;
            this.assetUpdated(assetID, page.vSendForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SEND_SUCCESS, { assetName: name }));
        });
    }
    /* update wallet configuration */
    reconfig() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const assetID = this.selectedAssetID;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.reconfigErr);
            let walletType = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().currentWalletDefinition(assetID).type;
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.changeWalletType)) {
                walletType = page.changeWalletTypeSelect.value || '';
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.reconfigForm);
            const req = {
                assetID: assetID,
                config: this.reconfigForm.map(assetID),
                walletType: walletType
            };
            if (this.changeWalletPW)
                req.newWalletPW = page.newPW.value;
            const res = yield this.safePost('/api/reconfigurewallet', req);
            page.newPW.value = '';
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.reconfigErr, res.msg);
                return;
            }
            if ((_a = this.data) === null || _a === void 0 ? void 0 : _a.goBack) {
                (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loadPage(this.data.goBack);
                return;
            }
            this.assetUpdated(assetID, page.reconfigForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_RECONFIG_SUCCESS));
            this.updateTicketBuyer(assetID);
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().clearTxHistory(assetID);
            this.showTxHistory(assetID);
            this.updatePrivacy(assetID);
            this.checkNeedsProvider(assetID);
        });
    }
    /* lock instructs the API to lock the wallet. */
    lock(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.newWalletForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/closewallet', { assetID: assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res))
                return;
            this.updateDisplayedAsset(assetID);
            this.updatePrivacy(assetID);
        });
    }
    downloadLogs() {
        return __awaiter(this, void 0, void 0, function* () {
            const search = new URLSearchParams('');
            search.append('assetid', `${this.selectedAssetID}`);
            const url = new URL(window.location.href);
            url.search = search.toString();
            url.pathname = '/wallets/logfile';
            window.open(url.toString());
        });
    }
    // displayExportWalletAuth displays a form to warn the user about the
    // dangers of exporting a wallet, and asks them to enter their password.
    displayExportWalletAuth() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.exportWalletErr);
            page.exportWalletPW.value = '';
            this.showForm(page.exportWalletAuth);
        });
    }
    // exportWalletAuthSubmit is called after the user enters their password to
    // authorize looking up the information to restore their wallet in an
    // external wallet.
    exportWalletAuthSubmit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const req = {
                assetID: this.selectedAssetID,
                pass: page.exportWalletPW.value
            };
            const url = '/api/restorewalletinfo';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.forms);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.exportWalletPW.value = '';
                this.displayRestoreWalletInfo(res.restorationinfo);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.exportWalletErr, res.msg);
            }
        });
    }
    // displayRestoreWalletInfo displays the information needed to restore a
    // wallet in external wallets.
    displayRestoreWalletInfo(info) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.restoreInfoCardsList);
            for (const wr of info) {
                const card = this.restoreInfoCard.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(card);
                tmpl.name.textContent = wr.target;
                tmpl.seed.textContent = wr.seed;
                tmpl.seedName.textContent = `${wr.seedName}:`;
                tmpl.instructions.textContent = wr.instructions;
                page.restoreInfoCardsList.appendChild(card);
            }
            this.showForm(page.restoreWalletInfo);
        });
    }
    recoverWallet() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.recoverWalletErr);
            const req = {
                assetID: this.selectedAssetID
            };
            const url = '/api/recoverwallet';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.forms);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if (res.code === _http__WEBPACK_IMPORTED_MODULE_2__.Errors.activeOrdersErr) {
                this.forceUrl = url;
                this.forceReq = req;
                this.showConfirmForce();
            }
            else if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                this.closePopups();
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.recoverWalletErr, res.msg);
            }
        });
    }
    /*
     * confirmForceSubmit resubmits either the recover or rescan requests with
     * force set to true. These two requests require force to be set to true if
     * they are called while the wallet is managing active orders.
     */
    confirmForceSubmit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.forceReq.force = true;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.forms);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(this.forceUrl, this.forceReq);
            loaded();
            if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res))
                this.closePopups();
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.confirmForceErr, res.msg);
            }
        });
    }
    /* handleBalance handles notifications updating a wallet's balance and assets'
       value in default fiat rate.
    . */
    handleBalanceNote(note) {
        this.updateAssetButton(note.assetID);
        if (note.assetID === this.selectedAssetID)
            this.updateDisplayedAssetBalance();
    }
    /* handleRatesNote handles fiat rate notifications, updating the fiat value of
     *  all supported assets.
     */
    handleRatesNote(note) {
        this.updateAssetButton(this.selectedAssetID);
        if (!note.fiatRates[this.selectedAssetID])
            return;
        this.updateDisplayedAssetBalance();
        const { feeState } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[this.selectedAssetID];
        if (feeState)
            this.updateFeeState(feeState);
    }
    /*
     * handleWalletStateNote is a handler for both the 'walletstate' and
     * 'walletconfig' notifications.
     */
    handleWalletStateNote(note) {
        const { assetID, feeState } = note.wallet;
        this.updateAssetButton(assetID);
        this.assetUpdated(assetID);
        if (note.topic === 'WalletPeersUpdate' &&
            assetID === this.selectedAssetID &&
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.managePeersForm)) {
            this.updateWalletPeersTable();
        }
        if (feeState && assetID === this.selectedAssetID)
            this.updateFeeState(feeState);
    }
    /*
     * handleCreateWalletNote is a handler for 'createwallet' notifications.
     */
    handleCreateWalletNote(note) {
        this.updateAssetButton(note.assetID);
        this.assetUpdated(note.assetID);
        this.showTxHistory(note.assetID);
    }
    handleCustomWalletNote(note) {
        const walletNote = note.payload;
        switch (walletNote.route) {
            case 'tipChange': {
                const n = walletNote;
                switch (n.assetID) {
                    case 42: { // dcr
                        if (!this.stakeStatus)
                            return;
                        const data = n.data;
                        const synced = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[n.assetID].synced;
                        if (synced) {
                            const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(n.assetID);
                            this.updateTicketStats(data.stats, ui, data.ticketPrice, data.votingSubsidy);
                        }
                    }
                }
                break;
            }
            case 'ticketPurchaseUpdate': {
                this.processTicketPurchaseUpdate(walletNote);
                break;
            }
            case 'transaction': {
                const n = walletNote;
                if (n.assetID === this.selectedAssetID)
                    this.handleTxNote(n.transaction, n.new);
                break;
            }
            case 'transactionHistorySynced': {
                const n = walletNote;
                if (n.assetID === this.selectedAssetID)
                    this.showTxHistory(n.assetID);
                break;
            }
        }
    }
    /*
     * unload is called by the Application when the user navigates away from
     * the /wallets page.
     */
    unload() {
        clearInterval(this.secondTicker);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
}
function trimStringWithEllipsis(str, maxLen) {
    if (str.length <= maxLen)
        return str;
    return `${str.substring(0, maxLen / 2)}...${str.substring(str.length - maxLen / 2)}`;
}


/***/ }),

/***/ "./src/js/ws.ts":
/*!**********************!*\
  !*** ./src/js/ws.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// MessageSocket is a WebSocket manager that uses the Decred DEX Message format
// for communications.
//
// Message request format:
// {
//   route: 'name',
//   id: int,
//   payload: anything or nothing
// }
//
// Message response payload will be a result object with either a valid 'result'
// field or an 'error' field
//
// Functions for external use:
// registerRoute (route, handler) -- register a function to handle events
// of the given type
// request (route, payload) -- create a JSON message in the above format and
// send it
//
// Based on messagesocket_service.js by Jonathan Chappelow @ dcrdata, which is
// based on ws_events_dispatcher.js by Ismael Celis
const typeRequest = 1;
function forward(route, payload, handlers) {
    if (!route && payload.error) {
        const err = payload.error;
        console.error(`websocket error (code ${err.code}): ${err.message}`);
        return;
    }
    if (typeof handlers[route] === 'undefined') {
        // console.log(`unhandled message for ${route}: ${payload}`)
        return;
    }
    // call each handler
    for (let i = 0; i < handlers[route].length; i++) {
        handlers[route][i](payload);
    }
}
let id = 0;
class MessageSocket {
    constructor() {
        this.handlers = {};
        this.queue = [];
        this.maxQlength = 5;
    }
    registerRoute(route, handler) {
        this.handlers[route] = this.handlers[route] || [];
        this.handlers[route].push(handler);
    }
    deregisterRoute(route) {
        this.handlers[route] = [];
    }
    // request sends a request-type message to the server
    request(route, payload) {
        if (!this.connection || this.connection.readyState !== window.WebSocket.OPEN) {
            while (this.queue.length > this.maxQlength - 1)
                this.queue.shift();
            this.queue.push([route, payload]);
            return;
        }
        id++;
        const message = JSON.stringify({
            route: route,
            type: typeRequest,
            id: id,
            payload: payload
        });
        window.log('ws', 'sending', message);
        this.connection.send(message);
    }
    close(reason) {
        window.log('ws', 'close, reason:', reason, this.handlers);
        this.handlers = {};
        if (this.connection)
            this.connection.close();
    }
    connect(uri, reloader) {
        this.uri = uri;
        this.reloader = reloader;
        let retrys = 0;
        const go = () => {
            window.log('ws', `connecting to ${uri}`);
            let conn = this.connection = new window.WebSocket(uri);
            if (!conn)
                return;
            const timeout = setTimeout(() => {
                // readyState is still WebSocket.CONNECTING. Cancel and trigger onclose.
                if (conn)
                    conn.close();
            }, 500);
            // unmarshal message, and forward the message to registered handlers
            conn.onmessage = (evt) => {
                const message = JSON.parse(evt.data);
                forward(message.route, message.payload, this.handlers);
            };
            // Stub out standard functions
            conn.onclose = (evt) => {
                window.log('ws', 'onclose');
                clearTimeout(timeout);
                conn = this.connection = null;
                forward('close', null, this.handlers);
                retrys++;
                // 1.2, 1.6, 2.0, 2.4, 3.1, 3.8, 4.8, 6.0, 7.5, 9.3, ...
                const delay = Math.min(Math.pow(1.25, retrys), 10);
                console.error(`websocket disconnected (${evt.code}), trying again in ${delay.toFixed(1)} seconds`);
                setTimeout(() => {
                    go();
                }, delay * 1000);
            };
            conn.onopen = () => {
                window.log('ws', 'onopen');
                clearTimeout(timeout);
                if (retrys > 0) {
                    retrys = 0;
                    reloader();
                }
                forward('open', null, this.handlers);
                const queue = this.queue;
                this.queue = [];
                for (const [route, message] of queue) {
                    this.request(route, message);
                }
            };
            conn.onerror = (evt) => {
                window.log('ws', 'onerror:', evt);
                forward('error', evt, this.handlers);
            };
        };
        go();
    }
}
const ws = new MessageSocket();
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ws);


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/app */ "./src/js/app.ts");
/* harmony import */ var _js_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./js/registry */ "./src/js/registry.ts");
/* harmony import */ var _css_bootstrap_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./css/bootstrap.scss */ "./src/css/bootstrap.scss");
/* harmony import */ var _css_application_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./css/application.scss */ "./src/css/application.scss");




const app = new _js_app__WEBPACK_IMPORTED_MODULE_0__["default"]();
(0,_js_registry__WEBPACK_IMPORTED_MODULE_1__.registerApplication)(app);
app.start();

})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUssR0FBRyxFQUFFO2dCQUNmLEtBQUssTUFBTSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsSUFBSSxLQUFLLEVBQUU7b0JBQ3BDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQztpQkFDN0I7WUFDSCxDQUFDO1lBRUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxDQUFDLEdBQVUsRUFBRSxFQUFFO2dCQUM1QixNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxVQUFVLEVBQUUsR0FBRyxDQUFDO2dCQUNqQyxPQUFPLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDO1lBQ3RDLENBQUM7UUFDSCxDQUFDO1FBQ0QsRUFBRSxFQUFFO0lBQ04sQ0FBQztDQUNGO0FBRUQsTUFBTSxFQUFFLEdBQUcsSUFBSSxhQUFhLEVBQUU7QUFDOUIsaUVBQWUsRUFBRTs7Ozs7OztVQ3RKakI7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTs7VUFFQTtVQUNBOztVQUVBO1VBQ0E7VUFDQTs7Ozs7V0N0QkE7V0FDQTtXQUNBO1dBQ0E7V0FDQSx5Q0FBeUMsd0NBQXdDO1dBQ2pGO1dBQ0E7V0FDQTs7Ozs7V0NQQTs7Ozs7V0NBQTtXQUNBO1dBQ0E7V0FDQSx1REFBdUQsaUJBQWlCO1dBQ3hFO1dBQ0EsZ0RBQWdELGFBQWE7V0FDN0Q7Ozs7Ozs7Ozs7Ozs7OztBQ05rQztBQUNpQjtBQUN0QjtBQUNFO0FBRS9CLE1BQU0sR0FBRyxHQUFHLElBQUksK0NBQVcsRUFBRTtBQUM3QixpRUFBbUIsQ0FBQyxHQUFHLENBQUM7QUFDeEIsR0FBRyxDQUFDLEtBQUssRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL2Jpc29udy8uL3NyYy9jc3MvYXBwbGljYXRpb24uc2NzcyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvY3NzL2Jvb3RzdHJhcC5zY3NzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9hY2NvdW50LnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9hcHAudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2Jhc2VwYWdlLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9jaGFydHMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2NvaW5leHBsb3JlcnMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2RleHNldHRpbmdzLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9kb2MudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2Zvcm1zLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9odHRwLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9pbml0LnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9sb2NhbGVzLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9sb2dpbi50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvbWFya2V0cy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvbW0udHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL21tYXJjaGl2ZXMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL21tbG9ncy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvbW1zZXR0aW5ncy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvbW11dGlsLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9ub3RpZmljYXRpb25zLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9vcHRzLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9vcmRlci50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvb3JkZXJib29rLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9vcmRlcnMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL29yZGVydXRpbC50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvcmVnaXN0ZXIudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL3JlZ2lzdHJ5LnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9zZXR0aW5ncy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvc3RhdGUudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL3dhbGxldHMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL3dzLnRzIiwid2VicGFjazovL2Jpc29udy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9iaXNvbncvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2Jpc29udy93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2Jpc29udy93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL2Jpc29udy8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW5cbmV4cG9ydCB7fTsiLCIvLyBleHRyYWN0ZWQgYnkgbWluaS1jc3MtZXh0cmFjdC1wbHVnaW5cbmV4cG9ydCB7fTsiLCJpbXBvcnQgRG9jIGZyb20gJy4vZG9jJ1xuaW1wb3J0IHtcbiAgT3JkZXJUeXBlTGltaXQsXG4gIE9yZGVyVHlwZU1hcmtldCxcbiAgT3JkZXJUeXBlQ2FuY2VsLFxuICBTdGF0dXNFcG9jaCxcbiAgU3RhdHVzQm9va2VkLFxuICBSYXRlRW5jb2RpbmdGYWN0b3IsXG4gIE1hdGNoU2lkZU1ha2VyLFxuICBNYWtlclJlZGVlbWVkLFxuICBUYWtlclN3YXBDYXN0LFxuICBJbW1lZGlhdGVUaUZcbn0gZnJvbSAnLi9vcmRlcnV0aWwnXG5pbXBvcnQge1xuICBhcHAsXG4gIFBhZ2VFbGVtZW50LFxuICBFeGNoYW5nZUF1dGgsXG4gIE9yZGVyLFxuICBNYXJrZXRcbn0gZnJvbSAnLi9yZWdpc3RyeSdcblxuZXhwb3J0IGNvbnN0IGJvbmRSZXNlcnZlTXVsdGlwbGllciA9IDIgLy8gUmVzZXJ2ZXMgZm9yIG5leHQgYm9uZFxuZXhwb3J0IGNvbnN0IHBlclRpZXJCYXNlUGFyY2VsTGltaXQgPSAyXG5leHBvcnQgY29uc3QgcGFyY2VsTGltaXRTY29yZU11bHRpcGxpZXIgPSAzXG5cbmV4cG9ydCBjbGFzcyBSZXB1dGF0aW9uTWV0ZXIge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgaG9zdDogc3RyaW5nXG5cbiAgY29uc3RydWN0b3IgKGRpdjogUGFnZUVsZW1lbnQpIHtcbiAgICB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHRoaXMucGFnZS5wZW5hbHR5TWFya2VyVG1wbClcbiAgfVxuXG4gIHNldEhvc3QgKGhvc3Q6IHN0cmluZykge1xuICAgIHRoaXMuaG9zdCA9IGhvc3RcbiAgfVxuXG4gIHVwZGF0ZSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBob3N0IH0gPSB0aGlzXG4gICAgY29uc3QgeyBhdXRoLCBtYXhTY29yZSwgcGVuYWx0eVRocmVzaG9sZCB9ID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdXG4gICAgY29uc3QgeyByZXA6IHsgc2NvcmUgfSB9ID0gYXV0aFxuXG4gICAgY29uc3QgZGlzcGxheVRpZXIgPSBzdHJvbmdUaWVyKGF1dGgpXG5cbiAgICBjb25zdCBtaW5TY29yZSA9IGRpc3BsYXlUaWVyID8gZGlzcGxheVRpZXIgKiBwZW5hbHR5VGhyZXNob2xkICogLTEgOiBwZW5hbHR5VGhyZXNob2xkICogLTEgLy8gSnVzdCBmb3IgbG9va3NcbiAgICBjb25zdCB3YXJuUGN0ID0gMjVcbiAgICBjb25zdCBzY29yZVBjdCA9IDEwMCAtIHdhcm5QY3RcbiAgICBwYWdlLnNjb3JlV2Fybi5zdHlsZS53aWR0aCA9IGAke3dhcm5QY3R9JWBcbiAgICBjb25zdCBwb3MgPSBzY29yZSA+PSAwID8gd2FyblBjdCArIChzY29yZSAvIG1heFNjb3JlKSAqIHNjb3JlUGN0IDogd2FyblBjdCAtIChNYXRoLm1pbih3YXJuUGN0LCBzY29yZSAvIG1pblNjb3JlICogd2FyblBjdCkpXG5cbiAgICBwYWdlLnNjb3JlUG9pbnRlci5zdHlsZS5sZWZ0ID0gYCR7cG9zfSVgXG4gICAgcGFnZS5zY29yZU1pbi50ZXh0Q29udGVudCA9IFN0cmluZyhtaW5TY29yZSlcbiAgICBwYWdlLnNjb3JlTWF4LnRleHRDb250ZW50ID0gU3RyaW5nKG1heFNjb3JlKVxuICAgIGNvbnN0IGJvbnVzID0gbGltaXRCb251cyhzY29yZSwgbWF4U2NvcmUpXG4gICAgcGFnZS5saW1pdEJvbnVzLnRleHRDb250ZW50ID0gYm9udXMudG9GaXhlZCgxKVxuICAgIGZvciAoY29uc3QgbSBvZiBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLnNjb3JlVHJheSwgJy5wZW5hbHR5LW1hcmtlcicpKSBtLnJlbW92ZSgpXG4gICAgaWYgKGRpc3BsYXlUaWVyID4gMSkge1xuICAgICAgY29uc3QgbWFya2VyUGN0ID0gd2FyblBjdCAvIGRpc3BsYXlUaWVyXG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGRpc3BsYXlUaWVyOyBpKyspIHtcbiAgICAgICAgY29uc3QgZGl2ID0gcGFnZS5wZW5hbHR5TWFya2VyVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgICAgcGFnZS5zY29yZVRyYXkuYXBwZW5kQ2hpbGQoZGl2KVxuICAgICAgICBkaXYuc3R5bGUubGVmdCA9IGAke21hcmtlclBjdCAqIGl9JWBcbiAgICAgIH1cbiAgICB9XG4gICAgcGFnZS5zY29yZS50ZXh0Q29udGVudCA9IFN0cmluZyhzY29yZSlcbiAgICBwYWdlLnNjb3JlRGF0YS5jbGFzc0xpc3QucmVtb3ZlKCduZWdhdGl2ZScsICdwb3NpdGl2ZScpXG4gICAgaWYgKHNjb3JlID4gMCkgcGFnZS5zY29yZURhdGEuY2xhc3NMaXN0LmFkZCgncG9zaXRpdmUnKVxuICAgIGVsc2UgcGFnZS5zY29yZURhdGEuY2xhc3NMaXN0LmFkZCgnbmVnYXRpdmUnKVxuICB9XG59XG5cbi8qXG4gKiBzdHJvbmdUaWVyIGlzIHRoZSBlZmZlY3RpdmUgdGllciwgd2l0aCBzb21lIHJlc3BlY3QgZm9yIGJvbmQgb3ZlcmxhcCwgc3VjaFxuICogdGhhdCB3ZSBkb24ndCBjb3VudCB3ZWFrIGJvbmRzIHRoYXQgaGF2ZSBhbHJlYWR5IGhhZCB0aGVpciByZXBsYWNlbWVudHNcbiAqIGNvbmZpcm1lZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0cm9uZ1RpZXIgKGF1dGg6IEV4Y2hhbmdlQXV0aCk6IG51bWJlciB7XG4gIGNvbnN0IHsgd2Vha1N0cmVuZ3RoLCB0YXJnZXRUaWVyLCBlZmZlY3RpdmVUaWVyIH0gPSBhdXRoXG4gIGlmIChlZmZlY3RpdmVUaWVyID4gdGFyZ2V0VGllcikge1xuICAgIGNvbnN0IGRpZmYgPSBlZmZlY3RpdmVUaWVyIC0gdGFyZ2V0VGllclxuICAgIGlmICh3ZWFrU3RyZW5ndGggPj0gZGlmZikgcmV0dXJuIHRhcmdldFRpZXJcbiAgICByZXR1cm4gdGFyZ2V0VGllciArIChkaWZmIC0gd2Vha1N0cmVuZ3RoKVxuICB9XG4gIHJldHVybiBlZmZlY3RpdmVUaWVyXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaWtlbHlUYWtlciAob3JkOiBPcmRlciwgcmF0ZTogbnVtYmVyKTogYm9vbGVhbiB7XG4gIGlmIChvcmQudHlwZSA9PT0gT3JkZXJUeXBlTWFya2V0IHx8IG9yZC50aWYgPT09IEltbWVkaWF0ZVRpRikgcmV0dXJuIHRydWVcbiAgLy8gTXVzdCBjcm9zcyB0aGUgc3ByZWFkIHRvIGJlIGEgdGFrZXIgKG5vdCBzbyBjb25zZXJ2YXRpdmUpLlxuICBpZiAocmF0ZSA9PT0gMCkgcmV0dXJuIGZhbHNlXG4gIGlmIChvcmQuc2VsbCkgcmV0dXJuIG9yZC5yYXRlIDwgcmF0ZVxuICByZXR1cm4gb3JkLnJhdGUgPiByYXRlXG59XG5cbmNvbnN0IHByZXBhcmNlbFF1YW50aXR5ID0gKG9yZDogT3JkZXIsIG1rdD86IE1hcmtldCwgbWlkR2FwPzogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IHF0eSA9IG9yZC5xdHkgLSBvcmQuZmlsbGVkXG4gIGlmIChvcmQudHlwZSA9PT0gT3JkZXJUeXBlTGltaXQpIHJldHVybiBxdHlcbiAgaWYgKG9yZC5zZWxsKSByZXR1cm4gcXR5ICogb3JkLnJhdGUgLyBSYXRlRW5jb2RpbmdGYWN0b3JcbiAgY29uc3QgcmF0ZSA9IG1pZEdhcCB8fCBta3Q/LnNwb3Q/LnJhdGUgfHwgMFxuICAvLyBDYWxsZXIgc2hvdWxkIG5vdCBjYWxsIHRoaXMgZm9yIG1hcmtldCBvcmRlcnMgd2l0aG91dCBhIG1rdCBhcmcuXG4gIGlmICghbWt0KSByZXR1cm4gMFxuICAvLyBUaGlzIGlzIHRyaWNreS4gVGhlIHNlcnZlciB3aWxsIHVzZSB0aGUgbWlkLWdhcCByYXRlIHRvIGNvbnZlcnQgdGhlXG4gIC8vIG9yZGVyIHF0eS4gV2UgZG9uJ3QgaGF2ZSBhIG1pZC1nYXAgcmF0ZSwgb25seSBhIHNwb3QgcmF0ZS5cbiAgaWYgKHJhdGUgJiYgKG1rdD8uc3BvdD8uYm9va1ZvbHVtZSB8fCAwKSA+IDApIHJldHVybiBxdHkgKiBSYXRlRW5jb2RpbmdGYWN0b3IgLyByYXRlXG4gIHJldHVybiBta3QubG90c2l6ZSAvLyBzZXJ2ZXIgdXNlcyBzYW1lIGZhbGxiYWNrIGlmIGJvb2sgaXMgZW1wdHlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVwb2NoV2VpZ2h0IChvcmQ6IE9yZGVyLCBta3Q6IE1hcmtldCwgbWlkR2FwPzogbnVtYmVyKSB7XG4gIGlmIChvcmQuc3RhdHVzICE9PSBTdGF0dXNFcG9jaCkgcmV0dXJuIDBcbiAgY29uc3QgcXR5ID0gcHJlcGFyY2VsUXVhbnRpdHkob3JkLCBta3QsIG1pZEdhcClcbiAgY29uc3QgcmF0ZSA9IG1pZEdhcCB8fCBta3Quc3BvdD8ucmF0ZSB8fCAwXG4gIGlmIChsaWtlbHlUYWtlcihvcmQsIHJhdGUpKSByZXR1cm4gcXR5ICogMlxuICByZXR1cm4gcXR5XG59XG5cbmZ1bmN0aW9uIGJvb2tXZWlnaHQgKG9yZDogT3JkZXIpIHtcbiAgaWYgKG9yZC5zdGF0dXMgIT09IFN0YXR1c0Jvb2tlZCkgcmV0dXJuIDBcbiAgcmV0dXJuIHByZXBhcmNlbFF1YW50aXR5KG9yZClcbn1cblxuZnVuY3Rpb24gc2V0dGxpbmdXZWlnaHQgKG9yZDogT3JkZXIpIHtcbiAgbGV0IHN1bSA9IDBcbiAgZm9yIChjb25zdCBtIG9mIChvcmQubWF0Y2hlcyB8fCBbXSkpIHtcbiAgICBpZiAobS5zaWRlID09PSBNYXRjaFNpZGVNYWtlcikge1xuICAgICAgaWYgKG0uc3RhdHVzID4gTWFrZXJSZWRlZW1lZCkgY29udGludWVcbiAgICB9IGVsc2UgaWYgKG0uc3RhdHVzID4gVGFrZXJTd2FwQ2FzdCkgY29udGludWVcbiAgICBzdW0gKz0gbS5xdHlcbiAgfVxuICByZXR1cm4gc3VtXG59XG5cbmZ1bmN0aW9uIHBhcmNlbFdlaWdodCAob3JkOiBPcmRlciwgbWt0OiBNYXJrZXQsIG1pZEdhcD86IG51bWJlcikge1xuICBpZiAob3JkLnR5cGUgPT09IE9yZGVyVHlwZUNhbmNlbCkgcmV0dXJuIDBcbiAgcmV0dXJuIGVwb2NoV2VpZ2h0KG9yZCwgbWt0LCBtaWRHYXApICsgYm9va1dlaWdodChvcmQpICsgc2V0dGxpbmdXZWlnaHQob3JkKVxufVxuXG4vLyBmdW5jdGlvbiByb3VuZFBhcmNlbHMgKHA6IG51bWJlcik6IG51bWJlciB7XG4vLyAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucm91bmQoKHAgKiAxZTgpKSAvIDFlOClcbi8vIH1cblxuZnVuY3Rpb24gbGltaXRCb251cyAoc2NvcmU6IG51bWJlciwgbWF4U2NvcmU6IG51bWJlcik6IG51bWJlciB7XG4gIHJldHVybiBzY29yZSA+IDAgPyAxICsgc2NvcmUgLyBtYXhTY29yZSAqIChwYXJjZWxMaW1pdFNjb3JlTXVsdGlwbGllciAtIDEpIDogMVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdHJhZGluZ0xpbWl0cyAoaG9zdDogc3RyaW5nKTogW251bWJlciwgbnVtYmVyXSB7IC8vIFt1c2VkUGFyY2VscywgcGFyY2VsTGltaXRdXG4gIGNvbnN0IHsgYXV0aCwgbWF4U2NvcmUsIG1hcmtldHMgfSA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XVxuICBjb25zdCB7IHJlcDogeyBzY29yZSB9IH0gPSBhdXRoXG4gIGNvbnN0IHRpZXIgPSBzdHJvbmdUaWVyKGF1dGgpXG5cbiAgbGV0IHVzZWRQYXJjZWxzID0gMFxuICBmb3IgKGNvbnN0IG1rdCBvZiBPYmplY3QudmFsdWVzKG1hcmtldHMpKSB7XG4gICAgbGV0IG1rdFdlaWdodCA9IDBcbiAgICBmb3IgKGNvbnN0IG9yZCBvZiAobWt0LmluZmxpZ2h0IHx8IFtdKSkgbWt0V2VpZ2h0ICs9IHBhcmNlbFdlaWdodChvcmQsIG1rdClcbiAgICBmb3IgKGNvbnN0IG9yZCBvZiAobWt0Lm9yZGVycyB8fCBbXSkpIG1rdFdlaWdodCArPSBwYXJjZWxXZWlnaHQob3JkLCBta3QpXG4gICAgdXNlZFBhcmNlbHMgKz0gKG1rdFdlaWdodCAvIChta3QucGFyY2Vsc2l6ZSAqIG1rdC5sb3RzaXplKSlcbiAgfVxuICBjb25zdCBwYXJjZWxMaW1pdCA9IHBlclRpZXJCYXNlUGFyY2VsTGltaXQgKiBsaW1pdEJvbnVzKHNjb3JlLCBtYXhTY29yZSkgKiB0aWVyXG4gIHJldHVybiBbdXNlZFBhcmNlbHMsIHBhcmNlbExpbWl0XVxufVxuIiwiaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0IFJlZ2lzdHJhdGlvblBhZ2UgZnJvbSAnLi9yZWdpc3RlcidcbmltcG9ydCBMb2dpblBhZ2UgZnJvbSAnLi9sb2dpbidcbmltcG9ydCBXYWxsZXRzUGFnZSwgeyB0eFR5cGVTdHJpbmcgfSBmcm9tICcuL3dhbGxldHMnXG5pbXBvcnQgU2V0dGluZ3NQYWdlIGZyb20gJy4vc2V0dGluZ3MnXG5pbXBvcnQgTWFya2V0c1BhZ2UgZnJvbSAnLi9tYXJrZXRzJ1xuaW1wb3J0IE9yZGVyc1BhZ2UgZnJvbSAnLi9vcmRlcnMnXG5pbXBvcnQgT3JkZXJQYWdlIGZyb20gJy4vb3JkZXInXG5pbXBvcnQgTWFya2V0TWFrZXJQYWdlIGZyb20gJy4vbW0nXG5pbXBvcnQgTWFya2V0TWFrZXJTZXR0aW5nc1BhZ2UgZnJvbSAnLi9tbXNldHRpbmdzJ1xuaW1wb3J0IERleFNldHRpbmdzUGFnZSBmcm9tICcuL2RleHNldHRpbmdzJ1xuaW1wb3J0IE1hcmtldE1ha2VyQXJjaGl2ZXNQYWdlIGZyb20gJy4vbW1hcmNoaXZlcydcbmltcG9ydCBNYXJrZXRNYWtlckxvZ3NQYWdlIGZyb20gJy4vbW1sb2dzJ1xuaW1wb3J0IEluaXRQYWdlIGZyb20gJy4vaW5pdCdcbmltcG9ydCB7IE1NIH0gZnJvbSAnLi9tbXV0aWwnXG5pbXBvcnQgeyBSYXRlRW5jb2RpbmdGYWN0b3IsIFN0YXR1c0V4ZWN1dGVkLCBoYXNBY3RpdmVNYXRjaGVzIH0gZnJvbSAnLi9vcmRlcnV0aWwnXG5pbXBvcnQgeyBnZXRKU09OLCBwb3N0SlNPTiwgRXJyb3JzIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0ICogYXMgbnRmbiBmcm9tICcuL25vdGlmaWNhdGlvbnMnXG5pbXBvcnQgd3MgZnJvbSAnLi93cydcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0IHtcbiAgVXNlcixcbiAgU3VwcG9ydGVkQXNzZXQsXG4gIEV4Y2hhbmdlLFxuICBXYWxsZXRTdGF0ZSxcbiAgQm9uZE5vdGUsXG4gIFJlcHV0YXRpb25Ob3RlLFxuICBDb3JlTm90ZSxcbiAgT3JkZXJOb3RlLFxuICBNYXJrZXQsXG4gIE9yZGVyLFxuICBNYXRjaCxcbiAgQmFsYW5jZU5vdGUsXG4gIFdhbGxldENvbmZpZ05vdGUsXG4gIFdhbGxldFN5bmNOb3RlLFxuICBNYXRjaE5vdGUsXG4gIENvbm5FdmVudE5vdGUsXG4gIFNwb3RQcmljZU5vdGUsXG4gIFVuaXRJbmZvLFxuICBXYWxsZXREZWZpbml0aW9uLFxuICBXYWxsZXRCYWxhbmNlLFxuICBMb2dNZXNzYWdlLFxuICBOb3RlRWxlbWVudCxcbiAgQmFsYW5jZVJlc3BvbnNlLFxuICBBUElSZXNwb25zZSxcbiAgUmF0ZU5vdGUsXG4gIEluRmxpZ2h0T3JkZXIsXG4gIFdhbGxldFRyYW5zYWN0aW9uLFxuICBUeEhpc3RvcnlSZXN1bHQsXG4gIFdhbGxldE5vdGUsXG4gIFRyYW5zYWN0aW9uTm90ZSxcbiAgUGFnZUVsZW1lbnQsXG4gIEFjdGlvblJlcXVpcmVkTm90ZSxcbiAgQWN0aW9uUmVzb2x2ZWROb3RlLFxuICBUcmFuc2FjdGlvbkFjdGlvbk5vdGUsXG4gIENvcmVBY3Rpb25SZXF1aXJlZE5vdGUsXG4gIFJlamVjdGVkUmVkZW1wdGlvbkRhdGEsXG4gIE1hcmtldE1ha2luZ1N0YXR1cyxcbiAgUnVuU3RhdHNOb3RlLFxuICBNTUJvdFN0YXR1cyxcbiAgQ0VYTm90aWZpY2F0aW9uLFxuICBDRVhCYWxhbmNlVXBkYXRlLFxuICBFcG9jaFJlcG9ydE5vdGUsXG4gIENFWFByb2JsZW1zTm90ZVxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IHsgc2V0Q29pbkhyZWYgfSBmcm9tICcuL2NvaW5leHBsb3JlcnMnXG5cbmNvbnN0IGlkZWwgPSBEb2MuaWRlbCAvLyA9IGVsZW1lbnQgYnkgaWRcbmNvbnN0IGJpbmQgPSBEb2MuYmluZFxuY29uc3QgdW5iaW5kID0gRG9jLnVuYmluZFxuXG5jb25zdCBub3RpZmljYXRpb25Sb3V0ZSA9ICdub3RpZnknXG5jb25zdCBub3RlQ2FjaGVTaXplID0gMTAwXG5cbmludGVyZmFjZSBQYWdlIHtcbiAgdW5sb2FkICgpOiB2b2lkXG59XG5cbmludGVyZmFjZSBQYWdlQ2xhc3Mge1xuICBuZXcgKG1haW46IEhUTUxFbGVtZW50LCBkYXRhOiBhbnkpOiBQYWdlO1xufVxuXG5pbnRlcmZhY2UgQ29yZU5vdGVQbHVzIGV4dGVuZHMgQ29yZU5vdGUge1xuICBlbDogSFRNTEVsZW1lbnQgLy8gQWRkZWQgaW4gYXBwXG59XG5cbmludGVyZmFjZSBVc2VyUmVzcG9uc2UgZXh0ZW5kcyBBUElSZXNwb25zZSB7XG4gIHVzZXI/OiBVc2VyXG4gIGxhbmc6IHN0cmluZ1xuICBsYW5nczogc3RyaW5nW11cbiAgaW5pdGVkOiBib29sZWFuXG4gIG1tU3RhdHVzOiBNYXJrZXRNYWtpbmdTdGF0dXNcbn1cblxuLyogY29uc3RydWN0b3JzIGlzIGEgbWFwIHRvIHBhZ2UgY29uc3RydWN0b3JzLiAqL1xuY29uc3QgY29uc3RydWN0b3JzOiBSZWNvcmQ8c3RyaW5nLCBQYWdlQ2xhc3M+ID0ge1xuICBsb2dpbjogTG9naW5QYWdlLFxuICByZWdpc3RlcjogUmVnaXN0cmF0aW9uUGFnZSxcbiAgbWFya2V0czogTWFya2V0c1BhZ2UsXG4gIHdhbGxldHM6IFdhbGxldHNQYWdlLFxuICBzZXR0aW5nczogU2V0dGluZ3NQYWdlLFxuICBvcmRlcnM6IE9yZGVyc1BhZ2UsXG4gIG9yZGVyOiBPcmRlclBhZ2UsXG4gIGRleHNldHRpbmdzOiBEZXhTZXR0aW5nc1BhZ2UsXG4gIGluaXQ6IEluaXRQYWdlLFxuICBtbTogTWFya2V0TWFrZXJQYWdlLFxuICBtbXNldHRpbmdzOiBNYXJrZXRNYWtlclNldHRpbmdzUGFnZSxcbiAgbW1hcmNoaXZlczogTWFya2V0TWFrZXJBcmNoaXZlc1BhZ2UsXG4gIG1tbG9nczogTWFya2V0TWFrZXJMb2dzUGFnZVxufVxuXG5pbnRlcmZhY2UgTGFuZ0RhdGEge1xuICBuYW1lOiBzdHJpbmdcbiAgZmxhZzogc3RyaW5nXG59XG5cbmNvbnN0IGxhbmd1YWdlRGF0YTogUmVjb3JkPHN0cmluZywgTGFuZ0RhdGE+ID0ge1xuICAnZW4tVVMnOiB7XG4gICAgbmFtZTogJ0VuZ2xpc2gnLFxuICAgIGZsYWc6ICfwn4e68J+HuCcgLy8gTm90IPCfh6zwn4enLiBNVVJJQ0EhXG4gIH0sXG4gICdwdC1CUic6IHtcbiAgICBuYW1lOiAnUG9ydHVnZXNlJyxcbiAgICBmbGFnOiAn8J+Hp/Cfh7cnXG4gIH0sXG4gICd6aC1DTic6IHtcbiAgICBuYW1lOiAnQ2hpbmVzZScsXG4gICAgZmxhZzogJ/Cfh6jwn4ezJ1xuICB9LFxuICAncGwtUEwnOiB7XG4gICAgbmFtZTogJ1BvbGlzaCcsXG4gICAgZmxhZzogJ/Cfh7Xwn4exJ1xuICB9LFxuICAnZGUtREUnOiB7XG4gICAgbmFtZTogJ0dlcm1hbicsXG4gICAgZmxhZzogJ/Cfh6nwn4eqJ1xuICB9LFxuICAnYXInOiB7XG4gICAgbmFtZTogJ0FyYWJpYycsXG4gICAgZmxhZzogJ/Cfh6rwn4esJyAvLyBFZ3lwdCBJIGd1ZXNzXG4gIH1cbn1cblxuaW50ZXJmYWNlIHJlcXVpcmVkQWN0aW9uIHtcbiAgZGl2OiBQYWdlRWxlbWVudFxuICBzdGFtcDogbnVtYmVyXG4gIHVuaXF1ZUlEOiBzdHJpbmdcbiAgYWN0aW9uSUQ6IHN0cmluZ1xuICBzZWxlY3RlZDogYm9vbGVhblxufVxuXG4vLyBBcHBsaWNhdGlvbiBpcyB0aGUgbWFpbiBqYXZhc2NyaXB0IHdlYiBhcHBsaWNhdGlvbiBmb3IgQmlzb24gV2FsbGV0LlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwbGljYXRpb24ge1xuICBub3RlczogQ29yZU5vdGVQbHVzW11cbiAgcG9rZXM6IENvcmVOb3RlUGx1c1tdXG4gIGxhbmdzOiBzdHJpbmdbXVxuICBsYW5nOiBzdHJpbmdcbiAgbW1TdGF0dXM6IE1hcmtldE1ha2luZ1N0YXR1c1xuICBpbml0ZWQ6IGJvb2xlYW5cbiAgYXV0aGVkOiBib29sZWFuXG4gIHVzZXI6IFVzZXJcbiAgc2VlZEdlblRpbWU6IG51bWJlclxuICBjb21taXRIYXNoOiBzdHJpbmdcbiAgc2hvd1BvcHVwczogYm9vbGVhblxuICBsb2dnZXJzOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPlxuICByZWNvcmRlcnM6IFJlY29yZDxzdHJpbmcsIExvZ01lc3NhZ2VbXT5cbiAgbWFpbjogSFRNTEVsZW1lbnRcbiAgaGVhZGVyOiBIVE1MRWxlbWVudFxuICBoZWFkZXJTcGFjZTogSFRNTEVsZW1lbnRcbiAgYXNzZXRzOiBSZWNvcmQ8bnVtYmVyLCBTdXBwb3J0ZWRBc3NldD5cbiAgZXhjaGFuZ2VzOiBSZWNvcmQ8c3RyaW5nLCBFeGNoYW5nZT5cbiAgd2FsbGV0TWFwOiBSZWNvcmQ8bnVtYmVyLCBXYWxsZXRTdGF0ZT5cbiAgZmlhdFJhdGVzTWFwOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIHRvb2x0aXA6IEhUTUxFbGVtZW50XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIEhUTUxFbGVtZW50PlxuICBsb2FkZWRQYWdlOiBQYWdlIHwgbnVsbFxuICBwb3B1cE5vdGVzOiBIVE1MRWxlbWVudFxuICBwb3B1cFRtcGw6IEhUTUxFbGVtZW50XG4gIG5vdGVSZWNlaXZlcnM6IFJlY29yZDxzdHJpbmcsIChuOiBDb3JlTm90ZSkgPT4gdm9pZD5bXVxuICB0eEhpc3RvcnlNYXA6IFJlY29yZDxudW1iZXIsIFR4SGlzdG9yeVJlc3VsdD5cbiAgcmVxdWlyZWRBY3Rpb25zOiBSZWNvcmQ8c3RyaW5nLCByZXF1aXJlZEFjdGlvbj5cblxuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgdGhpcy5ub3RlcyA9IFtdXG4gICAgdGhpcy5wb2tlcyA9IFtdXG4gICAgdGhpcy5zZWVkR2VuVGltZSA9IDBcbiAgICB0aGlzLmNvbW1pdEhhc2ggPSBwcm9jZXNzLmVudi5DT01NSVRIQVNIIHx8ICcnXG4gICAgdGhpcy5ub3RlUmVjZWl2ZXJzID0gW11cbiAgICB0aGlzLmZpYXRSYXRlc01hcCA9IHt9XG4gICAgdGhpcy5zaG93UG9wdXBzID0gU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5wb3B1cHNMSykgPT09ICcxJ1xuICAgIHRoaXMudHhIaXN0b3J5TWFwID0ge31cbiAgICB0aGlzLnJlcXVpcmVkQWN0aW9ucyA9IHt9XG5cbiAgICBjb25zb2xlLmxvZygnQmlzb24gV2FsbGV0LCBCdWlsZCcsIHRoaXMuY29tbWl0SGFzaC5zdWJzdHJpbmcoMCwgNykpXG5cbiAgICAvLyBTZXQgQm9vdHN0cmFwIGRhcmsgdGhlbWUgYXR0cmlidXRlIGlmIGRhcmsgbW9kZSBpcyBlbmFibGVkLlxuICAgIGlmIChTdGF0ZS5pc0RhcmsoKSkge1xuICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdkYXJrJylcbiAgICB9XG5cbiAgICAvLyBMb2dnZXJzIGNhbiBiZSBlbmFibGVkIGJ5IHNldHRpbmcgYSB0cnV0aHkgdmFsdWUgdG8gdGhlIGxvZ2dlcklEIHVzaW5nXG4gICAgLy8gZW5hYmxlTG9nZ2VyLiBTZXR0aW5ncyBhcmUgc3RvcmVkIGFjcm9zcyBzZXNzaW9ucy4gU2VlIGRvY3N0cmluZyBmb3IgdGhlXG4gICAgLy8gbG9nIG1ldGhvZCBmb3IgbW9yZSBpbmZvLlxuICAgIHRoaXMubG9nZ2VycyA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUubG9nZ2Vyc0xLKSB8fCB7fVxuICAgIHdpbmRvdy5lbmFibGVMb2dnZXIgPSAobG9nZ2VySUQsIHN0YXRlKSA9PiB7XG4gICAgICBpZiAoc3RhdGUpIHRoaXMubG9nZ2Vyc1tsb2dnZXJJRF0gPSB0cnVlXG4gICAgICBlbHNlIGRlbGV0ZSB0aGlzLmxvZ2dlcnNbbG9nZ2VySURdXG4gICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmxvZ2dlcnNMSywgdGhpcy5sb2dnZXJzKVxuICAgICAgcmV0dXJuIGAke2xvZ2dlcklEfSBsb2dnZXIgJHtzdGF0ZSA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YFxuICAgIH1cbiAgICAvLyBFbmFibGUgbG9nZ2luZyBmcm9tIGFueXdoZXJlLlxuICAgIHdpbmRvdy5sb2cgPSAobG9nZ2VySUQsIC4uLmEpID0+IHsgdGhpcy5sb2cobG9nZ2VySUQsIC4uLmEpIH1cbiAgICB3aW5kb3cubW1TdGF0dXMgPSAoKSA9PiB0aGlzLm1tU3RhdHVzXG5cbiAgICAvLyBSZWNvcmRlcnMgY2FuIHJlY29yZCBsb2cgbWVzc2FnZXMsIGFuZCB0aGVuIHNhdmUgdGhlbSB0byBmaWxlIG9uIHJlcXVlc3QuXG4gICAgY29uc3QgcmVjb3JkZXJLZXlzID0gU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5yZWNvcmRlcnNMSykgfHwgW11cbiAgICB0aGlzLnJlY29yZGVycyA9IHt9XG4gICAgZm9yIChjb25zdCBsb2dnZXJJRCBvZiByZWNvcmRlcktleXMpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdyZWNvcmRpbmcnLCBsb2dnZXJJRClcbiAgICAgIHRoaXMucmVjb3JkZXJzW2xvZ2dlcklEXSA9IFtdXG4gICAgfVxuICAgIHdpbmRvdy5yZWNvcmRMb2dnZXIgPSAobG9nZ2VySUQsIG9uKSA9PiB7XG4gICAgICBpZiAob24pIHRoaXMucmVjb3JkZXJzW2xvZ2dlcklEXSA9IFtdXG4gICAgICBlbHNlIGRlbGV0ZSB0aGlzLnJlY29yZGVyc1tsb2dnZXJJRF1cbiAgICAgIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUucmVjb3JkZXJzTEssIE9iamVjdC5rZXlzKHRoaXMucmVjb3JkZXJzKSlcbiAgICAgIHJldHVybiBgJHtsb2dnZXJJRH0gcmVjb3JkZXIgJHtvbiA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCd9YFxuICAgIH1cbiAgICB3aW5kb3cuZHVtcExvZ2dlciA9IGxvZ2dlcklEID0+IHtcbiAgICAgIGNvbnN0IHJlY29yZCA9IHRoaXMucmVjb3JkZXJzW2xvZ2dlcklEXVxuICAgICAgaWYgKCFyZWNvcmQpIHJldHVybiBgbm8gcmVjb3JkZXIgZm9yIGxvZ2dlciAke2xvZ2dlcklEfWBcbiAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJylcbiAgICAgIGEuaHJlZiA9IGBkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsJHt3aW5kb3cuYnRvYShKU09OLnN0cmluZ2lmeShyZWNvcmQsIG51bGwsIDQpKX1gXG4gICAgICBhLmRvd25sb2FkID0gYCR7bG9nZ2VySUR9Lmpzb25gXG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpXG4gICAgICBhLmNsaWNrKClcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpXG4gICAgICB9LCAwKVxuICAgIH1cblxuICAgIHdpbmRvdy51c2VyID0gKCkgPT4gdGhpcy51c2VyXG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgdGhlIGFwcGxpY2F0aW9uLiBUaGlzIGlzIHRoZSBvbmx5IHRoaW5nIGRvbmUgZnJvbSB0aGUgaW5kZXguanMgZW50cnlcbiAgICogcG9pbnQuIFJlYWQgdGhlIGlkID0gbWFpbiBlbGVtZW50IGFuZCBhdHRhY2ggaGFuZGxlcnMuXG4gICAqL1xuICBhc3luYyBzdGFydCAoKSB7XG4gICAgLy8gSGFuZGxlIGJhY2sgbmF2aWdhdGlvbiBmcm9tIHRoZSBicm93c2VyLlxuICAgIGJpbmQod2luZG93LCAncG9wc3RhdGUnLCAoZTogUG9wU3RhdGVFdmVudCkgPT4ge1xuICAgICAgY29uc3QgcGFnZSA9IGUuc3RhdGU/LnBhZ2VcbiAgICAgIGlmICghcGFnZSAmJiBwYWdlICE9PSAnJykgcmV0dXJuXG4gICAgICB0aGlzLmxvYWRQYWdlKHBhZ2UsIGUuc3RhdGUuZGF0YSwgdHJ1ZSlcbiAgICB9KVxuICAgIC8vIFRoZSBtYWluIGVsZW1lbnQgaXMgdGhlIGludGVyY2hhbmdlYWJsZSBwYXJ0IG9mIHRoZSBwYWdlIHRoYXQgZG9lc24ndFxuICAgIC8vIGluY2x1ZGUgdGhlIGhlYWRlci4gTWFpbiBzaG91bGQgZGVmaW5lIGEgZGF0YS1oYW5kbGVyIGF0dHJpYnV0ZVxuICAgIC8vIGFzc29jaWF0ZWQgd2l0aCBvbmUgb2YgdGhlIGF2YWlsYWJsZSBjb25zdHJ1Y3RvcnMuXG4gICAgdGhpcy5tYWluID0gaWRlbChkb2N1bWVudCwgJ21haW4nKVxuICAgIGNvbnN0IGhhbmRsZXIgPSB0aGlzLm1haW4uZGF0YXNldC5oYW5kbGVyXG4gICAgLy8gRG9uJ3QgZmV0Y2ggdGhlIHVzZXIgdW50aWwgd2Uga25vdyB3aGF0IHBhZ2Ugd2UncmUgb24uXG4gICAgYXdhaXQgdGhpcy5mZXRjaFVzZXIoKVxuICAgIGNvbnN0IGlnbm9yZUNhY2hlZExvY2FsZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnXG4gICAgYXdhaXQgaW50bC5sb2FkTG9jYWxlKHRoaXMubGFuZywgdGhpcy5jb21taXRIYXNoLCBpZ25vcmVDYWNoZWRMb2NhbGUpXG4gICAgLy8gVGhlIGFwcGxpY2F0aW9uIGlzIGZyZWUgdG8gcmVzcG9uZCB3aXRoIGEgcGFnZSB0aGF0IGRpZmZlcnMgZnJvbSB0aGVcbiAgICAvLyBvbmUgcmVxdWVzdGVkIGluIHRoZSBvbW5pYm94LCBlLmcuIHJvdXRpbmcgdGhvdWdoIGEgbG9naW4gcGFnZS4gU2V0IHRoZVxuICAgIC8vIGN1cnJlbnQgVVJMIHN0YXRlIGJhc2VkIG9uIHRoZSBhY3R1YWwgcGFnZS5cbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuICAgIGlmIChoYW5kbGVyRnJvbVBhdGgodXJsLnBhdGhuYW1lKSAhPT0gaGFuZGxlcikge1xuICAgICAgdXJsLnBhdGhuYW1lID0gYC8ke2hhbmRsZXJ9YFxuICAgICAgdXJsLnNlYXJjaCA9ICcnXG4gICAgICB3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUoeyBwYWdlOiBoYW5kbGVyIH0sICcnLCB1cmwpXG4gICAgfVxuICAgIC8vIEF0dGFjaCBzdHVmZi5cbiAgICB0aGlzLmF0dGFjaEhlYWRlcigpXG4gICAgdGhpcy5hdHRhY2hBY3Rpb25zKClcbiAgICB0aGlzLmF0dGFjaENvbW1vbih0aGlzLmhlYWRlcilcbiAgICB0aGlzLmF0dGFjaCh7fSlcblxuICAgIC8vIElmIHdlIGFyZSBhdXRoZWQsIHBvcHVsYXRlIG5vdGVzLCBvdGhlcndpc2UgZ2V0IHdlJ2xsIHRoZW0gZnJvbSB0aGUgbG9naW5cbiAgICAvLyByZXNwb25zZS5cbiAgICBpZiAodGhpcy5hdXRoZWQpIGF3YWl0IHRoaXMuZmV0Y2hOb3RlcygpXG4gICAgdGhpcy51cGRhdGVNZW51SXRlbXNEaXNwbGF5KClcbiAgICAvLyBpbml0aWFsaXplIGRlc2t0b3Agbm90aWZpY2F0aW9uc1xuICAgIG50Zm4uZmV0Y2hEZXNrdG9wTnRmblNldHRpbmdzKClcbiAgICAvLyBDb25uZWN0IHRoZSB3ZWJzb2NrZXQgYW5kIHJlZ2lzdGVyIHRoZSBub3RpZmljYXRpb24gcm91dGUuXG4gICAgd3MuY29ubmVjdChnZXRTb2NrZXRVUkkoKSwgKCkgPT4gdGhpcy5yZWNvbm5lY3RlZCgpKVxuICAgIHdzLnJlZ2lzdGVyUm91dGUobm90aWZpY2F0aW9uUm91dGUsIChub3RlOiBDb3JlTm90ZSkgPT4ge1xuICAgICAgdGhpcy5ub3RpZnkobm90ZSlcbiAgICB9KVxuICB9XG5cbiAgLypcbiAgICogcmVjb25uZWN0ZWQgaXMgY2FsbGVkIGJ5IHRoZSB3ZWJzb2NrZXQgY2xpZW50IHdoZW4gYSByZWNvbm5lY3Rpb24gaXMgbWFkZS5cbiAgICovXG4gIHJlY29ubmVjdGVkICgpIHtcbiAgICBpZiAodGhpcy5tYWluPy5kYXRhc2V0LmhhbmRsZXIgPT09ICdzZXR0aW5ncycpIHdpbmRvdy5sb2NhdGlvbi5hc3NpZ24oJy8nKVxuICAgIGVsc2Ugd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpIC8vIFRoaXMgdHJpZ2dlcnMgYW5vdGhlciB3ZWJzb2NrZXQgZGlzY29ubmVjdC9jb25uZWN0ICghKVxuICAgIC8vIGEgZmV0Y2hVc2VyKCkgYW5kIGxvYWRQYWdlKHdpbmRvdy5oaXN0b3J5LnN0YXRlLnBhZ2UpIG1pZ2h0IHdvcmtcbiAgfVxuXG4gIC8qXG4gICAqIEZldGNoIGFuZCBzYXZlIHRoZSB1c2VyLCB3aGljaCBpcyB0aGUgcHJpbWFyeSBjb3JlIHN0YXRlIHRoYXQgbXVzdCBiZVxuICAgKiBtYWludGFpbmVkIGJ5IHRoZSBBcHBsaWNhdGlvbi5cbiAgICovXG4gIGFzeW5jIGZldGNoVXNlciAoKTogUHJvbWlzZTxVc2VyIHwgdm9pZD4ge1xuICAgIGNvbnN0IHJlc3A6IFVzZXJSZXNwb25zZSA9IGF3YWl0IGdldEpTT04oJy9hcGkvdXNlcicpXG4gICAgaWYgKCF0aGlzLmNoZWNrUmVzcG9uc2UocmVzcCkpIHJldHVyblxuICAgIHRoaXMuaW5pdGVkID0gcmVzcC5pbml0ZWRcbiAgICB0aGlzLmF1dGhlZCA9IEJvb2xlYW4ocmVzcC51c2VyKVxuICAgIHRoaXMubGFuZyA9IHJlc3AubGFuZ1xuICAgIHRoaXMubGFuZ3MgPSByZXNwLmxhbmdzXG4gICAgdGhpcy5tbVN0YXR1cyA9IHJlc3AubW1TdGF0dXNcbiAgICBpZiAoIXJlc3AudXNlcikgcmV0dXJuXG4gICAgY29uc3QgdXNlciA9IHJlc3AudXNlclxuICAgIHRoaXMuc2VlZEdlblRpbWUgPSB1c2VyLnNlZWRnZW50aW1lXG4gICAgdGhpcy51c2VyID0gdXNlclxuICAgIHRoaXMuYXNzZXRzID0gdXNlci5hc3NldHNcbiAgICB0aGlzLmV4Y2hhbmdlcyA9IHVzZXIuZXhjaGFuZ2VzXG4gICAgdGhpcy53YWxsZXRNYXAgPSB7fVxuICAgIHRoaXMuZmlhdFJhdGVzTWFwID0gdXNlci5maWF0UmF0ZXNcbiAgICBmb3IgKGNvbnN0IFthc3NldElELCBhc3NldF0gb2YgKE9iamVjdC5lbnRyaWVzKHVzZXIuYXNzZXRzKSBhcyBbYW55LCBTdXBwb3J0ZWRBc3NldF1bXSkpIHtcbiAgICAgIGlmIChhc3NldC53YWxsZXQpIHtcbiAgICAgICAgdGhpcy53YWxsZXRNYXBbYXNzZXRJRF0gPSBhc3NldC53YWxsZXRcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZU1lbnVJdGVtc0Rpc3BsYXkoKVxuICAgIHJldHVybiB1c2VyXG4gIH1cblxuICBhc3luYyBmZXRjaE1NU3RhdHVzICgpIHtcbiAgICB0aGlzLm1tU3RhdHVzID0gYXdhaXQgTU0uc3RhdHVzKClcbiAgfVxuXG4gIC8qIExvYWQgdGhlIHBhZ2UgZnJvbSB0aGUgc2VydmVyLiBJbnNlcnQgYW5kIGJpbmQgdGhlIERPTS4gKi9cbiAgYXN5bmMgbG9hZFBhZ2UgKHBhZ2U6IHN0cmluZywgZGF0YT86IGFueSwgc2tpcFB1c2g/OiBib29sZWFuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgLy8gQ2xvc2Ugc29tZSBtZW51cyBhbmQgdG9vbHRpcHMuXG4gICAgdGhpcy50b29sdGlwLnN0eWxlLmxlZnQgPSAnLTEwMDAwcHgnXG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLm5vdGVCb3gsIHRoaXMucGFnZS5wcm9maWxlQm94KVxuICAgIC8vIFBhcnNlIHRoZSByZXF1ZXN0LlxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYC8ke3BhZ2V9YCwgd2luZG93LmxvY2F0aW9uLm9yaWdpbilcbiAgICBjb25zdCByZXF1ZXN0ZWRIYW5kbGVyID0gaGFuZGxlckZyb21QYXRoKHBhZ2UpXG4gICAgLy8gRmV0Y2ggYW5kIHBhcnNlIHRoZSBwYWdlLlxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgd2luZG93LmZldGNoKHVybC50b1N0cmluZygpKVxuICAgIGlmICghcmVzcG9uc2Uub2spIHJldHVybiBmYWxzZVxuICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KClcbiAgICBjb25zdCBkb2MgPSBEb2Mubm9kZXJpemUoaHRtbClcbiAgICBjb25zdCBtYWluID0gaWRlbChkb2MsICdtYWluJylcbiAgICBjb25zdCBkZWxpdmVyZWQgPSBtYWluLmRhdGFzZXQuaGFuZGxlclxuICAgIC8vIEFwcGVuZCB0aGUgcmVxdWVzdCB0byB0aGUgcGFnZSBoaXN0b3J5LlxuICAgIGlmICghc2tpcFB1c2gpIHtcbiAgICAgIGNvbnN0IHBhdGggPSBkZWxpdmVyZWQgPT09IHJlcXVlc3RlZEhhbmRsZXIgPyB1cmwudG9TdHJpbmcoKSA6IGAvJHtkZWxpdmVyZWR9YFxuICAgICAgd2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKHsgcGFnZTogcGFnZSwgZGF0YTogZGF0YSB9LCAnJywgcGF0aClcbiAgICB9XG4gICAgLy8gSW5zZXJ0IHBhZ2UgYW5kIGF0dGFjaCBoYW5kbGVycy5cbiAgICBkb2N1bWVudC50aXRsZSA9IGRvYy50aXRsZVxuICAgIHRoaXMubWFpbi5yZXBsYWNlV2l0aChtYWluKVxuICAgIHRoaXMubWFpbiA9IG1haW5cbiAgICB0aGlzLm5vdGVSZWNlaXZlcnMgPSBbXVxuICAgIERvYy5lbXB0eSh0aGlzLmhlYWRlclNwYWNlKVxuICAgIHRoaXMuYXR0YWNoKGRhdGEpXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8qIGF0dGFjaCBiaW5kcyB0aGUgY29tbW9uIGhhbmRsZXJzIGFuZCBjYWxscyB0aGUgcGFnZSBjb25zdHJ1Y3Rvci4gKi9cbiAgYXR0YWNoIChkYXRhOiBhbnkpIHtcbiAgICBjb25zdCBoYW5kbGVySUQgPSB0aGlzLm1haW4uZGF0YXNldC5oYW5kbGVyXG4gICAgaWYgKCFoYW5kbGVySUQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2Nhbm5vdCBhdHRhY2ggdG8gY29udGVudCB3aXRoIG5vIHNwZWNpZmllZCBoYW5kbGVyJylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLmF0dGFjaENvbW1vbih0aGlzLm1haW4pXG4gICAgaWYgKHRoaXMubG9hZGVkUGFnZSkgdGhpcy5sb2FkZWRQYWdlLnVubG9hZCgpXG4gICAgY29uc3QgY29uc3RydWN0b3IgPSBjb25zdHJ1Y3RvcnNbaGFuZGxlcklEXVxuICAgIGlmIChjb25zdHJ1Y3RvcikgdGhpcy5sb2FkZWRQYWdlID0gbmV3IGNvbnN0cnVjdG9yKHRoaXMubWFpbiwgZGF0YSlcbiAgICBlbHNlIHRoaXMubG9hZGVkUGFnZSA9IG51bGxcblxuICAgIC8vIEJpbmQgdGhlIHRvb2x0aXBzLlxuICAgIHRoaXMuYmluZFRvb2x0aXBzKHRoaXMubWFpbilcblxuICAgIGlmICh3aW5kb3cuaXNXZWJ2aWV3KSB7XG4gICAgICAvLyBCaW5kIHdlYnZpZXcgVVJMIGhhbmRsZXJzXG4gICAgICB0aGlzLmJpbmRVcmxIYW5kbGVycyh0aGlzLm1haW4pXG4gICAgfVxuXG4gICAgdGhpcy5iaW5kVW5pdHModGhpcy5tYWluKVxuICB9XG5cbiAgYmluZFRvb2x0aXBzIChhbmNlc3RvcjogSFRNTEVsZW1lbnQpIHtcbiAgICBhbmNlc3Rvci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10b29sdGlwXScpLmZvckVhY2goKGVsOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgYmluZChlbCwgJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICAgIHRoaXMudG9vbHRpcC50ZXh0Q29udGVudCA9IGVsLmRhdGFzZXQudG9vbHRpcCB8fCAnJ1xuICAgICAgICBjb25zdCBseXQgPSBEb2MubGF5b3V0TWV0cmljcyhlbClcbiAgICAgICAgbGV0IGxlZnQgPSBseXQuY2VudGVyWCAtIHRoaXMudG9vbHRpcC5vZmZzZXRXaWR0aCAvIDJcbiAgICAgICAgaWYgKGxlZnQgPCAwKSBsZWZ0ID0gNVxuICAgICAgICBpZiAobGVmdCArIHRoaXMudG9vbHRpcC5vZmZzZXRXaWR0aCA+IGRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGgpIHtcbiAgICAgICAgICBsZWZ0ID0gZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCAtIHRoaXMudG9vbHRpcC5vZmZzZXRXaWR0aCAtIDVcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUubGVmdCA9IGAke2xlZnR9cHhgXG4gICAgICAgIHRoaXMudG9vbHRpcC5zdHlsZS50b3AgPSBgJHtseXQuYm9keVRvcCAtIHRoaXMudG9vbHRpcC5vZmZzZXRIZWlnaHQgLSA1fXB4YFxuICAgICAgfSlcbiAgICAgIGJpbmQoZWwsICdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUubGVmdCA9ICctMTAwMDBweCdcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICAqIGJpbmRVbml0cyBiaW5kcyBhIGhvdmVyaW5nIHVuaXQgc2VsZWN0aW9uIG1lbnUgdG8gdGhlIHZhbHVlIG9yIHJhdGVcbiAgICogZGlzcGxheSBlbGVtZW50cy4gVGhlIG1lbnUgZ2l2ZXMgdXNlcnMgYW4gb3B0aW9uIHRvIGNvbnZlcnQgdGhlIHZhbHVlXG4gICAqIHRvIHRoZWlyIHByZWZlcnJlZCB1bml0cy5cbiAgICovXG4gIGJpbmRVbml0cyAobWFpbjogUGFnZUVsZW1lbnQpIHtcbiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSBhcyBQYWdlRWxlbWVudFxuICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdwb3NpdGlvbi1hYnNvbHV0ZScsICdwLTMnKVxuICAgIC8vIGRpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAneWVsbG93J1xuICAgIGNvbnN0IHJvd3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSBhcyBQYWdlRWxlbWVudFxuICAgIGRpdi5hcHBlbmRDaGlsZChyb3dzKVxuICAgIHJvd3MuY2xhc3NMaXN0LmFkZCgnYm9keS1iZycsICdib3JkZXInKVxuICAgIGNvbnN0IGFkZFJvdyA9IChlbDogUGFnZUVsZW1lbnQsIHVuaXQ6IHN0cmluZywgY0ZhY3RvcjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBib3ggPSBEb2Muc2FmZVNlbGVjdG9yKGVsLCAnW2RhdGEtdW5pdC1ib3hdJylcbiAgICAgIGNvbnN0IGF0b21zID0gcGFyc2VJbnQoYm94LmRhdGFzZXQuYXRvbXMgYXMgc3RyaW5nKVxuICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgIHJvdy50ZXh0Q29udGVudCA9IHVuaXRcbiAgICAgIHJvd3MuYXBwZW5kQ2hpbGQocm93KVxuICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ3AtMicsICdob3ZlcmJnJywgJ3BvaW50ZXInKVxuICAgICAgRG9jLmJpbmQocm93LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIERvYy5zZXRUZXh0KGVsLCAnW2RhdGEtdmFsdWVdJywgRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGF0b21zIC8gY0ZhY3RvciwgTWF0aC5yb3VuZChNYXRoLmxvZzEwKGNGYWN0b3IpKSkpXG4gICAgICAgIERvYy5zZXRUZXh0KGVsLCAnW2RhdGEtdW5pdF0nLCB1bml0KVxuICAgICAgfSlcbiAgICB9XG4gICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3RvcihtYWluLCAnW2RhdGEtY29udmVyc2lvbi12YWx1ZV0nKSkge1xuICAgICAgY29uc3QgYm94ID0gRG9jLnNhZmVTZWxlY3RvcihlbCwgJ1tkYXRhLXVuaXQtYm94XScpXG4gICAgICBEb2MuYmluZChib3gsICdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICBEb2MuZW1wdHkocm93cylcbiAgICAgICAgYm94LmFwcGVuZENoaWxkKGRpdilcbiAgICAgICAgY29uc3QgbHl0ID0gRG9jLmxheW91dE1ldHJpY3MoYm94KVxuICAgICAgICBjb25zdCBhc3NldElEID0gcGFyc2VJbnQoYm94LmRhdGFzZXQuYXNzZXRJRCBhcyBzdHJpbmcpXG4gICAgICAgIGNvbnN0IHsgdW5pdEluZm86IHVpIH0gPSB0aGlzLmFzc2V0c1thc3NldElEXVxuICAgICAgICBhZGRSb3coZWwsIHVpLmNvbnZlbnRpb25hbC51bml0LCB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICAgICAgZm9yIChjb25zdCB7IHVuaXQsIGNvbnZlcnNpb25GYWN0b3IgfSBvZiB1aS5kZW5vbWluYXRpb25zKSBhZGRSb3coZWwsIHVuaXQsIGNvbnZlcnNpb25GYWN0b3IpXG4gICAgICAgIGFkZFJvdyhlbCwgdWkuYXRvbWljVW5pdCwgMSlcbiAgICAgICAgaWYgKGx5dC5ib2R5VG9wID4gKGRpdi5vZmZzZXRIZWlnaHQgKyB0aGlzLmhlYWRlci5vZmZzZXRIZWlnaHQpKSB7XG4gICAgICAgICAgZGl2LnN0eWxlLmJvdHRvbSA9ICdjYWxjKDEwMCUgLSAxcmVtKSdcbiAgICAgICAgICBkaXYuc3R5bGUudG9wID0gJ2F1dG8nXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGl2LnN0eWxlLnRvcCA9ICdjYWxjKDEwMCUgLSAxcmVtKSdcbiAgICAgICAgICBkaXYuc3R5bGUuYm90dG9tID0gJ2F1dG8nXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBEb2MuYmluZChib3gsICdtb3VzZWxlYXZlJywgKCkgPT4gZGl2LnJlbW92ZSgpKVxuICAgIH1cbiAgfVxuXG4gIGJpbmRVcmxIYW5kbGVycyAoYW5jZXN0b3I6IEhUTUxFbGVtZW50KSB7XG4gICAgaWYgKCF3aW5kb3cub3BlblVybCkgcmV0dXJuXG4gICAgZm9yIChjb25zdCBsaW5rIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnYVt0YXJnZXQ9X2JsYW5rXScpKSB7XG4gICAgICBEb2MuYmluZChsaW5rLCAnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgd2luZG93Lm9wZW5VcmwobGluay5ocmVmID8/ICcnKVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICAvKiBhdHRhY2hIZWFkZXIgYXR0YWNoZXMgdGhlIGhlYWRlciBlbGVtZW50LCB3aGljaCB1bmxpa2UgdGhlIG1haW4gZWxlbWVudCxcbiAgICogaXNuJ3QgcmVwbGFjZWQgZHVyaW5nIHBhZ2UgbmF2aWdhdGlvbi5cbiAgICovXG4gIGF0dGFjaEhlYWRlciAoKSB7XG4gICAgdGhpcy5oZWFkZXIgPSBpZGVsKGRvY3VtZW50LmJvZHksICdoZWFkZXInKVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyh0aGlzLmhlYWRlcilcbiAgICB0aGlzLmhlYWRlclNwYWNlID0gcGFnZS5oZWFkZXJTcGFjZVxuICAgIHRoaXMucG9wdXBOb3RlcyA9IGlkZWwoZG9jdW1lbnQuYm9keSwgJ3BvcHVwTm90ZXMnKVxuICAgIHRoaXMucG9wdXBUbXBsID0gRG9jLnRtcGxFbGVtZW50KHRoaXMucG9wdXBOb3RlcywgJ25vdGUnKVxuICAgIGlmICh0aGlzLnBvcHVwVG1wbCkgdGhpcy5wb3B1cFRtcGwucmVtb3ZlKClcbiAgICBlbHNlIGNvbnNvbGUuZXJyb3IoJ3BvcHVwVG1wbCBlbGVtZW50IG5vdCBmb3VuZCcpXG4gICAgdGhpcy50b29sdGlwID0gaWRlbChkb2N1bWVudC5ib2R5LCAndG9vbHRpcCcpXG4gICAgcGFnZS5ub3RlVG1wbC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJylcbiAgICBwYWdlLm5vdGVUbXBsLnJlbW92ZSgpXG4gICAgcGFnZS5wb2tlVG1wbC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJylcbiAgICBwYWdlLnBva2VUbXBsLnJlbW92ZSgpXG4gICAgcGFnZS5sb2FkZXIucmVtb3ZlKClcbiAgICBEb2Muc2hvdyhwYWdlLmxvYWRlcilcblxuICAgIGJpbmQocGFnZS5ub3RlQmVsbCwgJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5wb2tlTGlzdClcbiAgICAgIERvYy5zaG93KHBhZ2Uubm90ZUxpc3QpXG4gICAgICB0aGlzLmFja05vdGVzKClcbiAgICAgIHBhZ2Uubm90ZUNhdC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgICAgcGFnZS5wb2tlQ2F0LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgICB0aGlzLnNob3dEcm9wZG93bihwYWdlLm5vdGVCZWxsLCBwYWdlLm5vdGVCb3gpXG4gICAgICBEb2MuaGlkZShwYWdlLm5vdGVJbmRpY2F0b3IpXG4gICAgICBmb3IgKGNvbnN0IG5vdGUgb2YgdGhpcy5ub3Rlcykge1xuICAgICAgICBpZiAobm90ZS5hY2tlZCkge1xuICAgICAgICAgIG5vdGUuZWwuY2xhc3NMaXN0LnJlbW92ZSgnZmlyc3R2aWV3JylcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zZXROb3RlVGltZXMocGFnZS5ub3RlTGlzdClcbiAgICAgIHRoaXMuc2V0Tm90ZVRpbWVzKHBhZ2UucG9rZUxpc3QpXG4gICAgfSlcblxuICAgIGJpbmQocGFnZS5idXJnZXJJY29uLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLmxvZ291dEVycilcbiAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duKHBhZ2UuYnVyZ2VySWNvbiwgcGFnZS5wcm9maWxlQm94KVxuICAgIH0pXG5cbiAgICBiaW5kKHBhZ2UuaW5uZXJOb3RlSWNvbiwgJ2NsaWNrJywgKCkgPT4geyBEb2MuaGlkZShwYWdlLm5vdGVCb3gpIH0pXG4gICAgYmluZChwYWdlLmlubmVyQnVyZ2VySWNvbiwgJ2NsaWNrJywgKCkgPT4geyBEb2MuaGlkZShwYWdlLnByb2ZpbGVCb3gpIH0pXG5cbiAgICBiaW5kKHBhZ2UucHJvZmlsZVNpZ25vdXQsICdjbGljaycsIGFzeW5jICgpID0+IGF3YWl0IHRoaXMuc2lnbk91dCgpKVxuXG4gICAgYmluZChwYWdlLnBva2VDYXQsICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc2V0Tm90ZVRpbWVzKHBhZ2UucG9rZUxpc3QpXG4gICAgICBwYWdlLnBva2VDYXQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcbiAgICAgIHBhZ2Uubm90ZUNhdC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgICAgRG9jLmhpZGUocGFnZS5ub3RlTGlzdClcbiAgICAgIERvYy5zaG93KHBhZ2UucG9rZUxpc3QpXG4gICAgICB0aGlzLmFja05vdGVzKClcbiAgICB9KVxuXG4gICAgYmluZChwYWdlLm5vdGVDYXQsICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc2V0Tm90ZVRpbWVzKHBhZ2Uubm90ZUxpc3QpXG4gICAgICBwYWdlLm5vdGVDYXQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcbiAgICAgIHBhZ2UucG9rZUNhdC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgICAgRG9jLmhpZGUocGFnZS5wb2tlTGlzdClcbiAgICAgIERvYy5zaG93KHBhZ2Uubm90ZUxpc3QpXG4gICAgICB0aGlzLmFja05vdGVzKClcbiAgICB9KVxuXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UubGFuZ0J0dG5UbXBsKVxuICAgIGNvbnN0IHsgbmFtZSwgZmxhZyB9ID0gbGFuZ3VhZ2VEYXRhW3RoaXMubGFuZ11cbiAgICBwYWdlLmxhbmdGbGFnLnRleHRDb250ZW50ID0gZmxhZ1xuICAgIHBhZ2UubGFuZ05hbWUudGV4dENvbnRlbnQgPSBuYW1lXG5cbiAgICBmb3IgKGNvbnN0IGxhbmcgb2YgdGhpcy5sYW5ncykge1xuICAgICAgaWYgKGxhbmcgPT09IHRoaXMubGFuZykgY29udGludWVcbiAgICAgIGNvbnN0IGRpdiA9IHBhZ2UubGFuZ0J0dG5UbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgY29uc3QgeyBuYW1lLCBmbGFnIH0gPSBsYW5ndWFnZURhdGFbbGFuZ11cbiAgICAgIGRpdi50ZXh0Q29udGVudCA9IGZsYWdcbiAgICAgIGRpdi50aXRsZSA9IG5hbWVcbiAgICAgIERvYy5iaW5kKGRpdiwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zZXRMYW5ndWFnZShsYW5nKSlcbiAgICAgIHBhZ2UubGFuZ0J0dG5zLmFwcGVuZENoaWxkKGRpdilcbiAgICB9XG4gIH1cblxuICBhdHRhY2hBY3Rpb25zICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBPYmplY3QuYXNzaWduKHBhZ2UsIERvYy5pZERlc2NlbmRhbnRzKERvYy5pZGVsKGRvY3VtZW50LmJvZHksICdyZXF1aXJlZEFjdGlvbnMnKSkpXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UubWlzc2luZ05vbmNlc1RtcGwsIHBhZ2UuYWN0aW9uVHhUYWJsZVRtcGwsIHBhZ2UudG9vQ2hlYXBUbXBsLCBwYWdlLmxvc3ROb25jZVRtcGwpXG4gICAgRG9jLmJpbmQocGFnZS5hY3Rpb25zQ29sbGFwc2UsICdjbGljaycsICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuYWN0aW9uRGlhbG9nKVxuICAgICAgRG9jLnNob3cocGFnZS5hY3Rpb25EaWFsb2dDb2xsYXBzZWQpXG4gICAgfSlcbiAgICBEb2MuYmluZChwYWdlLmFjdGlvbkRpYWxvZ0NvbGxhcHNlZCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5hY3Rpb25EaWFsb2dDb2xsYXBzZWQpXG4gICAgICBEb2Muc2hvdyhwYWdlLmFjdGlvbkRpYWxvZylcbiAgICAgIGlmIChwYWdlLmFjdGlvbkRpYWxvZ0NvbnRlbnQuY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB0aGlzLnNob3dPbGRlc3RBY3Rpb24oKVxuICAgIH0pXG4gICAgY29uc3Qgc2hvd0FkamFjZW50QWN0aW9uID0gKGRpcjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBzZWxlY3RlZCA9IE9iamVjdC52YWx1ZXModGhpcy5yZXF1aXJlZEFjdGlvbnMpLmZpbHRlcigocjogcmVxdWlyZWRBY3Rpb24pID0+IHIuc2VsZWN0ZWQpWzBdXG4gICAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5zb3J0ZWRBY3Rpb25zKClcbiAgICAgIGNvbnN0IGlkeCA9IGFjdGlvbnMuaW5kZXhPZihzZWxlY3RlZClcbiAgICAgIHRoaXMuc2hvd1JlcXVlc3RlZEFjdGlvbihhY3Rpb25zW2lkeCArIGRpcl0udW5pcXVlSUQpXG4gICAgfVxuICAgIERvYy5iaW5kKHBhZ2UucHJldkFjdGlvbiwgJ2NsaWNrJywgKCkgPT4gc2hvd0FkamFjZW50QWN0aW9uKC0xKSlcbiAgICBEb2MuYmluZChwYWdlLm5leHRBY3Rpb24sICdjbGljaycsICgpID0+IHNob3dBZGphY2VudEFjdGlvbigxKSlcbiAgfVxuXG4gIHNldFJlcXVpcmVkQWN0aW9ucyAoKSB7XG4gICAgY29uc3QgeyB1c2VyOiB7IGFjdGlvbnMgfSwgcmVxdWlyZWRBY3Rpb25zIH0gPSB0aGlzXG4gICAgaWYgKCFhY3Rpb25zKSByZXR1cm5cbiAgICBmb3IgKGNvbnN0IGEgb2YgYWN0aW9ucykgdGhpcy5hZGRBY3Rpb24oYSlcbiAgICBpZiAoT2JqZWN0LmtleXMocmVxdWlyZWRBY3Rpb25zKS5sZW5ndGgpIHtcbiAgICAgIHRoaXMuc2hvd09sZGVzdEFjdGlvbigpXG4gICAgICB0aGlzLmJsaW5rQWN0aW9uKClcbiAgICB9XG4gIH1cblxuICBzb3J0ZWRBY3Rpb25zICgpIHtcbiAgICBjb25zdCBhY3Rpb25zID0gT2JqZWN0LnZhbHVlcyh0aGlzLnJlcXVpcmVkQWN0aW9ucylcbiAgICBhY3Rpb25zLnNvcnQoKGE6IHJlcXVpcmVkQWN0aW9uLCBiOiByZXF1aXJlZEFjdGlvbikgPT4gYS5zdGFtcCAtIGIuc3RhbXApXG4gICAgcmV0dXJuIGFjdGlvbnNcbiAgfVxuXG4gIHNob3dPbGRlc3RBY3Rpb24gKCkge1xuICAgIHRoaXMuc2hvd1JlcXVlc3RlZEFjdGlvbih0aGlzLnNvcnRlZEFjdGlvbnMoKVswXS51bmlxdWVJRClcbiAgfVxuXG4gIGFkZEFjdGlvbiAocmVxOiBBY3Rpb25SZXF1aXJlZE5vdGUpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHJlcXVpcmVkQWN0aW9ucyB9ID0gdGhpc1xuICAgIGNvbnN0IGV4aXN0aW5nQWN0aW9uID0gcmVxdWlyZWRBY3Rpb25zW3JlcS51bmlxdWVJRF1cbiAgICBpZiAoZXhpc3RpbmdBY3Rpb24gJiYgZXhpc3RpbmdBY3Rpb24uYWN0aW9uSUQgPT09IHJlcS5hY3Rpb25JRCkgcmV0dXJuXG4gICAgY29uc3QgZGl2ID0gdGhpcy5hY3Rpb25Gb3JtKHJlcSlcbiAgICBpZiAoZXhpc3RpbmdBY3Rpb24pIHtcbiAgICAgIGlmIChleGlzdGluZ0FjdGlvbi5zZWxlY3RlZCkgZXhpc3RpbmdBY3Rpb24uZGl2LnJlcGxhY2VXaXRoKGRpdilcbiAgICAgIGV4aXN0aW5nQWN0aW9uLmRpdiA9IGRpdlxuICAgIH0gZWxzZSB7XG4gICAgICByZXF1aXJlZEFjdGlvbnNbcmVxLnVuaXF1ZUlEXSA9IHtcbiAgICAgICAgZGl2LFxuICAgICAgICBzdGFtcDogKG5ldyBEYXRlKCkpLmdldFRpbWUoKSxcbiAgICAgICAgdW5pcXVlSUQ6IHJlcS51bmlxdWVJRCxcbiAgICAgICAgYWN0aW9uSUQ6IHJlcS5hY3Rpb25JRCxcbiAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlXG4gICAgICB9XG4gICAgICBjb25zdCBuID0gT2JqZWN0LmtleXMocmVxdWlyZWRBY3Rpb25zKS5sZW5ndGhcbiAgICAgIHBhZ2UuYWN0aW9uRGlhbG9nQ291bnQudGV4dENvbnRlbnQgPSBTdHJpbmcobilcbiAgICAgIHBhZ2UuYWN0aW9uQ291bnQudGV4dENvbnRlbnQgPSBTdHJpbmcobilcbiAgICAgIGlmIChEb2MuaXNIaWRkZW4ocGFnZS5hY3Rpb25EaWFsb2cpKSB7XG4gICAgICAgIHRoaXMuc2hvd1JlcXVlc3RlZEFjdGlvbihyZXEudW5pcXVlSUQpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYmxpbmtBY3Rpb24gKCkge1xuICAgIERvYy5ibGluayh0aGlzLnBhZ2UuYWN0aW9uRGlhbG9nKVxuICAgIERvYy5ibGluayh0aGlzLnBhZ2UuYWN0aW9uRGlhbG9nQ29sbGFwc2VkKVxuICB9XG5cbiAgcmVzb2x2ZUFjdGlvbiAocmVxOiBBY3Rpb25SZXNvbHZlZE5vdGUpIHtcbiAgICB0aGlzLnJlc29sdmVBY3Rpb25XaXRoSUQocmVxLnVuaXF1ZUlEKVxuICB9XG5cbiAgcmVzb2x2ZUFjdGlvbldpdGhJRCAodW5pcXVlSUQ6IHN0cmluZykge1xuICAgIGNvbnN0IHsgcGFnZSwgcmVxdWlyZWRBY3Rpb25zIH0gPSB0aGlzXG4gICAgY29uc3QgZXhpc3RpbmdBY3Rpb24gPSByZXF1aXJlZEFjdGlvbnNbdW5pcXVlSURdXG4gICAgaWYgKCFleGlzdGluZ0FjdGlvbikgcmV0dXJuXG4gICAgZGVsZXRlIHJlcXVpcmVkQWN0aW9uc1t1bmlxdWVJRF1cbiAgICBjb25zdCByZW0gPSBPYmplY3Qua2V5cyhyZXF1aXJlZEFjdGlvbnMpLmxlbmd0aFxuICAgIGV4aXN0aW5nQWN0aW9uLmRpdi5yZW1vdmUoKVxuICAgIGlmIChyZW0gPT09IDApIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuYWN0aW9uRGlhbG9nLCBwYWdlLmFjdGlvbkRpYWxvZ0NvbGxhcHNlZClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwYWdlLmFjdGlvbkRpYWxvZ0NvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHJlbSlcbiAgICBwYWdlLmFjdGlvbkNvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHJlbSlcbiAgICBpZiAoZXhpc3RpbmdBY3Rpb24uc2VsZWN0ZWQpIHRoaXMuc2hvd09sZGVzdEFjdGlvbigpXG4gIH1cblxuICBhY3Rpb25Gb3JtIChyZXE6IEFjdGlvblJlcXVpcmVkTm90ZSkge1xuICAgIHN3aXRjaCAocmVxLmFjdGlvbklEKSB7XG4gICAgICBjYXNlICd0b29DaGVhcCc6XG4gICAgICAgIHJldHVybiB0aGlzLnRvb0NoZWFwQWN0aW9uKHJlcSlcbiAgICAgIGNhc2UgJ21pc3NpbmdOb25jZXMnOlxuICAgICAgICByZXR1cm4gdGhpcy5taXNzaW5nTm9uY2VzQWN0aW9uKHJlcSlcbiAgICAgIGNhc2UgJ2xvc3ROb25jZSc6XG4gICAgICAgIHJldHVybiB0aGlzLmxvc3ROb25jZUFjdGlvbihyZXEpXG4gICAgICBjYXNlICdyZWRlZW1SZWplY3RlZCc6XG4gICAgICAgIHJldHVybiB0aGlzLnJlZGVlbVJlamVjdGVkQWN0aW9uKHJlcSlcbiAgICB9XG4gICAgdGhyb3cgRXJyb3IoJ3Vua25vd24gcmVxdWlyZWQgYWN0aW9uIElEICcgKyByZXEuYWN0aW9uSUQpXG4gIH1cblxuICBhY3Rpb25UeFRhYmxlIChyZXE6IEFjdGlvblJlcXVpcmVkTm90ZSkge1xuICAgIGNvbnN0IHsgYXNzZXRJRCwgcGF5bG9hZCB9ID0gcmVxXG4gICAgY29uc3QgbiA9IHBheWxvYWQgYXMgVHJhbnNhY3Rpb25BY3Rpb25Ob3RlXG4gICAgY29uc3QgeyB1bml0SW5mbzogdWksIHRva2VuIH0gPSB0aGlzLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHRhYmxlID0gdGhpcy5wYWdlLmFjdGlvblR4VGFibGVUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZSh0YWJsZSlcbiAgICB0bXBsLmxvc3RUeElELnRleHRDb250ZW50ID0gbi50eC5pZFxuICAgIHRtcGwubG9zdFR4SUQuZGF0YXNldC5leHBsb3JlckNvaW4gPSBuLnR4LmlkXG4gICAgc2V0Q29pbkhyZWYodG9rZW4gPyB0b2tlbi5wYXJlbnRJRCA6IGFzc2V0SUQsIHRtcGwubG9zdFR4SUQpXG4gICAgdG1wbC50eEFtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobi50eC5hbW91bnQsIHVpKVxuICAgIHRtcGwuYW10VW5pdC50ZXh0Q29udGVudCA9IHVpLmNvbnZlbnRpb25hbC51bml0XG4gICAgY29uc3QgcGFyZW50VUkgPSB0b2tlbiA/IHRoaXMudW5pdEluZm8odG9rZW4ucGFyZW50SUQpIDogdWlcbiAgICB0bXBsLnR5cGUudGV4dENvbnRlbnQgPSB0eFR5cGVTdHJpbmcobi50eC50eXBlKVxuICAgIHRtcGwuZmVlQW1vdW50LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShuLnR4LmZlZXMsIHBhcmVudFVJKVxuICAgIHRtcGwuZmVlVW5pdC50ZXh0Q29udGVudCA9IHBhcmVudFVJLmNvbnZlbnRpb25hbC51bml0XG4gICAgc3dpdGNoIChyZXEuYWN0aW9uSUQpIHtcbiAgICAgIGNhc2UgJ3Rvb0NoZWFwJzoge1xuICAgICAgICBEb2Muc2hvdyh0bXBsLm5ld0ZlZXNSb3cpXG4gICAgICAgIHRtcGwubmV3RmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobi50eC5mZWVzLCBwYXJlbnRVSSlcbiAgICAgICAgdG1wbC5uZXdGZWVzVW5pdC50ZXh0Q29udGVudCA9IHBhcmVudFVJLmNvbnZlbnRpb25hbC51bml0XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YWJsZVxuICB9XG5cbiAgYXN5bmMgc3VibWl0QWN0aW9uIChyZXE6IEFjdGlvblJlcXVpcmVkTm90ZSwgYWN0aW9uOiBhbnksIGVyck1zZzogUGFnZUVsZW1lbnQpIHtcbiAgICBEb2MuaGlkZShlcnJNc2cpXG4gICAgY29uc3QgbG9hZGluZyA9IHRoaXMubG9hZGluZyh0aGlzLnBhZ2UuYWN0aW9uRGlhbG9nKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3Rha2VhY3Rpb24nLCB7XG4gICAgICBhc3NldElEOiByZXEuYXNzZXRJRCxcbiAgICAgIGFjdGlvbklEOiByZXEuYWN0aW9uSUQsXG4gICAgICBhY3Rpb25cbiAgICB9KVxuICAgIGxvYWRpbmcoKVxuICAgIGlmICghdGhpcy5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGVyck1zZy50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KGVyck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnJlc29sdmVBY3Rpb25XaXRoSUQocmVxLnVuaXF1ZUlEKVxuICB9XG5cbiAgbWlzc2luZ05vbmNlc0FjdGlvbiAocmVxOiBBY3Rpb25SZXF1aXJlZE5vdGUpIHtcbiAgICBjb25zdCB7IGFzc2V0SUQgfSA9IHJlcVxuICAgIGNvbnN0IGRpdiA9IHRoaXMucGFnZS5taXNzaW5nTm9uY2VzVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgIGNvbnN0IHsgbmFtZSB9ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICB0bXBsLmFzc2V0TmFtZS50ZXh0Q29udGVudCA9IG5hbWVcbiAgICBEb2MuYmluZCh0bXBsLmRvTm90aGluZ0J0dG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc3VibWl0QWN0aW9uKHJlcSwgeyByZWNvdmVyOiBmYWxzZSB9LCB0bXBsLmVyck1zZylcbiAgICB9KVxuICAgIERvYy5iaW5kKHRtcGwucmVjb3ZlckJ0dG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc3VibWl0QWN0aW9uKHJlcSwgeyByZWNvdmVyOiB0cnVlIH0sIHRtcGwuZXJyTXNnKVxuICAgIH0pXG4gICAgcmV0dXJuIGRpdlxuICB9XG5cbiAgdG9vQ2hlYXBBY3Rpb24gKHJlcTogQWN0aW9uUmVxdWlyZWROb3RlKSB7XG4gICAgY29uc3QgeyBhc3NldElELCBwYXlsb2FkIH0gPSByZXFcbiAgICBjb25zdCBuID0gcGF5bG9hZCBhcyBUcmFuc2FjdGlvbkFjdGlvbk5vdGVcbiAgICBjb25zdCBkaXYgPSB0aGlzLnBhZ2UudG9vQ2hlYXBUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgY29uc3QgeyBuYW1lIH0gPSB0aGlzLmFzc2V0c1thc3NldElEXVxuICAgIHRtcGwuYXNzZXROYW1lLnRleHRDb250ZW50ID0gbmFtZVxuICAgIHRtcGwudHhUYWJsZS5hcHBlbmRDaGlsZCh0aGlzLmFjdGlvblR4VGFibGUocmVxKSlcbiAgICBjb25zdCBhY3QgPSAoYnVtcDogYm9vbGVhbikgPT4ge1xuICAgICAgdGhpcy5zdWJtaXRBY3Rpb24ocmVxLCB7XG4gICAgICAgIHR4SUQ6IG4udHguaWQsXG4gICAgICAgIGJ1bXBcbiAgICAgIH0sIHRtcGwuZXJyTXNnKVxuICAgIH1cbiAgICBEb2MuYmluZCh0bXBsLmtlZXBXYWl0aW5nQnR0biwgJ2NsaWNrJywgKCkgPT4gYWN0KGZhbHNlKSlcbiAgICBEb2MuYmluZCh0bXBsLmFkZEZlZXNCdHRuLCAnY2xpY2snLCAoKSA9PiBhY3QodHJ1ZSkpXG4gICAgcmV0dXJuIGRpdlxuICB9XG5cbiAgbG9zdE5vbmNlQWN0aW9uIChyZXE6IEFjdGlvblJlcXVpcmVkTm90ZSkge1xuICAgIGNvbnN0IHsgYXNzZXRJRCwgcGF5bG9hZCB9ID0gcmVxXG4gICAgY29uc3QgbiA9IHBheWxvYWQgYXMgVHJhbnNhY3Rpb25BY3Rpb25Ob3RlXG4gICAgY29uc3QgZGl2ID0gdGhpcy5wYWdlLmxvc3ROb25jZVRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICBjb25zdCB7IG5hbWUgfSA9IHRoaXMuYXNzZXRzW2Fzc2V0SURdXG4gICAgdG1wbC5hc3NldE5hbWUudGV4dENvbnRlbnQgPSBuYW1lXG4gICAgdG1wbC5ub25jZS50ZXh0Q29udGVudCA9IFN0cmluZyhuLm5vbmNlKVxuICAgIHRtcGwudHhUYWJsZS5hcHBlbmRDaGlsZCh0aGlzLmFjdGlvblR4VGFibGUocmVxKSlcbiAgICBEb2MuYmluZCh0bXBsLmFiYW5kb25CdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN1Ym1pdEFjdGlvbihyZXEsIHsgdHhJRDogbi50eC5pZCwgYWJhbmRvbjogdHJ1ZSB9LCB0bXBsLmVyck1zZylcbiAgICB9KVxuICAgIERvYy5iaW5kKHRtcGwua2VlcFdhaXRpbmdCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN1Ym1pdEFjdGlvbihyZXEsIHsgdHhJRDogbi50eC5pZCwgYWJhbmRvbjogZmFsc2UgfSwgdG1wbC5lcnJNc2cpXG4gICAgfSlcbiAgICBEb2MuYmluZCh0bXBsLnJlcGxhY2VCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXBsYWNlbWVudElEID0gdG1wbC5pZElucHV0LnZhbHVlXG4gICAgICBpZiAoIXJlcGxhY2VtZW50SUQpIHtcbiAgICAgICAgdG1wbC5pZElucHV0LmZvY3VzKClcbiAgICAgICAgRG9jLmJsaW5rKHRtcGwuaWRJbnB1dClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICB0aGlzLnN1Ym1pdEFjdGlvbihyZXEsIHsgdHhJRDogbi50eC5pZCwgYWJhbmRvbjogZmFsc2UsIHJlcGxhY2VtZW50SUQgfSwgdG1wbC5lcnJNc2cpXG4gICAgfSlcbiAgICByZXR1cm4gZGl2XG4gIH1cblxuICByZWRlZW1SZWplY3RlZEFjdGlvbiAocmVxOiBBY3Rpb25SZXF1aXJlZE5vdGUpIHtcbiAgICBjb25zdCB7IG9yZGVySUQsIGNvaW5JRCwgY29pbkZtdCwgYXNzZXRJRCB9ID0gcmVxLnBheWxvYWQgYXMgUmVqZWN0ZWRSZWRlbXB0aW9uRGF0YVxuICAgIGNvbnN0IGRpdiA9IHRoaXMucGFnZS5yZWplY3RlZFJlZGVtcHRpb25UbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgY29uc3QgeyBuYW1lLCB0b2tlbiB9ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICB0bXBsLmFzc2V0TmFtZS50ZXh0Q29udGVudCA9IG5hbWVcbiAgICB0bXBsLnR4aWQudGV4dENvbnRlbnQgPSBjb2luRm10XG4gICAgdG1wbC50eGlkLmRhdGFzZXQuZXhwbG9yZXJDb2luID0gY29pbklEXG4gICAgc2V0Q29pbkhyZWYodG9rZW4gPyB0b2tlbi5wYXJlbnRJRCA6IGFzc2V0SUQsIHRtcGwudHhpZClcbiAgICBEb2MuYmluZCh0bXBsLmRvTm90aGluZ0J0dG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc3VibWl0QWN0aW9uKHJlcSwgeyBvcmRlcklELCBjb2luSUQsIHJldHJ5OiBmYWxzZSB9LCB0bXBsLmVyck1zZylcbiAgICB9KVxuICAgIERvYy5iaW5kKHRtcGwudHJ5QWdhaW5CdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN1Ym1pdEFjdGlvbihyZXEsIHsgb3JkZXJJRCwgY29pbklELCByZXRyeTogdHJ1ZSB9LCB0bXBsLmVyck1zZylcbiAgICB9KVxuICAgIHJldHVybiBkaXZcbiAgfVxuXG4gIHNob3dSZXF1ZXN0ZWRBY3Rpb24gKHVuaXF1ZUlEOiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHJlcXVpcmVkQWN0aW9ucyB9ID0gdGhpc1xuICAgIERvYy5oaWRlKHBhZ2UuYWN0aW9uRGlhbG9nQ29sbGFwc2VkKVxuICAgIGZvciAoY29uc3QgciBvZiBPYmplY3QudmFsdWVzKHJlcXVpcmVkQWN0aW9ucykpIHIuc2VsZWN0ZWQgPSByLnVuaXF1ZUlEID09PSB1bmlxdWVJRFxuICAgIERvYy5lbXB0eShwYWdlLmFjdGlvbkRpYWxvZ0NvbnRlbnQpXG4gICAgY29uc3QgYWN0aW9uID0gcmVxdWlyZWRBY3Rpb25zW3VuaXF1ZUlEXVxuICAgIHBhZ2UuYWN0aW9uRGlhbG9nQ29udGVudC5hcHBlbmRDaGlsZChhY3Rpb24uZGl2KVxuICAgIERvYy5zaG93KHBhZ2UuYWN0aW9uRGlhbG9nKVxuICAgIGNvbnN0IGFjdGlvbnMgPSB0aGlzLnNvcnRlZEFjdGlvbnMoKVxuICAgIGlmIChhY3Rpb25zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5hY3Rpb25zTmF2aWdhdG9yKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UuYWN0aW9uc05hdmlnYXRvcilcbiAgICBjb25zdCBpZHggPSBhY3Rpb25zLmluZGV4T2YoYWN0aW9uKVxuICAgIHBhZ2UuY3VycmVudEFjdGlvbi50ZXh0Q29udGVudCA9IFN0cmluZyhpZHggKyAxKVxuICAgIHBhZ2UucHJldkFjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpbnZpc2libGUnLCBpZHggPT09IDApXG4gICAgcGFnZS5uZXh0QWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2ludmlzaWJsZScsIGlkeCA9PT0gYWN0aW9ucy5sZW5ndGggLSAxKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlTWFya2V0RWxlbWVudHMgc2V0cyB0aGUgdGV4dENvbnRlbnQgZm9yIGFueSB0aWNrZXIgb3IgYXNzZXQgbmFtZVxuICAgKiBlbGVtZW50cyBvciBhbnkgYXNzZXQgbG9nbyBzcmMgYXR0cmlidXRlcyBmb3IgZGVzY2VuZGVudHMgb2YgYW5jZXN0b3IuXG4gICAqL1xuICB1cGRhdGVNYXJrZXRFbGVtZW50cyAoYW5jZXN0b3I6IFBhZ2VFbGVtZW50LCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCB4Yz86IEV4Y2hhbmdlKSB7XG4gICAgY29uc3QgZ2V0QXNzZXQgPSAoYXNzZXRJRDogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBhID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICAgIGlmIChhKSByZXR1cm4gYVxuICAgICAgaWYgKCF4YykgdGhyb3cgRXJyb3IoYG5vIGFzc2V0IGZvdW5kIGZvciBhc3NldCBJRCAke2Fzc2V0SUR9YClcbiAgICAgIGNvbnN0IHhjQXNzZXQgPSB4Yy5hc3NldHNbYXNzZXRJRF1cbiAgICAgIHJldHVybiB7IHVuaXRJbmZvOiB4Y0Fzc2V0LnVuaXRJbmZvLCBuYW1lOiB4Y0Fzc2V0LnN5bWJvbCwgc3ltYm9sOiB4Y0Fzc2V0LnN5bWJvbCB9XG4gICAgfVxuICAgIGNvbnN0IHsgdW5pdEluZm86IGJ1aSwgbmFtZTogYmFzZU5hbWUsIHN5bWJvbDogYmFzZVN5bWJvbCB9ID0gZ2V0QXNzZXQoYmFzZUlEKVxuICAgIGZvciAoY29uc3QgZWwgb2YgRG9jLmFwcGx5U2VsZWN0b3IoYW5jZXN0b3IsICdbZGF0YS1iYXNlLW5hbWUnKSkgZWwudGV4dENvbnRlbnQgPSBiYXNlTmFtZVxuICAgIGZvciAoY29uc3QgaW1nIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtYmFzZS1sb2dvXScpKSBpbWcuc3JjID0gRG9jLmxvZ29QYXRoKGJhc2VTeW1ib2wpXG4gICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3RvcihhbmNlc3RvciwgJ1tkYXRhLWJhc2UtdGlja2VyXScpKSBlbC50ZXh0Q29udGVudCA9IGJ1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIGNvbnN0IHsgdW5pdEluZm86IHF1aSwgbmFtZTogcXVvdGVOYW1lLCBzeW1ib2w6IHF1b3RlU3ltYm9sIH0gPSBnZXRBc3NldChxdW90ZUlEKVxuICAgIGZvciAoY29uc3QgZWwgb2YgRG9jLmFwcGx5U2VsZWN0b3IoYW5jZXN0b3IsICdbZGF0YS1xdW90ZS1uYW1lJykpIGVsLnRleHRDb250ZW50ID0gcXVvdGVOYW1lXG4gICAgZm9yIChjb25zdCBpbWcgb2YgRG9jLmFwcGx5U2VsZWN0b3IoYW5jZXN0b3IsICdbZGF0YS1xdW90ZS1sb2dvXScpKSBpbWcuc3JjID0gRG9jLmxvZ29QYXRoKHF1b3RlU3ltYm9sKVxuICAgIGZvciAoY29uc3QgZWwgb2YgRG9jLmFwcGx5U2VsZWN0b3IoYW5jZXN0b3IsICdbZGF0YS1xdW90ZS10aWNrZXJdJykpIGVsLnRleHRDb250ZW50ID0gcXVpLmNvbnZlbnRpb25hbC51bml0XG4gIH1cblxuICBhc3luYyBzZXRMYW5ndWFnZSAobGFuZzogc3RyaW5nKSB7XG4gICAgYXdhaXQgcG9zdEpTT04oJy9hcGkvc2V0bG9jYWxlJywgbGFuZylcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbiAgfVxuXG4gIC8qXG4gICAqIHNob3dEcm9wZG93biBzZXRzIHRoZSBwb3NpdGlvbiBhbmQgdmlzaWJpbGl0eSBvZiB0aGUgc3BlY2lmaWVkIGRyb3Bkb3duXG4gICAqIGRpYWxvZyBhY2NvcmRpbmcgdG8gdGhlIHBvc2l0aW9uIG9mIGl0cyBpY29uIGJ1dHRvbi5cbiAgICovXG4gIHNob3dEcm9wZG93biAoaWNvbjogSFRNTEVsZW1lbnQsIGRpYWxvZzogSFRNTEVsZW1lbnQpIHtcbiAgICBEb2MuaGlkZSh0aGlzLnBhZ2Uubm90ZUJveCwgdGhpcy5wYWdlLnByb2ZpbGVCb3gpXG4gICAgRG9jLnNob3coZGlhbG9nKVxuICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDUwMCkgT2JqZWN0LmFzc2lnbihkaWFsb2cuc3R5bGUsIHsgbGVmdDogJzAnLCByaWdodDogJzAnLCB0b3A6ICcwJyB9KVxuICAgIGVsc2Uge1xuICAgICAgY29uc3QgaWNvID0gaWNvbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgY29uc3QgcmlnaHQgPSBgJHt3aW5kb3cuaW5uZXJXaWR0aCAtIGljby5sZWZ0IC0gaWNvLndpZHRoICsgNX1weGBcbiAgICAgIE9iamVjdC5hc3NpZ24oZGlhbG9nLnN0eWxlLCB7IGxlZnQ6ICdhdXRvJywgcmlnaHQsIHRvcDogYCR7aWNvLnRvcCAtIDR9cHhgIH0pXG4gICAgfVxuXG4gICAgY29uc3QgaGlkZSA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoIURvYy5tb3VzZUluRWxlbWVudChlLCBkaWFsb2cpKSB7XG4gICAgICAgIERvYy5oaWRlKGRpYWxvZylcbiAgICAgICAgdW5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBoaWRlKVxuICAgICAgICBpZiAoZGlhbG9nID09PSB0aGlzLnBhZ2Uubm90ZUJveCAmJiBEb2MuaXNEaXNwbGF5ZWQodGhpcy5wYWdlLm5vdGVMaXN0KSkge1xuICAgICAgICAgIHRoaXMuYWNrTm90ZXMoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGJpbmQoZG9jdW1lbnQsICdjbGljaycsIGhpZGUpXG4gIH1cblxuICBhY2tOb3RlcyAoKSB7XG4gICAgY29uc3QgYWNrcyA9IFtdXG4gICAgZm9yIChjb25zdCBub3RlIG9mIHRoaXMubm90ZXMpIHtcbiAgICAgIGlmIChub3RlLmFja2VkKSB7XG4gICAgICAgIG5vdGUuZWwuY2xhc3NMaXN0LnJlbW92ZSgnZmlyc3R2aWV3JylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vdGUuYWNrZWQgPSB0cnVlXG4gICAgICAgIGlmIChub3RlLmlkICYmIG5vdGUuc2V2ZXJpdHkgPiBudGZuLlBPS0UpIGFja3MucHVzaChub3RlLmlkKVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYWNrcy5sZW5ndGgpIHdzLnJlcXVlc3QoJ2Fja25vdGVzJywgYWNrcylcbiAgICBEb2MuaGlkZSh0aGlzLnBhZ2Uubm90ZUluZGljYXRvcilcbiAgfVxuXG4gIHNldE5vdGVUaW1lcyAobm90ZUxpc3Q6IEhUTUxFbGVtZW50KSB7XG4gICAgZm9yIChjb25zdCBlbCBvZiAoQXJyYXkuZnJvbShub3RlTGlzdC5jaGlsZHJlbikgYXMgTm90ZUVsZW1lbnRbXSkpIHtcbiAgICAgIERvYy5zYWZlU2VsZWN0b3IoZWwsICdzcGFuLm5vdGUtdGltZScpLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShlbC5ub3RlLnN0YW1wKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGJpbmRJbnRlcm5hbE5hdmlnYXRpb24gaGlqYWNrcyBuYXZpZ2F0aW9uIGJ5IGNsaWNrIG9uIGFueSBsb2NhbCBsaW5rcyB0aGF0XG4gICAqIGFyZSBkZXNjZW5kYW50cyBvZiBhbmNlc3Rvci5cbiAgICovXG4gIGJpbmRJbnRlcm5hbE5hdmlnYXRpb24gKGFuY2VzdG9yOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHBhZ2VVUkwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuICAgIGFuY2VzdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKS5mb3JFYWNoKGEgPT4ge1xuICAgICAgaWYgKCFhLmhyZWYpIHJldHVyblxuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChhLmhyZWYpXG4gICAgICBpZiAodXJsLm9yaWdpbiA9PT0gcGFnZVVSTC5vcmlnaW4pIHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSB1cmwucGF0aG5hbWUuc3Vic3RyaW5nKDEpXG4gICAgICAgIGNvbnN0IHBhcmFtczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgICAgIGlmICh1cmwuc2VhcmNoKSB7XG4gICAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5mb3JFYWNoKCh2LCBrKSA9PiB7XG4gICAgICAgICAgICBwYXJhbXNba10gPSB2XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBEb2MuYmluZChhLCAnY2xpY2snLCAoZTogRXZlbnQpID0+IHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICB0aGlzLmxvYWRQYWdlKHRva2VuLCBwYXJhbXMpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZU1lbnVJdGVtc0Rpc3BsYXkgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIHRoZSB1c2VyIGhhcyBzaWduZWQgaW4gb3Igb3V0LFxuICAgKiBhbmQgd2hlbiB0aGUgdXNlciByZWdpc3RlcnMgYSBERVguXG4gICAqL1xuICB1cGRhdGVNZW51SXRlbXNEaXNwbGF5ICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGF1dGhlZCwgbW1TdGF0dXMgfSA9IHRoaXNcbiAgICBpZiAoIXBhZ2UpIHtcbiAgICAgIC8vIGluaXRpYWwgcGFnZSBsb2FkLCBoZWFkZXIgZWxlbWVudHMgbm90IHlldCBhdHRhY2hlZCBidXQgbWVudSBpdGVtc1xuICAgICAgLy8gd291bGQgYWxyZWFkeSBiZSBoaWRkZW4vZGlzcGxheWVkIGFzIGFwcHJvcHJpYXRlLlxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmICghYXV0aGVkKSB7XG4gICAgICBwYWdlLnByb2ZpbGVCb3guY2xhc3NMaXN0LnJlbW92ZSgnYXV0aGVkJylcbiAgICAgIERvYy5oaWRlKHBhZ2Uubm90ZUJlbGwsIHBhZ2Uud2FsbGV0c01lbnVFbnRyeSwgcGFnZS5tYXJrZXRzTWVudUVudHJ5KVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zZXRWaXMoT2JqZWN0LmtleXModGhpcy5leGNoYW5nZXMpLmxlbmd0aCA+IDAsIHBhZ2UubWFya2V0c01lbnVFbnRyeSwgcGFnZS5tbUxpbmspXG5cbiAgICBwYWdlLnByb2ZpbGVCb3guY2xhc3NMaXN0LmFkZCgnYXV0aGVkJylcbiAgICBEb2Muc2hvdyhwYWdlLm5vdGVCZWxsLCBwYWdlLndhbGxldHNNZW51RW50cnksIHBhZ2UubWFya2V0c01lbnVFbnRyeSlcbiAgICBEb2Muc2V0VmlzKG1tU3RhdHVzLCBwYWdlLm1tTGluaylcbiAgfVxuXG4gIGFzeW5jIGZldGNoTm90ZXMgKCkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEpTT04oJy9hcGkvbm90ZXMnKVxuICAgIGlmICghdGhpcy5jaGVja1Jlc3BvbnNlKHJlcykpIHJldHVybiBjb25zb2xlLmVycm9yKCdmYWlsZWQgdG8gZmV0Y2ggbm90ZXM6JywgcmVzPy5tc2cgfHwgU3RyaW5nKHJlcykpXG4gICAgcmVzLm5vdGVzLnJldmVyc2UoKVxuICAgIHRoaXMuc2V0Tm90ZXMocmVzLm5vdGVzKVxuICAgIHRoaXMuc2V0UG9rZXMocmVzLnBva2VzKVxuICAgIHRoaXMuc2V0UmVxdWlyZWRBY3Rpb25zKClcbiAgfVxuXG4gIC8qIGF0dGFjaENvbW1vbiBzY2FucyB0aGUgcHJvdmlkZWQgbm9kZSBhbmQgaGFuZGxlcyBzb21lIGNvbW1vbiBiaW5kaW5ncy4gKi9cbiAgYXR0YWNoQ29tbW9uIChub2RlOiBIVE1MRWxlbWVudCkge1xuICAgIHRoaXMuYmluZEludGVybmFsTmF2aWdhdGlvbihub2RlKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlQm9uZENvbmZzIHVwZGF0ZXMgdGhlIGluZm9ybWF0aW9uIGZvciBhIHBlbmRpbmcgYm9uZC5cbiAgICovXG4gIHVwZGF0ZUJvbmRDb25mcyAoZGV4QWRkcjogc3RyaW5nLCBjb2luSUQ6IHN0cmluZywgY29uZnM6IG51bWJlcikge1xuICAgIGNvbnN0IGRleCA9IHRoaXMuZXhjaGFuZ2VzW2RleEFkZHJdXG4gICAgZm9yIChjb25zdCBib25kIG9mIGRleC5hdXRoLnBlbmRpbmdCb25kcykgaWYgKGJvbmQuY29pbklEID09PSBjb2luSUQpIGJvbmQuY29uZnMgPSBjb25mc1xuICB9XG5cbiAgdXBkYXRlVGllciAoaG9zdDogc3RyaW5nLCBib25kZWRUaWVyOiBudW1iZXIpIHtcbiAgICB0aGlzLmV4Y2hhbmdlc1tob3N0XS5hdXRoLnJlcC5ib25kZWRUaWVyID0gYm9uZGVkVGllclxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlQm9uZE5vdGUgaXMgdGhlIGhhbmRsZXIgZm9yIHRoZSAnYm9uZHBvc3QnLXR5cGUgbm90aWZpY2F0aW9uLCB3aGljaFxuICAgKiBpcyB1c2VkIHRvIHVwZGF0ZSB0aGUgZGV4IHRpZXIgYW5kIHJlZ2lzdHJhdGlvbiBzdGF0dXMuXG4gICAqL1xuICBoYW5kbGVCb25kTm90ZSAobm90ZTogQm9uZE5vdGUpIHtcbiAgICBpZiAobm90ZS5hdXRoKSB0aGlzLmV4Y2hhbmdlc1tub3RlLmRleF0uYXV0aCA9IG5vdGUuYXV0aFxuICAgIHN3aXRjaCAobm90ZS50b3BpYykge1xuICAgICAgY2FzZSAnUmVnVXBkYXRlJzpcbiAgICAgICAgaWYgKG5vdGUuY29pbklEICE9PSBudWxsKSB7IC8vIHNob3VsZCBuZXZlciBiZSBudWxsIGZvciBSZWdVcGRhdGVcbiAgICAgICAgICB0aGlzLnVwZGF0ZUJvbmRDb25mcyhub3RlLmRleCwgbm90ZS5jb2luSUQsIG5vdGUuY29uZmlybWF0aW9ucylcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnQm9uZENvbmZpcm1lZCc6XG4gICAgICAgIGlmIChub3RlLnRpZXIgIT09IG51bGwpIHsgLy8gc2hvdWxkIG5ldmVyIGJlIG51bGwgZm9yIEJvbmRDb25maXJtZWRcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRpZXIobm90ZS5kZXgsIG5vdGUudGllcilcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBoYW5kbGVUcmFuc2FjdGlvbiBlaXRoZXIgYWRkcyBhIG5ldyB0cmFuc2FjdGlvbiB0byB0aGUgdHJhbnNhY3Rpb24gaGlzdG9yeVxuICAgKiBvciB1cGRhdGVzIGFuIGV4aXN0aW5nIHRyYW5zYWN0aW9uLlxuICAgKi9cbiAgaGFuZGxlVHJhbnNhY3Rpb25Ob3RlIChhc3NldElEOiBudW1iZXIsIG5vdGU6IFRyYW5zYWN0aW9uTm90ZSkge1xuICAgIGNvbnN0IHR4SGlzdG9yeSA9IHRoaXMudHhIaXN0b3J5TWFwW2Fzc2V0SURdXG4gICAgaWYgKCF0eEhpc3RvcnkpIHJldHVyblxuXG4gICAgaWYgKG5vdGUubmV3KSB7XG4gICAgICB0eEhpc3RvcnkudHhzLnVuc2hpZnQobm90ZS50cmFuc2FjdGlvbilcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHhIaXN0b3J5LnR4cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHR4SGlzdG9yeS50eHNbaV0uaWQgPT09IG5vdGUudHJhbnNhY3Rpb24uaWQpIHtcbiAgICAgICAgdHhIaXN0b3J5LnR4c1tpXSA9IG5vdGUudHJhbnNhY3Rpb25cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBoYW5kbGVUeEhpc3RvcnlTeW5jZWROb3RlIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBkZWxldGUgdGhpcy50eEhpc3RvcnlNYXBbYXNzZXRJRF1cbiAgfVxuXG4gIGxvZ2dlZEluIChub3RlczogQ29yZU5vdGVbXSwgcG9rZXM6IENvcmVOb3RlW10pIHtcbiAgICB0aGlzLnNldE5vdGVzKG5vdGVzKVxuICAgIHRoaXMuc2V0UG9rZXMocG9rZXMpXG4gICAgdGhpcy5zZXRSZXF1aXJlZEFjdGlvbnMoKVxuICB9XG5cbiAgLypcbiAgICogc2V0Tm90ZXMgc2V0cyB0aGUgY3VycmVudCBub3RpZmljYXRpb24gY2FjaGUgYW5kIHBvcHVsYXRlcyB0aGUgbm90aWZpY2F0aW9uXG4gICAqIGRpc3BsYXkuXG4gICAqL1xuICBzZXROb3RlcyAobm90ZXM6IENvcmVOb3RlW10pIHtcbiAgICB0aGlzLmxvZygnbm90ZXMnLCAnc2V0Tm90ZXMnLCBub3RlcylcbiAgICB0aGlzLm5vdGVzID0gW11cbiAgICBEb2MuZW1wdHkodGhpcy5wYWdlLm5vdGVMaXN0KVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm90ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMucHJlcGVuZE5vdGVFbGVtZW50KG5vdGVzW2ldKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIHNldFBva2VzIHNldHMgdGhlIGN1cnJlbnQgcG9rZSBjYWNoZSBhbmQgcG9wdWxhdGVzIHRoZSBwb2tlcyBkaXNwbGF5LlxuICAgKi9cbiAgc2V0UG9rZXMgKHBva2VzOiBDb3JlTm90ZVtdKSB7XG4gICAgdGhpcy5sb2coJ3Bva2VzJywgJ3NldFBva2VzJywgcG9rZXMpXG4gICAgdGhpcy5wb2tlcyA9IFtdXG4gICAgRG9jLmVtcHR5KHRoaXMucGFnZS5wb2tlTGlzdClcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBva2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLnByZXBlbmRQb2tlRWxlbWVudChwb2tlc1tpXSlcbiAgICB9XG4gIH1cblxuICBib3RTdGF0dXMgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcik6IE1NQm90U3RhdHVzIHwgdW5kZWZpbmVkIHtcbiAgICBmb3IgKGNvbnN0IGJvdCBvZiAodGhpcy5tbVN0YXR1cz8uYm90cyA/PyBbXSkpIHtcbiAgICAgIGNvbnN0IHsgY29uZmlnOiBjIH0gPSBib3RcbiAgICAgIGlmIChob3N0ID09PSBjLmhvc3QgJiYgYmFzZUlEID09PSBjLmJhc2VJRCAmJiBxdW90ZUlEID09PSBjLnF1b3RlSUQpIHtcbiAgICAgICAgcmV0dXJuIGJvdFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZVVzZXIgKG5vdGU6IENvcmVOb3RlKSB7XG4gICAgY29uc3QgeyB1c2VyLCBhc3NldHMsIHdhbGxldE1hcCB9ID0gdGhpc1xuICAgIGlmIChub3RlLnR5cGUgPT09ICdmaWF0cmF0ZXVwZGF0ZScpIHtcbiAgICAgIHRoaXMuZmlhdFJhdGVzTWFwID0gKG5vdGUgYXMgUmF0ZU5vdGUpLmZpYXRSYXRlc1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIFNvbWUgbm90ZXMgY2FuIGJlIHJlY2VpdmVkIGJlZm9yZSB3ZSBnZXQgYSBVc2VyIGR1cmluZyBsb2dpbi5cbiAgICBpZiAoIXVzZXIpIHJldHVyblxuICAgIHN3aXRjaCAobm90ZS50eXBlKSB7XG4gICAgICBjYXNlICdvcmRlcic6IHtcbiAgICAgICAgY29uc3Qgb3JkZXJOb3RlID0gbm90ZSBhcyBPcmRlck5vdGVcbiAgICAgICAgY29uc3Qgb3JkZXIgPSBvcmRlck5vdGUub3JkZXJcbiAgICAgICAgY29uc3QgbWt0ID0gdXNlci5leGNoYW5nZXNbb3JkZXIuaG9zdF0ubWFya2V0c1tvcmRlci5tYXJrZXRdXG4gICAgICAgIGNvbnN0IHRlbXBJRCA9IG9yZGVyTm90ZS50ZW1wSURcblxuICAgICAgICAvLyBFbnN1cmUgbWFya2V0J3MgaW5mbGlnaHQgb3JkZXJzIGxpc3QgaXMgdXBkYXRlZC5cbiAgICAgICAgaWYgKG5vdGUudG9waWMgPT09ICdBc3luY09yZGVyU3VibWl0dGVkJykge1xuICAgICAgICAgIGNvbnN0IGluRmxpZ2h0ID0gb3JkZXIgYXMgSW5GbGlnaHRPcmRlclxuICAgICAgICAgIGluRmxpZ2h0LnRlbXBJRCA9IHRlbXBJRFxuICAgICAgICAgIGlmICghbWt0LmluZmxpZ2h0KSBta3QuaW5mbGlnaHQgPSBbaW5GbGlnaHRdXG4gICAgICAgICAgZWxzZSBta3QuaW5mbGlnaHQucHVzaChpbkZsaWdodClcbiAgICAgICAgICBicmVha1xuICAgICAgICB9IGVsc2UgaWYgKG5vdGUudG9waWMgPT09ICdBc3luY09yZGVyRmFpbHVyZScpIHtcbiAgICAgICAgICBta3QuaW5mbGlnaHQgPSBta3QuaW5mbGlnaHQuZmlsdGVyKG9yZCA9PiBvcmQudGVtcElEICE9PSB0ZW1wSUQpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGkgaW4gbWt0LmluZmxpZ2h0IHx8IFtdKSB7XG4gICAgICAgICAgICBpZiAoIShta3QuaW5mbGlnaHRbaV0udGVtcElEID09PSB0ZW1wSUQpKSBjb250aW51ZVxuICAgICAgICAgICAgbWt0LmluZmxpZ2h0ID0gbWt0LmluZmxpZ2h0LmZpbHRlcihvcmQgPT4gb3JkLnRlbXBJRCAhPT0gdGVtcElEKVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBVcGRhdGVzIGdpdmVuIG9yZGVyIGluIG1hcmtldCdzIG9yZGVycyBsaXN0IGlmIGl0IGZpbmRzIGl0LlxuICAgICAgICAvLyBSZXR1cm5zIGEgYm9vbCB3aGljaCBpbmRpY2F0ZXMgaWYgb3JkZXIgd2FzIGZvdW5kLlxuICAgICAgICBta3Qub3JkZXJzID0gbWt0Lm9yZGVycyB8fCBbXVxuICAgICAgICBjb25zdCB1cGRhdGVPcmRlciA9IChta3Q6IE1hcmtldCwgb3JkOiBPcmRlcikgPT4ge1xuICAgICAgICAgIGNvbnN0IGkgPSBta3Qub3JkZXJzLmZpbmRJbmRleCgobzogT3JkZXIpID0+IG8uaWQgPT09IG9yZC5pZClcbiAgICAgICAgICBpZiAoaSA9PT0gLTEpIHJldHVybiBmYWxzZVxuICAgICAgICAgIGlmIChub3RlLnRvcGljID09PSAnT3JkZXJSZXRpcmVkJykgbWt0Lm9yZGVycy5zcGxpY2UoaSwgMSlcbiAgICAgICAgICBlbHNlIG1rdC5vcmRlcnNbaV0gPSBvcmRcbiAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBub3RpZmljYXRpb24gb3JkZXIgYWxyZWFkeSBleGlzdHMgd2UgdXBkYXRlIGl0LlxuICAgICAgICAvLyBJbiBjYXNlIG1hcmtldCdzIG9yZGVycyBsaXN0IGlzIGVtcHR5IG9yIHRoZSBub3RpZmljYXRpb24gb3JkZXIgaXNuJ3RcbiAgICAgICAgLy8gcGFydCBvZiBpdCB3ZSBhZGQgaXQgbWFudWFsbHkgYXMgdGhpcyBtZWFucyB0aGUgb3JkZXIgd2FzXG4gICAgICAgIC8vIGp1c3QgcGxhY2VkLlxuICAgICAgICBpZiAoIXVwZGF0ZU9yZGVyKG1rdCwgb3JkZXIpKSBta3Qub3JkZXJzLnB1c2gob3JkZXIpXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdiYWxhbmNlJzoge1xuICAgICAgICBjb25zdCBuOiBCYWxhbmNlTm90ZSA9IG5vdGUgYXMgQmFsYW5jZU5vdGVcbiAgICAgICAgY29uc3QgYXNzZXQgPSB1c2VyLmFzc2V0c1tuLmFzc2V0SURdXG4gICAgICAgIC8vIEJhbGFuY2UgdXBkYXRlcyBjYW4gY29tZSBiZWZvcmUgdGhlIHVzZXIgaXMgZmV0Y2hlZCBhZnRlciBsb2dpbi5cbiAgICAgICAgaWYgKCFhc3NldCkgYnJlYWtcbiAgICAgICAgY29uc3QgdyA9IGFzc2V0LndhbGxldFxuICAgICAgICBpZiAodykgdy5iYWxhbmNlID0gbi5iYWxhbmNlXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdib25kcG9zdCc6XG4gICAgICAgIHRoaXMuaGFuZGxlQm9uZE5vdGUobm90ZSBhcyBCb25kTm90ZSlcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ3JlcHV0YXRpb24nOiB7XG4gICAgICAgIGNvbnN0IG4gPSBub3RlIGFzIFJlcHV0YXRpb25Ob3RlXG4gICAgICAgIHRoaXMuZXhjaGFuZ2VzW24uaG9zdF0uYXV0aC5yZXAgPSBuLnJlcFxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnd2FsbGV0c3RhdGUnOlxuICAgICAgY2FzZSAnd2FsbGV0Y29uZmlnJzoge1xuICAgICAgICAvLyBhc3NldHMgY2FuIGJlIG51bGwgaWYgZmFpbGVkIHRvIGNvbm5lY3QgdG8gZGV4IHNlcnZlci5cbiAgICAgICAgaWYgKCFhc3NldHMpIHJldHVyblxuICAgICAgICBjb25zdCB3YWxsZXQgPSAobm90ZSBhcyBXYWxsZXRDb25maWdOb3RlKT8ud2FsbGV0XG4gICAgICAgIGlmICghd2FsbGV0KSByZXR1cm5cbiAgICAgICAgY29uc3QgYXNzZXQgPSBhc3NldHNbd2FsbGV0LmFzc2V0SURdXG4gICAgICAgIGFzc2V0LndhbGxldCA9IHdhbGxldFxuICAgICAgICB3YWxsZXRNYXBbd2FsbGV0LmFzc2V0SURdID0gd2FsbGV0XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICd3YWxsZXRzeW5jJzoge1xuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBXYWxsZXRTeW5jTm90ZVxuICAgICAgICBjb25zdCB3ID0gdGhpcy53YWxsZXRNYXBbbi5hc3NldElEXVxuICAgICAgICBpZiAodykge1xuICAgICAgICAgIHcuc3luY1N0YXR1cyA9IG4uc3luY1N0YXR1c1xuICAgICAgICAgIHcuc3luY2VkID0gdy5zeW5jU3RhdHVzLnN5bmNlZFxuICAgICAgICAgIHcuc3luY1Byb2dyZXNzID0gbi5zeW5jUHJvZ3Jlc3NcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnbWF0Y2gnOiB7XG4gICAgICAgIGNvbnN0IG4gPSBub3RlIGFzIE1hdGNoTm90ZVxuICAgICAgICBjb25zdCBvcmQgPSB0aGlzLm9yZGVyKG4ub3JkZXJJRClcbiAgICAgICAgaWYgKG9yZCkgdXBkYXRlTWF0Y2gob3JkLCBuLm1hdGNoKVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnY29ubic6IHtcbiAgICAgICAgY29uc3QgbiA9IG5vdGUgYXMgQ29ubkV2ZW50Tm90ZVxuICAgICAgICBjb25zdCB4YyA9IHVzZXIuZXhjaGFuZ2VzW24uaG9zdF1cbiAgICAgICAgaWYgKHhjKSB4Yy5jb25uZWN0aW9uU3RhdHVzID0gbi5jb25uZWN0aW9uU3RhdHVzXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdzcG90cyc6IHtcbiAgICAgICAgY29uc3QgbiA9IG5vdGUgYXMgU3BvdFByaWNlTm90ZVxuICAgICAgICBjb25zdCB4YyA9IHVzZXIuZXhjaGFuZ2VzW24uaG9zdF1cbiAgICAgICAgLy8gU3BvdHMgY2FuIGNvbWUgYmVmb3JlIHRoZSB1c2VyIGlzIGZldGNoZWQgYWZ0ZXIgbG9naW4gYW5kIGJlZm9yZS93aGlsZSB0aGVcbiAgICAgICAgLy8gbWFya2V0cyBwYWdlIHJlbG9hZCB3aGVuIGl0IHJlY2VpdmVzIGEgZGV4IGNvbm4gbm90ZS5cbiAgICAgICAgaWYgKCF4YyB8fCAheGMubWFya2V0cykgYnJlYWtcbiAgICAgICAgZm9yIChjb25zdCBbbWt0TmFtZSwgc3BvdF0gb2YgT2JqZWN0LmVudHJpZXMobi5zcG90cykpIHhjLm1hcmtldHNbbWt0TmFtZV0uc3BvdCA9IHNwb3RcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2ZpYXRyYXRldXBkYXRlJzoge1xuICAgICAgICB0aGlzLmZpYXRSYXRlc01hcCA9IChub3RlIGFzIFJhdGVOb3RlKS5maWF0UmF0ZXNcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2FjdGlvbnJlcXVpcmVkJzoge1xuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBDb3JlQWN0aW9uUmVxdWlyZWROb3RlXG4gICAgICAgIHRoaXMuYWRkQWN0aW9uKG4ucGF5bG9hZClcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3dhbGxldG5vdGUnOiB7XG4gICAgICAgIGNvbnN0IG4gPSBub3RlIGFzIFdhbGxldE5vdGVcbiAgICAgICAgc3dpdGNoIChuLnBheWxvYWQucm91dGUpIHtcbiAgICAgICAgICBjYXNlICd0cmFuc2FjdGlvbic6IHtcbiAgICAgICAgICAgIGNvbnN0IHR4Tm90ZSA9IG4ucGF5bG9hZCBhcyBUcmFuc2FjdGlvbk5vdGVcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlVHJhbnNhY3Rpb25Ob3RlKG4ucGF5bG9hZC5hc3NldElELCB0eE5vdGUpXG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlICdhY3Rpb25SZXF1aXJlZCc6IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcSA9IG4ucGF5bG9hZCBhcyBBY3Rpb25SZXF1aXJlZE5vdGVcbiAgICAgICAgICAgIHRoaXMuYWRkQWN0aW9uKHJlcSlcbiAgICAgICAgICAgIHRoaXMuYmxpbmtBY3Rpb24oKVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSAnYWN0aW9uUmVzb2x2ZWQnOiB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmVBY3Rpb24obi5wYXlsb2FkIGFzIEFjdGlvblJlc29sdmVkTm90ZSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG4ucGF5bG9hZC5yb3V0ZSA9PT0gJ3RyYW5zYWN0aW9uSGlzdG9yeVN5bmNlZCcpIHtcbiAgICAgICAgICB0aGlzLmhhbmRsZVR4SGlzdG9yeVN5bmNlZE5vdGUobi5wYXlsb2FkLmFzc2V0SUQpXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3J1bnN0YXRzJzoge1xuICAgICAgICB0aGlzLmxvZygnbW0nLCB7IHJ1bnN0YXRzOiBub3RlIH0pXG4gICAgICAgIGNvbnN0IG4gPSBub3RlIGFzIFJ1blN0YXRzTm90ZVxuICAgICAgICBjb25zdCBib3QgPSB0aGlzLmJvdFN0YXR1cyhuLmhvc3QsIG4uYmFzZUlELCBuLnF1b3RlSUQpXG4gICAgICAgIGlmIChib3QpIHtcbiAgICAgICAgICBib3QucnVuU3RhdHMgPSBuLnN0YXRzXG4gICAgICAgICAgYm90LnJ1bm5pbmcgPSBCb29sZWFuKG4uc3RhdHMpXG4gICAgICAgICAgaWYgKCFuLnN0YXRzKSB7XG4gICAgICAgICAgICBib3QubGF0ZXN0RXBvY2ggPSB1bmRlZmluZWRcbiAgICAgICAgICAgIGJvdC5jZXhQcm9ibGVtcyA9IHVuZGVmaW5lZFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnY2V4bm90ZSc6IHtcbiAgICAgICAgY29uc3QgbiA9IG5vdGUgYXMgQ0VYTm90aWZpY2F0aW9uXG4gICAgICAgIHN3aXRjaCAobi50b3BpYykge1xuICAgICAgICAgIGNhc2UgJ0JhbGFuY2VVcGRhdGUnOiB7XG4gICAgICAgICAgICBjb25zdCB1ID0gbi5ub3RlIGFzIENFWEJhbGFuY2VVcGRhdGVcbiAgICAgICAgICAgIHRoaXMubW1TdGF0dXMuY2V4ZXNbbi5jZXhOYW1lXS5iYWxhbmNlc1t1LmFzc2V0SURdID0gdS5iYWxhbmNlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdlcG9jaHJlcG9ydCc6IHtcbiAgICAgICAgY29uc3QgbiA9IG5vdGUgYXMgRXBvY2hSZXBvcnROb3RlXG4gICAgICAgIGNvbnN0IGJvdCA9IHRoaXMuYm90U3RhdHVzKG4uaG9zdCwgbi5iYXNlSUQsIG4ucXVvdGVJRClcbiAgICAgICAgaWYgKGJvdCkgYm90LmxhdGVzdEVwb2NoID0gbi5yZXBvcnRcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2NleHByb2JsZW1zJzoge1xuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBDRVhQcm9ibGVtc05vdGVcbiAgICAgICAgY29uc3QgYm90ID0gdGhpcy5ib3RTdGF0dXMobi5ob3N0LCBuLmJhc2VJRCwgbi5xdW90ZUlEKVxuICAgICAgICBpZiAoYm90KSBib3QuY2V4UHJvYmxlbXMgPSBuLnByb2JsZW1zXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogbm90aWZ5IGlzIHRoZSB0b3AtbGV2ZWwgaGFuZGxlciBmb3Igbm90aWZpY2F0aW9ucyByZWNlaXZlZCBmcm9tIHRoZSBjbGllbnQuXG4gICAqIE5vdGlmaWNhdGlvbnMgYXJlIHByb3BhZ2F0ZWQgdG8gdGhlIGxvYWRlZFBhZ2UuXG4gICAqL1xuICBub3RpZnkgKG5vdGU6IENvcmVOb3RlKSB7XG4gICAgLy8gSGFuZGxlIHR5cGUtc3BlY2lmaWMgdXBkYXRlcy5cbiAgICB0aGlzLmxvZygnbm90ZXMnLCAnbm90aWZ5Jywgbm90ZSlcbiAgICB0aGlzLnVwZGF0ZVVzZXIobm90ZSlcbiAgICAvLyBJbmZvcm0gdGhlIHBhZ2UuXG4gICAgZm9yIChjb25zdCBmZWVkZXIgb2YgdGhpcy5ub3RlUmVjZWl2ZXJzKSB7XG4gICAgICBjb25zdCBmID0gZmVlZGVyW25vdGUudHlwZV1cbiAgICAgIGlmICghZikgY29udGludWVcbiAgICAgIHRyeSB7XG4gICAgICAgIGYobm90ZSlcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ25vdGUgZmVlZGVyIGVycm9yOicsIGVycm9yLm1lc3NhZ2UgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IpXG4gICAgICAgIGNvbnNvbGUubG9nKG5vdGUpXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnN0YWNrKVxuICAgICAgfVxuICAgIH1cbiAgICAvLyBEaXNjYXJkIGRhdGEgbm90aWZpY2F0aW9ucy5cbiAgICBpZiAobm90ZS5zZXZlcml0eSA8IG50Zm4uUE9LRSkgcmV0dXJuXG4gICAgLy8gUG9rZSBub3RpZmljYXRpb25zIGhhdmUgdGhlaXIgb3duIGRpc3BsYXkuXG4gICAgY29uc3QgeyBwb3B1cFRtcGwsIHBvcHVwTm90ZXMsIHNob3dQb3B1cHMgfSA9IHRoaXNcbiAgICBpZiAoc2hvd1BvcHVwcykge1xuICAgICAgY29uc3Qgc3BhbiA9IHBvcHVwVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIERvYy50bXBsRWxlbWVudChzcGFuLCAndGV4dCcpLnRleHRDb250ZW50ID0gYCR7bm90ZS5zdWJqZWN0fTogJHtudGZuLnBsYWluTm90ZShub3RlLmRldGFpbHMpfWBcbiAgICAgIGNvbnN0IGluZGljYXRvciA9IERvYy50bXBsRWxlbWVudChzcGFuLCAnaW5kaWNhdG9yJylcbiAgICAgIGlmIChub3RlLnNldmVyaXR5ID09PSBudGZuLlBPS0UpIHtcbiAgICAgICAgRG9jLmhpZGUoaW5kaWNhdG9yKVxuICAgICAgfSBlbHNlIHNldFNldmVyaXR5Q2xhc3MoaW5kaWNhdG9yLCBub3RlLnNldmVyaXR5KVxuICAgICAgcG9wdXBOb3Rlcy5hcHBlbmRDaGlsZChzcGFuKVxuICAgICAgRG9jLnNob3cocG9wdXBOb3RlcylcbiAgICAgIC8vIFRoZXNlIHRha2UgdXAgc2NyZWVuIHNwYWNlLiBPbmx5IHNob3cgbWF4IDUgYXQgYSB0aW1lLlxuICAgICAgd2hpbGUgKHBvcHVwTm90ZXMuY2hpbGRyZW4ubGVuZ3RoID4gNSkgcG9wdXBOb3Rlcy5yZW1vdmVDaGlsZChwb3B1cE5vdGVzLmZpcnN0Q2hpbGQgYXMgTm9kZSlcbiAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCBEb2MuYW5pbWF0ZSg1MDAsIChwcm9ncmVzczogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgc3Bhbi5zdHlsZS5vcGFjaXR5ID0gU3RyaW5nKDEgLSBwcm9ncmVzcylcbiAgICAgICAgfSlcbiAgICAgICAgc3Bhbi5yZW1vdmUoKVxuICAgICAgICBpZiAocG9wdXBOb3Rlcy5jaGlsZHJlbi5sZW5ndGggPT09IDApIERvYy5oaWRlKHBvcHVwTm90ZXMpXG4gICAgICB9LCA2MDAwKVxuICAgIH1cbiAgICAvLyBTdWNjZXNzIGFuZCBoaWdoZXIgc2V2ZXJpdHkgZ28gdG8gdGhlIGJlbGwgZHJvcGRvd24uXG4gICAgaWYgKG5vdGUuc2V2ZXJpdHkgPT09IG50Zm4uUE9LRSkgdGhpcy5wcmVwZW5kUG9rZUVsZW1lbnQobm90ZSlcbiAgICBlbHNlIHRoaXMucHJlcGVuZE5vdGVFbGVtZW50KG5vdGUpXG5cbiAgICAvLyBzaG93IGRlc2t0b3Agbm90aWZpY2F0aW9uXG4gICAgbnRmbi5kZXNrdG9wTm90aWZ5KG5vdGUpXG4gIH1cblxuICAvKlxuICAgKiByZWdpc3Rlck5vdGVGZWVkZXIgcmVnaXN0ZXJzIGEgZmVlZGVyIGZvciBjb3JlIG5vdGlmaWNhdGlvbnMuIFRoZSBmZWVkZXJcbiAgICogd2lsbCBiZSBkZS1yZWdpc3RlcmVkIHdoZW4gYSBuZXcgcGFnZSBpcyBsb2FkZWQuXG4gICAqL1xuICByZWdpc3Rlck5vdGVGZWVkZXIgKHJlY2VpdmVyczogUmVjb3JkPHN0cmluZywgKG46IENvcmVOb3RlKSA9PiB2b2lkPikge1xuICAgIHRoaXMubm90ZVJlY2VpdmVycy5wdXNoKHJlY2VpdmVycylcbiAgfVxuXG4gIC8qXG4gICAqIGxvZyBwcmludHMgdG8gdGhlIGNvbnNvbGUgaWYgYSBsb2dnZXIgaGFzIGJlZW4gZW5hYmxlZC4gTG9nZ2VycyBhcmUgY3JlYXRlZFxuICAgKiBpbXBsaWNpdGx5IGJ5IHBhc3NpbmcgYSBsb2dnZXJJRCB0byBsb2cuIGkuZS4geW91IGRvbid0IGNyZWF0ZSBhIGxvZ2dlcixcbiAgICogeW91IGp1c3QgbG9nIHRvIGl0LiBMb2dnZXJzIGFyZSBlbmFibGVkIGJ5IGludm9raW5nIGEgZ2xvYmFsIGZ1bmN0aW9uLFxuICAgKiBlbmFibGVMb2dnZXIobG9nZ2VySUQsIG9uT2ZmQm9vbGVhbiksIGZyb20gdGhlIGJyb3dzZXIncyBqcyBjb25zb2xlLiBZb3VyXG4gICAqIGNob2ljZXMgYXJlIHN0b3JlZCBhY3Jvc3Mgc2Vzc2lvbnMuIFNvbWUgY29tbW9uIGFuZCB1c2VmdWwgbG9nZ2VycyBhcmVcbiAgICogbGlzdGVkIGJlbG93LCBidXQgdGhpcyBsaXN0IGlzIG5vdCBtZWFudCB0byBiZSBjb21wcmVoZW5zaXZlLlxuICAgKlxuICAgKiBMb2dnZXJJRCAgIERlc2NyaXB0aW9uXG4gICAqIC0tLS0tLS0tICAgLS0tLS0tLS0tLS1cbiAgICogbm90ZXMgICAgICBOb3RpZmljYXRpb25zIG9mIGFsbCBsZXZlbHMuXG4gICAqIGJvb2sgICAgICAgT3JkZXIgYm9vayBmZWVkLlxuICAgKiB3cy4uLi4uLi4uLldlYnNvY2tldCBjb25uZWN0aW9uIHN0YXR1cyBjaGFuZ2VzLlxuICAgKi9cbiAgbG9nIChsb2dnZXJJRDogc3RyaW5nLCAuLi5tc2c6IGFueSkge1xuICAgIGlmICh0aGlzLmxvZ2dlcnNbbG9nZ2VySURdKSBjb25zb2xlLmxvZyhgJHtub3dTdHJpbmcoKX1bJHtsb2dnZXJJRH1dOmAsIC4uLm1zZylcbiAgICBpZiAodGhpcy5yZWNvcmRlcnNbbG9nZ2VySURdKSB7XG4gICAgICB0aGlzLnJlY29yZGVyc1tsb2dnZXJJRF0ucHVzaCh7XG4gICAgICAgIHRpbWU6IG5vd1N0cmluZygpLFxuICAgICAgICBtc2c6IG1zZ1xuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBwcmVwZW5kUG9rZUVsZW1lbnQgKGNuOiBDb3JlTm90ZSkge1xuICAgIGNvbnN0IFtlbCwgbm90ZV0gPSB0aGlzLm1ha2VQb2tlKGNuKVxuICAgIHRoaXMucG9rZXMucHVzaChub3RlKVxuICAgIHdoaWxlICh0aGlzLnBva2VzLmxlbmd0aCA+IG5vdGVDYWNoZVNpemUpIHRoaXMucG9rZXMuc2hpZnQoKVxuICAgIHRoaXMucHJlcGVuZExpc3RFbGVtZW50KHRoaXMucGFnZS5wb2tlTGlzdCwgbm90ZSwgZWwpXG4gIH1cblxuICBwcmVwZW5kTm90ZUVsZW1lbnQgKGNuOiBDb3JlTm90ZSkge1xuICAgIGNvbnN0IFtlbCwgbm90ZV0gPSB0aGlzLm1ha2VOb3RlKGNuKVxuICAgIHRoaXMubm90ZXMucHVzaChub3RlKVxuICAgIHdoaWxlICh0aGlzLm5vdGVzLmxlbmd0aCA+IG5vdGVDYWNoZVNpemUpIHRoaXMubm90ZXMuc2hpZnQoKVxuICAgIGNvbnN0IG5vdGVMaXN0ID0gdGhpcy5wYWdlLm5vdGVMaXN0XG4gICAgdGhpcy5wcmVwZW5kTGlzdEVsZW1lbnQobm90ZUxpc3QsIG5vdGUsIGVsKVxuICAgIHRoaXMuYmluZFVybEhhbmRsZXJzKGVsKVxuICAgIC8vIFNldCB0aGUgaW5kaWNhdG9yIGNvbG9yLlxuICAgIGlmICh0aGlzLm5vdGVzLmxlbmd0aCA9PT0gMCB8fCAoRG9jLmlzRGlzcGxheWVkKHRoaXMucGFnZS5ub3RlQm94KSAmJiBEb2MuaXNEaXNwbGF5ZWQobm90ZUxpc3QpKSkgcmV0dXJuXG4gICAgbGV0IHVuYWNrZWQgPSAwXG4gICAgY29uc3Qgc2V2ZXJpdHkgPSB0aGlzLm5vdGVzLnJlZHVjZSgocywgbm90ZSkgPT4ge1xuICAgICAgaWYgKCFub3RlLmFja2VkKSB1bmFja2VkKytcbiAgICAgIGlmICghbm90ZS5hY2tlZCAmJiBub3RlLnNldmVyaXR5ID4gcykgcmV0dXJuIG5vdGUuc2V2ZXJpdHlcbiAgICAgIHJldHVybiBzXG4gICAgfSwgbnRmbi5JR05PUkUpXG4gICAgY29uc3QgbmkgPSB0aGlzLnBhZ2Uubm90ZUluZGljYXRvclxuICAgIHNldFNldmVyaXR5Q2xhc3MobmksIHNldmVyaXR5KVxuICAgIGlmICh1bmFja2VkKSB7XG4gICAgICBuaS50ZXh0Q29udGVudCA9IFN0cmluZygodW5hY2tlZCA+IG5vdGVDYWNoZVNpemUgLSAxKSA/IGAke25vdGVDYWNoZVNpemUgLSAxfStgIDogdW5hY2tlZClcbiAgICAgIERvYy5zaG93KG5pKVxuICAgIH0gZWxzZSBEb2MuaGlkZShuaSlcbiAgfVxuXG4gIHByZXBlbmRMaXN0RWxlbWVudCAobm90ZUxpc3Q6IEhUTUxFbGVtZW50LCBub3RlOiBDb3JlTm90ZVBsdXMsIGVsOiBOb3RlRWxlbWVudCkge1xuICAgIGVsLm5vdGUgPSBub3RlXG4gICAgbm90ZUxpc3QucHJlcGVuZChlbClcbiAgICB3aGlsZSAobm90ZUxpc3QuY2hpbGRyZW4ubGVuZ3RoID4gbm90ZUNhY2hlU2l6ZSkgbm90ZUxpc3QucmVtb3ZlQ2hpbGQobm90ZUxpc3QubGFzdENoaWxkIGFzIE5vZGUpXG4gICAgdGhpcy5zZXROb3RlVGltZXMobm90ZUxpc3QpXG4gIH1cblxuICAvKlxuICAgKiBtYWtlTm90ZSBjb25zdHJ1Y3RzIGEgc2luZ2xlIG5vdGlmaWNhdGlvbiBlbGVtZW50IGZvciB0aGUgZHJvcC1kb3duXG4gICAqIG5vdGlmaWNhdGlvbiBsaXN0LlxuICAgKi9cbiAgbWFrZU5vdGUgKG5vdGU6IENvcmVOb3RlKTogW05vdGVFbGVtZW50LCBDb3JlTm90ZVBsdXNdIHtcbiAgICBjb25zdCBlbCA9IHRoaXMucGFnZS5ub3RlVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgTm90ZUVsZW1lbnRcbiAgICBpZiAobm90ZS5zZXZlcml0eSA+IG50Zm4uUE9LRSkge1xuICAgICAgY29uc3QgY2xzID0gbm90ZS5zZXZlcml0eSA9PT0gbnRmbi5TVUNDRVNTID8gJ2dvb2QnIDogbm90ZS5zZXZlcml0eSA9PT0gbnRmbi5XQVJOSU5HID8gJ3dhcm4nIDogJ2JhZCdcbiAgICAgIERvYy5zYWZlU2VsZWN0b3IoZWwsICdkaXYubm90ZS1pbmRpY2F0b3InKS5jbGFzc0xpc3QuYWRkKGNscylcbiAgICB9XG5cbiAgICBEb2Muc2FmZVNlbGVjdG9yKGVsLCAnZGl2Lm5vdGUtc3ViamVjdCcpLnRleHRDb250ZW50ID0gbm90ZS5zdWJqZWN0XG4gICAgbnRmbi5pbnNlcnRSaWNoTm90ZShEb2Muc2FmZVNlbGVjdG9yKGVsLCAnZGl2Lm5vdGUtZGV0YWlscycpLCBub3RlLmRldGFpbHMpXG4gICAgY29uc3QgbnA6IENvcmVOb3RlUGx1cyA9IHsgZWwsIC4uLm5vdGUgfVxuICAgIHJldHVybiBbZWwsIG5wXVxuICB9XG5cbiAgbWFrZVBva2UgKG5vdGU6IENvcmVOb3RlKTogW05vdGVFbGVtZW50LCBDb3JlTm90ZVBsdXNdIHtcbiAgICBjb25zdCBlbCA9IHRoaXMucGFnZS5wb2tlVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgTm90ZUVsZW1lbnRcbiAgICBEb2MudG1wbEVsZW1lbnQoZWwsICdzdWJqZWN0JykudGV4dENvbnRlbnQgPSBgJHtub3RlLnN1YmplY3R9OmBcbiAgICBudGZuLmluc2VydFJpY2hOb3RlKERvYy50bXBsRWxlbWVudChlbCwgJ2RldGFpbHMnKSwgbm90ZS5kZXRhaWxzKVxuICAgIGNvbnN0IG5wOiBDb3JlTm90ZVBsdXMgPSB7IGVsLCAuLi5ub3RlIH1cbiAgICByZXR1cm4gW2VsLCBucF1cbiAgfVxuXG4gIC8qXG4gICAqIGxvYWRpbmcgYXBwZW5kcyB0aGUgbG9hZGVyIHRvIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBhbmQgZGlzcGxheXMgdGhlXG4gICAqIGxvYWRpbmcgaWNvbi4gVGhlIGxvYWRlciB3aWxsIGJsb2NrIGFsbCBpbnRlcmFjdGlvbiB3aXRoIHRoZSBzcGVjaWZpZWRcbiAgICogZWxlbWVudCB1bnRpbCBBcHBsaWNhdGlvbi5sb2FkZWQgaXMgY2FsbGVkLlxuICAgKi9cbiAgbG9hZGluZyAoZWw6IEhUTUxFbGVtZW50KTogKCkgPT4gdm9pZCB7XG4gICAgY29uc3QgbG9hZGVyID0gdGhpcy5wYWdlLmxvYWRlci5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICBlbC5hcHBlbmRDaGlsZChsb2FkZXIpXG4gICAgcmV0dXJuICgpID0+IHsgbG9hZGVyLnJlbW92ZSgpIH1cbiAgfVxuXG4gIC8qIG9yZGVycyByZXRyaWV2ZXMgYSBsaXN0IG9mIG9yZGVycyBmb3IgdGhlIHNwZWNpZmllZCBkZXggYW5kIG1hcmtldFxuICAgKiBpbmNsdWRpbmcgaW5mbGlnaHQgb3JkZXJzLlxuICAgKi9cbiAgb3JkZXJzIChob3N0OiBzdHJpbmcsIG1rdElEOiBzdHJpbmcpOiBPcmRlcltdIHtcbiAgICBsZXQgb3JkZXJzOiBPcmRlcltdID0gW11cbiAgICBjb25zdCBta3QgPSB0aGlzLnVzZXIuZXhjaGFuZ2VzW2hvc3RdLm1hcmtldHNbbWt0SURdXG4gICAgaWYgKG1rdC5vcmRlcnMpIG9yZGVycyA9IG9yZGVycy5jb25jYXQobWt0Lm9yZGVycylcbiAgICBpZiAobWt0LmluZmxpZ2h0KSBvcmRlcnMgPSBvcmRlcnMuY29uY2F0KG1rdC5pbmZsaWdodClcbiAgICByZXR1cm4gb3JkZXJzXG4gIH1cblxuICAvKlxuICAgKiBoYXZlQWN0aXZlT3JkZXJzIHJldHVybnMgd2hldGhlciBvciBub3QgdGhlcmUgYXJlIGFjdGl2ZSBvcmRlcnMgaW52b2x2aW5nIGFcbiAgICogY2VydGFpbiBhc3NldC5cbiAgICovXG4gIGhhdmVBY3RpdmVPcmRlcnMgKGFzc2V0SUQ6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGZvciAoY29uc3QgeGMgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLnVzZXIuZXhjaGFuZ2VzKSkge1xuICAgICAgaWYgKCF4Yy5tYXJrZXRzKSBjb250aW51ZVxuICAgICAgZm9yIChjb25zdCBtYXJrZXQgb2YgT2JqZWN0LnZhbHVlcyh4Yy5tYXJrZXRzKSkge1xuICAgICAgICBpZiAoIW1hcmtldC5vcmRlcnMpIGNvbnRpbnVlXG4gICAgICAgIGZvciAoY29uc3Qgb3JkIG9mIG1hcmtldC5vcmRlcnMpIHtcbiAgICAgICAgICBpZiAoKG9yZC5iYXNlSUQgPT09IGFzc2V0SUQgfHwgb3JkLnF1b3RlSUQgPT09IGFzc2V0SUQpICYmXG4gICAgICAgICAgICAob3JkLnN0YXR1cyA8IFN0YXR1c0V4ZWN1dGVkIHx8IGhhc0FjdGl2ZU1hdGNoZXMob3JkKSkpIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICAvKiBvcmRlciBhdHRlbXB0cyB0byBsb2NhdGUgYW4gb3JkZXIgYnkgb3JkZXIgSUQuICovXG4gIG9yZGVyIChvaWQ6IHN0cmluZyk6IE9yZGVyIHwgbnVsbCB7XG4gICAgZm9yIChjb25zdCB4YyBvZiBPYmplY3QudmFsdWVzKHRoaXMudXNlci5leGNoYW5nZXMpKSB7XG4gICAgICBpZiAoIXhjIHx8ICF4Yy5tYXJrZXRzKSBjb250aW51ZVxuICAgICAgZm9yIChjb25zdCBtYXJrZXQgb2YgT2JqZWN0LnZhbHVlcyh4Yy5tYXJrZXRzKSkge1xuICAgICAgICBpZiAoIW1hcmtldC5vcmRlcnMpIGNvbnRpbnVlXG4gICAgICAgIGZvciAoY29uc3Qgb3JkIG9mIG1hcmtldC5vcmRlcnMpIHtcbiAgICAgICAgICBpZiAob3JkLmlkID09PSBvaWQpIHJldHVybiBvcmRcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLypcbiAgICogY2FuQWNjZWxlcmF0ZU9yZGVyIHJldHVybnMgdHJ1ZSBpZiB0aGUgXCJmcm9tXCIgd2FsbGV0IG9mIHRoZSBvcmRlclxuICAgKiBzdXBwb3J0cyBhY2NlbGVyYXRpb24sIGFuZCBpZiB0aGUgb3JkZXIgaGFzIHVuY29uZmlybWVkIHN3YXBcbiAgICogdHJhbnNhY3Rpb25zLlxuICAgKi9cbiAgY2FuQWNjZWxlcmF0ZU9yZGVyIChvcmRlcjogT3JkZXIpOiBib29sZWFuIHtcbiAgICBjb25zdCB3YWxsZXRUcmFpdEFjY2VsZXJhdG9yID0gMSA8PCA0XG4gICAgbGV0IGZyb21Bc3NldElEXG4gICAgaWYgKG9yZGVyLnNlbGwpIGZyb21Bc3NldElEID0gb3JkZXIuYmFzZUlEXG4gICAgZWxzZSBmcm9tQXNzZXRJRCA9IG9yZGVyLnF1b3RlSURcbiAgICBjb25zdCB3YWxsZXQgPSB0aGlzLndhbGxldE1hcFtmcm9tQXNzZXRJRF1cbiAgICBpZiAoIXdhbGxldCB8fCAhKHdhbGxldC50cmFpdHMgJiB3YWxsZXRUcmFpdEFjY2VsZXJhdG9yKSkgcmV0dXJuIGZhbHNlXG4gICAgaWYgKG9yZGVyLm1hdGNoZXMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3JkZXIubWF0Y2hlcz8ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBvcmRlci5tYXRjaGVzW2ldXG4gICAgICAgIGlmIChtYXRjaC5zd2FwICYmIG1hdGNoLnN3YXAuY29uZnMgJiYgbWF0Y2guc3dhcC5jb25mcy5jb3VudCA9PT0gMCAmJiAhbWF0Y2gucmV2b2tlZCkge1xuICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICAvKlxuICAgKiB1bml0SW5mbyBmZXRjaGVzIHVuaXQgaW5mbyBbZGV4LlVuaXRJbmZvXSBmb3IgdGhlIGFzc2V0LiBJZiB4Y1xuICAgKiBbY29yZS5FeGNoYW5nZV0gaXMgcHJvdmlkZWQsIGFuZCB0aGlzIGlzIG5vdCBhIFN1cHBvcnRlZEFzc2V0LCB0aGUgVW5pdEluZm9cbiAgICogc2VudCBmcm9tIHRoZSBleGNoYW5nZSdzIGFzc2V0cyBtYXAgW2RleC5Bc3NldF0gd2lsbCBiZSB1c2VkLlxuICAgKi9cbiAgdW5pdEluZm8gKGFzc2V0SUQ6IG51bWJlciwgeGM/OiBFeGNoYW5nZSk6IFVuaXRJbmZvIHtcbiAgICBjb25zdCBzdXBwb3J0ZWRBc3NldCA9IHRoaXMuYXNzZXRzW2Fzc2V0SURdXG4gICAgaWYgKHN1cHBvcnRlZEFzc2V0KSByZXR1cm4gc3VwcG9ydGVkQXNzZXQudW5pdEluZm9cbiAgICBpZiAoIXhjIHx8ICF4Yy5hc3NldHMpIHtcbiAgICAgIHRocm93IEVycm9yKGludGwucHJlcChpbnRsLklEX1VOU1VQUE9SVEVEX0FTU0VUX0lORk9fRVJSX01TRywgeyBhc3NldElEOiBgJHthc3NldElEfWAgfSkpXG4gICAgfVxuICAgIHJldHVybiB4Yy5hc3NldHNbYXNzZXRJRF0udW5pdEluZm9cbiAgfVxuXG4gIHBhcmVudEFzc2V0IChhc3NldElEOiBudW1iZXIpIDogU3VwcG9ydGVkQXNzZXQge1xuICAgIGNvbnN0IGFzc2V0ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICBpZiAoIWFzc2V0LnRva2VuKSByZXR1cm4gYXNzZXRcbiAgICByZXR1cm4gdGhpcy5hc3NldHNbYXNzZXQudG9rZW4ucGFyZW50SURdXG4gIH1cblxuICAvKlxuICAqIGJhc2VDaGFpblN5bWJvbCByZXR1cm5zIHRoZSBzeW1ib2wgZm9yIHRoZSBhc3NldCdzIHBhcmVudCBpZiB0aGUgYXNzZXQgaXMgYVxuICAqIHRva2VuLCBvdGhlcndpc2UgdGhlIHN5bWJvbCBmb3IgdGhlIGFzc2V0IGl0c2VsZi5cbiAgKi9cbiAgYmFzZUNoYWluU3ltYm9sIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBhc3NldCA9IHRoaXMudXNlci5hc3NldHNbYXNzZXRJRF1cbiAgICByZXR1cm4gYXNzZXQudG9rZW4gPyB0aGlzLnVzZXIuYXNzZXRzW2Fzc2V0LnRva2VuLnBhcmVudElEXS5zeW1ib2wgOiBhc3NldC5zeW1ib2xcbiAgfVxuXG4gIC8qXG4gICAqIGV4dGVuc2lvbldhbGxldCByZXR1cm5zIHRoZSBFeHRlbnNpb25Db25maWd1cmVkV2FsbGV0IGZvciB0aGUgYXNzZXQsIGlmXG4gICAqIGl0IGV4aXN0cy5cbiAgICovXG4gIGV4dGVuc2lvbldhbGxldCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHRoaXMudXNlci5leHRlbnNpb25Nb2RlQ29uZmlnPy5yZXN0cmljdGVkV2FsbGV0c1t0aGlzLmJhc2VDaGFpblN5bWJvbChhc3NldElEKV1cbiAgfVxuXG4gIC8qIGNvbnZlbnRpb25hbFJhdGUgY29udmVydHMgdGhlIGVuY29kZWQgYXRvbWljIHJhdGUgdG8gYSBjb252ZW50aW9uYWwgcmF0ZSAqL1xuICBjb252ZW50aW9uYWxSYXRlIChiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCBlbmNSYXRlOiBudW1iZXIsIHhjPzogRXhjaGFuZ2UpOiBudW1iZXIge1xuICAgIGNvbnN0IFtiLCBxXSA9IFt0aGlzLnVuaXRJbmZvKGJhc2VJRCwgeGMpLCB0aGlzLnVuaXRJbmZvKHF1b3RlSUQsIHhjKV1cblxuICAgIGNvbnN0IHIgPSBiLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yIC8gcS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIHJldHVybiBlbmNSYXRlICogciAvIFJhdGVFbmNvZGluZ0ZhY3RvclxuICB9XG5cbiAgd2FsbGV0RGVmaW5pdGlvbiAoYXNzZXRJRDogbnVtYmVyLCB3YWxsZXRUeXBlOiBzdHJpbmcpOiBXYWxsZXREZWZpbml0aW9uIHtcbiAgICBjb25zdCBhc3NldCA9IHRoaXMuYXNzZXRzW2Fzc2V0SURdXG4gICAgaWYgKGFzc2V0LnRva2VuKSByZXR1cm4gYXNzZXQudG9rZW4uZGVmaW5pdGlvblxuICAgIGlmICghYXNzZXQuaW5mbykgdGhyb3cgRXJyb3IoJ3doZXJlXFwncyB0aGUgd2FsbGV0IGluZm8/JylcbiAgICBpZiAod2FsbGV0VHlwZSA9PT0gJycpIHJldHVybiBhc3NldC5pbmZvLmF2YWlsYWJsZXdhbGxldHNbYXNzZXQuaW5mby5lbXB0eWlkeF1cbiAgICByZXR1cm4gYXNzZXQuaW5mby5hdmFpbGFibGV3YWxsZXRzLmZpbHRlcihkZWYgPT4gZGVmLnR5cGUgPT09IHdhbGxldFR5cGUpWzBdXG4gIH1cblxuICBjdXJyZW50V2FsbGV0RGVmaW5pdGlvbiAoYXNzZXRJRDogbnVtYmVyKTogV2FsbGV0RGVmaW5pdGlvbiB7XG4gICAgY29uc3QgYXNzZXQgPSB0aGlzLmFzc2V0c1thc3NldElEXVxuICAgIGlmIChhc3NldC50b2tlbikge1xuICAgICAgcmV0dXJuIGFzc2V0LnRva2VuLmRlZmluaXRpb25cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMud2FsbGV0RGVmaW5pdGlvbihhc3NldElELCB0aGlzLmFzc2V0c1thc3NldElEXS53YWxsZXQudHlwZSlcbiAgfVxuXG4gIC8qXG4gICAqIGZldGNoQmFsYW5jZSByZXF1ZXN0cyBhIGJhbGFuY2UgdXBkYXRlIGZyb20gdGhlIEFQSS4gVGhlIEFQSSByZXNwb25zZSBkb2VzXG4gICAqIGluY2x1ZGUgdGhlIGJhbGFuY2UsIGJ1dCB3ZSdyZSBpZ25vcmluZyBpdCwgc2luY2UgYSBiYWxhbmNlIHVwZGF0ZVxuICAgKiBub3RpZmljYXRpb24gaXMgcmVjZWl2ZWQgdmlhIHRoZSBBcHBsaWNhdGlvbiBhbnl3YXlzLlxuICAgKi9cbiAgYXN5bmMgZmV0Y2hCYWxhbmNlIChhc3NldElEOiBudW1iZXIpOiBQcm9taXNlPFdhbGxldEJhbGFuY2U+IHtcbiAgICBjb25zdCByZXM6IEJhbGFuY2VSZXNwb25zZSA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2JhbGFuY2UnLCB7IGFzc2V0SUQ6IGFzc2V0SUQgfSlcbiAgICBpZiAoIXRoaXMuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGZhaWxlZCB0byBmZXRjaCBiYWxhbmNlIGZvciBhc3NldCBJRCAke2Fzc2V0SUR9YClcbiAgICB9XG4gICAgcmV0dXJuIHJlcy5iYWxhbmNlXG4gIH1cblxuICAvKlxuICAgKiBjaGVja1Jlc3BvbnNlIGNoZWNrcyB0aGUgcmVzcG9uc2Ugb2JqZWN0IGFzIHJldHVybmVkIGZyb20gdGhlIGZ1bmN0aW9ucyBpblxuICAgKiB0aGUgaHR0cCBtb2R1bGUuIElmIHRoZSByZXNwb25zZSBpbmRpY2F0ZXMgdGhhdCB0aGUgcmVxdWVzdCBmYWlsZWQsIGl0XG4gICAqIHJldHVybnMgZmFsc2UsIG90aGVyd2lzZSwgdHJ1ZS5cbiAgICovXG4gIGNoZWNrUmVzcG9uc2UgKHJlc3A6IEFQSVJlc3BvbnNlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChyZXNwLnJlcXVlc3RTdWNjZXNzZnVsICYmIHJlc3Aub2spXG4gIH1cblxuICAvKipcbiAgICogc2lnbk91dCBjYWxsIHRvIC9hcGkvbG9nb3V0LCBpZiByZXNwb25zZSB3aXRoIG5vIGVycm9ycyBvY2N1cnJlZCByZW1vdmUgYXV0aFxuICAgKiBhbmQgb3RoZXIgcHJpdmFjeS1jcml0aWNhbCBjb29raWVzL2xvY2FscyBhbmQgcmVsb2FkIHRoZSBwYWdlLCBvdGhlcndpc2VcbiAgICogc2hvdyBhIG5vdGlmaWNhdGlvbi5cbiAgICovXG4gIGFzeW5jIHNpZ25PdXQgKCkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2xvZ291dCcpXG4gICAgaWYgKCF0aGlzLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgaWYgKHJlcy5jb2RlID09PSBFcnJvcnMuYWN0aXZlT3JkZXJzRXJyKSB7XG4gICAgICAgIHRoaXMucGFnZS5sb2dvdXRFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BQ1RJVkVfT1JERVJTX0xPR09VVF9FUlJfTVNHKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wYWdlLmxvZ291dEVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIH1cbiAgICAgIERvYy5zaG93KHRoaXMucGFnZS5sb2dvdXRFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgU3RhdGUucmVtb3ZlQ29va2llKFN0YXRlLmF1dGhDSylcbiAgICBTdGF0ZS5yZW1vdmVDb29raWUoU3RhdGUucHdLZXlDSylcbiAgICBTdGF0ZS5yZW1vdmVMb2NhbChTdGF0ZS5ub3RpZmljYXRpb25zTEspIC8vIE5vdGlmaWNhdGlvbiBzdG9yYWdlIHdhcyBERVBSRUNBVEVEIHByZS12MS5cbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvbG9naW4nXG4gIH1cblxuICAvKlxuICAgKiB0eEhpc3RvcnkgbG9hZHMgdGhlIHR4IGhpc3RvcnkgZm9yIGFuIGFzc2V0LiBJZiB0aGUgcmVzdWx0cyBhcmUgbm90XG4gICAqIGFscmVhZHkgY2FjaGVkLCB0aGV5IGFyZSBjYWNoZWQuIElmIHdlIGhhdmUgcmVhY2hlZCB0aGUgb2xkZXN0IHR4LFxuICAgKiB0aGlzIGZhY3QgaXMgYWxzbyBjYWNoZWQuIElmIHRoZSBleGFjdCBhbW91bnQgb2YgdHJhbnNhY3Rpb25zIGFzIGhhdmUgYmVlblxuICAgKiBtYWRlIGFyZSByZXF1ZXN0ZWQsIHdlIHdpbGwgbm90IGtub3cgaWYgd2UgaGF2ZSByZWFjaGVkIHRoZSBsYXN0IHR4IHVudGlsXG4gICAqIGEgc3Vic2VxdWVudCBjYWxsLlxuICAqL1xuICBhc3luYyB0eEhpc3RvcnkgKGFzc2V0SUQ6IG51bWJlciwgbjogbnVtYmVyLCBhZnRlcj86IHN0cmluZyk6IFByb21pc2U8VHhIaXN0b3J5UmVzdWx0PiB7XG4gICAgY29uc3QgdXJsID0gJy9hcGkvdHhoaXN0b3J5J1xuICAgIGNvbnN0IGNhY2hlZFR4SGlzdG9yeSA9IHRoaXMudHhIaXN0b3J5TWFwW2Fzc2V0SURdXG4gICAgaWYgKCFjYWNoZWRUeEhpc3RvcnkpIHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHVybCwge1xuICAgICAgICBuOiBuLFxuICAgICAgICBhc3NldElEOiBhc3NldElEXG4gICAgICB9KVxuICAgICAgaWYgKCF0aGlzLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzLm1zZylcbiAgICAgIH1cbiAgICAgIGxldCB0eHMgOiBXYWxsZXRUcmFuc2FjdGlvbltdIHwgbnVsbCB8IHVuZGVmaW5lZCA9IHJlcy50eHNcbiAgICAgIGlmICghdHhzKSB7XG4gICAgICAgIHR4cyA9IFtdXG4gICAgICB9XG4gICAgICB0aGlzLnR4SGlzdG9yeU1hcFthc3NldElEXSA9IHtcbiAgICAgICAgdHhzOiB0eHMsXG4gICAgICAgIGxhc3RUeDogdHhzLmxlbmd0aCA8IG5cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnR4SGlzdG9yeU1hcFthc3NldElEXVxuICAgIH1cbiAgICBjb25zdCB0eHMgOiBXYWxsZXRUcmFuc2FjdGlvbltdID0gW11cbiAgICBsZXQgbGFzdFR4ID0gZmFsc2VcbiAgICBjb25zdCBzdGFydEluZGV4ID0gYWZ0ZXIgPyBjYWNoZWRUeEhpc3RvcnkudHhzLmZpbmRJbmRleCh0eCA9PiB0eC5pZCA9PT0gYWZ0ZXIpICsgMSA6IDBcbiAgICBpZiAoYWZ0ZXIgJiYgc3RhcnRJbmRleCA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBhZnRlciB0eCAnICsgYWZ0ZXIpXG4gICAgfVxuICAgIGxldCBsYXN0SW5kZXggPSBzdGFydEluZGV4XG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0SW5kZXg7IGkgPCBjYWNoZWRUeEhpc3RvcnkudHhzLmxlbmd0aCAmJiB0eHMubGVuZ3RoIDwgbjsgaSsrKSB7XG4gICAgICB0eHMucHVzaChjYWNoZWRUeEhpc3RvcnkudHhzW2ldKVxuICAgICAgbGFzdEluZGV4ID0gaVxuICAgICAgYWZ0ZXIgPSBjYWNoZWRUeEhpc3RvcnkudHhzW2ldLmlkXG4gICAgfVxuICAgIGlmIChjYWNoZWRUeEhpc3RvcnkubGFzdFR4ICYmIGxhc3RJbmRleCA9PT0gY2FjaGVkVHhIaXN0b3J5LnR4cy5sZW5ndGggLSAxKSB7XG4gICAgICBsYXN0VHggPSB0cnVlXG4gICAgfVxuICAgIGlmICh0eHMubGVuZ3RoIDwgbiAmJiAhY2FjaGVkVHhIaXN0b3J5Lmxhc3RUeCkge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04odXJsLCB7XG4gICAgICAgIG46IG4gLSB0eHMubGVuZ3RoICsgMSwgLy8gKyAxIGJlY2F1c2UgZmlyc3QgcmVzdWx0IHdpbGwgYmUgcmVmSURcbiAgICAgICAgYXNzZXRJRDogYXNzZXRJRCxcbiAgICAgICAgcmVmSUQ6IGFmdGVyLFxuICAgICAgICBwYXN0OiB0cnVlXG4gICAgICB9KVxuICAgICAgaWYgKCF0aGlzLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzLm1zZylcbiAgICAgIH1cbiAgICAgIGxldCByZXNUeHMgOiBXYWxsZXRUcmFuc2FjdGlvbltdIHwgbnVsbCB8IHVuZGVmaW5lZCA9IHJlcy50eHNcbiAgICAgIGlmICghcmVzVHhzKSB7XG4gICAgICAgIHJlc1R4cyA9IFtdXG4gICAgICB9XG4gICAgICBpZiAocmVzVHhzLmxlbmd0aCA+IDAgJiYgYWZ0ZXIpIHtcbiAgICAgICAgaWYgKHJlc1R4c1swXS5pZCA9PT0gYWZ0ZXIpIHtcbiAgICAgICAgICByZXNUeHMuc2hpZnQoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEltcGxpZXMgYSBidWcgaW4gdGhlIGNsaWVudFxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZpcnN0IHR4IGhpc3RvcnkgZWxlbWVudCAhPSByZWZJRCcpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNhY2hlZFR4SGlzdG9yeS5sYXN0VHggPSByZXNUeHMubGVuZ3RoIDwgbiAtIHR4cy5sZW5ndGhcbiAgICAgIGxhc3RUeCA9IGNhY2hlZFR4SGlzdG9yeS5sYXN0VHhcbiAgICAgIHR4cy5wdXNoKC4uLnJlc1R4cylcbiAgICAgIGNhY2hlZFR4SGlzdG9yeS50eHMucHVzaCguLi5yZXNUeHMpXG4gICAgfVxuICAgIHJldHVybiB7IHR4cywgbGFzdFR4IH1cbiAgfVxuXG4gIGdldFdhbGxldFR4IChhc3NldElEOiBudW1iZXIsIHR4SUQ6IHN0cmluZyk6IFdhbGxldFRyYW5zYWN0aW9uIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBjYWNoZWRUeEhpc3RvcnkgPSB0aGlzLnR4SGlzdG9yeU1hcFthc3NldElEXVxuICAgIGlmICghY2FjaGVkVHhIaXN0b3J5KSByZXR1cm4gdW5kZWZpbmVkXG4gICAgcmV0dXJuIGNhY2hlZFR4SGlzdG9yeS50eHMuZmluZCh0eCA9PiB0eC5pZCA9PT0gdHhJRClcbiAgfVxuXG4gIGNsZWFyVHhIaXN0b3J5IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBkZWxldGUgdGhpcy50eEhpc3RvcnlNYXBbYXNzZXRJRF1cbiAgfVxuXG4gIGFzeW5jIG5lZWRzQ3VzdG9tUHJvdmlkZXIgKGFzc2V0SUQ6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGJhc2VDaGFpbklEID0gdGhpcy5hc3NldHNbYXNzZXRJRF0/LnRva2VuPy5wYXJlbnRJRCA/PyBhc3NldElEXG4gICAgaWYgKCFiYXNlQ2hhaW5JRCkgcmV0dXJuIGZhbHNlXG4gICAgY29uc3QgdyA9IHRoaXMud2FsbGV0TWFwW2Jhc2VDaGFpbklEXVxuICAgIGlmICghdykgcmV0dXJuIGZhbHNlXG4gICAgY29uc3QgdHJhaXRBY2NvdW50TG9ja2VyID0gMSA8PCAxNFxuICAgIGlmICgody50cmFpdHMgJiB0cmFpdEFjY291bnRMb2NrZXIpID09PSAwKSByZXR1cm4gZmFsc2VcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS93YWxsZXRzZXR0aW5ncycsIHsgYXNzZXRJRDogYmFzZUNoYWluSUQgfSlcbiAgICBpZiAoIXRoaXMuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKHJlcy5tc2cpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgY29uc3Qgc2V0dGluZ3MgPSByZXMubWFwIGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgICByZXR1cm4gIXNldHRpbmdzLnByb3ZpZGVyc1xuICB9XG59XG5cbi8qIGdldFNvY2tldFVSSSByZXR1cm5zIHRoZSB3ZWJzb2NrZXQgVVJJIGZvciB0aGUgY2xpZW50LiAqL1xuZnVuY3Rpb24gZ2V0U29ja2V0VVJJICgpOiBzdHJpbmcge1xuICBjb25zdCBwcm90b2NvbCA9ICh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonKSA/ICd3c3MnIDogJ3dzJ1xuICByZXR1cm4gYCR7cHJvdG9jb2x9Oi8vJHt3aW5kb3cubG9jYXRpb24uaG9zdH0vd3NgXG59XG5cbi8qXG4gKiBzZXZlcml0eUNsYXNzTWFwIG1hcHMgYSBub3RpZmljYXRpb24gc2V2ZXJpdHkgbGV2ZWwgdG8gYSBDU1MgY2xhc3MgdGhhdFxuICogYXNzaWducyBhIGJhY2tncm91bmQgY29sb3IuXG4gKi9cbmNvbnN0IHNldmVyaXR5Q2xhc3NNYXA6IFJlY29yZDxudW1iZXIsIHN0cmluZz4gPSB7XG4gIFtudGZuLlNVQ0NFU1NdOiAnZ29vZCcsXG4gIFtudGZuLkVSUk9SXTogJ2JhZCcsXG4gIFtudGZuLldBUk5JTkddOiAnd2Fybidcbn1cblxuLyogaGFuZGxlckZyb21QYXRoIHBhcnNlcyB0aGUgaGFuZGxlciBuYW1lIGZyb20gdGhlIHBhdGguICovXG5mdW5jdGlvbiBoYW5kbGVyRnJvbVBhdGggKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBwYXRoLnJlcGxhY2UoL15cXC8vLCAnJykuc3BsaXQoJy8nKVswXS5zcGxpdCgnPycpWzBdLnNwbGl0KCcjJylbMF1cbn1cblxuLyogbm93U3RyaW5nIGNyZWF0ZXMgYSBzdHJpbmcgZm9ybWF0dGVkIGxpa2UgSEg6TU06U1MueHh4ICovXG5mdW5jdGlvbiBub3dTdHJpbmcgKCk6IHN0cmluZyB7XG4gIGNvbnN0IHN0YW1wID0gbmV3IERhdGUoKVxuICBjb25zdCBoID0gc3RhbXAuZ2V0SG91cnMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJylcbiAgY29uc3QgbSA9IHN0YW1wLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJylcbiAgY29uc3QgcyA9IHN0YW1wLmdldFNlY29uZHMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJylcbiAgY29uc3QgbXMgPSBzdGFtcC5nZXRNaWxsaXNlY29uZHMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDMsICcwJylcbiAgcmV0dXJuIGAke2h9OiR7bX06JHtzfS4ke21zfWBcbn1cblxuZnVuY3Rpb24gc2V0U2V2ZXJpdHlDbGFzcyAoZWw6IEhUTUxFbGVtZW50LCBzZXZlcml0eTogbnVtYmVyKSB7XG4gIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2JhZCcsICd3YXJuJywgJ2dvb2QnKVxuICBlbC5jbGFzc0xpc3QuYWRkKHNldmVyaXR5Q2xhc3NNYXBbc2V2ZXJpdHldKVxufVxuXG4vKiB1cGRhdGVNYXRjaCB1cGRhdGVzIHRoZSBtYXRjaCBpbiBvciBhZGRzIHRoZSBtYXRjaCB0byB0aGUgb3JkZXIuICovXG5mdW5jdGlvbiB1cGRhdGVNYXRjaCAob3JkZXI6IE9yZGVyLCBtYXRjaDogTWF0Y2gpIHtcbiAgZm9yIChjb25zdCBpIGluIG9yZGVyLm1hdGNoZXMpIHtcbiAgICBjb25zdCBtID0gb3JkZXIubWF0Y2hlc1tpXVxuICAgIGlmIChtLm1hdGNoSUQgPT09IG1hdGNoLm1hdGNoSUQpIHtcbiAgICAgIG9yZGVyLm1hdGNoZXNbaV0gPSBtYXRjaFxuICAgICAgcmV0dXJuXG4gICAgfVxuICB9XG4gIG9yZGVyLm1hdGNoZXMgPSBvcmRlci5tYXRjaGVzIHx8IFtdXG4gIG9yZGVyLm1hdGNoZXMucHVzaChtYXRjaClcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhc2VQYWdlIHtcbiAgLyogdW5sb2FkIGlzIGNhbGxlZCB3aGVuIHRoZSB1c2VyIG5hdmlnYXRlcyBhd2F5IGZyb20gdGhlIHBhZ2UuICovXG4gIHVubG9hZCAoKSB7XG4gICAgLy8gc2hvdWxkIGJlIGltcGxlbWVudGVkIGJ5IGluaGVyaXRpbmcgY2xhc3MuXG4gIH1cbn1cbiIsImltcG9ydCBEb2MsIHsgQW5pbWF0aW9uLCBjbGFtcCB9IGZyb20gJy4vZG9jJ1xuaW1wb3J0IHsgUmF0ZUVuY29kaW5nRmFjdG9yIH0gZnJvbSAnLi9vcmRlcnV0aWwnXG5pbXBvcnQgT3JkZXJCb29rIGZyb20gJy4vb3JkZXJib29rJ1xuaW1wb3J0IFN0YXRlIGZyb20gJy4vc3RhdGUnXG5pbXBvcnQgeyBVbml0SW5mbywgTWFya2V0LCBDYW5kbGUsIENhbmRsZXNQYXlsb2FkLCBhcHAgfSBmcm9tICcuL3JlZ2lzdHJ5J1xuXG5jb25zdCBiaW5kID0gRG9jLmJpbmRcbmNvbnN0IFBJUEkgPSAyICogTWF0aC5QSVxuY29uc3QgcGx1c0NoYXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDU5OTE0KVxuY29uc3QgbWludXNDaGFyID0gU3RyaW5nLmZyb21DaGFyQ29kZSg1OTkxNSlcblxuaW50ZXJmYWNlIFBvaW50IHtcbiAgeDogbnVtYmVyXG4gIHk6IG51bWJlclxufVxuXG5pbnRlcmZhY2UgTWluTWF4IHtcbiAgbWluOiBudW1iZXJcbiAgbWF4OiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIExhYmVsIHtcbiAgdmFsOiBudW1iZXJcbiAgdHh0OiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIExhYmVsU2V0IHtcbiAgd2lkZXN0PzogbnVtYmVyXG4gIGxibHM6IExhYmVsW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2xhdG9yIHtcbiAgICB4OiAoeDogbnVtYmVyKSA9PiBudW1iZXJcbiAgICB5OiAoeTogbnVtYmVyKSA9PiBudW1iZXJcbiAgICB1bng6ICh4OiBudW1iZXIpID0+IG51bWJlclxuICAgIHVueTogKHk6IG51bWJlcikgPT4gbnVtYmVyXG4gICAgdzogKHc6IG51bWJlcikgPT4gbnVtYmVyXG4gICAgaDogKGg6IG51bWJlcikgPT4gbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTW91c2VSZXBvcnQge1xuICByYXRlOiBudW1iZXJcbiAgZGVwdGg6IG51bWJlclxuICBkb3RDb2xvcjogc3RyaW5nXG4gIGhvdmVyTWFya2VyczogbnVtYmVyW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBWb2x1bWVSZXBvcnQge1xuICBidXlCYXNlOiBudW1iZXJcbiAgYnV5UXVvdGU6IG51bWJlclxuICBzZWxsQmFzZTogbnVtYmVyXG4gIHNlbGxRdW90ZTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVwdGhSZXBvcnRlcnMge1xuICBtb3VzZTogKHI6IE1vdXNlUmVwb3J0IHwgbnVsbCkgPT4gdm9pZFxuICBjbGljazogKHg6IG51bWJlcikgPT4gdm9pZFxuICB2b2x1bWU6IChyOiBWb2x1bWVSZXBvcnQpID0+IHZvaWRcbiAgem9vbTogKHo6IG51bWJlcikgPT4gdm9pZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhbmRsZVJlcG9ydGVycyB7XG4gIG1vdXNlOiAocjogQ2FuZGxlIHwgbnVsbCkgPT4gdm9pZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENoYXJ0UmVwb3J0ZXJzIHtcbiAgcmVzaXplOiAoKSA9PiB2b2lkLFxuICBjbGljazogKGU6IE1vdXNlRXZlbnQpID0+IHZvaWQsXG4gIHpvb206IChiaWdnZXI6IGJvb2xlYW4pID0+IHZvaWRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXB0aExpbmUge1xuICByYXRlOiBudW1iZXJcbiAgY29sb3I6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERlcHRoTWFya2VyIHtcbiAgcmF0ZTogbnVtYmVyXG4gIGFjdGl2ZTogYm9vbGVhblxufVxuXG5pbnRlcmZhY2UgRGVwdGhNYXJrIGV4dGVuZHMgRGVwdGhNYXJrZXIge1xuICBxdHk6IG51bWJlclxuICBzZWxsOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBUaGVtZSB7XG4gIGJvZHk6IHN0cmluZ1xuICBheGlzTGFiZWw6IHN0cmluZ1xuICBncmlkQm9yZGVyOiBzdHJpbmdcbiAgZ3JpZExpbmVzOiBzdHJpbmdcbiAgZ2FwTGluZTogc3RyaW5nXG4gIHZhbHVlOiBzdHJpbmdcbiAgem9vbTogc3RyaW5nXG4gIHpvb21Ib3Zlcjogc3RyaW5nXG4gIHNlbGxMaW5lOiBzdHJpbmdcbiAgYnV5TGluZTogc3RyaW5nXG4gIHNlbGxGaWxsOiBzdHJpbmdcbiAgYnV5RmlsbDogc3RyaW5nXG4gIGNyb3NzaGFpcnM6IHN0cmluZ1xuICBsZWdlbmRGaWxsOiBzdHJpbmdcbiAgbGVnZW5kVGV4dDogc3RyaW5nXG59XG5cbmNvbnN0IGRhcmtUaGVtZTogVGhlbWUgPSB7XG4gIGJvZHk6ICcjMGIyMDMxJyxcbiAgYXhpc0xhYmVsOiAnI2IxYjFiMScsXG4gIGdyaWRCb3JkZXI6ICcjMzgzZjRiJyxcbiAgZ3JpZExpbmVzOiAnIzM4M2Y0YicsXG4gIGdhcExpbmU6ICcjNmI2YjZiJyxcbiAgdmFsdWU6ICcjOWE5YTlhJyxcbiAgem9vbTogJyM1YjViNWInLFxuICB6b29tSG92ZXI6ICcjYWFhJyxcbiAgc2VsbExpbmU6ICcjYWUzMzMzJyxcbiAgYnV5TGluZTogJyMwNWEzNWEnLFxuICBzZWxsRmlsbDogJyM1OTFhMWEnLFxuICBidXlGaWxsOiAnIzAyNTcyZicsXG4gIGNyb3NzaGFpcnM6ICcjODg4JyxcbiAgbGVnZW5kRmlsbDogJ2JsYWNrJyxcbiAgbGVnZW5kVGV4dDogJyNkNWQ1ZDUnXG59XG5cbmNvbnN0IGxpZ2h0VGhlbWU6IFRoZW1lID0ge1xuICBib2R5OiAnI2Y0ZjRmNCcsXG4gIGF4aXNMYWJlbDogJyMxYjFiMWInLFxuICBncmlkQm9yZGVyOiAnI2RkZCcsXG4gIGdyaWRMaW5lczogJyNkZGQnLFxuICBnYXBMaW5lOiAnIzU5NTk1OScsXG4gIHZhbHVlOiAnIzRkNGQ0ZCcsXG4gIHpvb206ICcjNzc3JyxcbiAgem9vbUhvdmVyOiAnIzMzMycsXG4gIHNlbGxMaW5lOiAnIzk5MzAyYicsXG4gIGJ1eUxpbmU6ICcjMjA3YTQ2JyxcbiAgc2VsbEZpbGw6ICcjYmQ1OTU5JyxcbiAgYnV5RmlsbDogJyM0Y2FkNzUnLFxuICBjcm9zc2hhaXJzOiAnIzU5NTk1OScsXG4gIGxlZ2VuZEZpbGw6ICcjZTZlNmU2JyxcbiAgbGVnZW5kVGV4dDogJyMxYjFiMWInXG59XG5cbi8vIENoYXJ0IGlzIHRoZSBiYXNlIGNsYXNzIGZvciBjaGFydHMuXG5leHBvcnQgY2xhc3MgQ2hhcnQge1xuICBwYXJlbnQ6IEhUTUxFbGVtZW50XG4gIHJlcG9ydDogQ2hhcnRSZXBvcnRlcnNcbiAgdGhlbWU6IFRoZW1lXG4gIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnRcbiAgdmlzaWJsZTogYm9vbGVhblxuICByZW5kZXJTY2hlZHVsZWQ6IGJvb2xlYW5cbiAgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRcbiAgbW91c2VQb3M6IFBvaW50IHwgbnVsbFxuICByZWN0OiBET01SZWN0XG4gIHdoZWVsTGltaXRlcjogbnVtYmVyIHwgbnVsbFxuICBib3VuZFJlc2l6ZXI6ICgpID0+IHZvaWRcbiAgcGxvdFJlZ2lvbjogUmVnaW9uXG4gIHhSZWdpb246IFJlZ2lvblxuICB5UmVnaW9uOiBSZWdpb25cbiAgZGF0YUV4dGVudHM6IEV4dGVudHNcbiAgdW5hdHRhY2hlcnM6ICgoKSA9PiB2b2lkKVtdXG5cbiAgY29uc3RydWN0b3IgKHBhcmVudDogSFRNTEVsZW1lbnQsIHJlcG9ydGVyczogQ2hhcnRSZXBvcnRlcnMpIHtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudFxuICAgIHRoaXMucmVwb3J0ID0gcmVwb3J0ZXJzXG4gICAgdGhpcy50aGVtZSA9IFN0YXRlLmlzRGFyaygpID8gZGFya1RoZW1lIDogbGlnaHRUaGVtZVxuICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJylcbiAgICB0aGlzLnZpc2libGUgPSB0cnVlXG4gICAgcGFyZW50LmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKVxuICAgIGNvbnN0IGN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJylcbiAgICBpZiAoIWN0eCkge1xuICAgICAgY29uc29sZS5lcnJvcignZXJyb3IgZ2V0dGluZyBjYW52YXMgY29udGV4dCcpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5jdHggPSBjdHhcbiAgICB0aGlzLmN0eC50ZXh0QWxpZ24gPSAnY2VudGVyJ1xuICAgIHRoaXMuY3R4LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnXG4gICAgLy8gTW91c2UgaGFuZGxpbmdcbiAgICB0aGlzLm1vdXNlUG9zID0gbnVsbFxuICAgIGJpbmQodGhpcy5jYW52YXMsICdtb3VzZW1vdmUnLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgLy8gdGhpcy5yZWN0IHdpbGwgYmUgc2V0IGluIHJlc2l6ZSgpLlxuICAgICAgaWYgKCF0aGlzLnJlY3QpIHJldHVyblxuICAgICAgdGhpcy5tb3VzZVBvcyA9IHtcbiAgICAgICAgeDogZS5jbGllbnRYIC0gdGhpcy5yZWN0LmxlZnQsXG4gICAgICAgIHk6IGUuY2xpZW50WSAtIHRoaXMucmVjdC55XG4gICAgICB9XG4gICAgICB0aGlzLmRyYXcoKVxuICAgIH0pXG4gICAgYmluZCh0aGlzLmNhbnZhcywgJ21vdXNlbGVhdmUnLCAoKSA9PiB7XG4gICAgICB0aGlzLm1vdXNlUG9zID0gbnVsbFxuICAgICAgdGhpcy5kcmF3KClcbiAgICB9KVxuXG4gICAgLy8gQmluZCByZXNpemUuXG4gICAgY29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKCkgPT4gdGhpcy5yZXNpemUoKSlcbiAgICByZXNpemVPYnNlcnZlci5vYnNlcnZlKHRoaXMucGFyZW50KVxuXG4gICAgLy8gU2Nyb2xsaW5nIGJ5IHdoZWVsIGlzIHNtb290aGVyIHdoZW4gdGhlIHJhdGUgaXMgc2xpZ2h0bHkgbGltaXRlZC5cbiAgICB0aGlzLndoZWVsTGltaXRlciA9IG51bGxcbiAgICBiaW5kKHRoaXMuY2FudmFzLCAnd2hlZWwnLCAoZTogV2hlZWxFdmVudCkgPT4geyB0aGlzLndoZWVsKGUpIH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KVxuICAgIGJpbmQodGhpcy5jYW52YXMsICdjbGljaycsIChlOiBNb3VzZUV2ZW50KSA9PiB7IHRoaXMuY2xpY2soZSkgfSlcbiAgICBjb25zdCBzZXRWaXMgPSAoKSA9PiB7XG4gICAgICB0aGlzLnZpc2libGUgPSBkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgIT09ICdoaWRkZW4nXG4gICAgICBpZiAodGhpcy52aXNpYmxlICYmIHRoaXMucmVuZGVyU2NoZWR1bGVkKSB7XG4gICAgICAgIHRoaXMucmVuZGVyU2NoZWR1bGVkID0gZmFsc2VcbiAgICAgICAgdGhpcy5kcmF3KClcbiAgICAgIH1cbiAgICB9XG4gICAgYmluZChkb2N1bWVudCwgJ3Zpc2liaWxpdHljaGFuZ2UnLCBzZXRWaXMpXG4gICAgdGhpcy51bmF0dGFjaGVycyA9IFsoKSA9PiB7IERvYy51bmJpbmQoZG9jdW1lbnQsICd2aXNpYmlsaXR5Y2hhbmdlJywgc2V0VmlzKSB9XVxuICB9XG5cbiAgd2hlZWxlZCAoKSB7XG4gICAgdGhpcy53aGVlbExpbWl0ZXIgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7IHRoaXMud2hlZWxMaW1pdGVyID0gbnVsbCB9LCAxMDApXG4gIH1cblxuICAvKiBjbGVhciB0aGUgY2FudmFzLiAqL1xuICBjbGVhciAoKSB7XG4gICAgdGhpcy5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpXG4gIH1cblxuICAvKiBkcmF3IGNhbGxzIHRoZSBjaGlsZCBjbGFzcydzIHJlbmRlciBtZXRob2QuICovXG4gIGRyYXcgKCkge1xuICAgIHRoaXMucmVuZGVyKClcbiAgfVxuXG4gIC8qIGNsaWNrIGlzIHRoZSBoYW5kbGVyIGZvciBhIGNsaWNrIGV2ZW50IG9uIHRoZSBjYW52YXMuICovXG4gIGNsaWNrIChlOiBNb3VzZUV2ZW50KSB7XG4gICAgdGhpcy5yZXBvcnQuY2xpY2soZSlcbiAgfVxuXG4gIC8qIHdoZWVsIGlzIGEgbW91c2V3aGVlbCBldmVudCBoYW5kbGVyLiAqL1xuICB3aGVlbCAoZTogV2hlZWxFdmVudCkge1xuICAgIHRoaXMuem9vbShlLmRlbHRhWSA8IDApXG4gIH1cblxuICAvKlxuICAgKiByZXNpemUgdXBkYXRlcyB0aGUgY2hhcnQgc2l6ZS4gVGhlIHBhcmVudEhlaWdodCBpcyBhbiBhcmd1bWVudCB0byBzdXBwb3J0XG4gICAqIHVwZGF0aW5nIHRoZSBoZWlnaHQgcHJvZ3JhbW1hdGljYWxseSBhZnRlciB0aGUgY2FsbGVyIHNldHMgYSBzdHlsZS5oZWlnaHRcbiAgICogYnV0IGJlZm9yZSB0aGUgY2xpZW50SGVpZ2h0IGhhcyBiZWVuIHVwZGF0ZWQuXG4gICAqL1xuICByZXNpemUgKCkge1xuICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy5wYXJlbnQuY2xpZW50V2lkdGhcbiAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLnBhcmVudC5jbGllbnRIZWlnaHRcbiAgICBjb25zdCB4TGJsSGVpZ2h0ID0gMzBcbiAgICBjb25zdCB5R3Vlc3MgPSA0MCAvLyB5IGxhYmVsIHdpZHRoIGd1ZXNzLiBXaWxsIGJlIGFkanVzdGVkIHdoZW4gZHJhd24uXG4gICAgY29uc3QgcGxvdEV4dGVudHMgPSBuZXcgRXh0ZW50cygwLCB0aGlzLmNhbnZhcy53aWR0aCwgMCwgdGhpcy5jYW52YXMuaGVpZ2h0IC0geExibEhlaWdodClcbiAgICBjb25zdCB4TGJsRXh0ZW50cyA9IG5ldyBFeHRlbnRzKDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQgLSB4TGJsSGVpZ2h0LCB0aGlzLmNhbnZhcy5oZWlnaHQpXG4gICAgY29uc3QgeUxibEV4dGVudHMgPSBuZXcgRXh0ZW50cygwLCB5R3Vlc3MsIDAsIHRoaXMuY2FudmFzLmhlaWdodCAtIHhMYmxIZWlnaHQpXG4gICAgdGhpcy5wbG90UmVnaW9uID0gbmV3IFJlZ2lvbih0aGlzLmN0eCwgcGxvdEV4dGVudHMpXG4gICAgdGhpcy54UmVnaW9uID0gbmV3IFJlZ2lvbih0aGlzLmN0eCwgeExibEV4dGVudHMpXG4gICAgdGhpcy55UmVnaW9uID0gbmV3IFJlZ2lvbih0aGlzLmN0eCwgeUxibEV4dGVudHMpXG4gICAgLy8gQWZ0ZXIgY2hhbmdpbmcgdGhlIHZpc2liaWxpdHksIHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCB3aWxsXG4gICAgLy8gcmV0dXJuIG5vbnNlbnNlIHVudGlsIGEgcmVuZGVyLlxuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgdGhpcy5yZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIHRoaXMucmVwb3J0LnJlc2l6ZSgpXG4gICAgfSlcbiAgfVxuXG4gIC8qIHpvb20gaXMgY2FsbGVkIHdoZW4gdGhlIHVzZXIgc2Nyb2xscyB0aGUgbW91c2Ugd2hlZWwgb24gdGhlIGNhbnZhcy4gKi9cbiAgem9vbSAoYmlnZ2VyOiBib29sZWFuKSB7XG4gICAgaWYgKHRoaXMud2hlZWxMaW1pdGVyKSByZXR1cm5cbiAgICB0aGlzLnJlcG9ydC56b29tKGJpZ2dlcilcbiAgfVxuXG4gIC8qIFRoZSBtYXJrZXQgaGFuZGxlciB3aWxsIGNhbGwgdW5hdHRhY2ggd2hlbiB0aGUgbWFya2V0cyBwYWdlIGlzIHVubG9hZGVkLiAqL1xuICB1bmF0dGFjaCAoKSB7XG4gICAgZm9yIChjb25zdCB1IG9mIHRoaXMudW5hdHRhY2hlcnMpIHUoKVxuICAgIHRoaXMudW5hdHRhY2hlcnMgPSBbXVxuICB9XG5cbiAgLyogcmVuZGVyIG11c3QgYmUgaW1wbGVtZW50ZWQgYnkgdGhlIGNoaWxkIGNsYXNzLiAqL1xuICByZW5kZXIgKCkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ2NoaWxkIGNsYXNzIG11c3Qgb3ZlcnJpZGUgcmVuZGVyIG1ldGhvZCcpXG4gIH1cblxuICAvKiBhcHBseUxhYmVsU3R5bGUgYXBwbGllcyB0aGUgc3R5bGUgdXNlZCBmb3IgYXhpcyB0aWNrIGxhYmVscy4gKi9cbiAgYXBwbHlMYWJlbFN0eWxlIChmb250U2l6ZT86IG51bWJlcikge1xuICAgIHRoaXMuY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInXG4gICAgdGhpcy5jdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSdcbiAgICB0aGlzLmN0eC5mb250ID0gYCR7Zm9udFNpemUgPz8gJzE0J31weCAnc2FucycsIHNhbnMtc2VyaWZgXG4gICAgdGhpcy5jdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZS5heGlzTGFiZWxcbiAgfVxuXG4gIC8qIHBsb3RYTGFiZWxzIGFwcGxpZXMgdGhlIHByb3ZpZGVkIGxhYmVscyB0byB0aGUgeCBheGlzIGFuZCBkcmF3cyB0aGUgZ3JpZC4gKi9cbiAgcGxvdFhMYWJlbHMgKGxhYmVsczogTGFiZWxTZXQsIG1pblg6IG51bWJlciwgbWF4WDogbnVtYmVyLCB1bml0TGluZXM6IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgZXh0ZW50cyA9IG5ldyBFeHRlbnRzKG1pblgsIG1heFgsIDAsIDEpXG4gICAgdGhpcy54UmVnaW9uLnBsb3QoZXh0ZW50cywgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0b29sczogVHJhbnNsYXRvcikgPT4ge1xuICAgICAgdGhpcy5hcHBseUxhYmVsU3R5bGUoKVxuICAgICAgY29uc3QgY2VudGVyWCA9IChtYXhYICsgbWluWCkgLyAyXG4gICAgICBsZXQgbGFzdFggPSBtaW5YXG4gICAgICBsZXQgdW5pdENlbnRlciA9IGNlbnRlclhcbiAgICAgIGNvbnN0IFtsZWZ0RWRnZSwgcmlnaHRFZGdlXSA9IFt0b29scy54KG1pblgpLCB0b29scy54KG1heFgpXVxuICAgICAgY29uc3QgY2VudGVyWSA9IHRvb2xzLnkoMC41KVxuICAgICAgbGFiZWxzLmxibHMuZm9yRWFjaChsYmwgPT4ge1xuICAgICAgICBjb25zdCBtID0gY3R4Lm1lYXN1cmVUZXh0KGxibC50eHQpXG4gICAgICAgIGNvbnN0IHggPSB0b29scy54KGxibC52YWwpXG4gICAgICAgIGlmICh4IC0gbS53aWR0aCAvIDIgPCBsZWZ0RWRnZSB8fCB4ICsgbS53aWR0aCAvIDIgPiByaWdodEVkZ2UpIHJldHVyblxuICAgICAgICBjdHguZmlsbFRleHQobGJsLnR4dCwgeCwgY2VudGVyWSlcbiAgICAgICAgaWYgKGNlbnRlclggPj0gbGFzdFggJiYgY2VudGVyWCA8IGxibC52YWwpIHtcbiAgICAgICAgICB1bml0Q2VudGVyID0gKGxhc3RYICsgbGJsLnZhbCkgLyAyXG4gICAgICAgIH1cbiAgICAgICAgbGFzdFggPSBsYmwudmFsXG4gICAgICB9KVxuICAgICAgY3R4LmZvbnQgPSAnMTFweCBcXCdzYW5zXFwnLCBzYW5zLXNlcmlmJ1xuICAgICAgaWYgKHVuaXRMaW5lcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgY3R4LmZpbGxUZXh0KHVuaXRMaW5lc1swXSwgdG9vbHMueCh1bml0Q2VudGVyKSwgdG9vbHMueSgwLjYzKSlcbiAgICAgICAgY3R4LmZpbGxUZXh0KHVuaXRMaW5lc1sxXSwgdG9vbHMueCh1bml0Q2VudGVyKSwgdG9vbHMueSgwLjIzKSlcbiAgICAgIH0gZWxzZSBpZiAodW5pdExpbmVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBjdHguZmlsbFRleHQodW5pdExpbmVzWzBdLCB0b29scy54KHVuaXRDZW50ZXIpLCBjZW50ZXJZKVxuICAgICAgfVxuICAgIH0sIHRydWUpXG4gIH1cblxuICBwbG90WEdyaWQgKGxhYmVsczogTGFiZWxTZXQsIG1pblg6IG51bWJlciwgbWF4WDogbnVtYmVyKSB7XG4gICAgY29uc3QgZXh0ZW50cyA9IG5ldyBFeHRlbnRzKG1pblgsIG1heFgsIDAsIDEpXG4gICAgdGhpcy5wbG90UmVnaW9uLnBsb3QoZXh0ZW50cywgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0b29sczogVHJhbnNsYXRvcikgPT4ge1xuICAgICAgY3R4LmxpbmVXaWR0aCA9IDFcbiAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMudGhlbWUuZ3JpZExpbmVzXG4gICAgICBsYWJlbHMubGJscy5mb3JFYWNoKGxibCA9PiB7XG4gICAgICAgIGxpbmUoY3R4LCB0b29scy54KGxibC52YWwpLCB0b29scy55KDApLCB0b29scy54KGxibC52YWwpLCB0b29scy55KDEpKVxuICAgICAgfSlcbiAgICB9LCB0cnVlKVxuICB9XG5cbiAgLypcbiAgICogcGxvdFlMYWJlbHMgYXBwbGllcyB0aGUgeSBsYWJlbHMgYmFzZWQgb24gdGhlIHByb3ZpZGVkIHBsb3QgcmVnaW9uLCBhbmRcbiAgICogZHJhd3MgdGhlIGdyaWQuXG4gICAqL1xuICBwbG90WUxhYmVscyAobGFiZWxzOiBMYWJlbFNldCwgbWluWTogbnVtYmVyLCBtYXhZOiBudW1iZXIsIHVuaXQ6IHN0cmluZykge1xuICAgIGNvbnN0IGV4dGVudHMgPSBuZXcgRXh0ZW50cygwLCAxLCBtaW5ZLCBtYXhZKVxuXG4gICAgY29uc3QgZmlsbFJlY3QgPSAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHg6IG51bWJlciwgeTogbnVtYmVyLCB3OiBudW1iZXIsIGg6IG51bWJlciwgcjogbnVtYmVyKSA9PiB7XG4gICAgICBjdHguc2F2ZSgpXG4gICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZS5ib2R5XG4gICAgICBjdHguYmVnaW5QYXRoKClcbiAgICAgIGlmIChjdHgucm91bmRSZWN0KSBjdHgucm91bmRSZWN0KHgsIHksIHcsIGgsIHIpIC8vIFNhZmFyaSA8IDE2IGRvZXNuJ3Qgc3VwcG9ydFxuICAgICAgZWxzZSBjdHgucmVjdCh4LCB5LCB3LCBoKVxuICAgICAgY3R4LmZpbGwoKVxuICAgICAgY3R4LnJlc3RvcmUoKVxuICAgIH1cblxuICAgIHRoaXMueVJlZ2lvbi5wbG90KGV4dGVudHMsIChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgdG9vbHM6IFRyYW5zbGF0b3IpID0+IHtcbiAgICAgIHRoaXMuYXBwbHlMYWJlbFN0eWxlKClcbiAgICAgIHRoaXMuY3R4LnRleHRBbGlnbiA9ICdsZWZ0J1xuICAgICAgY29uc3QgY2VudGVyWSA9IG1heFkgLyAyXG4gICAgICBsZXQgbGFzdFkgPSAwXG4gICAgICBsZXQgdW5pdENlbnRlciA9IGNlbnRlcllcbiAgICAgIGNvbnN0IHggPSB0b29scy54KDApXG4gICAgICBjb25zdCBbeFBhZCwgeVBhZF0gPSBbMywgM11cbiAgICAgIGxhYmVscy5sYmxzLmZvckVhY2gobGJsID0+IHtcbiAgICAgICAgY29uc3QgeSA9IHRvb2xzLnkobGJsLnZhbClcbiAgICAgICAgaWYgKHkgPCB0b29scy55KG1heFkpICsgeVBhZCArIDcgfHwgeSA+IHRvb2xzLnkobWluWSkgLSB5UGFkIC0gNykgcmV0dXJuXG4gICAgICAgIGNvbnN0IG0gPSBjdHgubWVhc3VyZVRleHQobGJsLnR4dClcbiAgICAgICAgZmlsbFJlY3QoY3R4LCB4LCB5IC0gNyAtIHlQYWQsIG0ud2lkdGggKyB4UGFkICogMiwgMTQgKyB5UGFkICogMywgMylcbiAgICAgICAgY3R4LmZpbGxUZXh0KGxibC50eHQsIHggKyB4UGFkLCB5ICsgMilcbiAgICAgICAgaWYgKGNlbnRlclkgPj0gbGFzdFkgJiYgY2VudGVyWSA8IGxibC52YWwpIHtcbiAgICAgICAgICB1bml0Q2VudGVyID0gKGxhc3RZICsgbGJsLnZhbCkgLyAyXG4gICAgICAgIH1cbiAgICAgICAgbGFzdFkgPSBsYmwudmFsXG4gICAgICB9KVxuICAgICAgY29uc3QgbSA9IGN0eC5tZWFzdXJlVGV4dCh1bml0KVxuICAgICAgY29uc3QgeSA9IHRvb2xzLnkodW5pdENlbnRlcilcbiAgICAgIGZpbGxSZWN0KGN0eCwgeCwgeSAtIHlQYWQgLSA3LCBtLndpZHRoICsgeFBhZCAqIDIsIDE0ICsgeVBhZCAqIDIsIDMpXG4gICAgICBjdHguZmlsbFRleHQodW5pdCwgeCArIHhQYWQsIHRvb2xzLnkodW5pdENlbnRlcikpXG4gICAgfSwgdHJ1ZSlcbiAgfVxuXG4gIHBsb3RZR3JpZCAocmVnaW9uOiBSZWdpb24sIGxhYmVsczogTGFiZWxTZXQsIG1pblk6IG51bWJlciwgbWF4WTogbnVtYmVyKSB7XG4gICAgY29uc3QgZXh0ZW50cyA9IG5ldyBFeHRlbnRzKDAsIDEsIG1pblksIG1heFkpXG4gICAgcmVnaW9uLnBsb3QoZXh0ZW50cywgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0b29sczogVHJhbnNsYXRvcikgPT4ge1xuICAgICAgY3R4LmxpbmVXaWR0aCA9IDFcbiAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMudGhlbWUuZ3JpZExpbmVzXG4gICAgICBsYWJlbHMubGJscy5mb3JFYWNoKGxibCA9PiB7XG4gICAgICAgIGxpbmUoY3R4LCB0b29scy54KDApLCB0b29scy55KGxibC52YWwpLCB0b29scy54KDEpLCB0b29scy55KGxibC52YWwpKVxuICAgICAgfSlcbiAgICB9LCB0cnVlKVxuICB9XG5cbiAgLypcbiAgICogZG9ZTGFiZWxzIGdlbmVyYXRlcyBhbmQgYXBwbGllcyB0aGUgeS1heGlzIGxhYmVscywgYmFzZWQgdXBvbiB0aGVcbiAgICogcHJvdmlkZWQgcGxvdCByZWdpb24uXG4gICAqL1xuICBtYWtlWUxhYmVscyAocmVnaW9uOiBSZWdpb24sIHN0ZXA6IG51bWJlciwgdW5pdDogc3RyaW5nLCB2YWxGbXQ/OiAodjogbnVtYmVyKSA9PiBzdHJpbmcpOiBMYWJlbFNldCB7XG4gICAgdGhpcy5hcHBseUxhYmVsU3R5bGUoKVxuICAgIGNvbnN0IHlMYWJlbHMgPSBtYWtlTGFiZWxzKHRoaXMuY3R4LCByZWdpb24uaGVpZ2h0KCksIHRoaXMuZGF0YUV4dGVudHMueS5taW4sXG4gICAgICB0aGlzLmRhdGFFeHRlbnRzLnkubWF4LCA1MCwgc3RlcCwgdW5pdCwgdmFsRm10KVxuXG4gICAgLy8gUmVhc3NpZ24gdGhlIHdpZHRoIG9mIHRoZSB5LWxhYmVsIGNvbHVtbiB0byBhY2NvbW1vZGF0ZSB0aGUgd2lkZXN0IHRleHQuXG4gICAgY29uc3QgeUF4aXNXaWR0aCA9ICh5TGFiZWxzLndpZGVzdCB8fCAwKSArIDIwIC8qIHggcGFkZGluZyAqL1xuICAgIHRoaXMueVJlZ2lvbi5leHRlbnRzLngubWF4ID0geUF4aXNXaWR0aFxuICAgIHRoaXMueVJlZ2lvbi5leHRlbnRzLnkubWF4ID0gcmVnaW9uLmV4dGVudHMueS5tYXhcblxuICAgIHJldHVybiB5TGFiZWxzXG4gIH1cblxuICBsaW5lICh4MDogbnVtYmVyLCB5MDogbnVtYmVyLCB4MTogbnVtYmVyLCB5MTogbnVtYmVyLCBza2lwU3Ryb2tlPzogYm9vbGVhbikge1xuICAgIGxpbmUodGhpcy5jdHgsIHgwLCB5MCwgeDEsIHkxLCBza2lwU3Ryb2tlKVxuICB9XG5cbiAgLyogZG90IGRyYXdzIGEgY2lyY2xlIHdpdGggdGhlIHByb3ZpZGVkIGNvbnRleHQuICovXG4gIGRvdCAoeDogbnVtYmVyLCB5OiBudW1iZXIsIGNvbG9yOiBzdHJpbmcsIHJhZGl1czogbnVtYmVyKSB7XG4gICAgZG90KHRoaXMuY3R4LCB4LCB5LCBjb2xvciwgcmFkaXVzKVxuICB9XG59XG5cbi8qIERlcHRoQ2hhcnQgaXMgYSBqYXZhc2NyaXB0IENhbnZhcy1iYXNlZCBkZXB0aCBjaGFydCByZW5kZXJlci4gKi9cbmV4cG9ydCBjbGFzcyBEZXB0aENoYXJ0IGV4dGVuZHMgQ2hhcnQge1xuICByZXBvcnRlcnM6IERlcHRoUmVwb3J0ZXJzXG4gIGJvb2s6IE9yZGVyQm9va1xuICB6b29tTGV2ZWw6IG51bWJlclxuICBsb3RTaXplOiBudW1iZXJcbiAgY29udmVudGlvbmFsUmF0ZVN0ZXA6IG51bWJlclxuICBsaW5lczogRGVwdGhMaW5lW11cbiAgbWFya2VyczogUmVjb3JkPHN0cmluZywgRGVwdGhNYXJrZXJbXT5cbiAgem9vbUluQnR0bjogUmVnaW9uXG4gIHpvb21PdXRCdHRuOiBSZWdpb25cbiAgYmFzZVVuaXQ6IHN0cmluZ1xuICBxdW90ZVVuaXQ6IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yIChwYXJlbnQ6IEhUTUxFbGVtZW50LCByZXBvcnRlcnM6IERlcHRoUmVwb3J0ZXJzLCB6b29tOiBudW1iZXIpIHtcbiAgICBzdXBlcihwYXJlbnQsIHtcbiAgICAgIHJlc2l6ZTogKCkgPT4gdGhpcy5yZXNpemVkKCksXG4gICAgICBjbGljazogKGU6IE1vdXNlRXZlbnQpID0+IHRoaXMuY2xpY2tlZChlKSxcbiAgICAgIHpvb206IChiaWdnZXI6IGJvb2xlYW4pID0+IHRoaXMuem9vbWVkKGJpZ2dlcilcbiAgICB9KVxuICAgIHRoaXMucmVwb3J0ZXJzID0gcmVwb3J0ZXJzXG4gICAgdGhpcy56b29tTGV2ZWwgPSB6b29tXG4gICAgdGhpcy5saW5lcyA9IFtdXG4gICAgdGhpcy5tYXJrZXJzID0ge1xuICAgICAgYnV5czogW10sXG4gICAgICBzZWxsczogW11cbiAgICB9XG4gICAgdGhpcy5zZXRab29tQnR0bnMoKSAvLyBjYW4ndCB3YWl0IGZvciByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgLT4gcmVzaXplZFxuICAgIHRoaXMucmVzaXplKClcbiAgfVxuXG4gIC8vIHNldFpvb21CdHRucyBjcmVhdGVzIG5ldyByZWdpb25zIGZvciB6b29tIGluIGFuZCB6b29tIG91dCBidXR0b25zLiBJdCBpc1xuICAvLyB1c2VkIGluIGluaXRpYXRpb24gb2YgdGhlIGJ1dHRvbnMgYW5kIHJlc2l6aW5nLlxuICBzZXRab29tQnR0bnMgKCkge1xuICAgIHRoaXMuem9vbUluQnR0biA9IG5ldyBSZWdpb24odGhpcy5jdHgsIG5ldyBFeHRlbnRzKDAsIDAsIDAsIDApKVxuICAgIHRoaXMuem9vbU91dEJ0dG4gPSBuZXcgUmVnaW9uKHRoaXMuY3R4LCBuZXcgRXh0ZW50cygwLCAwLCAwLCAwKSlcbiAgfVxuXG4gIC8qIHJlc2l6ZWQgaXMgY2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBvciBwYXJlbnQgZWxlbWVudCBhcmUgcmVzaXplZC4gKi9cbiAgcmVzaXplZCAoKSB7XG4gICAgLy8gVGhlIGJ1dHRvbiByZWdpb24gZXh0ZW50cyBhcmUgc2V0IGR1cmluZyBkcmF3aW5nLlxuICAgIHRoaXMuc2V0Wm9vbUJ0dG5zKClcbiAgICBpZiAodGhpcy5ib29rKSB0aGlzLmRyYXcoKVxuICB9XG5cbiAgLyogem9vbWVkIHpvb21zIHRoZSBjdXJyZW50IHZpZXcgaW4gb3Igb3V0LiBiaWdnZXI9dHJ1ZSBpcyB6b29tIGluLiAqL1xuICB6b29tZWQgKGJpZ2dlcjogYm9vbGVhbikge1xuICAgIGlmICghdGhpcy56b29tTGV2ZWwpIHJldHVyblxuICAgIGlmICghdGhpcy5ib29rLmJ1eXMgfHwgIXRoaXMuYm9vay5zZWxscykgcmV0dXJuXG4gICAgdGhpcy53aGVlbGVkKClcbiAgICAvLyBab29tIGluIHRvIDY2JSwgYnV0IG91dCB0byAxNTAlID0gMSAvICgyLzMpIHNvIHRoYXQgdGhlIHNhbWUgem9vbSBsZXZlbHNcbiAgICAvLyBhcmUgaGl0IHdoZW4gcmV2ZXJzaW5nIGRpcmVjdGlvbi5cbiAgICB0aGlzLnpvb21MZXZlbCAqPSBiaWdnZXIgPyAyIC8gMyA6IDMgLyAyXG4gICAgdGhpcy56b29tTGV2ZWwgPSBjbGFtcCh0aGlzLnpvb21MZXZlbCwgMC4wMDUsIDIpXG4gICAgdGhpcy5kcmF3KClcbiAgICB0aGlzLnJlcG9ydGVycy56b29tKHRoaXMuem9vbUxldmVsKVxuICB9XG5cbiAgLyogY2xpY2tlZCBpcyB0aGUgY2FudmFzICdjbGljaycgZXZlbnQgaGFuZGxlci4gKi9cbiAgY2xpY2tlZCAoZTogTW91c2VFdmVudCkge1xuICAgIGlmICghdGhpcy5kYXRhRXh0ZW50cykgcmV0dXJuXG4gICAgY29uc3QgeCA9IGUuY2xpZW50WCAtIHRoaXMucmVjdC5sZWZ0XG4gICAgY29uc3QgeSA9IGUuY2xpZW50WSAtIHRoaXMucmVjdC55XG4gICAgaWYgKHRoaXMuem9vbUluQnR0bi5jb250YWlucyh4LCB5KSkgeyB0aGlzLnpvb20odHJ1ZSk7IHJldHVybiB9XG4gICAgaWYgKHRoaXMuem9vbU91dEJ0dG4uY29udGFpbnMoeCwgeSkpIHsgdGhpcy56b29tKGZhbHNlKTsgcmV0dXJuIH1cbiAgICBjb25zdCB0cmFuc2xhdG9yID0gdGhpcy5wbG90UmVnaW9uLnRyYW5zbGF0b3IodGhpcy5kYXRhRXh0ZW50cylcbiAgICB0aGlzLnJlcG9ydGVycy5jbGljayh0cmFuc2xhdG9yLnVueCh4KSlcbiAgfVxuXG4gIC8vIHNldCBzZXRzIHRoZSBjdXJyZW50IGRhdGEgc2V0IGFuZCBkcmF3cy5cbiAgc2V0IChib29rOiBPcmRlckJvb2ssIGxvdFNpemU6IG51bWJlciwgcmF0ZVN0ZXBFbmM6IG51bWJlciwgYmFzZVVuaXRJbmZvOiBVbml0SW5mbywgcXVvdGVVbml0SW5mbzogVW5pdEluZm8pIHtcbiAgICB0aGlzLmJvb2sgPSBib29rXG4gICAgdGhpcy5sb3RTaXplID0gbG90U2l6ZSAvIGJhc2VVbml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIHRoaXMuY29udmVudGlvbmFsUmF0ZVN0ZXAgPSBEb2MuY29udmVudGlvbmFsUmF0ZVN0ZXAocmF0ZVN0ZXBFbmMsIGJhc2VVbml0SW5mbywgcXVvdGVVbml0SW5mbylcbiAgICB0aGlzLmJhc2VVbml0ID0gYmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XG4gICAgdGhpcy5xdW90ZVVuaXQgPSBxdW90ZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XG4gICAgaWYgKCF0aGlzLnpvb21MZXZlbCkge1xuICAgICAgY29uc3QgW21pZEdhcCwgZ2FwV2lkdGhdID0gdGhpcy5nYXAoKVxuICAgICAgLy8gRGVmYXVsdCB0byA1JSB6b29tLCBidXQgd2l0aCBhIG1pbmltdW0gb2YgNSAqIG1pZEdhcCwgYnV0IHN0aWxsIG9ic2VydmluZ1xuICAgICAgLy8gdGhlIGhhcmQgY2FwIG9mIDIwMCUuXG4gICAgICBjb25zdCBtaW5ab29tID0gTWF0aC5tYXgoZ2FwV2lkdGggLyBtaWRHYXAgKiA1LCAwLjA1KVxuICAgICAgdGhpcy56b29tTGV2ZWwgPSBNYXRoLm1pbihtaW5ab29tLCAyKVxuICAgIH1cbiAgICB0aGlzLmRyYXcoKVxuICB9XG5cbiAgLypcbiAgICogcmVuZGVyIGRyYXdzIHRoZSBjaGFydC5cbiAgICogMS4gQ2FsY3VsYXRlIHRoZSBkYXRhIGV4dGVudHMgYW5kIHRyYW5zbGF0ZSB0aGUgb3JkZXIgYm9vayBkYXRhIHRvIGFcbiAgICogICAgY3VtdWxhdGl2ZSBmb3JtLlxuICAgKiAyLiBEcmF3IGF4aXMgdGlja3MgYW5kIGdyaWQsIG1pZC1nYXAgbGluZSBhbmQgdmFsdWUsIHpvb20gYnV0dG9ucywgbW91c2VcbiAgICogICAgcG9zaXRpb24gaW5kaWNhdG9yLi4uXG4gICAqIDQuIFRpY2sgbGFiZWxzLlxuICAgKiA1LiBEYXRhLlxuICAgKiA2LiBFcG9jaCBsaW5lIGxlZ2VuZC5cbiAgICogNy4gSG92ZXIgbGVnZW5kLlxuICAgKi9cbiAgcmVuZGVyICgpIHtcbiAgICAvLyBpZiBjb25uZWN0aW9uIGZhaWxzIGl0IGlzIG5vdCBwb3NzaWJsZSB0byBnZXQgYm9vay5cbiAgICBpZiAoIXRoaXMuYm9vayB8fCAhdGhpcy52aXNpYmxlIHx8IHRoaXMuY2FudmFzLndpZHRoID09PSAwKSB7XG4gICAgICB0aGlzLnJlbmRlclNjaGVkdWxlZCA9IHRydWVcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRoaXMuY2xlYXIoKVxuICAgIC8vIGlmICghdGhpcy5ib29rIHx8IHRoaXMuYm9vay5lbXB0eSgpKSByZXR1cm5cbiAgICBjb25zdCBjdHggPSB0aGlzLmN0eFxuICAgIGNvbnN0IG1vdXNlUG9zID0gdGhpcy5tb3VzZVBvc1xuICAgIGNvbnN0IGJ1eXMgPSB0aGlzLmJvb2suYnV5c1xuICAgIGNvbnN0IHNlbGxzID0gdGhpcy5ib29rLnNlbGxzXG5cbiAgICBjb25zdCBbbWlkR2FwLCBnYXBXaWR0aF0gPSB0aGlzLmdhcCgpXG5cbiAgICBjb25zdCBoYWxmV2luZG93ID0gdGhpcy56b29tTGV2ZWwgKiBtaWRHYXAgLyAyXG4gICAgY29uc3QgaGlnaCA9IG1pZEdhcCArIGhhbGZXaW5kb3dcbiAgICBjb25zdCBsb3cgPSBtaWRHYXAgLSBoYWxmV2luZG93XG5cbiAgICAvLyBHZXQgYSBzb3J0ZWQgY29weSBvZiB0aGUgbWFya2VycyBsaXN0LlxuICAgIGNvbnN0IGJ1eU1hcmtlcnMgPSBbLi4udGhpcy5tYXJrZXJzLmJ1eXNdXG4gICAgY29uc3Qgc2VsbE1hcmtlcnMgPSBbLi4udGhpcy5tYXJrZXJzLnNlbGxzXVxuICAgIGJ1eU1hcmtlcnMuc29ydCgoYSwgYikgPT4gYi5yYXRlIC0gYS5yYXRlKVxuICAgIHNlbGxNYXJrZXJzLnNvcnQoKGEsIGIpID0+IGEucmF0ZSAtIGIucmF0ZSlcbiAgICBjb25zdCBtYXJrZXJzOiBEZXB0aE1hcmtbXSA9IFtdXG5cbiAgICBjb25zdCBidXlEZXB0aDogW251bWJlciwgbnVtYmVyXVtdID0gW11cbiAgICBjb25zdCBidXlFcG9jaDogW251bWJlciwgbnVtYmVyXVtdID0gW11cbiAgICBjb25zdCBzZWxsRGVwdGg6IFtudW1iZXIsIG51bWJlcl1bXSA9IFtdXG4gICAgY29uc3Qgc2VsbEVwb2NoOiBbbnVtYmVyLCBudW1iZXJdW10gPSBbXVxuICAgIGNvbnN0IHZvbHVtZVJlcG9ydCA9IHtcbiAgICAgIGJ1eUJhc2U6IDAsXG4gICAgICBidXlRdW90ZTogMCxcbiAgICAgIHNlbGxCYXNlOiAwLFxuICAgICAgc2VsbFF1b3RlOiAwXG4gICAgfVxuICAgIGxldCBzdW0gPSAwXG4gICAgLy8gVGhlIGVwb2NoIGxpbmUgaXMgYWJvdmUgdGhlIG5vbi1lcG9jaCByZWdpb24sIHNvIHRoZSBlcG9jaFN1bSB5IHZhbHVlXG4gICAgLy8gbXVzdCBhY2NvdW50IGZvciBub24tZXBvY2ggb3JkZXJzIHRvby5cbiAgICBsZXQgZXBvY2hTdW0gPSAwXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1eXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IG9yZCA9IGJ1eXNbaV1cbiAgICAgIGVwb2NoU3VtICs9IG9yZC5xdHlcbiAgICAgIGlmIChvcmQucmF0ZSA+PSBsb3cpIGJ1eUVwb2NoLnB1c2goW29yZC5yYXRlLCBlcG9jaFN1bV0pXG4gICAgICBpZiAob3JkLmVwb2NoKSBjb250aW51ZVxuICAgICAgc3VtICs9IG9yZC5xdHlcbiAgICAgIGJ1eURlcHRoLnB1c2goW29yZC5yYXRlLCBzdW1dKVxuICAgICAgdm9sdW1lUmVwb3J0LmJ1eUJhc2UgKz0gb3JkLnF0eVxuICAgICAgdm9sdW1lUmVwb3J0LmJ1eVF1b3RlICs9IG9yZC5xdHkgKiBvcmQucmF0ZVxuICAgICAgd2hpbGUgKGJ1eU1hcmtlcnMubGVuZ3RoICYmIGZsb2F0Q29tcGFyZShidXlNYXJrZXJzWzBdLnJhdGUsIG9yZC5yYXRlKSkge1xuICAgICAgICBjb25zdCBtYXJrID0gYnV5TWFya2Vycy5zaGlmdCgpXG4gICAgICAgIGlmICghbWFyaykgY29udGludWVcbiAgICAgICAgbWFya2Vycy5wdXNoKHtcbiAgICAgICAgICByYXRlOiBtYXJrLnJhdGUsXG4gICAgICAgICAgcXR5OiBvcmQuZXBvY2ggPyBlcG9jaFN1bSA6IHN1bSxcbiAgICAgICAgICBzZWxsOiBvcmQuc2VsbCxcbiAgICAgICAgICBhY3RpdmU6IG1hcmsuYWN0aXZlXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGJ1eVN1bSA9IGJ1eURlcHRoLmxlbmd0aCA/IGxhc3QoYnV5RGVwdGgpWzFdIDogMFxuICAgIGJ1eURlcHRoLnB1c2goW2xvdywgYnV5U3VtXSlcbiAgICBjb25zdCBlcG9jaEJ1eVN1bSA9IGJ1eUVwb2NoLmxlbmd0aCA/IGxhc3QoYnV5RXBvY2gpWzFdIDogMFxuICAgIGJ1eUVwb2NoLnB1c2goW2xvdywgZXBvY2hCdXlTdW1dKVxuXG4gICAgZXBvY2hTdW0gPSBzdW0gPSAwXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxscy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgb3JkID0gc2VsbHNbaV1cbiAgICAgIGVwb2NoU3VtICs9IG9yZC5xdHlcbiAgICAgIGlmIChvcmQucmF0ZSA8PSBoaWdoKSBzZWxsRXBvY2gucHVzaChbb3JkLnJhdGUsIGVwb2NoU3VtXSlcbiAgICAgIGlmIChvcmQuZXBvY2gpIGNvbnRpbnVlXG4gICAgICBzdW0gKz0gb3JkLnF0eVxuICAgICAgc2VsbERlcHRoLnB1c2goW29yZC5yYXRlLCBzdW1dKVxuICAgICAgdm9sdW1lUmVwb3J0LnNlbGxCYXNlICs9IG9yZC5xdHlcbiAgICAgIHZvbHVtZVJlcG9ydC5zZWxsUXVvdGUgKz0gb3JkLnF0eSAqIG9yZC5yYXRlXG4gICAgICB3aGlsZSAoc2VsbE1hcmtlcnMubGVuZ3RoICYmIGZsb2F0Q29tcGFyZShzZWxsTWFya2Vyc1swXS5yYXRlLCBvcmQucmF0ZSkpIHtcbiAgICAgICAgY29uc3QgbWFyayA9IHNlbGxNYXJrZXJzLnNoaWZ0KClcbiAgICAgICAgaWYgKCFtYXJrKSBjb250aW51ZVxuICAgICAgICBtYXJrZXJzLnB1c2goe1xuICAgICAgICAgIHJhdGU6IG1hcmsucmF0ZSxcbiAgICAgICAgICBxdHk6IG9yZC5lcG9jaCA/IGVwb2NoU3VtIDogc3VtLFxuICAgICAgICAgIHNlbGw6IG9yZC5zZWxsLFxuICAgICAgICAgIGFjdGl2ZTogbWFyay5hY3RpdmVcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gQWRkIGEgZGF0YSBwb2ludCBnb2luZyB0byB0aGUgbGVmdCBzbyB0aGF0IHRoZSBkYXRhIGRvZXNuJ3QgZW5kIHdpdGggYVxuICAgIC8vIHZlcnRpY2FsIGxpbmUuXG4gICAgY29uc3Qgc2VsbFN1bSA9IHNlbGxEZXB0aC5sZW5ndGggPyBsYXN0KHNlbGxEZXB0aClbMV0gOiAwXG4gICAgc2VsbERlcHRoLnB1c2goW2hpZ2gsIHNlbGxTdW1dKVxuICAgIGNvbnN0IGVwb2NoU2VsbFN1bSA9IHNlbGxFcG9jaC5sZW5ndGggPyBsYXN0KHNlbGxFcG9jaClbMV0gOiAwXG4gICAgc2VsbEVwb2NoLnB1c2goW2hpZ2gsIGVwb2NoU2VsbFN1bV0pXG5cbiAgICAvLyBBZGQgfjMwcHggcGFkZGluZyB0byB0aGUgdG9wIG9mIHRoZSBjaGFydC5cbiAgICBjb25zdCBoID0gdGhpcy54UmVnaW9uLmV4dGVudHMueS5taW5cbiAgICBjb25zdCBncm93dGhGYWN0b3IgPSAoaCArIDQwKSAvIGhcbiAgICBjb25zdCBtYXhZID0gKGVwb2NoU2VsbFN1bSAmJiBlcG9jaEJ1eVN1bSA/IE1hdGgubWF4KGVwb2NoQnV5U3VtLCBlcG9jaFNlbGxTdW0pIDogZXBvY2hTZWxsU3VtIHx8IGVwb2NoQnV5U3VtIHx8IDEpICogZ3Jvd3RoRmFjdG9yXG5cbiAgICBjb25zdCBkYXRhRXh0ZW50cyA9IG5ldyBFeHRlbnRzKGxvdywgaGlnaCwgMCwgbWF4WSlcbiAgICB0aGlzLmRhdGFFeHRlbnRzID0gZGF0YUV4dGVudHNcblxuICAgIC8vIEEgZnVuY3Rpb24gdG8gYmUgcnVuIGF0IHRoZSBlbmQgaWYgdGhlcmUgaXMgbGVnZW5kIGRhdGEgdG8gZGlzcGxheS5cbiAgICBsZXQgbW91c2VEYXRhOiBNb3VzZVJlcG9ydCB8IG51bGwgPSBudWxsXG5cbiAgICAvLyBEcmF3IHRoZSBncmlkLlxuICAgIGNvbnN0IHhMYWJlbHMgPSBtYWtlTGFiZWxzKGN0eCwgdGhpcy5wbG90UmVnaW9uLndpZHRoKCksIGRhdGFFeHRlbnRzLngubWluLCBkYXRhRXh0ZW50cy54Lm1heCwgMTAwLCB0aGlzLmNvbnZlbnRpb25hbFJhdGVTdGVwLCAnJylcbiAgICB0aGlzLnBsb3RYR3JpZCh4TGFiZWxzLCBsb3csIGhpZ2gpXG4gICAgY29uc3QgeUxhYmVscyA9IHRoaXMubWFrZVlMYWJlbHModGhpcy5wbG90UmVnaW9uLCB0aGlzLmxvdFNpemUsIHRoaXMuYmFzZVVuaXQpXG4gICAgdGhpcy5wbG90WUdyaWQodGhpcy5wbG90UmVnaW9uLCB5TGFiZWxzLCB0aGlzLmRhdGFFeHRlbnRzLnkubWluLCB0aGlzLmRhdGFFeHRlbnRzLnkubWF4KVxuXG4gICAgdGhpcy5wbG90UmVnaW9uLnBsb3QoZGF0YUV4dGVudHMsIChjdHgsIHRvb2xzKSA9PiB7XG4gICAgICBjdHgubGluZVdpZHRoID0gMVxuICAgICAgLy8gZmlyc3QsIGEgc3F1YXJlIGFyb3VuZCB0aGUgcGxvdCBhcmVhLlxuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5ncmlkQm9yZGVyXG4gICAgICAvLyBkcmF3IGEgbGluZSB0byBpbmRpY2F0ZSBtaWQtZ2FwXG4gICAgICBjdHgubGluZVdpZHRoID0gMi41XG4gICAgICBjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLnRoZW1lLmdhcExpbmVcbiAgICAgIGxpbmUoY3R4LCB0b29scy54KG1pZEdhcCksIHRvb2xzLnkoMCksIHRvb2xzLngobWlkR2FwKSwgdG9vbHMueSgwLjMgKiBkYXRhRXh0ZW50cy55Lm1heCkpXG5cbiAgICAgIGN0eC5mb250ID0gJzMwcHggXFwnZGVtaS1zYW5zXFwnLCBzYW5zLXNlcmlmJ1xuICAgICAgY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInXG4gICAgICBjdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSdcbiAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLnZhbHVlXG4gICAgICBjb25zdCB5ID0gMC41ICogZGF0YUV4dGVudHMueS5tYXhcbiAgICAgIGN0eC5maWxsVGV4dChEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MobWlkR2FwKSwgdG9vbHMueChtaWRHYXApLCB0b29scy55KHkpKVxuICAgICAgY3R4LmZvbnQgPSAnMTJweCBcXCdzYW5zXFwnLCBzYW5zLXNlcmlmJ1xuICAgICAgLy8gY3R4LmZpbGxUZXh0KCdtaWQtbWFya2V0IHByaWNlJywgdG9vbHMueChtaWRHYXApLCB0b29scy55KHkpICsgMjQpXG4gICAgICBjdHguZmlsbFRleHQoYCR7KGdhcFdpZHRoIC8gbWlkR2FwICogMTAwKS50b0ZpeGVkKDIpfSUgc3ByZWFkYCxcbiAgICAgICAgdG9vbHMueChtaWRHYXApLCB0b29scy55KHkpICsgMjQpXG5cbiAgICAgIC8vIERyYXcgem9vbSBidXR0b25zLlxuICAgICAgY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInXG4gICAgICBjdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSdcbiAgICAgIGNvbnN0IHRvcENlbnRlclggPSB0aGlzLnBsb3RSZWdpb24uZXh0ZW50cy5taWRYXG4gICAgICBjb25zdCB0b3BDZW50ZXJZID0gdG9vbHMueShtYXhZICogMC45KVxuICAgICAgY29uc3Qgem9vbVBjdCA9IGRhdGFFeHRlbnRzLnhSYW5nZSAvIG1pZEdhcCAqIDEwMFxuICAgICAgY29uc3Qgem9vbVRleHQgPSBgJHt6b29tUGN0LnRvRml4ZWQoMSl9JWBcbiAgICAgIGNvbnN0IHcgPSBjdHgubWVhc3VyZVRleHQoem9vbVRleHQpLndpZHRoXG4gICAgICBjdHguZm9udCA9ICcxM3B4IFxcJ3NhbnNcXCcsIHNhbnMtc2VyaWYnXG4gICAgICBjdHguZmlsbFRleHQoem9vbVRleHQsIHRvcENlbnRlclgsIHRvcENlbnRlclkgKyAxKVxuICAgICAgLy8gZGVmaW5lIHRoZSByZWdpb24gZm9yIHRoZSB6b29tIGJ1dHRvblxuICAgICAgY29uc3QgYnR0blNpemUgPSAyMFxuICAgICAgY29uc3QgeFBhZCA9IDEwXG4gICAgICBsZXQgYnR0bkxlZnQgPSB0b3BDZW50ZXJYIC0gdyAvIDIgLSB4UGFkIC0gYnR0blNpemVcbiAgICAgIGNvbnN0IGJ0dG5Ub3AgPSB0b3BDZW50ZXJZIC0gYnR0blNpemUgLyAyXG4gICAgICB0aGlzLnpvb21PdXRCdHRuLnNldEV4dGVudHMoXG4gICAgICAgIGJ0dG5MZWZ0LFxuICAgICAgICBidHRuTGVmdCArIGJ0dG5TaXplLFxuICAgICAgICBidHRuVG9wLFxuICAgICAgICBidHRuVG9wICsgYnR0blNpemVcbiAgICAgIClcbiAgICAgIGxldCBob3ZlciA9IG1vdXNlUG9zICYmIHRoaXMuem9vbU91dEJ0dG4uY29udGFpbnMobW91c2VQb3MueCwgbW91c2VQb3MueSlcbiAgICAgIHRoaXMuem9vbU91dEJ0dG4ucGxvdChuZXcgRXh0ZW50cygwLCAxLCAwLCAxKSwgY3R4ID0+IHtcbiAgICAgICAgY3R4LmZvbnQgPSAnMTJweCBcXCdpY29tb29uXFwnJ1xuICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZS56b29tXG4gICAgICAgIGlmIChob3Zlcikge1xuICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLnpvb21Ib3ZlclxuICAgICAgICAgIGN0eC5mb250ID0gJzEzcHggXFwnaWNvbW9vblxcJydcbiAgICAgICAgfVxuICAgICAgICBjdHguZmlsbFRleHQobWludXNDaGFyLCB0aGlzLnpvb21PdXRCdHRuLmV4dGVudHMubWlkWCwgdGhpcy56b29tT3V0QnR0bi5leHRlbnRzLm1pZFkpXG4gICAgICB9KVxuICAgICAgYnR0bkxlZnQgPSB0b3BDZW50ZXJYICsgdyAvIDIgKyB4UGFkXG4gICAgICB0aGlzLnpvb21JbkJ0dG4uc2V0RXh0ZW50cyhcbiAgICAgICAgYnR0bkxlZnQsXG4gICAgICAgIGJ0dG5MZWZ0ICsgYnR0blNpemUsXG4gICAgICAgIGJ0dG5Ub3AsXG4gICAgICAgIGJ0dG5Ub3AgKyBidHRuU2l6ZVxuICAgICAgKVxuICAgICAgaG92ZXIgPSBtb3VzZVBvcyAmJiB0aGlzLnpvb21JbkJ0dG4uY29udGFpbnMobW91c2VQb3MueCwgbW91c2VQb3MueSlcbiAgICAgIHRoaXMuem9vbUluQnR0bi5wbG90KG5ldyBFeHRlbnRzKDAsIDEsIDAsIDEpLCBjdHggPT4ge1xuICAgICAgICBjdHguZm9udCA9ICcxMnB4IFxcJ2ljb21vb25cXCcnXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLnpvb21cbiAgICAgICAgaWYgKGhvdmVyKSB7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuem9vbUhvdmVyXG4gICAgICAgICAgY3R4LmZvbnQgPSAnMTRweCBcXCdpY29tb29uXFwnJ1xuICAgICAgICB9XG4gICAgICAgIGN0eC5maWxsVGV4dChwbHVzQ2hhciwgdGhpcy56b29tSW5CdHRuLmV4dGVudHMubWlkWCwgdGhpcy56b29tSW5CdHRuLmV4dGVudHMubWlkWSlcbiAgICAgIH0pXG5cbiAgICAgIC8vIERyYXcgYSBkb3R0ZWQgdmVydGljYWwgbGluZSB3aGVyZSB0aGUgbW91c2UgaXMsIGFuZCBhIGRvdCBhdCB0aGUgbGV2ZWxcbiAgICAgIC8vIG9mIHRoZSBkZXB0aCBsaW5lLlxuICAgICAgY29uc3QgZHJhd0xpbmUgPSAoeDogbnVtYmVyLCBjb2xvcjogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh4ID4gaGlnaCB8fCB4IDwgbG93KSByZXR1cm5cbiAgICAgICAgY3R4LnNhdmUoKVxuICAgICAgICBjdHguc2V0TGluZURhc2goWzMsIDVdKVxuICAgICAgICBjdHgubGluZVdpZHRoID0gMS41XG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGNvbG9yXG4gICAgICAgIGxpbmUoY3R4LCB0b29scy54KHgpLCB0b29scy55KDApLCB0b29scy54KHgpLCB0b29scy55KG1heFkpKVxuICAgICAgICBjdHgucmVzdG9yZSgpXG4gICAgICB9XG5cbiAgICAgIC8vIGZvciAoY29uc3QgbGluZSBvZiB0aGlzLmxpbmVzIHx8IFtdKSB7XG4gICAgICAvLyAgIGRyYXdMaW5lKGxpbmUucmF0ZSwgbGluZS5jb2xvcilcbiAgICAgIC8vIH1cblxuICAgICAgY29uc3QgdG9sZXJhbmNlID0gKGhpZ2ggLSBsb3cpICogMC4wMDVcbiAgICAgIGNvbnN0IGhvdmVyTWFya2VycyA9IFtdXG4gICAgICBmb3IgKGNvbnN0IG1hcmtlciBvZiBtYXJrZXJzIHx8IFtdKSB7XG4gICAgICAgIGNvbnN0IGhvdmVyZWQgPSAobW91c2VQb3MgJiYgd2l0aGluVG9sZXJhbmNlKG1hcmtlci5yYXRlLCB0b29scy51bngobW91c2VQb3MueCksIHRvbGVyYW5jZSkpXG4gICAgICAgIGlmIChob3ZlcmVkKSBob3Zlck1hcmtlcnMucHVzaChtYXJrZXIucmF0ZSlcbiAgICAgICAgY3R4LnNhdmUoKVxuICAgICAgICBjdHgubGluZVdpZHRoID0gKGhvdmVyZWQgfHwgbWFya2VyLmFjdGl2ZSkgPyA1IDogM1xuICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBtYXJrZXIuc2VsbCA/IHRoaXMudGhlbWUuc2VsbExpbmUgOiB0aGlzLnRoZW1lLmJ1eUxpbmVcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IG1hcmtlci5zZWxsID8gdGhpcy50aGVtZS5zZWxsRmlsbCA6IHRoaXMudGhlbWUuYnV5RmlsbFxuICAgICAgICBjb25zdCBzaXplID0gKGhvdmVyZWQgfHwgbWFya2VyLmFjdGl2ZSkgPyAxMCA6IDhcbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpXG4gICAgICAgIGNvbnN0IHRpcCA9IHtcbiAgICAgICAgICB4OiB0b29scy54KG1hcmtlci5yYXRlKSxcbiAgICAgICAgICB5OiB0b29scy55KG1hcmtlci5xdHkpIC0gOFxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRvcCA9IHRpcC55IC0gKE1hdGguc3FydCgzKSAqIHNpemUgLyAyKSAvLyBjb3MoMzApXG4gICAgICAgIGN0eC5tb3ZlVG8odGlwLngsIHRpcC55KVxuICAgICAgICBjdHgubGluZVRvKHRpcC54IC0gc2l6ZSAvIDIsIHRvcClcbiAgICAgICAgY3R4LmxpbmVUbyh0aXAueCArIHNpemUgLyAyLCB0b3ApXG4gICAgICAgIGN0eC5jbG9zZVBhdGgoKVxuICAgICAgICBjdHguc3Ryb2tlKClcbiAgICAgICAgY3R4LmZpbGwoKVxuICAgICAgICBjdHgucmVzdG9yZSgpXG4gICAgICB9XG5cbiAgICAgIC8vIElmIHRoZSBtb3VzZSBpcyBpbiB0aGUgY2hhcnQgYXJlYSwgZHJhdyB0aGUgY3Jvc3NoYWlycy5cbiAgICAgIGlmICghbW91c2VQb3MpIHJldHVyblxuICAgICAgaWYgKCF0aGlzLnBsb3RSZWdpb24uY29udGFpbnMobW91c2VQb3MueCwgbW91c2VQb3MueSkpIHJldHVyblxuICAgICAgLy8gVGhlIG1vdXNlIGlzIGluIHRoZSBwbG90IHJlZ2lvbi4gR2V0IHRoZSBkYXRhIGNvb3JkaW5hdGVzIGFuZCBmaW5kIHRoZVxuICAgICAgLy8gc2lkZSBhbmQgZGVwdGggZm9yIHRoZSB4IHZhbHVlLlxuICAgICAgY29uc3QgZGF0YVggPSB0b29scy51bngobW91c2VQb3MueClcbiAgICAgIGxldCBldmFsU2lkZSA9IHNlbGxEZXB0aFxuICAgICAgbGV0IHRyaWdnZXIgPSAocHRYOiBudW1iZXIpID0+IHB0WCA+PSBkYXRhWFxuICAgICAgbGV0IGRvdENvbG9yID0gdGhpcy50aGVtZS5zZWxsTGluZVxuICAgICAgaWYgKGRhdGFYIDwgbWlkR2FwKSB7XG4gICAgICAgIGV2YWxTaWRlID0gYnV5RGVwdGhcbiAgICAgICAgdHJpZ2dlciA9IChwdFgpID0+IHB0WCA8PSBkYXRhWFxuICAgICAgICBkb3RDb2xvciA9IHRoaXMudGhlbWUuYnV5TGluZVxuICAgICAgfVxuICAgICAgbGV0IGJlc3REZXB0aCA9IGV2YWxTaWRlWzBdXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGV2YWxTaWRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHB0ID0gZXZhbFNpZGVbaV1cbiAgICAgICAgaWYgKHRyaWdnZXIocHRbMF0pKSBicmVha1xuICAgICAgICBiZXN0RGVwdGggPSBwdFxuICAgICAgfVxuICAgICAgZHJhd0xpbmUoZGF0YVgsIHRoaXMudGhlbWUuY3Jvc3NoYWlycylcbiAgICAgIG1vdXNlRGF0YSA9IHtcbiAgICAgICAgcmF0ZTogZGF0YVgsXG4gICAgICAgIGRlcHRoOiBiZXN0RGVwdGhbMV0sXG4gICAgICAgIGRvdENvbG9yOiBkb3RDb2xvcixcbiAgICAgICAgaG92ZXJNYXJrZXJzOiBob3Zlck1hcmtlcnNcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gRHJhdyB0aGUgZXBvY2ggbGluZXNcbiAgICBjdHgubGluZVdpZHRoID0gMS41XG4gICAgY3R4LnNldExpbmVEYXNoKFszLCAzXSlcbiAgICAvLyBlcG9jaCBzZWxsc1xuICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLnNlbGxGaWxsXG4gICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5zZWxsTGluZVxuICAgIHRoaXMuZHJhd0RlcHRoKHNlbGxFcG9jaClcbiAgICAvLyBlcG9jaCBidXlzXG4gICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuYnV5RmlsbFxuICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMudGhlbWUuYnV5TGluZVxuICAgIHRoaXMuZHJhd0RlcHRoKGJ1eUVwb2NoKVxuXG4gICAgLy8gRHJhdyB0aGUgYm9vayBkZXB0aC5cbiAgICBjdHgubGluZVdpZHRoID0gMi41XG4gICAgY3R4LnNldExpbmVEYXNoKFtdKVxuICAgIC8vIGJvb2sgc2VsbHNcbiAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZS5zZWxsRmlsbFxuICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMudGhlbWUuc2VsbExpbmVcbiAgICB0aGlzLmRyYXdEZXB0aChzZWxsRGVwdGgpXG4gICAgLy8gYm9vayBidXlzXG4gICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuYnV5RmlsbFxuICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMudGhlbWUuYnV5TGluZVxuICAgIHRoaXMuZHJhd0RlcHRoKGJ1eURlcHRoKVxuXG4gICAgdGhpcy5wbG90WUxhYmVscyh5TGFiZWxzLCB0aGlzLmRhdGFFeHRlbnRzLnkubWluLCB0aGlzLmRhdGFFeHRlbnRzLnkubWF4LCB0aGlzLmJhc2VVbml0KVxuICAgIHRoaXMucGxvdFhMYWJlbHMoeExhYmVscywgbG93LCBoaWdoLCBbYCR7dGhpcy5xdW90ZVVuaXR9L2AsIHRoaXMuYmFzZVVuaXRdKVxuXG4gICAgLy8gRGlzcGxheSB0aGUgZG90IGF0IHRoZSBpbnRlcnNlY3Rpb24gb2YgdGhlIG1vdXNlIGhvdmVyIGxpbmUgYW5kIHRoZSBkZXB0aFxuICAgIC8vIGxpbmUuIFRoaXMgc2hvdWxkIGJlIGRyYXduIGFmdGVyIHRoZSBkZXB0aHMuXG4gICAgaWYgKG1vdXNlRGF0YSkge1xuICAgICAgdGhpcy5wbG90UmVnaW9uLnBsb3QoZGF0YUV4dGVudHMsIChjdHgsIHRvb2xzKSA9PiB7XG4gICAgICAgIGlmICghbW91c2VEYXRhKSByZXR1cm4gLy8gRm9yIFR5cGVTY3JpcHQuIER1aC5cbiAgICAgICAgZG90KGN0eCwgdG9vbHMueChtb3VzZURhdGEucmF0ZSksIHRvb2xzLnkobW91c2VEYXRhLmRlcHRoKSwgbW91c2VEYXRhLmRvdENvbG9yLCA1KVxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBSZXBvcnQgdGhlIGJvb2sgdm9sdW1lcy5cbiAgICB0aGlzLnJlcG9ydGVycy52b2x1bWUodm9sdW1lUmVwb3J0KVxuICAgIHRoaXMucmVwb3J0ZXJzLm1vdXNlKG1vdXNlRGF0YSlcbiAgfVxuXG4gIC8qIGRyYXdEZXB0aCBkcmF3cyBhIHNpbmdsZSBzaWRlJ3MgZGVwdGggY2hhcnQgZGF0YS4gKi9cbiAgZHJhd0RlcHRoIChkZXB0aDogW251bWJlciwgbnVtYmVyXVtdKSB7XG4gICAgY29uc3QgZmlyc3RQdCA9IGRlcHRoWzBdXG4gICAgbGV0IHg6IG51bWJlclxuICAgIHRoaXMucGxvdFJlZ2lvbi5wbG90KHRoaXMuZGF0YUV4dGVudHMsIChjdHgsIHRvb2xzKSA9PiB7XG4gICAgICBjb25zdCB5WmVybyA9IHRvb2xzLnkoMClcbiAgICAgIGxldCB5ID0gdG9vbHMueShmaXJzdFB0WzFdKVxuICAgICAgY3R4LmJlZ2luUGF0aCgpXG4gICAgICBjdHgubW92ZVRvKHRvb2xzLngoZmlyc3RQdFswXSksIHRvb2xzLnkoZmlyc3RQdFsxXSkpXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRlcHRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIFNldCB4LCBidXQgZG9uJ3Qgc2V0IHkgdW50aWwgd2UgZHJhdyB0aGUgaG9yaXpvbnRhbCBsaW5lLlxuICAgICAgICB4ID0gdG9vbHMueChkZXB0aFtpXVswXSlcbiAgICAgICAgY3R4LmxpbmVUbyh4LCB5KVxuICAgICAgICAvLyBJZiB0aGlzIGlzIHBhc3QgdGhlIHJlbmRlciBlZGdlLCBxdWl0IGRyYXdpbmcuXG4gICAgICAgIHkgPSB0b29scy55KGRlcHRoW2ldWzFdKVxuICAgICAgICBjdHgubGluZVRvKHgsIHkpXG4gICAgICB9XG4gICAgICBjdHguc3Ryb2tlKClcbiAgICAgIGN0eC5saW5lVG8oeCwgeVplcm8pXG4gICAgICBjdHgubGluZVRvKHRvb2xzLngoZmlyc3RQdFswXSksIHlaZXJvKVxuICAgICAgY3R4LmNsb3NlUGF0aCgpXG4gICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjI1XG4gICAgICBjdHguZmlsbCgpXG4gICAgfSlcbiAgfVxuXG4gIC8qIHJldHVybnMgdGhlIG1pZC1nYXAgcmF0ZSBhbmQgZ2FwIHdpZHRoIGFzIGEgdHVwbGUuICovXG4gIGdhcCAoKSB7XG4gICAgY29uc3QgW2IsIHNdID0gW3RoaXMuYm9vay5iZXN0R2FwQnV5KCksIHRoaXMuYm9vay5iZXN0R2FwU2VsbCgpXVxuICAgIGlmICghYikge1xuICAgICAgaWYgKCFzKSByZXR1cm4gWzEsIDBdXG4gICAgICByZXR1cm4gW3MucmF0ZSwgMF1cbiAgICB9IGVsc2UgaWYgKCFzKSByZXR1cm4gW2IucmF0ZSwgMF1cbiAgICByZXR1cm4gWyhzLnJhdGUgKyBiLnJhdGUpIC8gMiwgcy5yYXRlIC0gYi5yYXRlXVxuICB9XG5cbiAgLyogc2V0TGluZXMgc3RvcmVzIHRoZSBpbmRpY2F0b3IgbGluZXMgdG8gZHJhdy4gKi9cbiAgc2V0TGluZXMgKGxpbmVzOiBEZXB0aExpbmVbXSkge1xuICAgIHRoaXMubGluZXMgPSBsaW5lc1xuICB9XG5cbiAgLyogc2V0TWFya2VycyBzZXRzIHRoZSBpbmRpY2F0b3IgbWFya2VycyB0byBkcmF3LiAqL1xuICBzZXRNYXJrZXJzIChtYXJrZXJzOiBSZWNvcmQ8c3RyaW5nLCBEZXB0aE1hcmtlcltdPikge1xuICAgIHRoaXMubWFya2VycyA9IG1hcmtlcnNcbiAgfVxufVxuXG4vKiBDYW5kbGVDaGFydCBpcyBhIGNhbmRsZXN0aWNrIGRhdGEgcmVuZGVyZXIuICovXG5leHBvcnQgY2xhc3MgQ2FuZGxlQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XG4gIHJlcG9ydGVyczogQ2FuZGxlUmVwb3J0ZXJzXG4gIGRhdGE6IENhbmRsZXNQYXlsb2FkXG4gIHpvb21MZXZlbDogbnVtYmVyXG4gIG51bVRvU2hvdzogbnVtYmVyXG4gIGNhbmRsZVJlZ2lvbjogUmVnaW9uXG4gIHZvbHVtZVJlZ2lvbjogUmVnaW9uXG4gIHJlc2l6ZVRpbWVyOiBudW1iZXJcbiAgem9vbUxldmVsczogbnVtYmVyW11cbiAgbWFya2V0OiBNYXJrZXRcbiAgcmF0ZUNvbnZlcnNpb25GYWN0b3I6IG51bWJlclxuXG4gIGNvbnN0cnVjdG9yIChwYXJlbnQ6IEhUTUxFbGVtZW50LCByZXBvcnRlcnM6IENhbmRsZVJlcG9ydGVycykge1xuICAgIHN1cGVyKHBhcmVudCwge1xuICAgICAgcmVzaXplOiAoKSA9PiB0aGlzLnJlc2l6ZWQoKSxcbiAgICAgIGNsaWNrOiAoLyogZTogTW91c2VFdmVudCAqLykgPT4geyB0aGlzLmNsaWNrZWQoKSB9LFxuICAgICAgem9vbTogKGJpZ2dlcjogYm9vbGVhbikgPT4gdGhpcy56b29tZWQoYmlnZ2VyKVxuICAgIH0pXG4gICAgdGhpcy5yZXBvcnRlcnMgPSByZXBvcnRlcnNcbiAgICB0aGlzLnpvb21MZXZlbCA9IDFcbiAgICB0aGlzLm51bVRvU2hvdyA9IDEwMFxuICAgIHRoaXMucmVzaXplKClcbiAgfVxuXG4gIC8qIHJlc2l6ZWQgaXMgY2FsbGVkIHdoZW4gdGhlIHdpbmRvdyBvciBwYXJlbnQgZWxlbWVudCBhcmUgcmVzaXplZC4gKi9cbiAgcmVzaXplZCAoKSB7XG4gICAgY29uc3QgZXh0ID0gdGhpcy5wbG90UmVnaW9uLmV4dGVudHNcbiAgICBjb25zdCBjYW5kbGVFeHRlbnRzID0gbmV3IEV4dGVudHMoZXh0LngubWluLCBleHQueC5tYXgsIGV4dC55Lm1pbiwgZXh0LnkubWluICsgZXh0LnlSYW5nZSAqIDAuODUpXG4gICAgdGhpcy5jYW5kbGVSZWdpb24gPSBuZXcgUmVnaW9uKHRoaXMuY3R4LCBjYW5kbGVFeHRlbnRzKVxuICAgIGNvbnN0IHZvbHVtZUV4dGVudHMgPSBuZXcgRXh0ZW50cyhleHQueC5taW4sIGV4dC54Lm1heCwgZXh0LnkubWluICsgMC44NSAqIGV4dC55UmFuZ2UsIGV4dC55Lm1heClcbiAgICB0aGlzLnZvbHVtZVJlZ2lvbiA9IG5ldyBSZWdpb24odGhpcy5jdHgsIHZvbHVtZUV4dGVudHMpXG4gICAgLy8gU2V0IGEgZGVsYXkgb24gdGhlIHJlbmRlciB0byBwcmV2ZW50IGxhZy5cbiAgICBpZiAodGhpcy5yZXNpemVUaW1lcikgY2xlYXJUaW1lb3V0KHRoaXMucmVzaXplVGltZXIpXG4gICAgdGhpcy5yZXNpemVUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHRoaXMuZHJhdygpLCAxMDApXG4gIH1cblxuICBjbGlja2VkICgvKiBlOiBNb3VzZUV2ZW50ICovKSB7XG4gICAgLy8gaGFuZGxlIGNsaWNrc1xuICB9XG5cbiAgLyogem9vbWVkIHpvb21zIHRoZSBjdXJyZW50IHZpZXcgaW4gb3Igb3V0LiBiaWdnZXI9dHJ1ZSBpcyB6b29tIGluLiAqL1xuICB6b29tZWQgKGJpZ2dlcjogYm9vbGVhbikge1xuICAgIC8vIGJpZ2dlciBhY3R1YWxseSBtZWFucyBmZXdlciBjYW5kbGVzIC0+IHJlZHVjZSB6b29tTGV2ZWxzIGluZGV4LlxuICAgIGNvbnN0IGlkeCA9IHRoaXMuem9vbUxldmVscy5pbmRleE9mKHRoaXMubnVtVG9TaG93KVxuICAgIGlmIChiaWdnZXIpIHtcbiAgICAgIGlmIChpZHggPT09IDApIHJldHVyblxuICAgICAgdGhpcy5udW1Ub1Nob3cgPSB0aGlzLnpvb21MZXZlbHNbaWR4IC0gMV1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuem9vbUxldmVscy5sZW5ndGggPD0gaWR4ICsgMSB8fCB0aGlzLm51bVRvU2hvdyA+IHRoaXMuZGF0YS5jYW5kbGVzLmxlbmd0aCkgcmV0dXJuXG4gICAgICB0aGlzLm51bVRvU2hvdyA9IHRoaXMuem9vbUxldmVsc1tpZHggKyAxXVxuICAgIH1cbiAgICB0aGlzLmRyYXcoKVxuICB9XG5cbiAgLyogcmVuZGVyIGRyYXdzIHRoZSBjaGFydCAqL1xuICByZW5kZXIgKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGFcbiAgICBpZiAoIWRhdGEgfHwgIXRoaXMudmlzaWJsZSB8fCB0aGlzLmNhbnZhcy53aWR0aCA9PT0gMCkge1xuICAgICAgdGhpcy5yZW5kZXJTY2hlZHVsZWQgPSB0cnVlXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgY2FuZGxlV2lkdGggPSBkYXRhLm1zXG4gICAgY29uc3QgbW91c2VQb3MgPSB0aGlzLm1vdXNlUG9zXG4gICAgY29uc3QgYWxsQ2FuZGxlcyA9IGRhdGEuY2FuZGxlcyB8fCBbXVxuXG4gICAgY29uc3QgbiA9IE1hdGgubWluKHRoaXMubnVtVG9TaG93LCBhbGxDYW5kbGVzLmxlbmd0aClcbiAgICBjb25zdCBjYW5kbGVzID0gYWxsQ2FuZGxlcy5zbGljZShhbGxDYW5kbGVzLmxlbmd0aCAtIG4pXG5cbiAgICB0aGlzLmNsZWFyKClcblxuICAgIC8vIElmIHRoZXJlIGFyZSBubyBjYW5kbGVzLiBqdXN0IGRvbid0IGRyYXcgYW55dGhpbmcuXG4gICAgaWYgKG4gPT09IDApIHJldHVyblxuXG4gICAgLy8gcGFkZGluZyBkZWZpbml0aW9uIGFuZCBzb21lIGhlbHBlciBmdW5jdGlvbnMgdG8gcGFyc2UgY2FuZGxlcy5cbiAgICBjb25zdCBjYW5kbGVXaWR0aFBhZGRpbmcgPSAwLjJcbiAgICBjb25zdCBzdGFydCA9IChjOiBDYW5kbGUpID0+IHRydW5jYXRlKGMuZW5kU3RhbXAsIGNhbmRsZVdpZHRoKVxuICAgIGNvbnN0IGVuZCA9IChjOiBDYW5kbGUpID0+IHN0YXJ0KGMpICsgY2FuZGxlV2lkdGhcbiAgICBjb25zdCBwYWRkZWRTdGFydCA9IChjOiBDYW5kbGUpID0+IHN0YXJ0KGMpICsgY2FuZGxlV2lkdGhQYWRkaW5nICogY2FuZGxlV2lkdGhcbiAgICBjb25zdCBwYWRkZWRXaWR0aCA9ICgxIC0gMiAqIGNhbmRsZVdpZHRoUGFkZGluZykgKiBjYW5kbGVXaWR0aFxuXG4gICAgY29uc3QgZmlyc3QgPSBjYW5kbGVzWzBdXG4gICAgY29uc3QgbGFzdCA9IGNhbmRsZXNbbiAtIDFdXG5cbiAgICBsZXQgW2hpZ2gsIGxvdywgaGlnaFZvbF0gPSBbZmlyc3QuaGlnaFJhdGUsIGZpcnN0Lmxvd1JhdGUsIGZpcnN0Lm1hdGNoVm9sdW1lXVxuICAgIGZvciAoY29uc3QgYyBvZiBjYW5kbGVzKSB7XG4gICAgICBpZiAoYy5oaWdoUmF0ZSA+IGhpZ2gpIGhpZ2ggPSBjLmhpZ2hSYXRlXG4gICAgICBpZiAoYy5sb3dSYXRlIDwgbG93KSBsb3cgPSBjLmxvd1JhdGVcbiAgICAgIGlmIChjLm1hdGNoVm9sdW1lID4gaGlnaFZvbCkgaGlnaFZvbCA9IGMubWF0Y2hWb2x1bWVcbiAgICB9XG5cbiAgICBoaWdoICs9IChoaWdoIC0gbG93KSAqIDAuMSAvLyBhIGxpdHRsZSBwYWRkaW5nXG4gICAgY29uc3QgeFN0YXJ0ID0gc3RhcnQoZmlyc3QpXG4gICAgbGV0IHhFbmQgPSBlbmQobGFzdClcbiAgICB4RW5kICs9ICh4RW5kIC0geFN0YXJ0KSAqIDAuMDUgLy8gYSBsaXR0bGUgcGFkZGluZ1xuXG4gICAgLy8gQ2FsY3VsYXRlIGRhdGEgZXh0ZW50cyBhbmQgc3RvcmUgdGhlbS4gVGhleSBhcmUgdXNlZCB0byBhcHBseSBsYWJlbHMuXG4gICAgY29uc3QgcmF0ZVN0ZXAgPSB0aGlzLm1hcmtldC5yYXRlc3RlcFxuICAgIGNvbnN0IGRhdGFFeHRlbnRzID0gbmV3IEV4dGVudHMoeFN0YXJ0LCB4RW5kLCBsb3csIGhpZ2gpXG4gICAgaWYgKGxvdyA9PT0gaGlnaCkge1xuICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gcHJpY2UgbW92ZW1lbnQgYXQgYWxsIGluIHRoZSB3aW5kb3csIHNob3cgYSBsaXR0bGUgbW9yZVxuICAgICAgLy8gdG9wIGFuZCBib3R0b20gc28gdGhpbmdzIHJlbmRlciBuaWNlbHkuXG4gICAgICBkYXRhRXh0ZW50cy55Lm1pbiAtPSByYXRlU3RlcFxuICAgICAgZGF0YUV4dGVudHMueS5tYXggKz0gcmF0ZVN0ZXBcbiAgICB9XG4gICAgdGhpcy5kYXRhRXh0ZW50cyA9IGRhdGFFeHRlbnRzXG5cbiAgICBsZXQgbW91c2VDYW5kbGU6IENhbmRsZSB8IG51bGwgPSBudWxsXG4gICAgaWYgKG1vdXNlUG9zKSB7XG4gICAgICB0aGlzLnBsb3RSZWdpb24ucGxvdChuZXcgRXh0ZW50cyhkYXRhRXh0ZW50cy54Lm1pbiwgZGF0YUV4dGVudHMueC5tYXgsIDAsIDEpLCAoY3R4LCB0b29scykgPT4ge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFN0YXJ0U3RhbXAgPSB0cnVuY2F0ZSh0b29scy51bngobW91c2VQb3MueCksIGNhbmRsZVdpZHRoKVxuICAgICAgICBmb3IgKGNvbnN0IGMgb2YgY2FuZGxlcykge1xuICAgICAgICAgIGlmIChzdGFydChjKSA9PT0gc2VsZWN0ZWRTdGFydFN0YW1wKSB7XG4gICAgICAgICAgICBtb3VzZUNhbmRsZSA9IGNcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLmdyaWRMaW5lc1xuICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHRvb2xzLngoc3RhcnQoYykpLCB0b29scy55KDApLCB0b29scy53KGNhbmRsZVdpZHRoKSwgdG9vbHMuaCgxKSlcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIERyYXcgdGhlIGdyaWRcbiAgICBjb25zdCByRmFjdG9yID0gdGhpcy5yYXRlQ29udmVyc2lvbkZhY3RvclxuICAgIGNvbnN0IGJhc2VVbml0ID0gYXBwKCkuYXNzZXRzW3RoaXMubWFya2V0LmJhc2VpZF0/LnVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0IHx8IHRoaXMubWFya2V0LmJhc2VzeW1ib2wudG9VcHBlckNhc2UoKVxuICAgIGNvbnN0IHhMYWJlbHMgPSBtYWtlQ2FuZGxlVGltZUxhYmVscyhjYW5kbGVzLCBjYW5kbGVXaWR0aCwgdGhpcy5wbG90UmVnaW9uLndpZHRoKCksIDEwMClcbiAgICB0aGlzLnBsb3RYR3JpZCh4TGFiZWxzLCB4U3RhcnQsIHhFbmQpXG4gICAgY29uc3QgeUxhYmVscyA9IHRoaXMubWFrZVlMYWJlbHModGhpcy5jYW5kbGVSZWdpb24sIHJhdGVTdGVwLCBiYXNlVW5pdCwgdiA9PiBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModiAvIHJGYWN0b3IpKVxuICAgIHRoaXMucGxvdFlHcmlkKHRoaXMuY2FuZGxlUmVnaW9uLCB5TGFiZWxzLCB0aGlzLmRhdGFFeHRlbnRzLnkubWluLCB0aGlzLmRhdGFFeHRlbnRzLnkubWF4KVxuXG4gICAgLy8gRHJhdyB0aGUgdm9sdW1lIGJhcnMuXG4gICAgY29uc3Qgdm9sRGF0YUV4dGVudHMgPSBuZXcgRXh0ZW50cyh4U3RhcnQsIHhFbmQsIDAsIGhpZ2hWb2wpXG4gICAgdGhpcy52b2x1bWVSZWdpb24ucGxvdCh2b2xEYXRhRXh0ZW50cywgKGN0eCwgdG9vbHMpID0+IHtcbiAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLmdyaWRCb3JkZXJcbiAgICAgIGZvciAoY29uc3QgYyBvZiBjYW5kbGVzKSB7XG4gICAgICAgIGN0eC5maWxsUmVjdCh0b29scy54KHBhZGRlZFN0YXJ0KGMpKSwgdG9vbHMueSgwKSwgdG9vbHMudyhwYWRkZWRXaWR0aCksIHRvb2xzLmgoYy5tYXRjaFZvbHVtZSkpXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIERyYXcgdGhlIGNhbmRsZXMuXG4gICAgdGhpcy5jYW5kbGVSZWdpb24ucGxvdChkYXRhRXh0ZW50cywgKGN0eCwgdG9vbHMpID0+IHtcbiAgICAgIGN0eC5saW5lV2lkdGggPSAxXG4gICAgICBmb3IgKGNvbnN0IGMgb2YgY2FuZGxlcykge1xuICAgICAgICBjb25zdCBkZXNjID0gYy5zdGFydFJhdGUgPiBjLmVuZFJhdGVcbiAgICAgICAgY29uc3QgW3gsIHksIHcsIGhdID0gW3Rvb2xzLngocGFkZGVkU3RhcnQoYykpLCB0b29scy55KGMuc3RhcnRSYXRlKSwgdG9vbHMudyhwYWRkZWRXaWR0aCksIHRvb2xzLmgoYy5lbmRSYXRlIC0gYy5zdGFydFJhdGUpXVxuICAgICAgICBjb25zdCBbaGlnaCwgbG93LCBjeF0gPSBbdG9vbHMueShjLmhpZ2hSYXRlKSwgdG9vbHMueShjLmxvd1JhdGUpLCB3IC8gMiArIHhdXG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGRlc2MgPyB0aGlzLnRoZW1lLnNlbGxMaW5lIDogdGhpcy50aGVtZS5idXlMaW5lXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBkZXNjID8gdGhpcy50aGVtZS5zZWxsRmlsbCA6IHRoaXMudGhlbWUuYnV5RmlsbFxuXG4gICAgICAgIGN0eC5iZWdpblBhdGgoKVxuICAgICAgICBjdHgubW92ZVRvKGN4LCBoaWdoKVxuICAgICAgICBjdHgubGluZVRvKGN4LCBsb3cpXG4gICAgICAgIGN0eC5zdHJva2UoKVxuXG4gICAgICAgIGN0eC5maWxsUmVjdCh4LCB5LCB3LCBoKVxuICAgICAgICBjdHguc3Ryb2tlUmVjdCh4LCB5LCB3LCBoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAvLyBBcHBseSBsYWJlbHMuXG4gICAgdGhpcy5wbG90WExhYmVscyh4TGFiZWxzLCB4U3RhcnQsIHhFbmQsIFtdKVxuICAgIHRoaXMucGxvdFlMYWJlbHMoeUxhYmVscywgdGhpcy5kYXRhRXh0ZW50cy55Lm1pbiwgdGhpcy5kYXRhRXh0ZW50cy55Lm1heCwgYmFzZVVuaXQpXG5cbiAgICAvLyBIaWdobGlnaHQgdGhlIGNhbmRsZSBpZiB0aGUgdXNlciBtb3VzZSBpcyBvdmVyIHRoZSBjYW52YXMuXG4gICAgaWYgKG1vdXNlQ2FuZGxlKSB7XG4gICAgICBjb25zdCB5RXh0ID0gdGhpcy54UmVnaW9uLmV4dGVudHMueVxuICAgICAgdGhpcy54UmVnaW9uLnBsb3QobmV3IEV4dGVudHMoZGF0YUV4dGVudHMueC5taW4sIGRhdGFFeHRlbnRzLngubWF4LCB5RXh0Lm1pbiwgeUV4dC5tYXgpLCAoY3R4LCB0b29scykgPT4ge1xuICAgICAgICBpZiAoIW1vdXNlQ2FuZGxlKSByZXR1cm4gLy8gRm9yIFR5cGVTY3JpcHQuIER1aC5cbiAgICAgICAgdGhpcy5hcHBseUxhYmVsU3R5bGUoKVxuICAgICAgICBjb25zdCByYW5nZVR4dCA9IGAke25ldyBEYXRlKHN0YXJ0KG1vdXNlQ2FuZGxlKSkudG9Mb2NhbGVTdHJpbmcoKX0gLSAke25ldyBEYXRlKGVuZChtb3VzZUNhbmRsZSkpLnRvTG9jYWxlU3RyaW5nKCl9YFxuICAgICAgICBjb25zdCBbeFBhZCwgeVBhZF0gPSBbMjUsIDJdXG4gICAgICAgIGNvbnN0IHJhbmdlV2lkdGggPSBjdHgubWVhc3VyZVRleHQocmFuZ2VUeHQpLndpZHRoICsgMiAqIHhQYWRcbiAgICAgICAgY29uc3QgcmFuZ2VIZWlnaHQgPSAxNlxuICAgICAgICBsZXQgY2VudGVyWCA9IHRvb2xzLngoKHN0YXJ0KG1vdXNlQ2FuZGxlKSArIGVuZChtb3VzZUNhbmRsZSkpIC8gMilcbiAgICAgICAgbGV0IGxlZnQgPSBjZW50ZXJYIC0gcmFuZ2VXaWR0aCAvIDJcbiAgICAgICAgY29uc3QgeEV4dCA9IHRoaXMueFJlZ2lvbi5leHRlbnRzLnhcbiAgICAgICAgaWYgKGxlZnQgPCB4RXh0Lm1pbikgbGVmdCA9IHhFeHQubWluXG4gICAgICAgIGVsc2UgaWYgKGxlZnQgKyByYW5nZVdpZHRoID4geEV4dC5tYXgpIGxlZnQgPSB4RXh0Lm1heCAtIHJhbmdlV2lkdGhcbiAgICAgICAgY2VudGVyWCA9IGxlZnQgKyByYW5nZVdpZHRoIC8gMlxuICAgICAgICBjb25zdCB0b3AgPSB5RXh0Lm1pbiArICh0aGlzLnhSZWdpb24uaGVpZ2h0KCkgLSByYW5nZUhlaWdodCkgLyAyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLmxlZ2VuZEZpbGxcbiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5ncmlkQm9yZGVyXG4gICAgICAgIGNvbnN0IHJlY3RBcmdzOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFtsZWZ0IC0geFBhZCwgdG9wIC0geVBhZCwgcmFuZ2VXaWR0aCArIDIgKiB4UGFkLCByYW5nZUhlaWdodCArIDIgKiB5UGFkXVxuICAgICAgICBjdHguZmlsbFJlY3QoLi4ucmVjdEFyZ3MpXG4gICAgICAgIGN0eC5zdHJva2VSZWN0KC4uLnJlY3RBcmdzKVxuICAgICAgICB0aGlzLmFwcGx5TGFiZWxTdHlsZSgpXG4gICAgICAgIGN0eC5maWxsVGV4dChyYW5nZVR4dCwgY2VudGVyWCwgdGhpcy54UmVnaW9uLmV4dGVudHMubWlkWSwgcmFuZ2VXaWR0aClcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gUmVwb3J0IHRoZSBtb3VzZSBjYW5kbGUuXG4gICAgdGhpcy5yZXBvcnRlcnMubW91c2UobW91c2VDYW5kbGUpXG4gIH1cblxuICAvKiBzZXRDYW5kbGVzIHNldHMgdGhlIGNhbmRsZSBkYXRhIGFuZCByZWRyYXdzIHRoZSBjaGFydC4gKi9cbiAgc2V0Q2FuZGxlcyAoZGF0YTogQ2FuZGxlc1BheWxvYWQsIG1hcmtldDogTWFya2V0LCBiYXNlVW5pdEluZm86IFVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvOiBVbml0SW5mbykge1xuICAgIHRoaXMuZGF0YSA9IGRhdGFcbiAgICBpZiAoIWRhdGEuY2FuZGxlcykgcmV0dXJuXG4gICAgdGhpcy5tYXJrZXQgPSBtYXJrZXRcbiAgICBjb25zdCBbcUZhY3RvciwgYkZhY3Rvcl0gPSBbcXVvdGVVbml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciwgYmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXVxuICAgIHRoaXMucmF0ZUNvbnZlcnNpb25GYWN0b3IgPSBSYXRlRW5jb2RpbmdGYWN0b3IgKiBxRmFjdG9yIC8gYkZhY3RvclxuICAgIGxldCBuID0gMjVcbiAgICB0aGlzLnpvb21MZXZlbHMgPSBbXVxuICAgIGNvbnN0IG1heENhbmRsZXMgPSBNYXRoLm1heChkYXRhLmNhbmRsZXMubGVuZ3RoLCAxMDAwKVxuICAgIHdoaWxlIChuIDwgbWF4Q2FuZGxlcykge1xuICAgICAgdGhpcy56b29tTGV2ZWxzLnB1c2gobilcbiAgICAgIG4gKj0gMlxuICAgIH1cbiAgICB0aGlzLm51bVRvU2hvdyA9IDEwMFxuICAgIHRoaXMuZHJhdygpXG4gIH1cbn1cblxuaW50ZXJmYWNlIFdhdmVPcHRzIHtcbiAgbWVzc2FnZT86IHN0cmluZ1xuICBiYWNrZ3JvdW5kQ29sb3I/OiBzdHJpbmcgfCBib29sZWFuIC8vIHRydWUgZm9yIDxib2R5PiBiYWNrZ3JvdW5kIGNvbG9yXG59XG5cbi8qIFdhdmUgaXMgYSBsb2FkaW5nIGFuaW1hdGlvbiB0aGF0IGRpc3BsYXlzIGEgY29sb3JmdWwgbGluZSB0aGF0IG9zY2lsbGF0ZXMgKi9cbmV4cG9ydCBjbGFzcyBXYXZlIGV4dGVuZHMgQ2hhcnQge1xuICBhbmk6IEFuaW1hdGlvblxuICBzaXplOiBbbnVtYmVyLCBudW1iZXJdXG4gIHJlZ2lvbjogUmVnaW9uXG4gIGNvbG9yU2hpZnQ6IG51bWJlclxuICBvcHRzOiBXYXZlT3B0c1xuICBtc2dSZWdpb246IFJlZ2lvblxuICBmb250U2l6ZTogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IgKHBhcmVudDogSFRNTEVsZW1lbnQsIG9wdHM/OiBXYXZlT3B0cykge1xuICAgIHN1cGVyKHBhcmVudCwge1xuICAgICAgcmVzaXplOiAoKSA9PiB0aGlzLnJlc2l6ZWQoKSxcbiAgICAgIGNsaWNrOiAoLyogZTogTW91c2VFdmVudCAqLykgPT4geyAvKiBwYXNzICovIH0sXG4gICAgICB6b29tOiAoLyogYmlnZ2VyOiBib29sZWFuICovKSA9PiB7IC8qIHBhc3MgKi8gfVxuICAgIH0pXG4gICAgdGhpcy5jYW52YXMuY2xhc3NMaXN0LmFkZCgnZmlsbC1hYnMnKVxuICAgIHRoaXMuY2FudmFzLnN0eWxlLnpJbmRleCA9ICc1J1xuXG4gICAgdGhpcy5vcHRzID0gb3B0cyA/PyB7fVxuXG4gICAgY29uc3QgcGVyaW9kID0gMTUwMCAvLyBtc1xuICAgIGNvbnN0IHN0YXJ0ID0gTWF0aC5yYW5kb20oKSAqIHBlcmlvZFxuICAgIHRoaXMuY29sb3JTaGlmdCA9IE1hdGgucmFuZG9tKCkgKiAzNjBcblxuICAgIC8vIHkgPSBBKmNvcyhrKnggKyB0aGV0YSp0ICsgYylcbiAgICAvLyBjb21iaW5lIHRocmVlIHdhdmVzIHdpdGggZGlmZmVyZW50IHBlcmlvZHMgYW5kIHNwZWVkcyBhbmQgcGhhc2VzLlxuICAgIGNvbnN0IGFtcGxpdHVkZXMgPSBbMSwgMC42NSwgMC43NV1cbiAgICBjb25zdCBrcyA9IFszLCAzLCAyXVxuICAgIGNvbnN0IHNwZWVkcyA9IFtNYXRoLlBJLCBNYXRoLlBJICogMTAgLyA5LCBNYXRoLlBJIC8gMi41XVxuICAgIGNvbnN0IHBoYXNlcyA9IFswLCAwLCBNYXRoLlBJICogMS41XVxuICAgIGNvbnN0IG4gPSA3NVxuICAgIGNvbnN0IHNpbmdsZSA9IChuOiBudW1iZXIsIGFuZ3VsYXJYOiBudW1iZXIsIGFuZ3VsYXJUaW1lOiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICAgICAgcmV0dXJuIGFtcGxpdHVkZXNbbl0gKiBNYXRoLmNvcyhrc1tuXSAqIGFuZ3VsYXJYICsgc3BlZWRzW25dICogYW5ndWxhclRpbWUgKyBwaGFzZXNbbl0pXG4gICAgfVxuICAgIGNvbnN0IHZhbHVlID0gKHg6IG51bWJlciwgYW5ndWxhclRpbWU6IG51bWJlcik6IG51bWJlciA9PiB7XG4gICAgICBjb25zdCBhbmd1bGFyWCA9IHggKiBNYXRoLlBJICogMlxuICAgICAgcmV0dXJuIChzaW5nbGUoMCwgYW5ndWxhclgsIGFuZ3VsYXJUaW1lKSArIHNpbmdsZSgxLCBhbmd1bGFyWCwgYW5ndWxhclRpbWUpICsgc2luZ2xlKDIsIGFuZ3VsYXJYLCBhbmd1bGFyVGltZSkpIC8gM1xuICAgIH1cbiAgICB0aGlzLnJlc2l6ZSgpXG4gICAgdGhpcy5hbmkgPSBuZXcgQW5pbWF0aW9uKEFuaW1hdGlvbi5Gb3JldmVyLCAoKSA9PiB7XG4gICAgICBjb25zdCBhbmd1bGFyVGltZSA9IChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHN0YXJ0KSAvIHBlcmlvZCAqIE1hdGguUEkgKiAyXG4gICAgICBjb25zdCB2YWx1ZXMgPSBbXVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgdmFsdWVzLnB1c2godmFsdWUoaSAvIChuIC0gMSksIGFuZ3VsYXJUaW1lKSlcbiAgICAgIH1cbiAgICAgIHRoaXMuZHJhd1ZhbHVlcyh2YWx1ZXMpXG4gICAgfSlcbiAgfVxuXG4gIHJlc2l6ZWQgKCkge1xuICAgIGNvbnN0IG9wdHMgPSB0aGlzLm9wdHNcbiAgICBjb25zdCBbbWF4VywgbWF4SF0gPSBbMTUwLCAxMDBdXG4gICAgY29uc3QgW2N3LCBjaF0gPSBbdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodF1cbiAgICBsZXQgW3csIGhdID0gW2N3ICogMC44LCBjaCAqIDAuOF1cbiAgICBpZiAodyA+IG1heFcpIHcgPSBtYXhXXG4gICAgaWYgKGggPiBtYXhIKSBoID0gbWF4SFxuICAgIGxldCBbbCwgdF0gPSBbKGN3IC0gdykgLyAyLCAoY2ggLSBoKSAvIDJdXG4gICAgaWYgKG9wdHMubWVzc2FnZSkge1xuICAgICAgdGhpcy5mb250U2l6ZSA9IGNsYW1wKGggKiAwLjE1LCAxMCwgMTQpXG4gICAgICB0aGlzLmFwcGx5TGFiZWxTdHlsZSh0aGlzLmZvbnRTaXplKVxuICAgICAgY29uc3QgeXBhZCA9IHRoaXMuZm9udFNpemUgKiAwLjVcbiAgICAgIGNvbnN0IGhhbGZIID0gKHRoaXMuZm9udFNpemUgLyAyKSArIHlwYWRcbiAgICAgIHQgLT0gaGFsZkhcbiAgICAgIHRoaXMubXNnUmVnaW9uID0gbmV3IFJlZ2lvbih0aGlzLmN0eCwgbmV3IEV4dGVudHMoMCwgY3csIHQgKyBoLCB0ICsgaCArIDIgKiBoYWxmSCkpXG4gICAgfVxuICAgIHRoaXMucmVnaW9uID0gbmV3IFJlZ2lvbih0aGlzLmN0eCwgbmV3IEV4dGVudHMobCwgbCArIHcsIHQsIHQgKyBoKSlcbiAgfVxuXG4gIGRyYXdWYWx1ZXMgKHZhbHVlczogbnVtYmVyW10pIHtcbiAgICBpZiAoIXRoaXMucmVnaW9uKSByZXR1cm5cbiAgICB0aGlzLmNsZWFyKClcbiAgICBjb25zdCBoc2wgPSAoaDogbnVtYmVyKSA9PiBgaHNsKCR7aH0sIDM1JSwgNTAlKWBcblxuICAgIGNvbnN0IHsgcmVnaW9uLCBtc2dSZWdpb24sIGNhbnZhczogeyB3aWR0aDogdywgaGVpZ2h0OiBoIH0sIG9wdHM6IHsgYmFja2dyb3VuZENvbG9yOiBiZywgbWVzc2FnZTogbXNnIH0sIGNvbG9yU2hpZnQsIGN0eCB9ID0gdGhpc1xuXG4gICAgaWYgKGJnKSB7XG4gICAgICBpZiAoYmcgPT09IHRydWUpIGN0eC5maWxsU3R5bGUgPSBTdGF0ZS5pc0RhcmsoKSA/ICcjMGExZTM0JyA6ICcjZjBmMGYwJ1xuICAgICAgZWxzZSBjdHguZmlsbFN0eWxlID0gYmdcbiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3LCBoKVxuICAgIH1cblxuICAgIHJlZ2lvbi5wbG90KG5ldyBFeHRlbnRzKDAsIDEsIC0xLCAxKSwgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0OiBUcmFuc2xhdG9yKSA9PiB7XG4gICAgICBjdHgubGluZVdpZHRoID0gNFxuICAgICAgY3R4LmxpbmVDYXAgPSAncm91bmQnXG5cbiAgICAgIGNvbnN0IHNoaWZ0ID0gY29sb3JTaGlmdCArIChuZXcgRGF0ZSgpLmdldFRpbWUoKSAlIDIwMDApIC8gMjAwMCAqIDM2MCAvLyBjb2xvcnMgbW92ZSB3aXRoIGZyZXF1ZW5jeSAxIC8gMnNcbiAgICAgIGNvbnN0IGdyYWQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQodC54KDApLCAwLCB0LngoMSksIDApXG4gICAgICBncmFkLmFkZENvbG9yU3RvcCgwLCBoc2woc2hpZnQpKVxuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gZ3JhZFxuXG4gICAgICBjdHguYmVnaW5QYXRoKClcbiAgICAgIGN0eC5tb3ZlVG8odC54KDApLCB0LnkodmFsdWVzWzBdKSlcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHByb2cgPSBpIC8gKHZhbHVlcy5sZW5ndGggLSAxKVxuICAgICAgICBncmFkLmFkZENvbG9yU3RvcChwcm9nLCBoc2wocHJvZyAqIDMwMCArIHNoaWZ0KSlcbiAgICAgICAgY3R4LmxpbmVUbyh0LngocHJvZyksIHQueSh2YWx1ZXNbaV0pKVxuICAgICAgfVxuICAgICAgY3R4LnN0cm9rZSgpXG4gICAgfSlcbiAgICBpZiAoIW1zZykgcmV0dXJuXG4gICAgbXNnUmVnaW9uLnBsb3QobmV3IEV4dGVudHMoMCwgMSwgMCwgMSksIChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgdDogVHJhbnNsYXRvcikgPT4ge1xuICAgICAgdGhpcy5hcHBseUxhYmVsU3R5bGUodGhpcy5mb250U2l6ZSlcbiAgICAgIGN0eC5maWxsVGV4dChtc2csIHQueCgwLjUpLCB0LnkoMC41KSwgdGhpcy5tc2dSZWdpb24ud2lkdGgoKSlcbiAgICB9KVxuICB9XG5cbiAgcmVuZGVyICgpIHsgLyogcGFzcyAqLyB9XG5cbiAgc3RvcCAoKSB7XG4gICAgdGhpcy5hbmkuc3RvcCgpXG4gICAgdGhpcy5jYW52YXMucmVtb3ZlKClcbiAgfVxufVxuXG4vKlxuICogRXh0ZW50cyBob2xkcyBhIG1pbiBhbmQgbWF4IGluIGJvdGggdGhlIHggYW5kIHkgZGlyZWN0aW9ucywgYW5kIHByb3ZpZGVzXG4gKiBnZXR0ZXJzIGZvciByZWxhdGVkIGRhdGEuXG4gKi9cbmV4cG9ydCBjbGFzcyBFeHRlbnRzIHtcbiAgeDogTWluTWF4XG4gIHk6IE1pbk1heFxuXG4gIGNvbnN0cnVjdG9yICh4TWluOiBudW1iZXIsIHhNYXg6IG51bWJlciwgeU1pbjogbnVtYmVyLCB5TWF4OiBudW1iZXIpIHtcbiAgICB0aGlzLnNldEV4dGVudHMoeE1pbiwgeE1heCwgeU1pbiwgeU1heClcbiAgfVxuXG4gIHNldEV4dGVudHMgKHhNaW46IG51bWJlciwgeE1heDogbnVtYmVyLCB5TWluOiBudW1iZXIsIHlNYXg6IG51bWJlcikge1xuICAgIHRoaXMueCA9IHtcbiAgICAgIG1pbjogeE1pbixcbiAgICAgIG1heDogeE1heFxuICAgIH1cbiAgICB0aGlzLnkgPSB7XG4gICAgICBtaW46IHlNaW4sXG4gICAgICBtYXg6IHlNYXhcbiAgICB9XG4gIH1cblxuICBnZXQgeFJhbmdlICgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLngubWF4IC0gdGhpcy54Lm1pblxuICB9XG5cbiAgZ2V0IG1pZFggKCk6IG51bWJlciB7XG4gICAgcmV0dXJuICh0aGlzLngubWF4ICsgdGhpcy54Lm1pbikgLyAyXG4gIH1cblxuICBnZXQgeVJhbmdlICgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnkubWF4IC0gdGhpcy55Lm1pblxuICB9XG5cbiAgZ2V0IG1pZFkgKCk6IG51bWJlciB7XG4gICAgcmV0dXJuICh0aGlzLnkubWF4ICsgdGhpcy55Lm1pbikgLyAyXG4gIH1cbn1cblxuLypcbiAqIFJlZ2lvbiBhcHBsaWVzIGFuIEV4dGVudHMgdG8gdGhlIGNhbnZhcywgcHJvdmlkaW5nIHV0aWxpdGllcyBmb3IgY29vcmRpbmF0ZVxuICogdHJhbnNmb3JtYXRpb25zIGFuZCByZXN0cmljdGluZyBkcmF3aW5nIHRvIGEgc3BlY2lmaWVkIHJlZ2lvbiBvZiB0aGUgY2FudmFzLlxuICovXG5leHBvcnQgY2xhc3MgUmVnaW9uIHtcbiAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEXG4gIGV4dGVudHM6IEV4dGVudHNcblxuICBjb25zdHJ1Y3RvciAoY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCBleHRlbnRzOiBFeHRlbnRzKSB7XG4gICAgdGhpcy5jb250ZXh0ID0gY29udGV4dFxuICAgIHRoaXMuZXh0ZW50cyA9IGV4dGVudHNcbiAgfVxuXG4gIHNldEV4dGVudHMgKHhNaW46IG51bWJlciwgeE1heDogbnVtYmVyLCB5TWluOiBudW1iZXIsIHlNYXg6IG51bWJlcikge1xuICAgIHRoaXMuZXh0ZW50cy5zZXRFeHRlbnRzKHhNaW4sIHhNYXgsIHlNaW4sIHlNYXgpXG4gIH1cblxuICB3aWR0aCAoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5leHRlbnRzLnhSYW5nZVxuICB9XG5cbiAgaGVpZ2h0ICgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmV4dGVudHMueVJhbmdlXG4gIH1cblxuICBjb250YWlucyAoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBjb25zdCBleHQgPSB0aGlzLmV4dGVudHNcbiAgICByZXR1cm4gKHggPCBleHQueC5tYXggJiYgeCA+IGV4dC54Lm1pbiAmJlxuICAgICAgeSA8IGV4dC55Lm1heCAmJiB5ID4gZXh0LnkubWluKVxuICB9XG5cbiAgLypcbiAgICogQSB0cmFuc2xhdG9yIHByb3ZpZGVzIDQgZnVuY3Rpb24gZm9yIGNvb3JkaW5hdGUgdHJhbnNmb3JtYXRpb25zLiB4IGFuZCB5XG4gICAqIHRyYW5zbGF0ZSBkYXRhIGNvb3JkaW5hdGVzIHRvIGNhbnZhcyBjb29yZGluYXRlcyBmb3IgdGhlIHNwZWNpZmllZCBkYXRhXG4gICAqIEV4dGVudHMuIHVueCBhbmQgdW55IHRyYW5zbGF0ZSBjYW52YXMgY29vcmRpbmF0ZXMgdG8gZGF0YSBjb29yZGluYXRlcy5cbiAgICovXG4gIHRyYW5zbGF0b3IgKGRhdGFFeHRlbnRzOiBFeHRlbnRzKTogVHJhbnNsYXRvciB7XG4gICAgY29uc3QgcmVnaW9uID0gdGhpcy5leHRlbnRzXG4gICAgY29uc3QgeE1pbiA9IGRhdGFFeHRlbnRzLngubWluXG4gICAgLy8gY29uc3QgeE1heCA9IGRhdGFFeHRlbnRzLngubWF4XG4gICAgY29uc3QgeU1pbiA9IGRhdGFFeHRlbnRzLnkubWluXG4gICAgLy8gY29uc3QgeU1heCA9IGRhdGFFeHRlbnRzLnkubWF4XG4gICAgY29uc3QgeVJhbmdlID0gZGF0YUV4dGVudHMueVJhbmdlXG4gICAgY29uc3QgeFJhbmdlID0gZGF0YUV4dGVudHMueFJhbmdlXG4gICAgY29uc3Qgc2NyZWVuTWluWCA9IHJlZ2lvbi54Lm1pblxuICAgIGNvbnN0IHNjcmVlblcgPSByZWdpb24ueC5tYXggLSBzY3JlZW5NaW5YXG4gICAgY29uc3Qgc2NyZWVuTWF4WSA9IHJlZ2lvbi55Lm1heFxuICAgIGNvbnN0IHNjcmVlbkggPSBzY3JlZW5NYXhZIC0gcmVnaW9uLnkubWluXG4gICAgY29uc3QgeEZhY3RvciA9IHNjcmVlblcgLyB4UmFuZ2VcbiAgICBjb25zdCB5RmFjdG9yID0gc2NyZWVuSCAvIHlSYW5nZVxuICAgIHJldHVybiB7XG4gICAgICB4OiAoeDogbnVtYmVyKSA9PiAoeCAtIHhNaW4pICogeEZhY3RvciArIHNjcmVlbk1pblgsXG4gICAgICB5OiAoeTogbnVtYmVyKSA9PiBzY3JlZW5NYXhZIC0gKHkgLSB5TWluKSAqIHlGYWN0b3IsXG4gICAgICB1bng6ICh4OiBudW1iZXIpID0+ICh4IC0gc2NyZWVuTWluWCkgLyB4RmFjdG9yICsgeE1pbixcbiAgICAgIHVueTogKHk6IG51bWJlcikgPT4geU1pbiAtICh5IC0gc2NyZWVuTWF4WSkgLyB5RmFjdG9yLFxuICAgICAgdzogKHc6IG51bWJlcikgPT4gdyAvIHhSYW5nZSAqIHNjcmVlblcsXG4gICAgICBoOiAoaDogbnVtYmVyKSA9PiAtaCAvIHlSYW5nZSAqIHNjcmVlbkhcbiAgICB9XG4gIH1cblxuICAvKiBjbGVhciBjbGVhcnMgdGhlIHJlZ2lvbi4gKi9cbiAgY2xlYXIgKCkge1xuICAgIGNvbnN0IGV4dCA9IHRoaXMuZXh0ZW50c1xuICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoZXh0LngubWluLCBleHQueS5taW4sIGV4dC54UmFuZ2UsIGV4dC55UmFuZ2UpXG4gIH1cblxuICAvKiBwbG90IHByZXBhcmVzIHRvb2xzIGZvciBkcmF3aW5nIHVzaW5nIGRhdGEgY29vcmRpbmF0ZXMuICovXG4gIHBsb3QgKGRhdGFFeHRlbnRzOiBFeHRlbnRzLCBkcmF3RnVuYzogKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0b29sczogVHJhbnNsYXRvcikgPT4gdm9pZCwgc2tpcE1hc2s/OiBib29sZWFuKSB7XG4gICAgY29uc3QgY3R4ID0gdGhpcy5jb250ZXh0XG4gICAgY29uc3QgcmVnaW9uID0gdGhpcy5leHRlbnRzXG4gICAgY3R4LnNhdmUoKSAvLyBTYXZlIHRoZSBvcmlnaW5hbCBzdGF0ZVxuICAgIGlmICghc2tpcE1hc2spIHtcbiAgICAgIGN0eC5iZWdpblBhdGgoKVxuICAgICAgY3R4LnJlY3QocmVnaW9uLngubWluLCByZWdpb24ueS5taW4sIHJlZ2lvbi54UmFuZ2UsIHJlZ2lvbi55UmFuZ2UpXG4gICAgICBjdHguY2xpcCgpXG4gICAgfVxuXG4gICAgLy8gVGhlIGRyYXdGdW5jIHdpbGwgYmUgcGFzc2VkIGEgc2V0IG9mIHRvb2wgdGhhdCBjYW4gYmUgdXNlZCB0byBhc3Npc3RcbiAgICAvLyBkcmF3aW5nLiBUaGUgdG9vbHMgc3RhcnQgd2l0aCB0aGUgdHJhbnNmb3JtYXRpb24gZnVuY3Rpb25zLlxuICAgIGNvbnN0IHRvb2xzID0gdGhpcy50cmFuc2xhdG9yKGRhdGFFeHRlbnRzKVxuXG4gICAgLy8gQ3JlYXRlIGEgdHJhbnNmb3JtYXRpb24gdGhhdCBhbGxvd3MgZHJhd2luZyBpbiBkYXRhIGNvb3JkaW5hdGVzLiBJdCdzXG4gICAgLy8gbm90IGFkdmlzYWJsZSB0byBzdHJva2Ugb3IgYWRkIHRleHQgd2l0aCB0aGlzIHRyYW5zZm9ybSBpbiBwbGFjZSwgYXMgdGhlXG4gICAgLy8gcmVzdWx0IHdpbGwgYmUgZGlzdG9ydGVkLiBZb3UgY2FuIGhvd2V2ZXIgdXNlIGN0eC5tb3ZlVG8gYW5kIGN0eC5saW5lVG9cbiAgICAvLyB3aXRoIHRoaXMgdHJhbnNmb3JtIGluIHBsYWNlIHVzaW5nIGRhdGEgY29vcmRpbmF0ZXMsIGFuZCByZW1vdmUgdGhlXG4gICAgLy8gdHJhbnNmb3JtIGJlZm9yZSBzdHJva2luZy4gVGhlIGRhdGFDb29yZHMgbWV0aG9kIG9mIHRoZSBzdXBwbGllZCB0b29sXG4gICAgLy8gcHJvdmlkZXMgdGhpcyBmdW5jdGlvbmFsaXR5LlxuXG4gICAgLy8gVE9ETzogRmlndXJlIG91dCB3aHkgdGhpcyBkb2Vzbid0IHdvcmsgb24gV2ViVmlldy5cbiAgICAvLyBjb25zdCB5UmFuZ2UgPSBkYXRhRXh0ZW50cy55UmFuZ2VcbiAgICAvLyBjb25zdCB4RmFjdG9yID0gcmVnaW9uLnhSYW5nZSAvIGRhdGFFeHRlbnRzLnhSYW5nZVxuICAgIC8vIGNvbnN0IHlGYWN0b3IgPSByZWdpb24ueVJhbmdlIC8geVJhbmdlXG4gICAgLy8gY29uc3QgeE1pbiA9IGRhdGFFeHRlbnRzLngubWluXG4gICAgLy8gY29uc3QgeU1pbiA9IGRhdGFFeHRlbnRzLnkubWluXG4gICAgLy8gLy8gVGhlc2UgdHJhbnNsYXRpb24gZmFjdG9ycyBhcmUgY29tcGxpY2F0ZWQgYmVjYXVzZSB0aGUgKDAsIDApIG9mIHRoZVxuICAgIC8vIC8vIHJlZ2lvbiBpcyBub3QgbmVjZXNzYXJpbHkgdGhlICgwLCAwKSBvZiB0aGUgY2FudmFzLlxuICAgIC8vIGNvbnN0IHR4ID0gKHJlZ2lvbi54Lm1pbiArIHhNaW4pIC0geE1pbiAqIHhGYWN0b3JcbiAgICAvLyBjb25zdCB0eSA9IC1yZWdpb24ueS5taW4gLSAoeVJhbmdlIC0geU1pbikgKiB5RmFjdG9yXG4gICAgLy8gY29uc3Qgc2V0VHJhbnNmb3JtID0gKCkgPT4ge1xuICAgIC8vICAgLy8gRGF0YSBjb29yZGluYXRlcyBhcmUgZmxpcHBlZCBhYm91dCB5LiBGbGlwIHRoZSBjb29yZGluYXRlcyBhbmRcbiAgICAvLyAgIC8vIHRyYW5zbGF0ZSB0b3AgbGVmdCBjb3JuZXIgdG8gY2FudmFzICgwLCAwKS5cbiAgICAvLyAgIGN0eC50cmFuc2Zvcm0oMSwgMCwgMCwgLTEsIC14TWluLCB5TWluKVxuICAgIC8vICAgLy8gU2NhbGUgdG8gZGF0YSBjb29yZGluYXRlcyBhbmQgc2hpZnQgaW50byBwbGFjZSBmb3IgdGhlIHJlZ2lvbidzIG9mZnNldFxuICAgIC8vICAgLy8gb24gdGhlIGNhbnZhcy5cbiAgICAvLyAgIGN0eC50cmFuc2Zvcm0oeEZhY3RvciwgMCwgMCwgeUZhY3RvciwgdHgsIHR5KVxuICAgIC8vIH1cbiAgICAvLyAvLyBkYXRhQ29vcmRzIGFsbG93cyBzb21lIGRyYXdpbmcgdG8gYmUgcGVyZm9ybWVkIGRpcmVjdGx5IGluIGRhdGFcbiAgICAvLyAvLyBjb29yZGluYXRlcy4gTW9zdCBhY3R1YWwgZHJhd2luZyBmdW5jdGlvbnMgbGlrZSBjdHguc3Ryb2tlIGFuZFxuICAgIC8vIC8vIGN0eC5maWxsUmVjdCBzaG91bGQgbm90IGJlIGNhbGxlZCBmcm9tIGluc2lkZSBkYXRhQ29vcmRzLCBidXRcbiAgICAvLyAvLyBjdHgubW92ZVRvIGFuZCBjdHguTGluZVRvIGFyZSBmaW5lLlxuICAgIC8vIHRvb2xzLmRhdGFDb29yZHMgPSBmID0+IHtcbiAgICAvLyAgIGN0eC5zYXZlKClcbiAgICAvLyAgIHNldFRyYW5zZm9ybSgpXG4gICAgLy8gICBmKClcbiAgICAvLyAgIGN0eC5yZXN0b3JlKClcbiAgICAvLyB9XG5cbiAgICBkcmF3RnVuYyh0aGlzLmNvbnRleHQsIHRvb2xzKVxuICAgIGN0eC5yZXN0b3JlKClcbiAgfVxufVxuXG4vKlxuICogbWFrZUxhYmVscyBhdHRlbXB0cyB0byBjcmVhdGUgdGhlIGFwcHJvcHJpYXRlIGxhYmVscyBmb3IgdGhlIHNwZWNpZmllZFxuICogc2NyZWVuIHNpemUsIGNvbnRleHQsIGFuZCBsYWJlbCBzcGFjaW5nLlxuICovXG5mdW5jdGlvbiBtYWtlTGFiZWxzIChcbiAgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsXG4gIHNjcmVlblc6IG51bWJlcixcbiAgbWluOiBudW1iZXIsXG4gIG1heDogbnVtYmVyLFxuICBzcGFjaW5nR3Vlc3M6IG51bWJlcixcbiAgc3RlcDogbnVtYmVyLFxuICB1bml0OiBzdHJpbmcsXG4gIHZhbEZtdD86ICh2OiBudW1iZXIpID0+IHN0cmluZ1xuKTogTGFiZWxTZXQge1xuICB2YWxGbXQgPSB2YWxGbXQgfHwgRG9jLmZvcm1hdEZvdXJTaWdGaWdzXG4gIGNvbnN0IG4gPSBzY3JlZW5XIC8gc3BhY2luZ0d1ZXNzXG4gIGNvbnN0IGRpZmYgPSBtYXggLSBtaW5cbiAgaWYgKG4gPCAxIHx8IGRpZmYgPD0gMCkgcmV0dXJuIHsgbGJsczogW10gfVxuICBjb25zdCB0aWNrR3Vlc3MgPSBkaWZmIC8gblxuICAvLyBtYWtlIHRoZSB0aWNrIHNwYWNpbmcgYSBtdWx0aXBsZSBvZiB0aGUgc3RlcFxuICBjb25zdCB0aWNrID0gdGlja0d1ZXNzICsgc3RlcCAtICh0aWNrR3Vlc3MgJSBzdGVwKVxuICBsZXQgeCA9IG1pbiArIHRpY2sgLSAobWluICUgdGljaylcbiAgY29uc3QgYWJzTWF4ID0gTWF0aC5tYXgoTWF0aC5hYnMobWF4KSwgTWF0aC5hYnMobWluKSlcbiAgLy8gVGhlIE1hdGgucm91bmQgcGFydCBpcyB0aGUgbWluaW11bSBwcmVjaXNpb24gcmVxdWlyZWQgdG8gc2VlIHRoZSBjaGFuZ2UgaW4gdGhlIG51bWJlcnMuXG4gIC8vIFRoZSAyIGFjY291bnRzIGZvciB0aGUgcHJlY2lzaW9uIG9mIHRoZSB0aWNrLlxuICBjb25zdCBzaWdGaWdzID0gTWF0aC5yb3VuZChNYXRoLmxvZzEwKGFic01heCAvIHRpY2spKSArIDJcbiAgY29uc3QgcHRzOiBMYWJlbFtdID0gW11cbiAgbGV0IHdpZGVzdCA9IDBcbiAgd2hpbGUgKHggPCBtYXgpIHtcbiAgICB4ID0gTnVtYmVyKHgudG9QcmVjaXNpb24oc2lnRmlncykpXG4gICAgY29uc3QgbGJsID0gdmFsRm10KHgpXG4gICAgd2lkZXN0ID0gTWF0aC5tYXgod2lkZXN0LCBjdHgubWVhc3VyZVRleHQobGJsKS53aWR0aClcbiAgICBwdHMucHVzaCh7XG4gICAgICB2YWw6IHgsXG4gICAgICB0eHQ6IGxibFxuICAgIH0pXG4gICAgeCArPSB0aWNrXG4gIH1cbiAgY29uc3QgdW5pdFcgPSBjdHgubWVhc3VyZVRleHQodW5pdCkud2lkdGhcbiAgaWYgKHVuaXRXID4gd2lkZXN0KSB3aWRlc3QgPSB1bml0V1xuICByZXR1cm4ge1xuICAgIHdpZGVzdDogd2lkZXN0LFxuICAgIGxibHM6IHB0c1xuICB9XG59XG5cbmNvbnN0IG1vbnRocyA9IFsnamFuJywgJ2ZlYicsICdtYXInLCAnYXByJywgJ21heScsICdqdW4nLCAnanVsJywgJ2F1ZycsICdzZXAnLCAnb2N0JywgJ25vdicsICdkZWMnXVxuXG4vKiBtYWtlQ2FuZGxlVGltZUxhYmVscyBwcmVwYXJlcyBsYWJlbHMgZm9yIGNhbmRsZXN0aWNrIGRhdGEuICovXG5mdW5jdGlvbiBtYWtlQ2FuZGxlVGltZUxhYmVscyAoY2FuZGxlczogQ2FuZGxlW10sIGR1cjogbnVtYmVyLCBzY3JlZW5XOiBudW1iZXIsIHNwYWNpbmdHdWVzczogbnVtYmVyKTogTGFiZWxTZXQge1xuICBjb25zdCBmaXJzdCA9IGNhbmRsZXNbMF1cbiAgY29uc3QgbGFzdCA9IGNhbmRsZXNbY2FuZGxlcy5sZW5ndGggLSAxXVxuICBjb25zdCBzdGFydCA9IHRydW5jYXRlKGZpcnN0LmVuZFN0YW1wLCBkdXIpXG4gIGNvbnN0IGVuZCA9IHRydW5jYXRlKGxhc3QuZW5kU3RhbXAsIGR1cikgKyBkdXJcbiAgY29uc3QgZGlmZiA9IGVuZCAtIHN0YXJ0XG4gIGNvbnN0IG4gPSBNYXRoLm1pbihjYW5kbGVzLmxlbmd0aCwgc2NyZWVuVyAvIHNwYWNpbmdHdWVzcylcbiAgY29uc3QgdGljayA9IHRydW5jYXRlKGRpZmYgLyBuLCBkdXIpXG4gIGlmICh0aWNrID09PSAwKSB7XG4gICAgY29uc29sZS5lcnJvcignemVybyB0aWNrJywgZHVyLCBkaWZmLCBuKSAvLyBwcm9iYWJseSB3b24ndCBoYXBwZW4sIGJ1dCBpdCdkIHN1Y2sgaWYgaXQgZGlkXG4gICAgcmV0dXJuIHsgbGJsczogW10gfVxuICB9XG4gIGxldCB4ID0gc3RhcnRcbiAgY29uc3Qgem9uZU9mZnNldCA9IG5ldyBEYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKVxuICBjb25zdCBkYXlTdGFtcCA9ICh4OiBudW1iZXIpID0+IHtcbiAgICB4ID0geCAtIHpvbmVPZmZzZXQgKiA2MDAwMFxuICAgIHJldHVybiB4IC0gKHggJSA4NjQwMDAwMClcbiAgfVxuICBsZXQgbGFzdERheSA9IGRheVN0YW1wKHN0YXJ0KVxuICBsZXQgbGFzdFllYXIgPSAwIC8vIG5ldyBEYXRlKHN0YXJ0KS5nZXRGdWxsWWVhcigpXG4gIGlmIChkYXlTdGFtcChmaXJzdC5lbmRTdGFtcCkgPT09IGRheVN0YW1wKGxhc3QuZW5kU3RhbXApKSBsYXN0RGF5ID0gMCAvLyBGb3JjZSBhdCBsZWFzdCBvbmUgZGF5IHN0YW1wLlxuICBjb25zdCBwdHMgPSBbXVxuICBsZXQgbGFiZWxcbiAgaWYgKGR1ciA8IDg2NDAwMDAwKSB7XG4gICAgbGFiZWwgPSAoZDogRGF0ZSwgeDogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBkYXkgPSBkYXlTdGFtcCh4KVxuICAgICAgaWYgKGRheSAhPT0gbGFzdERheSkgcmV0dXJuIGAke21vbnRoc1tkLmdldE1vbnRoKCldfSR7ZC5nZXREYXRlKCl9ICR7ZC5nZXRIb3VycygpfToke1N0cmluZyhkLmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwgJzAnKX1gXG4gICAgICBlbHNlIHJldHVybiBgJHtkLmdldEhvdXJzKCl9OiR7U3RyaW5nKGQuZ2V0TWludXRlcygpKS5wYWRTdGFydCgyLCAnMCcpfWBcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGFiZWwgPSAoZDogRGF0ZSkgPT4ge1xuICAgICAgY29uc3QgeWVhciA9IGQuZ2V0RnVsbFllYXIoKVxuICAgICAgaWYgKHllYXIgIT09IGxhc3RZZWFyKSByZXR1cm4gYCR7bW9udGhzW2QuZ2V0TW9udGgoKV19JHtkLmdldERhdGUoKX0gJyR7U3RyaW5nKHllYXIpLnNsaWNlKDIsIDQpfWBcbiAgICAgIGVsc2UgcmV0dXJuIGAke21vbnRoc1tkLmdldE1vbnRoKCldfSR7ZC5nZXREYXRlKCl9YFxuICAgIH1cbiAgfVxuICB3aGlsZSAoeCA8PSBlbmQpIHtcbiAgICBjb25zdCBkID0gbmV3IERhdGUoeClcbiAgICBwdHMucHVzaCh7XG4gICAgICB2YWw6IHgsXG4gICAgICB0eHQ6IGxhYmVsKGQsIHgpXG4gICAgfSlcbiAgICBsYXN0RGF5ID0gZGF5U3RhbXAoeClcbiAgICBsYXN0WWVhciA9IGQuZ2V0RnVsbFllYXIoKVxuICAgIHggKz0gdGlja1xuICB9XG4gIHJldHVybiB7IGxibHM6IHB0cyB9XG59XG5cbi8qIFRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuICovXG5mdW5jdGlvbiBsYXN0IChhcnI6IGFueVtdKTogYW55IHtcbiAgcmV0dXJuIGFyclthcnIubGVuZ3RoIC0gMV1cbn1cblxuLyogbGluZSBkcmF3cyBhIGxpbmUgd2l0aCB0aGUgcHJvdmlkZWQgY29udGV4dC4gKi9cbmZ1bmN0aW9uIGxpbmUgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB4MDogbnVtYmVyLCB5MDogbnVtYmVyLCB4MTogbnVtYmVyLCB5MTogbnVtYmVyLCBza2lwU3Ryb2tlPzogYm9vbGVhbikge1xuICBjdHguYmVnaW5QYXRoKClcbiAgY3R4Lm1vdmVUbyh4MCwgeTApXG4gIGN0eC5saW5lVG8oeDEsIHkxKVxuICBpZiAoIXNraXBTdHJva2UpIGN0eC5zdHJva2UoKVxufVxuXG4vKiBkb3QgZHJhd3MgYSBjaXJjbGUgd2l0aCB0aGUgcHJvdmlkZWQgY29udGV4dC4gKi9cbmZ1bmN0aW9uIGRvdCAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHg6IG51bWJlciwgeTogbnVtYmVyLCBjb2xvcjogc3RyaW5nLCByYWRpdXM6IG51bWJlcikge1xuICBjdHguZmlsbFN0eWxlID0gY29sb3JcbiAgY3R4LmJlZ2luUGF0aCgpXG4gIGN0eC5hcmMoeCwgeSwgcmFkaXVzLCAwLCBQSVBJKVxuICBjdHguZmlsbCgpXG59XG5cbi8qIGZsb2F0Q29tcGFyZSBjb21wYXJlcyB0d28gZmxvYXRzIHRvIHdpdGhpbiBhIHRvbGVyYW5jZSBvZiAgMWUtOC4gKi9cbmZ1bmN0aW9uIGZsb2F0Q29tcGFyZSAoYTogbnVtYmVyLCBiOiBudW1iZXIpIHtcbiAgcmV0dXJuIHdpdGhpblRvbGVyYW5jZShhLCBiLCAxZS04KVxufVxuXG4vKlxuICogd2l0aGluVG9sZXJhbmNlIHJldHVybnMgdHJ1ZSBpZiB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIGEgYW5kIGIgYXJlIHdpdGhcbiAqIHRoZSBzcGVjaWZpZWQgdG9sZXJhbmNlLlxuICovXG5mdW5jdGlvbiB3aXRoaW5Ub2xlcmFuY2UgKGE6IG51bWJlciwgYjogbnVtYmVyLCB0b2xlcmFuY2U6IG51bWJlcikge1xuICByZXR1cm4gTWF0aC5hYnMoYSAtIGIpIDwgTWF0aC5hYnModG9sZXJhbmNlKVxufVxuXG5mdW5jdGlvbiB0cnVuY2F0ZSAodjogbnVtYmVyLCB3OiBudW1iZXIpOiBudW1iZXIge1xuICByZXR1cm4gdiAtICh2ICUgdylcbn1cbiIsImltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnRcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuXG5leHBvcnQgY29uc3QgTWFpbm5ldCA9IDBcbmV4cG9ydCBjb25zdCBUZXN0bmV0ID0gMVxuZXhwb3J0IGNvbnN0IFNpbW5ldCA9IDJcblxuY29uc3QgY29pbklEVGFrZXJGb3VuZE1ha2VyUmVkZW1wdGlvbiA9ICdUYWtlckZvdW5kTWFrZXJSZWRlbXB0aW9uOidcblxuLyogZXRoQmFzZWRFeHBsb3JlckFyZyByZXR1cm5zIHRoZSBleHBsb3JlciBhcmd1bWVudCBmb3IgRVRILCBFUkMyMCBhbmQgRVZNXG5Db21wYXRpYmxlIGFzc2V0cyBhbmQgd2hldGhlciB0aGUgcmV0dXJuIHZhbHVlIGlzIGFuIGFkZHJlc3MuICovXG5mdW5jdGlvbiBldGhCYXNlZEV4cGxvcmVyQXJnIChjaWQ6IHN0cmluZyk6IFtzdHJpbmcsIGJvb2xlYW5dIHtcbiAgaWYgKGNpZC5zdGFydHNXaXRoKGNvaW5JRFRha2VyRm91bmRNYWtlclJlZGVtcHRpb24pKSByZXR1cm4gW2NpZC5zdWJzdHJpbmcoY29pbklEVGFrZXJGb3VuZE1ha2VyUmVkZW1wdGlvbi5sZW5ndGgpLCB0cnVlXVxuICBlbHNlIGlmIChjaWQubGVuZ3RoID09PSA0MikgcmV0dXJuIFtjaWQsIHRydWVdXG4gIGVsc2UgcmV0dXJuIFtjaWQsIGZhbHNlXVxufVxuXG5jb25zdCBldGhFeHBsb3JlcnM6IFJlY29yZDxudW1iZXIsIChjaWQ6IHN0cmluZykgPT4gc3RyaW5nPiA9IHtcbiAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBbYXJnLCBpc0FkZHJdID0gZXRoQmFzZWRFeHBsb3JlckFyZyhjaWQpXG4gICAgcmV0dXJuIGlzQWRkciA/IGBodHRwczovL2V0aGVyc2Nhbi5pby9hZGRyZXNzLyR7YXJnfWAgOiBgaHR0cHM6Ly9ldGhlcnNjYW4uaW8vdHgvJHthcmd9YFxuICB9LFxuICBbVGVzdG5ldF06IChjaWQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IFthcmcsIGlzQWRkcl0gPSBldGhCYXNlZEV4cGxvcmVyQXJnKGNpZClcbiAgICByZXR1cm4gaXNBZGRyID8gYGh0dHBzOi8vc2Vwb2xpYS5ldGhlcnNjYW4uaW8vYWRkcmVzcy8ke2FyZ31gIDogYGh0dHBzOi8vc2Vwb2xpYS5ldGhlcnNjYW4uaW8vdHgvJHthcmd9YFxuICB9LFxuICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgW2FyZywgaXNBZGRyXSA9IGV0aEJhc2VkRXhwbG9yZXJBcmcoY2lkKVxuICAgIHJldHVybiBpc0FkZHIgPyBgaHR0cHM6Ly9ldGhlcnNjYW4uaW8vYWRkcmVzcy8ke2FyZ31gIDogYGh0dHBzOi8vZXRoZXJzY2FuLmlvL3R4LyR7YXJnfWBcbiAgfVxufVxuXG5jb25zdCBwb2x5Z29uRXhwbG9yZXJzOiBSZWNvcmQ8bnVtYmVyLCAoY2lkOiBzdHJpbmcpID0+IHN0cmluZz4gPSB7XG4gIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgW2FyZywgaXNBZGRyXSA9IGV0aEJhc2VkRXhwbG9yZXJBcmcoY2lkKVxuICAgIHJldHVybiBpc0FkZHIgPyBgaHR0cHM6Ly9wb2x5Z29uc2Nhbi5jb20vYWRkcmVzcy8ke2FyZ31gIDogYGh0dHBzOi8vcG9seWdvbnNjYW4uY29tL3R4LyR7YXJnfWBcbiAgfSxcbiAgW1Rlc3RuZXRdOiAoY2lkOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBbYXJnLCBpc0FkZHJdID0gZXRoQmFzZWRFeHBsb3JlckFyZyhjaWQpXG4gICAgcmV0dXJuIGlzQWRkciA/IGBodHRwczovL2Ftb3kucG9seWdvbnNjYW4uY29tL2FkZHJlc3MvJHthcmd9YCA6IGBodHRwczovL2Ftb3kucG9seWdvbnNjYW4uY29tL3R4LyR7YXJnfWBcbiAgfSxcbiAgW1NpbW5ldF06IChjaWQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IFthcmcsIGlzQWRkcl0gPSBldGhCYXNlZEV4cGxvcmVyQXJnKGNpZClcbiAgICByZXR1cm4gaXNBZGRyID8gYGh0dHBzOi8vcG9seWdvbnNjYW4uY29tL2FkZHJlc3MvJHthcmd9YCA6IGBodHRwczovL3BvbHlnb25zY2FuLmNvbS90eC8ke2FyZ31gXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IENvaW5FeHBsb3JlcnM6IFJlY29yZDxudW1iZXIsIFJlY29yZDxudW1iZXIsIChjaWQ6IHN0cmluZykgPT4gc3RyaW5nPj4gPSB7XG4gIDQyOiB7IC8vIGRjclxuICAgIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBbdHhpZCwgdm91dF0gPSBjaWQuc3BsaXQoJzonKVxuICAgICAgaWYgKHZvdXQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGBodHRwczovL2V4cGxvcmVyLmRjcmRhdGEub3JnL3R4LyR7dHhpZH0vb3V0LyR7dm91dH1gXG4gICAgICByZXR1cm4gYGh0dHBzOi8vZXhwbG9yZXIuZGNyZGF0YS5vcmcvdHgvJHt0eGlkfWBcbiAgICB9LFxuICAgIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBbdHhpZCwgdm91dF0gPSBjaWQuc3BsaXQoJzonKVxuICAgICAgaWYgKHZvdXQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGBodHRwczovL3Rlc3RuZXQuZGNyZGF0YS5vcmcvdHgvJHt0eGlkfS9vdXQvJHt2b3V0fWBcbiAgICAgIHJldHVybiBgaHR0cHM6Ly90ZXN0bmV0LmRjcmRhdGEub3JnL3R4LyR7dHhpZH1gXG4gICAgfSxcbiAgICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBbdHhpZCwgdm91dF0gPSBjaWQuc3BsaXQoJzonKVxuICAgICAgaWYgKHZvdXQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGBodHRwOi8vMTI3LjAuMC4xOjE3Nzc5L3R4LyR7dHhpZH0vb3V0LyR7dm91dH1gXG4gICAgICByZXR1cm4gYGh0dHBzOi8vMTI3LjAuMC4xOjE3Nzc5L3R4LyR7dHhpZH1gXG4gICAgfVxuICB9LFxuICAwOiB7IC8vIGJ0Y1xuICAgIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9tZW1wb29sLnNwYWNlL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbVGVzdG5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vbWVtcG9vbC5zcGFjZS90ZXN0bmV0L3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9tZW1wb29sLnNwYWNlL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YFxuICB9LFxuICAyOiB7IC8vIGx0Y1xuICAgIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9sdGMuYml0YXBzLmNvbS8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1Rlc3RuZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL3NvY2hhaW4uY29tL3R4L0xUQ1RFU1QvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2x0Yy5iaXRhcHMuY29tLyR7Y2lkLnNwbGl0KCc6JylbMF19YFxuICB9LFxuICAyMDogeyAvLyBkZ2JcbiAgICBbTWFpbm5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vZGlnaWV4cGxvcmVyLmluZm8vdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly90ZXN0bmV0ZXhwbG9yZXIuZGlnaWJ5dGVzZXJ2ZXJzLmlvL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9kaWdpZXhwbG9yZXIuaW5mby90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWBcbiAgfSxcbiAgNjA6IGV0aEV4cGxvcmVycyxcbiAgNjAwMDE6IGV0aEV4cGxvcmVycyxcbiAgNjAwMDI6IGV0aEV4cGxvcmVycyxcbiAgMzogeyAvLyBkb2dlXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2RvZ2VibG9ja3MuY29tL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbVGVzdG5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vYmxvY2tleHBsb3Jlci5vbmUvZG9nZWNvaW4vdGVzdG5ldC90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1NpbW5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vZG9nZWJsb2Nrcy5jb20vdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gXG4gIH0sXG4gIDU6IHsgLy8gZGFzaFxuICAgIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9ibG9ja2V4cGxvcmVyLm9uZS9kYXNoL21haW5uZXQvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9ibG9ja2V4cGxvcmVyLm9uZS9kYXNoL3Rlc3RuZXQvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2Jsb2NrZXhwbG9yZXIub25lL2Rhc2gvbWFpbm5ldC90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWBcbiAgfSxcbiAgMTMzOiB7IC8vIHplY1xuICAgIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly96Y2FzaGJsb2NrZXhwbG9yZXIuY29tL3RyYW5zYWN0aW9ucy8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1Rlc3RuZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2Jsb2NrZXhwbG9yZXIub25lL3pjYXNoL3Rlc3RuZXQvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL3pjYXNoYmxvY2tleHBsb3Jlci5jb20vdHJhbnNhY3Rpb25zLyR7Y2lkLnNwbGl0KCc6JylbMF19YFxuICB9LFxuICAxNDc6IHsgLy8gemNsXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2V4cGxvcmVyLnpjbC56ZWxjb3JlLmlvL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9leHBsb3Jlci56Y2wuemVsY29yZS5pby90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWBcbiAgfSxcbiAgMTM2OiB7IC8vIGZpcm9cbiAgICBbTWFpbm5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vZXhwbG9yZXIuZmlyby5vcmcvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly90ZXN0ZXhwbG9yZXIuZmlyby5vcmcvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2V4cGxvcmVyLmZpcm8ub3JnL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YFxuICB9LFxuICAxNDU6IHsgLy8gYmNoXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2JjaC5sb3BpbmcubmV0L3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbVGVzdG5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vdGJjaDQubG9waW5nLm5ldC90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1NpbW5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vYmNoLmxvcGluZy5uZXQvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gXG4gIH0sXG4gIDk2NjogcG9seWdvbkV4cGxvcmVycyxcbiAgOTY2MDAxOiBwb2x5Z29uRXhwbG9yZXJzLFxuICA5NjYwMDI6IHBvbHlnb25FeHBsb3JlcnMsXG4gIDk2NjAwMzogcG9seWdvbkV4cGxvcmVycyxcbiAgOTY2MDA0OiBwb2x5Z29uRXhwbG9yZXJzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRDb2luSUQgKGNpZDogc3RyaW5nKSB7XG4gIGlmIChjaWQuc3RhcnRzV2l0aChjb2luSURUYWtlckZvdW5kTWFrZXJSZWRlbXB0aW9uKSkge1xuICAgIGNvbnN0IG1ha2VyQWRkciA9IGNpZC5zdWJzdHJpbmcoY29pbklEVGFrZXJGb3VuZE1ha2VyUmVkZW1wdGlvbi5sZW5ndGgpXG4gICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX1RBS0VSX0ZPVU5EX01BS0VSX1JFREVNUFRJT04sIHsgbWFrZXJBZGRyOiBtYWtlckFkZHIgfSlcbiAgfVxuICByZXR1cm4gY2lkXG59XG5cbi8qXG4gKiBiYXNlQ2hhaW5JRCByZXR1cm5zIHRoZSBhc3NldCBJRCBmb3IgdGhlIGFzc2V0J3MgcGFyZW50IGlmIHRoZSBhc3NldCBpcyBhXG4gKiB0b2tlbiwgb3RoZXJ3aXNlIHRoZSBJRCBmb3IgdGhlIGFzc2V0IGl0c2VsZi5cbiAqL1xuZnVuY3Rpb24gYmFzZUNoYWluSUQgKGFzc2V0SUQ6IG51bWJlcikge1xuICBjb25zdCBhc3NldCA9IGFwcCgpLnVzZXIuYXNzZXRzW2Fzc2V0SURdXG4gIHJldHVybiBhc3NldC50b2tlbiA/IGFzc2V0LnRva2VuLnBhcmVudElEIDogYXNzZXRJRFxufVxuXG4vKlxuICogc2V0Q29pbkhyZWYgc2V0cyB0aGUgaHlwZXJsaW5rIGVsZW1lbnQncyBocmVmIGF0dHJpYnV0ZSBiYXNlZCBvbiBwcm92aWRlZFxuICogYXNzZXRJRCBhbmQgZGF0YS1leHBsb3Jlci1jb2luIHZhbHVlIHByZXNlbnQgb24gc3VwcGxpZWQgbGluayBlbGVtZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0Q29pbkhyZWYgKGFzc2V0SUQ6IG51bWJlciwgbGluazogUGFnZUVsZW1lbnQpIHtcbiAgY29uc3QgbmV0ID0gYXBwKCkudXNlci5uZXRcbiAgY29uc3QgYXNzZXRFeHBsb3JlciA9IENvaW5FeHBsb3JlcnNbYmFzZUNoYWluSUQoYXNzZXRJRCldXG4gIGlmICghYXNzZXRFeHBsb3JlcikgcmV0dXJuXG4gIGNvbnN0IGZvcm1hdHRlciA9IGFzc2V0RXhwbG9yZXJbbmV0XVxuICBpZiAoIWZvcm1hdHRlcikgcmV0dXJuXG4gIGxpbmsuY2xhc3NMaXN0LnJlbW92ZSgncGxhaW5saW5rJylcbiAgbGluay5jbGFzc0xpc3QuYWRkKCdzdWJ0bGVsaW5rJylcbiAgbGluay5ocmVmID0gZm9ybWF0dGVyKGxpbmsuZGF0YXNldC5leHBsb3JlckNvaW4gfHwgJycpXG59XG4iLCJpbXBvcnQgRG9jLCB7IEFuaW1hdGlvbiwgQW5pVG9nZ2xlIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0ICogYXMgZm9ybXMgZnJvbSAnLi9mb3JtcydcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0IHsgUmVwdXRhdGlvbk1ldGVyLCBzdHJvbmdUaWVyIH0gZnJvbSAnLi9hY2NvdW50J1xuaW1wb3J0IHtcbiAgYXBwLFxuICBQYWdlRWxlbWVudCxcbiAgQ29ubmVjdGlvblN0YXR1cyxcbiAgRXhjaGFuZ2UsXG4gIFdhbGxldFN0YXRlLFxuICBQcmVwYWlkQm9uZElEXG59IGZyb20gJy4vcmVnaXN0cnknXG5cbmludGVyZmFjZSBBbmltYXRvciB7XG4gIGFuaW1hdGU6ICgoKSA9PiBQcm9taXNlPHZvaWQ+KVxufVxuXG5pbnRlcmZhY2UgQm9uZE9wdGlvbnNGb3JtIHtcbiAgaG9zdD86IHN0cmluZyAvLyBSZXF1aXJlZCwgYnV0IHNldCBieSB1cGRhdGVCb25kT3B0aW9uc1xuICBib25kQXNzZXRJRD86IG51bWJlclxuICB0YXJnZXRUaWVyPzogbnVtYmVyXG4gIHBlbmFsdHlDb21wcz86IG51bWJlclxufVxuXG5jb25zdCBhbmltYXRpb25MZW5ndGggPSAzMDBcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGV4U2V0dGluZ3NQYWdlIGV4dGVuZHMgQmFzZVBhZ2Uge1xuICBib2R5OiBIVE1MRWxlbWVudFxuICBmb3JtczogUGFnZUVsZW1lbnRbXVxuICBjdXJyZW50Rm9ybTogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGhvc3Q6IHN0cmluZ1xuICBhY2NvdW50RGlzYWJsZWQ6Ym9vbGVhblxuICBrZXl1cDogKGU6IEtleWJvYXJkRXZlbnQpID0+IHZvaWRcbiAgZGV4QWRkckZvcm06IGZvcm1zLkRFWEFkZHJlc3NGb3JtXG4gIGJvbmRGZWVCdWZmZXJDYWNoZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPlxuICBuZXdXYWxsZXRGb3JtOiBmb3Jtcy5OZXdXYWxsZXRGb3JtXG4gIHJlZ0Fzc2V0Rm9ybTogZm9ybXMuRmVlQXNzZXRTZWxlY3Rpb25Gb3JtXG4gIHdhbGxldFdhaXRGb3JtOiBmb3Jtcy5XYWxsZXRXYWl0Rm9ybVxuICBjb25maXJtUmVnaXN0ZXJGb3JtOiBmb3Jtcy5Db25maXJtUmVnaXN0cmF0aW9uRm9ybVxuICByZXB1dGF0aW9uTWV0ZXI6IFJlcHV0YXRpb25NZXRlclxuICBhbmltYXRpb246IEFuaW1hdGlvblxuICByZW5ld1RvZ2dsZTogQW5pVG9nZ2xlXG5cbiAgY29uc3RydWN0b3IgKGJvZHk6IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMuYm9keSA9IGJvZHlcbiAgICBjb25zdCBob3N0ID0gdGhpcy5ob3N0ID0gYm9keS5kYXRhc2V0Lmhvc3QgPyBib2R5LmRhdGFzZXQuaG9zdCA6ICcnXG4gICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbaG9zdF1cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoYm9keSlcbiAgICB0aGlzLmZvcm1zID0gRG9jLmFwcGx5U2VsZWN0b3IocGFnZS5mb3JtcywgJzpzY29wZSA+IGZvcm0nKVxuXG4gICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtID0gbmV3IGZvcm1zLkNvbmZpcm1SZWdpc3RyYXRpb25Gb3JtKHBhZ2UuY29uZmlybVJlZ0Zvcm0sIGFzeW5jICgpID0+IHtcbiAgICAgIHRoaXMuc2hvd1N1Y2Nlc3MoaW50bC5wcmVwKGludGwuSURfVFJBRElOR19USUVSX1VQREFURUQpKVxuICAgICAgdGhpcy5yZW5ld1RvZ2dsZS5zZXRTdGF0ZSh0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0udGllciA+IDApXG4gICAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgICAgYXBwKCkudXBkYXRlTWVudUl0ZW1zRGlzcGxheSgpXG4gICAgfSwgKCkgPT4ge1xuICAgICAgdGhpcy5ydW5BbmltYXRpb24odGhpcy5yZWdBc3NldEZvcm0sIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgIH0pXG4gICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnNldEV4Y2hhbmdlKHhjLCAnJylcblxuICAgIHRoaXMud2FsbGV0V2FpdEZvcm0gPSBuZXcgZm9ybXMuV2FsbGV0V2FpdEZvcm0ocGFnZS53YWxsZXRXYWl0LCAoKSA9PiB7XG4gICAgICB0aGlzLnJ1bkFuaW1hdGlvbih0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0sIHBhZ2UuY29uZmlybVJlZ0Zvcm0pXG4gICAgfSwgKCkgPT4ge1xuICAgICAgdGhpcy5ydW5BbmltYXRpb24odGhpcy5yZWdBc3NldEZvcm0sIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgIH0pXG4gICAgdGhpcy53YWxsZXRXYWl0Rm9ybS5zZXRFeGNoYW5nZSh4YylcblxuICAgIHRoaXMubmV3V2FsbGV0Rm9ybSA9IG5ldyBmb3Jtcy5OZXdXYWxsZXRGb3JtKFxuICAgICAgcGFnZS5uZXdXYWxsZXRGb3JtLFxuICAgICAgYXNzZXRJRCA9PiB0aGlzLm5ld1dhbGxldENyZWF0ZWQoYXNzZXRJRCwgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnRpZXIpLFxuICAgICAgKCkgPT4gdGhpcy5ydW5BbmltYXRpb24odGhpcy5yZWdBc3NldEZvcm0sIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgIClcblxuICAgIHRoaXMucmVnQXNzZXRGb3JtID0gbmV3IGZvcm1zLkZlZUFzc2V0U2VsZWN0aW9uRm9ybShwYWdlLnJlZ0Fzc2V0Rm9ybSwgYXN5bmMgKGFzc2V0SUQ6IG51bWJlciwgdGllcjogbnVtYmVyKSA9PiB7XG4gICAgICBpZiAoYXNzZXRJRCA9PT0gUHJlcGFpZEJvbmRJRCkge1xuICAgICAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgICAgICB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKVxuICAgICAgICB0aGlzLnNob3dTdWNjZXNzKGludGwucHJlcChpbnRsLklEX1RSQURJTkdfVElFUl9VUERBVEVEKSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgICAgY29uc3Qgd2FsbGV0ID0gYXNzZXQud2FsbGV0XG4gICAgICBpZiAod2FsbGV0KSB7XG4gICAgICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5yZWdBc3NldEZvcm0pXG4gICAgICAgIGNvbnN0IGJvbmRzRmVlQnVmZmVyID0gYXdhaXQgdGhpcy5nZXRCb25kc0ZlZUJ1ZmZlcihhc3NldElELCBwYWdlLnJlZ0Fzc2V0Rm9ybSlcbiAgICAgICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnNldEFzc2V0KGFzc2V0SUQsIHRpZXIsIGJvbmRzRmVlQnVmZmVyKVxuICAgICAgICBsb2FkZWQoKVxuICAgICAgICB0aGlzLnByb2dyZXNzVGllckZvcm1zV2l0aFdhbGxldChhc3NldElELCB3YWxsZXQpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnNldEFzc2V0KGFzc2V0SUQsIHRpZXIsIDApXG4gICAgICB0aGlzLm5ld1dhbGxldEZvcm0uc2V0QXNzZXQoYXNzZXRJRClcbiAgICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5uZXdXYWxsZXRGb3JtKVxuICAgIH0pXG4gICAgdGhpcy5yZWdBc3NldEZvcm0uc2V0RXhjaGFuZ2UoeGMsICcnKVxuXG4gICAgdGhpcy5yZXB1dGF0aW9uTWV0ZXIgPSBuZXcgUmVwdXRhdGlvbk1ldGVyKHBhZ2UucmVwTWV0ZXIpXG4gICAgdGhpcy5yZXB1dGF0aW9uTWV0ZXIuc2V0SG9zdChob3N0KVxuXG4gICAgRG9jLmJpbmQocGFnZS5leHBvcnREZXhCdG4sICdjbGljaycsICgpID0+IHRoaXMuZXhwb3J0QWNjb3VudCgpKVxuXG4gICAgdGhpcy5hY2NvdW50RGlzYWJsZWQgPSBib2R5LmRhdGFzZXQuZGlzYWJsZWQgPT09ICd0cnVlJ1xuICAgIERvYy5iaW5kKHBhZ2UudG9nZ2xlQWNjb3VudFN0YXR1c0J0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmFjY291bnREaXNhYmxlZCkgdGhpcy5wcmVwYXJlQWNjb3VudERpc2FibGUocGFnZS5kaXNhYmxlQWNjb3VudEZvcm0pXG4gICAgICBlbHNlIHRoaXMudG9nZ2xlQWNjb3VudFN0YXR1cyhmYWxzZSlcbiAgICB9KVxuICAgIERvYy5iaW5kKHBhZ2UudXBkYXRlQ2VydEJ0biwgJ2NsaWNrJywgKCkgPT4gcGFnZS5jZXJ0RmlsZUlucHV0LmNsaWNrKCkpXG4gICAgRG9jLmJpbmQocGFnZS51cGRhdGVIb3N0QnRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLnByZXBhcmVVcGRhdGVIb3N0KCkpXG4gICAgRG9jLmJpbmQocGFnZS5jZXJ0RmlsZUlucHV0LCAnY2hhbmdlJywgKCkgPT4gdGhpcy5vbkNlcnRGaWxlQ2hhbmdlKCkpXG4gICAgRG9jLmJpbmQocGFnZS5nb0JhY2tUb1NldHRpbmdzLCAnY2xpY2snLCAoKSA9PiBhcHAoKS5sb2FkUGFnZSgnc2V0dGluZ3MnKSlcblxuICAgIGNvbnN0IHNob3dUaWVyRm9ybSA9ICgpID0+IHtcbiAgICAgIHRoaXMucmVnQXNzZXRGb3JtLnNldEV4Y2hhbmdlKGFwcCgpLmV4Y2hhbmdlc1tob3N0XSwgJycpIC8vIHJlc2V0IGZvcm1cbiAgICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5yZWdBc3NldEZvcm0pXG4gICAgfVxuICAgIERvYy5iaW5kKHBhZ2UuY2hhbmdlVGllciwgJ2NsaWNrJywgKCkgPT4geyBzaG93VGllckZvcm0oKSB9KVxuICAgIGNvbnN0IHdpbGxBdXRvUmVuZXcgPSB4Yy5hdXRoLnRhcmdldFRpZXIgPiAwXG4gICAgdGhpcy5yZW5ld1RvZ2dsZSA9IG5ldyBBbmlUb2dnbGUocGFnZS50b2dnbGVBdXRvUmVuZXcsIHBhZ2UucmVuZXdFcnIsIHdpbGxBdXRvUmVuZXcsIGFzeW5jIChuZXdTdGF0ZTogYm9vbGVhbikgPT4ge1xuICAgICAgaWYgKHRoaXMuYWNjb3VudERpc2FibGVkKSByZXR1cm5cbiAgICAgIGlmIChuZXdTdGF0ZSkgc2hvd1RpZXJGb3JtKClcbiAgICAgIGVsc2UgcmV0dXJuIHRoaXMuZGlzYWJsZUF1dG9SZW5ldygpXG4gICAgfSlcbiAgICBEb2MuYmluZChwYWdlLmF1dG9SZW5ld0JveCwgJ2NsaWNrJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIGlmICghdGhpcy5hY2NvdW50RGlzYWJsZWQpIHBhZ2UudG9nZ2xlQXV0b1JlbmV3LmNsaWNrKClcbiAgICB9KVxuXG4gICAgcGFnZS5wZW5hbHR5Q29tcHMudGV4dENvbnRlbnQgPSBTdHJpbmcoeGMuYXV0aC5wZW5hbHR5Q29tcHMpXG4gICAgY29uc3QgaGlkZUNvbXBJbnB1dCA9ICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UucGVuYWx0eUNvbXBJbnB1dClcbiAgICAgIERvYy5zaG93KHBhZ2UucGVuYWx0eUNvbXBzKVxuICAgIH1cbiAgICBEb2MuYmluZChwYWdlLnBlbmFsdHlDb21wQm94LCAnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbdGhpcy5ob3N0XVxuICAgICAgcGFnZS5wZW5hbHR5Q29tcElucHV0LnZhbHVlID0gU3RyaW5nKHhjLmF1dGgucGVuYWx0eUNvbXBzKVxuICAgICAgRG9jLmhpZGUocGFnZS5wZW5hbHR5Q29tcHMpXG4gICAgICBEb2Muc2hvdyhwYWdlLnBlbmFsdHlDb21wSW5wdXQpXG4gICAgICBwYWdlLnBlbmFsdHlDb21wSW5wdXQuZm9jdXMoKVxuICAgICAgY29uc3QgY2hlY2tDbGljayA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChEb2MubW91c2VJbkVsZW1lbnQoZSwgcGFnZS5wZW5hbHR5Q29tcEJveCkpIHJldHVyblxuICAgICAgICBoaWRlQ29tcElucHV0KClcbiAgICAgICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ2NsaWNrJywgY2hlY2tDbGljaylcbiAgICAgIH1cbiAgICAgIERvYy5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjaGVja0NsaWNrKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLnBlbmFsdHlDb21wSW5wdXQsICdrZXl1cCcsIGFzeW5jIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLnBlbmFsdHlDb21wc0VycilcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgaGlkZUNvbXBJbnB1dCgpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgaWYgKCEoZS5rZXkgPT09ICdFbnRlcicpKSByZXR1cm5cbiAgICAgIGNvbnN0IHBlbmFsdHlDb21wcyA9IHBhcnNlSW50KHBhZ2UucGVuYWx0eUNvbXBJbnB1dC52YWx1ZSB8fCAnJylcbiAgICAgIGlmIChpc05hTihwZW5hbHR5Q29tcHMpKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UucGVuYWx0eUNvbXBzRXJyKVxuICAgICAgICBwYWdlLnBlbmFsdHlDb21wc0Vyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0lOVkFMSURfQ09NUFNfVkFMVUUpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLm90aGVyQm9uZFNldHRpbmdzKVxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVCb25kT3B0aW9ucyh7IHBlbmFsdHlDb21wcyB9KVxuICAgICAgICBsb2FkZWQoKVxuICAgICAgICBwYWdlLnBlbmFsdHlDb21wcy50ZXh0Q29udGVudCA9IFN0cmluZyhwZW5hbHR5Q29tcHMpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvYWRlZCgpXG4gICAgICAgIERvYy5zaG93KHBhZ2UucGVuYWx0eUNvbXBzRXJyKVxuICAgICAgICBwYWdlLnBlbmFsdHlDb21wc0Vyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FQSV9FUlJPUiwgeyBtc2c6IGUubXNnIH0pXG4gICAgICB9XG4gICAgICBoaWRlQ29tcElucHV0KClcbiAgICB9KVxuXG4gICAgdGhpcy5kZXhBZGRyRm9ybSA9IG5ldyBmb3Jtcy5ERVhBZGRyZXNzRm9ybShwYWdlLmRleEFkZHJGb3JtLCBhc3luYyAoeGM6IEV4Y2hhbmdlKSA9PiB7XG4gICAgICBhcHAoKS5sb2FkUGFnZShgL2RleHNldHRpbmdzLyR7eGMuaG9zdH1gKVxuICAgIH0sIHRoaXMuaG9zdClcblxuICAgIC8vIGZvcm1zLmJpbmQocGFnZS5ib25kRGV0YWlsc0Zvcm0sIHBhZ2UudXBkYXRlQm9uZE9wdGlvbnNDb25maXJtLCAoKSA9PiB0aGlzLnVwZGF0ZUJvbmRPcHRpb25zKCkpXG4gICAgZm9ybXMuYmluZChwYWdlLmRpc2FibGVBY2NvdW50Rm9ybSwgcGFnZS5kaXNhYmxlQWNjb3VudENvbmZpcm0sICgpID0+IHRoaXMudG9nZ2xlQWNjb3VudFN0YXR1cyh0cnVlKSlcblxuICAgIERvYy5iaW5kKHBhZ2UuZm9ybXMsICdtb3VzZWRvd24nLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKCFEb2MubW91c2VJbkVsZW1lbnQoZSwgdGhpcy5jdXJyZW50Rm9ybSkpIHsgdGhpcy5jbG9zZVBvcHVwcygpIH1cbiAgICB9KVxuXG4gICAgdGhpcy5rZXl1cCA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIHRoaXMuY2xvc2VQb3B1cHMoKVxuICAgICAgfVxuICAgIH1cbiAgICBEb2MuYmluZChkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5rZXl1cClcblxuICAgIERvYy5hcHBseVNlbGVjdG9yKHBhZ2UuZm9ybXMsICcuZm9ybS1jbG9zZXInKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIERvYy5iaW5kKGVsLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuY2xvc2VQb3B1cHMoKSB9KVxuICAgIH0pXG5cbiAgICBhcHAoKS5yZWdpc3Rlck5vdGVGZWVkZXIoe1xuICAgICAgY29ubjogKCkgPT4geyB0aGlzLnNldENvbm5lY3Rpb25TdGF0dXMoKSB9LFxuICAgICAgcmVwdXRhdGlvbjogKCkgPT4geyB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKSB9LFxuICAgICAgZmVlcGF5bWVudDogKCkgPT4geyB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKSB9LFxuICAgICAgYm9uZHBvc3Q6ICgpID0+IHsgdGhpcy51cGRhdGVSZXB1dGF0aW9uKCkgfVxuICAgIH0pXG5cbiAgICB0aGlzLnNldENvbm5lY3Rpb25TdGF0dXMoKVxuICAgIHRoaXMudXBkYXRlUmVwdXRhdGlvbigpXG4gIH1cblxuICB1bmxvYWQgKCkge1xuICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdrZXl1cCcsIHRoaXMua2V5dXApXG4gIH1cblxuICBhc3luYyBwcm9ncmVzc1RpZXJGb3Jtc1dpdGhXYWxsZXQgKGFzc2V0SUQ6IG51bWJlciwgd2FsbGV0OiBXYWxsZXRTdGF0ZSkge1xuICAgIGNvbnN0IHsgcGFnZSwgY29uZmlybVJlZ2lzdGVyRm9ybTogeyBmZWVzIH0gfSA9IHRoaXNcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHsgYm9uZEFzc2V0cyB9ID0gdGhpcy5yZWdBc3NldEZvcm0ueGNcbiAgICBjb25zdCBib25kQXNzZXQgPSBib25kQXNzZXRzW2Fzc2V0LnN5bWJvbF1cbiAgICBpZiAoIXdhbGxldC5vcGVuKSB7XG4gICAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuZm9ybXMpXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9vcGVud2FsbGV0JywgeyBhc3NldElEOiBhc3NldElEIH0pXG4gICAgICBsb2FkZWQoKVxuICAgICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgICAgdGhpcy5yZWdBc3NldEZvcm0uc2V0QXNzZXRFcnJvcihgZXJyb3IgdW5sb2NraW5nIHdhbGxldDogJHtyZXMubXNnfWApXG4gICAgICAgIHRoaXMucnVuQW5pbWF0aW9uKHRoaXMucmVnQXNzZXRGb3JtLCBwYWdlLnJlZ0Fzc2V0Rm9ybSlcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAod2FsbGV0LnN5bmNlZCAmJiB3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgPj0gMiAqIGJvbmRBc3NldC5hbW91bnQgKyBmZWVzKSB7XG4gICAgICAvLyBJZiB3ZSBhcmUgcmFpc2luZyBvdXIgdGllciwgd2UnbGwgc2hvdyBhIGNvbmZpcm1hdGlvbiBmb3JtXG4gICAgICB0aGlzLnByb2dyZXNzVGllckZvcm1XaXRoU3luY2VkRnVuZGVkV2FsbGV0KGFzc2V0SUQpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy53YWxsZXRXYWl0Rm9ybS5zZXRXYWxsZXQoYXNzZXRJRCwgZmVlcywgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnRpZXIpXG4gICAgdGhpcy5zaG93Rm9ybShwYWdlLndhbGxldFdhaXQpXG4gIH1cblxuICBhc3luYyBwcm9ncmVzc1RpZXJGb3JtV2l0aFN5bmNlZEZ1bmRlZFdhbGxldCAoYm9uZEFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHhjID0gYXBwKCkuZXhjaGFuZ2VzW3RoaXMuaG9zdF1cbiAgICBjb25zdCB0YXJnZXRUaWVyID0gdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnRpZXJcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3Qgc3Ryb25nVGllciA9IHhjLmF1dGgubGl2ZVN0cmVuZ3RoICsgeGMuYXV0aC5wZW5kaW5nU3RyZW5ndGggLSB4Yy5hdXRoLndlYWtTdHJlbmd0aFxuICAgIGlmICh0YXJnZXRUaWVyID4geGMuYXV0aC50YXJnZXRUaWVyICYmIHRhcmdldFRpZXIgPiBzdHJvbmdUaWVyKSB7XG4gICAgICB0aGlzLnJ1bkFuaW1hdGlvbih0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0sIHBhZ2UuY29uZmlybVJlZ0Zvcm0pXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgLy8gTG93ZXJpbmcgdGllclxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5ib2R5KVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnVwZGF0ZUJvbmRPcHRpb25zKHsgYm9uZEFzc2V0SUQsIHRhcmdldFRpZXIgfSlcbiAgICAgIGxvYWRlZCgpXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9hZGVkKClcbiAgICAgIHRoaXMucmVnQXNzZXRGb3JtLnNldFRpZXJFcnJvcihlLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyB0aGlzLmFuaW1hdGVDb25maXJtRm9ybShwYWdlLnJlZ0Fzc2V0Rm9ybSlcbiAgICB0aGlzLnNob3dTdWNjZXNzKGludGwucHJlcChpbnRsLklEX1RSQURJTkdfVElFUl9VUERBVEVEKSlcbiAgfVxuXG4gIHVwZGF0ZVJlcHV0YXRpb24gKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhdXRoID0gYXBwKCkuZXhjaGFuZ2VzW3RoaXMuaG9zdF0uYXV0aFxuICAgIGNvbnN0IHsgcmVwOiB7IHBlbmFsdGllcyB9LCB0YXJnZXRUaWVyLCBleHBpcmVkQm9uZHMgfSA9IGF1dGhcbiAgICBjb25zdCBkaXNwbGF5VGllciA9IHN0cm9uZ1RpZXIoYXV0aClcbiAgICBwYWdlLnRhcmdldFRpZXIudGV4dENvbnRlbnQgPSBTdHJpbmcodGFyZ2V0VGllcilcbiAgICBwYWdlLmVmZmVjdGl2ZVRpZXIudGV4dENvbnRlbnQgPSBTdHJpbmcoZGlzcGxheVRpZXIpXG4gICAgcGFnZS5wZW5hbHRpZXMudGV4dENvbnRlbnQgPSBTdHJpbmcocGVuYWx0aWVzKVxuICAgIHBhZ2UuYm9uZHNQZW5kaW5nUmVmdW5kLnRleHRDb250ZW50ID0gYCR7ZXhwaXJlZEJvbmRzPy5sZW5ndGggfHwgMH1gXG4gICAgdGhpcy5yZXB1dGF0aW9uTWV0ZXIudXBkYXRlKClcbiAgfVxuXG4gIC8qIHNob3dGb3JtIHNob3dzIGEgbW9kYWwgZm9ybSB3aXRoIGEgbGl0dGxlIGFuaW1hdGlvbi4gKi9cbiAgYXN5bmMgc2hvd0Zvcm0gKGZvcm06IEhUTUxFbGVtZW50KSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHRoaXMuY3VycmVudEZvcm0gPSBmb3JtXG4gICAgdGhpcy5mb3Jtcy5mb3JFYWNoKGZvcm0gPT4gRG9jLmhpZGUoZm9ybSkpXG4gICAgZm9ybS5zdHlsZS5yaWdodCA9ICcxMDAwMHB4J1xuICAgIERvYy5zaG93KHBhZ2UuZm9ybXMsIGZvcm0pXG4gICAgY29uc3Qgc2hpZnQgPSAocGFnZS5mb3Jtcy5vZmZzZXRXaWR0aCArIGZvcm0ub2Zmc2V0V2lkdGgpIC8gMlxuICAgIGF3YWl0IERvYy5hbmltYXRlKGFuaW1hdGlvbkxlbmd0aCwgcHJvZ3Jlc3MgPT4ge1xuICAgICAgZm9ybS5zdHlsZS5yaWdodCA9IGAkeygxIC0gcHJvZ3Jlc3MpICogc2hpZnR9cHhgXG4gICAgfSwgJ2Vhc2VPdXRIYXJkJylcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzAnXG4gIH1cblxuICBhc3luYyBydW5BbmltYXRpb24gKGFuaTogQW5pbWF0b3IsIGZvcm06IFBhZ2VFbGVtZW50KSB7XG4gICAgRG9jLmhpZGUodGhpcy5jdXJyZW50Rm9ybSlcbiAgICBhd2FpdCBhbmkuYW5pbWF0ZSgpXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IGZvcm1cbiAgICBEb2Muc2hvdyhmb3JtKVxuICB9XG5cbiAgY2xvc2VQb3B1cHMgKCkge1xuICAgIERvYy5oaWRlKHRoaXMucGFnZS5mb3JtcylcbiAgICBpZiAodGhpcy5hbmltYXRpb24pIHRoaXMuYW5pbWF0aW9uLnN0b3AoKVxuICB9XG5cbiAgYXN5bmMgc2hvd1N1Y2Nlc3MgKG1zZzogc3RyaW5nKSB7XG4gICAgdGhpcy5mb3Jtcy5mb3JFYWNoKGZvcm0gPT4gRG9jLmhpZGUoZm9ybSkpXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IHRoaXMucGFnZS5jaGVja21hcmtGb3JtXG4gICAgdGhpcy5hbmltYXRpb24gPSBmb3Jtcy5zaG93U3VjY2Vzcyh0aGlzLnBhZ2UsIG1zZylcbiAgICBhd2FpdCB0aGlzLmFuaW1hdGlvbi53YWl0KClcbiAgICB0aGlzLmFuaW1hdGlvbiA9IG5ldyBBbmltYXRpb24oMTUwMCwgKCkgPT4geyAvKiBwYXNzICovIH0sICcnLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50Rm9ybSA9PT0gdGhpcy5wYWdlLmNoZWNrbWFya0Zvcm0pIHRoaXMuY2xvc2VQb3B1cHMoKVxuICAgIH0pXG4gIH1cblxuICAvLyBleHBvcnRBY2NvdW50IGV4cG9ydHMgYW5kIGRvd25sb2FkcyB0aGUgYWNjb3VudCBpbmZvLlxuICBhc3luYyBleHBvcnRBY2NvdW50ICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGhvc3QgfSA9IHRoaXNcbiAgICBjb25zdCByZXEgPSB7IGhvc3QgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5ib2R5KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2V4cG9ydGFjY291bnQnLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5leHBvcnRBY2NvdW50RXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5leHBvcnRBY2NvdW50RXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHJlcy5hY2NvdW50LmJvbmRzID0gcmVzLmJvbmRzIC8vIG1haW50YWluIGJhY2t3YXJkIGNvbXBhdCBvZiBKU09OIGZpbGVcbiAgICBjb25zdCBhY2NvdW50Rm9yRXhwb3J0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXMuYWNjb3VudCkpXG4gICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxuICAgIGEuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsICdkY3JBY2NvdW50LScgKyBob3N0ICsgJy5qc29uJylcbiAgICBhLnNldEF0dHJpYnV0ZSgnaHJlZicsICdkYXRhOnRleHQvanNvbiwnICsgSlNPTi5zdHJpbmdpZnkoYWNjb3VudEZvckV4cG9ydCwgbnVsbCwgMikpXG4gICAgYS5jbGljaygpXG4gICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgfVxuXG4gIC8vIHRvZ2dsZUFjY291bnRTdGF0dXMgZW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgYWNjb3VudCBhc3NvY2lhdGVkIHdpdGggdGhlXG4gIC8vIHByb3ZpZGVkIGhvc3QuXG4gIGFzeW5jIHRvZ2dsZUFjY291bnRTdGF0dXMgKGRpc2FibGU6Ym9vbGVhbikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmVyck1zZylcbiAgICBsZXQgaG9zdDogc3RyaW5nfG51bGwgPSB0aGlzLmhvc3RcbiAgICBpZiAoZGlzYWJsZSkgaG9zdCA9IHBhZ2UuZGlzYWJsZUFjY291bnRIb3N0LnRleHRDb250ZW50XG4gICAgY29uc3QgcmVxID0geyBob3N0LCBkaXNhYmxlOiBkaXNhYmxlIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuYm9keSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS90b2dnbGVhY2NvdW50c3RhdHVzJywgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGlmIChkaXNhYmxlKSB7XG4gICAgICAgIHBhZ2UuZGlzYWJsZUFjY291bnRFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICAgIERvYy5zaG93KHBhZ2UuZGlzYWJsZUFjY291bnRFcnIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYWdlLmVyck1zZy50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgICAgRG9jLnNob3cocGFnZS5lcnJNc2cpXG4gICAgICB9XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKGRpc2FibGUpIHtcbiAgICAgIHRoaXMucGFnZS50b2dnbGVBY2NvdW50U3RhdHVzQnRuLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfRU5BQkxFX0FDQ09VTlQpXG4gICAgICBEb2MuaGlkZShwYWdlLmZvcm1zKVxuICAgIH0gZWxzZSB0aGlzLnBhZ2UudG9nZ2xlQWNjb3VudFN0YXR1c0J0bi50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0RJU0FCTEVfQUNDT1VOVClcblxuICAgIHRoaXMuYWNjb3VudERpc2FibGVkID0gZGlzYWJsZVxuXG4gICAgLy8gUmVmcmVzaCBleGNoYW5nZSBpbmZvcm1hdGlvbiBzaW5jZSB3ZSd2ZSBqdXN0IGVuYWJsZWQvZGlzYWJsZWQgdGhlXG4gICAgLy8gZXhjaGFuZ2UuXG4gICAgYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICBhcHAoKS5sb2FkUGFnZShgZGV4c2V0dGluZ3MvJHtob3N0fWApXG4gIH1cblxuICBhc3luYyBwcmVwYXJlQWNjb3VudERpc2FibGUgKGRpc2FibGVBY2NvdW50Rm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5kaXNhYmxlQWNjb3VudEhvc3QudGV4dENvbnRlbnQgPSB0aGlzLmhvc3RcbiAgICBwYWdlLmRpc2FibGVBY2NvdW50RXJyLnRleHRDb250ZW50ID0gJydcbiAgICB0aGlzLnNob3dGb3JtKGRpc2FibGVBY2NvdW50Rm9ybSlcbiAgfVxuXG4gIC8vIFJldHJpZXZlIGFuIGVzdGltYXRlIGZvciB0aGUgdHggZmVlIG5lZWRlZCB0byBjcmVhdGUgbmV3IGJvbmQgcmVzZXJ2ZXMuXG4gIGFzeW5jIGdldEJvbmRzRmVlQnVmZmVyIChhc3NldElEOiBudW1iZXIsIGZvcm06IEhUTUxFbGVtZW50KSB7XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhmb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2JvbmRzZmVlYnVmZmVyJywgeyBhc3NldElEIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcmV0dXJuIDBcbiAgICB9XG4gICAgcmV0dXJuIHJlcy5mZWVCdWZmZXJcbiAgfVxuXG4gIGFzeW5jIHByZXBhcmVVcGRhdGVIb3N0ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5kZXhBZGRyRm9ybS5yZWZyZXNoKClcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UuZGV4QWRkckZvcm0pXG4gIH1cblxuICBhc3luYyBvbkNlcnRGaWxlQ2hhbmdlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5lcnJNc2cpXG4gICAgY29uc3QgZmlsZXMgPSBwYWdlLmNlcnRGaWxlSW5wdXQuZmlsZXNcbiAgICBsZXQgY2VydFxuICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGgpIGNlcnQgPSBhd2FpdCBmaWxlc1swXS50ZXh0KClcbiAgICBpZiAoIWNlcnQpIHJldHVyblxuICAgIGNvbnN0IHJlcSA9IHsgaG9zdDogdGhpcy5ob3N0LCBjZXJ0OiBjZXJ0IH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuYm9keSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS91cGRhdGVjZXJ0JywgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UuZXJyTXNnLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5lcnJNc2cpXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudXBkYXRlQ2VydE1zZylcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4geyBEb2MuaGlkZShwYWdlLnVwZGF0ZUNlcnRNc2cpIH0sIDUwMDApXG4gICAgfVxuICB9XG5cbiAgc2V0Q29ubmVjdGlvblN0YXR1cyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGV4Y2hhbmdlID0gYXBwKCkudXNlci5leGNoYW5nZXNbdGhpcy5ob3N0XVxuICAgIGNvbnN0IGRpc3BsYXlJY29ucyA9IChjb25uZWN0ZWQ6IGJvb2xlYW4pID0+IHtcbiAgICAgIGlmIChjb25uZWN0ZWQpIHtcbiAgICAgICAgRG9jLmhpZGUocGFnZS5kaXNjb25uZWN0ZWRJY29uKVxuICAgICAgICBEb2Muc2hvdyhwYWdlLmNvbm5lY3RlZEljb24pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLmRpc2Nvbm5lY3RlZEljb24pXG4gICAgICAgIERvYy5oaWRlKHBhZ2UuY29ubmVjdGVkSWNvbilcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV4Y2hhbmdlKSB7XG4gICAgICBzd2l0Y2ggKGV4Y2hhbmdlLmNvbm5lY3Rpb25TdGF0dXMpIHtcbiAgICAgICAgY2FzZSBDb25uZWN0aW9uU3RhdHVzLkNvbm5lY3RlZDpcbiAgICAgICAgICBkaXNwbGF5SWNvbnModHJ1ZSlcbiAgICAgICAgICBwYWdlLmNvbm5lY3Rpb25TdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9DT05ORUNURUQpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBDb25uZWN0aW9uU3RhdHVzLkRpc2Nvbm5lY3RlZDpcbiAgICAgICAgICBkaXNwbGF5SWNvbnMoZmFsc2UpXG4gICAgICAgICAgaWYgKHRoaXMuYWNjb3VudERpc2FibGVkKSBwYWdlLmNvbm5lY3Rpb25TdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BQ0NPVU5UX0RJU0FCTEVEX01TRylcbiAgICAgICAgICBlbHNlIHBhZ2UuY29ubmVjdGlvblN0YXR1cy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0RJU0NPTk5FQ1RFRClcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIENvbm5lY3Rpb25TdGF0dXMuSW52YWxpZENlcnQ6XG4gICAgICAgICAgZGlzcGxheUljb25zKGZhbHNlKVxuICAgICAgICAgIHBhZ2UuY29ubmVjdGlvblN0YXR1cy50ZXh0Q29udGVudCA9IGAke2ludGwucHJlcChpbnRsLklEX0RJU0NPTk5FQ1RFRCl9IC0gJHtpbnRsLnByZXAoaW50bC5JRF9JTlZBTElEX0NFUlRJRklDQVRFKX1gXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZGlzYWJsZUF1dG9SZW5ldyAoKSB7XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLnBhZ2Uub3RoZXJCb25kU2V0dGluZ3MpXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMudXBkYXRlQm9uZE9wdGlvbnMoeyB0YXJnZXRUaWVyOiAwIH0pXG4gICAgICBsb2FkZWQoKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvYWRlZCgpXG4gICAgICB0aHJvdyBlXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlQm9uZE9wdGlvbnMgaXMgY2FsbGVkIHdoZW4gdGhlIGZvcm0gdG8gdXBkYXRlIGJvbmQgb3B0aW9ucyBpc1xuICAgKiBzdWJtaXR0ZWQuXG4gICAqL1xuICBhc3luYyB1cGRhdGVCb25kT3B0aW9ucyAoY29uZjogQm9uZE9wdGlvbnNGb3JtKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25mLmhvc3QgPSB0aGlzLmhvc3RcbiAgICBhd2FpdCBwb3N0SlNPTignL2FwaS91cGRhdGVib25kb3B0aW9ucycsIGNvbmYpXG4gICAgY29uc3QgdGFyZ2V0VGllciA9IGNvbmYudGFyZ2V0VGllciA/PyBhcHAoKS5leGNoYW5nZXNbdGhpcy5ob3N0XS5hdXRoLnRhcmdldFRpZXJcbiAgICB0aGlzLnJlbmV3VG9nZ2xlLnNldFN0YXRlKHRhcmdldFRpZXIgPiAwKVxuICB9XG5cbiAgYXN5bmMgbmV3V2FsbGV0Q3JlYXRlZCAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIpIHtcbiAgICB0aGlzLnJlZ0Fzc2V0Rm9ybS5yZWZyZXNoKClcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICBpZiAoIXVzZXIpIHJldHVyblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhc3NldCA9IHVzZXIuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3Qgd2FsbGV0ID0gYXNzZXQud2FsbGV0XG4gICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbdGhpcy5ob3N0XVxuICAgIGNvbnN0IGJvbmRBbXQgPSB4Yy5ib25kQXNzZXRzW2Fzc2V0LnN5bWJvbF0uYW1vdW50XG5cbiAgICBjb25zdCBib25kc0ZlZUJ1ZmZlciA9IGF3YWl0IHRoaXMuZ2V0Qm9uZHNGZWVCdWZmZXIoYXNzZXRJRCwgcGFnZS5uZXdXYWxsZXRGb3JtKVxuICAgIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS5zZXRGZWVzKGFzc2V0SUQsIGJvbmRzRmVlQnVmZmVyKVxuXG4gICAgaWYgKHdhbGxldC5zeW5jZWQgJiYgd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlID49IDIgKiBib25kQW10ICsgYm9uZHNGZWVCdWZmZXIpIHtcbiAgICAgIHRoaXMucHJvZ3Jlc3NUaWVyRm9ybVdpdGhTeW5jZWRGdW5kZWRXYWxsZXQoYXNzZXRJRClcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRoaXMud2FsbGV0V2FpdEZvcm0uc2V0V2FsbGV0KGFzc2V0SUQsIGJvbmRzRmVlQnVmZmVyLCB0aWVyKVxuICAgIGF3YWl0IHRoaXMuc2hvd0Zvcm0ocGFnZS53YWxsZXRXYWl0KVxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7XG4gIFVuaXRJbmZvLFxuICBMYXlvdXRNZXRyaWNzLFxuICBXYWxsZXRTdGF0ZSxcbiAgUGFnZUVsZW1lbnRcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuXG4vLyBTeW1ib2xpemVyIGlzIHNhdGlzZmllZCBieSBib3RoIGRleC5Bc3NldCBhbmQgY29yZS5TdXBwb3J0ZWRBc3NldC4gVXNlZCBieVxuLy8gRG9jLnN5bWJvbGl6ZS5cbmludGVyZmFjZSBTeW1ib2xpemVyIHtcbiAgc3ltYm9sOiBzdHJpbmdcbiAgdW5pdEluZm86IFVuaXRJbmZvXG59XG5cbmNvbnN0IHBhcnNlciA9IG5ldyB3aW5kb3cuRE9NUGFyc2VyKClcblxuY29uc3QgRlBTID0gMzBcblxuY29uc3QgQmlwSURzOiBSZWNvcmQ8bnVtYmVyLCBzdHJpbmc+ID0ge1xuICAwOiAnYnRjJyxcbiAgNDI6ICdkY3InLFxuICAyOiAnbHRjJyxcbiAgNTogJ2Rhc2gnLFxuICAyMDogJ2RnYicsXG4gIDIyOiAnbW9uYScsXG4gIDI4OiAndnRjJyxcbiAgMzogJ2RvZ2UnLFxuICAxNDU6ICdiY2gnLFxuICA2MDogJ2V0aCcsXG4gIDYwMDAxOiAndXNkYy5ldGgnLFxuICA2MDAwMjogJ3VzZHQuZXRoJyxcbiAgNjAwMDM6ICdtYXRpYy5ldGgnLFxuICAxMzY6ICdmaXJvJyxcbiAgMTMzOiAnemVjJyxcbiAgOTY2OiAncG9seWdvbicsXG4gIDk2NjAwMTogJ3VzZGMucG9seWdvbicsXG4gIDk2NjAwMjogJ3dldGgucG9seWdvbicsXG4gIDk2NjAwMzogJ3didGMucG9seWdvbicsXG4gIDk2NjAwNDogJ3VzZHQucG9seWdvbicsXG4gIDE0NzogJ3pjbCdcbn1cblxuY29uc3QgQmlwU3ltYm9sSURzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4oZnVuY3Rpb24gKCkge1xuICBmb3IgKGNvbnN0IGsgb2YgT2JqZWN0LmtleXMoQmlwSURzKSkge1xuICAgIEJpcFN5bWJvbElEc1tCaXBJRHNbcGFyc2VJbnQoayldXSA9IHBhcnNlSW50KGspXG4gIH1cbn0pKClcblxuY29uc3QgQmlwU3ltYm9scyA9IE9iamVjdC52YWx1ZXMoQmlwSURzKVxuXG5jb25zdCBSYXRlRW5jb2RpbmdGYWN0b3IgPSAxZTggLy8gc2FtZSBhcyB2YWx1ZSBkZWZpbmVkIGluIC4vb3JkZXJ1dGlsXG5cbmNvbnN0IGxvZzEwUmF0ZUVuY29kaW5nRmFjdG9yID0gTWF0aC5yb3VuZChNYXRoLmxvZzEwKFJhdGVFbmNvZGluZ0ZhY3RvcikpXG5cbmNvbnN0IGxhbmd1YWdlcyA9IG5hdmlnYXRvci5sYW5ndWFnZXMuZmlsdGVyKChsb2NhbGU6IHN0cmluZykgPT4gbG9jYWxlICE9PSAnYycpXG5cbmNvbnN0IGludEZvcm1hdHRlciA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChsYW5ndWFnZXMsIHsgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAwIH0pXG5cbmNvbnN0IGZvdXJTaWdGaWdzID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KGxhbmd1YWdlcywge1xuICBtaW5pbXVtU2lnbmlmaWNhbnREaWdpdHM6IDQsXG4gIG1heGltdW1TaWduaWZpY2FudERpZ2l0czogNFxufSlcblxuLyogQSBjYWNoZSBmb3IgZm9ybWF0dGVycyB1c2VkIGZvciBEb2MuZm9ybWF0Q29pblZhbHVlLiAqL1xuY29uc3QgZGVjaW1hbEZvcm1hdHRlcnM6IFJlY29yZDxudW1iZXIsIEludGwuTnVtYmVyRm9ybWF0PiA9IHt9XG5cbi8qXG4gKiBkZWNpbWFsRm9ybWF0dGVyIGdldHMgdGhlIGZvcm1hdENvaW5WYWx1ZSBmb3JtYXR0ZXIgZm9yIHRoZSBzcGVjaWZpZWQgZGVjaW1hbFxuICogcHJlY2lzaW9uLlxuICovXG5mdW5jdGlvbiBkZWNpbWFsRm9ybWF0dGVyIChwcmVjOiBudW1iZXIpIHtcbiAgcmV0dXJuIGZvcm1hdHRlcihkZWNpbWFsRm9ybWF0dGVycywgMiwgcHJlYylcbn1cblxuLyogQSBjYWNoZSBmb3IgZm9ybWF0dGVycyB1c2VkIGZvciBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbi4gKi9cbmNvbnN0IGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXJzOiBSZWNvcmQ8bnVtYmVyLCBJbnRsLk51bWJlckZvcm1hdD4gPSB7fVxuXG4vKlxuICogZnVsbFByZWNpc2lvbkZvcm1hdHRlciBnZXRzIHRoZSBmb3JtYXRGdWxsUHJlY2lzaW9uIGZvcm1hdHRlciBmb3IgdGhlXG4gKiBzcGVjaWZpZWQgZGVjaW1hbCBwcmVjaXNpb24uXG4gKi9cbmZ1bmN0aW9uIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXIgKHByZWM6IG51bWJlciwgbG9jYWxlcz86IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gIHJldHVybiBmb3JtYXR0ZXIoZnVsbFByZWNpc2lvbkZvcm1hdHRlcnMsIHByZWMsIHByZWMsIGxvY2FsZXMpXG59XG5cbi8qXG4gKiBmb3JtYXR0ZXIgZ2V0cyB0aGUgZm9ybWF0dGVyIGZyb20gdGhlIHN1cHBsaWVkIGNhY2hlIGlmIGl0IGFscmVhZHkgZXhpc3RzLFxuICogZWxzZSBjcmVhdGVzIGl0LlxuICovXG5mdW5jdGlvbiBmb3JtYXR0ZXIgKGZvcm1hdHRlcnM6IFJlY29yZDxzdHJpbmcsIEludGwuTnVtYmVyRm9ybWF0PiwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyLCBsb2NhbGVzPzogc3RyaW5nIHwgc3RyaW5nW10pOiBJbnRsLk51bWJlckZvcm1hdCB7XG4gIGNvbnN0IGsgPSBgJHttaW59LSR7bWF4fWBcbiAgbGV0IGZtdCA9IGZvcm1hdHRlcnNba11cbiAgaWYgKCFmbXQpIHtcbiAgICBmbXQgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQobG9jYWxlcyA/PyBsYW5ndWFnZXMsIHtcbiAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogbWluLFxuICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiBtYXhcbiAgICB9KVxuICAgIGZvcm1hdHRlcnNba10gPSBmbXRcbiAgfVxuICByZXR1cm4gZm10XG59XG5cbi8qXG4gKiBjb252ZXJ0VG9Db252ZW50aW9uYWwgY29udmVydHMgdGhlIHZhbHVlIGluIGF0b21pYyB1bml0cyB0byBjb252ZW50aW9uYWxcbiAqIHVuaXRzLlxuICovXG5mdW5jdGlvbiBjb252ZXJ0VG9Db252ZW50aW9uYWwgKHY6IG51bWJlciwgdW5pdEluZm8/OiBVbml0SW5mbykge1xuICBsZXQgcHJlYyA9IDhcbiAgaWYgKHVuaXRJbmZvKSB7XG4gICAgY29uc3QgZiA9IHVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgdiAvPSBmXG4gICAgcHJlYyA9IE1hdGgucm91bmQoTWF0aC5sb2cxMChmKSlcbiAgfVxuICByZXR1cm4gW3YsIHByZWNdXG59XG5cbi8qXG4gKiBiZXN0RGlzcGxheU9yZGVyIGlzIHVzZWQgaW4gYmVzdENvbnZlcnNpb24sIGFuZCBpcyB0aGUgb3JkZXIgb2YgbWFnbml0dWRlXG4gKiB0aGF0IGlzIGNvbnNpZGVyZWQgdGhlIGJlc3QgZm9yIGRpc3BsYXkuIEZvciBleGFtcGxlLCBpZiBiZXN0RGlzcGxheU9yZGVyIGlzXG4gKiAxLCBhbmQgdGhlIGNob2ljZXMgZm9yIGRpc3BsYXkgYXJlIDEsMDAwIEJUQyBvciAwLjAwMDAxIFNhdHMsIHRoZSBhbGdvcml0aG1cbiAqIHdpbGwgbG9vayBhdCB0aGUgb3JkZXJzIG9mIHRoZSBjb252ZXJzaW9ucywgMTAwMCA9PiAxMF4zID0+IG9yZGVyIDMsIGFuZFxuICogMC4wMDAwMSA9PiAxMF4tNSA9PiBvcmRlciA1LCBhbmQgc2VlIHdoaWNoIGlzIGNsb3Nlc3QgdG8gYmVzdERpc3BsYXlPcmRlciBhbmRcbiAqIGNob29zZSB0aGF0IGNvbnZlcnNpb24uIEluIHRoZSBleGFtcGxlLCAzIC0gYmVzdERpc3BsYXlPcmRlciA9IDIgYW5kXG4gKiAxIC0gKC01KSA9IDYsIHNvIHRoZSBjb252ZXJzaW9uIHRoYXQgaGFzIHRoZSBvcmRlciBjbG9zZXN0IHRvXG4gKiBiZXN0RGlzcGxheU9yZGVyIGlzIHRoZSBmaXJzdCBvbmUsIDEsMDAwIEJUQy5cbiAqL1xuY29uc3QgYmVzdERpc3BsYXlPcmRlciA9IDEgLy8gMTBeMSA9PiAxXG5cbi8qXG4gKiByZXNvbHZlVW5pdENvbnZlcnNpb25zIGNyZWF0ZXMgYSBsb29rdXAgb2JqZWN0IG1hcHBpbmcgdW5pdCAtPiBjb252ZXJzaW9uXG4gKiBmYWN0b3IuIEJ5IGRlZmF1bHQsIHJlc29sdmVVbml0Q29udmVyc2lvbnMgb25seSBtYXBzIHRoZSBhdG9taWMgYW5kXG4gKiBjb252ZW50aW9uYWwgdW5pdHMuIElmIGEgcHJlZnMgZGljdCBpcyBwcm92aWRlZCwgYWRkaXRpb25hbCB1bml0cyBjYW4gYmVcbiAqIGluY2x1ZGVkLlxuICovXG5mdW5jdGlvbiByZXNvbHZlVW5pdENvbnZlcnNpb25zICh1aTogVW5pdEluZm8sIHByZWZzPzogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4pOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+IHtcbiAgY29uc3QgdW5pdEZhY3RvcnM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgW3VpLmF0b21pY1VuaXRdOiAxLFxuICAgIFt1aS5jb252ZW50aW9uYWwudW5pdF06IHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gIH1cbiAgaWYgKHVpLmRlbm9taW5hdGlvbnMgJiYgcHJlZnMpIHtcbiAgICBmb3IgKGNvbnN0IGFsdCBvZiB1aS5kZW5vbWluYXRpb25zKSBpZiAocHJlZnNbYWx0LnVuaXRdKSB1bml0RmFjdG9yc1thbHQudW5pdF0gPSBhbHQuY29udmVyc2lvbkZhY3RvclxuICB9XG4gIHJldHVybiB1bml0RmFjdG9yc1xufVxuXG4vLyBIZWxwZXJzIGZvciB3b3JraW5nIHdpdGggdGhlIERPTS5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERvYyB7XG4gIC8qXG4gICAqIGlkZWwgaXMgdGhlIGVsZW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIGlkIHRoYXQgaXMgdGhlIGRlc2NlbmRlbnQgb2YgdGhlXG4gICAqIHNwZWNpZmllZCBub2RlLlxuICAgKi9cbiAgc3RhdGljIGlkZWwgKGVsOiBEb2N1bWVudCB8IEVsZW1lbnQsIGlkOiBzdHJpbmcpOiBIVE1MRWxlbWVudCB7XG4gICAgcmV0dXJuIGVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lkfWApIGFzIEhUTUxFbGVtZW50XG4gIH1cblxuICAvKiBiaW5kIGJpbmRzIHRoZSBmdW5jdGlvbiB0byB0aGUgZXZlbnQgZm9yIHRoZSBlbGVtZW50LiAqL1xuICBzdGF0aWMgYmluZCAoZWw6IEV2ZW50VGFyZ2V0LCBldjogc3RyaW5nIHwgc3RyaW5nW10sIGY6IEV2ZW50TGlzdGVuZXJPckV2ZW50TGlzdGVuZXJPYmplY3QsIG9wdHM/OiBhbnkgLyogRXZlbnRMaXN0ZW5lck9wdGlvbnMgKi8pOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgKEFycmF5LmlzQXJyYXkoZXYpID8gZXYgOiBbZXZdKSkgZWwuYWRkRXZlbnRMaXN0ZW5lcihlLCBmLCBvcHRzKVxuICB9XG5cbiAgLyogdW5iaW5kIHJlbW92ZXMgdGhlIGhhbmRsZXIgZm9yIHRoZSBldmVudCBmcm9tIHRoZSBlbGVtZW50LiAqL1xuICBzdGF0aWMgdW5iaW5kIChlbDogRXZlbnRUYXJnZXQsIGV2OiBzdHJpbmcsIGY6IChlOiBFdmVudCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXYsIGYpXG4gIH1cblxuICAvKiBub2Rlcml6ZSBjcmVhdGVzIGEgRG9jdW1lbnQgb2JqZWN0IGZyb20gYSBzdHJpbmcgb2YgSFRNTC4gKi9cbiAgc3RhdGljIG5vZGVyaXplIChodG1sOiBzdHJpbmcpOiBEb2N1bWVudCB7XG4gICAgcmV0dXJuIHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaHRtbCwgJ3RleHQvaHRtbCcpXG4gIH1cblxuICAvKlxuICAgKiBtb3VzZUluRWxlbWVudCByZXR1cm5zIHRydWUgaWYgdGhlIHBvc2l0aW9uIG9mIG1vdXNlIGV2ZW50LCBlLCBpcyB3aXRoaW5cbiAgICogdGhlIGJvdW5kcyBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgb3IgYW55IG9mIGl0cyBkZXNjZW5kZW50cy5cbiAgICovXG4gIHN0YXRpYyBtb3VzZUluRWxlbWVudCAoZTogTW91c2VFdmVudCwgZWw6IEhUTUxFbGVtZW50KTogYm9vbGVhbiB7XG4gICAgaWYgKGVsLmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpKSByZXR1cm4gdHJ1ZVxuICAgIGNvbnN0IHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIHJldHVybiBlLnBhZ2VYID49IHJlY3QubGVmdCAmJiBlLnBhZ2VYIDw9IHJlY3QucmlnaHQgJiZcbiAgICAgIGUucGFnZVkgPj0gcmVjdC50b3AgJiYgZS5wYWdlWSA8PSByZWN0LmJvdHRvbVxuICB9XG5cbiAgLypcbiAgICogbGF5b3V0TWV0cmljcyBnZXRzIGluZm9ybWF0aW9uIGFib3V0IHRoZSBlbGVtZW50cyBwb3NpdGlvbiBvbiB0aGUgcGFnZS5cbiAgICovXG4gIHN0YXRpYyBsYXlvdXRNZXRyaWNzIChlbDogSFRNTEVsZW1lbnQpOiBMYXlvdXRNZXRyaWNzIHtcbiAgICBjb25zdCBib3ggPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIGNvbnN0IGRvY0VsID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50XG4gICAgY29uc3QgdG9wID0gYm94LnRvcCArIGRvY0VsLnNjcm9sbFRvcFxuICAgIGNvbnN0IGxlZnQgPSBib3gubGVmdCArIGRvY0VsLnNjcm9sbExlZnRcbiAgICBjb25zdCB3ID0gZWwub2Zmc2V0V2lkdGhcbiAgICBjb25zdCBoID0gZWwub2Zmc2V0SGVpZ2h0XG4gICAgcmV0dXJuIHtcbiAgICAgIGJvZHlUb3A6IHRvcCxcbiAgICAgIGJvZHlMZWZ0OiBsZWZ0LFxuICAgICAgd2lkdGg6IHcsXG4gICAgICBoZWlnaHQ6IGgsXG4gICAgICBjZW50ZXJYOiBsZWZ0ICsgdyAvIDIsXG4gICAgICBjZW50ZXJZOiB0b3AgKyBoIC8gMlxuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBkZXNjZW5kZW50TWV0cmljcyAocGFyZW50OiBQYWdlRWxlbWVudCwga2lkOiBQYWdlRWxlbWVudCk6IExheW91dE1ldHJpY3Mge1xuICAgIGNvbnN0IHBhcmVudE1ldHJpY3MgPSBEb2MubGF5b3V0TWV0cmljcyhwYXJlbnQpXG4gICAgY29uc3Qga2lkTWV0cmljcyA9IERvYy5sYXlvdXRNZXRyaWNzKGtpZClcbiAgICByZXR1cm4ge1xuICAgICAgYm9keVRvcDoga2lkTWV0cmljcy5ib2R5VG9wIC0gcGFyZW50TWV0cmljcy5ib2R5VG9wLFxuICAgICAgYm9keUxlZnQ6IGtpZE1ldHJpY3MuYm9keUxlZnQgLSBwYXJlbnRNZXRyaWNzLmJvZHlMZWZ0LFxuICAgICAgd2lkdGg6IGtpZE1ldHJpY3Mud2lkdGgsXG4gICAgICBoZWlnaHQ6IGtpZE1ldHJpY3MuaGVpZ2h0LFxuICAgICAgY2VudGVyWDoga2lkTWV0cmljcy5jZW50ZXJYIC0gcGFyZW50TWV0cmljcy5ib2R5TGVmdCxcbiAgICAgIGNlbnRlclk6IGtpZE1ldHJpY3MuY2VudGVyWSAtIHBhcmVudE1ldHJpY3MuYm9keVRvcFxuICAgIH1cbiAgfVxuXG4gIC8qIGVtcHR5IHJlbW92ZXMgYWxsIGNoaWxkIG5vZGVzIGZyb20gdGhlIHNwZWNpZmllZCBlbGVtZW50LiAqL1xuICBzdGF0aWMgZW1wdHkgKC4uLmVsczogRWxlbWVudFtdKSB7XG4gICAgZm9yIChjb25zdCBlbCBvZiBlbHMpIHdoaWxlIChlbC5maXJzdENoaWxkKSBlbC5yZW1vdmVDaGlsZChlbC5maXJzdENoaWxkKVxuICB9XG5cbiAgLypcbiAgICogc2V0Q29udGVudCByZW1vdmVzIGFsbCBjaGlsZCBub2RlcyBmcm9tIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBhbmQgYXBwZW5kc1xuICAgKiBwYXNzZWQgZWxlbWVudHMuXG4gICAqL1xuICBzdGF0aWMgc2V0Q29udGVudCAoYW5jZXN0b3I6IFBhZ2VFbGVtZW50LCAuLi5raWRzOiBQYWdlRWxlbWVudFtdKSB7XG4gICAgRG9jLmVtcHR5KGFuY2VzdG9yKVxuICAgIGZvciAoY29uc3QgayBvZiBraWRzKSBhbmNlc3Rvci5hcHBlbmRDaGlsZChrKVxuICB9XG5cbiAgLypcbiAgICogaGlkZSBoaWRlcyB0aGUgc3BlY2lmaWVkIGVsZW1lbnRzLiBUaGlzIGlzIGFjY29tcGxpc2hlZCBieSBhZGRpbmcgdGhlXG4gICAqIGJvb3RzdHJhcCBkLWhpZGUgY2xhc3MgdG8gdGhlIGVsZW1lbnQuIFVzZSBEb2Muc2hvdyB0byB1bmRvLlxuICAgKi9cbiAgc3RhdGljIGhpZGUgKC4uLmVsczogRWxlbWVudFtdKSB7XG4gICAgZm9yIChjb25zdCBlbCBvZiBlbHMpIGVsLmNsYXNzTGlzdC5hZGQoJ2QtaGlkZScpXG4gIH1cblxuICAvKlxuICAgKiBzaG93IHNob3dzIHRoZSBzcGVjaWZpZWQgZWxlbWVudHMuIFRoaXMgaXMgYWNjb21wbGlzaGVkIGJ5IHJlbW92aW5nIHRoZVxuICAgKiBib290c3RyYXAgZC1oaWRlIGNsYXNzIGFzIGFkZGVkIHdpdGggRG9jLmhpZGUuXG4gICAqL1xuICBzdGF0aWMgc2hvdyAoLi4uZWxzOiBFbGVtZW50W10pIHtcbiAgICBmb3IgKGNvbnN0IGVsIG9mIGVscykgZWwuY2xhc3NMaXN0LnJlbW92ZSgnZC1oaWRlJylcbiAgfVxuXG4gIC8qXG4gICAqIHNob3cgb3IgaGlkZSB0aGUgc3BlY2lmaWVkIGVsZW1lbnRzLCBiYXNlZCBvbiB2YWx1ZSBvZiB0aGUgdHJ1dGhpbmVzcyBvZlxuICAgKiB2aXMuXG4gICAqL1xuICBzdGF0aWMgc2V0VmlzICh2aXM6IGFueSwgLi4uZWxzOiBFbGVtZW50W10pIHtcbiAgICBpZiAodmlzKSBEb2Muc2hvdyguLi5lbHMpXG4gICAgZWxzZSBEb2MuaGlkZSguLi5lbHMpXG4gIH1cblxuICAvKiBpc0hpZGRlbiByZXR1cm5zIHRydWUgaWYgdGhlIHNwZWNpZmllZCBlbGVtZW50IGlzIGhpZGRlbiAqL1xuICBzdGF0aWMgaXNIaWRkZW4gKGVsOiBFbGVtZW50KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGVsLmNsYXNzTGlzdC5jb250YWlucygnZC1oaWRlJylcbiAgfVxuXG4gIC8qIGlzRGlzcGxheWVkIHJldHVybnMgdHJ1ZSBpZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgaXMgbm90IGhpZGRlbiAqL1xuICBzdGF0aWMgaXNEaXNwbGF5ZWQgKGVsOiBFbGVtZW50KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICFlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2QtaGlkZScpXG4gIH1cblxuICAvKlxuICAgKiBhbmltYXRlIHJ1bnMgdGhlIHN1cHBsaWVkIGZ1bmN0aW9uLCB3aGljaCBzaG91bGQgYmUgYSBcInByb2dyZXNzXCIgZnVuY3Rpb25cbiAgICogYWNjZXB0aW5nIG9uZSBhcmd1bWVudC4gVGhlIHByb2dyZXNzIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIHJlcGVhdGVkbHlcbiAgICogd2l0aCB0aGUgYXJndW1lbnQgdmFyeWluZyBmcm9tIDAuMCB0byAxLjAuIFRoZSBleGFjdCBwYXRoIHRoYXQgYW5pbWF0ZVxuICAgKiB0YWtlcyBmcm9tIDAuMCB0byAxLjAgd2lsbCB2YXJ5IGRlcGVuZGluZyBvbiB0aGUgY2hvaWNlIG9mIGVhc2luZ1xuICAgKiBhbGdvcml0aG0uIFNlZSB0aGUgRWFzaW5nIG9iamVjdCBmb3IgdGhlIGF2YWlsYWJsZSBlYXNpbmcgYWxnbyBjaG9pY2VzLiBUaGVcbiAgICogZGVmYXVsdCBlYXNpbmcgYWxnb3JpdGhtIGlzIGxpbmVhci5cbiAgICovXG4gIHN0YXRpYyBhc3luYyBhbmltYXRlIChkdXJhdGlvbjogbnVtYmVyLCBmOiAocHJvZ3Jlc3M6IG51bWJlcikgPT4gdm9pZCwgZWFzaW5nQWxnbz86IHN0cmluZykge1xuICAgIGF3YWl0IG5ldyBBbmltYXRpb24oZHVyYXRpb24sIGYsIGVhc2luZ0FsZ28pLndhaXQoKVxuICB9XG5cbiAgc3RhdGljIGFzeW5jIGJsaW5rIChlbDogUGFnZUVsZW1lbnQpIHtcbiAgICBjb25zdCBbciwgZywgYl0gPSBTdGF0ZS5pc0RhcmsoKSA/IFsyNTUsIDI1NSwgMjU1XSA6IFswLCAwLCAwXVxuICAgIGNvbnN0IGN5Y2xlcyA9IDJcbiAgICBEb2MuYW5pbWF0ZSgxMDAwLCAocDogbnVtYmVyKSA9PiB7XG4gICAgICBlbC5zdHlsZS5vdXRsaW5lID0gYDJweCBzb2xpZCByZ2JhKCR7cn0sICR7Z30sICR7Yn0sICR7KGN5Y2xlcyAtIHAgKiBjeWNsZXMpICUgMX0pYFxuICAgIH0pXG4gIH1cblxuICBzdGF0aWMgYXBwbHlTZWxlY3RvciAoYW5jZXN0b3I6IEhUTUxFbGVtZW50LCBrOiBzdHJpbmcpOiBQYWdlRWxlbWVudFtdIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShhbmNlc3Rvci5xdWVyeVNlbGVjdG9yQWxsKGspKSBhcyBQYWdlRWxlbWVudFtdXG4gIH1cblxuICBzdGF0aWMga2lkcyAoYW5jZXN0b3I6IEhUTUxFbGVtZW50KTogUGFnZUVsZW1lbnRbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oYW5jZXN0b3IuY2hpbGRyZW4pIGFzIFBhZ2VFbGVtZW50W11cbiAgfVxuXG4gIHN0YXRpYyBzYWZlU2VsZWN0b3IgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCwgazogc3RyaW5nKTogUGFnZUVsZW1lbnQge1xuICAgIGNvbnN0IGVsID0gYW5jZXN0b3IucXVlcnlTZWxlY3RvcihrKVxuICAgIGlmIChlbCkgcmV0dXJuIGVsIGFzIFBhZ2VFbGVtZW50XG4gICAgY29uc29sZS53YXJuKGBubyBlbGVtZW50IGZvdW5kIGZvciBzZWxlY3RvciAnJHtrfScgb24gZWxlbWVudCAtPmAsIGFuY2VzdG9yKVxuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICB9XG5cbiAgLypcbiAgICogaWREZXNjZW5kYW50cyBjcmVhdGVzIGFuIG9iamVjdCBtYXBwaW5nIHRvIGVsZW1lbnRzIHdoaWNoIGFyZSBkZXNjZW5kYW50c1xuICAgKiBvZiB0aGUgYW5jZXN0b3IgYW5kIGhhdmUgaWQgYXR0cmlidXRlcy4gRWxlbWVudHMgYXJlIGtleWVkIGJ5IHRoZWlyIGlkXG4gICAqIHZhbHVlLlxuICAgKi9cbiAgc3RhdGljIGlkRGVzY2VuZGFudHMgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCk6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PiB7XG4gICAgY29uc3QgZDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+ID0ge31cbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2lkXScpKSBkW2VsLmlkXSA9IGVsXG4gICAgcmV0dXJuIGRcbiAgfVxuXG4gIC8qXG4gICAqIGZvcm1hdENvaW5WYWx1ZSBmb3JtYXRzIHRoZSB2YWx1ZSBpbiBhdG9taWMgdW5pdHMgaW50byBhIHN0cmluZ1xuICAgKiByZXByZXNlbnRhdGlvbiBpbiBjb252ZW50aW9uYWwgdW5pdHMuIElmIHRoZSB2YWx1ZSBoYXBwZW5zIHRvIGJlIGFuXG4gICAqIGludGVnZXIsIG5vIGRlY2ltYWxzIGFyZSBkaXNwbGF5ZWQuIFRyYWlsaW5nIHplcm9zIG1heSBiZSB0cnVuY2F0ZWQuXG4gICAqL1xuICBzdGF0aWMgZm9ybWF0Q29pblZhbHVlICh2QXRvbWljOiBudW1iZXIsIHVuaXRJbmZvPzogVW5pdEluZm8pOiBzdHJpbmcge1xuICAgIGNvbnN0IFt2LCBwcmVjXSA9IGNvbnZlcnRUb0NvbnZlbnRpb25hbCh2QXRvbWljLCB1bml0SW5mbylcbiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih2KSkgcmV0dXJuIGludEZvcm1hdHRlci5mb3JtYXQodilcbiAgICByZXR1cm4gZGVjaW1hbEZvcm1hdHRlcihwcmVjKS5mb3JtYXQodilcbiAgfVxuXG4gIHN0YXRpYyBjb252ZW50aW9uYWxDb2luVmFsdWUgKHZBdG9taWM6IG51bWJlciwgdW5pdEluZm8/OiBVbml0SW5mbyk6IG51bWJlciB7XG4gICAgY29uc3QgW3ZdID0gY29udmVydFRvQ29udmVudGlvbmFsKHZBdG9taWMsIHVuaXRJbmZvKVxuICAgIHJldHVybiB2XG4gIH1cblxuICAvKlxuICAgKiBmb3JtYXRSYXRlRnVsbFByZWNpc2lvbiBmb3JtYXRzIHJhdGUgdG8gcmVwcmVzZW50IGl0IGV4YWN0bHkgYXQgcmF0ZSBzdGVwXG4gICAqIHByZWNpc2lvbiwgdHJpbW1pbmcgbm9uLWVmZmVjdHVhbCB6ZXJvcyBpZiB0aGVyZSBhcmUgYW55LlxuICAgKi9cbiAgc3RhdGljIGZvcm1hdFJhdGVGdWxsUHJlY2lzaW9uIChlbmNSYXRlOiBudW1iZXIsIGJ1aTogVW5pdEluZm8sIHF1aTogVW5pdEluZm8sIHJhdGVTdGVwRW5jOiBudW1iZXIpIHtcbiAgICBjb25zdCByID0gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yIC8gcXVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgY29uc3QgY29udlJhdGUgPSBlbmNSYXRlICogciAvIFJhdGVFbmNvZGluZ0ZhY3RvclxuICAgIGNvbnN0IHJhdGVTdGVwRGlnaXRzID0gbG9nMTBSYXRlRW5jb2RpbmdGYWN0b3IgLSBNYXRoLmZsb29yKE1hdGgubG9nMTAocmF0ZVN0ZXBFbmMpKSAtXG4gICAgICBNYXRoLmZsb29yKE1hdGgubG9nMTAoYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKSAtIE1hdGgubG9nMTAocXVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKSlcbiAgICBpZiAocmF0ZVN0ZXBEaWdpdHMgPD0gMCkgcmV0dXJuIGludEZvcm1hdHRlci5mb3JtYXQoY29udlJhdGUpXG4gICAgcmV0dXJuIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXIocmF0ZVN0ZXBEaWdpdHMpLmZvcm1hdChjb252UmF0ZSlcbiAgfVxuXG4gIHN0YXRpYyBmb3JtYXRGb3VyU2lnRmlncyAobjogbnVtYmVyLCBtYXhEZWNpbWFscz86IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIGZvcm1hdFNpZ0ZpZ3NXaXRoRm9ybWF0dGVycyhpbnRGb3JtYXR0ZXIsIGZvdXJTaWdGaWdzLCBuLCBtYXhEZWNpbWFscylcbiAgfVxuXG4gIHN0YXRpYyBmb3JtYXRJbnQgKGk6IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIGludEZvcm1hdHRlci5mb3JtYXQoaSlcbiAgfVxuXG4gIC8qXG4gICAqIGZvcm1hdEZ1bGxQcmVjaXNpb24gZm9ybWF0cyB0aGUgdmFsdWUgaW4gYXRvbWljIHVuaXRzIGludG8gYSBzdHJpbmdcbiAgICogcmVwcmVzZW50YXRpb24gaW4gY29udmVudGlvbmFsIHVuaXRzIHVzaW5nIHRoZSBmdWxsIGRlY2ltYWwgcHJlY2lzaW9uXG4gICAqIGFzc29jaWF0ZWQgd2l0aCB0aGUgY29udmVudGlvbmFsIHVuaXQncyBjb252ZXJzaW9uIGZhY3Rvci5cbiAgICovXG4gIHN0YXRpYyBmb3JtYXRGdWxsUHJlY2lzaW9uICh2QXRvbWljOiBudW1iZXIsIHVuaXRJbmZvPzogVW5pdEluZm8pOiBzdHJpbmcge1xuICAgIGNvbnN0IFt2LCBwcmVjXSA9IGNvbnZlcnRUb0NvbnZlbnRpb25hbCh2QXRvbWljLCB1bml0SW5mbylcbiAgICByZXR1cm4gZnVsbFByZWNpc2lvbkZvcm1hdHRlcihwcmVjKS5mb3JtYXQodilcbiAgfVxuXG4gIC8qXG4gICAqIGZvcm1hdEZpYXRDb252ZXJzaW9uIGZvcm1hdHMgdGhlIHZhbHVlIGluIGF0b21pYyB1bml0cyB0byBpdHMgcmVwcmVzZW50YXRpb24gaW5cbiAgICogY29udmVudGlvbmFsIHVuaXRzIGFuZCByZXR1cm5zIHRoZSBmaWF0IHZhbHVlIGFzIGEgc3RyaW5nLlxuICAgKi9cbiAgc3RhdGljIGZvcm1hdEZpYXRDb252ZXJzaW9uICh2QXRvbWljOiBudW1iZXIsIHJhdGU6IG51bWJlciwgdW5pdEluZm8/OiBVbml0SW5mbyk6IHN0cmluZyB7XG4gICAgaWYgKCFyYXRlIHx8IHJhdGUgPT09IDApIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9VTkFWQUlMQUJMRSlcbiAgICBjb25zdCBwcmVjID0gMlxuICAgIGNvbnN0IFt2XSA9IGNvbnZlcnRUb0NvbnZlbnRpb25hbCh2QXRvbWljLCB1bml0SW5mbylcbiAgICBjb25zdCB2YWx1ZSA9IHYgKiByYXRlXG4gICAgcmV0dXJuIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXIocHJlYykuZm9ybWF0KHZhbHVlKVxuICB9XG5cbiAgc3RhdGljIGxhbmd1YWdlcyAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBsYW5ndWFnZXNcbiAgfVxuXG4gIHN0YXRpYyBmb3JtYXRGaWF0VmFsdWUgKHZhbHVlOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyKDIpLmZvcm1hdCh2YWx1ZSlcbiAgfVxuXG4gIC8qXG4gICAqIGJlc3RDb252ZXJzaW9uIHBpY2tzIHRoZSBiZXN0IGNvbnZlcnNpb24gZmFjdG9yIGZvciB0aGUgYXRvbWljIHZhbHVlLiBUaGVcbiAgICogYmVzdCBpcyB0aGUgb25lIGluIHdoaWNoIGxvZzEwKGNvbnZlcnRlZF92YWx1ZSkgaXMgY2xvc2VzdCB0b1xuICAgKiBiZXN0RGlzcGxheU9yZGVyLiBSZXR1cm46IFtjb252ZXJ0ZWRfdmFsdWUsIHByZWNpc2lvbiwgdW5pdF0uXG4gICAqL1xuICBzdGF0aWMgYmVzdENvbnZlcnNpb24gKGF0b21zOiBudW1iZXIsIHVpOiBVbml0SW5mbywgcHJlZnM/OiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPik6IFtudW1iZXIsIG51bWJlciwgc3RyaW5nXSB7XG4gICAgY29uc3QgdW5pdEZhY3RvcnMgPSByZXNvbHZlVW5pdENvbnZlcnNpb25zKHVpLCBwcmVmcylcbiAgICBjb25zdCBsb2dEaWZmczogW3N0cmluZywgbnVtYmVyXVtdID0gW11cbiAgICBjb25zdCBlbnRyeURpZmYgPSAoZW50cnk6IFtzdHJpbmcsIG51bWJlcl0pID0+IE1hdGguYWJzKE1hdGgubG9nMTAoYXRvbXMgLyBlbnRyeVsxXSkgLSBiZXN0RGlzcGxheU9yZGVyKVxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgT2JqZWN0LmVudHJpZXModW5pdEZhY3RvcnMpKSBsb2dEaWZmcy5wdXNoKFtlbnRyeVswXSwgZW50cnlEaWZmKGVudHJ5KV0pXG4gICAgY29uc3QgYmVzdCA9IGxvZ0RpZmZzLnJlZHVjZSgoYmVzdDogW3N0cmluZywgbnVtYmVyXSwgZW50cnk6IFtzdHJpbmcsIG51bWJlcl0pID0+IGVudHJ5WzFdIDwgYmVzdFsxXSA/IGVudHJ5IDogYmVzdClcbiAgICBjb25zdCB1bml0ID0gYmVzdFswXVxuICAgIGNvbnN0IGNGYWN0b3IgPSB1bml0RmFjdG9yc1t1bml0XVxuICAgIGNvbnN0IHYgPSBhdG9tcyAvIGNGYWN0b3JcbiAgICByZXR1cm4gW3YsIE1hdGgucm91bmQoTWF0aC5sb2cxMChjRmFjdG9yKSksIHVuaXRdXG4gIH1cblxuICAvKlxuICAgKiBmb3JtYXRCZXN0VW5pdHNGdWxsUHJlY2lzaW9uIGZvcm1hdHMgdGhlIHZhbHVlIHdpdGggdGhlIGJlc3QgY2hvaWNlIG9mXG4gICAqIHVuaXRzLCBhdCBmdWxsIHByZWNpc2lvbi5cbiAgICovXG4gIHN0YXRpYyBmb3JtYXRCZXN0VW5pdHNGdWxsUHJlY2lzaW9uIChhdG9tczogbnVtYmVyLCB1aTogVW5pdEluZm8sIHByZWZzPzogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4pOiBbc3RyaW5nLCBzdHJpbmddIHtcbiAgICBjb25zdCBbdiwgcHJlYywgdW5pdF0gPSB0aGlzLmJlc3RDb252ZXJzaW9uKGF0b21zLCB1aSwgcHJlZnMpXG4gICAgaWYgKE51bWJlci5pc0ludGVnZXIodikpIHJldHVybiBbaW50Rm9ybWF0dGVyLmZvcm1hdCh2KSwgdW5pdF1cbiAgICByZXR1cm4gW2Z1bGxQcmVjaXNpb25Gb3JtYXR0ZXIocHJlYykuZm9ybWF0KHYpLCB1bml0XVxuICB9XG5cbiAgLypcbiAgICogZm9ybWF0QmVzdFVuaXRzRm91clNpZ0ZpZ3MgZm9ybWF0cyB0aGUgdmFsdWUgd2l0aCB0aGUgYmVzdCBjaG9pY2Ugb2ZcbiAgICogdW5pdHMgYW5kIHJvdW5kZWQgdG8gZm91ciBzaWduaWZpY2FudCBmaWd1cmVzLlxuICAgKi9cbiAgc3RhdGljIGZvcm1hdEJlc3RVbml0c0ZvdXJTaWdGaWdzIChhdG9tczogbnVtYmVyLCB1aTogVW5pdEluZm8sIHByZWZzPzogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4pOiBbc3RyaW5nLCBzdHJpbmddIHtcbiAgICBjb25zdCBbdiwgcHJlYywgdW5pdF0gPSB0aGlzLmJlc3RDb252ZXJzaW9uKGF0b21zLCB1aSwgcHJlZnMpXG4gICAgcmV0dXJuIFtEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModiwgcHJlYyksIHVuaXRdXG4gIH1cblxuICAvKlxuICAgKiBmb3JtYXRCZXN0UmF0ZUVsZW1lbnQgZm9ybWF0cyBhIHJhdGUgdXNpbmcgdGhlIGJlc3QgYXZhaWxhYmxlIHVuaXRzIGFuZFxuICAgKiB1cGRhdGVzIHRoZSBVSSBlbGVtZW50LiBUaGUgYW5jZXN0b3Igc2hvdWxkIGhhdmUgZGVzY2VuZGVudHMgd2l0aCBkYXRhXG4gICAqIGF0dHJpYnV0ZXMgW2Jlc3QtdmFsdWUsIGRhdGEtdW5pdCwgZGF0YS11bml0LWJveCwgZGF0YS1kZW5vbV0uXG4gICAqL1xuICBzdGF0aWMgZm9ybWF0QmVzdFJhdGVFbGVtZW50IChhbmNlc3RvcjogUGFnZUVsZW1lbnQsIGFzc2V0SUQ6IG51bWJlciwgYXRvbXM6IG51bWJlciwgdWk6IFVuaXRJbmZvLCBwcmVmcz86IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+KSB7XG4gICAgRG9jLmZvcm1hdEJlc3RWYWx1ZUVsZW1lbnQoYW5jZXN0b3IsIGFzc2V0SUQsIGF0b21zLCB1aSwgcHJlZnMpXG4gICAgRG9jLnNldFRleHQoYW5jZXN0b3IsICdbZGF0YS1kZW5vbV0nLCB1aS5mZWVSYXRlRGVub20pXG4gIH1cblxuICAvKlxuICAgKiBmb3JtYXRCZXN0UmF0ZUVsZW1lbnQgZm9ybWF0cyBhIHZhbHVlIHVzaW5nIHRoZSBiZXN0IGF2YWlsYWJsZSB1bml0cyBhbmRcbiAgICogdXBkYXRlcyB0aGUgVUkgZWxlbWVudC4gVGhlIGFuY2VzdG9yIHNob3VsZCBoYXZlIGRlc2NlbmRlbnRzIHdpdGggZGF0YVxuICAgKiBhdHRyaWJ1dGVzIFtiZXN0LXZhbHVlLCBkYXRhLXVuaXQsIGRhdGEtdW5pdC1ib3hdLlxuICAgKi9cbiAgc3RhdGljIGZvcm1hdEJlc3RWYWx1ZUVsZW1lbnQgKGFuY2VzdG9yOiBQYWdlRWxlbWVudCwgYXNzZXRJRDogbnVtYmVyLCBhdG9tczogbnVtYmVyLCB1aTogVW5pdEluZm8sIHByZWZzPzogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4pIHtcbiAgICBjb25zdCBbdiwgdW5pdF0gPSB0aGlzLmZvcm1hdEJlc3RVbml0c0ZvdXJTaWdGaWdzKGF0b21zLCB1aSwgcHJlZnMpXG4gICAgRG9jLnNldFRleHQoYW5jZXN0b3IsICdbZGF0YS12YWx1ZV0nLCB2KVxuICAgIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtdW5pdF0nLCB1bml0KVxuICAgIGNvbnN0IHNwYW4gPSBEb2Muc2FmZVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtdW5pdC1ib3hdJylcbiAgICBzcGFuLmRhdGFzZXQuYXRvbXMgPSBTdHJpbmcoYXRvbXMpXG4gICAgc3Bhbi5kYXRhc2V0LmFzc2V0SUQgPSBTdHJpbmcoYXNzZXRJRClcbiAgfVxuXG4gIHN0YXRpYyBjb252ZW50aW9uYWxSYXRlU3RlcCAocmF0ZVN0ZXBFbmM6IG51bWJlciwgYmFzZVVuaXRJbmZvOiBVbml0SW5mbywgcXVvdGVVbml0SW5mbzogVW5pdEluZm8pIHtcbiAgICBjb25zdCBbcUZhY3RvciwgYkZhY3Rvcl0gPSBbcXVvdGVVbml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciwgYmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXVxuICAgIHJldHVybiByYXRlU3RlcEVuYyAvIFJhdGVFbmNvZGluZ0ZhY3RvciAqIChiRmFjdG9yIC8gcUZhY3RvcilcbiAgfVxuXG4gIC8qXG4gICAqIGxvZ29QYXRoIGNyZWF0ZXMgYSBwYXRoIHRvIGEgcG5nIGxvZ28gZm9yIHRoZSBzcGVjaWZpZWQgdGlja2VyIHN5bWJvbC4gSWZcbiAgICogdGhlIHN5bWJvbCBpcyBub3QgYSBzdXBwb3J0ZWQgYXNzZXQsIHRoZSBnZW5lcmljIGxldHRlciBsb2dvIHdpbGwgYmVcbiAgICogcmVxdWVzdGVkIGluc3RlYWQuXG4gICAqL1xuICBzdGF0aWMgbG9nb1BhdGggKHN5bWJvbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoQmlwU3ltYm9scy5pbmRleE9mKHN5bWJvbCkgPT09IC0xKSBzeW1ib2wgPSBzeW1ib2wuc3Vic3RyaW5nKDAsIDEpXG4gICAgc3ltYm9sID0gc3ltYm9sLnNwbGl0KCcuJylbMF0gLy8gZS5nLiB1c2RjLmV0aCA9PiB1c2RjXG4gICAgcmV0dXJuIGAvaW1nL2NvaW5zLyR7c3ltYm9sfS5wbmdgXG4gIH1cblxuICBzdGF0aWMgYmlwU3ltYm9sIChhc3NldElEOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBCaXBJRHNbYXNzZXRJRF1cbiAgfVxuXG4gIHN0YXRpYyBiaXBJREZyb21TeW1ib2wgKHN5bWJvbDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICByZXR1cm4gQmlwU3ltYm9sSURzW3N5bWJvbF1cbiAgfVxuXG4gIHN0YXRpYyBiaXBDRVhTeW1ib2wgKGFzc2V0SUQ6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgYmlwU3ltYm9sID0gQmlwSURzW2Fzc2V0SURdXG4gICAgaWYgKCFiaXBTeW1ib2wgfHwgYmlwU3ltYm9sID09PSAnJykgcmV0dXJuICcnXG4gICAgY29uc3QgcGFydHMgPSBiaXBTeW1ib2wuc3BsaXQoJy4nKVxuICAgIGlmIChwYXJ0c1swXSA9PT0gJ3dldGgnKSByZXR1cm4gJ2V0aCdcbiAgICByZXR1cm4gcGFydHNbMF1cbiAgfVxuXG4gIHN0YXRpYyBsb2dvUGF0aEZyb21JRCAoYXNzZXRJRDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gRG9jLmxvZ29QYXRoKEJpcElEc1thc3NldElEXSlcbiAgfVxuXG4gIC8qXG4gICAqIHN5bWJvbGl6ZSBjcmVhdGVzIGEgdG9rZW4tYXdhcmUgc3ltYm9sIGVsZW1lbnQgZm9yIHRoZSBhc3NldCdzIHN5bWJvbC4gRm9yXG4gICAqIG5vbi10b2tlbiBhc3NldHMsIHRoaXMgaXMgc2ltcGx5IGEgPHNwYW4+U1lNQk9MPC9zcGFuPi4gRm9yIHRva2VucywgaXQnbGxcbiAgICogYmUgPHNwYW4+PHNwYW4+U1lNQk9MPC9zcGFuPjxzdXA+UEFSRU5UPC9zdXA+PC9zcGFuPi5cbiAgICovXG4gIHN0YXRpYyBzeW1ib2xpemUgKGFzc2V0OiBTeW1ib2xpemVyLCB1c2VMb2dvPzogYm9vbGVhbik6IFBhZ2VFbGVtZW50IHtcbiAgICBjb25zdCB0aWNrZXIgPSBhc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgIGNvbnN0IHN5bWJvbFNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBzeW1ib2xTcGFuLnRleHRDb250ZW50ID0gdGlja2VyLnRvVXBwZXJDYXNlKClcbiAgICBjb25zdCBwYXJ0cyA9IGFzc2V0LnN5bWJvbC5zcGxpdCgnLicpXG4gICAgY29uc3QgaXNUb2tlbiA9IHBhcnRzLmxlbmd0aCA9PT0gMlxuICAgIGlmICghaXNUb2tlbikgcmV0dXJuIHN5bWJvbFNwYW5cbiAgICBjb25zdCBwYXJlbnRTeW1ib2wgPSBwYXJ0c1sxXVxuICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICBzcGFuLmFwcGVuZENoaWxkKHN5bWJvbFNwYW4pXG4gICAgaWYgKHVzZUxvZ28pIHtcbiAgICAgIGNvbnN0IHBhcmVudExvZ28gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxuICAgICAgcGFyZW50TG9nby5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50U3ltYm9sKVxuICAgICAgcGFyZW50TG9nby5jbGFzc0xpc3QuYWRkKCd0b2tlbi1wYXJlbnQnKVxuICAgICAgc3Bhbi5hcHBlbmRDaGlsZChwYXJlbnRMb2dvKVxuICAgICAgcmV0dXJuIHNwYW5cbiAgICB9XG4gICAgY29uc3QgcGFyZW50U3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3VwJylcbiAgICBwYXJlbnRTdXAudGV4dENvbnRlbnQgPSBwYXJlbnRTeW1ib2wudG9VcHBlckNhc2UoKVxuICAgIHBhcmVudFN1cC5jbGFzc0xpc3QuYWRkKCd0b2tlbi1wYXJlbnQnKVxuICAgIHNwYW4uYXBwZW5kQ2hpbGQocGFyZW50U3VwKVxuICAgIHJldHVybiBzcGFuXG4gIH1cblxuICAvKlxuICAgKiBzaG9ydFN5bWJvbCByZW1vdmVzIHRoZSBzaG9ydCBmb3JtYXQgb2YgYSBzeW1ib2wsIHdpdGggYW55IHBhcmVudCBjaGFpblxuICAgKiBpZGVudGlmaWVyIHJlbW92ZWRcbiAgICovXG4gIHN0YXRpYyBzaG9ydFN5bWJvbCAoc3ltYm9sOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBzeW1ib2wuc3BsaXQoJy4nKVswXS50b1VwcGVyQ2FzZSgpXG4gIH1cblxuICAvKlxuICAgKiBzZXRUZXh0IHNldHMgdGhlIHRleHRDb250ZW50IGZvciBhbGwgZGVzY2VuZGFudCBlbGVtZW50cyB0aGF0IG1hdGNoIHRoZVxuICAgKiBzcGVjaWZpZWQgQ1NTIHNlbGVjdG9yLlxuICAgKi9cbiAgc3RhdGljIHNldFRleHQgKGFuY2VzdG9yOiBQYWdlRWxlbWVudCwgc2VsZWN0b3I6IHN0cmluZywgdGV4dENvbnRlbnQ6IHN0cmluZykge1xuICAgIGZvciAoY29uc3QgZWwgb2YgRG9jLmFwcGx5U2VsZWN0b3IoYW5jZXN0b3IsIHNlbGVjdG9yKSkgZWwudGV4dENvbnRlbnQgPSB0ZXh0Q29udGVudFxuICB9XG5cbiAgc3RhdGljIHNldFNyYyAoYW5jZXN0b3I6IFBhZ2VFbGVtZW50LCBzZWxlY3Rvcjogc3RyaW5nLCB0ZXh0Q29udGVudDogc3RyaW5nKSB7XG4gICAgZm9yIChjb25zdCBpbWcgb2YgRG9jLmFwcGx5U2VsZWN0b3IoYW5jZXN0b3IsIHNlbGVjdG9yKSkgaW1nLnNyYyA9IHRleHRDb250ZW50XG4gIH1cblxuICAvKlxuICAqIGNsZWFuVGVtcGxhdGVzIHJlbW92ZXMgdGhlIGVsZW1lbnRzIGZyb20gdGhlIERPTSBhbmQgZGVsZXRlcyB0aGUgaWRcbiAgKiBhdHRyaWJ1dGUuXG4gICovXG4gIHN0YXRpYyBjbGVhblRlbXBsYXRlcyAoLi4udG1wbHM6IEhUTUxFbGVtZW50W10pIHtcbiAgICB0bXBscy5mb3JFYWNoKHRtcGwgPT4ge1xuICAgICAgdG1wbC5yZW1vdmUoKVxuICAgICAgdG1wbC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJylcbiAgICB9KVxuICB9XG5cbiAgLypcbiAgKiB0bXBsRWxlbWVudCBpcyBhIGhlbHBlciBmdW5jdGlvbiBmb3IgZ3JhYmJpbmcgc3ViLWVsZW1lbnRzIG9mIHRoZSBtYXJrZXQgbGlzdFxuICAqIHRlbXBsYXRlLlxuICAqL1xuICBzdGF0aWMgdG1wbEVsZW1lbnQgKGFuY2VzdG9yOiBEb2N1bWVudCB8IEhUTUxFbGVtZW50LCBzOiBzdHJpbmcpOiBQYWdlRWxlbWVudCB7XG4gICAgcmV0dXJuIGFuY2VzdG9yLnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXRtcGw9XCIke3N9XCJdYCkgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgfVxuXG4gIC8qXG4gICogcGFyc2VUZW1wbGF0ZSByZXR1cm5zIGFuIG9iamVjdCBvZiBkYXRhLXRtcGwgZWxlbWVudHMsIGtleWVkIGJ5IHRoZWlyXG4gICogZGF0YS10bXBsIHZhbHVlcy5cbiAgKi9cbiAgc3RhdGljIHBhcnNlVGVtcGxhdGUgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCk6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PiB7XG4gICAgY29uc3QgZDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+ID0ge31cbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtdG1wbF0nKSkgZFtlbC5kYXRhc2V0LnRtcGwgfHwgJyddID0gZWxcbiAgICByZXR1cm4gZFxuICB9XG5cbiAgLypcbiAgICogdGltZVNpbmNlIHJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGR1cmF0aW9uIHNpbmNlIHRoZVxuICAgKiBzcGVjaWZpZWQgdW5peCB0aW1lc3RhbXAgKG1pbGxpc2Vjb25kcykuXG4gICAqL1xuICBzdGF0aWMgdGltZVNpbmNlIChtczogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gRG9jLmZvcm1hdER1cmF0aW9uKChuZXcgRGF0ZSgpLmdldFRpbWUoKSkgLSBtcylcbiAgfVxuXG4gIC8qXG4gICAqIGhtc1NpbmNlIHJldHVybnMgYSB0aW1lIGR1cmF0aW9uIHNpbmNlIHRoZSBzcGVjaWZpZWQgdW5peCB0aW1lc3RhbXBcbiAgICogZm9ybWF0dGVkIGFzIEhIOk1NOlNTXG4gICAqL1xuICBzdGF0aWMgaG1zU2luY2UgKHNlY3M6IG51bWJlcikge1xuICAgIGxldCByID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgLSBzZWNzXG4gICAgY29uc3QgaCA9IFN0cmluZyhNYXRoLmZsb29yKHIgLyAzNjAwKSlcbiAgICByID0gciAlIDM2MDBcbiAgICBjb25zdCBtID0gU3RyaW5nKE1hdGguZmxvb3IociAvIDYwKSlcbiAgICBjb25zdCBzID0gU3RyaW5nKE1hdGguZmxvb3IociAlIDYwKSlcbiAgICByZXR1cm4gYCR7aC5wYWRTdGFydCgyLCAnMCcpfToke20ucGFkU3RhcnQoMiwgJzAnKX06JHtzLnBhZFN0YXJ0KDIsICcwJyl9YFxuICB9XG5cbiAgLyogZm9ybWF0RHVyYXRpb24gcmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZHVyYXRpb24gKi9cbiAgc3RhdGljIGZvcm1hdER1cmF0aW9uIChkdXI6IG51bWJlcik6IHN0cmluZyB7XG4gICAgbGV0IHNlY29uZHMgPSBNYXRoLmZsb29yKGR1cilcbiAgICBsZXQgcmVzdWx0ID0gJydcbiAgICBsZXQgY291bnQgPSAwXG4gICAgY29uc3QgYWRkID0gKG46IG51bWJlciwgczogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAobiA+IDAgfHwgY291bnQgPiAwKSBjb3VudCsrXG4gICAgICBpZiAobiA+IDApIHJlc3VsdCArPSBgJHtufSAke3N9IGBcbiAgICAgIHJldHVybiBjb3VudCA+PSAyXG4gICAgfVxuICAgIGxldCB5LCBtbywgZCwgaCwgbSwgc1xuICAgIFt5LCBzZWNvbmRzXSA9IHRpbWVNb2Qoc2Vjb25kcywgYVllYXIpXG4gICAgaWYgKGFkZCh5LCAneScpKSB7IHJldHVybiByZXN1bHQgfVxuICAgIFttbywgc2Vjb25kc10gPSB0aW1lTW9kKHNlY29uZHMsIGFNb250aClcbiAgICBpZiAoYWRkKG1vLCAnbW8nKSkgeyByZXR1cm4gcmVzdWx0IH1cbiAgICBbZCwgc2Vjb25kc10gPSB0aW1lTW9kKHNlY29uZHMsIGFEYXkpXG4gICAgaWYgKGFkZChkLCAnZCcpKSB7IHJldHVybiByZXN1bHQgfVxuICAgIFtoLCBzZWNvbmRzXSA9IHRpbWVNb2Qoc2Vjb25kcywgYW5Ib3VyKVxuICAgIGlmIChhZGQoaCwgJ2gnKSkgeyByZXR1cm4gcmVzdWx0IH1cbiAgICBbbSwgc2Vjb25kc10gPSB0aW1lTW9kKHNlY29uZHMsIGFNaW51dGUpXG4gICAgaWYgKGFkZChtLCAnbScpKSB7IHJldHVybiByZXN1bHQgfVxuICAgIFtzLCBzZWNvbmRzXSA9IHRpbWVNb2Qoc2Vjb25kcywgMTAwMClcbiAgICBhZGQocywgJ3MnKVxuICAgIHJldHVybiByZXN1bHQgfHwgJzAgcydcbiAgfVxuXG4gIC8qXG4gICAqIGRpc2FibGVNb3VzZVdoZWVsIGNhbiBiZSB1c2VkIHRvIGRpc2FibGUgdGhlIG1vdXNlIHdoZWVsIGZvciBhbnlcbiAgICogaW5wdXQuIEl0IGlzIHZlcnkgZWFzeSB0byB1bmtub3dpbmdseSBzY3JvbGwgdXAgb24gYSBudW1iZXIgaW5wdXRcbiAgICogYW5kIHRoZW4gc3VibWl0IGFuIHVuZXhwZWN0ZWQgdmFsdWUuIFRoaXMgZnVuY3Rpb24gcHJldmVudHMgdGhlXG4gICAqIHNjcm9sbCBpbmNyZW1lbnQvZGVjcmVtZW50IGJlaGF2aW9yIGZvciBhIHdoZWVsIGFjdGlvbiBvbiBhXG4gICAqIG51bWJlciBpbnB1dC5cbiAgICovXG4gIHN0YXRpYyBkaXNhYmxlTW91c2VXaGVlbCAoLi4uaW5wdXRGaWVsZHM6IEVsZW1lbnRbXSkge1xuICAgIGZvciAoY29uc3QgaW5wdXRGaWVsZCBvZiBpbnB1dEZpZWxkcykge1xuICAgICAgRG9jLmJpbmQoaW5wdXRGaWVsZCwgJ3doZWVsJywgKCkgPT4geyAvKiBwYXNzICovIH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KVxuICAgIH1cbiAgfVxuXG4gIC8vIHNob3dGb3JtRXJyb3IgY2FuIGJlIHVzZWQgdG8gc2V0IGFuZCBkaXNwbGF5IGVycm9yIG1lc3NhZ2Ugb24gZm9ybXMuXG4gIHN0YXRpYyBzaG93Rm9ybUVycm9yIChlbDogUGFnZUVsZW1lbnQsIG1zZzogYW55KSB7XG4gICAgZWwudGV4dENvbnRlbnQgPSBtc2dcbiAgICBEb2Muc2hvdyhlbClcbiAgfVxuXG4gIC8vIHNob3dGaWF0VmFsdWUgZGlzcGxheXMgdGhlIGZpYXQgZXF1aXZhbGVudCBmb3IgdGhlIHByb3ZpZGVkIGFtb3VudC5cbiAgc3RhdGljIHNob3dGaWF0VmFsdWUgKGRpc3BsYXk6IFBhZ2VFbGVtZW50LCBhbW91bnQ6IG51bWJlciwgcmF0ZTogbnVtYmVyLCB1aTogVW5pdEluZm8pOiB2b2lkIHtcbiAgICBpZiAocmF0ZSkge1xuICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGaWF0Q29udmVyc2lvbihhbW91bnQsIHJhdGUsIHVpKVxuICAgICAgRG9jLnNob3coZGlzcGxheS5wYXJlbnRFbGVtZW50IGFzIEVsZW1lbnQpXG4gICAgfSBlbHNlIERvYy5oaWRlKGRpc3BsYXkucGFyZW50RWxlbWVudCBhcyBFbGVtZW50KVxuICB9XG59XG5cbi8qXG4gKiBBbmltYXRpb24gaXMgYSBoYW5kbGVyIGZvciBzdGFydGluZyBhbmQgc3RvcHBpbmcgYW5pbWF0aW9ucy5cbiAqL1xuZXhwb3J0IGNsYXNzIEFuaW1hdGlvbiB7XG4gIGRvbmU6ICgoKSA9PiB2b2lkKSB8IHVuZGVmaW5lZFxuICBlbmRBbmltYXRpb246IGJvb2xlYW5cbiAgdGhyZWFkOiBQcm9taXNlPHZvaWQ+XG4gIHN0YXRpYyBGb3JldmVyOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAoZHVyYXRpb246IG51bWJlciwgZjogKHByb2dyZXNzOiBudW1iZXIpID0+IHZvaWQsIGVhc2luZ0FsZ28/OiBzdHJpbmcsIGRvbmU/OiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5kb25lID0gZG9uZVxuICAgIHRoaXMudGhyZWFkID0gdGhpcy5ydW4oZHVyYXRpb24sIGYsIGVhc2luZ0FsZ28pXG4gIH1cblxuICAvKlxuICAgKiBydW4gcnVucyB0aGUgYW5pbWF0aW9uIGZ1bmN0aW9uLCBpbmNyZWFzaW5nIHByb2dyZXNzIGZyb20gMCB0byAxIGluIGFcbiAgICogbWFubmVyIGRpY3RhdGVkIGJ5IGVhc2luZ0FsZ28uXG4gICAqL1xuICBhc3luYyBydW4gKGR1cmF0aW9uOiBudW1iZXIsIGY6IChwcm9ncmVzczogbnVtYmVyKSA9PiB2b2lkLCBlYXNpbmdBbGdvPzogc3RyaW5nKSB7XG4gICAgZHVyYXRpb24gPSBkdXJhdGlvbiA+PSAwID8gZHVyYXRpb24gOiAxMDAwICogODY0MDAgKiAzNjUgKiAxMCAvLyAxMCB5ZWFycywgaW4gbXNcbiAgICBjb25zdCBlYXNlciA9IGVhc2luZ0FsZ28gPyBFYXNpbmdbZWFzaW5nQWxnb10gOiBFYXNpbmcubGluZWFyXG4gICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgIGNvbnN0IGVuZCA9IChkdXJhdGlvbiA9PT0gQW5pbWF0aW9uLkZvcmV2ZXIpID8gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgOiBzdGFydCArIGR1cmF0aW9uXG4gICAgY29uc3QgcmFuZ2UgPSBlbmQgLSBzdGFydFxuICAgIGNvbnN0IGZyYW1lRHVyYXRpb24gPSAxMDAwIC8gRlBTXG4gICAgbGV0IG5vdyA9IHN0YXJ0XG4gICAgdGhpcy5lbmRBbmltYXRpb24gPSBmYWxzZVxuICAgIHdoaWxlIChub3cgPCBlbmQpIHtcbiAgICAgIGlmICh0aGlzLmVuZEFuaW1hdGlvbikgcmV0dXJuIHRoaXMucnVuQ29tcGxldGlvbkZ1bmN0aW9uKClcbiAgICAgIGYoZWFzZXIoKG5vdyAtIHN0YXJ0KSAvIHJhbmdlKSlcbiAgICAgIGF3YWl0IHNsZWVwKGZyYW1lRHVyYXRpb24pXG4gICAgICBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgIH1cbiAgICBmKDEpXG4gICAgdGhpcy5ydW5Db21wbGV0aW9uRnVuY3Rpb24oKVxuICB9XG5cbiAgLyogd2FpdCByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSB3aGVuIHRoZSBhbmltYXRpb24gY29tcGxldGVzLiAqL1xuICBhc3luYyB3YWl0ICgpIHtcbiAgICBhd2FpdCB0aGlzLnRocmVhZFxuICB9XG5cbiAgLyogc3RvcCBzY2hlZHVsZXMgdGhlIGFuaW1hdGlvbiB0byBleGl0IGF0IGl0cyBuZXh0IGZyYW1lLiAqL1xuICBzdG9wICgpIHtcbiAgICB0aGlzLmVuZEFuaW1hdGlvbiA9IHRydWVcbiAgfVxuXG4gIC8qXG4gICAqIHN0b3BBbmRXYWl0IHN0b3BzIHRoZSBhbmltYXRpb25zIGFuZCByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZVxuICAgKiB3aGVuIHRoZSBhbmltYXRpb24gZXhpdHMuXG4gICAqL1xuICBhc3luYyBzdG9wQW5kV2FpdCAoKSB7XG4gICAgdGhpcy5zdG9wKClcbiAgICBhd2FpdCB0aGlzLndhaXQoKVxuICB9XG5cbiAgLyogcnVuQ29tcGxldGlvbkZ1bmN0aW9uIHJ1bnMgYW55IHJlZ2lzdGVyZWQgY2FsbGJhY2sgZnVuY3Rpb24gKi9cbiAgcnVuQ29tcGxldGlvbkZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kb25lKSB0aGlzLmRvbmUoKVxuICB9XG59XG5BbmltYXRpb24uRm9yZXZlciA9IC0xXG5cbi8qIEVhc2luZyBhbGdvcml0aG1zIGZvciBhbmltYXRpb25zLiAqL1xuZXhwb3J0IGNvbnN0IEVhc2luZzogUmVjb3JkPHN0cmluZywgKHQ6IG51bWJlcikgPT4gbnVtYmVyPiA9IHtcbiAgbGluZWFyOiB0ID0+IHQsXG4gIGVhc2VJbjogdCA9PiB0ICogdCxcbiAgZWFzZU91dDogdCA9PiB0ICogKDIgLSB0KSxcbiAgZWFzZUluSGFyZDogdCA9PiB0ICogdCAqIHQsXG4gIGVhc2VPdXRIYXJkOiB0ID0+ICgtLXQpICogdCAqIHQgKyAxLFxuICBlYXNlT3V0RWxhc3RpYzogdCA9PiB7XG4gICAgY29uc3QgYzQgPSAoMiAqIE1hdGguUEkpIC8gM1xuICAgIHJldHVybiB0ID09PSAwXG4gICAgICA/IDBcbiAgICAgIDogdCA9PT0gMVxuICAgICAgICA/IDFcbiAgICAgICAgOiBNYXRoLnBvdygyLCAtMTAgKiB0KSAqIE1hdGguc2luKCh0ICogMTAgLSAwLjc1KSAqIGM0KSArIDFcbiAgfVxufVxuXG4vKiBXYWxsZXRJY29ucyBhcmUgdXNlZCBmb3IgY29udHJvbGxpbmcgd2FsbGV0cyBpbiB2YXJpb3VzIHBsYWNlcy4gKi9cbmV4cG9ydCBjbGFzcyBXYWxsZXRJY29ucyB7XG4gIGljb25zOiBSZWNvcmQ8c3RyaW5nLCBIVE1MRWxlbWVudD5cbiAgc3RhdHVzOiBFbGVtZW50XG5cbiAgY29uc3RydWN0b3IgKGJveDogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCBzdGF0ZUVsZW1lbnQgPSAobmFtZTogc3RyaW5nKSA9PiBib3gucXVlcnlTZWxlY3RvcihgW2RhdGEtc3RhdGU9JHtuYW1lfV1gKSBhcyBIVE1MRWxlbWVudFxuICAgIHRoaXMuaWNvbnMgPSB7fVxuICAgIHRoaXMuaWNvbnMuc2xlZXBpbmcgPSBzdGF0ZUVsZW1lbnQoJ3NsZWVwaW5nJylcbiAgICB0aGlzLmljb25zLmxvY2tlZCA9IHN0YXRlRWxlbWVudCgnbG9ja2VkJylcbiAgICB0aGlzLmljb25zLnVubG9ja2VkID0gc3RhdGVFbGVtZW50KCd1bmxvY2tlZCcpXG4gICAgdGhpcy5pY29ucy5ub3dhbGxldCA9IHN0YXRlRWxlbWVudCgnbm93YWxsZXQnKVxuICAgIHRoaXMuaWNvbnMuc3luY2luZyA9IHN0YXRlRWxlbWVudCgnc3luY2luZycpXG4gICAgdGhpcy5pY29ucy5ub3BlZXJzID0gc3RhdGVFbGVtZW50KCdub3BlZXJzJylcbiAgICB0aGlzLmljb25zLmRpc2FibGVkID0gc3RhdGVFbGVtZW50KCdkaXNhYmxlZCcpXG4gICAgdGhpcy5zdGF0dXMgPSBzdGF0ZUVsZW1lbnQoJ3N0YXR1cycpXG4gIH1cblxuICAvKiBzbGVlcGluZyBzZXRzIHRoZSBpY29ucyB0byBpbmRpY2F0ZSB0aGF0IHRoZSB3YWxsZXQgaXMgbm90IGNvbm5lY3RlZC4gKi9cbiAgc2xlZXBpbmcgKCkge1xuICAgIGNvbnN0IGkgPSB0aGlzLmljb25zXG4gICAgRG9jLmhpZGUoaS5sb2NrZWQsIGkudW5sb2NrZWQsIGkubm93YWxsZXQsIGkuc3luY2luZywgaS5kaXNhYmxlZClcbiAgICBEb2Muc2hvdyhpLnNsZWVwaW5nKVxuICAgIGlmICh0aGlzLnN0YXR1cykgdGhpcy5zdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9PRkYpXG4gIH1cblxuICAvKlxuICAgKiBsb2NrZWQgc2V0cyB0aGUgaWNvbnMgdG8gaW5kaWNhdGUgdGhhdCB0aGUgd2FsbGV0IGlzIGNvbm5lY3RlZCwgYnV0IGxvY2tlZC5cbiAgICovXG4gIGxvY2tlZCAoKSB7XG4gICAgY29uc3QgaSA9IHRoaXMuaWNvbnNcbiAgICBEb2MuaGlkZShpLnVubG9ja2VkLCBpLm5vd2FsbGV0LCBpLnNsZWVwaW5nLCBpLmRpc2FibGVkKVxuICAgIERvYy5zaG93KGkubG9ja2VkKVxuICAgIGlmICh0aGlzLnN0YXR1cykgdGhpcy5zdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9MT0NLRUQpXG4gIH1cblxuICAvKlxuICAgKiB1bmxvY2tlZCBzZXRzIHRoZSBpY29ucyB0byBpbmRpY2F0ZSB0aGF0IHRoZSB3YWxsZXQgaXMgY29ubmVjdGVkIGFuZFxuICAgKiB1bmxvY2tlZC5cbiAgICovXG4gIHVubG9ja2VkICgpIHtcbiAgICBjb25zdCBpID0gdGhpcy5pY29uc1xuICAgIERvYy5oaWRlKGkubG9ja2VkLCBpLm5vd2FsbGV0LCBpLnNsZWVwaW5nLCBpLmRpc2FibGVkKVxuICAgIERvYy5zaG93KGkudW5sb2NrZWQpXG4gICAgaWYgKHRoaXMuc3RhdHVzKSB0aGlzLnN0YXR1cy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1JFQURZKVxuICB9XG5cbiAgLyogbm93YWxsZXQgc2V0cyB0aGUgaWNvbnMgdG8gaW5kaWNhdGUgdGhhdCBubyB3YWxsZXQgZXhpc3RzLiAqL1xuICBub3dhbGxldCAoKSB7XG4gICAgY29uc3QgaSA9IHRoaXMuaWNvbnNcbiAgICBEb2MuaGlkZShpLmxvY2tlZCwgaS51bmxvY2tlZCwgaS5zbGVlcGluZywgaS5zeW5jaW5nLCBpLmRpc2FibGVkKVxuICAgIERvYy5zaG93KGkubm93YWxsZXQpXG4gICAgaWYgKHRoaXMuc3RhdHVzKSB0aGlzLnN0YXR1cy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX1dBTExFVClcbiAgfVxuXG4gIC8qIHNldCB0aGUgaWNvbnMgdG8gaW5kaWNhdGUgdGhhdCB0aGUgd2FsbGV0IGlzIGRpc2FibGVkICovXG4gIGRpc2FibGVkICgpIHtcbiAgICBjb25zdCBpID0gdGhpcy5pY29uc1xuICAgIERvYy5oaWRlKGkubG9ja2VkLCBpLnVubG9ja2VkLCBpLnNsZWVwaW5nLCBpLnN5bmNpbmcsIGkubm93YWxsZXQsIGkubm9wZWVycylcbiAgICBEb2Muc2hvdyhpLmRpc2FibGVkKVxuICAgIGkuZGlzYWJsZWQuZGF0YXNldC50b29sdGlwID0gaW50bC5wcmVwKGludGwuSURfRElTQUJMRURfTVNHKVxuICB9XG5cbiAgc2V0U3luY2luZyAod2FsbGV0OiBXYWxsZXRTdGF0ZSB8IG51bGwpIHtcbiAgICBjb25zdCBzeW5jSWNvbiA9IHRoaXMuaWNvbnMuc3luY2luZ1xuICAgIGlmICghd2FsbGV0IHx8ICF3YWxsZXQucnVubmluZyB8fCB3YWxsZXQuZGlzYWJsZWQpIHtcbiAgICAgIERvYy5oaWRlKHN5bmNJY29uKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKHdhbGxldC5wZWVyQ291bnQgPT09IDApIHtcbiAgICAgIERvYy5zaG93KHRoaXMuaWNvbnMubm9wZWVycylcbiAgICAgIERvYy5oaWRlKHN5bmNJY29uKSAvLyBwb3RlbnRpYWxseSBtaXNsZWFkaW5nIHdpdGggbm8gcGVlcnNcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2MuaGlkZSh0aGlzLmljb25zLm5vcGVlcnMpXG5cbiAgICBpZiAoIXdhbGxldC5zeW5jZWQpIHtcbiAgICAgIERvYy5zaG93KHN5bmNJY29uKVxuICAgICAgc3luY0ljb24uZGF0YXNldC50b29sdGlwID0gaW50bC5wcmVwKGludGwuSURfV0FMTEVUX1NZTkNfUFJPR1JFU1MsIHsgc3luY1Byb2dyZXNzOiAod2FsbGV0LnN5bmNQcm9ncmVzcyAqIDEwMCkudG9GaXhlZCgxKSB9KVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5oaWRlKHN5bmNJY29uKVxuICB9XG5cbiAgLyogcmVhZHMgdGhlIGNvcmUuV2FsbGV0IHN0YXRlIGFuZCBzZXRzIHRoZSBpY29uIHZpc2liaWxpdHkuICovXG4gIHJlYWRXYWxsZXQgKHdhbGxldDogV2FsbGV0U3RhdGUgfCBudWxsKSB7XG4gICAgdGhpcy5zZXRTeW5jaW5nKHdhbGxldClcbiAgICBpZiAoIXdhbGxldCkgcmV0dXJuIHRoaXMubm93YWxsZXQoKVxuICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgY2FzZSAod2FsbGV0LmRpc2FibGVkKTpcbiAgICAgICAgdGhpcy5kaXNhYmxlZCgpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICghd2FsbGV0LnJ1bm5pbmcpOlxuICAgICAgICB0aGlzLnNsZWVwaW5nKClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgKCF3YWxsZXQub3Blbik6XG4gICAgICAgIHRoaXMubG9ja2VkKClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgKHdhbGxldC5vcGVuKTpcbiAgICAgICAgdGhpcy51bmxvY2tlZCgpXG4gICAgICAgIGJyZWFrXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25zb2xlLmVycm9yKCd3YWxsZXQgaW4gdW5rbm93biBzdGF0ZScsIHdhbGxldClcbiAgICB9XG4gIH1cbn1cblxuLypcbiAqIEFuaVRvZ2dsZSBpcyBhIHNtYWxsIHRvZ2dsZSBzd2l0Y2gsIGRlZmluZWQgaW4gSFRNTCB3aXRoIHRoZSBlbGVtZW50XG4gKiA8ZGl2IGNsYXNzPVwiYW5pdG9nZ2xlXCI+PC9kaXY+LiBUaGUgYW5pbWF0aW9ucyBhcmUgZGVmaW5lZCBpbiB0aGUgYW5pdG9nZ2xlXG4gKiBDU1MgY2xhc3MuIEFuaVRvZ2dsZSB0cmlnZ2VycyB0aGUgY2FsbGJhY2sgb24gY2xpY2sgZXZlbnRzLCBidXQgZG9lcyBub3RcbiAqIHVwZGF0ZSB0b2dnbGUgYXBwZWFyYW5jZSwgc28gdGhlIGNhbGxlciBtdXN0IGNhbGwgdGhlIHNldFN0YXRlIG1ldGhvZCBmcm9tXG4gKiB0aGUgY2FsbGJhY2sgb3IgZWxzZXdoZXJlIGlmIHRoZSBuZXdTdGF0ZVxuICogaXMgYWNjZXB0ZWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBBbmlUb2dnbGUge1xuICB0b2dnbGU6IFBhZ2VFbGVtZW50XG4gIHRvZ2dsaW5nOiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IgKHRvZ2dsZTogUGFnZUVsZW1lbnQsIGVycm9yRWw6IFBhZ2VFbGVtZW50LCBpbml0aWFsU3RhdGU6IGJvb2xlYW4sIGNhbGxiYWNrOiAobmV3U3RhdGU6IGJvb2xlYW4pID0+IFByb21pc2U8YW55Pikge1xuICAgIHRoaXMudG9nZ2xlID0gdG9nZ2xlXG4gICAgaWYgKHRvZ2dsZS5jaGlsZHJlbi5sZW5ndGggPT09IDApIHRvZ2dsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcblxuICAgIERvYy5iaW5kKHRvZ2dsZSwgJ2NsaWNrJywgYXN5bmMgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIERvYy5oaWRlKGVycm9yRWwpXG4gICAgICBjb25zdCBuZXdTdGF0ZSA9ICF0b2dnbGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdvbicpXG4gICAgICB0aGlzLnRvZ2dsaW5nID0gdHJ1ZVxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgY2FsbGJhY2sobmV3U3RhdGUpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHRoaXMudG9nZ2xpbmcgPSBmYWxzZVxuICAgICAgICBEb2Muc2hvdyhlcnJvckVsKVxuICAgICAgICBlcnJvckVsLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQVBJX0VSUk9SLCB7IG1zZzogZS5tc2cgfHwgU3RyaW5nKGUpIH0pXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgdGhpcy50b2dnbGluZyA9IGZhbHNlXG4gICAgfSlcbiAgICB0aGlzLnNldFN0YXRlKGluaXRpYWxTdGF0ZSlcbiAgfVxuXG4gIHNldFN0YXRlIChzdGF0ZTogYm9vbGVhbikge1xuICAgIGlmIChzdGF0ZSkgdGhpcy50b2dnbGUuY2xhc3NMaXN0LmFkZCgnb24nKVxuICAgIGVsc2UgdGhpcy50b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnb24nKVxuICB9XG59XG5cbi8qIHNsZWVwIGNhbiBiZSB1c2VkIGJ5IGFzeW5jIGZ1bmN0aW9ucyB0byBwYXVzZSBmb3IgYSBzcGVjaWZpZWQgcGVyaW9kLiAqL1xuZnVuY3Rpb24gc2xlZXAgKG1zOiBudW1iZXIpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpXG59XG5cbmNvbnN0IGFZZWFyID0gMzE1MzYwMDAwMDBcbmNvbnN0IGFNb250aCA9IDI1OTIwMDAwMDBcbmNvbnN0IGFEYXkgPSA4NjQwMDAwMFxuY29uc3QgYW5Ib3VyID0gMzYwMDAwMFxuY29uc3QgYU1pbnV0ZSA9IDYwMDAwXG5cbi8qIHRpbWVNb2QgcmV0dXJucyB0aGUgcXVvdGllbnQgYW5kIHJlbWFpbmRlciBvZiB0IC8gZHVyLiAqL1xuZnVuY3Rpb24gdGltZU1vZCAodDogbnVtYmVyLCBkdXI6IG51bWJlcikge1xuICBjb25zdCBuID0gTWF0aC5mbG9vcih0IC8gZHVyKVxuICByZXR1cm4gW24sIHQgLSBuICogZHVyXVxufVxuXG5mdW5jdGlvbiBmb3JtYXRTaWdGaWdzV2l0aEZvcm1hdHRlcnMgKGludEZvcm1hdHRlcjogSW50bC5OdW1iZXJGb3JtYXQsIHNpZ0ZpZ0Zvcm1hdHRlcjogSW50bC5OdW1iZXJGb3JtYXQsIG46IG51bWJlciwgbWF4RGVjaW1hbHM/OiBudW1iZXIsIGxvY2FsZXM/OiBzdHJpbmcgfCBzdHJpbmdbXSk6IHN0cmluZyB7XG4gIGlmIChuID49IDEwMDApIHJldHVybiBpbnRGb3JtYXR0ZXIuZm9ybWF0KG4pXG4gIGNvbnN0IHMgPSBzaWdGaWdGb3JtYXR0ZXIuZm9ybWF0KG4pXG4gIGlmICh0eXBlb2YgbWF4RGVjaW1hbHMgIT09ICdudW1iZXInKSByZXR1cm4gc1xuICBjb25zdCBmcmFjdGlvbmFsID0gc2lnRmlnRm9ybWF0dGVyLmZvcm1hdFRvUGFydHMobikuZmlsdGVyKChwYXJ0OiBJbnRsLk51bWJlckZvcm1hdFBhcnQpID0+IHBhcnQudHlwZSA9PT0gJ2ZyYWN0aW9uJylbMF0/LnZhbHVlID8/ICcnXG4gIGlmIChmcmFjdGlvbmFsLmxlbmd0aCA8PSBtYXhEZWNpbWFscykgcmV0dXJuIHNcbiAgcmV0dXJuIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXIobWF4RGVjaW1hbHMsIGxvY2FsZXMpLmZvcm1hdChuKVxufVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgLy8gQ29kZSB3aWxsIG9ubHkgYXBwZWFyIGluIGRldiBidWlsZC5cbiAgLy8gaHR0cHM6Ly93ZWJwYWNrLmpzLm9yZy9ndWlkZXMvcHJvZHVjdGlvbi9cbiAgd2luZG93LnRlc3RGb3JtYXRGb3VyU2lnRmlncyA9ICgpID0+IHtcbiAgICBjb25zdCB0ZXN0czogW3N0cmluZywgc3RyaW5nLCBudW1iZXIgfCB1bmRlZmluZWQsIHN0cmluZ11bXSA9IFtcbiAgICAgIFsnZW4tVVMnLCAnMS4yMzQ1NjcnLCB1bmRlZmluZWQsICcxLjIzNSddLCAvLyBzaWdGaWdGb3JtYXR0ZXJcbiAgICAgIFsnZW4tVVMnLCAnMS4yMzQ1NjcnLCAyLCAnMS4yMyddLCAvLyBkZWNpbWFsRm9ybWF0dGVyXG4gICAgICBbJ2VuLVVTJywgJzEyMzQnLCB1bmRlZmluZWQsICcxLDIzNC4wJ10sIC8vIG9uZUZyYWN0aW9uYWxEaWdpdFxuICAgICAgWydlbi1VUycsICcxMicsIHVuZGVmaW5lZCwgJzEyLjAwJ10sIC8vIHNpZ0ZpZ0Zvcm1hdHRlclxuICAgICAgWydmci1GUicsICcxMjMuNDU2NzgnLCB1bmRlZmluZWQsICcxMjMsNSddLCAvLyBvbmVGcmFjdGlvbmFsRGlnaXRcbiAgICAgIFsnZnItRlInLCAnMTIzNC41JywgdW5kZWZpbmVkLCAnMeKArzIzNCw1J10sIC8vIFUrMjAyRiBmb3IgdGhvdXNhbmRzIHNlcGFyYXRvclxuICAgICAgLy8gRm9yIEFyYWJpYywgaHR0cHM6Ly93d3cuc2FpdGFrLmNvbS9udW1iZXIgaXMgdXNlZnVsLCBidXQgc2VlbXMgdG8gdXNlXG4gICAgICAvLyBzbGlnaHRseSBkaWZmZXJlbnQgdW5pY29kZSBwb2ludHMgYW5kIG5vIHRob3VzYW5kcyBzZXBhcmF0b3IuIEkgdGhpbmtcbiAgICAgIC8vIHRoZSBBcmFiaWMgZGVjaW1hbCBzZXBhcmF0b3IgaXMgc3VwcG9zZWQgdG8gYmUgbW9yZSBsaWtlIGEgcG9pbnQsIG5vdFxuICAgICAgLy8gYSBjb21tYSwgYnV0IEdvb2dsZSBDaHJvbWUgdXNlcyBVKzA2NkIgKEFyYWJpYyBEZWNpbWFsIFNlcGFyYXRvciksXG4gICAgICAvLyB3aGljaCBsb29rcyBsaWtlIGEgY29tbWEgdG8gbWUuIMKvXFxfKOODhClfL8KvXG4gICAgICBbJ2FyLUVHJywgJzEyMy40NTY3OCcsIHVuZGVmaW5lZCwgJ9mh2aLZo9mr2aUnXSxcbiAgICAgIFsnYXItRUcnLCAnMTIzNCcsIHVuZGVmaW5lZCwgJ9mh2azZotmj2aTZq9mgJ10sXG4gICAgICBbJ2FyLUVHJywgJzAuMTIzNDUnLCAzLCAn2aDZq9mh2aLZoyddXG4gICAgXVxuXG4gICAgLy8gUmVwcm9kdWNlIHRoZSBOdW1iZXJGb3JtYXRzIHdpdGggT05MWSBvdXIgZGVzaXJlZCBsYW5ndWFnZS5cbiAgICBmb3IgKGNvbnN0IFtjb2RlLCB1bmZvcm1hdHRlZCwgbWF4RGVjaW1hbHMsIGV4cGVjdGVkXSBvZiB0ZXN0cykge1xuICAgICAgY29uc3QgaW50Rm9ybWF0dGVyID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KGNvZGUsIHsgLy8gb25lRnJhY3Rpb25hbERpZ2l0XG4gICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMSxcbiAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAxXG4gICAgICB9KVxuICAgICAgY29uc3Qgc2lnRmlnRm9ybWF0dGVyID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KGNvZGUsIHtcbiAgICAgICAgbWluaW11bVNpZ25pZmljYW50RGlnaXRzOiA0LFxuICAgICAgICBtYXhpbXVtU2lnbmlmaWNhbnREaWdpdHM6IDRcbiAgICAgIH0pXG4gICAgICBmb3IgKGNvbnN0IGsgaW4gZGVjaW1hbEZvcm1hdHRlcnMpIGRlbGV0ZSBkZWNpbWFsRm9ybWF0dGVyc1trXSAvLyBjbGVhbnVwXG4gICAgICBmb3IgKGNvbnN0IGsgaW4gZnVsbFByZWNpc2lvbkZvcm1hdHRlcnMpIGRlbGV0ZSBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyc1trXSAvLyBjbGVhbnVwXG4gICAgICBjb25zdCBzID0gZm9ybWF0U2lnRmlnc1dpdGhGb3JtYXR0ZXJzKGludEZvcm1hdHRlciwgc2lnRmlnRm9ybWF0dGVyLCBwYXJzZUZsb2F0RGVmYXVsdCh1bmZvcm1hdHRlZCksIG1heERlY2ltYWxzLCBjb2RlKVxuICAgICAgaWYgKHMgIT09IGV4cGVjdGVkKSBjb25zb2xlLmxvZyhgVEVTVCBGQUlMRUQ6IGYoJyR7Y29kZX0nLCAke3VuZm9ybWF0dGVkfSwgJHttYXhEZWNpbWFsc30pID0+ICcke3N9JyAhPSAnJHtleHBlY3RlZH0nfWApXG4gICAgICBlbHNlIGNvbnNvbGUubG9nKGDinJTvuI8gZignJHtjb2RlfScsICR7dW5mb3JtYXR0ZWR9LCAke21heERlY2ltYWxzfSkgPT4gJHtzfSDinJTvuI9gKVxuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy50ZXN0Rm9ybWF0UmF0ZUZ1bGxQcmVjaXNpb24gPSAoKSA9PiB7XG4gICAgY29uc3QgdGVzdHM6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXIsIHN0cmluZ11bXSA9IFtcbiAgICAgIC8vIFR3byB1dHhvIGFzc2V0cyB3aXRoIGEgY29udmVudGlvbmFsIHJhdGUgb2YgMC4xNS4gQ29udmVudGlvbmFsIHJhdGVcbiAgICAgIC8vIHN0ZXAgaXMgMTAwIC8gMWU4ID0gMWUtNiwgc28gdGhlcmUgc2hvdWxkIGJlIDYgZGVjaW1hbCBkaWdpdHMuXG4gICAgICBbMS41ZTcsIDEwMCwgMWU4LCAxZTgsICcwLjE1MDAwMCddLFxuICAgICAgLy8gVVNEQyBxdW90ZSAtPiB1dHhvIGJhc2Ugd2l0aCBhIHJhdGUgb2YgJDEwIC8gMSBYWVouIFVTREMgaGFzIGFuXG4gICAgICAvLyBjb252ZXJzaW9uIGZhY3RvciBvZiAxZTYsIHNvICQxMCBlbmNvZGVzIHRvIDFlNywgMSBYWVogZW5jb2RlcyB0byAxZTgsXG4gICAgICAvLyBlbmNvZGVkIHJhdGUgaXMgMWU3IC8gMWU4ICogMWU4ID0gMWU3LCBiRmFjdG9yIC8gcUZhY3RvciBpcyAxZTIuXG4gICAgICAvLyBUaGUgY29udmVudGlvbmFsIHJhdGUgc3RlcCBpcyAyMDAgLyAxZTggKiAxZTIgPSAyZS00LCBzbyB1c2luZ1xuICAgICAgLy8gcmF0ZVN0ZXBEaWdpdHMsIHdlIHNob3VsZCBnZXQgNCBkZWNpbWFsIGRpZ2l0cy5cbiAgICAgIFsxZTcsIDIwMCwgMWU2LCAxZTgsICcxMC4wMDAwJ10sXG4gICAgICAvLyBTZXQgYSByYXRlIG9mIDEgYXRvbSBVU0RDIGZvciAwLjAxIEJUQy4gVGhhdCBhdG9taWMgcmF0ZSB3aWxsIGJlIDEgL1xuICAgICAgLy8gMWU2ID0gMWUtNi4gVGhlIGVuY29kZWQgcmF0ZSB3aWxsIGJlIDFlLTYgKiAxZTggPSAxZTIuIEFzIGxvbmcgYXMgb3VyXG4gICAgICAvLyByYXRlIHN0ZXAgZGl2aWRlcyBldmVubHkgaW50byAxMDAsIHRoaXMgc2hvdWxkIHdvcmsuIFRoZSBjb252ZW50aW9uYWxcbiAgICAgIC8vIHJhdGUgaXMgMWUtNiAvIDFlLTIgPSAxZS00LCBzbyBleHBlY3QgNCBkZWNpbWFsIGRpZ2l0cy5cbiAgICAgIFsxZTIsIDEwMCwgMWU2LCAxZTgsICcwLjAwMDEnXSxcbiAgICAgIC8vIERDUi1FVEgsIGV4cGVjdCA2IGRlY2ltYWxzLlxuICAgICAgWzEuNWU3LCAxMDAwLCAxZTksIDFlOCwgJzAuMDE1MDAwJ10sXG4gICAgICBbMWU2LCAxMDAwLCAxZTksIDFlOCwgJzAuMDAxMDAwJ10sXG4gICAgICBbMWUzLCAxMDAwLCAxZTksIDFlOCwgJzAuMDAwMDAxJ10sXG4gICAgICBbMTAwMDAxMDAwLCAxMDAwLCAxZTksIDFlOCwgJzAuMTAwMDAxJ10sXG4gICAgICBbMTAwMDAwMTAwMCwgMTAwMCwgMWU5LCAxZTgsICcxLjAwMDAwMSddLFxuICAgICAgLy8gRENSLVVTREMsIGV4cGVjdCAzIGRlY2ltYWxzLlxuICAgICAgWzEuNWU3LCAxMDAwLCAxZTYsIDFlOCwgJzE1LjAwMCddLFxuICAgICAgWzFlNiwgMTAwMCwgMWU2LCAxZTgsICcxLjAwMCddLFxuICAgICAgWzFlMywgMTAwMCwgMWU2LCAxZTgsICcwLjAwMSddLFxuICAgICAgWzEwMTAwMCwgMTAwMCwgMWU2LCAxZTgsICcwLjEwMSddLFxuICAgICAgWzEwMDEwMDAsIDEwMDAsIDFlNiwgMWU4LCAnMS4wMDEnXSxcbiAgICAgIC8vIFVUWE8gYXNzZXRzIGJ1dCB3aXRoIGEgcmF0ZSBzdGVwIHRoYXQncyBub3QgYSBwZXJmZWN0IHBvd2VyIG9mIDEwLlxuICAgICAgLy8gRm9yIGEgcmF0ZSBzdGVwIG9mIDUwMCwgYSBtaW4gcmF0ZSB3b3VsZCBiZSBlLmcuIHJhdGUgc3RlcCA9IDUwMC5cbiAgICAgIC8vIDVlMiAvIDFlOCA9IDVlLTYgPSAwLjAwMDAwNVxuICAgICAgWzVlMiwgNTAwLCAxZTgsIDFlOCwgJzAuMDAwMDA1J11cbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IFtlbmNSYXRlLCByYXRlU3RlcCwgcUZhY3RvciwgYkZhY3RvciwgZXhwRW5jb2RpbmddIG9mIHRlc3RzKSB7XG4gICAgICBmb3IgKGNvbnN0IGsgaW4gZnVsbFByZWNpc2lvbkZvcm1hdHRlcnMpIGRlbGV0ZSBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyc1trXSAvLyBjbGVhbnVwXG4gICAgICBjb25zdCBidWkgPSB7IGNvbnZlbnRpb25hbDogeyBjb252ZXJzaW9uRmFjdG9yOiBiRmFjdG9yIH0gfSBhcyBhbnkgYXMgVW5pdEluZm9cbiAgICAgIGNvbnN0IHF1aSA9IHsgY29udmVudGlvbmFsOiB7IGNvbnZlcnNpb25GYWN0b3I6IHFGYWN0b3IgfSB9IGFzIGFueSBhcyBVbml0SW5mb1xuICAgICAgY29uc3QgZW5jID0gRG9jLmZvcm1hdFJhdGVGdWxsUHJlY2lzaW9uKGVuY1JhdGUsIGJ1aSwgcXVpLCByYXRlU3RlcClcbiAgICAgIGlmIChlbmMgIT09IGV4cEVuY29kaW5nKSBjb25zb2xlLmxvZyhgVEVTVCBGQUlMRUQ6IGYoJHtlbmNSYXRlfSwgJHtiRmFjdG9yfSwgJHtxRmFjdG9yfSwgJHtyYXRlU3RlcH0pID0+ICR7ZW5jfSAhPSAke2V4cEVuY29kaW5nfWApXG4gICAgICBlbHNlIGNvbnNvbGUubG9nKGDinJTvuI8gZigke2VuY1JhdGV9LCAke2JGYWN0b3J9LCAke3FGYWN0b3J9LCAke3JhdGVTdGVwfSkgPT4gJHtlbmN9IOKclO+4j2ApXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTnVtYmVySW5wdXRPcHRzIHtcbiAgcHJlYz86IG51bWJlclxuICBzaWdGaWdzPzogYm9vbGVhblxuICBjaGFuZ2VkPzogKHY6IG51bWJlcikgPT4gdm9pZFxuICBtaW4/OiBudW1iZXJcbiAgc2V0PzogKHY6IG51bWJlciwgczogc3RyaW5nKSA9PiB2b2lkIC8vIGNhbGxlZCB3aGVuIHNldFZhbHVlIGlzIGNhbGxlZFxufVxuXG5leHBvcnQgY2xhc3MgTnVtYmVySW5wdXQge1xuICBpbnB1dDogUGFnZUVsZW1lbnRcbiAgcHJlYzogbnVtYmVyXG4gIGZtdDogKHY6IG51bWJlciwgcHJlYzogbnVtYmVyKSA9PiBbbnVtYmVyLCBzdHJpbmddXG4gIGNoYW5nZWQ6ICh2OiBudW1iZXIpID0+IHZvaWRcbiAgc2V0PzogKHY6IG51bWJlciwgczogc3RyaW5nKSA9PiB2b2lkXG4gIG1pbjogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IgKGlucHV0OiBQYWdlRWxlbWVudCwgb3B0czogTnVtYmVySW5wdXRPcHRzKSB7XG4gICAgdGhpcy5pbnB1dCA9IGlucHV0XG4gICAgdGhpcy5wcmVjID0gb3B0cy5wcmVjID8/IDBcbiAgICB0aGlzLmZtdCA9IG9wdHMuc2lnRmlncyA/IHRvRm91clNpZ0ZpZ3MgOiB0b1ByZWNpc2lvblxuICAgIHRoaXMuY2hhbmdlZCA9IG9wdHMuY2hhbmdlZCA/PyAoKCkgPT4geyAvKiBwYXNzICovIH0pXG4gICAgdGhpcy5zZXQgPSBvcHRzLnNldFxuICAgIHRoaXMubWluID0gb3B0cy5taW4gPz8gMFxuXG4gICAgRG9jLmJpbmQoaW5wdXQsICdjaGFuZ2UnLCAoKSA9PiB7IHRoaXMuaW5wdXRDaGFuZ2VkKCkgfSlcbiAgfVxuXG4gIGlucHV0Q2hhbmdlZCAoKSB7XG4gICAgY29uc3QgeyBjaGFuZ2VkIH0gPSB0aGlzXG4gICAgaWYgKGNoYW5nZWQpIGNoYW5nZWQodGhpcy52YWx1ZSgpKVxuICB9XG5cbiAgc2V0VmFsdWUgKHY6IG51bWJlcikge1xuICAgIHRoaXMuaW5wdXQudmFsdWUgPSBTdHJpbmcodilcbiAgICB2ID0gdGhpcy52YWx1ZSgpXG4gICAgaWYgKHRoaXMuc2V0KSB0aGlzLnNldCh2LCB0aGlzLmlucHV0LnZhbHVlKVxuICB9XG5cbiAgdmFsdWUgKCkge1xuICAgIGNvbnN0IHsgaW5wdXQsIG1pbiwgcHJlYywgZm10IH0gPSB0aGlzXG4gICAgY29uc3QgcmF3ViA9IE1hdGgubWF4KHBhcnNlRmxvYXREZWZhdWx0KGlucHV0LnZhbHVlLCBtaW4gPz8gMCksIG1pbiA/PyAwKVxuICAgIGNvbnN0IFt2LCBzXSA9IGZtdChyYXdWLCBwcmVjID8/IDApXG4gICAgaW5wdXQudmFsdWUgPSBzXG4gICAgcmV0dXJuIHZcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEluY3JlbWVudGFsSW5wdXRPcHRzIGV4dGVuZHMgTnVtYmVySW5wdXRPcHRzIHtcbiAgaW5jPzogbnVtYmVyXG59XG5cbmV4cG9ydCBjbGFzcyBJbmNyZW1lbnRhbElucHV0IGV4dGVuZHMgTnVtYmVySW5wdXQge1xuICBpbmM6IG51bWJlclxuICBvcHRzOiBJbmNyZW1lbnRhbElucHV0T3B0c1xuXG4gIGNvbnN0cnVjdG9yIChib3g6IFBhZ2VFbGVtZW50LCBvcHRzOiBJbmNyZW1lbnRhbElucHV0T3B0cykge1xuICAgIHN1cGVyKERvYy5zYWZlU2VsZWN0b3IoYm94LCAnaW5wdXQnKSwgb3B0cylcbiAgICB0aGlzLm9wdHMgPSBvcHRzXG4gICAgdGhpcy5pbmMgPSBvcHRzLmluYyA/PyAxXG5cbiAgICBjb25zdCB1cCA9IERvYy5zYWZlU2VsZWN0b3IoYm94LCAnLmljby1hcnJvd3VwJylcbiAgICBjb25zdCBkb3duID0gRG9jLnNhZmVTZWxlY3Rvcihib3gsICcuaWNvLWFycm93ZG93bicpXG5cbiAgICBEb2MuYmluZCh1cCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmluY3JlbWVudCgxKSB9KVxuICAgIERvYy5iaW5kKGRvd24sICdjbGljaycsICgpID0+IHsgdGhpcy5pbmNyZW1lbnQoLTEpIH0pXG4gIH1cblxuICBzZXRJbmNyZW1lbnRBbmRNaW5pbXVtIChpbmM6IG51bWJlciwgbWluOiBudW1iZXIpIHtcbiAgICB0aGlzLmluYyA9IGluY1xuICAgIHRoaXMubWluID0gbWluXG4gIH1cblxuICBpbmNyZW1lbnQgKHNpZ246IG51bWJlcikge1xuICAgIGNvbnN0IHsgaW5jLCBtaW4sIGlucHV0IH0gPSB0aGlzXG4gICAgaW5wdXQudmFsdWUgPSBTdHJpbmcoTWF0aC5tYXgodGhpcy52YWx1ZSgpICsgc2lnbiAqIGluYywgbWluKSlcbiAgICB0aGlzLmlucHV0Q2hhbmdlZCgpXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE1pbmlTbGlkZXIge1xuICB0cmFjazogUGFnZUVsZW1lbnRcbiAgYmFsbDogUGFnZUVsZW1lbnRcbiAgcjogbnVtYmVyXG4gIGNoYW5nZWQ6IChyOiBudW1iZXIpID0+IHZvaWRcblxuICBjb25zdHJ1Y3RvciAoYm94OiBQYWdlRWxlbWVudCwgY2hhbmdlZDogKHI6IG51bWJlcikgPT4gdm9pZCkge1xuICAgIHRoaXMuY2hhbmdlZCA9IGNoYW5nZWRcbiAgICB0aGlzLnIgPSAwXG5cbiAgICBjb25zdCBjb2xvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29sb3IuZGF0YXNldC50bXBsID0gJ2NvbG9yJ1xuICAgIGJveC5hcHBlbmRDaGlsZChjb2xvcilcbiAgICBjb25zdCB0cmFjayA9IHRoaXMudHJhY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIHRyYWNrLmRhdGFzZXQudG1wbCA9ICd0cmFjaydcbiAgICBjb2xvci5hcHBlbmRDaGlsZCh0cmFjaylcbiAgICBjb25zdCBiYWxsID0gdGhpcy5iYWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBiYWxsLmRhdGFzZXQudG1wbCA9ICdiYWxsJ1xuICAgIHRyYWNrLmFwcGVuZENoaWxkKGJhbGwpXG5cbiAgICBEb2MuYmluZChib3gsICdtb3VzZWRvd24nLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKGUuYnV0dG9uICE9PSAwKSByZXR1cm5cbiAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgY29uc3Qgc3RhcnRYID0gZS5wYWdlWFxuICAgICAgY29uc3QgdyA9IHRyYWNrLmNsaWVudFdpZHRoXG4gICAgICBjb25zdCBzdGFydExlZnQgPSB0aGlzLnIgKiB3XG4gICAgICBjb25zdCBsZWZ0ID0gKGVlOiBNb3VzZUV2ZW50KSA9PiBNYXRoLm1heChNYXRoLm1pbihzdGFydExlZnQgKyAoZWUucGFnZVggLSBzdGFydFgpLCB3KSwgMClcbiAgICAgIGNvbnN0IHRyYWNrTW91c2UgPSAoZWU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgZWUucHJldmVudERlZmF1bHQoKVxuICAgICAgICBjb25zdCBsID0gbGVmdChlZSlcbiAgICAgICAgdGhpcy5yID0gbCAvIHdcbiAgICAgICAgYmFsbC5zdHlsZS5sZWZ0ID0gYCR7dGhpcy5yICogMTAwfSVgXG4gICAgICAgIHRoaXMuY2hhbmdlZCh0aGlzLnIpXG4gICAgICB9XG4gICAgICBjb25zdCBtb3VzZVVwID0gKGVlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIHRyYWNrTW91c2UoZWUpXG4gICAgICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdtb3VzZW1vdmUnLCB0cmFja01vdXNlKVxuICAgICAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAnbW91c2V1cCcsIG1vdXNlVXApXG4gICAgICB9XG4gICAgICBEb2MuYmluZChkb2N1bWVudCwgJ21vdXNlbW92ZScsIHRyYWNrTW91c2UpXG4gICAgICBEb2MuYmluZChkb2N1bWVudCwgJ21vdXNldXAnLCBtb3VzZVVwKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChib3gsICdjbGljaycsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5idXR0b24gIT09IDApIHJldHVyblxuICAgICAgY29uc3QgeCA9IGUucGFnZVhcbiAgICAgIGNvbnN0IG0gPSBEb2MubGF5b3V0TWV0cmljcyh0cmFjaylcbiAgICAgIHRoaXMuciA9IGNsYW1wKCh4IC0gbS5ib2R5TGVmdCkgLyBtLndpZHRoLCAwLCAxKVxuICAgICAgYmFsbC5zdHlsZS5sZWZ0ID0gYCR7dGhpcy5yICogbS53aWR0aH1weGBcbiAgICAgIHRoaXMuY2hhbmdlZCh0aGlzLnIpXG4gICAgfSlcbiAgfVxuXG4gIHNldFZhbHVlIChyOiBudW1iZXIpIHtcbiAgICB0aGlzLnIgPSBjbGFtcChyLCAwLCAxKVxuICAgIHRoaXMuYmFsbC5zdHlsZS5sZWZ0ID0gYCR7dGhpcy5yICogMTAwfSVgXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvUHJlY2lzaW9uICh2OiBudW1iZXIsIHByZWM6IG51bWJlcik6IFtudW1iZXIsIHN0cmluZ10ge1xuICBjb25zdCBvcmQgPSBNYXRoLnBvdygxMCwgcHJlYyA/PyAwKVxuICB2ID0gTWF0aC5yb3VuZCh2ICogb3JkKSAvIG9yZFxuICBsZXQgcyA9IHYudG9GaXhlZChwcmVjKVxuICBpZiAocHJlYyA+IDApIHtcbiAgICB3aGlsZSAocy5lbmRzV2l0aCgnMCcpKSBzID0gcy5zdWJzdHJpbmcoMCwgcy5sZW5ndGggLSAxKVxuICAgIGlmIChzLmVuZHNXaXRoKCcuJykpIHMgPSBzLnN1YnN0cmluZygwLCBzLmxlbmd0aCAtIDEpXG4gIH1cbiAgcmV0dXJuIFt2LCBzXVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9Gb3VyU2lnRmlncyAodjogbnVtYmVyLCBtYXhQcmVjOiBudW1iZXIpOiBbbnVtYmVyLCBzdHJpbmddIHtcbiAgY29uc3Qgb3JkID0gTWF0aC5mbG9vcihNYXRoLmxvZzEwKE1hdGguYWJzKHYpKSlcbiAgaWYgKG9yZCA+PSAzKSByZXR1cm4gW01hdGgucm91bmQodiksIHYudG9GaXhlZCgwKV1cbiAgY29uc3QgcHJlYyA9IE1hdGgubWluKDQgLSBvcmQsIG1heFByZWMpXG4gIHJldHVybiB0b1ByZWNpc2lvbih2LCBwcmVjKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VGbG9hdERlZmF1bHQgKGlucHV0VmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCwgZGVmYXVsdFZhbHVlPzogbnVtYmVyKSB7XG4gIGNvbnN0IHYgPSBwYXJzZUZsb2F0KChpbnB1dFZhbHVlID8/ICcnKS5yZXBsYWNlKC8sL2csICcnKSlcbiAgaWYgKCFpc05hTih2KSkgcmV0dXJuIHZcbiAgcmV0dXJuIGRlZmF1bHRWYWx1ZSA/PyAwXG59XG5cbi8qIGNsYW1wIHJldHVybnMgdiBpZiBtaW4gPD0gdiA8PSBtYXgsIGVsc2UgbWluIG9yIG1heC4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGFtcCAodjogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xuICBpZiAodiA8IG1pbikgcmV0dXJuIG1pblxuICBpZiAodiA+IG1heCkgcmV0dXJuIG1heFxuICByZXR1cm4gdlxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0dXBDb3B5QnRuICh0eHQ6IHN0cmluZywgdGV4dEVsOiBQYWdlRWxlbWVudCwgYnRuRWw6IFBhZ2VFbGVtZW50LCBjb2xvcjogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodHh0KVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKCdVbmFibGUgdG8gY29weTogJywgZXJyKVxuICB9XG4gIGNvbnN0IHRleHRPcmlnaW5hbENvbG9yID0gdGV4dEVsLnN0eWxlLmNvbG9yXG4gIGNvbnN0IGJ0bk9yaWdpbmFsQ29sb3IgPSBidG5FbC5zdHlsZS5jb2xvclxuICB0ZXh0RWwuc3R5bGUuY29sb3IgPSBjb2xvclxuICBidG5FbC5zdHlsZS5jb2xvciA9IGNvbG9yXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHRleHRFbC5zdHlsZS5jb2xvciA9IHRleHRPcmlnaW5hbENvbG9yXG4gICAgYnRuRWwuc3R5bGUuY29sb3IgPSBidG5PcmlnaW5hbENvbG9yXG4gIH0sIDM1MClcbn1cbiIsImltcG9ydCBEb2MsIHsgQW5pbWF0aW9uIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgeyBwb3N0SlNPTiB9IGZyb20gJy4vaHR0cCdcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQgeyBXYXZlIH0gZnJvbSAnLi9jaGFydHMnXG5pbXBvcnQge1xuICBib25kUmVzZXJ2ZU11bHRpcGxpZXIsXG4gIHBlclRpZXJCYXNlUGFyY2VsTGltaXQsXG4gIHBhcmNlbExpbWl0U2NvcmVNdWx0aXBsaWVyLFxuICBzdHJvbmdUaWVyXG59IGZyb20gJy4vYWNjb3VudCdcbmltcG9ydCB7XG4gIGFwcCxcbiAgU3VwcG9ydGVkQXNzZXQsXG4gIFBhZ2VFbGVtZW50LFxuICBXYWxsZXREZWZpbml0aW9uLFxuICBDb25maWdPcHRpb24sXG4gIEV4Y2hhbmdlLFxuICBNYXJrZXQsXG4gIEJvbmRBc3NldCxcbiAgV2FsbGV0U3RhdGUsXG4gIEJhbGFuY2VOb3RlLFxuICBPcmRlcixcbiAgWFlSYW5nZSxcbiAgV2FsbGV0U3RhdGVOb3RlLFxuICBXYWxsZXRTeW5jTm90ZSxcbiAgV2FsbGV0SW5mbyxcbiAgVG9rZW4sXG4gIFdhbGxldENyZWF0aW9uTm90ZSxcbiAgQ29yZU5vdGUsXG4gIFByZXBhaWRCb25kSURcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7IFhZUmFuZ2VIYW5kbGVyIH0gZnJvbSAnLi9vcHRzJ1xuaW1wb3J0IHsgQ29pbkV4cGxvcmVycyB9IGZyb20gJy4vY29pbmV4cGxvcmVycydcbmltcG9ydCB7IE1NLCBzZXRDZXhFbGVtZW50cyB9IGZyb20gJy4vbW11dGlsJ1xuXG5pbnRlcmZhY2UgQ29uZmlnT3B0aW9uSW5wdXQgZXh0ZW5kcyBIVE1MSW5wdXRFbGVtZW50IHtcbiAgY29uZmlnT3B0OiBDb25maWdPcHRpb25cbn1cblxuaW50ZXJmYWNlIFByb2dyZXNzUG9pbnQge1xuICBzdGFtcDogbnVtYmVyXG4gIHByb2dyZXNzOiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIEN1cnJlbnRBc3NldCB7XG4gIGFzc2V0OiBTdXBwb3J0ZWRBc3NldFxuICBwYXJlbnRBc3NldD86IFN1cHBvcnRlZEFzc2V0XG4gIHdpbmZvOiBXYWxsZXRJbmZvIHwgVG9rZW5cbiAgLy8gc2VsZWN0ZWREZWYgaXMgdXNlZCBpbiBhIHN0cmFuZ2Ugd2F5IGZvciB0b2tlbnMuIElmIGEgdG9rZW4ncyBwYXJlbnQgd2FsbGV0XG4gIC8vIGFscmVhZHkgZXhpc3RzLCB0aGVuIHNlbGVjdGVkRGVmIGlzIGdvaW5nIHRvIGJlIHRoZSBUb2tlbi5kZWZpbml0aW9uLlxuICAvLyBCVVQsIGlmIHRoZSB0b2tlbidzIHBhcmVudCB3YWxsZXQgZG9lc24ndCBleGlzdCB5ZXQsIHRoZSBOZXdXYWxsZXRGb3JtXG4gIC8vIG9wZXJhdGVzIGluIGEgY29tYmluZWQgY29uZmlndXJhdGlvbiBtb2RlLCBhbmQgdGhlIHNlbGVjdGVkRGVmIHdpbGwgYmUgdGhlXG4gIC8vIGN1cnJlbnRseSBzZWxlY3RlZCBwYXJlbnQgYXNzZXQgZGVmaW5pdGlvbi4gVGhlcmUgaXMgbm8gbG9zcyBvZiBpbmZvXG4gIC8vIGluIHN1Y2ggYSBjYXNlLCBiZWNhdXNlIHRoZSB0b2tlbiB3YWxsZXQgb25seSBoYXMgb25lIGRlZmluaXRpb24uXG4gIHNlbGVjdGVkRGVmOiBXYWxsZXREZWZpbml0aW9uXG59XG5cbmludGVyZmFjZSBXYWxsZXRDb25maWcge1xuICBhc3NldElEOiBudW1iZXJcbiAgY29uZmlnOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gIHdhbGxldFR5cGU6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgRm9ybXNDb25maWcge1xuICBjbG9zZWQ/OiAoKSA9PiB2b2lkXG59XG5cbmV4cG9ydCBjbGFzcyBGb3JtcyB7XG4gIGZvcm1zRGl2OiBQYWdlRWxlbWVudFxuICBjdXJyZW50Rm9ybTogUGFnZUVsZW1lbnQgfCB1bmRlZmluZWRcbiAga2V5dXA6IChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG4gIGNsb3NlZD86ICgpID0+IHZvaWRcblxuICBjb25zdHJ1Y3RvciAoZm9ybXNEaXY6IFBhZ2VFbGVtZW50LCBjZmc/OiBGb3Jtc0NvbmZpZykge1xuICAgIHRoaXMuZm9ybXNEaXYgPSBmb3Jtc0RpdlxuICAgIHRoaXMuY2xvc2VkID0gY2ZnPy5jbG9zZWRcblxuICAgIGZvcm1zRGl2LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtLWNsb3NlcicpLmZvckVhY2goZWwgPT4ge1xuICAgICAgRG9jLmJpbmQoZWwsICdjbGljaycsICgpID0+IHsgdGhpcy5jbG9zZSgpIH0pXG4gICAgfSlcblxuICAgIERvYy5iaW5kKGZvcm1zRGl2LCAnbW91c2Vkb3duJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICghdGhpcy5jdXJyZW50Rm9ybSkgcmV0dXJuXG4gICAgICBpZiAoIURvYy5tb3VzZUluRWxlbWVudChlLCB0aGlzLmN1cnJlbnRGb3JtKSkgeyB0aGlzLmNsb3NlKCkgfVxuICAgIH0pXG5cbiAgICB0aGlzLmtleXVwID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuICB9XG5cbiAgLyogc2hvd0Zvcm0gc2hvd3MgYSBtb2RhbCBmb3JtIHdpdGggYSBsaXR0bGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBzaG93IChmb3JtOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY3VycmVudEZvcm0gPSBmb3JtXG4gICAgRG9jLmhpZGUoLi4uQXJyYXkuZnJvbSh0aGlzLmZvcm1zRGl2LmNoaWxkcmVuKSlcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzEwMDAwcHgnXG4gICAgRG9jLnNob3codGhpcy5mb3Jtc0RpdiwgZm9ybSlcbiAgICBjb25zdCBzaGlmdCA9ICh0aGlzLmZvcm1zRGl2Lm9mZnNldFdpZHRoICsgZm9ybS5vZmZzZXRXaWR0aCkgLyAyXG4gICAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pbWF0aW9uTGVuZ3RoLCBwcm9ncmVzcyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gYCR7KDEgLSBwcm9ncmVzcykgKiBzaGlmdH1weGBcbiAgICB9LCAnZWFzZU91dEhhcmQnKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMCdcbiAgfVxuXG4gIGNsb3NlICgpOiB2b2lkIHtcbiAgICBEb2MuaGlkZSh0aGlzLmZvcm1zRGl2KVxuICAgIGlmICh0aGlzLmNsb3NlZCkgdGhpcy5jbG9zZWQoKVxuICAgIHRoaXMuY3VycmVudEZvcm0gPSB1bmRlZmluZWRcbiAgfVxuXG4gIGV4aXQgKCkge1xuICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdrZXl1cCcsIHRoaXMua2V5dXApXG4gIH1cbn1cblxuLypcbiAqIE5ld1dhbGxldEZvcm0gc2hvdWxkIGJlIHVzZWQgd2l0aCB0aGUgXCJuZXdXYWxsZXRGb3JtXCIgdGVtcGxhdGUuIFRoZSBlbmNsb3NpbmdcbiAqIDxmb3JtPiBlbGVtZW50IHNob3VsZCBiZSB0aGUgZmlyc3QgYXJndW1lbnQgb2YgdGhlIGNvbnN0cnVjdG9yLlxuICovXG5leHBvcnQgY2xhc3MgTmV3V2FsbGV0Rm9ybSB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBmb3JtOiBIVE1MRWxlbWVudFxuICBzdWNjZXNzOiAoYXNzZXRJRDogbnVtYmVyKSA9PiB2b2lkXG4gIGN1cnJlbnQ6IEN1cnJlbnRBc3NldFxuICBzdWJmb3JtOiBXYWxsZXRDb25maWdGb3JtXG4gIHdhbGxldENmZ0d1aWRlOiBQYWdlRWxlbWVudFxuICBwYXJlbnRTeW5jZXI6IG51bGwgfCAoKHc6IFdhbGxldFN0YXRlKSA9PiB2b2lkKVxuICBjcmVhdGVVcGRhdGVyOiBudWxsIHwgKChub3RlOiBXYWxsZXRDcmVhdGlvbk5vdGUpID0+IHZvaWQpXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzdWNjZXNzOiAoYXNzZXRJRDogbnVtYmVyKSA9PiB2b2lkLCBiYWNrRnVuYz86ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShmb3JtKVxuXG4gICAgaWYgKGJhY2tGdW5jKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLmdvQmFjaylcbiAgICAgIERvYy5iaW5kKHBhZ2UuZ29CYWNrLCAnY2xpY2snLCAoKSA9PiB7IGJhY2tGdW5jKCkgfSlcbiAgICB9XG5cbiAgICBEb2MuZW1wdHkocGFnZS53YWxsZXRUYWJUbXBsKVxuICAgIHBhZ2Uud2FsbGV0VGFiVG1wbC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJylcblxuICAgIC8vIFdhbGxldENvbmZpZ0Zvcm0gd2lsbCBzZXQgdGhlIGdsb2JhbCBhcHAgdmFyaWFibGUuXG4gICAgdGhpcy5zdWJmb3JtID0gbmV3IFdhbGxldENvbmZpZ0Zvcm0ocGFnZS53YWxsZXRTZXR0aW5ncywgdHJ1ZSlcblxuICAgIHRoaXMud2FsbGV0Q2ZnR3VpZGUgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ3dhbGxldENmZ0d1aWRlJylcblxuICAgIGJpbmQoZm9ybSwgcGFnZS5zdWJtaXRBZGQsICgpID0+IHRoaXMuc3VibWl0KCkpXG4gICAgYmluZChmb3JtLCBwYWdlLm9uZUJ0dG4sICgpID0+IHRoaXMuc3VibWl0KCkpXG5cbiAgICBhcHAoKS5yZWdpc3Rlck5vdGVGZWVkZXIoe1xuICAgICAgd2FsbGV0c3RhdGU6IChub3RlOiBXYWxsZXRTdGF0ZU5vdGUpID0+IHsgdGhpcy5yZXBvcnRXYWxsZXRTdGF0ZShub3RlLndhbGxldCkgfSxcbiAgICAgIHdhbGxldHN5bmM6IChub3RlOiBXYWxsZXRTeW5jTm90ZSkgPT4geyBpZiAodGhpcy5wYXJlbnRTeW5jZXIpIHRoaXMucGFyZW50U3luY2VyKGFwcCgpLndhbGxldE1hcFtub3RlLmFzc2V0SURdKSB9LFxuICAgICAgY3JlYXRld2FsbGV0OiAobm90ZTogV2FsbGV0Q3JlYXRpb25Ob3RlKSA9PiB7IHRoaXMucmVwb3J0Q3JlYXRpb25VcGRhdGUobm90ZSkgfVxuICAgIH0pXG4gIH1cblxuICAvKlxuICAgKiByZXBvcnRXYWxsZXRTdGF0ZSBzaG91bGQgYmUgY2FsbGVkIHdoZW4gYSAnd2FsbGV0c3RhdGUnIG5vdGlmaWNhdGlvbiBpc1xuICAgKiByZWNlaXZlZC5cbiAgICogVE9ETzogTGV0IGZvcm0gY2xhc3NlcyByZWdpc3RlciBmb3Igbm90aWZpY2F0aW9ucy5cbiAgICovXG4gIHJlcG9ydFdhbGxldFN0YXRlICh3OiBXYWxsZXRTdGF0ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnBhcmVudFN5bmNlcikgdGhpcy5wYXJlbnRTeW5jZXIodylcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydFdhbGxldFN0YXRlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhICdjcmVhdGV3YWxsZXQnIG5vdGlmaWNhdGlvbiBpc1xuICAgKiByZWNlaXZlZC5cbiAgICovXG4gIHJlcG9ydENyZWF0aW9uVXBkYXRlIChub3RlOiBXYWxsZXRDcmVhdGlvbk5vdGUpIHtcbiAgICBpZiAodGhpcy5jcmVhdGVVcGRhdGVyKSB0aGlzLmNyZWF0ZVVwZGF0ZXIobm90ZSlcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVdhbGxldCAoYXNzZXRJRDogbnVtYmVyLCB3YWxsZXRUeXBlOiBzdHJpbmcsIHBhcmVudEZvcm0/OiBXYWxsZXRDb25maWcpIHtcbiAgICBjb25zdCBjcmVhdGVGb3JtID0ge1xuICAgICAgYXNzZXRJRDogYXNzZXRJRCxcbiAgICAgIHBhc3M6IHRoaXMucGFnZS5uZXdXYWxsZXRQYXNzLnZhbHVlIHx8ICcnLFxuICAgICAgY29uZmlnOiB0aGlzLnN1YmZvcm0ubWFwKGFzc2V0SUQpLFxuICAgICAgd2FsbGV0VHlwZTogd2FsbGV0VHlwZSxcbiAgICAgIHBhcmVudEZvcm06IHBhcmVudEZvcm1cbiAgICB9XG5cbiAgICBjb25zdCBhbmkgPSBuZXcgV2F2ZSh0aGlzLmZvcm0sIHsgYmFja2dyb3VuZENvbG9yOiB0cnVlIH0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvbmV3d2FsbGV0JywgY3JlYXRlRm9ybSlcbiAgICBhbmkuc3RvcCgpXG4gICAgcmV0dXJuIHJlc1xuICB9XG5cbiAgYXN5bmMgc3VibWl0ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbmV3V2FsbGV0UGFzcyA9IHBhZ2UubmV3V2FsbGV0UGFzcyBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgRG9jLmhpZGUocGFnZS5uZXdXYWxsZXRFcnIpXG5cbiAgICBjb25zdCB7IGFzc2V0LCBwYXJlbnRBc3NldCB9ID0gdGhpcy5jdXJyZW50XG4gICAgY29uc3Qgc2VsZWN0ZWREZWYgPSB0aGlzLmN1cnJlbnQuc2VsZWN0ZWREZWZcbiAgICBsZXQgcGFyZW50Rm9ybVxuICAgIGxldCB3YWxsZXRUeXBlID0gc2VsZWN0ZWREZWYudHlwZVxuICAgIGlmIChwYXJlbnRBc3NldCkge1xuICAgICAgd2FsbGV0VHlwZSA9IChhc3NldC50b2tlbiBhcyBUb2tlbikuZGVmaW5pdGlvbi50eXBlXG4gICAgICBwYXJlbnRGb3JtID0ge1xuICAgICAgICBhc3NldElEOiBwYXJlbnRBc3NldC5pZCxcbiAgICAgICAgY29uZmlnOiB0aGlzLnN1YmZvcm0ubWFwKHBhcmVudEFzc2V0LmlkKSxcbiAgICAgICAgd2FsbGV0VHlwZTogc2VsZWN0ZWREZWYudHlwZVxuICAgICAgfVxuICAgIH1cbiAgICAvLyBSZWdpc3RlciB0aGUgc2VsZWN0ZWQgYXNzZXQuXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5jcmVhdGVXYWxsZXQoYXNzZXQuaWQsIHdhbGxldFR5cGUsIHBhcmVudEZvcm0pXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHRoaXMuc2V0RXJyb3IocmVzLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBuZXdXYWxsZXRQYXNzLnZhbHVlID0gJydcbiAgICBpZiAocGFyZW50QXNzZXQpIGF3YWl0IHRoaXMucnVuUGFyZW50U3luYygpXG4gICAgZWxzZSB0aGlzLnN1Y2Nlc3ModGhpcy5jdXJyZW50LmFzc2V0LmlkKVxuICB9XG5cbiAgLypcbiAgICogcnVuUGFyZW50U3luYyBzaG93cyBhIHN5bmNpbmcgc3ViLWRpYWxvZyB0aGF0IHRyYWNrcyB0aGUgcGFyZW50IGFzc2V0J3NcbiAgICogc3luY1Byb2dyZXNzIGFuZCBpbmZvcm1zIHRoZSB1c2VyIHRoYXQgdGhlIHRva2VuIHdhbGxldCB3aWxsIGJlIGNyZWF0ZWRcbiAgICogYWZ0ZXIgc3luYyBpcyBjb21wbGV0ZS5cbiAgICovXG4gIGFzeW5jIHJ1blBhcmVudFN5bmMgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgY3VycmVudDogeyBwYXJlbnRBc3NldCwgYXNzZXQgfSB9ID0gdGhpc1xuICAgIGlmICghcGFyZW50QXNzZXQpIHJldHVyblxuXG4gICAgcGFnZS5wYXJlbnRTeW5jUGN0LnRleHRDb250ZW50ID0gJzAnXG4gICAgcGFnZS5wYXJlbnROYW1lLnRleHRDb250ZW50ID0gcGFyZW50QXNzZXQubmFtZVxuICAgIHBhZ2UucGFyZW50TG9nby5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50QXNzZXQuc3ltYm9sKVxuICAgIHBhZ2UuY2hpbGROYW1lLnRleHRDb250ZW50ID0gYXNzZXQubmFtZVxuICAgIHBhZ2UuY2hpbGRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChhc3NldC5zeW1ib2wpXG4gICAgRG9jLmhpZGUocGFnZS5tYWluRm9ybSlcbiAgICBEb2Muc2hvdyhwYWdlLnBhcmVudFN5bmNpbmcpXG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zeW5jUGFyZW50KHBhcmVudEFzc2V0KVxuICAgICAgdGhpcy5zdWNjZXNzKHRoaXMuY3VycmVudC5hc3NldC5pZClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5zZXRFcnJvcihlcnJvci5tZXNzYWdlIHx8IGVycm9yKVxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLm1haW5Gb3JtKVxuICAgIERvYy5oaWRlKHBhZ2UucGFyZW50U3luY2luZylcbiAgfVxuXG4gIC8qXG4gICAqIHN5bmNQYXJlbnQgbW9uaXRvcnMgdGhlIHN5bmMgcHJvZ3Jlc3Mgb2YgYSB0b2tlbidzIHBhcmVudCBhc3NldCwgZ2VuZXJhdGluZ1xuICAgKiBhbiBFcnJvciBpZiB0aGUgdG9rZW4gd2FsbGV0IGNyZWF0aW9uIGRvZXMgbm90IGNvbXBsZXRlIHN1Y2Nlc3NmdWxseS5cbiAgICovXG4gIHN5bmNQYXJlbnQgKHBhcmVudEFzc2V0OiBTdXBwb3J0ZWRBc3NldCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgcGFnZSwgY3VycmVudDogeyBhc3NldCB9IH0gPSB0aGlzXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIC8vIEZpcnN0LCBjaGVjayBpZiBpdCdzIGFscmVhZHkgc3luY2VkLlxuICAgICAgY29uc3QgdyA9IGFwcCgpLmFzc2V0c1twYXJlbnRBc3NldC5pZF0ud2FsbGV0XG4gICAgICBpZiAodyAmJiB3LnN5bmNlZCkgcmV0dXJuIHJlc29sdmUoKVxuICAgICAgLy8gTm90IHN5bmNlZCwgc28gY3JlYXRlIGEgc3luY2VyIHRvIHVwZGF0ZSB0aGUgcGFyZW50IHN5bmMgcGFuZS5cbiAgICAgIHRoaXMucGFyZW50U3luY2VyID0gKHc6IFdhbGxldFN0YXRlKSA9PiB7XG4gICAgICAgIGlmICh3LmFzc2V0SUQgIT09IHBhcmVudEFzc2V0LmlkKSByZXR1cm5cbiAgICAgICAgcGFnZS5wYXJlbnRTeW5jUGN0LnRleHRDb250ZW50ID0gKHcuc3luY1Byb2dyZXNzICogMTAwKS50b0ZpeGVkKDEpXG4gICAgICB9XG4gICAgICAvLyBIYW5kbGUgdGhlIGFzeW5jIHJlc3VsdC5cbiAgICAgIHRoaXMuY3JlYXRlVXBkYXRlciA9IChub3RlOiBXYWxsZXRDcmVhdGlvbk5vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUuYXNzZXRJRCAhPT0gYXNzZXQuaWQpIHJldHVyblxuICAgICAgICBzd2l0Y2ggKG5vdGUudG9waWMpIHtcbiAgICAgICAgICBjYXNlICdRdWV1ZWRDcmVhdGlvbkZhaWxlZCc6XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGAke25vdGUuc3ViamVjdH06ICR7bm90ZS5kZXRhaWxzfWApKVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICBjYXNlICdRdWV1ZWRDcmVhdGlvblN1Y2Nlc3MnOlxuICAgICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudFN5bmNlciA9IG51bGxcbiAgICAgICAgdGhpcy5jcmVhdGVVcGRhdGVyID0gbnVsbFxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKiBzZXRBc3NldCBzZXRzIHRoZSBjdXJyZW50IGFzc2V0IG9mIHRoZSBOZXdXYWxsZXRGb3JtICovXG4gIGFzeW5jIHNldEFzc2V0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBpZiAoIXRoaXMucGFyc2VBc3NldChhc3NldElEKSkgcmV0dXJuIC8vIG5vdGhpbmcgdG8gY2hhbmdlXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IHRhYnMgPSBwYWdlLndhbGxldFR5cGVUYWJzXG4gICAgY29uc3QgeyB3aW5mbywgYXNzZXQsIHBhcmVudEFzc2V0IH0gPSB0aGlzLmN1cnJlbnRcbiAgICBwYWdlLmFzc2V0TmFtZS50ZXh0Q29udGVudCA9IHdpbmZvLm5hbWVcbiAgICBwYWdlLm5ld1dhbGxldFBhc3MudmFsdWUgPSAnJ1xuXG4gICAgRG9jLmVtcHR5KHRhYnMpXG4gICAgRG9jLmhpZGUodGFicywgcGFnZS5uZXdXYWxsZXRFcnIsIHBhZ2UudG9rZW5Nc2dCb3gpXG4gICAgdGhpcy5wYWdlLmFzc2V0TG9nby5zcmMgPSBEb2MubG9nb1BhdGgoYXNzZXQuc3ltYm9sKVxuICAgIGlmIChwYXJlbnRBc3NldCkge1xuICAgICAgcGFnZS50b2tlblBhcmVudExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHBhcmVudEFzc2V0LnN5bWJvbClcbiAgICAgIHBhZ2UudG9rZW5QYXJlbnROYW1lLnRleHRDb250ZW50ID0gcGFyZW50QXNzZXQubmFtZVxuICAgICAgRG9jLnNob3cocGFnZS50b2tlbk1zZ0JveClcbiAgICB9XG5cbiAgICBjb25zdCBwaW5mbyA9IHBhcmVudEFzc2V0ID8gcGFyZW50QXNzZXQuaW5mbyA6IG51bGxcbiAgICBjb25zdCB3YWxsZXREZWZzID0gcGluZm8gPyBwaW5mby5hdmFpbGFibGV3YWxsZXRzIDogKHdpbmZvIGFzIFdhbGxldEluZm8pLmF2YWlsYWJsZXdhbGxldHMgPyAod2luZm8gYXMgV2FsbGV0SW5mbykuYXZhaWxhYmxld2FsbGV0cyA6IFsod2luZm8gYXMgVG9rZW4pLmRlZmluaXRpb25dXG5cbiAgICBpZiAod2FsbGV0RGVmcy5sZW5ndGggPiAxKSB7XG4gICAgICBEb2Muc2hvdyh0YWJzKVxuICAgICAgZm9yIChjb25zdCB3RGVmIG9mIHdhbGxldERlZnMpIHtcbiAgICAgICAgY29uc3QgdGFiID0gcGFnZS53YWxsZXRUYWJUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgICB0YWIuZGF0YXNldC50b29sdGlwID0gd0RlZi5kZXNjcmlwdGlvblxuICAgICAgICB0YWIudGV4dENvbnRlbnQgPSB3RGVmLnRhYlxuICAgICAgICB0YWJzLmFwcGVuZENoaWxkKHRhYilcbiAgICAgICAgRG9jLmJpbmQodGFiLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgZm9yIChjb25zdCB0IG9mIERvYy5raWRzKHRhYnMpKSB0LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICAgICAgICB0YWIuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuICAgICAgICAgIHRoaXMudXBkYXRlKHdEZWYpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBhcHAoKS5iaW5kVG9vbHRpcHModGFicylcbiAgICAgIGNvbnN0IGZpcnN0ID0gdGFicy5maXJzdENoaWxkIGFzIEhUTUxFbGVtZW50XG4gICAgICBmaXJzdC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy51cGRhdGUodGhpcy5jdXJyZW50LnNlbGVjdGVkRGVmKVxuICAgIGlmIChhc3NldC53YWxsZXRDcmVhdGlvblBlbmRpbmcpIGF3YWl0IHRoaXMucnVuUGFyZW50U3luYygpXG4gIH1cblxuICAvKlxuICAqIHBhcnNlQXNzZXQgcGFyc2VzIHRoZSBjdXJyZW50IGRhdGEgZm9yIHRoZSBhc3NldCBJRC5cbiAgKi9cbiAgcGFyc2VBc3NldCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudCAmJiB0aGlzLmN1cnJlbnQuYXNzZXQuaWQgPT09IGFzc2V0SUQpIHJldHVybiBmYWxzZVxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgdG9rZW4gPSBhc3NldC50b2tlblxuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIGlmICghYXNzZXQuaW5mbykgdGhyb3cgRXJyb3IoJ3RoaXMgbm9uLXRva2VuIGFzc2V0IGhhcyBubyB3YWxsZXQgaW5mbyEnKVxuICAgICAgdGhpcy5jdXJyZW50ID0geyBhc3NldCwgd2luZm86IGFzc2V0LmluZm8sIHNlbGVjdGVkRGVmOiBhc3NldC5pbmZvLmF2YWlsYWJsZXdhbGxldHNbMF0gfVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS51c2VyLmFzc2V0c1t0b2tlbi5wYXJlbnRJRF1cbiAgICBpZiAocGFyZW50QXNzZXQud2FsbGV0KSB7XG4gICAgICAvLyBJZiB0aGUgcGFyZW50IGFzc2V0IGFscmVhZHkgaGFzIGEgd2FsbGV0LCB0aGVyZSdzIG5vIG5lZWQgdG8gY29uZmlndXJlXG4gICAgICAvLyB0aGUgcGFyZW50IHRvby4gSnVzdCBjb25maWd1cmUgdGhlIHRva2VuLlxuICAgICAgdGhpcy5jdXJyZW50ID0geyBhc3NldCwgd2luZm86IHRva2VuLCBzZWxlY3RlZERlZjogdG9rZW4uZGVmaW5pdGlvbiB9XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBpZiAoIXBhcmVudEFzc2V0LmluZm8pIHRocm93IEVycm9yKCd0aGlzIHBhcmVudCBoYXMgbm8gd2FsbGV0IGluZm8hJylcbiAgICB0aGlzLmN1cnJlbnQgPSB7IGFzc2V0LCBwYXJlbnRBc3NldCwgd2luZm86IHRva2VuLCBzZWxlY3RlZERlZjogcGFyZW50QXNzZXQuaW5mby5hdmFpbGFibGV3YWxsZXRzWzBdIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlICh3YWxsZXREZWY6IFdhbGxldERlZmluaXRpb24pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5jdXJyZW50LnNlbGVjdGVkRGVmID0gd2FsbGV0RGVmXG4gICAgRG9jLmhpZGUocGFnZS53YWxsZXRQYXNzQW5kU3VibWl0QnR0biwgcGFnZS5vbmVCdHRuQm94LCBwYWdlLm5ld1dhbGxldFBhc3NCb3gpXG4gICAgY29uc3QgZ3VpZGVMaW5rID0gd2FsbGV0RGVmLmd1aWRlbGlua1xuICAgIGNvbnN0IGNvbmZpZ09wdHMgPSB3YWxsZXREZWYuY29uZmlnb3B0cyB8fCBbXVxuICAgIC8vIElmIGEgY29uZmlnIHJlcHJlc2VudHMgYSB3YWxsZXQncyBiaXJ0aGRheSwgd2UgdXBkYXRlIHRoZSBkZWZhdWx0XG4gICAgLy8gc2VsZWN0aW9uIHRvIHRoZSBjdXJyZW50IGRhdGUgaWYgdGhpcyBpbnN0YWxsYXRpb24gb2YgdGhlIGNsaWVudFxuICAgIC8vIGdlbmVyYXRlZCBhIHNlZWQuXG4gICAgY29uZmlnT3B0cy5tYXAoKG9wdCkgPT4ge1xuICAgICAgaWYgKG9wdC5pc0JpcnRoZGF5Q29uZmlnICYmIGFwcCgpLnNlZWRHZW5UaW1lID4gMCkge1xuICAgICAgICBvcHQuZGVmYXVsdCA9IHRvVW5peERhdGUobmV3IERhdGUoKSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBvcHRcbiAgICB9KVxuICAgIC8vIEVpdGhlciB0aGlzIGlzIGEgd2FsbGV0RGVmIGZvciBhIHRva2VuJ3MgdW5jcmVhdGVkIHBhcmVudCBhc3NldCwgb3IgdGhpc1xuICAgIC8vIGlzIHRoZSBkZWZpbml0aW9uIGZvciB0aGUgdG9rZW4uXG4gICAgbGV0IGNvbnRhaW5zUmVxdWlyZWQgPSBmYWxzZVxuICAgIGZvciAoY29uc3Qgb3B0IG9mIGNvbmZpZ09wdHMpIHtcbiAgICAgIGlmIChvcHQucmVxdWlyZWQpIHtcbiAgICAgICAgY29udGFpbnNSZXF1aXJlZCA9IHRydWVcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgeyBhc3NldCwgcGFyZW50QXNzZXQsIHdpbmZvIH0gPSB0aGlzLmN1cnJlbnRcbiAgICBjb25zdCBkaXNwbGF5Q3JlYXRlQnRuID0gd2FsbGV0RGVmLnNlZWRlZCB8fCBCb29sZWFuKGFzc2V0LnRva2VuKVxuICAgIGlmIChkaXNwbGF5Q3JlYXRlQnRuICYmICFjb250YWluc1JlcXVpcmVkKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLndhbGxldFNldHRpbmdzSGVhZGVyKVxuICAgICAgRG9jLnNob3cocGFnZS5vbmVCdHRuQm94KVxuICAgIH0gZWxzZSBpZiAoZGlzcGxheUNyZWF0ZUJ0bikge1xuICAgICAgRG9jLnNob3cocGFnZS53YWxsZXRQYXNzQW5kU3VibWl0QnR0biwgcGFnZS53YWxsZXRTZXR0aW5nc0hlYWRlcilcbiAgICAgIHBhZ2UubmV3V2FsbGV0UGFzcy52YWx1ZSA9ICcnXG4gICAgICBwYWdlLnN1Ym1pdEFkZC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0NSRUFURSlcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLnNob3cocGFnZS53YWxsZXRQYXNzQW5kU3VibWl0QnR0biwgcGFnZS53YWxsZXRTZXR0aW5nc0hlYWRlcilcbiAgICAgIGlmICghd2FsbGV0RGVmLm5vYXV0aCkgRG9jLnNob3cocGFnZS5uZXdXYWxsZXRQYXNzQm94KVxuICAgICAgcGFnZS5zdWJtaXRBZGQudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BREQpXG4gICAgfVxuXG4gICAgaWYgKHBhcmVudEFzc2V0KSB7XG4gICAgICBjb25zdCBwYXJlbnRBbmRUb2tlbk9wdHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbmZpZ09wdHMpKVxuICAgICAgLy8gQWRkIHRoZSByZWdBc3NldCBmaWVsZCB0byB0aGUgY29uZmlndXJhdGlvbnMgc28gcHJvcGVyIGxvZ29zIHdpbGwgYmUgZGlzcGxheWVkXG4gICAgICAvLyBuZXh0IHRvIHRoZW0sIGFuZCBtYXAgY2FuIGZpbHRlciB0aGVtIG91dC4gVGhlIG9wdHMgYXJlIGNvcGllZCBoZXJlIHNvIHRoZSBvcmlnaW5hbHNcbiAgICAgIC8vIGRvIG5vdCBoYXZlIHRoZSByZWdBc3NldCBmaWVsZCBhZGRlZCB0byB0aGVtLlxuICAgICAgZm9yIChjb25zdCBvcHQgb2YgcGFyZW50QW5kVG9rZW5PcHRzKSBvcHQucmVnQXNzZXQgPSBwYXJlbnRBc3NldC5pZFxuICAgICAgY29uc3QgdG9rZW5PcHRzID0gKHdpbmZvIGFzIFRva2VuKS5kZWZpbml0aW9uLmNvbmZpZ29wdHMgfHwgW11cbiAgICAgIGlmICh0b2tlbk9wdHMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCB0b2tlbk9wdHNDb3B5ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0b2tlbk9wdHMpKVxuICAgICAgICBmb3IgKGNvbnN0IG9wdCBvZiB0b2tlbk9wdHNDb3B5KSBvcHQucmVnQXNzZXQgPSBhc3NldC5pZFxuICAgICAgICBwYXJlbnRBbmRUb2tlbk9wdHMucHVzaCguLi50b2tlbk9wdHNDb3B5KVxuICAgICAgfVxuICAgICAgdGhpcy5zdWJmb3JtLnVwZGF0ZShhc3NldC5pZCwgcGFyZW50QW5kVG9rZW5PcHRzLCBmYWxzZSlcbiAgICB9IGVsc2UgdGhpcy5zdWJmb3JtLnVwZGF0ZShhc3NldC5pZCwgY29uZmlnT3B0cywgZmFsc2UpXG4gICAgdGhpcy5zZXRHdWlkZUxpbmsoZ3VpZGVMaW5rKVxuXG4gICAgLy8gQSBzZWVkZWQgb3IgdG9rZW4gd2FsbGV0IGlzIGludGVybmFsIHRvIEJpc29uIFdhbGxldCBhbmQgYXMgc3VjaCBkb2VzXG4gICAgLy8gbm90IGhhdmUgYW4gZXh0ZXJuYWwgY29uZmlnIGZpbGUgdG8gc2VsZWN0LlxuICAgIGlmICh3YWxsZXREZWYuc2VlZGVkIHx8IEJvb2xlYW4odGhpcy5jdXJyZW50LmFzc2V0LnRva2VuKSkgRG9jLmhpZGUodGhpcy5zdWJmb3JtLmZpbGVTZWxlY3RvcilcbiAgICBlbHNlIERvYy5zaG93KHRoaXMuc3ViZm9ybS5maWxlU2VsZWN0b3IpXG5cbiAgICBhd2FpdCB0aGlzLmxvYWREZWZhdWx0cygpXG4gIH1cblxuICBzZXRHdWlkZUxpbmsgKGd1aWRlTGluazogc3RyaW5nKSB7XG4gICAgRG9jLmhpZGUodGhpcy53YWxsZXRDZmdHdWlkZSlcbiAgICBpZiAoZ3VpZGVMaW5rICE9PSAnJykge1xuICAgICAgdGhpcy53YWxsZXRDZmdHdWlkZS5ocmVmID0gZ3VpZGVMaW5rXG4gICAgICBEb2Muc2hvdyh0aGlzLndhbGxldENmZ0d1aWRlKVxuICAgIH1cbiAgfVxuXG4gIC8qIHNldEVycm9yIHNldHMgYW5kIHNob3dzIHRoZSBpbi1mb3JtIGVycm9yIG1lc3NhZ2UuICovXG4gIGFzeW5jIHNldEVycm9yIChlcnJNc2c6IHN0cmluZykge1xuICAgIHRoaXMucGFnZS5uZXdXYWxsZXRFcnIudGV4dENvbnRlbnQgPSBlcnJNc2dcbiAgICBEb2Muc2hvdyh0aGlzLnBhZ2UubmV3V2FsbGV0RXJyKVxuICB9XG5cbiAgLypcbiAgICogbG9hZERlZmF1bHRzIGF0dGVtcHRzIHRvIGxvYWQgdGhlIEV4Y2hhbmdlV2FsbGV0IGNvbmZpZ3VyYXRpb24gZnJvbSB0aGVcbiAgICogZGVmYXVsdCB3YWxsZXQgY29uZmlnIHBhdGggb24gdGhlIHNlcnZlciBhbmQgd2lsbCBhdXRvLWZpbGwgdGhlIHBhZ2Ugb25cbiAgICogdGhlIHN1YmZvcm0gaWYgc2V0dGluZ3MgYXJlIGZvdW5kLlxuICAgKi9cbiAgYXN5bmMgbG9hZERlZmF1bHRzICgpIHtcbiAgICAvLyBObyBkZWZhdWx0IGNvbmZpZyBmaWxlcyBmb3Igc2VlZGVkIGFzc2V0cyByaWdodCBub3cuXG4gICAgY29uc3QgeyBhc3NldCwgcGFyZW50QXNzZXQsIHNlbGVjdGVkRGVmIH0gPSB0aGlzLmN1cnJlbnRcbiAgICBpZiAoIXNlbGVjdGVkRGVmLmNvbmZpZ3BhdGgpIHJldHVyblxuICAgIGxldCBjb25maWdJRCA9IGFzc2V0LmlkXG4gICAgaWYgKHBhcmVudEFzc2V0KSB7XG4gICAgICBpZiAoc2VsZWN0ZWREZWYuc2VlZGVkKSByZXR1cm5cbiAgICAgIGNvbmZpZ0lEID0gcGFyZW50QXNzZXQuaWRcbiAgICB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvZGVmYXVsdHdhbGxldGNmZycsIHtcbiAgICAgIGFzc2V0SUQ6IGNvbmZpZ0lELFxuICAgICAgdHlwZTogc2VsZWN0ZWREZWYudHlwZVxuICAgIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgdGhpcy5zZXRFcnJvcihyZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuc3ViZm9ybS5zZXRMb2FkZWRDb25maWcocmVzLmNvbmZpZylcbiAgfVxufVxuXG5sZXQgZHluYW1pY0lucHV0Q291bnRlciA9IDBcblxuLypcbiAqIFdhbGxldENvbmZpZ0Zvcm0gaXMgYSBkeW5hbWljYWxseSBnZW5lcmF0ZWQgc3ViLWZvcm0gZm9yIHNldHRpbmdcbiAqIGFzc2V0LXNwZWNpZmljIHdhbGxldCBjb25maWd1cmF0aW9uIG9wdGlvbnMuXG4qL1xuZXhwb3J0IGNsYXNzIFdhbGxldENvbmZpZ0Zvcm0ge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgZm9ybTogSFRNTEVsZW1lbnRcbiAgY29uZmlnRWxlbWVudHM6IFtDb25maWdPcHRpb24sIEhUTUxFbGVtZW50XVtdXG4gIGNvbmZpZ09wdHM6IENvbmZpZ09wdGlvbltdXG4gIHNlY3Rpb25pemU6IGJvb2xlYW5cbiAgYWxsU2V0dGluZ3M6IFBhZ2VFbGVtZW50XG4gIGR5bmFtaWNPcHRzOiBQYWdlRWxlbWVudFxuICB0ZXh0SW5wdXRUbXBsOiBQYWdlRWxlbWVudFxuICBkYXRlSW5wdXRUbXBsOiBQYWdlRWxlbWVudFxuICBjaGVja2JveFRtcGw6IFBhZ2VFbGVtZW50XG4gIHJlcGVhdGFibGVUbXBsOiBQYWdlRWxlbWVudFxuICBmaWxlU2VsZWN0b3I6IFBhZ2VFbGVtZW50XG4gIGZpbGVJbnB1dDogUGFnZUVsZW1lbnRcbiAgZXJyTXNnOiBQYWdlRWxlbWVudFxuICBzaG93T3RoZXI6IFBhZ2VFbGVtZW50XG4gIHNob3dJY29uOiBQYWdlRWxlbWVudFxuICBoaWRlSWNvbjogUGFnZUVsZW1lbnRcbiAgc2hvd0hpZGVNc2c6IFBhZ2VFbGVtZW50XG4gIG90aGVyU2V0dGluZ3M6IFBhZ2VFbGVtZW50XG4gIGxvYWRlZFNldHRpbmdzTXNnOiBQYWdlRWxlbWVudFxuICBsb2FkZWRTZXR0aW5nczogUGFnZUVsZW1lbnRcbiAgZGVmYXVsdFNldHRpbmdzTXNnOiBQYWdlRWxlbWVudFxuICBkZWZhdWx0U2V0dGluZ3M6IFBhZ2VFbGVtZW50XG4gIGFzc2V0SGFzQWN0aXZlT3JkZXJzOiBib29sZWFuXG4gIGFzc2V0SUQ6IG51bWJlclxuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBIVE1MRWxlbWVudCwgc2VjdGlvbml6ZTogYm9vbGVhbikge1xuICAgIHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGZvcm0pXG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIC8vIEEgY29uZmlnRWxlbWVudCBpcyBhIGRpdiBjb250YWluaW5nIGFuIGlucHV0IGFuZCBpdHMgbGFiZWwuXG4gICAgdGhpcy5jb25maWdFbGVtZW50cyA9IFtdXG4gICAgLy8gY29uZmlnT3B0cyBpcyB0aGUgd2FsbGV0IG9wdGlvbnMgcHJvdmlkZWQgYnkgY29yZS5cbiAgICB0aGlzLmNvbmZpZ09wdHMgPSBbXVxuICAgIHRoaXMuc2VjdGlvbml6ZSA9IHNlY3Rpb25pemVcblxuICAgIC8vIEdldCB0ZW1wbGF0ZSBlbGVtZW50c1xuICAgIHRoaXMuYWxsU2V0dGluZ3MgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2FsbFNldHRpbmdzJylcbiAgICB0aGlzLmR5bmFtaWNPcHRzID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdkeW5hbWljT3B0cycpXG4gICAgdGhpcy50ZXh0SW5wdXRUbXBsID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICd0ZXh0SW5wdXQnKVxuICAgIHRoaXMudGV4dElucHV0VG1wbC5yZW1vdmUoKVxuICAgIHRoaXMuZGF0ZUlucHV0VG1wbCA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnZGF0ZUlucHV0JylcbiAgICB0aGlzLmRhdGVJbnB1dFRtcGwucmVtb3ZlKClcbiAgICB0aGlzLmNoZWNrYm94VG1wbCA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnY2hlY2tib3gnKVxuICAgIHRoaXMuY2hlY2tib3hUbXBsLnJlbW92ZSgpXG4gICAgdGhpcy5yZXBlYXRhYmxlVG1wbCA9IERvYy50bXBsRWxlbWVudChmb3JtLCAncmVwZWF0YWJsZUlucHV0JylcbiAgICB0aGlzLnJlcGVhdGFibGVUbXBsLnJlbW92ZSgpXG4gICAgdGhpcy5maWxlU2VsZWN0b3IgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2ZpbGVTZWxlY3RvcicpXG4gICAgdGhpcy5maWxlSW5wdXQgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2ZpbGVJbnB1dCcpXG4gICAgdGhpcy5lcnJNc2cgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2Vyck1zZycpXG4gICAgdGhpcy5zaG93T3RoZXIgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ3Nob3dPdGhlcicpXG4gICAgdGhpcy5zaG93SWNvbiA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnc2hvd0ljb24nKVxuICAgIHRoaXMuaGlkZUljb24gPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2hpZGVJY29uJylcbiAgICB0aGlzLnNob3dIaWRlTXNnID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdzaG93SGlkZU1zZycpXG4gICAgdGhpcy5vdGhlclNldHRpbmdzID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdvdGhlclNldHRpbmdzJylcbiAgICB0aGlzLmxvYWRlZFNldHRpbmdzTXNnID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdsb2FkZWRTZXR0aW5nc01zZycpXG4gICAgdGhpcy5sb2FkZWRTZXR0aW5ncyA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnbG9hZGVkU2V0dGluZ3MnKVxuICAgIHRoaXMuZGVmYXVsdFNldHRpbmdzTXNnID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdkZWZhdWx0U2V0dGluZ3NNc2cnKVxuICAgIHRoaXMuZGVmYXVsdFNldHRpbmdzID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdkZWZhdWx0U2V0dGluZ3MnKVxuXG4gICAgaWYgKCFzZWN0aW9uaXplKSBEb2MuaGlkZSh0aGlzLnNob3dPdGhlcilcblxuICAgIERvYy5iaW5kKHRoaXMuZmlsZVNlbGVjdG9yLCAnY2xpY2snLCAoKSA9PiB0aGlzLmZpbGVJbnB1dC5jbGljaygpKVxuXG4gICAgLy8gY29uZmlnIGZpbGUgdXBsb2FkXG4gICAgRG9jLmJpbmQodGhpcy5maWxlSW5wdXQsICdjaGFuZ2UnLCBhc3luYyAoKSA9PiB0aGlzLmZpbGVJbnB1dENoYW5nZWQoKSlcblxuICAgIERvYy5iaW5kKHRoaXMuc2hvd090aGVyLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnNldE90aGVyU2V0dGluZ3NWaXoodGhpcy5oaWRlSWNvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2QtaGlkZScpKVxuICAgIH0pXG4gIH1cblxuICAvKlxuICAgKiBmaWxlSW5wdXRDaGFuZ2VkIHdpbGwgcmVhZCB0aGUgc2VsZWN0ZWQgZmlsZSBhbmQgYXR0ZW1wdCB0byBsb2FkIHRoZVxuICAgKiBjb25maWd1cmF0aW9uIHNldHRpbmdzLiBBbGwgbG9hZGVkIHNldHRpbmdzIHdpbGwgYmUgbWFkZSB2aXNpYmxlIGZvclxuICAgKiBpbnNwZWN0aW9uIGJ5IHRoZSB1c2VyLlxuICAgKi9cbiAgYXN5bmMgZmlsZUlucHV0Q2hhbmdlZCAoKSB7XG4gICAgRG9jLmhpZGUodGhpcy5lcnJNc2cpXG4gICAgaWYgKCF0aGlzLmZpbGVJbnB1dC52YWx1ZSkgcmV0dXJuXG4gICAgY29uc3QgZmlsZXMgPSB0aGlzLmZpbGVJbnB1dC5maWxlc1xuICAgIGlmICghZmlsZXMgfHwgZmlsZXMubGVuZ3RoID09PSAwKSByZXR1cm5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuZm9ybSlcbiAgICBjb25zdCBjb25maWcgPSBhd2FpdCBmaWxlc1swXS50ZXh0KClcbiAgICBpZiAoIWNvbmZpZykgcmV0dXJuXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvcGFyc2Vjb25maWcnLCB7XG4gICAgICBjb25maWd0ZXh0OiBjb25maWdcbiAgICB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHRoaXMuZXJyTXNnLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3codGhpcy5lcnJNc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKE9iamVjdC5rZXlzKHJlcy5tYXApLmxlbmd0aCA9PT0gMCkgcmV0dXJuXG4gICAgdGhpcy5keW5hbWljT3B0cy5hcHBlbmQoLi4udGhpcy5zZXRDb25maWcocmVzLm1hcCkpXG4gICAgdGhpcy5yZW9yZGVyKHRoaXMuZHluYW1pY09wdHMpXG4gICAgY29uc3QgW2xvYWRlZE9wdHMsIGRlZmF1bHRPcHRzXSA9IFt0aGlzLmxvYWRlZFNldHRpbmdzLmNoaWxkcmVuLmxlbmd0aCwgdGhpcy5kZWZhdWx0U2V0dGluZ3MuY2hpbGRyZW4ubGVuZ3RoXVxuICAgIGlmIChsb2FkZWRPcHRzID09PSAwKSBEb2MuaGlkZSh0aGlzLmxvYWRlZFNldHRpbmdzLCB0aGlzLmxvYWRlZFNldHRpbmdzTXNnKVxuICAgIGlmIChkZWZhdWx0T3B0cyA9PT0gMCkgRG9jLmhpZGUodGhpcy5kZWZhdWx0U2V0dGluZ3MsIHRoaXMuZGVmYXVsdFNldHRpbmdzTXNnKVxuICAgIGlmIChsb2FkZWRPcHRzICsgZGVmYXVsdE9wdHMgPT09IDApIERvYy5oaWRlKHRoaXMuc2hvd090aGVyLCB0aGlzLm90aGVyU2V0dGluZ3MpXG4gIH1cblxuICBhZGRPcHQgKGJveDogSFRNTEVsZW1lbnQsIG9wdDogQ29uZmlnT3B0aW9uLCBpbnNlcnRBZnRlcj86IFBhZ2VFbGVtZW50LCBza2lwUmVwZWF0Tj86IGJvb2xlYW4pOiBQYWdlRWxlbWVudCB7XG4gICAgbGV0IGVsOiBIVE1MRWxlbWVudFxuICAgIGlmIChvcHQuaXNib29sZWFuKSBlbCA9IHRoaXMuY2hlY2tib3hUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgIGVsc2UgaWYgKG9wdC5pc2RhdGUpIGVsID0gdGhpcy5kYXRlSW5wdXRUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgIGVsc2UgaWYgKG9wdC5yZXBlYXRhYmxlKSB7XG4gICAgICBlbCA9IHRoaXMucmVwZWF0YWJsZVRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgICBlbC5jbGFzc0xpc3QuYWRkKCdyZXBlYXRhYmxlJylcbiAgICAgIERvYy5iaW5kKERvYy50bXBsRWxlbWVudChlbCwgJ2FkZCcpLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuYWRkT3B0KGJveCwgb3B0LCBlbCwgdHJ1ZSlcbiAgICAgIH0pXG4gICAgICBpZiAoIXNraXBSZXBlYXROKSBmb3IgKGxldCBpID0gMDsgaSA8IChvcHQucmVwZWF0TiA/IG9wdC5yZXBlYXROIC0gMSA6IDApOyBpKyspIHRoaXMuYWRkT3B0KGJveCwgb3B0LCBpbnNlcnRBZnRlciwgdHJ1ZSlcbiAgICB9IGVsc2UgZWwgPSB0aGlzLnRleHRJbnB1dFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgY29uc3QgaGlkZGVuRmllbGRzID0gYXBwKCkuZXh0ZW5zaW9uV2FsbGV0KHRoaXMuYXNzZXRJRCk/LmhpZGRlbkZpZWxkcyB8fCBbXVxuICAgIGlmIChoaWRkZW5GaWVsZHMuaW5kZXhPZihvcHQua2V5KSAhPT0gLTEpIERvYy5oaWRlKGVsKVxuICAgIHRoaXMuY29uZmlnRWxlbWVudHMucHVzaChbb3B0LCBlbF0pXG4gICAgY29uc3QgaW5wdXQgPSBlbC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpIGFzIENvbmZpZ09wdGlvbklucHV0XG4gICAgaW5wdXQuZGF0YXNldC5jb25maWdLZXkgPSBvcHQua2V5XG4gICAgLy8gV2UgbmVlZCB0byBnZW5lcmF0ZSBhIHVuaXF1ZSBJRCBvbmx5IGZvciB0aGUgPGlucHV0IGlkPiA9PiA8bGFiZWwgZm9yPlxuICAgIC8vIG1hdGNoaW5nLlxuICAgIGR5bmFtaWNJbnB1dENvdW50ZXIrK1xuICAgIGNvbnN0IGVsSUQgPSAnd2NmZy0nICsgU3RyaW5nKGR5bmFtaWNJbnB1dENvdW50ZXIpXG4gICAgaW5wdXQuaWQgPSBlbElEXG4gICAgY29uc3QgbGFiZWwgPSBEb2Muc2FmZVNlbGVjdG9yKGVsLCAnbGFiZWwnKVxuICAgIGxhYmVsLmh0bWxGb3IgPSBlbElEIC8vICdmb3InIGF0dHJpYnV0ZSwgYnV0ICdmb3InIGlzIGEga2V5d29yZFxuICAgIGxhYmVsLnByZXBlbmQob3B0LmRpc3BsYXluYW1lKVxuICAgIGlmIChvcHQucmVnQXNzZXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgbG9nbyA9IG5ldyB3aW5kb3cuSW1hZ2UoMTUsIDE1KVxuICAgICAgbG9nby5zcmMgPSBEb2MubG9nb1BhdGhGcm9tSUQob3B0LnJlZ0Fzc2V0IHx8IC0xKVxuICAgICAgbGFiZWwucHJlcGVuZChsb2dvKVxuICAgIH1cbiAgICBpZiAoaW5zZXJ0QWZ0ZXIpIGluc2VydEFmdGVyLmFmdGVyKGVsKVxuICAgIGVsc2UgYm94LmFwcGVuZENoaWxkKGVsKVxuICAgIGlmIChvcHQubm9lY2hvKSB7XG4gICAgICBpbnB1dC50eXBlID0gJ3Bhc3N3b3JkJ1xuICAgICAgaW5wdXQuYXV0b2NvbXBsZXRlID0gJ29mZidcbiAgICB9XG4gICAgaWYgKG9wdC5kZXNjcmlwdGlvbikgbGFiZWwuZGF0YXNldC50b29sdGlwID0gb3B0LmRlc2NyaXB0aW9uXG4gICAgaWYgKG9wdC5pc2Jvb2xlYW4pIGlucHV0LmNoZWNrZWQgPSBvcHQuZGVmYXVsdFxuICAgIGVsc2UgaWYgKG9wdC5pc2RhdGUpIHtcbiAgICAgIGNvbnN0IGdldE1pbk1heFZhbCA9IChtaW5NYXg6IHN0cmluZyB8IG51bWJlcikgPT4ge1xuICAgICAgICBpZiAoIW1pbk1heCkgcmV0dXJuICcnXG4gICAgICAgIGlmIChtaW5NYXggPT09ICdub3cnKSByZXR1cm4gZGF0ZVRvU3RyaW5nKG5ldyBEYXRlKCkpXG4gICAgICAgIHJldHVybiBkYXRlVG9TdHJpbmcobmV3IERhdGUoKG1pbk1heCBhcyBudW1iZXIpICogMTAwMCkpXG4gICAgICB9XG4gICAgICBpbnB1dC5tYXggPSBnZXRNaW5NYXhWYWwob3B0Lm1heClcbiAgICAgIGlucHV0Lm1pbiA9IGdldE1pbk1heFZhbChvcHQubWluKVxuICAgICAgY29uc3QgZGF0ZSA9IG9wdC5kZWZhdWx0ID8gbmV3IERhdGUob3B0LmRlZmF1bHQgKiAxMDAwKSA6IG5ldyBEYXRlKClcbiAgICAgIC8vIFVJIHNob3dzIERhdGVzIGluIHZhbHVlQXNEYXRlIGFzIFVUQywgYnV0IHVzZXIgaW50ZXJwcmV0cyBsb2NhbC4gU2V0IGFcbiAgICAgIC8vIGxvY2FsIGRhdGUgc3RyaW5nIHNvIHRoZSBVSSBkaXNwbGF5cyB3aGF0IHRoZSB1c2VyIGV4cGVjdHMuIGFsdDpcbiAgICAgIC8vIGlucHV0LnZhbHVlQXNEYXRlID0gZGF0ZUFwcGx5T2Zmc2V0KGRhdGUpXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGVUb1N0cmluZyhkYXRlKVxuICAgIH0gZWxzZSBpbnB1dC52YWx1ZSA9IG9wdC5kZWZhdWx0ICE9PSBudWxsID8gb3B0LmRlZmF1bHQgOiAnJ1xuICAgIGlucHV0LmRpc2FibGVkID0gQm9vbGVhbihvcHQuZGlzYWJsZXdoZW5hY3RpdmUgJiYgdGhpcy5hc3NldEhhc0FjdGl2ZU9yZGVycylcbiAgICByZXR1cm4gZWxcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZSBjcmVhdGVzIHRoZSBkeW5hbWljIGZvcm0uXG4gICAqL1xuICB1cGRhdGUgKGFzc2V0SUQ6IG51bWJlciwgY29uZmlnT3B0czogQ29uZmlnT3B0aW9uW10gfCBudWxsLCBhY3RpdmVPcmRlcnM6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmFzc2V0SGFzQWN0aXZlT3JkZXJzID0gYWN0aXZlT3JkZXJzXG4gICAgdGhpcy5jb25maWdFbGVtZW50cyA9IFtdXG4gICAgdGhpcy5jb25maWdPcHRzID0gY29uZmlnT3B0cyB8fCBbXVxuICAgIHRoaXMuYXNzZXRJRCA9IGFzc2V0SURcbiAgICBEb2MuZW1wdHkodGhpcy5keW5hbWljT3B0cywgdGhpcy5kZWZhdWx0U2V0dGluZ3MsIHRoaXMubG9hZGVkU2V0dGluZ3MpXG5cbiAgICAvLyBJZiB0aGVyZSBhcmUgbm8gb3B0aW9ucywganVzdCBoaWRlIHRoZSBlbnRpcmUgZm9ybS5cbiAgICBpZiAodGhpcy5jb25maWdPcHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIERvYy5oaWRlKHRoaXMuZm9ybSlcbiAgICBEb2Muc2hvdyh0aGlzLmZvcm0pXG5cbiAgICB0aGlzLnNldE90aGVyU2V0dGluZ3NWaXooZmFsc2UpXG4gICAgRG9jLmhpZGUoXG4gICAgICB0aGlzLmxvYWRlZFNldHRpbmdzTXNnLCB0aGlzLmxvYWRlZFNldHRpbmdzLCB0aGlzLmRlZmF1bHRTZXR0aW5nc01zZyxcbiAgICAgIHRoaXMuZGVmYXVsdFNldHRpbmdzLCB0aGlzLmVyck1zZ1xuICAgIClcbiAgICBjb25zdCBkZWZhdWx0ZWRPcHRzID0gW11cbiAgICBmb3IgKGNvbnN0IG9wdCBvZiB0aGlzLmNvbmZpZ09wdHMpIHtcbiAgICAgIGlmICh0aGlzLnNlY3Rpb25pemUgJiYgb3B0LmRlZmF1bHQgIT09IG51bGwpIGRlZmF1bHRlZE9wdHMucHVzaChvcHQpXG4gICAgICBlbHNlIHRoaXMuYWRkT3B0KHRoaXMuZHluYW1pY09wdHMsIG9wdClcbiAgICB9XG4gICAgaWYgKGRlZmF1bHRlZE9wdHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGNvbnN0IG9wdCBvZiBkZWZhdWx0ZWRPcHRzKSB0aGlzLmFkZE9wdCh0aGlzLmRlZmF1bHRTZXR0aW5ncywgb3B0KVxuICAgICAgRG9jLnNob3codGhpcy5zaG93T3RoZXIsIHRoaXMuZGVmYXVsdFNldHRpbmdzTXNnLCB0aGlzLmRlZmF1bHRTZXR0aW5ncylcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUodGhpcy5zaG93T3RoZXIpXG4gICAgfVxuICAgIGFwcCgpLmJpbmRUb29sdGlwcyh0aGlzLmFsbFNldHRpbmdzKVxuICAgIGlmICh0aGlzLmR5bmFtaWNPcHRzLmNoaWxkcmVuLmxlbmd0aCkgRG9jLnNob3codGhpcy5keW5hbWljT3B0cylcbiAgICBlbHNlIERvYy5oaWRlKHRoaXMuZHluYW1pY09wdHMpXG4gIH1cblxuICAvKlxuICAgKiBzZXRPdGhlclNldHRpbmdzVml6IHNldHMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGFkZGl0aW9uYWwgc2V0dGluZ3Mgc2VjdGlvbi5cbiAgICovXG4gIHNldE90aGVyU2V0dGluZ3NWaXogKHZpc2libGU6IGJvb2xlYW4pIHtcbiAgICBpZiAodmlzaWJsZSkge1xuICAgICAgRG9jLmhpZGUodGhpcy5zaG93SWNvbilcbiAgICAgIERvYy5zaG93KHRoaXMuaGlkZUljb24sIHRoaXMub3RoZXJTZXR0aW5ncylcbiAgICAgIHRoaXMuc2hvd0hpZGVNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9ISURFX0FERElUSU9OQUxfU0VUVElOR1MpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLmhpZGUodGhpcy5oaWRlSWNvbiwgdGhpcy5vdGhlclNldHRpbmdzKVxuICAgIERvYy5zaG93KHRoaXMuc2hvd0ljb24pXG4gICAgdGhpcy5zaG93SGlkZU1zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1NIT1dfQURESVRJT05BTF9TRVRUSU5HUylcbiAgfVxuXG4gIC8qXG4gICAqIHNldENvbmZpZyBsb29rcyBmb3IgaW5wdXRzIHdpdGggY29uZmlnT3B0IGtleXMgbWF0Y2hpbmcgdGhlIGNmZyBvYmplY3QsIGFuZFxuICAgKiBzZXRzIHRoZSBpbnB1dHMgdmFsdWUgdG8gdGhlIGNvcnJlc3BvbmRpbmcgY2ZnIHZhbHVlLiBBIGxpc3Qgb2YgbWF0Y2hpbmdcbiAgICogY29uZmlnRWxlbWVudHMgaXMgcmV0dXJuZWQuXG4gICAqL1xuICBzZXRDb25maWcgKGNmZzogUmVjb3JkPHN0cmluZywgc3RyaW5nPik6IEhUTUxFbGVtZW50W10ge1xuICAgIGNvbnN0IGZpbmRzOiBIVE1MRWxlbWVudFtdID0gW11cbiAgICBjb25zdCBoYW5kbGVkUmVwZWF0YWJsZXM6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+ID0ge31cbiAgICBjb25zdCByZW1vdmVzOiBbQ29uZmlnT3B0aW9uLCBQYWdlRWxlbWVudF1bXSA9IFtdXG4gICAgZm9yIChjb25zdCByIG9mIFsuLi50aGlzLmNvbmZpZ0VsZW1lbnRzXSkge1xuICAgICAgY29uc3QgW29wdCwgZWxdID0gclxuICAgICAgY29uc3QgdiA9IGNmZ1tvcHQua2V5XVxuICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZCkgY29udGludWVcbiAgICAgIGlmIChvcHQucmVwZWF0YWJsZSkge1xuICAgICAgICBpZiAoaGFuZGxlZFJlcGVhdGFibGVzW29wdC5rZXldKSB7XG4gICAgICAgICAgZWwucmVtb3ZlKClcbiAgICAgICAgICByZW1vdmVzLnB1c2gocilcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICAgIGhhbmRsZWRSZXBlYXRhYmxlc1tvcHQua2V5XSA9IHRydWVcbiAgICAgICAgY29uc3QgdmFscyA9IHYuc3BsaXQob3B0LnJlcGVhdGFibGUpXG4gICAgICAgIGNvbnN0IGZpcnN0VmFsID0gdmFsc1swXVxuICAgICAgICBmaW5kcy5wdXNoKGVsKVxuICAgICAgICBEb2Muc2FmZVNlbGVjdG9yKGVsLCAnaW5wdXQnKS52YWx1ZSA9IGZpcnN0VmFsXG4gICAgICAgIC8vIEFkZCByZXBlYXROIC0gMSBlbXB0eSBlbGVtZW50cyB0byB0aGUgcmVjb25maWcgZm9ybS4gQWRkIHRoZW0gYmVmb3JlXG4gICAgICAgIC8vIHRoZSBwb3B1bGF0ZWQgaW5wdXRzIGp1c3QgYmVjYXVzZSBvZiB0aGUgd2F5IHdlJ3JlIHVzaW5nIHRoZVxuICAgICAgICAvLyBpbnNlcnRBZnRlciBhcmd1bWVudCB0byBhZGRPcHQuXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgKG9wdC5yZXBlYXROIHx8IDEpOyBpKyspIGZpbmRzLnB1c2godGhpcy5hZGRPcHQoZWwucGFyZW50RWxlbWVudCBhcyBQYWdlRWxlbWVudCwgb3B0LCBlbCwgdHJ1ZSkpXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdmFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IG5ld0VsID0gdGhpcy5hZGRPcHQoZWwucGFyZW50RWxlbWVudCBhcyBQYWdlRWxlbWVudCwgb3B0LCBlbCwgdHJ1ZSlcbiAgICAgICAgICBEb2Muc2FmZVNlbGVjdG9yKG5ld0VsLCAnaW5wdXQnKS52YWx1ZSA9IHZhbHNbaV1cbiAgICAgICAgICBmaW5kcy5wdXNoKG5ld0VsKVxuICAgICAgICB9XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICBmaW5kcy5wdXNoKGVsKVxuICAgICAgY29uc3QgaW5wdXQgPSBEb2Muc2FmZVNlbGVjdG9yKGVsLCAnaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgICBpZiAob3B0LmlzYm9vbGVhbikgaW5wdXQuY2hlY2tlZCA9IGlzVHJ1dGh5U3RyaW5nKHYpXG4gICAgICBlbHNlIGlmIChvcHQuaXNkYXRlKSB7XG4gICAgICAgIGlucHV0LnZhbHVlID0gZGF0ZVRvU3RyaW5nKG5ldyBEYXRlKHBhcnNlSW50KHYpICogMTAwMCkpXG4gICAgICAgIC8vIGFsdDogaW5wdXQudmFsdWVBc0RhdGUgPSBkYXRlQXBwbHlPZmZzZXQoLi4uKVxuICAgICAgfSBlbHNlIGlucHV0LnZhbHVlID0gdlxuICAgIH1cbiAgICBmb3IgKGNvbnN0IHIgb2YgcmVtb3Zlcykge1xuICAgICAgY29uc3QgaSA9IHRoaXMuY29uZmlnRWxlbWVudHMuaW5kZXhPZihyKVxuICAgICAgaWYgKGkgPj0gMCkgdGhpcy5jb25maWdFbGVtZW50cy5zcGxpY2UoaSwgMSlcbiAgICB9XG5cbiAgICByZXR1cm4gZmluZHNcbiAgfVxuXG4gIC8qXG4gICAqIHNldExvYWRlZENvbmZpZyBzZXRzIHRoZSBpbnB1dCB2YWx1ZXMgZm9yIHRoZSBlbnRyaWVzIGluIGNmZywgYW5kIG1vdmVzXG4gICAqIHRoZW0gdG8gdGhlIGxvYWRlZFNldHRpbmdzIGJveC5cbiAgICovXG4gIHNldExvYWRlZENvbmZpZyAoY2ZnOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KSB7XG4gICAgY29uc3QgZmluZHMgPSB0aGlzLnNldENvbmZpZyhjZmcpXG4gICAgaWYgKCF0aGlzLnNlY3Rpb25pemUgfHwgZmluZHMubGVuZ3RoID09PSAwKSByZXR1cm5cbiAgICB0aGlzLmxvYWRlZFNldHRpbmdzLmFwcGVuZCguLi5maW5kcylcbiAgICB0aGlzLnJlb3JkZXIodGhpcy5sb2FkZWRTZXR0aW5ncylcbiAgICBEb2Muc2hvdyh0aGlzLmxvYWRlZFNldHRpbmdzLCB0aGlzLmxvYWRlZFNldHRpbmdzTXNnKVxuICAgIGlmICh0aGlzLmRlZmF1bHRTZXR0aW5ncy5jaGlsZHJlbi5sZW5ndGggPT09IDApIERvYy5oaWRlKHRoaXMuZGVmYXVsdFNldHRpbmdzLCB0aGlzLmRlZmF1bHRTZXR0aW5nc01zZylcbiAgfVxuXG4gIC8qXG4gICAqIG1hcCByZWFkcyBhbGwgaW5wdXRzIGFuZCBjb25zdHJ1Y3RzIGFuIG9iamVjdCBmcm9tIHRoZSBjb25maWdPcHQga2V5cyBhbmRcbiAgICogdmFsdWVzLlxuICAgKi9cbiAgbWFwIChhc3NldElEOiBudW1iZXIpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICBjb25zdCBjb25maWc6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuICAgIGZvciAoY29uc3QgW29wdCwgZWxdIG9mIHRoaXMuY29uZmlnRWxlbWVudHMpIHtcbiAgICAgIGNvbnN0IGlucHV0ID0gRG9jLnNhZmVTZWxlY3RvcihlbCwgJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudFxuICAgICAgaWYgKG9wdC5yZWdBc3NldCAhPT0gdW5kZWZpbmVkICYmIG9wdC5yZWdBc3NldCAhPT0gYXNzZXRJRCkgY29udGludWVcbiAgICAgIGlmIChvcHQuaXNib29sZWFuICYmIG9wdC5rZXkpIHtcbiAgICAgICAgY29uZmlnW29wdC5rZXldID0gaW5wdXQuY2hlY2tlZCA/ICcxJyA6ICcwJ1xuICAgICAgfSBlbHNlIGlmIChvcHQuaXNkYXRlICYmIG9wdC5rZXkpIHtcbiAgICAgICAgLy8gRm9yY2UgbG9jYWwgdGltZSBpbnRlcnByZXRhdGlvbiBieSBhcHBlbmRpbmcgYSB0aW1lIHRvIHRoZSBkYXRlXG4gICAgICAgIC8vIHN0cmluZywgb3RoZXJ3aXNlIHRoZSBEYXRlIGNvbnN0cnVjdG9yIGNvbnNpZGVycyBpdCBVVEMuXG4gICAgICAgIGNvbnN0IG1pbkRhdGUgPSBpbnB1dC5taW4gPyB0b1VuaXhEYXRlKG5ldyBEYXRlKGlucHV0Lm1pbiArICdUMDA6MDAnKSkgOiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUlxuICAgICAgICBjb25zdCBtYXhEYXRlID0gaW5wdXQubWF4ID8gdG9Vbml4RGF0ZShuZXcgRGF0ZShpbnB1dC5tYXggKyAnVDAwOjAwJykpIDogTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJcbiAgICAgICAgbGV0IGRhdGUgPSBpbnB1dC52YWx1ZSA/IHRvVW5peERhdGUobmV3IERhdGUoaW5wdXQudmFsdWUgKyAnVDAwOjAwJykpIDogMFxuICAgICAgICBpZiAoZGF0ZSA8IG1pbkRhdGUpIGRhdGUgPSBtaW5EYXRlXG4gICAgICAgIGVsc2UgaWYgKGRhdGUgPiBtYXhEYXRlKSBkYXRlID0gbWF4RGF0ZVxuICAgICAgICBjb25maWdbb3B0LmtleV0gPSBTdHJpbmcoZGF0ZSlcbiAgICAgIH0gZWxzZSBpZiAoaW5wdXQudmFsdWUpIHtcbiAgICAgICAgaWYgKG9wdC5yZXBlYXRhYmxlICYmIGNvbmZpZ1tvcHQua2V5XSkgY29uZmlnW29wdC5rZXldICs9IG9wdC5yZXBlYXRhYmxlICsgaW5wdXQudmFsdWVcbiAgICAgICAgZWxzZSBjb25maWdbb3B0LmtleV0gPSBpbnB1dC52YWx1ZVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29uZmlnXG4gIH1cblxuICAvKlxuICAgKiByZW9yZGVyIHNvcnRzIHRoZSBjb25maWdFbGVtZW50cyBpbiB0aGUgYm94IGJ5IHRoZSBvcmRlciBvZiB0aGVcbiAgICogc2VydmVyLXByb3ZpZGVkIGNvbmZpZ09wdHMgYXJyYXkuXG4gICAqL1xuICByZW9yZGVyIChib3g6IEhUTUxFbGVtZW50KSB7XG4gICAgY29uc3QgaW5wdXRzOiBSZWNvcmQ8c3RyaW5nLCBIVE1MRWxlbWVudFtdPiA9IHt9XG4gICAgYm94LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JykuZm9yRWFjaCgoaW5wdXQ6IENvbmZpZ09wdGlvbklucHV0KSA9PiB7XG4gICAgICBjb25zdCBrID0gaW5wdXQuZGF0YXNldC5jb25maWdLZXlcbiAgICAgIGlmICghaykgcmV0dXJuIC8vIFRTMjUzOFxuICAgICAgY29uc3QgZWxzID0gW11cbiAgICAgIGZvciAoY29uc3QgW29wdCwgZWxdIG9mIHRoaXMuY29uZmlnRWxlbWVudHMpIGlmIChvcHQua2V5ID09PSBrKSBlbHMucHVzaChlbClcbiAgICAgIGlucHV0c1trXSA9IGVsc1xuICAgIH0pXG4gICAgZm9yIChjb25zdCBvcHQgb2YgdGhpcy5jb25maWdPcHRzKSB7XG4gICAgICBjb25zdCBlbHMgPSBpbnB1dHNbb3B0LmtleV0gfHwgW11cbiAgICAgIGZvciAoY29uc3QgZWwgb2YgZWxzKSBib3guYXBwZW5kKGVsKVxuICAgIH1cbiAgfVxufVxuXG4vKlxuICogQ29uZmlybVJlZ2lzdHJhdGlvbkZvcm0gc2hvdWxkIGJlIHVzZWQgd2l0aCB0aGUgXCJjb25maXJtUmVnaXN0cmF0aW9uRm9ybVwiXG4gKiB0ZW1wbGF0ZS5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbmZpcm1SZWdpc3RyYXRpb25Gb3JtIHtcbiAgZm9ybTogSFRNTEVsZW1lbnRcbiAgc3VjY2VzczogKCkgPT4gdm9pZFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgeGM6IEV4Y2hhbmdlXG4gIGNlcnRGaWxlOiBzdHJpbmdcbiAgYm9uZEFzc2V0SUQ6IG51bWJlclxuICB0aWVyOiBudW1iZXJcbiAgZmVlczogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzdWNjZXNzOiAoKSA9PiB2b2lkLCBnb0JhY2s6ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGZvcm0pXG4gICAgdGhpcy5jZXJ0RmlsZSA9ICcnXG5cbiAgICBEb2MuYmluZCh0aGlzLnBhZ2UuZ29CYWNrLCAnY2xpY2snLCAoKSA9PiBnb0JhY2soKSlcbiAgICBiaW5kKGZvcm0sIHRoaXMucGFnZS5zdWJtaXQsICgpID0+IHRoaXMuc3VibWl0Rm9ybSgpKVxuICB9XG5cbiAgc2V0RXhjaGFuZ2UgKHhjOiBFeGNoYW5nZSwgY2VydEZpbGU6IHN0cmluZykge1xuICAgIHRoaXMueGMgPSB4Y1xuICAgIHRoaXMuY2VydEZpbGUgPSBjZXJ0RmlsZVxuICAgIHRoaXMucGFnZS5ob3N0LnRleHRDb250ZW50ID0geGMuaG9zdFxuICB9XG5cbiAgc2V0QXNzZXQgKGFzc2V0SUQ6IG51bWJlciwgdGllcjogbnVtYmVyLCBmZWVzOiBudW1iZXIpIHtcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHsgY29udmVyc2lvbkZhY3RvciwgdW5pdCB9ID0gYXNzZXQudW5pdEluZm8uY29udmVudGlvbmFsXG4gICAgdGhpcy5ib25kQXNzZXRJRCA9IGFzc2V0LmlkXG4gICAgdGhpcy50aWVyID0gdGllclxuICAgIHRoaXMuZmVlcyA9IGZlZXNcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYm9uZEFzc2V0ID0gdGhpcy54Yy5ib25kQXNzZXRzW2Fzc2V0LnN5bWJvbF1cbiAgICBjb25zdCBib25kTG9jayA9IGJvbmRBc3NldC5hbW91bnQgKiB0aWVyICogYm9uZFJlc2VydmVNdWx0aXBsaWVyXG4gICAgY29uc3QgYm9uZExvY2tDb252ZW50aW9uYWwgPSBib25kTG9jayAvIGNvbnZlcnNpb25GYWN0b3JcbiAgICBwYWdlLnRyYWRpbmdUaWVyLnRleHRDb250ZW50ID0gU3RyaW5nKHRpZXIpXG4gICAgcGFnZS5sb2dvLnNyYyA9IERvYy5sb2dvUGF0aChhc3NldC5zeW1ib2wpXG4gICAgcGFnZS5ib25kTG9jay50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhib25kTG9ja0NvbnZlbnRpb25hbClcbiAgICBwYWdlLmJvbmRVbml0LnRleHRDb250ZW50ID0gdW5pdFxuICAgIGNvbnN0IHIgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICBEb2Muc2hvdyhwYWdlLmJvbmRMb2NrVVNEQm94KVxuICAgIGlmIChyKSBwYWdlLmJvbmRMb2NrVVNELnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGJvbmRMb2NrQ29udmVudGlvbmFsICogcilcbiAgICBlbHNlIERvYy5oaWRlKHBhZ2UuYm9uZExvY2tVU0RCb3gpXG4gICAgaWYgKGZlZXMpIHBhZ2UuZmVlUmVzZXJ2ZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZmVlcyAvIGNvbnZlcnNpb25GYWN0b3IpXG4gICAgcGFnZS5yZXNlcnZlc1VuaXQudGV4dENvbnRlbnQgPSB1bml0XG4gIH1cblxuICBzZXRGZWVzIChhc3NldElEOiBudW1iZXIsIGZlZXM6IG51bWJlcikge1xuICAgIHRoaXMuZmVlcyA9IGZlZXNcbiAgICBjb25zdCBjb252ZXJzaW9uRmFjdG9yID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdLnVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgdGhpcy5wYWdlLmZlZVJlc2VydmVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGZlZXMgLyBjb252ZXJzaW9uRmFjdG9yKVxuICB9XG5cbiAgLyogRm9ybSBleHBhbmRzIGludG8gaXRzIHNwYWNlIHF1aWNrbHkgZnJvbSB0aGUgbG93ZXItcmlnaHQgYXMgaXQgZmFkZXMgaW4uICovXG4gIGFzeW5jIGFuaW1hdGUgKCkge1xuICAgIGNvbnN0IGZvcm0gPSB0aGlzLmZvcm1cbiAgICBEb2MuYW5pbWF0ZSg0MDAsIHByb2cgPT4ge1xuICAgICAgZm9ybS5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHtwcm9nfSlgXG4gICAgICBmb3JtLnN0eWxlLm9wYWNpdHkgPSBTdHJpbmcoTWF0aC5wb3cocHJvZywgNCkpXG4gICAgICBjb25zdCBvZmZzZXQgPSBgJHsoMSAtIHByb2cpICogNTAwfXB4YFxuICAgICAgZm9ybS5zdHlsZS50b3AgPSBvZmZzZXRcbiAgICAgIGZvcm0uc3R5bGUubGVmdCA9IG9mZnNldFxuICAgIH0pXG4gIH1cblxuICAvKlxuICAgKiBzdWJtaXRGb3JtIGlzIGNhbGxlZCB3aGVuIHRoZSBmb3JtIGlzIHN1Ym1pdHRlZC5cbiAgICovXG4gIGFzeW5jIHN1Ym1pdEZvcm0gKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgYm9uZEFzc2V0SUQsIHhjLCBjZXJ0RmlsZSwgdGllciB9ID0gdGhpc1xuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2JvbmRBc3NldElEXVxuICAgIGlmICghYXNzZXQpIHtcbiAgICAgIHBhZ2UucmVnRXJyLmlubmVyVGV4dCA9IGludGwucHJlcChpbnRsLklEX1NFTEVDVF9XQUxMRVRfRk9SX0ZFRV9QQVlNRU5UKVxuICAgICAgRG9jLnNob3cocGFnZS5yZWdFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLmhpZGUocGFnZS5yZWdFcnIpXG4gICAgY29uc3QgYm9uZEFzc2V0ID0geGMuYm9uZEFzc2V0c1thc3NldC53YWxsZXQuc3ltYm9sXVxuICAgIGNvbnN0IGRleEFkZHIgPSB4Yy5ob3N0XG4gICAgbGV0IGZvcm06IGFueVxuICAgIGxldCB1cmw6IHN0cmluZ1xuICAgIGlmICghYXBwKCkuZXhjaGFuZ2VzW3hjLmhvc3RdIHx8IGFwcCgpLmV4Y2hhbmdlc1t4Yy5ob3N0XS52aWV3T25seSkge1xuICAgICAgZm9ybSA9IHtcbiAgICAgICAgYWRkcjogZGV4QWRkcixcbiAgICAgICAgY2VydDogY2VydEZpbGUsXG4gICAgICAgIGJvbmQ6IGJvbmRBc3NldC5hbW91bnQgKiB0aWVyLFxuICAgICAgICBhc3NldDogYm9uZEFzc2V0LmlkXG4gICAgICB9XG4gICAgICB1cmwgPSAnL2FwaS9wb3N0Ym9uZCdcbiAgICB9IGVsc2Uge1xuICAgICAgZm9ybSA9IHtcbiAgICAgICAgaG9zdDogZGV4QWRkcixcbiAgICAgICAgdGFyZ2V0VGllcjogdGllcixcbiAgICAgICAgYm9uZEFzc2V0SUQ6IGJvbmRBc3NldElEXG4gICAgICB9XG4gICAgICB1cmwgPSAnL2FwaS91cGRhdGVib25kb3B0aW9ucydcbiAgICB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04odXJsLCBmb3JtKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UucmVnRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5yZWdFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zdWNjZXNzKClcbiAgfVxufVxuXG5pbnRlcmZhY2UgUmVnQXNzZXRSb3cge1xuICByZWFkeTogUGFnZUVsZW1lbnRcbn1cblxuaW50ZXJmYWNlIE1hcmtldExpbWl0c1JvdyB7XG4gIG1rdDogTWFya2V0XG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBzZXRUaWVyOiAoKHRpZXI6IG51bWJlcikgPT4gdm9pZClcbn1cblxuLypcbiAqIEZlZUFzc2V0U2VsZWN0aW9uRm9ybSBzaG91bGQgYmUgdXNlZCB3aXRoIHRoZSBcInJlZ0Fzc2V0Rm9ybVwiIHRlbXBsYXRlLlxuICovXG5leHBvcnQgY2xhc3MgRmVlQXNzZXRTZWxlY3Rpb25Gb3JtIHtcbiAgZm9ybTogSFRNTEVsZW1lbnRcbiAgc3VjY2VzczogKGFzc2V0SUQ6IG51bWJlciwgdGllcjogbnVtYmVyKSA9PiBQcm9taXNlPHZvaWQ+XG4gIHhjOiBFeGNoYW5nZVxuICBzZWxlY3RlZEFzc2V0SUQ6IG51bWJlclxuICBjZXJ0RmlsZTogc3RyaW5nXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBhc3NldFJvd3M6IFJlY29yZDxzdHJpbmcsIFJlZ0Fzc2V0Um93PlxuICBtYXJrZXRSb3dzOiBNYXJrZXRMaW1pdHNSb3dbXVxuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBIVE1MRWxlbWVudCwgc3VjY2VzczogKGFzc2V0SUQ6IG51bWJlciwgdGllcjogbnVtYmVyKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIHRoaXMuY2VydEZpbGUgPSAnJ1xuICAgIHRoaXMuc3VjY2VzcyA9IHN1Y2Nlc3NcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUoZm9ybSlcbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXMocGFnZS5jdXJyZW50Qm9uZFRtcGwsIHBhZ2UuYm9uZEFzc2V0VG1wbCwgcGFnZS5tYXJrZXRUbXBsKVxuXG4gICAgRG9jLmJpbmQocGFnZS50cmFkaW5nVGllcklucHV0LCAnaW5wdXQnLCAoKSA9PiB7IHRoaXMuc2V0VGllcigpIH0pXG4gICAgRG9jLmJpbmQocGFnZS50cmFkaW5nVGllcklucHV0LCAna2V5dXAnLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4geyBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHRoaXMuYWNjZXB0VGllcigpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zdWJtaXRUcmFkaW5nVGllciwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmFjY2VwdFRpZXIoKSB9KVxuXG4gICAgRG9jLmJpbmQocGFnZS50aWVyVXAsICdjbGljaycsICgpID0+IHsgdGhpcy5pbmNyZW1lbnRUaWVyKHRydWUpIH0pXG4gICAgRG9jLmJpbmQocGFnZS50aWVyRG93biwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmluY3JlbWVudFRpZXIoZmFsc2UpIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLmdvQmFja1RvQXNzZXRzLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLnRyYWRpbmdUaWVyRm9ybSlcbiAgICAgIERvYy5zaG93KHBhZ2UuYXNzZXRGb3JtKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLndoYXRzQUJvbmQsICdjbGljaycsICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuYXNzZXRGb3JtKVxuICAgICAgRG9jLnNob3cocGFnZS53aGF0c0FCb25kUGFuZWwpXG4gICAgfSlcblxuICAgIGNvbnN0IGhpZGVXaGF0c0FCb25kID0gKCkgPT4ge1xuICAgICAgRG9jLnNob3cocGFnZS5hc3NldEZvcm0pXG4gICAgICBEb2MuaGlkZShwYWdlLndoYXRzQUJvbmRQYW5lbClcbiAgICB9XG5cbiAgICBEb2MuYmluZChwYWdlLmJvbmRHb3RJdCwgJ2NsaWNrJywgKCkgPT4geyBoaWRlV2hhdHNBQm9uZCgpIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLndoYXRzQUJvbmRCYWNrLCAnY2xpY2snLCAoKSA9PiB7IGhpZGVXaGF0c0FCb25kKCkgfSlcblxuICAgIERvYy5iaW5kKHBhZ2UudXNlUHJlcGFpZEJvbmQsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93UHJlcGFpZEJvbmRGb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnBwYkdvQmFjaywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmhpZGVQcmVwYWlkQm9uZEZvcm0oKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc3VibWl0UHJlcGFpZEJvbmQsICdjbGljaycsICgpID0+IHsgdGhpcy5zdWJtaXRQcmVwYWlkQm9uZCgpIH0pXG5cbiAgICBhcHAoKS5yZWdpc3Rlck5vdGVGZWVkZXIoe1xuICAgICAgY3JlYXRld2FsbGV0OiAobm90ZTogV2FsbGV0Q3JlYXRpb25Ob3RlKSA9PiB7XG4gICAgICAgIGlmIChub3RlLnRvcGljID09PSAnUXVldWVkQ3JlYXRpb25TdWNjZXNzJykgdGhpcy53YWxsZXRDcmVhdGVkKG5vdGUuYXNzZXRJRClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgc2V0VGllckVycm9yIChlcnJNc2c6IHN0cmluZykge1xuICAgIHRoaXMucGFnZS50cmFkaW5nVGllckVyci50ZXh0Q29udGVudCA9IGVyck1zZ1xuICAgIERvYy5zaG93KHRoaXMucGFnZS50cmFkaW5nVGllckVycilcbiAgfVxuXG4gIHNldEFzc2V0RXJyb3IgKGVyck1zZzogc3RyaW5nKSB7XG4gICAgdGhpcy5wYWdlLnJlZ0Fzc2V0RXJyLnRleHRDb250ZW50ID0gZXJyTXNnXG4gICAgRG9jLnNob3codGhpcy5wYWdlLnJlZ0Fzc2V0RXJyKVxuICB9XG5cbiAgY2xlYXJFcnJvcnMgKCkge1xuICAgIERvYy5oaWRlKHRoaXMucGFnZS5yZWdBc3NldEVyciwgdGhpcy5wYWdlLnRyYWRpbmdUaWVyRXJyKVxuICB9XG5cbiAgc2V0RXhjaGFuZ2UgKHhjOiBFeGNoYW5nZSwgY2VydEZpbGU6IHN0cmluZykge1xuICAgIHRoaXMueGMgPSB4Y1xuICAgIHRoaXMuY2VydEZpbGUgPSBjZXJ0RmlsZVxuICAgIHRoaXMuYXNzZXRSb3dzID0ge31cbiAgICB0aGlzLm1hcmtldFJvd3MgPSBbXVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmFzc2V0Rm9ybSwgcGFnZS50cmFkaW5nVGllckZvcm0sIHBhZ2Uud2hhdHNBQm9uZFBhbmVsLCBwYWdlLnByZXBhaWRCb25kcylcbiAgICBEb2MuZW1wdHkocGFnZS5ib25kQXNzZXRzLCBwYWdlLm1hcmtldHMpXG4gICAgdGhpcy5jbGVhckVycm9ycygpXG5cbiAgICBjb25zdCBhZGRCb25kUm93ID0gKGFzc2V0SUQ6IG51bWJlciwgYm9uZEFzc2V0OiBCb25kQXNzZXQpID0+IHtcbiAgICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBpZiAoIWFzc2V0KSByZXR1cm5cbiAgICAgIGNvbnN0IHsgdW5pdEluZm86IHsgY29udmVudGlvbmFsOiB7IHVuaXQsIGNvbnZlcnNpb25GYWN0b3IgfSB9LCBuYW1lLCBzeW1ib2wgfSA9IGFzc2V0XG4gICAgICBjb25zdCB0ciA9IHBhZ2UuYm9uZEFzc2V0VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIHBhZ2UuYm9uZEFzc2V0cy5hcHBlbmRDaGlsZCh0cilcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZSh0cilcblxuICAgICAgdG1wbC5sb2dvLnNyYyA9IERvYy5sb2dvUGF0aChzeW1ib2wpXG4gICAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBuYW1lXG5cbiAgICAgIERvYy5iaW5kKHRyLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuYXNzZXRTZWxlY3RlZChhc3NldElEKSB9KVxuICAgICAgdG1wbC5mZWVTeW1ib2wudGV4dENvbnRlbnQgPSB1bml0XG4gICAgICBjb25zdCBib25kU2l6ZUNvbnZlbnRpb25hbCA9IGJvbmRBc3NldC5hbW91bnQgLyBjb252ZXJzaW9uRmFjdG9yXG4gICAgICB0bXBsLmZlZUFtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhib25kU2l6ZUNvbnZlbnRpb25hbClcbiAgICAgIGNvbnN0IGZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Fzc2V0SURdXG4gICAgICBEb2Muc2V0VmlzKGZpYXRSYXRlLCB0bXBsLmZpYXRCb3gpXG4gICAgICBpZiAoZmlhdFJhdGUpIHRtcGwuZmlhdEJvbmRBbW91bnQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYm9uZFNpemVDb252ZW50aW9uYWwgKiBmaWF0UmF0ZSlcbiAgICAgIHRoaXMuYXNzZXRSb3dzW2Fzc2V0SURdID0geyByZWFkeTogdG1wbC5yZWFkeSB9XG4gICAgfVxuXG4gICAgY29uc3QgYWRkTWFya2V0Um93ID0gKG1rdDogTWFya2V0KSA9PiB7XG4gICAgICBjb25zdCB7IGJhc2VpZDogYmFzZUlELCBxdW90ZWlkOiBxdW90ZUlEIH0gPSBta3RcbiAgICAgIGNvbnN0IFtiLCBxXSA9IFthcHAoKS5hc3NldHNbYmFzZUlEXSwgYXBwKCkuYXNzZXRzW3F1b3RlSURdXVxuICAgICAgaWYgKCFiIHx8ICFxKSByZXR1cm5cbiAgICAgIGNvbnN0IHRyID0gcGFnZS5tYXJrZXRUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgcGFnZS5tYXJrZXRzLmFwcGVuZENoaWxkKHRyKVxuICAgICAgY29uc3QgeyBzeW1ib2w6IGJhc2VTeW1ib2wsIHVuaXRJbmZvOiBidWkgfSA9IHhjLmFzc2V0c1tiYXNlSURdXG4gICAgICBjb25zdCB7IHN5bWJvbDogcXVvdGVTeW1ib2wsIHVuaXRJbmZvOiBxdWkgfSA9IHhjLmFzc2V0c1txdW90ZUlEXVxuICAgICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3Rvcih0ciwgJ1tkYXRhLWJhc2UtdGlja2VyXScpKSBlbC50ZXh0Q29udGVudCA9IGJ1aS5jb252ZW50aW9uYWwudW5pdFxuICAgICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3Rvcih0ciwgJ1tkYXRhLXF1b3RlLXRpY2tlcl0nKSkgZWwudGV4dENvbnRlbnQgPSBxdWkuY29udmVudGlvbmFsLnVuaXRcblxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRyKVxuICAgICAgdG1wbC5iYXNlTG9nby5zcmMgPSBEb2MubG9nb1BhdGgoYmFzZVN5bWJvbClcbiAgICAgIHRtcGwucXVvdGVMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChxdW90ZVN5bWJvbClcblxuICAgICAgY29uc3Qgc2V0VGllciA9ICh0aWVyOiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgeyBwYXJjZWxzaXplOiBwYXJjZWxTaXplLCBsb3RzaXplOiBsb3RTaXplIH0gPSBta3RcbiAgICAgICAgY29uc3QgY29udmVudGlvbmFsTG90U2l6ZSA9IGxvdFNpemUgLyBidWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgICAgY29uc3Qgc3RhcnRpbmdMaW1pdCA9IGNvbnZlbnRpb25hbExvdFNpemUgKiBwYXJjZWxTaXplICogcGVyVGllckJhc2VQYXJjZWxMaW1pdCAqIHRpZXJcbiAgICAgICAgY29uc3QgcHJpdmlsZWdlZExpbWl0ID0gY29udmVudGlvbmFsTG90U2l6ZSAqIHBhcmNlbFNpemUgKiBwZXJUaWVyQmFzZVBhcmNlbExpbWl0ICogcGFyY2VsTGltaXRTY29yZU11bHRpcGxpZXIgKiB0aWVyXG4gICAgICAgIHRtcGwudHJhZGVMaW1pdExvdy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhzdGFydGluZ0xpbWl0KVxuICAgICAgICB0bXBsLnRyYWRlTGltaXRIaWdoLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHByaXZpbGVnZWRMaW1pdClcbiAgICAgICAgY29uc3QgYmFzZUZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Jhc2VJRF1cbiAgICAgICAgaWYgKGJhc2VGaWF0UmF0ZSkge1xuICAgICAgICAgIHRtcGwuZmlhdFRyYWRlTGltaXRMb3cudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moc3RhcnRpbmdMaW1pdCAqIGJhc2VGaWF0UmF0ZSlcbiAgICAgICAgICB0bXBsLmZpYXRUcmFkZUxpbWl0SGlnaC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhwcml2aWxlZ2VkTGltaXQgKiBiYXNlRmlhdFJhdGUpXG4gICAgICAgIH1cbiAgICAgICAgRG9jLnNldFZpcyhiYXNlRmlhdFJhdGUsIHBhZ2UuZmlhdFRyYWRlTG93Qm94LCBwYWdlLmZpYXRUcmFkZUhpZ2hCb3gpXG4gICAgICB9XG5cbiAgICAgIHNldFRpZXIoc3Ryb25nVGllcih4Yy5hdXRoKSB8fCAxKVxuICAgICAgdGhpcy5tYXJrZXRSb3dzLnB1c2goeyBta3QsIHRtcGwsIHNldFRpZXIgfSlcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IHsgc3ltYm9sLCBpZDogYXNzZXRJRCB9IG9mIE9iamVjdC52YWx1ZXMoeGMuYXNzZXRzIHx8IHt9KSkge1xuICAgICAgaWYgKCFhcHAoKS5hc3NldHNbYXNzZXRJRF0pIGNvbnRpbnVlXG4gICAgICBjb25zdCBib25kQXNzZXQgPSB4Yy5ib25kQXNzZXRzW3N5bWJvbF1cbiAgICAgIGlmIChib25kQXNzZXQpIGFkZEJvbmRSb3coYXNzZXRJRCwgYm9uZEFzc2V0KVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgbWt0IG9mIE9iamVjdC52YWx1ZXMoeGMubWFya2V0cyB8fCB7fSkpIGFkZE1hcmtldFJvdyhta3QpXG5cbiAgICAvLyBwYWdlLmhvc3QudGV4dENvbnRlbnQgPSB4Yy5ob3N0XG4gICAgcGFnZS50cmFkaW5nVGllcklucHV0LnZhbHVlID0geGMuYXV0aC50YXJnZXRUaWVyID8gU3RyaW5nKHhjLmF1dGgudGFyZ2V0VGllcikgOiAnMSdcblxuICAgIGlmICh0aGlzLnZhbGlkQm9uZEFzc2V0U2VsZWN0ZWQoeGMpKSB0aGlzLmFzc2V0U2VsZWN0ZWQoeGMuYXV0aC5ib25kQXNzZXRJRClcbiAgICBlbHNlIERvYy5zaG93KHBhZ2UuYXNzZXRGb3JtKVxuICB9XG5cbiAgdmFsaWRCb25kQXNzZXRTZWxlY3RlZCAoeGM6IEV4Y2hhbmdlKSB7XG4gICAgaWYgKHhjLnZpZXdPbmx5KSByZXR1cm4gZmFsc2VcbiAgICBjb25zdCB7IHRhcmdldFRpZXIsIGJvbmRBc3NldElEIH0gPSB4Yy5hdXRoXG4gICAgaWYgKHRhcmdldFRpZXIgPCAxKSByZXR1cm4gZmFsc2VcbiAgICBjb25zdCBhID0gYXBwKCkuYXNzZXRzW2JvbmRBc3NldElEXVxuICAgIHJldHVybiBhICYmIEJvb2xlYW4oeGMuYm9uZEFzc2V0c1thLnN5bWJvbF0pXG4gIH1cblxuICAvKlxuICAgKiB3YWxsZXRDcmVhdGVkIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhbiBhc3luY2hyb25vdXMgd2FsbGV0IGNyZWF0aW9uXG4gICAqIGNvbXBsZXRlcyBzdWNjZXNzZnVsbHkuXG4gICAqL1xuICB3YWxsZXRDcmVhdGVkIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBhID0gdGhpcy5hc3NldFJvd3NbYXNzZXRJRF1cbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIHNldFJlYWR5TWVzc2FnZShhLnJlYWR5LCBhc3NldClcbiAgfVxuXG4gIHJlZnJlc2ggKCkge1xuICAgIHRoaXMuc2V0RXhjaGFuZ2UodGhpcy54YywgdGhpcy5jZXJ0RmlsZSlcbiAgfVxuXG4gIGFzc2V0U2VsZWN0ZWQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIHRoaXMuc2VsZWN0ZWRBc3NldElEID0gYXNzZXRJRFxuICAgIHRoaXMuc2V0VGllcigpXG4gICAgY29uc3QgeyBwYWdlOiB7IGFzc2V0Rm9ybSwgdHJhZGluZ1RpZXJGb3JtLCB0cmFkaW5nVGllcklucHV0IH0gfSA9IHRoaXNcbiAgICBEb2MuaGlkZShhc3NldEZvcm0pXG4gICAgRG9jLnNob3codHJhZGluZ1RpZXJGb3JtKVxuICAgIHRyYWRpbmdUaWVySW5wdXQuZm9jdXMoKVxuICB9XG5cbiAgc2V0VGllciAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCB4YzogeyBib25kQXNzZXRzIH0sIHNlbGVjdGVkQXNzZXRJRDogYXNzZXRJRCB9ID0gdGhpc1xuICAgIGNvbnN0IHsgc3ltYm9sLCB1bml0SW5mbzogdWkgfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHsgY29udmVudGlvbmFsOiB7IGNvbnZlcnNpb25GYWN0b3IsIHVuaXQgfSB9ID0gdWlcblxuICAgIGNvbnN0IGJvbmRBc3NldCA9IGJvbmRBc3NldHNbc3ltYm9sXVxuICAgIGNvbnN0IHJhdyA9IHBhZ2UudHJhZGluZ1RpZXJJbnB1dC52YWx1ZSA/PyAnJ1xuICAgIGlmICghcmF3KSByZXR1cm5cbiAgICBjb25zdCB0aWVyID0gcGFyc2VJbnQocmF3KVxuICAgIGlmIChpc05hTih0aWVyKSkge1xuICAgICAgdGhpcy5zZXRUaWVyRXJyb3IoaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9USUVSX1ZBTFVFKSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwYWdlLnRyYWRpbmdUaWVySW5wdXQudmFsdWUgPSBTdHJpbmcodGllcilcbiAgICBwYWdlLmJvbmRTaXplRGlzcGxheS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYm9uZEFzc2V0LmFtb3VudCwgdWkpXG4gICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLnRyYWRpbmdUaWVyRm9ybSwgJ1tkYXRhLXRpZXJdJykpIGVsLnRleHRDb250ZW50ID0gU3RyaW5nKHRpZXIpXG4gICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLnRyYWRpbmdUaWVyRm9ybSwgJ1tkYXRhLWJvbmQtYXNzZXQtdGlja2VyXScpKSBlbC50ZXh0Q29udGVudCA9IHVuaXRcbiAgICBjb25zdCBib25kTG9jayA9IGJvbmRBc3NldC5hbW91bnQgKiB0aWVyICogYm9uZFJlc2VydmVNdWx0aXBsaWVyXG4gICAgcGFnZS5ib25kTG9ja0Rpc3BsYXkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJvbmRMb2NrLCB1aSlcbiAgICBjb25zdCBmaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXVxuICAgIGlmIChmaWF0UmF0ZSkgcGFnZS5maWF0TG9ja0Rpc3BsYXkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYm9uZExvY2sgLyBjb252ZXJzaW9uRmFjdG9yICogZmlhdFJhdGUpXG4gICAgZm9yIChjb25zdCBtIG9mIE9iamVjdC52YWx1ZXModGhpcy5tYXJrZXRSb3dzKSkgbS5zZXRUaWVyKHRpZXIpXG4gICAgY29uc3QgY3VycmVudEJvbmRBbXRzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+ID0ge31cbiAgICBmb3IgKGNvbnN0IFthc3NldElEU3RyLCB7IHdhbGxldCB9XSBvZiBPYmplY3QuZW50cmllcyhhcHAoKS5hc3NldHMpKSB7XG4gICAgICBpZiAoIXdhbGxldCkgY29udGludWVcbiAgICAgIGNvbnN0IHsgYmFsYW5jZTogeyBib25kbG9ja2VkLCBib25kUmVzZXJ2ZXMgfSB9ID0gd2FsbGV0XG4gICAgICBjb25zdCBib25kZWQgPSBib25kbG9ja2VkICsgYm9uZFJlc2VydmVzXG4gICAgICBpZiAoYm9uZGVkID4gMCkgY3VycmVudEJvbmRBbXRzW3BhcnNlSW50KGFzc2V0SURTdHIpXSA9IGJvbmRlZFxuICAgIH1cbiAgICBjb25zdCBoYXZlTG9jayA9IE9iamVjdC5rZXlzKGN1cnJlbnRCb25kQW10cykubGVuZ3RoID4gMFxuICAgIERvYy5zZXRWaXMoaGF2ZUxvY2ssIHBhZ2UuY3VycmVudEJvbmRCb3gpXG4gICAgaWYgKGhhdmVMb2NrKSB7XG4gICAgICBEb2MuZW1wdHkocGFnZS5jdXJyZW50Qm9uZHMpXG4gICAgICBmb3IgKGNvbnN0IFthc3NldElEU3RyLCBib25kTG9ja2VkXSBvZiBPYmplY3QuZW50cmllcyhjdXJyZW50Qm9uZEFtdHMpKSB7XG4gICAgICAgIGNvbnN0IGFzc2V0SUQgPSBwYXJzZUludChhc3NldElEU3RyKVxuICAgICAgICBjb25zdCB7IHVuaXRJbmZvOiB1aSwgc3ltYm9sLCBuYW1lIH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICAgICAgY29uc3QgeyBjb252ZW50aW9uYWw6IHsgY29udmVyc2lvbkZhY3RvciwgdW5pdCB9IH0gPSB1aVxuICAgICAgICBjb25zdCB0ciA9IHBhZ2UuY3VycmVudEJvbmRUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICBwYWdlLmN1cnJlbnRCb25kcy5hcHBlbmRDaGlsZCh0cilcbiAgICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRyKVxuICAgICAgICB0bXBsLmljb24uc3JjID0gRG9jLmxvZ29QYXRoKHN5bWJvbClcbiAgICAgICAgdG1wbC5uYW1lLnRleHRDb250ZW50ID0gbmFtZVxuICAgICAgICB0bXBsLmFtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYm9uZExvY2tlZCwgdWkpXG4gICAgICAgIHRtcGwudGlja2VyLnRleHRDb250ZW50ID0gdW5pdFxuICAgICAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBuYW1lXG4gICAgICAgIGNvbnN0IGZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Fzc2V0SURdXG4gICAgICAgIERvYy5zZXRWaXModG1wbC5maWF0Qm94KVxuICAgICAgICBpZiAoZmlhdFJhdGUpIHRtcGwuZmlhdEFtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhib25kTG9ja2VkIC8gY29udmVyc2lvbkZhY3RvciAqIGZpYXRSYXRlKVxuICAgICAgfVxuICAgIH1cbiAgICBEb2Muc2V0VmlzKGZpYXRSYXRlLCBwYWdlLmZpYXRMb2NrQm94KVxuICB9XG5cbiAgYWNjZXB0VGllciAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzZWxlY3RlZEFzc2V0SUQ6IGFzc2V0SUQgfSA9IHRoaXNcbiAgICB0aGlzLmNsZWFyRXJyb3JzKClcbiAgICBjb25zdCByYXcgPSBwYWdlLnRyYWRpbmdUaWVySW5wdXQudmFsdWUgPz8gJydcbiAgICBpZiAoIXJhdykgcmV0dXJuXG4gICAgY29uc3QgdGllciA9IHBhcnNlSW50KHJhdylcbiAgICBpZiAoaXNOYU4odGllcikpIHtcbiAgICAgIHRoaXMuc2V0VGllckVycm9yKGludGwucHJlcChpbnRsLklEX0lOVkFMSURfVElFUl9WQUxVRSkpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zdWNjZXNzKGFzc2V0SUQsIHRpZXIpXG4gIH1cblxuICBpbmNyZW1lbnRUaWVyICh1cDogYm9vbGVhbikge1xuICAgIGNvbnN0IHsgcGFnZTogeyB0cmFkaW5nVGllcklucHV0OiBpbnB1dCB9IH0gPSB0aGlzXG4gICAgaW5wdXQudmFsdWUgPSBTdHJpbmcoTWF0aC5tYXgoMSwgKHBhcnNlSW50KGlucHV0LnZhbHVlID8/ICcnKSB8fCAxKSArICh1cCA/IDEgOiAtMSkpKVxuICAgIHRoaXMuc2V0VGllcigpXG4gIH1cblxuICAvKlxuICAgKiBBbmltYXRpb24gdG8gbWFrZSB0aGUgZWxlbWVudHMgc29ydCBvZiBleHBhbmQgaW50byB0aGVpciBzcGFjZSBmcm9tIHRoZVxuICAgKiBib3R0b20gYXMgdGhleSBmYWRlIGluLlxuICAgKi9cbiAgYXN5bmMgYW5pbWF0ZSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBmb3JtIH0gPSB0aGlzXG4gICAgY29uc3QgZXh0cmFNYXJnaW4gPSA3NVxuICAgIGNvbnN0IGV4dHJhVG9wID0gNTBcbiAgICBjb25zdCByZWdBc3NldEVsZW1lbnRzID0gQXJyYXkuZnJvbShwYWdlLmJvbmRBc3NldHMuY2hpbGRyZW4pIGFzIFBhZ2VFbGVtZW50W11cbiAgICBmb3JtLnN0eWxlLm9wYWNpdHkgPSAnMCdcblxuICAgIGNvbnN0IGFuaUxlbiA9IDM1MFxuICAgIGF3YWl0IERvYy5hbmltYXRlKGFuaUxlbiwgcHJvZyA9PiB7XG4gICAgICBmb3IgKGNvbnN0IGVsIG9mIHJlZ0Fzc2V0RWxlbWVudHMpIHtcbiAgICAgICAgZWwuc3R5bGUubWFyZ2luVG9wID0gYCR7KDEgLSBwcm9nKSAqIGV4dHJhTWFyZ2lufXB4YFxuICAgICAgICBlbC5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHtwcm9nfSlgXG4gICAgICB9XG4gICAgICBmb3JtLnN0eWxlLm9wYWNpdHkgPSBNYXRoLnBvdyhwcm9nLCA0KS50b0ZpeGVkKDEpXG4gICAgICBmb3JtLnN0eWxlLnRvcCA9IGAkeygxIC0gcHJvZykgKiBleHRyYVRvcH1weGBcbiAgICB9LCAnZWFzZU91dCcpXG4gIH1cblxuICBzaG93UHJlcGFpZEJvbmRGb3JtICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBEb2MuaGlkZShwYWdlLmFzc2V0Rm9ybSwgcGFnZS5wcmVwYWlkQm9uZEVycilcbiAgICBwYWdlLnByZXBhaWRCb25kQ29kZS52YWx1ZSA9ICcnXG4gICAgRG9jLnNob3cocGFnZS5wcmVwYWlkQm9uZHMpXG4gIH1cblxuICBoaWRlUHJlcGFpZEJvbmRGb3JtICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBEb2MuaGlkZShwYWdlLnByZXBhaWRCb25kcylcbiAgICBEb2Muc2hvdyhwYWdlLmFzc2V0Rm9ybSlcbiAgfVxuXG4gIGFzeW5jIHN1Ym1pdFByZXBhaWRCb25kICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHhjOiB7IGhvc3QgfSB9ID0gdGhpc1xuICAgIERvYy5oaWRlKHBhZ2UucHJlcGFpZEJvbmRFcnIpXG4gICAgY29uc3QgY29kZSA9IHBhZ2UucHJlcGFpZEJvbmRDb2RlLnZhbHVlXG4gICAgaWYgKCFjb2RlKSB7XG4gICAgICBwYWdlLnByZXBhaWRCb25kRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9WQUxVRSlcbiAgICAgIERvYy5zaG93KHBhZ2UucHJlcGFpZEJvbmRFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvcmVkZWVtcHJlcGFpZGJvbmQnLCB7IGhvc3QsIGNvZGUsIGNlcnQ6IHRoaXMuY2VydEZpbGUgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5wcmVwYWlkQm9uZEVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UucHJlcGFpZEJvbmRFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zdWNjZXNzKFByZXBhaWRCb25kSUQsIHJlcy50aWVyKVxuICB9XG59XG5cbi8qXG4gKiBzZXRSZWFkeU1lc3NhZ2Ugc2V0cyBhbiBhc3NldCdzIHN0YXR1cyBtZXNzYWdlIG9uIHRoZSBGZWVBc3NldFNlbGVjdGlvbkZvcm0uXG4gKi9cbmZ1bmN0aW9uIHNldFJlYWR5TWVzc2FnZSAoZWw6IFBhZ2VFbGVtZW50LCBhc3NldDogU3VwcG9ydGVkQXNzZXQpIHtcbiAgaWYgKGFzc2V0LndhbGxldCkgZWwudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9XQUxMRVRfUkVBRFkpXG4gIGVsc2UgaWYgKGFzc2V0LndhbGxldENyZWF0aW9uUGVuZGluZykgZWwudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9XQUxMRVRfUEVORElORylcbiAgZWxzZSBlbC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1NFVFVQX05FRURFRClcbiAgZWwuY2xhc3NMaXN0LnJlbW92ZSgncmVhZHlncmVlbicsICdzZXR1cG9yYW5nZScpXG4gIGVsLmNsYXNzTGlzdC5hZGQoYXNzZXQud2FsbGV0ID8gJ3JlYWR5Z3JlZW4nIDogJ3NldHVwb3JhbmdlJylcbn1cblxuLypcbiAqIFdhbGxldFdhaXRGb3JtIGlzIGEgZm9ybSB1c2VkIHRvIHRyYWNrIHRoZSB3YWxsZXQgc3luYyBzdGF0dXMgYW5kIGJhbGFuY2VcbiAqIGluIHByZXBhcmF0aW9uIGZvciBwb3N0aW5nIGEgYm9uZC5cbiAqL1xuZXhwb3J0IGNsYXNzIFdhbGxldFdhaXRGb3JtIHtcbiAgZm9ybTogSFRNTEVsZW1lbnRcbiAgc3VjY2VzczogKCkgPT4gdm9pZFxuICBnb0JhY2s6ICgpID0+IHZvaWRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGFzc2V0SUQ6IG51bWJlclxuICBwYXJlbnRJRD86IG51bWJlclxuICB4YzogRXhjaGFuZ2VcbiAgYm9uZEFzc2V0OiBCb25kQXNzZXRcbiAgcHJvZ3Jlc3NDYWNoZTogUHJvZ3Jlc3NQb2ludFtdXG4gIHByb2dyZXNzZWQ6IGJvb2xlYW5cbiAgZnVuZGVkOiBib29sZWFuXG4gIC8vIGlmIHByb2dyZXNzZWQgJiYgZnVuZGVkLCBzdG9wIHJlcG9ydGluZyBiYWxhbmNlIG9yIHN0YXRlOyBjYWxsIHN1Y2Nlc3MoKVxuICBib25kRmVlQnVmZmVyOiBudW1iZXIgLy8gaW4gcGFyZW50IGFzc2V0XG4gIHBhcmVudEFzc2V0U3luY2VkOiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzdWNjZXNzOiAoKSA9PiB2b2lkLCBnb0JhY2s6ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGZvcm0pXG4gICAgdGhpcy5hc3NldElEID0gLTFcbiAgICB0aGlzLnByb2dyZXNzQ2FjaGUgPSBbXVxuICAgIHRoaXMucHJvZ3Jlc3NlZCA9IGZhbHNlXG4gICAgdGhpcy5mdW5kZWQgPSBmYWxzZVxuXG4gICAgRG9jLmJpbmQodGhpcy5wYWdlLmdvQmFjaywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5hc3NldElEID0gLTFcbiAgICAgIGdvQmFjaygpXG4gICAgfSlcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICB3YWxsZXRzdGF0ZTogKG5vdGU6IFdhbGxldFN0YXRlTm90ZSkgPT4gdGhpcy5yZXBvcnRXYWxsZXRTdGF0ZShub3RlLndhbGxldCksXG4gICAgICB3YWxsZXRzeW5jOiAobm90ZTogV2FsbGV0U3luY05vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUuYXNzZXRJRCAhPT0gdGhpcy5hc3NldElEKSByZXR1cm5cbiAgICAgICAgY29uc3QgdyA9IGFwcCgpLndhbGxldE1hcFtub3RlLmFzc2V0SURdXG4gICAgICAgIHRoaXMucmVwb3J0UHJvZ3Jlc3Mody5zeW5jZWQsIHcuc3luY1Byb2dyZXNzKVxuICAgICAgfSxcbiAgICAgIGJhbGFuY2U6IChub3RlOiBCYWxhbmNlTm90ZSkgPT4gdGhpcy5yZXBvcnRCYWxhbmNlKG5vdGUuYXNzZXRJRClcbiAgICB9KVxuICB9XG5cbiAgLyogc2V0RXhjaGFuZ2Ugc2V0cyB0aGUgZXhjaGFuZ2UgZm9yIHdoaWNoIHRoZSBmZWUgaXMgYmVpbmcgcGFpZC4gKi9cbiAgc2V0RXhjaGFuZ2UgKHhjOiBFeGNoYW5nZSkge1xuICAgIHRoaXMueGMgPSB4Y1xuICB9XG5cbiAgLyogc2V0V2FsbGV0IG11c3QgYmUgY2FsbGVkIGJlZm9yZSBzaG93aW5nIHRoZSBXYWxsZXRXYWl0Rm9ybS4gKi9cbiAgc2V0V2FsbGV0IChhc3NldElEOiBudW1iZXIsIGJvbmRGZWVCdWZmZXI6IG51bWJlciwgdGllcjogbnVtYmVyKSB7XG4gICAgdGhpcy5hc3NldElEID0gYXNzZXRJRFxuICAgIHRoaXMucHJvZ3Jlc3NDYWNoZSA9IFtdXG4gICAgdGhpcy5wcm9ncmVzc2VkID0gZmFsc2VcbiAgICB0aGlzLmZ1bmRlZCA9IGZhbHNlXG4gICAgdGhpcy5ib25kRmVlQnVmZmVyID0gYm9uZEZlZUJ1ZmZlciAvLyBpbiBjYXNlIHdlJ3JlIGEgdG9rZW4sIHBhcmVudCdzIGJhbGFuY2UgbXVzdCBjb3ZlclxuICAgIHRoaXMucGFyZW50QXNzZXRTeW5jZWQgPSBmYWxzZVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHsgc3ltYm9sLCB1bml0SW5mbzogdWksIHdhbGxldDogeyBiYWxhbmNlOiBiYWwsIGFkZHJlc3MsIHN5bmNlZCwgc3luY1Byb2dyZXNzIH0sIHRva2VuIH0gPSBhc3NldFxuICAgIHRoaXMucGFyZW50SUQgPSB0b2tlbj8ucGFyZW50SURcbiAgICBjb25zdCBib25kQXNzZXQgPSB0aGlzLmJvbmRBc3NldCA9IHRoaXMueGMuYm9uZEFzc2V0c1tzeW1ib2xdXG5cbiAgICBjb25zdCBzeW1ib2xpemUgPSAoZWw6IFBhZ2VFbGVtZW50LCBhc3NldDogU3VwcG9ydGVkQXNzZXQpID0+IHtcbiAgICAgIERvYy5lbXB0eShlbClcbiAgICAgIGVsLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUoYXNzZXQpKVxuICAgIH1cblxuICAgIGZvciAoY29uc3Qgc3BhbiBvZiBEb2MuYXBwbHlTZWxlY3Rvcih0aGlzLmZvcm0sICcudW5pdCcpKSBzeW1ib2xpemUoc3BhbiwgYXNzZXQpXG4gICAgcGFnZS5sb2dvLnNyYyA9IERvYy5sb2dvUGF0aChzeW1ib2wpXG4gICAgcGFnZS5kZXBvQWRkci50ZXh0Q29udGVudCA9IGFkZHJlc3NcblxuICAgIERvYy5oaWRlKHBhZ2Uuc3luY1VuY2hlY2ssIHBhZ2Uuc3luY0NoZWNrLCBwYWdlLmJhbFVuY2hlY2ssIHBhZ2UuYmFsQ2hlY2ssIHBhZ2Uuc3luY1JlbWFpbkJveCwgcGFnZS5ib25kQ29zdEJyZWFrZG93bilcbiAgICBEb2Muc2hvdyhwYWdlLmJhbGFuY2VCb3gpXG5cbiAgICBsZXQgYm9uZExvY2sgPSAyICogYm9uZEFzc2V0LmFtb3VudCAqIHRpZXJcbiAgICBpZiAoYm9uZEZlZUJ1ZmZlciA+IDApIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuYm9uZENvc3RCcmVha2Rvd24pXG4gICAgICBwYWdlLmJvbmRMb2NrTm9GZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShib25kTG9jaywgdWkpXG4gICAgICBwYWdlLmJvbmRMb2NrRmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYm9uZEZlZUJ1ZmZlciwgdWkpXG4gICAgICBib25kTG9jayArPSBib25kRmVlQnVmZmVyXG4gICAgICBjb25zdCBuZWVkID0gTWF0aC5tYXgoYm9uZExvY2sgLSBiYWwuYXZhaWxhYmxlICsgYmFsLnJlc2VydmVzRGVmaWNpdCwgMClcbiAgICAgIHBhZ2UudG90YWxGb3JCb25kLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShuZWVkLCB1aSlcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc2VuZEVub3VnaCkgLy8gZ2VuZXJpYyBtc2cgd2hlbiBubyBmZWUgaW5mbyBhdmFpbGFibGUgd2hlblxuICAgICAgRG9jLmhpZGUocGFnZS50eEZlZUJveCwgcGFnZS5zZW5kRW5vdWdoRm9yVG9rZW4sIHBhZ2UudHhGZWVCYWxhbmNlQm94KSAvLyBmb3IgdG9rZW5zXG4gICAgICBEb2MuaGlkZShwYWdlLnNlbmRFbm91Z2hXaXRoRXN0KSAvLyBub24tdG9rZW5zXG5cbiAgICAgIGlmICh0b2tlbikge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLnR4RmVlQm94LCBwYWdlLnNlbmRFbm91Z2hGb3JUb2tlbiwgcGFnZS50eEZlZUJhbGFuY2VCb3gpXG4gICAgICAgIGNvbnN0IHBhcmVudEFzc2V0ID0gYXBwKCkuYXNzZXRzW3Rva2VuLnBhcmVudElEXVxuICAgICAgICBwYWdlLnR4RmVlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShib25kRmVlQnVmZmVyLCBwYXJlbnRBc3NldC51bml0SW5mbylcbiAgICAgICAgcGFnZS5wYXJlbnRGZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShib25kRmVlQnVmZmVyLCBwYXJlbnRBc3NldC51bml0SW5mbylcbiAgICAgICAgcGFnZS50b2tlbkZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG5lZWQsIHVpKVxuICAgICAgICBzeW1ib2xpemUocGFnZS50eEZlZVVuaXQsIHBhcmVudEFzc2V0KVxuICAgICAgICBzeW1ib2xpemUocGFnZS5wYXJlbnRVbml0LCBwYXJlbnRBc3NldClcbiAgICAgICAgc3ltYm9saXplKHBhZ2UucGFyZW50QmFsVW5pdCwgcGFyZW50QXNzZXQpXG4gICAgICAgIHBhZ2UucGFyZW50QmFsLnRleHRDb250ZW50ID0gcGFyZW50QXNzZXQud2FsbGV0ID8gRG9jLmZvcm1hdENvaW5WYWx1ZShwYXJlbnRBc3NldC53YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUsIHBhcmVudEFzc2V0LnVuaXRJbmZvKSA6ICcwJ1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS5zZW5kRW5vdWdoV2l0aEVzdClcbiAgICAgIH1cbiAgICAgIHBhZ2UuZmVlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShib25kTG9jaywgdWkpXG4gICAgfSBlbHNlIHsgLy8gc2hvdyBzb21lIGdlbmVyaWMgbWVzc2FnZSB3aXRoIG5vIGFtb3VudHMsIHRoaXMgc2hvdWxkbid0IGhhcHBlbi4uLiBzaG93IHdhbGxldCBlcnJvcj9cbiAgICAgIERvYy5zaG93KHBhZ2Uuc2VuZEVub3VnaClcbiAgICB9XG5cbiAgICBEb2Muc2hvdyhzeW5jZWQgPyBwYWdlLnN5bmNDaGVjayA6IHN5bmNQcm9ncmVzcyA+PSAxID8gcGFnZS5zeW5jU3Bpbm5lciA6IHBhZ2Uuc3luY1VuY2hlY2spXG4gICAgRG9jLnNob3coYmFsLmF2YWlsYWJsZSA+PSAyICogYm9uZEFzc2V0LmFtb3VudCArIGJvbmRGZWVCdWZmZXIgPyBwYWdlLmJhbENoZWNrIDogcGFnZS5iYWxVbmNoZWNrKVxuXG4gICAgcGFnZS5wcm9ncmVzcy50ZXh0Q29udGVudCA9IChzeW5jUHJvZ3Jlc3MgKiAxMDApLnRvRml4ZWQoMSlcblxuICAgIGlmIChzeW5jZWQpIHtcbiAgICAgIHRoaXMucHJvZ3Jlc3NlZCA9IHRydWVcbiAgICB9XG4gICAgdGhpcy5yZXBvcnRCYWxhbmNlKGFzc2V0SUQpXG4gIH1cblxuICAvKlxuICAgKiByZXBvcnRXYWxsZXRTdGF0ZSBzZXRzIHRoZSBwcm9ncmVzcyBhbmQgYmFsYW5jZSwgdWx0aW1hdGVseSBjYWxsaW5nIHRoZVxuICAgKiBzdWNjZXNzIGZ1bmN0aW9uIGlmIGNvbmRpdGlvbnMgYXJlIG1ldC5cbiAgICovXG4gIHJlcG9ydFdhbGxldFN0YXRlICh3YWxsZXQ6IFdhbGxldFN0YXRlKSB7XG4gICAgaWYgKHRoaXMucHJvZ3Jlc3NlZCAmJiB0aGlzLmZ1bmRlZCkgcmV0dXJuXG4gICAgaWYgKHdhbGxldC5hc3NldElEID09PSB0aGlzLmFzc2V0SUQpIHRoaXMucmVwb3J0UHJvZ3Jlc3Mod2FsbGV0LnN5bmNlZCwgd2FsbGV0LnN5bmNQcm9ncmVzcylcbiAgICB0aGlzLnJlcG9ydEJhbGFuY2Uod2FsbGV0LmFzc2V0SUQpXG4gIH1cblxuICAvKlxuICAgKiByZXBvcnRCYWxhbmNlIHNldHMgdGhlIGJhbGFuY2UgZGlzcGxheSBhbmQgY2FsbHMgc3VjY2VzcyBpZiB3ZSBnbyBvdmVyIHRoZVxuICAgKiB0aHJlc2hvbGQuXG4gICAqL1xuICByZXBvcnRCYWxhbmNlIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBpZiAodGhpcy5mdW5kZWQgfHwgdGhpcy5hc3NldElEID09PSAtMSkgcmV0dXJuXG4gICAgaWYgKGFzc2V0SUQgIT09IHRoaXMuYXNzZXRJRCAmJiBhc3NldElEICE9PSB0aGlzLnBhcmVudElEKSByZXR1cm5cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5hc3NldElEXVxuXG4gICAgY29uc3QgYXZhaWwgPSBhc3NldC53YWxsZXQuYmFsYW5jZS5hdmFpbGFibGVcbiAgICBwYWdlLmJhbGFuY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGF2YWlsLCBhc3NldC51bml0SW5mbylcblxuICAgIGlmIChhc3NldC50b2tlbikge1xuICAgICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXQudG9rZW4ucGFyZW50SURdXG4gICAgICBjb25zdCBwYXJlbnRBdmFpbCA9IHBhcmVudEFzc2V0LndhbGxldC5iYWxhbmNlLmF2YWlsYWJsZVxuICAgICAgcGFnZS5wYXJlbnRCYWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHBhcmVudEF2YWlsLCBwYXJlbnRBc3NldC51bml0SW5mbylcbiAgICAgIGlmIChwYXJlbnRBdmFpbCA8IHRoaXMuYm9uZEZlZUJ1ZmZlcikgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gTk9URTogd2hlbi9pZiB3ZSBhbGxvdyBvbmUtdGltZSBib25kIHBvc3QgKG5vIG1haW50ZW5hbmNlKSBmcm9tIHRoZSBVSSB3ZVxuICAgIC8vIG1heSBhbGxvdyB0byBwcm9jZWVkIGFzIGxvbmcgYXMgdGhleSBoYXZlIGVub3VnaCBmb3IgdHggZmVlcy4gRm9yIG5vdyxcbiAgICAvLyB0aGUgYmFsYW5jZSBjaGVjayBib3ggd2lsbCByZW1haW4gdW5jaGVja2VkIGFuZCB3ZSB3aWxsIG5vdCBwcm9jZWVkLlxuICAgIGlmIChhdmFpbCA8IDIgKiB0aGlzLmJvbmRBc3NldC5hbW91bnQgKyB0aGlzLmJvbmRGZWVCdWZmZXIpIHJldHVyblxuXG4gICAgRG9jLnNob3cocGFnZS5iYWxDaGVjaylcbiAgICBEb2MuaGlkZShwYWdlLmJhbFVuY2hlY2ssIHBhZ2UuYmFsYW5jZUJveCwgcGFnZS5zZW5kRW5vdWdoKVxuICAgIHRoaXMuZnVuZGVkID0gdHJ1ZVxuICAgIGlmICh0aGlzLnByb2dyZXNzZWQpIHRoaXMuc3VjY2VzcygpXG4gIH1cblxuICAvKlxuICAgKiByZXBvcnRQcm9ncmVzcyBzZXRzIHRoZSBwcm9ncmVzcyBkaXNwbGF5IGFuZCBjYWxscyBzdWNjZXNzIGlmIHdlIGFyZSBmdWxseVxuICAgKiBzeW5jZWQuXG4gICAqL1xuICByZXBvcnRQcm9ncmVzcyAoc3luY2VkOiBib29sZWFuLCBwcm9nOiBudW1iZXIpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgaWYgKHN5bmNlZCkge1xuICAgICAgcGFnZS5wcm9ncmVzcy50ZXh0Q29udGVudCA9ICcxMDAnXG4gICAgICBEb2MuaGlkZShwYWdlLnN5bmNVbmNoZWNrLCBwYWdlLnN5bmNSZW1haW5Cb3gsIHBhZ2Uuc3luY1NwaW5uZXIpXG4gICAgICBEb2Muc2hvdyhwYWdlLnN5bmNDaGVjaylcbiAgICAgIHRoaXMucHJvZ3Jlc3NlZCA9IHRydWVcbiAgICAgIGlmICh0aGlzLmZ1bmRlZCkgdGhpcy5zdWNjZXNzKClcbiAgICAgIHJldHVyblxuICAgIH0gZWxzZSBpZiAocHJvZyA9PT0gMSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5zeW5jVW5jaGVjaylcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3luY1NwaW5uZXIpXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc3luY1NwaW5uZXIpXG4gICAgICBEb2Muc2hvdyhwYWdlLnN5bmNVbmNoZWNrKVxuICAgIH1cbiAgICBwYWdlLnByb2dyZXNzLnRleHRDb250ZW50ID0gKHByb2cgKiAxMDApLnRvRml4ZWQoMSlcblxuICAgIGlmIChwcm9nID49IDAuOTk5KSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnN5bmNSZW1haW5pbmcpXG4gICAgICBEb2Muc2hvdyhwYWdlLnN5bmNGaW5pc2hpbmdVcClcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3luY1JlbWFpbkJveClcbiAgICAgIC8vIFRoZSBmaW5hbCBzdGFnZSBvZiB3YWxsZXQgc3luYyBwcm9jZXNzIGNhbiB0YWtlIGEgd2hpbGUgKGl0IG1pZ2h0IGhhbmdcbiAgICAgIC8vIGF0IDk5LjklIGZvciBtYW55IG1pbnV0ZXMsIGluZGV4aW5nIGFkZHJlc3NlcyBmb3IgZXhhbXBsZSksIHRoZSBzaW1wbGVzdFxuICAgICAgLy8gd2F5IHRvIGhhbmRsZSBpdCBpcyB0byBrZWVwIGRpc3BsYXlpbmcgXCJmaW5pc2hpbmcgdXBcIiBtZXNzYWdlIHVudGlsIHRoZVxuICAgICAgLy8gc3luYyBpcyBmaW5pc2hlZCwgc2luY2Ugd2UgY2FuJ3QgcmVhc29uYWJseSBzaG93IGl0IHByb2dyZXNzaW5nIG92ZXIgdGltZS5cbiAgICAgIHBhZ2Uuc3luY0ZpbmlzaGluZ1VwLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfV0FMTEVUX1NZTkNfRklOSVNISU5HX1VQKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIEJlZm9yZSB3ZSBnZXQgdG8gOTkuOSUgdGhlIHJlbWFpbmluZyB0aW1lIGVzdGltYXRlIG11c3QgYmUgYmFzZWQgb24gbW9yZVxuICAgIC8vIHRoYW4gb25lIHByb2dyZXNzIHJlcG9ydC4gV2UnbGwgY2FjaGUgdXAgdG8gdGhlIGxhc3QgMjAgYW5kIGxvb2sgYXQgdGhlXG4gICAgLy8gZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBmaXJzdCBhbmQgbGFzdCB0byBtYWtlIHRoZSBlc3RpbWF0ZS5cbiAgICBjb25zdCBjYWNoZVNpemUgPSAyMFxuICAgIGNvbnN0IGNhY2hlID0gdGhpcy5wcm9ncmVzc0NhY2hlXG4gICAgY2FjaGUucHVzaCh7XG4gICAgICBzdGFtcDogbmV3IERhdGUoKS5nZXRUaW1lKCksXG4gICAgICBwcm9ncmVzczogcHJvZ1xuICAgIH0pXG4gICAgaWYgKGNhY2hlLmxlbmd0aCA8IDIpIHtcbiAgICAgIC8vIENhbid0IG1lYW5pbmdmdWxseSBlc3RpbWF0ZSByZW1haW5pbmcgdW50aWwgd2UgaGF2ZSBhdCBsZWFzdCAyIGRhdGEgcG9pbnRzLlxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHdoaWxlIChjYWNoZS5sZW5ndGggPiBjYWNoZVNpemUpIGNhY2hlLnNoaWZ0KClcbiAgICBjb25zdCBbZmlyc3QsIGxhc3RdID0gW2NhY2hlWzBdLCBjYWNoZVtjYWNoZS5sZW5ndGggLSAxXV1cbiAgICBjb25zdCBwcm9nRGVsdGEgPSBsYXN0LnByb2dyZXNzIC0gZmlyc3QucHJvZ3Jlc3NcbiAgICBpZiAocHJvZ0RlbHRhID09PSAwKSB7XG4gICAgICAvLyBIYXZpbmcgbm8gcHJvZ3Jlc3MgZm9yIGEgd2hpbGUgbGlrZWx5IG1lYW5zIHdlIGFyZSBleHBlcmllbmNpbmcgbmV0d29ya1xuICAgICAgLy8gaXNzdWVzLCBjYW4ndCByZWFzb25hYmx5IGVzdGltYXRlIHRpbWUgcmVtYWluaW5nIGluIHRoaXMgY2FzZS5cbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2MuaGlkZShwYWdlLnN5bmNGaW5pc2hpbmdVcClcbiAgICBEb2Muc2hvdyhwYWdlLnN5bmNSZW1haW5pbmcpXG4gICAgRG9jLnNob3cocGFnZS5zeW5jUmVtYWluQm94KVxuICAgIGNvbnN0IHRpbWVEZWx0YSA9IGxhc3Quc3RhbXAgLSBmaXJzdC5zdGFtcFxuICAgIGNvbnN0IHByb2dSYXRlID0gcHJvZ0RlbHRhIC8gdGltZURlbHRhXG4gICAgY29uc3QgdG9Hb1Byb2cgPSAxIC0gbGFzdC5wcm9ncmVzc1xuICAgIGNvbnN0IHRvR29UaW1lID0gdG9Hb1Byb2cgLyBwcm9nUmF0ZVxuICAgIHBhZ2Uuc3luY1JlbWFpbi50ZXh0Q29udGVudCA9IERvYy5mb3JtYXREdXJhdGlvbih0b0dvVGltZSlcbiAgfVxufVxuXG5pbnRlcmZhY2UgRWFybHlBY2NlbGVyYXRpb24ge1xuICB0aW1lUGFzdDogbnVtYmVyLFxuICB3YXNBY2NlbGVyYXRpb246IGJvb2xlYW5cbn1cblxuaW50ZXJmYWNlIFByZUFjY2VsZXJhdGUge1xuICBzd2FwUmF0ZTogbnVtYmVyXG4gIHN1Z2dlc3RlZFJhdGU6IG51bWJlclxuICBzdWdnZXN0ZWRSYW5nZTogWFlSYW5nZVxuICBlYXJseUFjY2VsZXJhdGlvbj86IEVhcmx5QWNjZWxlcmF0aW9uXG59XG5cbi8qXG4gKiBBY2NlbGVyYXRlT3JkZXJGb3JtIGlzIHVzZWQgdG8gc3VibWl0IGFuIGFjY2VsZXJhdGlvbiByZXF1ZXN0IGZvciBhbiBvcmRlci5cbiAqL1xuZXhwb3J0IGNsYXNzIEFjY2VsZXJhdGVPcmRlckZvcm0ge1xuICBmb3JtOiBIVE1MRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgb3JkZXI6IE9yZGVyXG4gIGFjY2VsZXJhdGVkUmF0ZTogbnVtYmVyXG4gIGVhcmx5QWNjZWxlcmF0aW9uPzogRWFybHlBY2NlbGVyYXRpb25cbiAgY3VycmVuY3lVbml0OiBzdHJpbmdcbiAgc3VjY2VzczogKCkgPT4gdm9pZFxuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBIVE1MRWxlbWVudCwgc3VjY2VzczogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGZvcm0pXG5cbiAgICBEb2MuYmluZChwYWdlLmFjY2VsZXJhdGVTdWJtaXQsICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc3VibWl0KClcbiAgICB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc3VibWl0RWFybHlDb25maXJtLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnNlbmRBY2NlbGVyYXRlUmVxdWVzdCgpXG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICAqIGRpc3BsYXlFYXJseUFjY2VsZXJhdGlvbk1zZyBkaXNwbGF5cyBhIG1lc3NhZ2UgYXNraW5nIGZvciBjb25maXJtYXRpb25cbiAgICogd2hlbiB0aGUgdXNlciB0cmllcyB0byBzdWJtaXQgYW4gYWNjZWxlcmF0aW9uIHRyYW5zYWN0aW9uIHZlcnkgc29vbiBhZnRlclxuICAgKiB0aGUgc3dhcCB0cmFuc2FjdGlvbiB3YXMgYnJvYWRjYXN0LCBvciB2ZXJ5IHNvb24gYWZ0ZXIgYSBwcmV2aW91c1xuICAgKiBhY2NlbGVyYXRpb24uXG4gICAqL1xuICBkaXNwbGF5RWFybHlBY2NlbGVyYXRpb25Nc2cgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICAvLyB0aGlzIGlzIGNoZWNrZWQgaW4gc3VibWl0LCBidXQgYW5vdGhlciBjaGVjayBpcyBuZWVkZWQgZm9yIHRzIGNvbXBpbGVyXG4gICAgaWYgKCF0aGlzLmVhcmx5QWNjZWxlcmF0aW9uKSByZXR1cm5cbiAgICBwYWdlLnJlY2VudEFjY2VsZXJhdGlvblRpbWUudGV4dENvbnRlbnQgPSBgJHtNYXRoLmZsb29yKHRoaXMuZWFybHlBY2NlbGVyYXRpb24udGltZVBhc3QgLyA2MCl9YFxuICAgIHBhZ2UucmVjZW50U3dhcFRpbWUudGV4dENvbnRlbnQgPSBgJHtNYXRoLmZsb29yKHRoaXMuZWFybHlBY2NlbGVyYXRpb24udGltZVBhc3QgLyA2MCl9YFxuICAgIGlmICh0aGlzLmVhcmx5QWNjZWxlcmF0aW9uLndhc0FjY2VsZXJhdGlvbikge1xuICAgICAgRG9jLnNob3cocGFnZS5yZWNlbnRBY2NlbGVyYXRpb25Nc2cpXG4gICAgICBEb2MuaGlkZShwYWdlLnJlY2VudFN3YXBNc2cpXG4gICAgICBwYWdlLnJlY2VudEFjY2VsZXJhdGlvblRpbWUudGV4dENvbnRlbnQgPSBgJHtNYXRoLmZsb29yKHRoaXMuZWFybHlBY2NlbGVyYXRpb24udGltZVBhc3QgLyA2MCl9YFxuICAgIH0gZWxzZSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnJlY2VudFN3YXBNc2cpXG4gICAgICBEb2MuaGlkZShwYWdlLnJlY2VudEFjY2VsZXJhdGlvbk1zZylcbiAgICAgIHBhZ2UucmVjZW50U3dhcFRpbWUudGV4dENvbnRlbnQgPSBgJHtNYXRoLmZsb29yKHRoaXMuZWFybHlBY2NlbGVyYXRpb24udGltZVBhc3QgLyA2MCl9YFxuICAgIH1cbiAgICBEb2MuaGlkZShwYWdlLmNvbmZpZ3VyZUFjY2VsZXJhdGlvbkRpdiwgcGFnZS5hY2NlbGVyYXRlRXJyKVxuICAgIERvYy5zaG93KHBhZ2UuZWFybHlBY2NlbGVyYXRpb25EaXYpXG4gIH1cblxuICAvLyBzZW5kQWNjZWxlcmF0ZVJlcXVlc3QgbWFrZXMgYW4gYWNjZWxlcmF0ZSBvcmRlciByZXF1ZXN0IHRvIHRoZSBjbGllbnRcbiAgLy8gYmFja2VuZC5cbiAgYXN5bmMgc2VuZEFjY2VsZXJhdGVSZXF1ZXN0ICgpIHtcbiAgICBjb25zdCBvcmRlciA9IHRoaXMub3JkZXJcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgb3JkZXJJRDogb3JkZXIuaWQsXG4gICAgICBuZXdSYXRlOiB0aGlzLmFjY2VsZXJhdGVkUmF0ZVxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuYWNjZWxlcmF0ZU1haW5EaXYpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvYWNjZWxlcmF0ZW9yZGVyJywgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKGFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5hY2NlbGVyYXRlVHhJRC50ZXh0Q29udGVudCA9IHJlcy50eElEXG4gICAgICBEb2MuaGlkZShwYWdlLmFjY2VsZXJhdGVNYWluRGl2LCBwYWdlLnByZUFjY2VsZXJhdGVFcnIsIHBhZ2UuYWNjZWxlcmF0ZUVycilcbiAgICAgIERvYy5zaG93KHBhZ2UuYWNjZWxlcmF0ZU1zZ0RpdiwgcGFnZS5hY2NlbGVyYXRlU3VjY2VzcylcbiAgICAgIHRoaXMuc3VjY2VzcygpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2UuYWNjZWxlcmF0ZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX09SREVSX0FDQ0VMRVJBVElPTl9FUlJfTVNHLCB7IG1zZzogcmVzLm1zZyB9KVxuICAgICAgRG9jLmhpZGUocGFnZS5lYXJseUFjY2VsZXJhdGlvbkRpdilcbiAgICAgIERvYy5zaG93KHBhZ2UuYWNjZWxlcmF0ZUVyciwgcGFnZS5jb25maWd1cmVBY2NlbGVyYXRpb25EaXYpXG4gICAgfVxuICB9XG5cbiAgLy8gc3VibWl0IGlzIGNhbGxlZCB3aGVuIHRoZSBzdWJtaXQgYnV0dG9uIGlzIGNsaWNrZWQuXG4gIGFzeW5jIHN1Ym1pdCAoKSB7XG4gICAgaWYgKHRoaXMuZWFybHlBY2NlbGVyYXRpb24pIHtcbiAgICAgIHRoaXMuZGlzcGxheUVhcmx5QWNjZWxlcmF0aW9uTXNnKClcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZW5kQWNjZWxlcmF0ZVJlcXVlc3QoKVxuICAgIH1cbiAgfVxuXG4gIC8vIHJlZnJlc2ggc2hvdWxkIGJlIGNhbGxlZCBiZWZvcmUgdGhlIGZvcm0gaXMgZGlzcGxheWVkLiBJdCBtYWtlcyBhXG4gIC8vIHByZWFjY2VsZXJhdGUgcmVxdWVzdCB0byB0aGUgY2xpZW50IGJhY2tlbmQgYW5kIHNldHMgdXAgdGhlIGZvcm1cbiAgLy8gYmFzZWQgb24gdGhlIHJlc3VsdHMuXG4gIGFzeW5jIHJlZnJlc2ggKG9yZGVyOiBPcmRlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLm9yZGVyID0gb3JkZXJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9wcmVhY2NlbGVyYXRlJywgb3JkZXIuaWQpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UucHJlQWNjZWxlcmF0ZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX09SREVSX0FDQ0VMRVJBVElPTl9FUlJfTVNHLCB7IG1zZzogcmVzLm1zZyB9KVxuICAgICAgRG9jLmhpZGUocGFnZS5hY2NlbGVyYXRlTWFpbkRpdiwgcGFnZS5hY2NlbGVyYXRlU3VjY2VzcylcbiAgICAgIERvYy5zaG93KHBhZ2UuYWNjZWxlcmF0ZU1zZ0RpdiwgcGFnZS5wcmVBY2NlbGVyYXRlRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2UuYWNjZWxlcmF0ZU1zZ0RpdiwgcGFnZS5wcmVBY2NlbGVyYXRlRXJyLCBwYWdlLmFjY2VsZXJhdGVFcnIsIHBhZ2UuZmVlRXN0aW1hdGVEaXYsIHBhZ2UuZWFybHlBY2NlbGVyYXRpb25EaXYpXG4gICAgRG9jLnNob3cocGFnZS5hY2NlbGVyYXRlTWFpbkRpdiwgcGFnZS5hY2NlbGVyYXRlU3VjY2VzcywgcGFnZS5jb25maWd1cmVBY2NlbGVyYXRpb25EaXYpXG4gICAgY29uc3QgcHJlQWNjZWxlcmF0ZTogUHJlQWNjZWxlcmF0ZSA9IHJlcy5wcmVBY2NlbGVyYXRlXG4gICAgdGhpcy5lYXJseUFjY2VsZXJhdGlvbiA9IHByZUFjY2VsZXJhdGUuZWFybHlBY2NlbGVyYXRpb25cbiAgICB0aGlzLmN1cnJlbmN5VW5pdCA9IHByZUFjY2VsZXJhdGUuc3VnZ2VzdGVkUmFuZ2UueVVuaXRcbiAgICBwYWdlLmFjY2VsZXJhdGVBdmdGZWVSYXRlLnRleHRDb250ZW50ID0gYCR7cHJlQWNjZWxlcmF0ZS5zd2FwUmF0ZX0gJHtwcmVBY2NlbGVyYXRlLnN1Z2dlc3RlZFJhbmdlLnlVbml0fWBcbiAgICBwYWdlLmFjY2VsZXJhdGVDdXJyZW50RmVlUmF0ZS50ZXh0Q29udGVudCA9IGAke3ByZUFjY2VsZXJhdGUuc3VnZ2VzdGVkUmF0ZX0gJHtwcmVBY2NlbGVyYXRlLnN1Z2dlc3RlZFJhbmdlLnlVbml0fWBcbiAgICB0aGlzLmFjY2VsZXJhdGVkUmF0ZSA9IHByZUFjY2VsZXJhdGUuc3VnZ2VzdGVkUmFuZ2Uuc3RhcnQueVxuICAgIGNvbnN0IHNlbGVjdGVkID0gKCkgPT4geyAvKiBkbyBub3RoaW5nICovIH1cbiAgICBjb25zdCByb3VuZFkgPSB0cnVlXG4gICAgY29uc3QgdXBkYXRlUmF0ZSA9IChfOiBudW1iZXIsIG5ld1k6IG51bWJlcikgPT4geyB0aGlzLmFjY2VsZXJhdGVkUmF0ZSA9IG5ld1kgfVxuICAgIGNvbnN0IHJhbmdlSGFuZGxlciA9IG5ldyBYWVJhbmdlSGFuZGxlcihwcmVBY2NlbGVyYXRlLnN1Z2dlc3RlZFJhbmdlLCBwcmVBY2NlbGVyYXRlLnN1Z2dlc3RlZFJhbmdlLnN0YXJ0LngsIHtcbiAgICAgIHVwZGF0ZWQ6IHVwZGF0ZVJhdGUsIGNoYW5nZWQ6ICgpID0+IHRoaXMudXBkYXRlQWNjZWxlcmF0aW9uRXN0aW1hdGUoKSwgc2VsZWN0ZWQsIHJvdW5kWVxuICAgIH0pXG4gICAgRG9jLmVtcHR5KHBhZ2Uuc2xpZGVyQ29udGFpbmVyKVxuICAgIHBhZ2Uuc2xpZGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKHJhbmdlSGFuZGxlci5jb250cm9sKVxuICAgIHRoaXMudXBkYXRlQWNjZWxlcmF0aW9uRXN0aW1hdGUoKVxuICB9XG5cbiAgLy8gdXBkYXRlQWNjZWxlcmF0aW9uRXN0aW1hdGUgbWFrZXMgYW4gYWNjZWxlcmF0ZSBlc3RpbWF0ZSByZXF1ZXN0IHRvIHRoZVxuICAvLyBjbGllbnQgYmFja2VuZCB1c2luZyB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHJhdGUgb24gdGhlIHNsaWRlciwgYW5kXG4gIC8vIGRpc3BsYXlzIHRoZSByZXN1bHRzLlxuICBhc3luYyB1cGRhdGVBY2NlbGVyYXRpb25Fc3RpbWF0ZSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IG9yZGVyID0gdGhpcy5vcmRlclxuICAgIGNvbnN0IHJlcSA9IHtcbiAgICAgIG9yZGVySUQ6IG9yZGVyLmlkLFxuICAgICAgbmV3UmF0ZTogdGhpcy5hY2NlbGVyYXRlZFJhdGVcbiAgICB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnNsaWRlckNvbnRhaW5lcilcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9hY2NlbGVyYXRpb25lc3RpbWF0ZScsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmFjY2VsZXJhdGVFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9BQ0NFTEVSQVRJT05fRkVFX0VSUl9NU0csIHsgbXNnOiByZXMubXNnIH0pXG4gICAgICBEb2Muc2hvdyhwYWdlLmFjY2VsZXJhdGVFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgcGFnZS5mZWVSYXRlRXN0aW1hdGUudGV4dENvbnRlbnQgPSBgJHt0aGlzLmFjY2VsZXJhdGVkUmF0ZX0gJHt0aGlzLmN1cnJlbmN5VW5pdH1gXG4gICAgbGV0IGFzc2V0SURcbiAgICBsZXQgYXNzZXRTeW1ib2xcbiAgICBpZiAob3JkZXIuc2VsbCkge1xuICAgICAgYXNzZXRJRCA9IG9yZGVyLmJhc2VJRFxuICAgICAgYXNzZXRTeW1ib2wgPSBvcmRlci5iYXNlU3ltYm9sXG4gICAgfSBlbHNlIHtcbiAgICAgIGFzc2V0SUQgPSBvcmRlci5xdW90ZUlEXG4gICAgICBhc3NldFN5bWJvbCA9IG9yZGVyLnF1b3RlU3ltYm9sXG4gICAgfVxuICAgIGNvbnN0IHVuaXRJbmZvID0gYXBwKCkudW5pdEluZm8oYXNzZXRJRClcbiAgICBwYWdlLmZlZUVzdGltYXRlLnRleHRDb250ZW50ID0gYCR7cmVzLmZlZSAvIHVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yfSAke2Fzc2V0U3ltYm9sfWBcbiAgICBEb2Muc2hvdyhwYWdlLmZlZUVzdGltYXRlRGl2KVxuICB9XG59XG5cbi8qIERFWEFkZHJlc3NGb3JtIGFjY2VwdHMgYSBERVggYWRkcmVzcyBhbmQgcGVyZm9ybXMgYWNjb3VudCBkaXNjb3ZlcnkuICovXG5leHBvcnQgY2xhc3MgREVYQWRkcmVzc0Zvcm0ge1xuICBmb3JtOiBIVE1MRWxlbWVudFxuICBzdWNjZXNzOiAoeGM6IEV4Y2hhbmdlLCBjZXJ0OiBzdHJpbmcpID0+IHZvaWRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGtub3duRXhjaGFuZ2VzOiBIVE1MRWxlbWVudFtdXG4gIGRleFRvVXBkYXRlPzogc3RyaW5nXG4gIGNlcnRQaWNrZXI6IENlcnRpZmljYXRlUGlja2VyXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzdWNjZXNzOiAoeGM6IEV4Y2hhbmdlLCBjZXJ0OiBzdHJpbmcpID0+IHZvaWQsIGRleFRvVXBkYXRlPzogc3RyaW5nKSB7XG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIHRoaXMuc3VjY2VzcyA9IHN1Y2Nlc3NcblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShmb3JtKVxuXG4gICAgdGhpcy5jZXJ0UGlja2VyID0gbmV3IENlcnRpZmljYXRlUGlja2VyKGZvcm0pXG5cbiAgICBEb2MuYmluZChwYWdlLnNraXBSZWdpc3RyYXRpb24sICdjaGFuZ2UnLCAoKSA9PiB0aGlzLnNob3dPckhpZGVTdWJtaXRCdHRuKCkpXG4gICAgRG9jLmJpbmQocGFnZS5zaG93Q3VzdG9tLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLnNob3dDdXN0b20pXG4gICAgICBEb2Muc2hvdyhwYWdlLmN1c3RvbUJveCwgcGFnZS5hdXRoKVxuICAgIH0pXG5cbiAgICB0aGlzLmtub3duRXhjaGFuZ2VzID0gQXJyYXkuZnJvbShwYWdlLmtub3duWENzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5rbm93bi1leGNoYW5nZScpKVxuICAgIGZvciAoY29uc3QgZGl2IG9mIHRoaXMua25vd25FeGNoYW5nZXMpIHtcbiAgICAgIERvYy5iaW5kKGRpdiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBob3N0ID0gZGl2LmRhdGFzZXQuaG9zdFxuICAgICAgICBmb3IgKGNvbnN0IGQgb2YgdGhpcy5rbm93bkV4Y2hhbmdlcykgZC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrREVYKGhvc3QpXG4gICAgICB9KVxuICAgIH1cblxuICAgIGJpbmQoZm9ybSwgcGFnZS5zdWJtaXQsICgpID0+IHRoaXMuY2hlY2tERVgoKSlcblxuICAgIGlmIChkZXhUb1VwZGF0ZSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5hZGREZXhIZHIsIHBhZ2Uuc2tpcFJlZ2lzdHJhdGlvbkJveClcbiAgICAgIERvYy5zaG93KHBhZ2UudXBkYXRlRGV4SGRyKVxuICAgICAgdGhpcy5kZXhUb1VwZGF0ZSA9IGRleFRvVXBkYXRlXG4gICAgfVxuXG4gICAgdGhpcy5yZWZyZXNoKClcbiAgfVxuXG4gIHJlZnJlc2ggKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLmFkZHIudmFsdWUgPSAnJ1xuICAgIHRoaXMuY2VydFBpY2tlci5jbGVhckNlcnRGaWxlKClcbiAgICBEb2MuaGlkZShwYWdlLmVycilcbiAgICBpZiAodGhpcy5rbm93bkV4Y2hhbmdlcy5sZW5ndGggPT09IDAgfHwgdGhpcy5kZXhUb1VwZGF0ZSkge1xuICAgICAgRG9jLnNob3cocGFnZS5jdXN0b21Cb3gsIHBhZ2UuYXV0aClcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc2hvd0N1c3RvbSwgcGFnZS5rbm93blhDcywgcGFnZS5waWNrU2VydmVyTXNnLCBwYWdlLmFkZEN1c3RvbU1zZylcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS5jdXN0b21Cb3gpXG4gICAgICBEb2Muc2hvdyhwYWdlLnNob3dDdXN0b20pXG4gICAgfVxuICAgIGZvciAoY29uc3QgZGl2IG9mIHRoaXMua25vd25FeGNoYW5nZXMpIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgdGhpcy5zaG93T3JIaWRlU3VibWl0QnR0bigpXG4gIH1cblxuICAvKipcbiAgICogU2hvdyBvciBoaWRlIGFwcFBXQm94IGRlcGVuZGluZyBvbiBpZiBwYXNzd29yZCBpcyByZXF1aXJlZC4gU2hvdyB0aGVcbiAgICogc3VibWl0IGJ1dHRvbiBpZiBjb25uZWN0aW5nIGEgY3VzdG9tIHNlcnZlciBvciBwYXNzd29yZCBpcyByZXF1aXJlZCkuXG4gICAqL1xuICBzaG93T3JIaWRlU3VibWl0QnR0biAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5zZXRWaXMoRG9jLmlzRGlzcGxheWVkKHBhZ2UuY3VzdG9tQm94KSwgcGFnZS5hdXRoKVxuICB9XG5cbiAgc2tpcFJlZ2lzdHJhdGlvbiAoKSA6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnBhZ2Uuc2tpcFJlZ2lzdHJhdGlvbi5jaGVja2VkID8/IGZhbHNlXG4gIH1cblxuICAvKiBKdXN0IGEgc21hbGwgc2l6ZSB0d2VhayBhbmQgZmFkZS1pbi4gKi9cbiAgYXN5bmMgYW5pbWF0ZSAoKSB7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuZm9ybVxuICAgIERvYy5hbmltYXRlKDU1MCwgcHJvZyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgkezAuOSArIDAuMSAqIHByb2d9KWBcbiAgICAgIGZvcm0uc3R5bGUub3BhY2l0eSA9IFN0cmluZyhNYXRoLnBvdyhwcm9nLCA0KSlcbiAgICB9LCAnZWFzZU91dCcpXG4gIH1cblxuICBhc3luYyBjaGVja0RFWCAoYWRkcj86IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmVycilcbiAgICBhZGRyID0gYWRkciB8fCBwYWdlLmFkZHIudmFsdWVcbiAgICBpZiAoYWRkciA9PT0gJycpIHtcbiAgICAgIHBhZ2UuZXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfRU1QVFlfREVYX0FERFJFU1NfTVNHKVxuICAgICAgRG9jLnNob3cocGFnZS5lcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgY2VydCA9IGF3YWl0IHRoaXMuY2VydFBpY2tlci5maWxlKClcbiAgICBjb25zdCBza2lwUmVnaXN0cmF0aW9uID0gdGhpcy5za2lwUmVnaXN0cmF0aW9uKClcbiAgICBsZXQgZW5kcG9pbnQgOiBzdHJpbmcsIHJlcTogYW55XG4gICAgaWYgKHRoaXMuZGV4VG9VcGRhdGUpIHtcbiAgICAgIGVuZHBvaW50ID0gJy9hcGkvdXBkYXRlZGV4aG9zdCdcbiAgICAgIHJlcSA9IHtcbiAgICAgICAgbmV3SG9zdDogYWRkcixcbiAgICAgICAgY2VydDogY2VydCxcbiAgICAgICAgb2xkSG9zdDogdGhpcy5kZXhUb1VwZGF0ZVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlbmRwb2ludCA9IHNraXBSZWdpc3RyYXRpb24gPyAnL2FwaS9hZGRkZXgnIDogJy9hcGkvZGlzY292ZXJhY2N0J1xuICAgICAgcmVxID0ge1xuICAgICAgICBhZGRyOiBhZGRyLFxuICAgICAgICBjZXJ0OiBjZXJ0XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oZW5kcG9pbnQsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBpZiAoU3RyaW5nKHJlcy5tc2cpLmluY2x1ZGVzKCdjZXJ0aWZpY2F0ZSByZXF1aXJlZCcpKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UubmVlZENlcnQpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYWdlLmVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgICAgRG9jLnNob3cocGFnZS5lcnIpXG4gICAgICB9XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICBpZiAoIXRoaXMuZGV4VG9VcGRhdGUgJiYgKHNraXBSZWdpc3RyYXRpb24gfHwgcmVzLnBhaWQgfHwgT2JqZWN0LmtleXMocmVzLnhjLmF1dGgucGVuZGluZ0JvbmRzKS5sZW5ndGggPiAwKSkge1xuICAgICAgYXdhaXQgYXBwKCkubG9hZFBhZ2UoJ21hcmtldHMnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuc3VjY2VzcyhyZXMueGMsIGNlcnQpXG4gIH1cbn1cblxuLyogRGlzY292ZXJBY2NvdW50Rm9ybSBwZXJmb3JtcyBhY2NvdW50IGRpc2NvdmVyeSBmb3IgYSBwcmUtc2VsZWN0ZWQgREVYLiAqL1xuZXhwb3J0IGNsYXNzIERpc2NvdmVyQWNjb3VudEZvcm0ge1xuICBmb3JtOiBIVE1MRWxlbWVudFxuICBhZGRyOiBzdHJpbmdcbiAgc3VjY2VzczogKHhjOiBFeGNoYW5nZSkgPT4gdm9pZFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cblxuICBjb25zdHJ1Y3RvciAoZm9ybTogSFRNTEVsZW1lbnQsIGFkZHI6IHN0cmluZywgc3VjY2VzczogKHhjOiBFeGNoYW5nZSkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLmFkZHIgPSBhZGRyXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGZvcm0pXG4gICAgcGFnZS5kZXhIb3N0LnRleHRDb250ZW50ID0gYWRkclxuICAgIGJpbmQoZm9ybSwgcGFnZS5zdWJtaXQsICgpID0+IHRoaXMuY2hlY2tERVgoKSlcbiAgfVxuXG4gIC8qIEp1c3QgYSBzbWFsbCBzaXplIHR3ZWFrIGFuZCBmYWRlLWluLiAqL1xuICBhc3luYyBhbmltYXRlICgpIHtcbiAgICBjb25zdCBmb3JtID0gdGhpcy5mb3JtXG4gICAgRG9jLmFuaW1hdGUoNTUwLCBwcm9nID0+IHtcbiAgICAgIGZvcm0uc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7MC45ICsgMC4xICogcHJvZ30pYFxuICAgICAgZm9ybS5zdHlsZS5vcGFjaXR5ID0gU3RyaW5nKE1hdGgucG93KHByb2csIDQpKVxuICAgIH0sICdlYXNlT3V0JylcbiAgfVxuXG4gIGFzeW5jIGNoZWNrREVYICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5lcnIpXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgYWRkcjogdGhpcy5hZGRyXG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5mb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2Rpc2NvdmVyYWNjdCcsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UuZXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmIChyZXMucGFpZCkge1xuICAgICAgYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICAgIGF3YWl0IGFwcCgpLmxvYWRQYWdlKCdtYXJrZXRzJylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnN1Y2Nlc3MocmVzLnhjKVxuICB9XG59XG5cbi8qIExvZ2luRm9ybSBpcyB1c2VkIHRvIHNpZ24gaW50byB0aGUgYXBwLiAqL1xuZXhwb3J0IGNsYXNzIExvZ2luRm9ybSB7XG4gIGZvcm06IEhUTUxFbGVtZW50XG4gIHN1Y2Nlc3M6ICgpID0+IHZvaWRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzdWNjZXNzOiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUoZm9ybSlcbiAgICBiaW5kKGZvcm0sIHBhZ2Uuc3VibWl0LCAoKSA9PiB7IHRoaXMuc3VibWl0KCkgfSlcbiAgICBhcHAoKS5yZWdpc3Rlck5vdGVGZWVkZXIoe1xuICAgICAgbG9naW46IChub3RlOiBDb3JlTm90ZSkgPT4geyB0aGlzLmhhbmRsZUxvZ2luTm90ZShub3RlKSB9XG4gICAgfSlcbiAgfVxuXG4gIGhhbmRsZUxvZ2luTm90ZSAobjogQ29yZU5vdGUpIHtcbiAgICBpZiAobi5kZXRhaWxzID09PSAnJykgcmV0dXJuXG4gICAgY29uc3QgbG9naW5Nc2cgPSBEb2MuaWRlbCh0aGlzLmZvcm0sICdsb2FkZXJNc2cnKVxuICAgIERvYy5zaG93KGxvZ2luTXNnKVxuICAgIGlmIChsb2dpbk1zZykgbG9naW5Nc2cudGV4dENvbnRlbnQgPSBuLmRldGFpbHNcbiAgfVxuXG4gIGZvY3VzICgpIHtcbiAgICB0aGlzLnBhZ2UucHcuZm9jdXMoKVxuICB9XG5cbiAgcmVmcmVzaCAoKSB7XG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLmVyck1zZylcbiAgICB0aGlzLnBhZ2UucHcudmFsdWUgPSAnJ1xuICB9XG5cbiAgYXN5bmMgc3VibWl0ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5lcnJNc2cpXG4gICAgY29uc3QgcHcgPSBwYWdlLnB3LnZhbHVlIHx8ICcnXG4gICAgaWYgKHB3ID09PSAnJykge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5lcnJNc2csIGludGwucHJlcChpbnRsLklEX05PX1BBU1NfRVJST1JfTVNHKSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9sb2dpbicsIHsgcGFzczogcHcgfSlcbiAgICBsb2FkZWQoKVxuICAgIHBhZ2UucHcudmFsdWUgPSAnJ1xuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmVyck1zZywgcmVzLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIHJlcy5ub3RlcyA9IHJlcy5ub3RlcyB8fCBbXVxuICAgIHJlcy5ub3Rlcy5yZXZlcnNlKClcbiAgICByZXMucG9rZXMgPSByZXMucG9rZXMgfHwgW11cbiAgICBhcHAoKS5sb2dnZWRJbihyZXMubm90ZXMsIHJlcy5wb2tlcylcbiAgICB0aGlzLnN1Y2Nlc3MoKVxuICB9XG5cbiAgLyogSnVzdCBhIHNtYWxsIHNpemUgdHdlYWsgYW5kIGZhZGUtaW4uICovXG4gIGFzeW5jIGFuaW1hdGUgKCkge1xuICAgIGNvbnN0IGZvcm0gPSB0aGlzLmZvcm1cbiAgICBEb2MuYW5pbWF0ZSg1NTAsIHByb2cgPT4ge1xuICAgICAgZm9ybS5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHswLjkgKyAwLjEgKiBwcm9nfSlgXG4gICAgICBmb3JtLnN0eWxlLm9wYWNpdHkgPSBTdHJpbmcoTWF0aC5wb3cocHJvZywgNCkpXG4gICAgfSwgJ2Vhc2VPdXQnKVxuICB9XG59XG5cbmNvbnN0IHRyYWl0TmV3QWRkcmVzc2VyID0gMSA8PCAxXG5cbi8qXG4gKiBEZXBvc2l0QWRkcmVzcyBkaXNwbGF5cyBhIGRlcG9zaXQgYWRkcmVzcywgYSBRUiBjb2RlLCBhbmQgYSBidXR0b24gdG9cbiAqIGdlbmVyYXRlIGEgbmV3IGFkZHJlc3MgKGlmIHN1cHBvcnRlZCkuXG4gKi9cbmV4cG9ydCBjbGFzcyBEZXBvc2l0QWRkcmVzcyB7XG4gIGZvcm06IFBhZ2VFbGVtZW50XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBhc3NldElEOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogUGFnZUVsZW1lbnQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGZvcm0pXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UudW5pZmllZFJlY2VpdmVyVG1wbClcbiAgICBEb2MuYmluZChwYWdlLm5ld0RlcEFkZHJCdHRuLCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMubmV3RGVwb3NpdEFkZHJlc3MoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuY29weUFkZHJlc3NCdG4sICdjbGljaycsICgpID0+IHsgdGhpcy5jb3B5QWRkcmVzcygpIH0pXG4gIH1cblxuICAvKiBEaXNwbGF5IGEgZGVwb3NpdCBhZGRyZXNzLiAqL1xuICBhc3luYyBzZXRBc3NldCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgdGhpcy5hc3NldElEID0gYXNzZXRJRFxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmRlcG9zaXRFcnIsIHBhZ2UuZGVwb3NpdFRva2VuTXNnQm94KVxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgcGFnZS5kZXBvc2l0TG9nby5zcmMgPSBEb2MubG9nb1BhdGgoYXNzZXQuc3ltYm9sKVxuICAgIGNvbnN0IHdhbGxldCA9IGFwcCgpLndhbGxldE1hcFthc3NldElEXVxuICAgIHBhZ2UuZGVwb3NpdE5hbWUudGV4dENvbnRlbnQgPSBhc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgIGlmIChhc3NldC50b2tlbikge1xuICAgICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXQudG9rZW4ucGFyZW50SURdXG4gICAgICBwYWdlLmRlcG9zaXRUb2tlblBhcmVudExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHBhcmVudEFzc2V0LnN5bWJvbClcbiAgICAgIHBhZ2UuZGVwb3NpdFRva2VuUGFyZW50TmFtZS50ZXh0Q29udGVudCA9IHBhcmVudEFzc2V0Lm5hbWVcbiAgICAgIERvYy5zaG93KHBhZ2UuZGVwb3NpdFRva2VuTXNnQm94KVxuICAgIH1cbiAgICBEb2Muc2V0VmlzKCh3YWxsZXQudHJhaXRzICYgdHJhaXROZXdBZGRyZXNzZXIpICE9PSAwLCBwYWdlLm5ld0RlcEFkZHJCdHRuQm94KVxuICAgIHRoaXMuc2V0QWRkcmVzcyh3YWxsZXQuYWRkcmVzcylcbiAgfVxuXG4gIHNldEFkZHJlc3MgKGFkZHI6IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnVuaWZpZWRSZWNlaXZlcnMpXG4gICAgaWYgKGFkZHIuc3RhcnRzV2l0aCgndW5pZmllZDonKSkge1xuICAgICAgY29uc3QgcmVjZWl2ZXJzID0gSlNPTi5wYXJzZShhZGRyLnN1YnN0cmluZygndW5pZmllZDonLmxlbmd0aCkpIGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgICAgIERvYy5lbXB0eShwYWdlLnVuaWZpZWRSZWNlaXZlcnMpXG4gICAgICBEb2Muc2hvdyhwYWdlLnVuaWZpZWRSZWNlaXZlcnMpXG4gICAgICBjb25zdCBkZWZhdWx0UmVjZWl2ZXJUeXBlID0gJ3VuaWZpZWQnXG4gICAgICBmb3IgKGNvbnN0IFtyZWN2VHlwZSwgcmVjdl0gb2YgT2JqZWN0LmVudHJpZXMocmVjZWl2ZXJzKSkge1xuICAgICAgICBjb25zdCBkaXYgPSBwYWdlLnVuaWZpZWRSZWNlaXZlclRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgIHBhZ2UudW5pZmllZFJlY2VpdmVycy5hcHBlbmRDaGlsZChkaXYpXG4gICAgICAgIGRpdi50ZXh0Q29udGVudCA9IHJlY3ZUeXBlXG4gICAgICAgIGRpdi5kYXRhc2V0LnR5cGUgPSByZWN2VHlwZVxuICAgICAgICBpZiAocmVjdlR5cGUgPT09IGRlZmF1bHRSZWNlaXZlclR5cGUpIGRpdi5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgICAgIC8vIHRtcGwuYWRkci50ZXh0Q29udGVudCA9IHJlY3ZcbiAgICAgICAgRG9jLmJpbmQoZGl2LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgZm9yIChjb25zdCBidHRuIG9mIChBcnJheS5mcm9tKHBhZ2UudW5pZmllZFJlY2VpdmVycy5jaGlsZHJlbikgYXMgUGFnZUVsZW1lbnRbXSkpIGJ0dG4uY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0ZWQnLCBidHRuLmRhdGFzZXQudHlwZSA9PT0gcmVjdlR5cGUpXG4gICAgICAgICAgdGhpcy5zZXRDZW50cmFsQWRkcmVzcyhyZWN2KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgYWRkciA9IHJlY2VpdmVycy51bmlmaWVkXG4gICAgfVxuXG4gICAgdGhpcy5zZXRDZW50cmFsQWRkcmVzcyhhZGRyKVxuICB9XG5cbiAgc2V0Q2VudHJhbEFkZHJlc3MgKGFkZHI6IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLmRlcG9zaXRBZGRyZXNzLnRleHRDb250ZW50ID0gYWRkclxuICAgIHBhZ2UucXJjb2RlLnNyYyA9IGAvZ2VuZXJhdGVxcmNvZGU/YWRkcmVzcz0ke2FkZHJ9YFxuICB9XG5cbiAgLyogRmV0Y2ggYSBuZXcgYWRkcmVzcyBmcm9tIHRoZSB3YWxsZXQuICovXG4gIGFzeW5jIG5ld0RlcG9zaXRBZGRyZXNzICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGFzc2V0SUQsIGZvcm0gfSA9IHRoaXNcbiAgICBEb2MuaGlkZShwYWdlLmRlcG9zaXRFcnIpXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhmb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2RlcG9zaXRhZGRyZXNzJywge1xuICAgICAgYXNzZXRJRDogYXNzZXRJRFxuICAgIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5kZXBvc2l0RXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5kZXBvc2l0RXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGFwcCgpLndhbGxldE1hcFthc3NldElEXS5hZGRyZXNzID0gcmVzLmFkZHJlc3NcbiAgICB0aGlzLnNldEFkZHJlc3MocmVzLmFkZHJlc3MpXG4gIH1cblxuICBhc3luYyBjb3B5QWRkcmVzcyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHBhZ2UuZGVwb3NpdEFkZHJlc3MudGV4dENvbnRlbnQgfHwgJycpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UuY29weUFsZXJ0KVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBEb2MuaGlkZShwYWdlLmNvcHlBbGVydClcbiAgICAgICAgfSwgODAwKVxuICAgICAgfSlcbiAgICAgIC5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuYWJsZSB0byBjb3B5OiAnLCByZWFzb24pXG4gICAgICB9KVxuICB9XG59XG5cbi8vIEFwcFBhc3NSZXNldEZvcm0gaXMgdXNlZCB0byByZXNldCB0aGUgYXBwIGFwc3N3b3JkIHVzaW5nIHRoZSBhcHAgc2VlZC5cbmV4cG9ydCBjbGFzcyBBcHBQYXNzUmVzZXRGb3JtIHtcbiAgZm9ybTogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIHN1Y2Nlc3M6ICgpID0+IHZvaWRcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogUGFnZUVsZW1lbnQsIHN1Y2Nlc3M6ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhmb3JtKVxuICAgIGJpbmQoZm9ybSwgcGFnZS5yZXNldEFwcFBXU3VibWl0QnRuLCAoKSA9PiB0aGlzLnJlc2V0QXBwUFcoKSlcbiAgfVxuXG4gIGFzeW5jIHJlc2V0QXBwUFcgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBuZXdBcHBQVyA9IHBhZ2UubmV3QXBwUGFzc3dvcmQudmFsdWUgfHwgJydcbiAgICBjb25zdCBjb25maXJtTmV3QXBwUFcgPSBwYWdlLmNvbmZpcm1OZXdBcHBQYXNzd29yZC52YWx1ZVxuICAgIGlmIChuZXdBcHBQVyA9PT0gJycpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuYXBwUFdSZXNldEVyck1zZywgaW50bC5wcmVwKGludGwuSURfTk9fUEFTU19FUlJPUl9NU0cpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmIChuZXdBcHBQVyAhPT0gY29uZmlybU5ld0FwcFBXKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmFwcFBXUmVzZXRFcnJNc2csIGludGwucHJlcChpbnRsLklEX1BBU1NXT1JEX05PVF9NQVRDSCkpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9yZXNldGFwcHBhc3N3b3JkJywge1xuICAgICAgbmV3UGFzczogbmV3QXBwUFcsXG4gICAgICBzZWVkOiBwYWdlLnNlZWRJbnB1dC52YWx1ZVxuICAgIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5hcHBQV1Jlc2V0RXJyTXNnLCByZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKERvYy5pc0Rpc3BsYXllZChwYWdlLmFwcFBXUmVzZXRFcnJNc2cpKSBEb2MuaGlkZShwYWdlLmFwcFBXUmVzZXRFcnJNc2cpXG4gICAgcGFnZS5hcHBQV1Jlc2V0U3VjY2Vzc01zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1BBU1NXT1JEX1JFU0VUX1NVQ0NFU1NfTVNHKVxuICAgIERvYy5zaG93KHBhZ2UuYXBwUFdSZXNldFN1Y2Nlc3NNc2cpXG4gICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnN1Y2Nlc3MoKSwgMzAwMCkgLy8gYWxsb3cgdGltZSB0byB2aWV3IHRoZSBtZXNzYWdlXG4gIH1cblxuICBmb2N1cyAoKSB7XG4gICAgdGhpcy5wYWdlLm5ld0FwcFBhc3N3b3JkLmZvY3VzKClcbiAgfVxuXG4gIHJlZnJlc2ggKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLm5ld0FwcFBhc3N3b3JkLnZhbHVlID0gJydcbiAgICBwYWdlLmNvbmZpcm1OZXdBcHBQYXNzd29yZC52YWx1ZSA9ICcnXG4gICAgcGFnZS5zZWVkSW5wdXQudmFsdWUgPSAnJ1xuICAgIERvYy5oaWRlKHBhZ2UuYXBwUFdSZXNldFN1Y2Nlc3NNc2csIHBhZ2UuYXBwUFdSZXNldEVyck1zZylcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ2VydGlmaWNhdGVQaWNrZXIge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cblxuICBjb25zdHJ1Y3RvciAocGFyZW50OiBQYWdlRWxlbWVudCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShwYXJlbnQpXG4gICAgcGFnZS5zZWxlY3RlZENlcnQudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9OT05FX1NFTEVDVEVEKVxuICAgIERvYy5iaW5kKHBhZ2UuY2VydEZpbGUsICdjaGFuZ2UnLCAoKSA9PiB0aGlzLm9uQ2VydEZpbGVDaGFuZ2UoKSlcbiAgICBEb2MuYmluZChwYWdlLnJlbW92ZUNlcnQsICdjbGljaycsICgpID0+IHRoaXMuY2xlYXJDZXJ0RmlsZSgpKVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkQ2VydCwgJ2NsaWNrJywgKCkgPT4gcGFnZS5jZXJ0RmlsZS5jbGljaygpKVxuICB9XG5cbiAgLyoqXG4gICAqIG9uQ2VydEZpbGVDaGFuZ2Ugd2hlbiB0aGUgaW5wdXQgY2VydEZpbGUgY2hhbmdlZCwgcmVhZCB0aGUgZmlsZVxuICAgKiBhbmQgc2V0dGluZyBjZXJ0IG5hbWUgaW50byB0ZXh0IG9mIHNlbGVjdGVkQ2VydCB0byBkaXNwbGF5IG9uIHRoZSB2aWV3XG4gICAqL1xuICBhc3luYyBvbkNlcnRGaWxlQ2hhbmdlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgZmlsZXMgPSBwYWdlLmNlcnRGaWxlLmZpbGVzXG4gICAgaWYgKCFmaWxlcyB8fCAhZmlsZXMubGVuZ3RoKSByZXR1cm5cbiAgICBwYWdlLnNlbGVjdGVkQ2VydC50ZXh0Q29udGVudCA9IGZpbGVzWzBdLm5hbWVcbiAgICBEb2Muc2hvdyhwYWdlLnJlbW92ZUNlcnQpXG4gICAgRG9jLmhpZGUocGFnZS5hZGRDZXJ0KVxuICB9XG5cbiAgLyogY2xlYXJDZXJ0RmlsZSBjbGVhbnVwIGNlcnRGaWxlIHZhbHVlIGFuZCBzZWxlY3RlZENlcnQgdGV4dCAqL1xuICBjbGVhckNlcnRGaWxlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5jZXJ0RmlsZS52YWx1ZSA9ICcnXG4gICAgcGFnZS5zZWxlY3RlZENlcnQudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9OT05FX1NFTEVDVEVEKVxuICAgIERvYy5oaWRlKHBhZ2UucmVtb3ZlQ2VydClcbiAgICBEb2Muc2hvdyhwYWdlLmFkZENlcnQpXG4gIH1cblxuICBhc3luYyBmaWxlICgpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBpZiAocGFnZS5jZXJ0RmlsZS52YWx1ZSkge1xuICAgICAgY29uc3QgZmlsZXMgPSBwYWdlLmNlcnRGaWxlLmZpbGVzXG4gICAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBmaWxlc1swXS50ZXh0KClcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuICcnXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRva2VuQXBwcm92YWxGb3JtIHtcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIHN1Y2Nlc3M/OiAoKSA9PiB2b2lkXG4gIGFzc2V0SUQ6IG51bWJlclxuICBwYXJlbnRJRDogbnVtYmVyXG4gIHR4RmVlOiBudW1iZXJcbiAgaG9zdDogc3RyaW5nXG5cbiAgY29uc3RydWN0b3IgKHBhcmVudDogUGFnZUVsZW1lbnQsIHN1Y2Nlc3M/OiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUocGFyZW50KVxuICAgIHRoaXMuc3VjY2VzcyA9IHN1Y2Nlc3NcbiAgICBEb2MuYmluZCh0aGlzLnBhZ2Uuc3VibWl0LCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuYXBwcm92ZSgpIH0pXG4gIH1cblxuICBhc3luYyBzZXRBc3NldCAoYXNzZXRJRDogbnVtYmVyLCBob3N0OiBzdHJpbmcpIHtcbiAgICB0aGlzLmFzc2V0SUQgPSBhc3NldElEXG4gICAgdGhpcy5ob3N0ID0gaG9zdFxuICAgIGNvbnN0IHRva2VuQXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICBjb25zdCBwYXJlbnRJRCA9IHRoaXMucGFyZW50SUQgPSB0b2tlbkFzc2V0LnRva2VuPy5wYXJlbnRJRCBhcyBudW1iZXJcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcblxuICAgIERvYy5zaG93KHBhZ2Uuc3VibWlzc2lvbkVsZW1lbnRzKVxuICAgIERvYy5oaWRlKHBhZ2UudHhNc2csIHBhZ2UuZXJyTXNnLCBwYWdlLmFkZHJlc3NCb3gsIHBhZ2UuYmFsYW5jZUJveCwgcGFnZS5hZGRyZXNzQm94KVxuXG4gICAgRG9jLmVtcHR5KHBhZ2UudG9rZW5TeW1ib2wpXG4gICAgcGFnZS50b2tlblN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKHRva2VuQXNzZXQsIHRydWUpKVxuICAgIGNvbnN0IHByb3RvY29sVmVyc2lvbiA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XS5hc3NldHNbYXNzZXRJRF0udmVyc2lvblxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2FwcHJvdmV0b2tlbmZlZScsIHtcbiAgICAgIGFzc2V0SUQ6IHRva2VuQXNzZXQuaWQsXG4gICAgICB2ZXJzaW9uOiBwcm90b2NvbFZlcnNpb24sXG4gICAgICBhcHByb3Zpbmc6IHRydWVcbiAgICB9KVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmVyck1zZy50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UuZXJyTXNnKVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB7IHVuaXRJbmZvOiB1aSwgd2FsbGV0OiB7IGFkZHJlc3MsIGJhbGFuY2U6IHsgYXZhaWxhYmxlOiBhdmFpbCB9IH0sIG5hbWU6IHBhcmVudE5hbWUgfSA9IGFwcCgpLmFzc2V0c1twYXJlbnRJRF1cbiAgICAgIGNvbnN0IHR4RmVlID0gdGhpcy50eEZlZSA9IHJlcy50eEZlZSBhcyBudW1iZXJcbiAgICAgIGxldCBmZWVUZXh0ID0gYCR7RG9jLmZvcm1hdENvaW5WYWx1ZSh0eEZlZSwgdWkpfSAke3VpLmNvbnZlbnRpb25hbC51bml0fWBcbiAgICAgIGNvbnN0IHJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbcGFyZW50SURdXG4gICAgICBpZiAocmF0ZSkge1xuICAgICAgICBmZWVUZXh0ICs9IGAgKCR7RG9jLmZvcm1hdEZpYXRDb252ZXJzaW9uKHR4RmVlLCByYXRlLCB1aSl9IFVTRClgXG4gICAgICB9XG4gICAgICBwYWdlLmZlZUVzdGltYXRlLnRleHRDb250ZW50ID0gZmVlVGV4dFxuICAgICAgRG9jLnNob3cocGFnZS5iYWxhbmNlQm94KVxuICAgICAgcGFnZS5iYWxhbmNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShhdmFpbCwgdWkpXG4gICAgICBwYWdlLnBhcmVudFRpY2tlci50ZXh0Q29udGVudCA9IHVpLmNvbnZlbnRpb25hbC51bml0XG4gICAgICBwYWdlLnBhcmVudE5hbWUudGV4dENvbnRlbnQgPSBwYXJlbnROYW1lXG4gICAgICBpZiAoYXZhaWwgPCB0eEZlZSkge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLmFkZHJlc3NCb3gpXG4gICAgICAgIHBhZ2UuYWRkcmVzcy50ZXh0Q29udGVudCA9IGFkZHJlc3NcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBhcHByb3ZlIGNhbGxzIHRoZSAvYXBpL2FwcHJvdmV0b2tlbiBlbmRwb2ludC5cbiAgICovXG4gIGFzeW5jIGFwcHJvdmUgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgYXNzZXRJRCwgaG9zdCwgc3VjY2VzcyB9ID0gdGhpc1xuICAgIGNvbnN0IHBhdGggPSAnL2FwaS9hcHByb3ZldG9rZW4nXG4gICAgY29uc3QgdG9rZW5Bc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHBhdGgsIHtcbiAgICAgIGFzc2V0SUQ6IHRva2VuQXNzZXQuaWQsXG4gICAgICBkZXhBZGRyOiBob3N0XG4gICAgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5lcnJNc2cudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLmVyck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwYWdlLnR4aWQuaW5uZXJUZXh0ID0gcmVzLnR4SURcbiAgICBjb25zdCBhc3NldEV4cGxvcmVyID0gQ29pbkV4cGxvcmVyc1t0b2tlbkFzc2V0LmlkXVxuICAgIGlmIChhc3NldEV4cGxvcmVyICYmIGFzc2V0RXhwbG9yZXJbYXBwKCkudXNlci5uZXRdKSB7XG4gICAgICBwYWdlLnR4aWQuaHJlZiA9IGFzc2V0RXhwbG9yZXJbYXBwKCkudXNlci5uZXRdKHJlcy50eElEKVxuICAgIH1cbiAgICBEb2MuaGlkZShwYWdlLnN1Ym1pc3Npb25FbGVtZW50cywgcGFnZS5iYWxhbmNlQm94LCBwYWdlLmFkZHJlc3NCb3gpXG4gICAgRG9jLnNob3cocGFnZS50eE1zZylcbiAgICBpZiAoc3VjY2Vzcykgc3VjY2VzcygpXG4gIH1cblxuICBoYW5kbGVCYWxhbmNlTm90ZSAobjogQmFsYW5jZU5vdGUpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHBhcmVudElELCB0eEZlZSB9ID0gdGhpc1xuICAgIGlmIChuLmFzc2V0SUQgIT09IHBhcmVudElEKSByZXR1cm5cbiAgICBwYWdlLmJhbGFuY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG4uYmFsYW5jZS5hdmFpbGFibGUsIGFwcCgpLmFzc2V0c1twYXJlbnRJRF0udW5pdEluZm8pXG4gICAgaWYgKG4uYmFsYW5jZS5hdmFpbGFibGUgPj0gdHhGZWUpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuYWRkcmVzc0JveClcbiAgICB9IGVsc2UgRG9jLmhpZGUocGFnZS5lcnJNc2cpXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIENFWENvbmZpZ3VyYXRpb25Gb3JtIHtcbiAgZm9ybTogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIHN1Y2Nlc3M6IChjZXhOYW1lOiBzdHJpbmcpID0+IHZvaWRcbiAgY2V4TmFtZTogc3RyaW5nXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IFBhZ2VFbGVtZW50LCBzdWNjZXNzOiAoY2V4TmFtZTogc3RyaW5nKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIHRoaXMuc3VjY2VzcyA9IHN1Y2Nlc3NcbiAgICB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShmb3JtKVxuXG4gICAgRG9jLmJpbmQodGhpcy5wYWdlLmNleFN1Ym1pdCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zdWJtaXQoKSlcbiAgfVxuXG4gIHNldENFWCAoY2V4TmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5jZXhOYW1lID0gY2V4TmFtZVxuICAgIHNldENleEVsZW1lbnRzKHRoaXMuZm9ybSwgY2V4TmFtZSlcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5jZXhDb25maWdQcm9tcHQsIHBhZ2UuY2V4Q29ubmVjdEVyckJveCwgcGFnZS5jZXhGb3JtRXJyKVxuICAgIHBhZ2UuY2V4QXBpS2V5SW5wdXQudmFsdWUgPSAnJ1xuICAgIHBhZ2UuY2V4U2VjcmV0SW5wdXQudmFsdWUgPSAnJ1xuICAgIGNvbnN0IGNleFN0YXR1cyA9IGFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWVdXG4gICAgY29uc3QgY29ubmVjdEVyciA9IGNleFN0YXR1cz8uY29ubmVjdEVyclxuICAgIGlmIChjb25uZWN0RXJyKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLmNleENvbm5lY3RFcnJCb3gpXG4gICAgICBwYWdlLmNleENvbm5lY3RFcnIudGV4dENvbnRlbnQgPSBjb25uZWN0RXJyXG4gICAgICBwYWdlLmNleEFwaUtleUlucHV0LnZhbHVlID0gY2V4U3RhdHVzLmNvbmZpZy5hcGlLZXlcbiAgICAgIHBhZ2UuY2V4U2VjcmV0SW5wdXQudmFsdWUgPSBjZXhTdGF0dXMuY29uZmlnLmFwaVNlY3JldFxuICAgIH0gZWxzZSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLmNleENvbmZpZ1Byb21wdClcbiAgICB9XG4gIH1cblxuICAvKlxuICAqIGhhbmRsZUNFWFN1Ym1pdCBoYW5kbGVzIGNsaWNrcyBvbiB0aGUgQ0VYIGNvbmZpZ3VyYXRpb24gc3VibWlzc2lvbiBidXR0b24uXG4gICovXG4gIGFzeW5jIHN1Ym1pdCAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBjZXhOYW1lLCBmb3JtIH0gPSB0aGlzXG4gICAgRG9jLmhpZGUocGFnZS5jZXhGb3JtRXJyKVxuICAgIGNvbnN0IGFwaUtleSA9IHBhZ2UuY2V4QXBpS2V5SW5wdXQudmFsdWVcbiAgICBjb25zdCBhcGlTZWNyZXQgPSBwYWdlLmNleFNlY3JldElucHV0LnZhbHVlXG4gICAgaWYgKCFhcGlLZXkgfHwgIWFwaVNlY3JldCkge1xuICAgICAgRG9jLnNob3cocGFnZS5jZXhGb3JtRXJyKVxuICAgICAgcGFnZS5jZXhGb3JtRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fUEFTU19FUlJPUl9NU0cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhmb3JtKVxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBNTS51cGRhdGVDRVhDb25maWcoe1xuICAgICAgICBuYW1lOiBjZXhOYW1lLFxuICAgICAgICBhcGlLZXk6IGFwaUtleSxcbiAgICAgICAgYXBpU2VjcmV0OiBhcGlTZWNyZXRcbiAgICAgIH0pXG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkgdGhyb3cgcmVzXG4gICAgICBhd2FpdCBhcHAoKS5mZXRjaE1NU3RhdHVzKClcbiAgICAgIHRoaXMuc3VjY2VzcyhjZXhOYW1lKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuY2V4Rm9ybUVycilcbiAgICAgIHBhZ2UuY2V4Rm9ybUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FQSV9FUlJPUiwgeyBtc2c6IGUubXNnID8/IFN0cmluZyhlKSB9KVxuICAgICAgcmV0dXJuXG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGxvYWRlZCgpXG4gICAgfVxuICB9XG59XG5cbmNvbnN0IGFuaW1hdGlvbkxlbmd0aCA9IDMwMFxuXG4vKiBTd2FwIGZvcm0xIGZvciBmb3JtMiB3aXRoIGFuIGFuaW1hdGlvbi4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzbGlkZVN3YXAgKGZvcm0xOiBIVE1MRWxlbWVudCwgZm9ybTI6IEhUTUxFbGVtZW50KSB7XG4gIGNvbnN0IHNoaWZ0ID0gZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCAvIDJcbiAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pbWF0aW9uTGVuZ3RoLCBwcm9ncmVzcyA9PiB7XG4gICAgZm9ybTEuc3R5bGUucmlnaHQgPSBgJHtwcm9ncmVzcyAqIHNoaWZ0fXB4YFxuICB9LCAnZWFzZUluSGFyZCcpXG4gIERvYy5oaWRlKGZvcm0xKVxuICBmb3JtMS5zdHlsZS5yaWdodCA9ICcwJ1xuICBmb3JtMi5zdHlsZS5yaWdodCA9IFN0cmluZygtc2hpZnQpXG4gIERvYy5zaG93KGZvcm0yKVxuICBpZiAoZm9ybTIucXVlcnlTZWxlY3RvcignaW5wdXQnKSkge1xuICAgIERvYy5zYWZlU2VsZWN0b3IoZm9ybTIsICdpbnB1dCcpLmZvY3VzKClcbiAgfVxuICBhd2FpdCBEb2MuYW5pbWF0ZShhbmltYXRpb25MZW5ndGgsIHByb2dyZXNzID0+IHtcbiAgICBmb3JtMi5zdHlsZS5yaWdodCA9IGAkey1zaGlmdCArIHByb2dyZXNzICogc2hpZnR9cHhgXG4gIH0sICdlYXNlT3V0SGFyZCcpXG4gIGZvcm0yLnN0eWxlLnJpZ2h0ID0gJzAnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG93U3VjY2VzcyAocGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+LCBtc2c6IHN0cmluZykge1xuICBwYWdlLnN1Y2Nlc3NNZXNzYWdlLnRleHRDb250ZW50ID0gbXNnXG4gIERvYy5zaG93KHBhZ2UuZm9ybXMsIHBhZ2UuY2hlY2ttYXJrRm9ybSlcbiAgcGFnZS5jaGVja21hcmtGb3JtLnN0eWxlLnJpZ2h0ID0gJzAnXG4gIHBhZ2UuY2hlY2ttYXJrLnN0eWxlLmZvbnRTaXplID0gJzBweCdcblxuICBjb25zdCBbc3RhcnRSLCBzdGFydEcsIHN0YXJ0Ql0gPSBTdGF0ZS5pc0RhcmsoKSA/IFsyMjMsIDIyNiwgMjI1XSA6IFs1MSwgNTEsIDUxXVxuICBjb25zdCBbZW5kUiwgZW5kRywgZW5kQl0gPSBbMTYsIDE2MywgMTZdXG4gIGNvbnN0IFtkaWZmUiwgZGlmZkcsIGRpZmZCXSA9IFtlbmRSIC0gc3RhcnRSLCBlbmRHIC0gc3RhcnRHLCBlbmRCIC0gc3RhcnRCXVxuXG4gIHJldHVybiBuZXcgQW5pbWF0aW9uKDEyMDAsIChwcm9nOiBudW1iZXIpID0+IHtcbiAgICBwYWdlLmNoZWNrbWFyay5zdHlsZS5mb250U2l6ZSA9IGAke3Byb2cgKiA4MH1weGBcbiAgICBwYWdlLmNoZWNrbWFyay5zdHlsZS5jb2xvciA9IGByZ2IoJHtzdGFydFIgKyBwcm9nICogZGlmZlJ9LCAke3N0YXJ0RyArIHByb2cgKiBkaWZmR30sICR7c3RhcnRCICsgcHJvZyAqIGRpZmZCfSlgXG4gIH0sICdlYXNlT3V0RWxhc3RpYycpXG59XG5cbi8qXG4gKiBiaW5kIGJpbmRzIHRoZSBjbGljayBhbmQgc3VibWl0IGV2ZW50cyBhbmQgcHJldmVudHMgcGFnZSByZWxvYWRpbmcgb25cbiAqIHN1Ym1pc3Npb24uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBiaW5kIChmb3JtOiBIVE1MRWxlbWVudCwgc3VibWl0QnR0bjogSFRNTEVsZW1lbnQsIGhhbmRsZXI6IChlOiBFdmVudCkgPT4gdm9pZCkge1xuICBjb25zdCB3cmFwcGVyID0gKGU6IEV2ZW50KSA9PiB7XG4gICAgaWYgKGUucHJldmVudERlZmF1bHQpIGUucHJldmVudERlZmF1bHQoKVxuICAgIGhhbmRsZXIoZSlcbiAgfVxuICBEb2MuYmluZChzdWJtaXRCdHRuLCAnY2xpY2snLCB3cmFwcGVyKVxuICBEb2MuYmluZChmb3JtLCAnc3VibWl0Jywgd3JhcHBlcilcbn1cblxuLy8gaXNUcnV0aHlTdHJpbmcgd2lsbCBiZSB0cnVlIGlmIHRoZSBwcm92aWRlZCBzdHJpbmcgaXMgcmVjb2duaXplZCBhcyBhXG4vLyB2YWx1ZSByZXByZXNlbnRpbmcgdHJ1ZS5cbmZ1bmN0aW9uIGlzVHJ1dGh5U3RyaW5nIChzOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHMgPT09ICcxJyB8fCBzLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJ1xufVxuXG4vLyB0b1VuaXhEYXRlIGNvbnZlcnRzIGEgamF2YXNjcmlwdCBkYXRlIG9iamVjdCB0byBhIHVuaXggZGF0ZSwgd2hpY2ggaXNcbi8vIHRoZSBudW1iZXIgb2YgKnNlY29uZHMqIHNpbmNlIHRoZSBzdGFydCBvZiB0aGUgZXBvY2guXG5mdW5jdGlvbiB0b1VuaXhEYXRlIChkYXRlOiBEYXRlKSB7XG4gIHJldHVybiBNYXRoLmZsb29yKGRhdGUuZ2V0VGltZSgpIC8gMTAwMClcbn1cblxuLy8gZGF0ZUFwcGx5T2Zmc2V0IHNoaWZ0cyBhIGRhdGUgYnkgdGhlIHRpbWV6b25lIG9mZnNldC4gVGhpcyBpcyB1c2VkIHRvIG1ha2Vcbi8vIFVUQyBkYXRlcyBzaG93IHRoZSBsb2NhbCBkYXRlLiBUaGlzIGNhbiBiZSB1c2VkIHRvIHByZXBhcmUgYSBEYXRlIHNvXG4vLyB0b0lTT1N0cmluZyBnZW5lcmF0ZXMgYSBsb2NhbCBkYXRlIHN0cmluZy4gVGhpcyBpcyBhbHNvIHVzZWQgdG8gdHJpY2sgYW4gaHRtbFxuLy8gaW5wdXQgZWxlbWVudCB0byBzaG93IHRoZSBsb2NhbCBkYXRlIHdoZW4gc2V0dGluZyB0aGUgdmFsdWVBc0RhdGUgZmllbGQuIFdoZW5cbi8vIHJlYWRpbmcgdGhlIGRhdGUgYmFjayB0byBKUywgdGhlIHZhbHVlIGZpZWxkIHNob3VsZCBiZSBpbnRlcnByZXRlZCBhcyBsb2NhbFxuLy8gdXNpbmcgdGhlIFwiVDAwOjAwXCIgc3VmZml4LCBvciB0aGUgRGF0ZSBpbiB2YWx1ZUFzRGF0ZSBzaG91bGQgYmUgc2hpZnRlZCBpblxuLy8gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbi5cbmZ1bmN0aW9uIGRhdGVBcHBseU9mZnNldCAoZGF0ZTogRGF0ZSkge1xuICByZXR1cm4gbmV3IERhdGUoZGF0ZS5nZXRUaW1lKCkgLSBkYXRlLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MCAqIDEwMDApXG59XG5cbi8vIGRhdGVUb1N0cmluZyBjb252ZXJ0cyBhIGphdmFzY3JpcHQgZGF0ZSBvYmplY3QgdG8gYSBZWVlZLU1NLUREIGZvcm1hdCBzdHJpbmcsXG4vLyBpbiB0aGUgbG9jYWwgdGltZSB6b25lLlxuZnVuY3Rpb24gZGF0ZVRvU3RyaW5nIChkYXRlOiBEYXRlKSB7XG4gIHJldHVybiBkYXRlQXBwbHlPZmZzZXQoZGF0ZSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG4gIC8vIEFub3RoZXIgY29tbW9uIGhhY2s6XG4gIC8vIGRhdGUudG9Mb2NhbGVTdHJpbmcoXCJzdi1TRVwiLCB7IHllYXI6IFwibnVtZXJpY1wiLCBtb250aDogXCIyLWRpZ2l0XCIsIGRheTogXCIyLWRpZ2l0XCIgfSlcbn1cbiIsIi8qXG4gKiByZXF1ZXN0SlNPTiBlbmNvZGVzIHRoZSBvYmplY3QgYW5kIHNlbmRzIHRoZSBKU09OIHRvIHRoZSBzcGVjaWZpZWQgYWRkcmVzcy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RKU09OIChtZXRob2Q6IHN0cmluZywgYWRkcjogc3RyaW5nLCByZXFCb2R5PzogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHdpbmRvdy5mZXRjaChhZGRyLCB7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIGhlYWRlcnM6IG5ldyB3aW5kb3cuSGVhZGVycyh7ICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSksXG4gICAgICAvLyBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiLFxuICAgICAgYm9keTogcmVxQm9keVxuICAgIH0pXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7IHRocm93IHJlc3BvbnNlIH1cbiAgICBjb25zdCBvYmogPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICBvYmoucmVxdWVzdFN1Y2Nlc3NmdWwgPSB0cnVlXG4gICAgcmV0dXJuIG9ialxuICB9IGNhdGNoIChyZXNwb25zZSkge1xuICAgIHJlc3BvbnNlLnJlcXVlc3RTdWNjZXNzZnVsID0gZmFsc2VcbiAgICByZXNwb25zZS5tc2cgPSBhd2FpdCByZXNwb25zZS50ZXh0KClcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxufVxuXG4vKlxuICogcG9zdEpTT04gc2VuZHMgYSBQT1NUIHJlcXVlc3Qgd2l0aCBKU09OLWZvcm1hdHRlZCBkYXRhIGFuZCByZXR1cm5zIHRoZVxuICogcmVzcG9uc2UuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwb3N0SlNPTiAoYWRkcjogc3RyaW5nLCBkYXRhPzogYW55KSB7XG4gIHJldHVybiByZXF1ZXN0SlNPTignUE9TVCcsIGFkZHIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxufVxuXG4vKlxuICogZ2V0SlNPTiBzZW5kcyBhIEdFVCByZXF1ZXN0IGFuZCByZXR1cm5zIHRoZSByZXNwb25zZS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEpTT04gKGFkZHI6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gIHJldHVybiByZXF1ZXN0SlNPTignR0VUJywgYWRkcilcbn1cblxuZXhwb3J0IGVudW0gRXJyb3JzIHtcbiAgd2FsbGV0RXJyLFxuICB3YWxsZXRBdXRoRXJyLFxuICB3YWxsZXRCYWxhbmNlRXJyLFxuICBkdXBlREVYRXJyLFxuICBhc3NldFN1cHBvcnRFcnIsXG4gIHJlZ2lzdGVyRXJyLFxuICBzaWduYXR1cmVFcnIsXG4gIHplcm9GZWVFcnIsXG4gIGZlZU1pc21hdGNoRXJyLFxuICBmZWVTZW5kRXJyLFxuICBwYXNzd29yZEVycixcbiAgZW1wdHlIb3N0RXJyLFxuICBjb25uZWN0aW9uRXJyLFxuICBhY2N0S2V5RXJyLFxuICB1bmtub3duT3JkZXJFcnIsXG4gIG9yZGVyUGFyYW1zRXJyLFxuICBkYkVycixcbiAgYXV0aEVycixcbiAgY29ubmVjdFdhbGxldEVycixcbiAgbWlzc2luZ1dhbGxldEVycixcbiAgZW5jcnlwdGlvbkVycixcbiAgZGVjb2RlRXJyLFxuICBhY2NvdW50VmVyaWZpY2F0aW9uRXJyLFxuICBhY2NvdW50UHJvb2ZFcnIsXG4gIHBhcnNlS2V5RXJyLFxuICBtYXJrZXRFcnIsXG4gIGFkZHJlc3NQYXJzZUVycixcbiAgYWRkckVycixcbiAgZmlsZVJlYWRFcnIsXG4gIHVua25vd25ERVhFcnIsXG4gIGFjY291bnRSZXRyaWV2ZUVycixcbiAgYWNjb3VudERpc2FibGVFcnIsXG4gIHN1c3BlbmRlZEFjY3RFcnIsXG4gIGV4aXN0ZW5jZUNoZWNrRXJyLFxuICBjcmVhdGVXYWxsZXRFcnIsXG4gIGFjdGl2ZU9yZGVyc0VycixcbiAgbmV3QWRkckVycixcbn1cbiIsImltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQge1xuICBiaW5kIGFzIGJpbmRGb3JtLFxuICBzbGlkZVN3YXBcbn0gZnJvbSAnLi9mb3JtcydcbmltcG9ydCB7IFdhdmUgfSBmcm9tICcuL2NoYXJ0cydcbmltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnQsXG4gIFN1cHBvcnRlZEFzc2V0LFxuICBVc2VyLFxuICBXYWxsZXRJbmZvLFxuICBXYWxsZXREZWZpbml0aW9uLFxuICBDb25maWdPcHRpb24sXG4gIEFQSVJlc3BvbnNlXG59IGZyb20gJy4vcmVnaXN0cnknXG5cbmludGVyZmFjZSBJbml0UmVzcG9uc2UgZXh0ZW5kcyBBUElSZXNwb25zZSB7XG4gIGhvc3RzOiBzdHJpbmdbXVxuICBtbmVtb25pYz86IHN0cmluZ1xufVxuXG4vKlxuICogSW5pdFBhZ2UgaXMgdGhlIHBhZ2UgaGFuZGxlciBmb3IgdGhlIC9pbml0IHZpZXcuIEluaXRQYWdlIGlzIGVzc2VudGlhbGx5IGFcbiAqIGZvcm0gaGFuZGxlci4gVGhlcmUgYXJlIG5vIG5vbi1mb3JtIGVsZW1lbnRzIG9uIC9pbml0LiBJbml0UGFnZSBhZGRpdGlvbmFsbHlcbiAqIGhhcyBhIHJvbGUgY2FjaGluZyB0aGUgaW5pdGlhbGl6YXRpb24gcGFzc3dvcmQuIEEgY291cGxlIG9mIG5vdGVzIGFib3V0XG4gKiBJbml0UGFnZS5cbiAqICAgMSkgVGhlcmUgaXMgbm8gZ29pbmcgYmFja3dhcmRzLiBPbmNlIHlvdSBzZXQgYSBwYXNzd29yZCwgeW91IGNhbid0IGdvIGJhY2tcbiAqICAgICAgdG8gdGhlIHBhc3N3b3JkIGZvcm0uIElmIHlvdSByZWZyZXNoLCB5b3Ugd29uJ3QgZW5kIHVwIG9uIC9pbml0LCBzb1xuICogICAgICB3b24ndCBoYXZlIGFjY2VzcyB0byB0aGUgUXVpY2tDb25maWdGb3JtIG9yIFNlZWRCYWNrdXBGb3JtIC4gT25jZSB5b3VcbiAqICAgICAgc3VibWl0IHlvdXIgYXV0by1jb25maWcgY2hvaWNlcywgeW91IGNhbid0IGNoYW5nZSB0aGVtLiBUaGlzIGhhc1xuICogICAgICBpbXBsaWNhdGlvbnMgZm9yIGNvZGluZyBhbmQgVUkuIFRoZXJlIGFyZSBubyBcImdvIGJhY2tcIiBvciBcImNsb3NlIGZvcm1cIlxuICogICAgICBlbGVtZW50cy5cbiAqICAgMikgVGhlIHVzZXIgY2FuIHByZWNsdWRlIGF1dG8tY29uZmlnIGFuZCBzZWVkIGJhY2t1cCBieSBjbGlja2luZyBhblxuICogICAgICBhdmFpbGFibGUgaGVhZGVyIGxpbmsgYWZ0ZXIgcGFzc3dvcmQgaW5pdCwgZS5nLiBXYWxsZXRzLCBpbiB0aGUgcGFnZVxuICogICAgICBoZWFkZXIuIE5PVEU6IFJlZ2FyZGxlc3Mgb2Ygd2hhdCB0aGUgdXNlciBkb2VzIGFmdGVyIHNldHRpbmcgdGhlIGFwcFxuICogICAgICBwYXNzLCB0aGV5IHdpbGwgcmVjZWl2ZSBhIG5vdGlmaWNhdGlvbiByZW1pbmRpbmcgdGhlbSB0byBiYWNrIHVwIHRoZWlyXG4gKiAgICAgIHNlZWQuIFBlcmhhcHMgaXQgd291bGQgYmUgYmV0dGVyIHRvIHNvbWVob3cgZGVsYXkgdGhhdCBtZXNzYWdlIHVudGlsXG4gKiAgICAgIHRoZXkgY2hvb3NlIHRvIGlnbm9yZSB0aGUgc2VlZCBiYWNrdXAgZGlhbG9nLCBidXQgaGF2aW5nIG1vcmUgcmVtaW5kZXJzXG4gKiAgICAgIGlzIGFsc28gb2theS5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5pdFBhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIGJvZHk6IEhUTUxFbGVtZW50XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBpbml0Rm9ybTogQXBwSW5pdEZvcm1cbiAgcXVpY2tDb25maWdGb3JtOiBRdWlja0NvbmZpZ0Zvcm1cbiAgc2VlZEJhY2t1cEZvcm06IFNlZWRCYWNrdXBGb3JtXG4gIG1uZW1vbmljPzogc3RyaW5nXG5cbiAgY29uc3RydWN0b3IgKGJvZHk6IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMuYm9keSA9IGJvZHlcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoYm9keSlcbiAgICB0aGlzLmluaXRGb3JtID0gbmV3IEFwcEluaXRGb3JtKHBhZ2UuYXBwUFdGb3JtLCAocHc6IHN0cmluZywgaG9zdHM6IHN0cmluZ1tdLCBtbmVtb25pYz86IHN0cmluZykgPT4geyB0aGlzLmFwcEluaXRlZChwdywgaG9zdHMsIG1uZW1vbmljKSB9KVxuICAgIHRoaXMucXVpY2tDb25maWdGb3JtID0gbmV3IFF1aWNrQ29uZmlnRm9ybShwYWdlLnF1aWNrQ29uZmlnRm9ybSwgKCkgPT4gdGhpcy5xdWlja0NvbmZpZ0RvbmUoKSlcbiAgICB0aGlzLnNlZWRCYWNrdXBGb3JtID0gbmV3IFNlZWRCYWNrdXBGb3JtKHBhZ2Uuc2VlZEJhY2t1cEZvcm0sICgpID0+IHRoaXMuc2VlZEJhY2tlZFVwKCkpXG4gIH1cblxuICBhc3luYyBhcHBJbml0ZWQgKHB3OiBzdHJpbmcsIGhvc3RzOiBzdHJpbmdbXSwgbW5lbW9uaWM/OiBzdHJpbmcpIHtcbiAgICB0aGlzLm1uZW1vbmljID0gbW5lbW9uaWNcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgYXdhaXQgdGhpcy5xdWlja0NvbmZpZ0Zvcm0udXBkYXRlKHB3LCBob3N0cylcbiAgICBpZiAobW5lbW9uaWMpIHRoaXMuc2VlZEJhY2t1cEZvcm0udXBkYXRlKG1uZW1vbmljKVxuICAgIHNsaWRlU3dhcChwYWdlLmFwcFBXRm9ybSwgcGFnZS5xdWlja0NvbmZpZ0Zvcm0pXG4gIH1cblxuICBxdWlja0NvbmZpZ0RvbmUgKCkge1xuICAgIGlmICghdGhpcy5tbmVtb25pYykgYXBwKCkubG9hZFBhZ2UoJ3dhbGxldHMnKVxuICAgIGVsc2Ugc2xpZGVTd2FwKHRoaXMucGFnZS5xdWlja0NvbmZpZ0Zvcm0sIHRoaXMucGFnZS5zZWVkQmFja3VwRm9ybSlcbiAgfVxuXG4gIHNlZWRCYWNrZWRVcCAoKSB7XG4gICAgYXBwKCkubG9hZFBhZ2UoJ3dhbGxldHMnKVxuICB9XG59XG5cbi8qXG4gKiBUaGUgQXBwSW5pdEZvcm0gaGFuZGxlcyB0aGUgZm9ybSB0aGF0IHNldHMgdGhlIGFwcCBwYXNzd29yZCwgYWNjZXB0cyBhblxuICogb3B0aW9uYWwgc2VlZCwgYW5kIGluaXRpYWxpemVzIHRoZSBhcHAuXG4gKi9cbmNsYXNzIEFwcEluaXRGb3JtIHtcbiAgZm9ybTogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIHN1Y2Nlc3M6IChwdzogc3RyaW5nLCBob3N0czogc3RyaW5nW10sIG1uZW1vbmljPzogc3RyaW5nKSA9PiB2b2lkXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IFBhZ2VFbGVtZW50LCBzdWNjZXNzOiAocHc6IHN0cmluZywgaG9zdHM6IHN0cmluZ1tdLCBtbmVtb25pYz86IHN0cmluZykgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGZvcm0pXG4gICAgYmluZEZvcm0oZm9ybSwgcGFnZS5hcHBQV1N1Ym1pdCwgKCkgPT4gdGhpcy5zZXRBcHBQYXNzKCkpXG4gICAgYmluZEZvcm0oZm9ybSwgcGFnZS50b2dnbGVTZWVkSW5wdXQsICgpID0+IHtcbiAgICAgIGlmIChEb2MuaXNIaWRkZW4ocGFnZS5zZWVkSW5wdXRCb3gpKSB7XG4gICAgICAgIHBhZ2UudG9nZ2xlU2VlZElucHV0SWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdpY28tcGx1cycpXG4gICAgICAgIHBhZ2UudG9nZ2xlU2VlZElucHV0SWNvbi5jbGFzc0xpc3QuYWRkKCdpY28tbWludXMnKVxuICAgICAgICBEb2Muc2hvdyhwYWdlLnNlZWRJbnB1dEJveClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhZ2UudG9nZ2xlU2VlZElucHV0SWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdpY28tbWludXMnKVxuICAgICAgICBwYWdlLnRvZ2dsZVNlZWRJbnB1dEljb24uY2xhc3NMaXN0LmFkZCgnaWNvLXBsdXMnKVxuICAgICAgICBEb2MuaGlkZShwYWdlLnNlZWRJbnB1dEJveClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLyogU2V0IHRoZSBhcHBsaWNhdGlvbiBwYXNzd29yZC4gQXR0YWNoZWQgdG8gZm9ybSBzdWJtaXNzaW9uLiAqL1xuICBhc3luYyBzZXRBcHBQYXNzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5hcHBQV0Vyck1zZylcbiAgICBjb25zdCBwdyA9IHBhZ2UuYXBwUFcudmFsdWUgfHwgJydcbiAgICBjb25zdCBwd0FnYWluID0gcGFnZS5hcHBQV0FnYWluLnZhbHVlXG4gICAgaWYgKHB3ID09PSAnJykge1xuICAgICAgcGFnZS5hcHBQV0Vyck1zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX1BBU1NfRVJST1JfTVNHKVxuICAgICAgRG9jLnNob3cocGFnZS5hcHBQV0Vyck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAocHcgIT09IHB3QWdhaW4pIHtcbiAgICAgIHBhZ2UuYXBwUFdFcnJNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9QQVNTV09SRF9OT1RfTUFUQ0gpXG4gICAgICBEb2Muc2hvdyhwYWdlLmFwcFBXRXJyTXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgcGFnZS5hcHBQVy52YWx1ZSA9ICcnXG4gICAgcGFnZS5hcHBQV0FnYWluLnZhbHVlID0gJydcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuZm9ybSlcbiAgICAvLyBjb25zdCBzZWVkID0gcGFnZS5zZWVkSW5wdXQudmFsdWU/LnJlcGxhY2UoL1xccysvZywgJycpIC8vIHN0cmlwIHdoaXRlc3BhY2VcbiAgICBjb25zdCBzZWVkID0gcGFnZS5zZWVkSW5wdXQudmFsdWUgPz8gJydcbiAgICBjb25zdCByZXM6IEluaXRSZXNwb25zZSA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2luaXQnLCB7XG4gICAgICBwYXNzOiBwdyxcbiAgICAgIHNlZWQ6IHNlZWRcbiAgICB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UuYXBwUFdFcnJNc2cudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLmFwcFBXRXJyTXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuc3VjY2VzcyhwdywgcmVzLmhvc3RzLCByZXMubW5lbW9uaWMpXG4gIH1cbn1cblxuLy8gSG9zdENvbmZpZ1JvdyBpcyB1c2VkIGJ5IHRoZSBRdWlja0NvbmZpZ0Zvcm0gdG8gdHJhY2sgdGhlIHVzZXIncyBjaG9pY2VzLlxuaW50ZXJmYWNlIEhvc3RDb25maWdSb3cge1xuICBob3N0OiBzdHJpbmdcbiAgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnRcbn1cblxuLy8gV2FsbGV0Q29uZmlnUm93IGlzIHVzZWQgYnkgdGhlIFF1aWNrQ29uZmlnRm9ybSB0byB0cmFjayB0aGUgdXNlcidzIGNob2ljZXMuXG5pbnRlcmZhY2UgV2FsbGV0Q29uZmlnUm93IHtcbiAgYXNzZXQ6IFN1cHBvcnRlZEFzc2V0XG4gIHR5cGU6IHN0cmluZ1xuICBjaGVja2JveDogSFRNTElucHV0RWxlbWVudFxufVxuXG5sZXQgcm93SURDb3VudGVyID0gMFxuXG4vKlxuICogUXVpY2tDb25maWdGb3JtIGhhbmRsZXMgdGhlIGZvcm0gdGhhdCBhbGxvd3MgdXNlcnMgdG8gcXVpY2tseSBjb25maWd1cmVcbiAqIHZpZXctb25seSBzZXJ2ZXJzIGFuZCBuYXRpdmUgd2FsbGV0cyAodGhhdCBkb24ndCByZXF1aXJlIGFueSBjb25maWd1cmF0aW9uKS5cbiAqL1xuY2xhc3MgUXVpY2tDb25maWdGb3JtIHtcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGZvcm06IFBhZ2VFbGVtZW50XG4gIHNlcnZlcnM6IEhvc3RDb25maWdSb3dbXVxuICB3YWxsZXRzOiBXYWxsZXRDb25maWdSb3dbXVxuICBwdzogc3RyaW5nXG4gIHN1Y2Nlc3M6ICgpID0+IHZvaWRcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogUGFnZUVsZW1lbnQsIHN1Y2Nlc3M6ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhmb3JtKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhwYWdlLnFjU2VydmVyVG1wbCwgcGFnZS5xY1dhbGxldFRtcGwpXG4gICAgYmluZEZvcm0oZm9ybSwgcGFnZS5xdWlja0NvbmZpZ1N1Ym1pdCwgKCkgPT4geyB0aGlzLnN1Ym1pdCgpIH0pXG4gICAgYmluZEZvcm0oZm9ybSwgcGFnZS5xY0VyckFjaywgKCkgPT4geyB0aGlzLnN1Y2Nlc3MoKSB9KVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlIChwdzogc3RyaW5nLCBob3N0czogc3RyaW5nW10pIHtcbiAgICB0aGlzLnB3ID0gcHdcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG5cbiAgICB0aGlzLnNlcnZlcnMgPSBbXVxuICAgIGZvciAoY29uc3QgaG9zdCBvZiBob3N0cykge1xuICAgICAgY29uc3Qgcm93ID0gcGFnZS5xY1NlcnZlclRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLnFjU2VydmVyc0JveC5hcHBlbmRDaGlsZChyb3cpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgcm93SURDb3VudGVyKytcbiAgICAgIGNvbnN0IHJvd0lEID0gYHFjc3JvdyR7cm93SURDb3VudGVyfWBcbiAgICAgIHJvdy5odG1sRm9yID0gcm93SURcbiAgICAgIHRtcGwuY2hlY2tib3guaWQgPSByb3dJRFxuICAgICAgdG1wbC5ob3N0LnRleHRDb250ZW50ID0gaG9zdFxuICAgICAgdGhpcy5zZXJ2ZXJzLnB1c2goeyBob3N0LCBjaGVja2JveDogdG1wbC5jaGVja2JveCBhcyBIVE1MSW5wdXRFbGVtZW50IH0pXG4gICAgfVxuXG4gICAgY29uc3QgdSA9IGF3YWl0IGFwcCgpLmZldGNoVXNlcigpIGFzIFVzZXJcbiAgICB0aGlzLndhbGxldHMgPSBbXVxuICAgIGZvciAoY29uc3QgYSBvZiBPYmplY3QudmFsdWVzKHUuYXNzZXRzKSkge1xuICAgICAgaWYgKGEudG9rZW4pIGNvbnRpbnVlXG4gICAgICBjb25zdCB3aW5mbyA9IGEuaW5mbyBhcyBXYWxsZXRJbmZvXG4gICAgICBsZXQgYXV0b0NvbmZpZ3VyYWJsZTogV2FsbGV0RGVmaW5pdGlvbiB8IG51bGwgPSBudWxsXG4gICAgICBmb3IgKGNvbnN0IHdEZWYgb2Ygd2luZm8uYXZhaWxhYmxld2FsbGV0cykge1xuICAgICAgICBpZiAoIXdEZWYuc2VlZGVkKSBjb250aW51ZVxuICAgICAgICBpZiAod0RlZi5jb25maWdvcHRzICYmIHdEZWYuY29uZmlnb3B0cy5zb21lKChvcHQ6IENvbmZpZ09wdGlvbikgPT4gb3B0LnJlcXVpcmVkKSkgY29udGludWVcbiAgICAgICAgYXV0b0NvbmZpZ3VyYWJsZSA9IHdEZWZcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGlmICghYXV0b0NvbmZpZ3VyYWJsZSkgY29udGludWVcbiAgICAgIGNvbnN0IHJvdyA9IHBhZ2UucWNXYWxsZXRUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgcGFnZS5xY1dhbGxldHNCb3guYXBwZW5kQ2hpbGQocm93KVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIHJvd0lEQ291bnRlcisrXG4gICAgICBjb25zdCByb3dJRCA9IGBxY3dyb3cke3Jvd0lEQ291bnRlcn1gXG4gICAgICByb3cuaHRtbEZvciA9IHJvd0lEXG4gICAgICB0bXBsLmNoZWNrYm94LmlkID0gcm93SURcbiAgICAgIHRtcGwuaWNvbi5zcmMgPSBEb2MubG9nb1BhdGgoYS5zeW1ib2wpXG4gICAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBhLm5hbWVcbiAgICAgIHRoaXMud2FsbGV0cy5wdXNoKHtcbiAgICAgICAgYXNzZXQ6IGEsXG4gICAgICAgIHR5cGU6IGF1dG9Db25maWd1cmFibGUudHlwZSxcbiAgICAgICAgY2hlY2tib3g6IHRtcGwuY2hlY2tib3ggYXMgSFRNTElucHV0RWxlbWVudFxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBhc3luYyBzdWJtaXQgKCkge1xuICAgIGNvbnN0IFtmYWlsZWRIb3N0cywgZmFpbGVkV2FsbGV0c106IFtzdHJpbmdbXSwgc3RyaW5nW11dID0gW1tdLCBbXV1cbiAgICBjb25zdCBhbmkgPSBuZXcgV2F2ZSh0aGlzLmZvcm0sIHsgYmFja2dyb3VuZENvbG9yOiB0cnVlLCBtZXNzYWdlOiAnLi4uJyB9KVxuICAgIGFuaS5vcHRzLm1lc3NhZ2UgPSBpbnRsLnByZXAoaW50bC5JRF9BRERJTkdfU0VSVkVSUylcbiAgICBjb25zdCBjb25uZWN0U2VydmVyID0gYXN5bmMgKHNydlJvdzogSG9zdENvbmZpZ1JvdykgPT4ge1xuICAgICAgaWYgKCFzcnZSb3cuY2hlY2tib3guY2hlY2tlZCkgcmV0dXJuXG4gICAgICBjb25zdCByZXEgPSB7XG4gICAgICAgIGFkZHI6IHNydlJvdy5ob3N0LFxuICAgICAgICBhcHBQVzogdGhpcy5wd1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvYWRkZGV4JywgcmVxKSAvLyBEUkFGVCBOT1RFOiBpZ25vcmUgZXJyb3JzIG9rP1xuICAgICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIGZhaWxlZEhvc3RzLnB1c2goc3J2Um93Lmhvc3QpXG4gICAgfVxuICAgIGF3YWl0IFByb21pc2UuYWxsKHRoaXMuc2VydmVycy5tYXAoY29ubmVjdFNlcnZlcikpXG5cbiAgICBhbmkub3B0cy5tZXNzYWdlID0gaW50bC5wcmVwKGludGwuSURfQ1JFQVRJTkdfV0FMTEVUUylcbiAgICBjb25zdCBjcmVhdGVXYWxsZXQgPSBhc3luYyAod2FsbGV0Um93OiBXYWxsZXRDb25maWdSb3cpID0+IHtcbiAgICAgIGNvbnN0IHsgYXNzZXQ6IGEsIHR5cGUsIGNoZWNrYm94IH0gPSB3YWxsZXRSb3dcbiAgICAgIGlmICghY2hlY2tib3guY2hlY2tlZCkgcmV0dXJuXG4gICAgICBjb25zdCBjb25maWc6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuICAgICAgY29uc3Qgd2FsbGV0RGVmID0gYXBwKCkud2FsbGV0RGVmaW5pdGlvbihhLmlkLCB0eXBlKVxuICAgICAgZm9yIChjb25zdCBvcHQgb2YgKHdhbGxldERlZi5jb25maWdvcHRzID8/IFtdKSkge1xuICAgICAgICBpZiAoIW9wdC5kZWZhdWx0KSBjb250aW51ZVxuICAgICAgICBpZiAob3B0LmlzYm9vbGVhbikge1xuICAgICAgICAgIGNvbmZpZ1tvcHQua2V5XSA9IG9wdC5kZWZhdWx0ID8gJzEnIDogJzAnXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0LnJlcGVhdGFibGUgJiYgY29uZmlnW29wdC5rZXldKSBjb25maWdbb3B0LmtleV0gKz0gb3B0LnJlcGVhdGFibGUgKyBvcHQuZGVmYXVsdFxuICAgICAgICBlbHNlIGNvbmZpZ1tvcHQua2V5XSA9IFN0cmluZyhvcHQuZGVmYXVsdClcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNyZWF0ZUZvcm0gPSB7XG4gICAgICAgIGFzc2V0SUQ6IGEuaWQsXG4gICAgICAgIGFwcFBhc3M6IHRoaXMucHcsXG4gICAgICAgIGNvbmZpZzogY29uZmlnLFxuICAgICAgICB3YWxsZXRUeXBlOiB0eXBlXG4gICAgICB9XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9uZXd3YWxsZXQnLCBjcmVhdGVGb3JtKVxuICAgICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIGZhaWxlZFdhbGxldHMucHVzaChhLm5hbWUpXG4gICAgfVxuICAgIGF3YWl0IFByb21pc2UuYWxsKHRoaXMud2FsbGV0cy5tYXAoY3JlYXRlV2FsbGV0KSlcblxuICAgIGFuaS5zdG9wKClcbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKSAvLyBDYWxscyB1cGRhdGVNZW51SXRlbXNEaXNwbGF5IGludGVybmFsbHlcbiAgICBpZiAoZmFpbGVkV2FsbGV0cy5sZW5ndGggKyBmYWlsZWRIb3N0cy5sZW5ndGggPT09IDApIHJldHVybiB0aGlzLnN1Y2Nlc3MoKVxuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UucWNDaG9pY2VzKVxuICAgIERvYy5zaG93KHBhZ2UucWNFcnJvcnMpXG5cbiAgICBpZiAoZmFpbGVkSG9zdHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGNvbnN0IGhvc3Qgb2YgZmFpbGVkSG9zdHMpIHtcbiAgICAgICAgcGFnZS5xY1NlcnZlckVycm9yTGlzdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShob3N0KSlcbiAgICAgICAgcGFnZS5xY1NlcnZlckVycm9yTGlzdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKVxuICAgICAgfVxuICAgIH0gZWxzZSBEb2MuaGlkZShwYWdlLnFjU2VydmVyRXJyb3JzKVxuXG4gICAgaWYgKGZhaWxlZFdhbGxldHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgZmFpbGVkV2FsbGV0cykge1xuICAgICAgICBwYWdlLnFjV2FsbGV0RXJyb3JMaXN0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG5hbWUpKVxuICAgICAgICBwYWdlLnFjV2FsbGV0RXJyb3JMaXN0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpXG4gICAgICB9XG4gICAgfSBlbHNlIERvYy5oaWRlKHBhZ2UucWNXYWxsZXRFcnJvcnMpXG4gIH1cbn1cblxuLypcbiAqIFNlZWRCYWNrdXBGb3JtIGhhbmRsZXMgdGhlIGZvcm0gdGhhdCBhbGxvd3MgdGhlIHVzZXIgdG8gYmFjayB1cCB0aGVpciBzZWVkXG4gKiBkdXJpbmcgaW5pdGlhbGl6YXRpb24uXG4gKi9cbmNsYXNzIFNlZWRCYWNrdXBGb3JtIHtcbiAgZm9ybTogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIG1uZW1vbmljOiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogUGFnZUVsZW1lbnQsIHN1Y2Nlc3M6ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGZvcm0pXG4gICAgYmluZEZvcm0oZm9ybSwgcGFnZS5zZWVkQWNrLCAoKSA9PiBzdWNjZXNzKCkpXG4gICAgYmluZEZvcm0oZm9ybSwgcGFnZS5zaG93U2VlZCwgKCkgPT4gdGhpcy5zaG93U2VlZCgpKVxuICB9XG5cbiAgdXBkYXRlIChtbmVtb25pYzogc3RyaW5nKSB7XG4gICAgdGhpcy5tbmVtb25pYyA9IG1uZW1vbmljXG4gIH1cblxuICBzaG93U2VlZCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UubW5lbW9uaWMudGV4dENvbnRlbnQgPSB0aGlzLm1uZW1vbmljIC8vIGAke3dvcmRzLnNsaWNlKDAsIDUpLmpvaW4oJyAnKX1cXG4ke3dvcmRzLnNsaWNlKDUsIDEwKS5qb2luKCcgJyl9XFxuJHt3b3Jkcy5zbGljZSgxMCwxNSkuam9pbignICcpfWBcbiAgICBEb2MuaGlkZShwYWdlLnNiV2FubmEpXG4gICAgRG9jLnNob3cocGFnZS5zYlNlZWQpXG4gIH1cbn1cbiIsImltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0IHsgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5cbnR5cGUgTG9jYWxlID0gUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuXG5leHBvcnQgY29uc3QgSURfTk9fUEFTU19FUlJPUl9NU0cgPSAnTk9fUEFTU19FUlJPUl9NU0cnXG5leHBvcnQgY29uc3QgSURfTk9fQVBQX1BBU1NfRVJST1JfTVNHID0gJ05PX0FQUF9QQVNTX0VSUk9SX01TRydcbmV4cG9ydCBjb25zdCBJRF9TRVRfQlVUVE9OX0JVWSA9ICdTRVRfQlVUVE9OX0JVWSdcbmV4cG9ydCBjb25zdCBJRF9TRVRfQlVUVE9OX1NFTEwgPSAnU0VUX0JVVFRPTl9TRUxMJ1xuZXhwb3J0IGNvbnN0IElEX09GRiA9ICdPRkYnXG5leHBvcnQgY29uc3QgSURfTUFYID0gJ01BWCdcbmV4cG9ydCBjb25zdCBJRF9SRUFEWSA9ICdSRUFEWSdcbmV4cG9ydCBjb25zdCBJRF9OT19XQUxMRVQgPSAnTk9fV0FMTEVUJ1xuZXhwb3J0IGNvbnN0IElEX0RJU0FCTEVEX01TRyA9ICdESVNBQkxFRF9NU0cnXG5leHBvcnQgY29uc3QgSURfV0FMTEVUX1NZTkNfUFJPR1JFU1MgPSAnV0FMTEVUX1NZTkNfUFJPR1JFU1MnXG5leHBvcnQgY29uc3QgSURfSElERV9BRERJVElPTkFMX1NFVFRJTkdTID0gJ0hJREVfQURESVRJT05BTF9TRVRUSU5HUydcbmV4cG9ydCBjb25zdCBJRF9TSE9XX0FERElUSU9OQUxfU0VUVElOR1MgPSAnU0hPV19BRERJVElPTkFMX1NFVFRJTkdTJ1xuZXhwb3J0IGNvbnN0IElEX0JVWSA9ICdCVVknXG5leHBvcnQgY29uc3QgSURfU0VMTCA9ICdTRUxMJ1xuZXhwb3J0IGNvbnN0IElEX05PVF9TVVBQT1JURUQgPSAnTk9UX1NVUFBPUlRFRCdcbmV4cG9ydCBjb25zdCBJRF9WRVJTSU9OX05PVF9TVVBQT1JURUQgPSAnVkVSU0lPTl9OT1RfU1VQUE9SVEVEJ1xuZXhwb3J0IGNvbnN0IElEX0NPTk5FQ1RJT05fRkFJTEVEID0gJ0NPTk5FQ1RJT05fRkFJTEVEJ1xuZXhwb3J0IGNvbnN0IElEX09SREVSX1BSRVZJRVcgPSAnT1JERVJfUFJFVklFVydcbmV4cG9ydCBjb25zdCBJRF9DQUxDVUxBVElORyA9ICdDQUxDVUxBVElORydcbmV4cG9ydCBjb25zdCBJRF9FU1RJTUFURV9VTkFWQUlMQUJMRSA9ICdFU1RJTUFURV9VTkFWQUlMQUJMRSdcbmV4cG9ydCBjb25zdCBJRF9OT19aRVJPX1JBVEUgPSAnTk9fWkVST19SQVRFJ1xuZXhwb3J0IGNvbnN0IElEX05PX1pFUk9fUVVBTlRJVFkgPSAnTk9fWkVST19RVUFOVElUWSdcbmV4cG9ydCBjb25zdCBJRF9UUkFERSA9ICdUUkFERSdcbmV4cG9ydCBjb25zdCBJRF9OT19BU1NFVF9XQUxMRVQgPSAnTk9fQVNTRVRfV0FMTEVUJ1xuZXhwb3J0IGNvbnN0IElEX0VYRUNVVEVEID0gJ0VYRUNVVEVEJ1xuZXhwb3J0IGNvbnN0IElEX0JPT0tFRCA9ICdCT09LRUQnXG5leHBvcnQgY29uc3QgSURfQ0FOQ0VMSU5HID0gJ0NBTkNFTElORydcbmV4cG9ydCBjb25zdCBJRF9QQVNTV09SRF9OT1RfTUFUQ0ggPSAnUEFTU1dPUkRfTk9UX01BVENIJ1xuZXhwb3J0IGNvbnN0IElEX0FDQ1RfVU5ERUZJTkVEID0gJ0FDQ1RfVU5ERUZJTkVEJ1xuZXhwb3J0IGNvbnN0IElEX0tFRVBfV0FMTEVUX1BBU1MgPSAnS0VFUF9XQUxMRVRfUEFTUydcbmV4cG9ydCBjb25zdCBJRF9ORVdfV0FMTEVUX1BBU1MgPSAnTkVXX1dBTExFVF9QQVNTJ1xuZXhwb3J0IGNvbnN0IElEX0xPVCA9ICdMT1QnXG5leHBvcnQgY29uc3QgSURfTE9UUyA9ICdMT1RTJ1xuZXhwb3J0IGNvbnN0IElEX1VOS05PV04gPSAnVU5LTk9XTidcbmV4cG9ydCBjb25zdCBJRF9FUE9DSCA9ICdFUE9DSCdcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9TVUJNSVRUSU5HID0gJ09SREVSX1NVQk1JVFRJTkcnXG5leHBvcnQgY29uc3QgSURfU0VUVExJTkcgPSAnU0VUVExJTkcnXG5leHBvcnQgY29uc3QgSURfTk9fTUFUQ0ggPSAnTk9fTUFUQ0gnXG5leHBvcnQgY29uc3QgSURfQ0FOQ0VMRUQgPSAnQ0FOQ0VMRUQnXG5leHBvcnQgY29uc3QgSURfUkVWT0tFRCA9ICdSRVZPS0VEJ1xuZXhwb3J0IGNvbnN0IElEX1dBSVRJTkdfRk9SX0NPTkZTID0gJ1dBSVRJTkdfRk9SX0NPTkZTJ1xuZXhwb3J0IGNvbnN0IElEX05PTkVfU0VMRUNURUQgPSAnTk9ORV9TRUxFQ1RFRCdcbmV4cG9ydCBjb25zdCBJRF9SRUdJU1RSQVRJT05fRkVFX1NVQ0NFU1MgPSAnUkVHSVNUUkFUSU9OX0ZFRV9TVUNDRVNTJ1xuZXhwb3J0IGNvbnN0IElEX0FQSV9FUlJPUiA9ICdBUElfRVJST1InXG5leHBvcnQgY29uc3QgSURfQUREID0gJ0FERCdcbmV4cG9ydCBjb25zdCBJRF9DUkVBVEUgPSAnQ1JFQVRFJ1xuZXhwb3J0IGNvbnN0IElEX1NFVFVQX1dBTExFVCA9ICdTRVRVUF9XQUxMRVQnXG5leHBvcnQgY29uc3QgSURfV0FMTEVUX1JFQURZID0gJ1dBTExFVF9SRUFEWSdcbmV4cG9ydCBjb25zdCBJRF9DSEFOR0VfV0FMTEVUX1RZUEUgPSAnQ0hBTkdFX1dBTExFVF9UWVBFJ1xuZXhwb3J0IGNvbnN0IElEX0tFRVBfV0FMTEVUX1RZUEUgPSAnS0VFUF9XQUxMRVRfVFlQRSdcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfUEVORElORyA9ICdXQUxMRVRfUEVORElORydcbmV4cG9ydCBjb25zdCBJRF9TRVRVUF9ORUVERUQgPSAnU0VUVVBfTkVFREVEJ1xuZXhwb3J0IGNvbnN0IElEX1NFTkRfU1VDQ0VTUyA9ICdTRU5EX1NVQ0NFU1MnXG5leHBvcnQgY29uc3QgSURfUkVDT05GSUdfU1VDQ0VTUyA9ICdSRUNPTkZJR19TVUNDRVNTJ1xuZXhwb3J0IGNvbnN0IElEX1JFU0NBTl9TVEFSVEVEID0gJ1JFU0NBTl9TVEFSVEVEJ1xuZXhwb3J0IGNvbnN0IElEX05FV19XQUxMRVRfU1VDQ0VTUyA9ICdORVdfV0FMTEVUX1NVQ0NFU1MnXG5leHBvcnQgY29uc3QgSURfV0FMTEVUX1VOTE9DS0VEID0gJ1dBTExFVF9VTkxPQ0tFRCdcbmV4cG9ydCBjb25zdCBJRF9TRUxMSU5HID0gJ1NFTExJTkcnXG5leHBvcnQgY29uc3QgSURfQlVZSU5HID0gJ0JVWUlORydcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfRElTQUJMRURfTVNHID0gJ1dBTExFVF9ESVNBQkxFRCdcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfRU5BQkxFRF9NU0cgPSAnV0FMTEVUX0VOQUJMRUQnXG5leHBvcnQgY29uc3QgSURfQUNUSVZFX09SREVSU19FUlJfTVNHID0gJ0FDVElWRV9PUkRFUlNfRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9BVkFJTEFCTEUgPSAnQVZBSUxBQkxFJ1xuZXhwb3J0IGNvbnN0IElEX0xPQ0tFRCA9ICdMT0NLRUQnXG5leHBvcnQgY29uc3QgSURfSU1NQVRVUkUgPSAnSU1NQVRVUkUnXG5leHBvcnQgY29uc3QgSURfRkVFX0JBTEFOQ0UgPSAnRkVFX0JBTEFOQ0UnXG5leHBvcnQgY29uc3QgSURfQ0FORExFU19MT0FESU5HID0gJ0NBTkRMRVNfTE9BRElORydcbmV4cG9ydCBjb25zdCBJRF9ERVBUSF9MT0FESU5HID0gJ0RFUFRIX0xPQURJTkcnXG5leHBvcnQgY29uc3QgSURfSU5WQUxJRF9BRERSRVNTX01TRyA9ICdJTlZBTElEX0FERFJFU1NfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1RYRkVFX1VOU1VQUE9SVEVEID0gJ1RYRkVFX1VOU1VQUE9SVEVEJ1xuZXhwb3J0IGNvbnN0IElEX1RYRkVFX0VSUl9NU0cgPSAnVFhGRUVfRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9BQ1RJVkVfT1JERVJTX0xPR09VVF9FUlJfTVNHID0gJ0FDVElWRV9PUkRFUlNfTE9HT1VUX0VSUl9NU0cnXG5leHBvcnQgY29uc3QgSURfSU5WQUxJRF9EQVRFX0VSUl9NU0cgPSAnSU5WQUxJRF9EQVRFX0VSUl9NU0cnXG5leHBvcnQgY29uc3QgSURfTk9fQVJDSElWRURfUkVDT1JEUyA9ICdOT19BUkNISVZFRF9SRUNPUkRTJ1xuZXhwb3J0IGNvbnN0IElEX0RFTEVURV9BUkNISVZFRF9SRUNPUkRTX1JFU1VMVCA9ICdERUxFVEVfQVJDSElWRURfUkVDT1JEU19SRVNVTFQnXG5leHBvcnQgY29uc3QgSURfQVJDSElWRURfUkVDT1JEU19QQVRIID0gJ0FSQ0hJVkVEX1JFQ09SRFNfUEFUSCdcbmV4cG9ydCBjb25zdCBJRF9ERUZBVUxUID0gJ0RFRkFVTFQnXG5leHBvcnQgY29uc3QgSURfQURERUQgPSAnQURERUQnXG5leHBvcnQgY29uc3QgSURfRElTQ09WRVJFRCA9ICdESVNDT1ZFUkVEJ1xuZXhwb3J0IGNvbnN0IElEX1VOU1VQUE9SVEVEX0FTU0VUX0lORk9fRVJSX01TRyA9ICdVTlNVUFBPUlRFRF9BU1NFVF9JTkZPX0VSUl9NU0cnXG5leHBvcnQgY29uc3QgSURfTElNSVRfT1JERVIgPSAnTElNSVRfT1JERVInXG5leHBvcnQgY29uc3QgSURfTElNSVRfT1JERVJfSU1NRURJQVRFX1RJRiA9ICdMSU1JVF9PUkRFUl9JTU1FRElBVEVfVElGJ1xuZXhwb3J0IGNvbnN0IElEX01BUktFVF9PUkRFUiA9ICdNQVJLRVRfT1JERVInXG5leHBvcnQgY29uc3QgSURfQ0FOQ0VMX09SREVSID0gJ0NBTkNFTF9PUkRFUidcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfTkVXTFlfTUFUQ0hFRCA9ICdNQVRDSF9TVEFUVVNfTkVXTFlfTUFUQ0hFRCdcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfTUFLRVJfU1dBUF9DQVNUID0gJ01BVENIX1NUQVRVU19NQUtFUl9TV0FQX0NBU1QnXG5leHBvcnQgY29uc3QgSURfTUFUQ0hfU1RBVFVTX1RBS0VSX1NXQVBfQ0FTVCA9ICdNQVRDSF9TVEFUVVNfVEFLRVJfU1dBUF9DQVNUJ1xuZXhwb3J0IGNvbnN0IElEX01BVENIX1NUQVRVU19NQUtFUl9SRURFRU1FRCA9ICdNQVRDSF9TVEFUVVNfTUFLRVJfUkVERUVNRUQnXG5leHBvcnQgY29uc3QgSURfTUFUQ0hfU1RBVFVTX1JFREVNUFRJT05fU0VOVCA9ICdNQVRDSF9TVEFUVVNfUkVERU1QVElPTl9TRU5UJ1xuZXhwb3J0IGNvbnN0IElEX01BVENIX1NUQVRVU19SRURFTVBUSU9OX0NPTkZJUk1FRCA9ICdNQVRDSF9SRURFTVBUSU9OX0NPTkZJUk1FRCdcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfUkVWT0tFRCA9ICdNQVRDSF9TVEFUVVNfUkVWT0tFRCdcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfUkVGVU5ERUQgPSAnTUFUQ0hfU1RBVFVTX1JFRlVOREVEJ1xuZXhwb3J0IGNvbnN0IElEX01BVENIX1NUQVRVU19SRUZVTkRfUEVORElORyA9ICdNQVRDSF9TVEFUVVNfUkVGVU5EX1BFTkRJTkcnXG5leHBvcnQgY29uc3QgSURfTUFUQ0hfU1RBVFVTX1JFREVFTV9QRU5ESU5HID0gJ01BVENIX1NUQVRVU19SRURFRU1fUEVORElORydcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfQ09NUExFVEUgPSAnTUFUQ0hfU1RBVFVTX0NPTVBMRVRFJ1xuZXhwb3J0IGNvbnN0IElEX1RBS0VSX0ZPVU5EX01BS0VSX1JFREVNUFRJT04gPSAnVEFLRVJfRk9VTkRfTUFLRVJfUkVERU1QVElPTidcbmV4cG9ydCBjb25zdCBJRF9PUEVOX1dBTExFVF9FUlJfTVNHID0gJ09QRU5fV0FMTEVUX0VSUl9NU0cnXG5leHBvcnQgY29uc3QgSURfT1JERVJfQUNDRUxFUkFUSU9OX0ZFRV9FUlJfTVNHID0gJ09SREVSX0FDQ0VMRVJBVElPTl9GRUVfRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9BQ0NFTEVSQVRJT05fRVJSX01TRyA9ICdPUkRFUl9BQ0NFTEVSQVRJT05fRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9DT05ORUNURUQgPSAnQ09OTkVDVEVEJ1xuZXhwb3J0IGNvbnN0IElEX0RJU0NPTk5FQ1RFRCA9ICdESVNDT05ORUNURUQnXG5leHBvcnQgY29uc3QgSURfSU5WQUxJRF9DRVJUSUZJQ0FURSA9ICdJTlZBTElEX0NFUlRJRklDQVRFJ1xuZXhwb3J0IGNvbnN0IElEX0NPTkZJUk1BVElPTlMgPSAnQ09ORklSTUFUSU9OUydcbmV4cG9ydCBjb25zdCBJRF9UQUtFUiA9ICdUQUtFUidcbmV4cG9ydCBjb25zdCBJRF9NQUtFUiA9ICdNQUtFUidcbmV4cG9ydCBjb25zdCBJRF9FTVBUWV9ERVhfQUREUkVTU19NU0cgPSAnRU1QVFlfREVYX0FERFJFU1NfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1NFTEVDVF9XQUxMRVRfRk9SX0ZFRV9QQVlNRU5UID0gJ1NFTEVDVF9XQUxMRVRfRk9SX0ZFRV9QQVlNRU5UJ1xuZXhwb3J0IGNvbnN0IElEX1VOQVZBSUxBQkxFID0gJ1VOQVZBSUxBQkxFJ1xuZXhwb3J0IGNvbnN0IElEX1dBTExFVF9TWU5DX0ZJTklTSElOR19VUCA9ICdXQUxMRVRfU1lOQ19GSU5JU0hJTkdfVVAnXG5leHBvcnQgY29uc3QgSURfQ09OTkVDVF9XQUxMRVRfRVJSX01TRyA9ICdDT05ORUNUSU5HX1dBTExFVF9FUlJfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1JFRlVORF9JTU1JTkVOVCA9ICdSRUZVTkRfSU1NSU5FTlQnXG5leHBvcnQgY29uc3QgSURfUkVGVU5EX1dJTExfSEFQUEVOX0FGVEVSID0gJ1JFRlVORF9XSUxMX0hBUFBFTl9BRlRFUidcbmV4cG9ydCBjb25zdCBJRF9BVkFJTEFCTEVfVElUTEUgPSAnQVZBSUxBQkxFX1RJVExFJ1xuZXhwb3J0IGNvbnN0IElEX0xPQ0tFRF9USVRMRSA9ICdMT0NLRURfVElUTEUnXG5leHBvcnQgY29uc3QgSURfSU1NQVRVUkVfVElUTEUgPSAnSU1NQVRVUkVfVElUTEUnXG5leHBvcnQgY29uc3QgSURfU1dBUFBJTkcgPSAnU1dBUFBJTkcnXG5leHBvcnQgY29uc3QgSURfQk9OREVEID0gJ0JPTkRFRCdcbmV4cG9ydCBjb25zdCBJRF9MT0NLRURfQkFMX01TRyA9ICdMT0NLRURfQkFMX01TRydcbmV4cG9ydCBjb25zdCBJRF9JTU1BVFVSRV9CQUxfTVNHID0gJ0lNTUFUVVJFX0JBTF9NU0cnXG5leHBvcnQgY29uc3QgSURfTE9DS0VEX1NXQVBQSU5HX0JBTF9NU0cgPSAnTE9DS0VEX1NXQVBQSU5HX0JBTF9NU0cnXG5leHBvcnQgY29uc3QgSURfTE9DS0VEX0JPTkRfQkFMX01TRyA9ICdMT0NLRURfQk9ORF9CQUxfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1JFU0VSVkVTX0RFRklDSVQgPSAnUkVTRVJWRVNfREVGSUNJVCdcbmV4cG9ydCBjb25zdCBJRF9SRVNFUlZFU19ERUZJQ0lUX01TRyA9ICdSRVNFUlZFU19ERUZJQ0lUX01TRydcbmV4cG9ydCBjb25zdCBJRF9CT05EX1JFU0VSVkVTID0gJ0JPTkRfUkVTRVJWRVMnXG5leHBvcnQgY29uc3QgSURfQk9ORF9SRVNFUlZFU19NU0cgPSAnQk9ORF9SRVNFUlZFU19NU0cnXG5leHBvcnQgY29uc3QgSURfU0hJRUxERUQgPSAnU0hJRUxERUQnXG5leHBvcnQgY29uc3QgSURfVFJBTlNQQVJFTlQgPSAnVFJBTlNQQVJFTlQnXG5leHBvcnQgY29uc3QgSURfU0hJRUxERURfTVNHID0gJ1NISUVMREVEX01TRydcbmV4cG9ydCBjb25zdCBJRF9PUkRFUiA9ICdPUkRFUidcbmV4cG9ydCBjb25zdCBJRF9MT0NLRURfT1JERVJfQkFMX01TRyA9ICdMT0NLRURfT1JERVJfQkFMX01TRydcbmV4cG9ydCBjb25zdCBJRF9DUkVBVElOR19XQUxMRVRTID0gJ0NSRUFUSU5HX1dBTExFVFMnXG5leHBvcnQgY29uc3QgSURfQURESU5HX1NFUlZFUlMgPSAnQURESU5HX1NFUlZFUidcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfUkVDT1ZFUllfU1VQUE9SVF9NU0cgPSAnV0FMTEVUX1JFQ09WRVJZX1NVUFBPUlRfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1RJQ0tFVFNfUFVSQ0hBU0VEID0gJ1RJQ0tFVFNfUFVSQ0hBU0VEJ1xuZXhwb3J0IGNvbnN0IElEX1RJQ0tFVF9TVEFUVVNfVU5LTk9XTiA9ICdUSUNLRVRfU1RBVFVTX1VOS05PV04nXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19VTk1JTkVEID0gJ1RJQ0tFVF9TVEFUVVNfVU5NSU5FRCdcbmV4cG9ydCBjb25zdCBJRF9USUNLRVRfU1RBVFVTX0lNTUFUVVJFID0gJ1RJQ0tFVF9TVEFUVVNfSU1NQVRVUkUnXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19MSVZFID0gJ1RJQ0tFVF9TVEFUVVNfTElWRSdcbmV4cG9ydCBjb25zdCBJRF9USUNLRVRfU1RBVFVTX1ZPVEVEID0gJ1RJQ0tFVF9TVEFUVVNfVk9URUQnXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19NSVNTRUQgPSAnVElDS0VUX1NUQVRVU19NSVNTRUQnXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19FWFBJUkVEID0gJ1RJQ0tFVF9TVEFUVVNfRVhQSVJFRCdcbmV4cG9ydCBjb25zdCBJRF9USUNLRVRfU1RBVFVTX1VOU1BFTlQgPSAnVElDS0VUX1NUQVRVU19VTlNQRU5UJ1xuZXhwb3J0IGNvbnN0IElEX1RJQ0tFVF9TVEFUVVNfUkVWT0tFRCA9ICdUSUNLRVRfU1RBVFVTX1JFVk9LRUQnXG5leHBvcnQgY29uc3QgSURfUEFTU1dPUkRfUkVTRVRfU1VDQ0VTU19NU0cgPSAnUEFTU1dPUkRfUkVTRVRfU1VDQ0VTU19NU0cnXG5leHBvcnQgY29uc3QgSURfQlJPV1NFUl9OVEZOX0VOQUJMRUQgPSAnQlJPV1NFUl9OVEZOX0VOQUJMRUQnXG5leHBvcnQgY29uc3QgSURfQlJPV1NFUl9OVEZOX09SREVSUyA9ICdCUk9XU0VSX05URk5fT1JERVJTJ1xuZXhwb3J0IGNvbnN0IElEX0JST1dTRVJfTlRGTl9NQVRDSEVTID0gJ0JST1dTRVJfTlRGTl9NQVRDSEVTJ1xuZXhwb3J0IGNvbnN0IElEX0JST1dTRVJfTlRGTl9CT05EUyA9ICdCUk9XU0VSX05URk5fQk9ORFMnXG5leHBvcnQgY29uc3QgSURfQlJPV1NFUl9OVEZOX0NPTk5FQ1RJT05TID0gJ0JST1dTRVJfTlRGTl9DT05ORUNUSU9OUydcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9CVVRUT05fQlVZX0JBTEFOQ0VfRVJST1IgPSAnT1JERVJfQlVUVE9OX0JVWV9CQUxBTkNFX0VSUk9SJ1xuZXhwb3J0IGNvbnN0IElEX09SREVSX0JVVFRPTl9TRUxMX0JBTEFOQ0VfRVJST1IgPSAnT1JERVJfQlVUVE9OX1NFTExfQkFMQU5DRV9FUlJPUidcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9CVVRUT05fUVRZX0VSUk9SID0gJ09SREVSX0JVVFRPTl9RVFlfRVJST1InXG5leHBvcnQgY29uc3QgSURfT1JERVJfQlVUVE9OX1FUWV9SQVRFX0VSUk9SID0gJ09SREVSX0JVVFRPTl9RVFlfUkFURV9FUlJPUidcbmV4cG9ydCBjb25zdCBJRF9DUkVBVEVfQVNTRVRfV0FMTEVUX01TRyA9ICdDUkVBVEVfQVNTRVRfV0FMTEVUX01TRydcbmV4cG9ydCBjb25zdCBJRF9OT19XQUxMRVRfTVNHID0gJ05PX1dBTExFVF9NU0cnXG5leHBvcnQgY29uc3QgSURfVFJBRElOR19USUVSX1VQREFURUQgPSAnVFJBRElOR19USUVSX1VQREFURUQnXG5leHBvcnQgY29uc3QgSURfSU5WQUxJRF9USUVSX1ZBTFVFID0gJ0lOVkFMSURfVElFUl9WQUxVRSdcbmV4cG9ydCBjb25zdCBJRF9JTlZBTElEX0NPTVBTX1ZBTFVFID0gJ0lOVkFMSURfQ09NUFNfVkFMVUUnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9VTktOT1dOID0gJ1RYX1RZUEVfVU5LTk9XTidcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1NFTkQgPSAnVFhfVFlQRV9TRU5EJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfUkVDRUlWRSA9ICdUWF9UWVBFX1JFQ0VJVkUnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9TV0FQID0gJ1RYX1RZUEVfU1dBUCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1JFREVFTSA9ICdUWF9UWVBFX1JFREVFTSdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1JFRlVORCA9ICdUWF9UWVBFX1JFRlVORCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1NQTElUID0gJ1RYX1RZUEVfU1BMSVQnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9DUkVBVEVfQk9ORCA9ICdUWF9UWVBFX0NSRUFURV9CT05EJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfUkVERUVNX0JPTkQgPSAnVFhfVFlQRV9SRURFRU1fQk9ORCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX0FQUFJPVkVfVE9LRU4gPSAnVFhfVFlQRV9BUFBST1ZFX1RPS0VOJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfQUNDRUxFUkFUSU9OID0gJ1RYX1RZUEVfQUNDRUxFUkFUSU9OJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfU0VMRl9UUkFOU0ZFUiA9ICdUWF9UWVBFX1NFTEZfVFJBTlNGRVInXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9SRVZPS0VfVE9LRU5fQVBQUk9WQUwgPSAnVFhfVFlQRV9SRVZPS0VfVE9LRU5fQVBQUk9WQUwnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9USUNLRVRfUFVSQ0hBU0UgPSAnVFhfVFlQRV9USUNLRVRfUFVSQ0hBU0UnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9USUNLRVRfVk9URSA9ICdUWF9UWVBFX1RJQ0tFVF9WT1RFJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfVElDS0VUX1JFVk9DQVRJT04gPSAnVFhfVFlQRV9USUNLRVRfUkVWT0NBVElPTidcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1NXQVBfT1JfU0VORCA9ICdUWF9UWVBFX1NXQVBfT1JfU0VORCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX01JWCA9ICdUWF9UWVBFX01JWCdcbmV4cG9ydCBjb25zdCBJRF9TV0FQX09SX1NFTkRfVE9PTFRJUCA9ICdTV0FQX09SX1NFTkRfVE9PTFRJUCdcbmV4cG9ydCBjb25zdCBJRF9NSVNTSU5HX0NFWF9DUkVEUyA9ICdNSVNTSU5HX0NFWF9DUkVEUydcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9CVUZGRVIgPSAnTUFUQ0hfQlVGRkVSJ1xuZXhwb3J0IGNvbnN0IElEX05PX1BMQUNFTUVOVFMgPSAnTk9fUExBQ0VNRU5UUydcbmV4cG9ydCBjb25zdCBJRF9JTlZBTElEX1ZBTFVFID0gJ0lOVkFMSURfVkFMVUUnXG5leHBvcnQgY29uc3QgSURfTk9fWkVSTyA9ICdOT19aRVJPJ1xuZXhwb3J0IGNvbnN0IElEX0JPVFRZUEVfQkFTSUNfTU0gPSAnQk9UVFlQRV9CQVNJQ19NTSdcbmV4cG9ydCBjb25zdCBJRF9CT1RUWVBFX0FSQl9NTSA9ICdCT1RUWVBFX0FSQl9NTSdcbmV4cG9ydCBjb25zdCBJRF9CT1RUWVBFX1NJTVBMRV9BUkIgPSAnQk9UVFlQRV9TSU1QTEVfQVJCJ1xuZXhwb3J0IGNvbnN0IElEX05PX0JPVFRZUEUgPSAnTk9fQk9UVFlQRSdcbmV4cG9ydCBjb25zdCBJRF9OT19DRVggPSAnTk9fQ0VYJ1xuZXhwb3J0IGNvbnN0IElEX0NFWEJBTEFOQ0VfRVJSID0gJ0NFWEJBTEFOQ0VfRVJSJ1xuZXhwb3J0IGNvbnN0IElEX1BFTkRJTkcgPSAnUEVORElORydcbmV4cG9ydCBjb25zdCBJRF9DT01QTEVURSA9ICdDT01QTEVURSdcbmV4cG9ydCBjb25zdCBJRF9BUkNISVZFRF9TRVRUSU5HUyA9ICdBUkNISVZFRF9TRVRUSU5HUydcbmV4cG9ydCBjb25zdCBJRF9OT19DT0RFX1BST1ZJREVEID0gJ05PX0NPREVfUFJPVklERUQnXG5leHBvcnQgY29uc3QgSURfRU5BQkxFX0FDQ09VTlQgPSAnRU5BQkxFX0FDQ09VTlQnXG5leHBvcnQgY29uc3QgSURfRElTQUJMRV9BQ0NPVU5UID0gJ0RJU0FCTEVfQUNDT1VOVCdcbmV4cG9ydCBjb25zdCBJRF9BQ0NPVU5UX0RJU0FCTEVEX01TRyA9ICdBQ0NPVU5UX0RJU0FCTEVEX01TRydcbmV4cG9ydCBjb25zdCBJRF9ERVhfRElTQUJMRURfTVNHID0gJ0RFWF9ESVNBQkxFRF9NU0cnXG5leHBvcnQgY29uc3QgSURfV0FMTEVUX05PVF9TWU5DRUQgPSAnV0FMTEVUX05PVF9TWU5DRUQnXG5leHBvcnQgY29uc3QgSURfV0FMTEVUX05PX1BFRVJTID0gJ1dBTExFVF9OT19QRUVSUydcbmV4cG9ydCBjb25zdCBJRF9ERVBPU0lUX0VSUk9SID0gJ0RFUE9TSVRfRVJST1InXG5leHBvcnQgY29uc3QgSURfV0lUSERSQVdfRVJST1IgPSAnV0lUSERSQVdfRVJST1InXG5leHBvcnQgY29uc3QgSURfREVYX1VOREVSRlVOREVEID0gJ0RFWF9VTkRFUkZVTkRFRCdcbmV4cG9ydCBjb25zdCBJRF9DRVhfVU5ERVJGVU5ERUQgPSAnQ0VYX1VOREVSRlVOREVEJ1xuZXhwb3J0IGNvbnN0IElEX0NFWF9UT09fU0hBTExPVyA9ICdDRVhfVE9PX1NIQUxMT1cnXG5leHBvcnQgY29uc3QgSURfQUNDT1VOVF9TVVNQRU5ERUQgPSAnQUNDT1VOVF9TVVNQRU5ERUQnXG5leHBvcnQgY29uc3QgSURfVVNFUl9MSU1JVF9UT09fTE9XID0gJ1VTRVJfTElNSVRfVE9PX0xPVydcbmV4cG9ydCBjb25zdCBJRF9OT19QUklDRV9TT1VSQ0UgPSAnTk9fUFJJQ0VfU09VUkNFJ1xuZXhwb3J0IGNvbnN0IElEX0NFWF9PUkRFUkJPT0tfVU5TWU5DRUQgPSAnQ0VYX09SREVSQk9PS19VTlNZTkNFRCdcbmV4cG9ydCBjb25zdCBJRF9ERVRFUk1JTkVfUExBQ0VNRU5UU19FUlJPUiA9ICdERVRFUk1JTkVfUExBQ0VNRU5UU19FUlJPUidcbmV4cG9ydCBjb25zdCBJRF9QTEFDRV9CVVlfT1JERVJTX0VSUk9SID0gJ1BMQUNFX0JVWV9PUkRFUlNfRVJST1InXG5leHBvcnQgY29uc3QgSURfUExBQ0VfU0VMTF9PUkRFUlNfRVJST1IgPSAnUExBQ0VfU0VMTF9PUkRFUlNfRVJST1InXG5leHBvcnQgY29uc3QgSURfQ0VYX1RSQURFX0VSUk9SID0gJ0NFWF9UUkFERV9FUlJPUidcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9SRVBPUlRfVElUTEUgPSAnT1JERVJfUkVQT1JUX1RJVExFJ1xuZXhwb3J0IGNvbnN0IElEX0NFWF9CQUxBTkNFUyA9ICdDRVhfQkFMQU5DRVMnXG5leHBvcnQgY29uc3QgSURfQ0FVU0VTX1NFTEZfTUFUQ0ggPSAnQ0FVU0VTX1NFTEZfTUFUQ0gnXG5cbmxldCBsb2NhbGU6IExvY2FsZVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZExvY2FsZSAobGFuZzogc3RyaW5nLCBjb21taXRIYXNoOiBzdHJpbmcsIHNraXBDYWNoZTogYm9vbGVhbikge1xuICBpZiAoIXNraXBDYWNoZSkge1xuICAgIGNvbnN0IHNwZWNzID0gU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5sb2NhbGVTcGVjc0tleSlcbiAgICBpZiAoc3BlY3MgJiYgc3BlY3MubGFuZyA9PT0gbGFuZyAmJiBzcGVjcy5jb21taXRIYXNoID09PSBjb21taXRIYXNoKSB7XG4gICAgICBsb2NhbGUgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmxvY2FsZUtleSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgfVxuICBsb2NhbGUgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9sb2NhbGUnLCBsYW5nKVxuICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmxvY2FsZVNwZWNzS2V5LCB7IGxhbmcsIGNvbW1pdEhhc2ggfSlcbiAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5sb2NhbGVLZXksIGxvY2FsZSlcbn1cblxuLyogcHJlcCB3aWxsIGZvcm1hdCB0aGUgbWVzc2FnZSB0byB0aGUgY3VycmVudCBsb2NhbGUuICovXG5leHBvcnQgZnVuY3Rpb24gcHJlcCAoazogc3RyaW5nLCBhcmdzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuICByZXR1cm4gc3RyaW5nVGVtcGxhdGVQYXJzZXIobG9jYWxlW2tdLCBhcmdzIHx8IHt9KVxufVxuXG53aW5kb3cuY2xlYXJMb2NhbGUgPSAoKSA9PiB7XG4gIFN0YXRlLnJlbW92ZUxvY2FsKFN0YXRlLmxvY2FsZVNwZWNzS2V5KVxuICBTdGF0ZS5yZW1vdmVMb2NhbChTdGF0ZS5sb2NhbGVLZXkpXG59XG5cbi8qXG4gKiBzdHJpbmdUZW1wbGF0ZVBhcnNlciBpcyBhIHRlbXBsYXRlIHN0cmluZyBtYXRjaGVyLCB3aGVyZSBleHByZXNzaW9uIGlzIGFueVxuICogdGV4dC4gSXQgc3dpdGNoZXMgd2hhdCBpcyBpbnNpZGUgZG91YmxlIGJyYWNrZXRzIChlLmcuICdidXkge3sgYXNzZXQgfX0nKVxuICogZm9yIHRoZSB2YWx1ZSBkZXNjcmliZWQgaW50byBhcmdzLiBhcmdzIGlzIGFuIG9iamVjdCB3aXRoIGtleXNcbiAqIGVxdWFsIHRvIHRoZSBwbGFjZWhvbGRlciBrZXlzLiAoZS5nLiB7XCJhc3NldFwiOiBcImRjclwifSkuXG4gKiBTbyB0aGF0IHdpbGwgYmUgc3dpdGNoZWQgZm9yOiAnYXNzZXQgZGNyJy5cbiAqL1xuZnVuY3Rpb24gc3RyaW5nVGVtcGxhdGVQYXJzZXIgKGV4cHJlc3Npb246IHN0cmluZywgYXJnczogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuICAvLyB0ZW1wbGF0ZU1hdGNoZXIgbWF0Y2hlcyBhbnkgdGV4dCB3aGljaDpcbiAgLy8gaXMgc29tZSB7eyB0ZXh0IH19IGJldHdlZW4gdHdvIGJyYWNrZXRzLCBhbmQgYSBzcGFjZSBiZXR3ZWVuIHRoZW0uXG4gIC8vIEl0IGlzIGdsb2JhbCwgdGhlcmVmb3JlIGl0IHdpbGwgY2hhbmdlIGFsbCBvY2N1cnJlbmNlcyBmb3VuZC5cbiAgLy8gdGV4dCBjYW4gYmUgYW55dGhpbmcsIGJ1dCBicmFja2V0cyAne30nIGFuZCBzcGFjZSAnXFxzJ1xuICBjb25zdCB0ZW1wbGF0ZU1hdGNoZXIgPSAve3tcXHM/KFtee31cXHNdKilcXHM/fX0vZ1xuICByZXR1cm4gZXhwcmVzc2lvbi5yZXBsYWNlKHRlbXBsYXRlTWF0Y2hlciwgKF8sIHZhbHVlKSA9PiBhcmdzW3ZhbHVlXSlcbn1cbiIsImltcG9ydCB7IFBhZ2VFbGVtZW50LCBhcHAgfSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgQXBwUGFzc1Jlc2V0Rm9ybSwgTG9naW5Gb3JtLCBzbGlkZVN3YXAgfSBmcm9tICcuL2Zvcm1zJ1xuXG4vKlxuICBMb2dpblBhZ2UgaG9sZHMgdGhlIGZvcm0gZm9yIGxvZ2luIGFuZCBwYXNzd29yZCByZXNldC5cbiovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMb2dpblBhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIGxvZ2luRm9ybTogTG9naW5Gb3JtXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBhcHBQYXNzUmVzZXRGb3JtOiBBcHBQYXNzUmVzZXRGb3JtXG5cbiAgY29uc3RydWN0b3IgKGJvZHk6IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhib2R5KVxuICAgIHRoaXMubG9naW5Gb3JtID0gbmV3IExvZ2luRm9ybShwYWdlLmxvZ2luRm9ybSwgKCkgPT4geyB0aGlzLmxvZ2dlZEluKCkgfSlcblxuICAgIGNvbnN0IHByZXBBbmREaXNwbGF5TG9naW5Gb3JtID0gKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5yZXNldEFwcFBXRm9ybSlcbiAgICAgIHRoaXMubG9naW5Gb3JtLnJlZnJlc2goKVxuICAgICAgRG9jLnNob3cocGFnZS5sb2dpbkZvcm0pXG4gICAgICB0aGlzLmxvZ2luRm9ybS5mb2N1cygpXG4gICAgfVxuICAgIHByZXBBbmREaXNwbGF5TG9naW5Gb3JtKClcblxuICAgIHRoaXMuYXBwUGFzc1Jlc2V0Rm9ybSA9IG5ldyBBcHBQYXNzUmVzZXRGb3JtKHBhZ2UucmVzZXRBcHBQV0Zvcm0sICgpID0+IHsgcHJlcEFuZERpc3BsYXlMb2dpbkZvcm0oKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuZm9yZ290UGFzc0J0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5hcHBQYXNzUmVzZXRGb3JtLnJlZnJlc2goKVxuICAgICAgc2xpZGVTd2FwKHBhZ2UubG9naW5Gb3JtLCBwYWdlLnJlc2V0QXBwUFdGb3JtKVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS5yZXNldFBhc3NGb3JtQ2xvc2VyLCAnY2xpY2snLCAoKSA9PiB7IHByZXBBbmREaXNwbGF5TG9naW5Gb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmZvcm1zLCAnbW91c2Vkb3duJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICghRG9jLm1vdXNlSW5FbGVtZW50KGUsIHBhZ2UucmVzZXRBcHBQV0Zvcm0pICYmIERvYy5pc0Rpc3BsYXllZChwYWdlLnJlc2V0QXBwUFdGb3JtKSkgeyBwcmVwQW5kRGlzcGxheUxvZ2luRm9ybSgpIH1cbiAgICB9KVxuICB9XG5cbiAgLyogbG9naW4gc3VibWl0cyB0aGUgc2lnbi1pbiBmb3JtIGFuZCBwYXJzZXMgdGhlIHJlc3VsdC4gKi9cbiAgYXN5bmMgbG9nZ2VkSW4gKCkge1xuICAgIGF3YWl0IGFwcCgpLmxvYWRQYWdlKCd3YWxsZXRzJylcbiAgfVxufVxuIiwiaW1wb3J0IERvYywgeyBXYWxsZXRJY29ucywgcGFyc2VGbG9hdERlZmF1bHQgfSBmcm9tICcuL2RvYydcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0IEJhc2VQYWdlIGZyb20gJy4vYmFzZXBhZ2UnXG5pbXBvcnQgT3JkZXJCb29rIGZyb20gJy4vb3JkZXJib29rJ1xuaW1wb3J0IHsgUmVwdXRhdGlvbk1ldGVyLCB0cmFkaW5nTGltaXRzLCBzdHJvbmdUaWVyIH0gZnJvbSAnLi9hY2NvdW50J1xuaW1wb3J0IHtcbiAgQ2FuZGxlQ2hhcnQsXG4gIERlcHRoQ2hhcnQsXG4gIERlcHRoTGluZSxcbiAgQ2FuZGxlUmVwb3J0ZXJzLFxuICBNb3VzZVJlcG9ydCxcbiAgVm9sdW1lUmVwb3J0LFxuICBEZXB0aE1hcmtlcixcbiAgV2F2ZVxufSBmcm9tICcuL2NoYXJ0cydcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0IHtcbiAgTmV3V2FsbGV0Rm9ybSxcbiAgQWNjZWxlcmF0ZU9yZGVyRm9ybSxcbiAgRGVwb3NpdEFkZHJlc3MsXG4gIFRva2VuQXBwcm92YWxGb3JtLFxuICBiaW5kIGFzIGJpbmRGb3JtLFxuICBGb3Jtc1xufSBmcm9tICcuL2Zvcm1zJ1xuaW1wb3J0ICogYXMgT3JkZXJVdGlsIGZyb20gJy4vb3JkZXJ1dGlsJ1xuaW1wb3J0IHdzIGZyb20gJy4vd3MnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7XG4gIGFwcCxcbiAgU3VwcG9ydGVkQXNzZXQsXG4gIFBhZ2VFbGVtZW50LFxuICBPcmRlcixcbiAgTWFya2V0LFxuICBPcmRlckVzdGltYXRlLFxuICBNYXhPcmRlckVzdGltYXRlLFxuICBFeGNoYW5nZSxcbiAgVW5pdEluZm8sXG4gIEFzc2V0LFxuICBDYW5kbGUsXG4gIENhbmRsZXNQYXlsb2FkLFxuICBUcmFkZUZvcm0sXG4gIEJvb2tVcGRhdGUsXG4gIE1heFNlbGwsXG4gIE1heEJ1eSxcbiAgU3dhcEVzdGltYXRlLFxuICBNYXJrZXRPcmRlckJvb2ssXG4gIEFQSVJlc3BvbnNlLFxuICBQcmVTd2FwLFxuICBQcmVSZWRlZW0sXG4gIFdhbGxldFN0YXRlTm90ZSxcbiAgV2FsbGV0U3luY05vdGUsXG4gIFdhbGxldENyZWF0aW9uTm90ZSxcbiAgU3BvdFByaWNlTm90ZSxcbiAgQm9uZE5vdGUsXG4gIE9yZGVyTm90ZSxcbiAgRXBvY2hOb3RlLFxuICBCYWxhbmNlTm90ZSxcbiAgTWluaU9yZGVyLFxuICBSZW1haW5kZXJVcGRhdGUsXG4gIENvbm5FdmVudE5vdGUsXG4gIE9yZGVyT3B0aW9uLFxuICBDb25uZWN0aW9uU3RhdHVzLFxuICBSZWNlbnRNYXRjaCxcbiAgTWF0Y2hOb3RlLFxuICBBcHByb3ZhbFN0YXR1cyxcbiAgT3JkZXJGaWx0ZXIsXG4gIFJ1blN0YXRzTm90ZSxcbiAgUnVuRXZlbnROb3RlLFxuICBFcG9jaFJlcG9ydE5vdGUsXG4gIENFWFByb2JsZW1zTm90ZVxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IHsgc2V0T3B0aW9uVGVtcGxhdGVzIH0gZnJvbSAnLi9vcHRzJ1xuaW1wb3J0IHsgUnVubmluZ01hcmtldE1ha2VyRGlzcGxheSB9IGZyb20gJy4vbW11dGlsJ1xuXG5jb25zdCBiaW5kID0gRG9jLmJpbmRcblxuY29uc3QgYm9va1JvdXRlID0gJ2Jvb2snXG5jb25zdCBib29rT3JkZXJSb3V0ZSA9ICdib29rX29yZGVyJ1xuY29uc3QgdW5ib29rT3JkZXJSb3V0ZSA9ICd1bmJvb2tfb3JkZXInXG5jb25zdCB1cGRhdGVSZW1haW5pbmdSb3V0ZSA9ICd1cGRhdGVfcmVtYWluaW5nJ1xuY29uc3QgZXBvY2hPcmRlclJvdXRlID0gJ2Vwb2NoX29yZGVyJ1xuY29uc3QgY2FuZGxlc1JvdXRlID0gJ2NhbmRsZXMnXG5jb25zdCBjYW5kbGVVcGRhdGVSb3V0ZSA9ICdjYW5kbGVfdXBkYXRlJ1xuY29uc3QgdW5tYXJrZXRSb3V0ZSA9ICd1bm1hcmtldCdcbmNvbnN0IGVwb2NoTWF0Y2hTdW1tYXJ5Um91dGUgPSAnZXBvY2hfbWF0Y2hfc3VtbWFyeSdcblxuY29uc3QgYW5Ib3VyID0gNjAgKiA2MCAqIDEwMDAgLy8gbWlsbGlzZWNvbmRzXG5jb25zdCBtYXhVc2VyT3JkZXJzU2hvd24gPSAxMFxuXG5jb25zdCBidXlCdG5DbGFzcyA9ICdidXlncmVlbi1iZydcbmNvbnN0IHNlbGxCdG5DbGFzcyA9ICdzZWxscmVkLWJnJ1xuXG5jb25zdCBmaXZlTWluQmluS2V5ID0gJzVtJ1xuY29uc3Qgb25lSHJCaW5LZXkgPSAnMWgnXG5cbmNvbnN0IHBlcmNlbnRGb3JtYXR0ZXIgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQoRG9jLmxhbmd1YWdlcygpLCB7XG4gIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMSxcbiAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAyXG59KVxuXG5jb25zdCBwYXJlbnRJRE5vbmUgPSAweEZGRkZGRkZGXG5cbmludGVyZmFjZSBNZXRhT3JkZXIge1xuICBkaXY6IEhUTUxFbGVtZW50XG4gIGhlYWRlcjogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGRldGFpbHM6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBvcmQ6IE9yZGVyXG4gIGNhbmNlbGxpbmc/OiBib29sZWFuXG59XG5cbmludGVyZmFjZSBDYW5jZWxEYXRhIHtcbiAgYnR0bjogUGFnZUVsZW1lbnRcbiAgb3JkZXI6IE9yZGVyXG59XG5cbmludGVyZmFjZSBDdXJyZW50TWFya2V0IHtcbiAgZGV4OiBFeGNoYW5nZVxuICBzaWQ6IHN0cmluZyAvLyBBIHN0cmluZyBtYXJrZXQgaWRlbnRpZmllciB1c2VkIGJ5IHRoZSBERVguXG4gIGNmZzogTWFya2V0XG4gIGJhc2U6IFN1cHBvcnRlZEFzc2V0XG4gIHF1b3RlOiBTdXBwb3J0ZWRBc3NldFxuICBiYXNlVW5pdEluZm86IFVuaXRJbmZvXG4gIHF1b3RlVW5pdEluZm86IFVuaXRJbmZvXG4gIG1heFNlbGxSZXF1ZXN0ZWQ6IGJvb2xlYW5cbiAgbWF4U2VsbDogTWF4T3JkZXJFc3RpbWF0ZSB8IG51bGxcbiAgc2VsbEJhbGFuY2U6IG51bWJlclxuICBidXlCYWxhbmNlOiBudW1iZXJcbiAgbWF4QnV5czogUmVjb3JkPG51bWJlciwgTWF4T3JkZXJFc3RpbWF0ZT5cbiAgY2FuZGxlQ2FjaGVzOiBSZWNvcmQ8c3RyaW5nLCBDYW5kbGVzUGF5bG9hZD5cbiAgYmFzZUNmZzogQXNzZXRcbiAgcXVvdGVDZmc6IEFzc2V0XG4gIHJhdGVDb252ZXJzaW9uRmFjdG9yOiBudW1iZXJcbiAgYm9va0xvYWRlZDogYm9vbGVhblxufVxuXG5pbnRlcmZhY2UgTG9hZFRyYWNrZXIge1xuICBsb2FkZWQ6ICgpID0+IHZvaWRcbiAgdGltZXI6IG51bWJlclxufVxuXG5pbnRlcmZhY2UgT3JkZXJSb3cgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIG1hbmFnZXI6IE9yZGVyVGFibGVSb3dNYW5hZ2VyXG59XG5cbmludGVyZmFjZSBTdGF0c0Rpc3BsYXkge1xuICByb3c6IFBhZ2VFbGVtZW50XG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxufVxuXG5pbnRlcmZhY2UgTWFya2V0c1BhZ2VQYXJhbXMge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBzdHJpbmdcbiAgcXVvdGVJRDogc3RyaW5nXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcmtldHNQYWdlIGV4dGVuZHMgQmFzZVBhZ2Uge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgbWFpbjogSFRNTEVsZW1lbnRcbiAgbWF4TG9hZGVkOiAoKCkgPT4gdm9pZCkgfCBudWxsXG4gIG1heE9yZGVyVXBkYXRlQ291bnRlcjogbnVtYmVyXG4gIG1hcmtldDogQ3VycmVudE1hcmtldFxuICBjdXJyZW50Rm9ybTogSFRNTEVsZW1lbnRcbiAgb3BlbkFzc2V0OiBTdXBwb3J0ZWRBc3NldFxuICBjdXJyZW50Q3JlYXRlOiBTdXBwb3J0ZWRBc3NldFxuICBtYXhFc3RpbWF0ZVRpbWVyOiBudW1iZXIgfCBudWxsXG4gIGJvb2s6IE9yZGVyQm9va1xuICBjYW5jZWxEYXRhOiBDYW5jZWxEYXRhXG4gIG1ldGFPcmRlcnM6IFJlY29yZDxzdHJpbmcsIE1ldGFPcmRlcj5cbiAgcHJlb3JkZXJDYWNoZTogUmVjb3JkPHN0cmluZywgT3JkZXJFc3RpbWF0ZT5cbiAgY3VycmVudE9yZGVyOiBUcmFkZUZvcm1cbiAgZGVwdGhMaW5lczogUmVjb3JkPHN0cmluZywgRGVwdGhMaW5lW10+XG4gIGFjdGl2ZU1hcmtlclJhdGU6IG51bWJlciB8IG51bGxcbiAgaG92ZXJzOiBIVE1MRWxlbWVudFtdXG4gIG9nVGl0bGU6IHN0cmluZ1xuICBkZXB0aENoYXJ0OiBEZXB0aENoYXJ0XG4gIGNhbmRsZUNoYXJ0OiBDYW5kbGVDaGFydFxuICBjYW5kbGVEdXI6IHN0cmluZ1xuICBiYWxhbmNlV2d0OiBCYWxhbmNlV2lkZ2V0XG4gIG1tOiBSdW5uaW5nTWFya2V0TWFrZXJEaXNwbGF5XG4gIG1hcmtldExpc3Q6IE1hcmtldExpc3RcbiAgbmV3V2FsbGV0Rm9ybTogTmV3V2FsbGV0Rm9ybVxuICBkZXBvc2l0QWRkckZvcm06IERlcG9zaXRBZGRyZXNzXG4gIGFwcHJvdmVUb2tlbkZvcm06IFRva2VuQXBwcm92YWxGb3JtXG4gIHJlcHV0YXRpb25NZXRlcjogUmVwdXRhdGlvbk1ldGVyXG4gIGtleXVwOiAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZFxuICBzZWNvbmRUaWNrZXI6IG51bWJlclxuICBjYW5kbGVzTG9hZGluZzogTG9hZFRyYWNrZXIgfCBudWxsXG4gIGFjY2VsZXJhdGVPcmRlckZvcm06IEFjY2VsZXJhdGVPcmRlckZvcm1cbiAgcmVjZW50TWF0Y2hlczogUmVjZW50TWF0Y2hbXVxuICByZWNlbnRNYXRjaGVzU29ydEtleTogc3RyaW5nXG4gIHJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uOiAxIHwgLTFcbiAgc3RhdHM6IFtTdGF0c0Rpc3BsYXksIFN0YXRzRGlzcGxheV1cbiAgbG9hZGluZ0FuaW1hdGlvbnM6IHsgY2FuZGxlcz86IFdhdmUsIGRlcHRoPzogV2F2ZSB9XG4gIG1tUnVubmluZzogYm9vbGVhbiB8IHVuZGVmaW5lZFxuICBmb3JtczogRm9ybXNcbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50LCBwYWdlUGFyYW1zOiBNYXJrZXRzUGFnZVBhcmFtcykge1xuICAgIHN1cGVyKClcblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhtYWluKVxuICAgIHRoaXMubWFpbiA9IG1haW5cbiAgICBpZiAoIXRoaXMubWFpbi5wYXJlbnRFbGVtZW50KSByZXR1cm4gLy8gTm90IGdvbm5hIGhhcHBlbiwgYnV0IFR5cGVTY3JpcHQgY2FyZXMuXG4gICAgLy8gVGhlcmUgbWF5IGJlIG11bHRpcGxlIHBlbmRpbmcgdXBkYXRlcyB0byB0aGUgbWF4IG9yZGVyLiBUaGlzIG1ha2VzIHN1cmVcbiAgICAvLyB0aGF0IHRoZSBzY3JlZW4gaXMgdXBkYXRlZCB3aXRoIHRoZSBtb3N0IHJlY2VudCBvbmUuXG4gICAgdGhpcy5tYXhPcmRlclVwZGF0ZUNvdW50ZXIgPSAwXG4gICAgdGhpcy5tZXRhT3JkZXJzID0ge31cbiAgICB0aGlzLnJlY2VudE1hdGNoZXMgPSBbXVxuICAgIHRoaXMucHJlb3JkZXJDYWNoZSA9IHt9XG4gICAgdGhpcy5kZXB0aExpbmVzID0ge1xuICAgICAgaG92ZXI6IFtdLFxuICAgICAgaW5wdXQ6IFtdXG4gICAgfVxuICAgIHRoaXMuaG92ZXJzID0gW11cbiAgICAvLyAnUmVjZW50IE1hdGNoZXMnIGxpc3Qgc29ydCBrZXkgYW5kIGRpcmVjdGlvbi5cbiAgICB0aGlzLnJlY2VudE1hdGNoZXNTb3J0S2V5ID0gJ2FnZSdcbiAgICB0aGlzLnJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uID0gLTFcbiAgICAvLyBzdG9yZSBvcmlnaW5hbCB0aXRsZSBzbyB3ZSBjYW4gcmUtYXBwZW5kIGl0IHdoZW4gdXBkYXRpbmcgbWFya2V0IHZhbHVlLlxuICAgIHRoaXMub2dUaXRsZSA9IGRvY3VtZW50LnRpdGxlXG4gICAgdGhpcy5mb3JtcyA9IG5ldyBGb3JtcyhwYWdlLmZvcm1zKVxuXG4gICAgY29uc3QgZGVwdGhSZXBvcnRlcnMgPSB7XG4gICAgICBjbGljazogKHg6IG51bWJlcikgPT4geyB0aGlzLnJlcG9ydERlcHRoQ2xpY2soeCkgfSxcbiAgICAgIHZvbHVtZTogKHI6IFZvbHVtZVJlcG9ydCkgPT4geyB0aGlzLnJlcG9ydERlcHRoVm9sdW1lKHIpIH0sXG4gICAgICBtb3VzZTogKHI6IE1vdXNlUmVwb3J0KSA9PiB7IHRoaXMucmVwb3J0RGVwdGhNb3VzZShyKSB9LFxuICAgICAgem9vbTogKHo6IG51bWJlcikgPT4geyB0aGlzLnJlcG9ydERlcHRoWm9vbSh6KSB9XG4gICAgfVxuICAgIHRoaXMuZGVwdGhDaGFydCA9IG5ldyBEZXB0aENoYXJ0KHBhZ2UuZGVwdGhDaGFydCwgZGVwdGhSZXBvcnRlcnMsIFN0YXRlLmZldGNoTG9jYWwoU3RhdGUuZGVwdGhab29tTEspKVxuXG4gICAgY29uc3QgY2FuZGxlUmVwb3J0ZXJzOiBDYW5kbGVSZXBvcnRlcnMgPSB7XG4gICAgICBtb3VzZTogYyA9PiB7IHRoaXMucmVwb3J0TW91c2VDYW5kbGUoYykgfVxuICAgIH1cbiAgICB0aGlzLmNhbmRsZUNoYXJ0ID0gbmV3IENhbmRsZUNoYXJ0KHBhZ2UuY2FuZGxlc0NoYXJ0LCBjYW5kbGVSZXBvcnRlcnMpXG5cbiAgICBjb25zdCBzdWNjZXNzID0gKCkgPT4geyAvKiBkbyBub3RoaW5nICovIH1cbiAgICAvLyBEbyBub3QgY2FsbCBjbGVhblRlbXBsYXRlcyBiZWZvcmUgY3JlYXRpbmcgdGhlIEFjY2VsZXJhdGVPcmRlckZvcm1cbiAgICB0aGlzLmFjY2VsZXJhdGVPcmRlckZvcm0gPSBuZXcgQWNjZWxlcmF0ZU9yZGVyRm9ybShwYWdlLmFjY2VsZXJhdGVGb3JtLCBzdWNjZXNzKVxuXG4gICAgdGhpcy5hcHByb3ZlVG9rZW5Gb3JtID0gbmV3IFRva2VuQXBwcm92YWxGb3JtKHBhZ2UuYXBwcm92ZVRva2VuRm9ybSlcblxuICAgIC8vIFNldCB1c2VyJ3MgbGFzdCBrbm93biBjYW5kbGUgZHVyYXRpb24uXG4gICAgdGhpcy5jYW5kbGVEdXIgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmxhc3RDYW5kbGVEdXJhdGlvbkxLKSB8fCBvbmVIckJpbktleVxuXG4gICAgLy8gU2V0dXAgdGhlIHJlZ2lzdGVyIHRvIHRyYWRlIGJ1dHRvbi5cbiAgICAvLyBUT0RPOiBVc2UgZGV4c2V0dGluZ3MgcGFnZT9cbiAgICBjb25zdCByZWdpc3RlckJ0dG4gPSBEb2MudG1wbEVsZW1lbnQocGFnZS5ub3RSZWdpc3RlcmVkLCAncmVnaXN0ZXJCdHRuJylcbiAgICBiaW5kKHJlZ2lzdGVyQnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgYXBwKCkubG9hZFBhZ2UoJ3JlZ2lzdGVyJywgeyBob3N0OiB0aGlzLm1hcmtldC5kZXguaG9zdCB9KVxuICAgIH0pXG5cbiAgICAvLyBTZXQgdXAgdGhlIEJhbGFuY2VXaWRnZXQuXG4gICAge1xuICAgICAgcGFnZS53YWxsZXRJbmZvVG1wbC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJylcbiAgICAgIGNvbnN0IGJXaWRnZXQgPSBwYWdlLndhbGxldEluZm9UbXBsXG4gICAgICBjb25zdCBxV2lkZ2V0ID0gcGFnZS53YWxsZXRJbmZvVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIGJXaWRnZXQuYWZ0ZXIocVdpZGdldClcbiAgICAgIGNvbnN0IHdndCA9IHRoaXMuYmFsYW5jZVdndCA9IG5ldyBCYWxhbmNlV2lkZ2V0KGJXaWRnZXQsIHFXaWRnZXQpXG4gICAgICBjb25zdCBiYXNlSWNvbnMgPSB3Z3QuYmFzZS5zdGF0ZUljb25zLmljb25zXG4gICAgICBjb25zdCBxdW90ZUljb25zID0gd2d0LnF1b3RlLnN0YXRlSWNvbnMuaWNvbnNcbiAgICAgIGJpbmQod2d0LmJhc2UudG1wbC5jb25uZWN0LCAnY2xpY2snLCAoKSA9PiB7IHRoaXMudW5sb2NrV2FsbGV0KHRoaXMubWFya2V0LmJhc2UuaWQpIH0pXG4gICAgICBiaW5kKHdndC5xdW90ZS50bXBsLmNvbm5lY3QsICdjbGljaycsICgpID0+IHsgdGhpcy51bmxvY2tXYWxsZXQodGhpcy5tYXJrZXQucXVvdGUuaWQpIH0pXG4gICAgICBiaW5kKHdndC5iYXNlLnRtcGwuZXhwaXJlZCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnVubG9ja1dhbGxldCh0aGlzLm1hcmtldC5iYXNlLmlkKSB9KVxuICAgICAgYmluZCh3Z3QucXVvdGUudG1wbC5leHBpcmVkLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMudW5sb2NrV2FsbGV0KHRoaXMubWFya2V0LnF1b3RlLmlkKSB9KVxuICAgICAgYmluZChiYXNlSWNvbnMuc2xlZXBpbmcsICdjbGljaycsICgpID0+IHsgdGhpcy51bmxvY2tXYWxsZXQodGhpcy5tYXJrZXQuYmFzZS5pZCkgfSlcbiAgICAgIGJpbmQocXVvdGVJY29ucy5zbGVlcGluZywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnVubG9ja1dhbGxldCh0aGlzLm1hcmtldC5xdW90ZS5pZCkgfSlcbiAgICAgIGJpbmQoYmFzZUljb25zLmxvY2tlZCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnVubG9ja1dhbGxldCh0aGlzLm1hcmtldC5iYXNlLmlkKSB9KVxuICAgICAgYmluZChxdW90ZUljb25zLmxvY2tlZCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnVubG9ja1dhbGxldCh0aGlzLm1hcmtldC5xdW90ZS5pZCkgfSlcbiAgICAgIGJpbmQoYmFzZUljb25zLmRpc2FibGVkLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1RvZ2dsZVdhbGxldFN0YXR1cyh0aGlzLm1hcmtldC5iYXNlKSB9KVxuICAgICAgYmluZChxdW90ZUljb25zLmRpc2FibGVkLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1RvZ2dsZVdhbGxldFN0YXR1cyh0aGlzLm1hcmtldC5xdW90ZSkgfSlcbiAgICAgIGJpbmQod2d0LmJhc2UudG1wbC5uZXdXYWxsZXRCdHRuLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd0NyZWF0ZSh0aGlzLm1hcmtldC5iYXNlKSB9KVxuICAgICAgYmluZCh3Z3QucXVvdGUudG1wbC5uZXdXYWxsZXRCdHRuLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd0NyZWF0ZSh0aGlzLm1hcmtldC5xdW90ZSkgfSlcbiAgICAgIGJpbmQod2d0LmJhc2UudG1wbC53YWxsZXRBZGRyLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd0RlcG9zaXQodGhpcy5tYXJrZXQuYmFzZS5pZCkgfSlcbiAgICAgIGJpbmQod2d0LnF1b3RlLnRtcGwud2FsbGV0QWRkciwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dEZXBvc2l0KHRoaXMubWFya2V0LnF1b3RlLmlkKSB9KVxuICAgICAgYmluZCh3Z3QuYmFzZS50bXBsLndhbnRQcm92aWRlcnMsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93Q3VzdG9tUHJvdmlkZXJEaWFsb2codGhpcy5tYXJrZXQuYmFzZS5pZCkgfSlcbiAgICAgIGJpbmQod2d0LnF1b3RlLnRtcGwud2FudFByb3ZpZGVycywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dDdXN0b21Qcm92aWRlckRpYWxvZyh0aGlzLm1hcmtldC5xdW90ZS5pZCkgfSlcbiAgICAgIHRoaXMuZGVwb3NpdEFkZHJGb3JtID0gbmV3IERlcG9zaXRBZGRyZXNzKHBhZ2UuZGVwb3NpdClcbiAgICB9XG5cbiAgICB0aGlzLm1tID0gbmV3IFJ1bm5pbmdNYXJrZXRNYWtlckRpc3BsYXkocGFnZS5tbVJ1bm5pbmcsIHRoaXMuZm9ybXMsIHBhZ2Uub3JkZXJSZXBvcnRGb3JtLCAnbWFya2V0cycpXG5cbiAgICB0aGlzLnJlcHV0YXRpb25NZXRlciA9IG5ldyBSZXB1dGF0aW9uTWV0ZXIocGFnZS5yZXB1dGF0aW9uTWV0ZXIpXG5cbiAgICAvLyBCaW5kIHRvZ2dsZSB3YWxsZXQgc3RhdHVzIGZvcm0uXG4gICAgYmluZEZvcm0ocGFnZS50b2dnbGVXYWxsZXRTdGF0dXNDb25maXJtLCBwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c1N1Ym1pdCwgYXN5bmMgKCkgPT4geyB0aGlzLnRvZ2dsZVdhbGxldFN0YXR1cygpIH0pXG5cbiAgICAvLyBQcmVwYXJlIHRlbXBsYXRlcyBmb3IgdGhlIGJ1eSBhbmQgc2VsbCB0YWJsZXMgYW5kIHRoZSB1c2VyJ3Mgb3JkZXIgdGFibGUuXG4gICAgc2V0T3B0aW9uVGVtcGxhdGVzKHBhZ2UpXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKFxuICAgICAgcGFnZS5vcmRlclJvd1RtcGwsIHBhZ2UuZHVyQnR0blRlbXBsYXRlLCBwYWdlLmJvb2xlYW5PcHRUbXBsLCBwYWdlLnJhbmdlT3B0VG1wbCxcbiAgICAgIHBhZ2Uub3JkZXJPcHRUbXBsLCBwYWdlLnVzZXJPcmRlclRtcGwsIHBhZ2UucmVjZW50TWF0Y2hlc1RlbXBsYXRlXG4gICAgKVxuXG4gICAgLy8gQnV0dG9ucyB0byBzaG93IHRva2VuIGFwcHJvdmFsIGZvcm1cbiAgICBiaW5kKHBhZ2UuYXBwcm92ZUJhc2VCdHRuLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1Rva2VuQXBwcm92YWxGb3JtKHRydWUpIH0pXG4gICAgYmluZChwYWdlLmFwcHJvdmVRdW90ZUJ0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93VG9rZW5BcHByb3ZhbEZvcm0oZmFsc2UpIH0pXG5cbiAgICBjb25zdCB0b2dnbGVUcmFkaW5nVGllciA9IChzaG93OiBib29sZWFuKSA9PiB7XG4gICAgICBEb2Muc2V0VmlzKCFzaG93LCBwYWdlLnNob3dUcmFkaW5nVGllcilcbiAgICAgIERvYy5zZXRWaXMoc2hvdywgcGFnZS50cmFkaW5nTGltaXRzLCBwYWdlLmhpZGVUcmFkaW5nVGllcilcbiAgICB9XG4gICAgYmluZChwYWdlLnNob3dUcmFkaW5nVGllciwgJ2NsaWNrJywgKCkgPT4geyB0b2dnbGVUcmFkaW5nVGllcih0cnVlKSB9KVxuICAgIGJpbmQocGFnZS5oaWRlVHJhZGluZ1RpZXIsICdjbGljaycsICgpID0+IHsgdG9nZ2xlVHJhZGluZ1RpZXIoZmFsc2UpIH0pXG5cbiAgICBjb25zdCB0b2dnbGVUcmFkaW5nUmVwdXRhdGlvbiA9IChzaG93OiBib29sZWFuKSA9PiB7XG4gICAgICBEb2Muc2V0VmlzKCFzaG93LCBwYWdlLnNob3dUcmFkaW5nUmVwdXRhdGlvbilcbiAgICAgIERvYy5zZXRWaXMoc2hvdywgcGFnZS5yZXB1dGF0aW9uTWV0ZXIsIHBhZ2UuaGlkZVRyYWRpbmdSZXB1dGF0aW9uKVxuICAgIH1cbiAgICBiaW5kKHBhZ2Uuc2hvd1RyYWRpbmdSZXB1dGF0aW9uLCAnY2xpY2snLCAoKSA9PiB7IHRvZ2dsZVRyYWRpbmdSZXB1dGF0aW9uKHRydWUpIH0pXG4gICAgYmluZChwYWdlLmhpZGVUcmFkaW5nUmVwdXRhdGlvbiwgJ2NsaWNrJywgKCkgPT4geyB0b2dnbGVUcmFkaW5nUmVwdXRhdGlvbihmYWxzZSkgfSlcblxuICAgIC8vIEJ1dHRvbnMgdG8gc2V0IG9yZGVyIHR5cGUgYW5kIHNpZGUuXG4gICAgYmluZChwYWdlLmJ1eUJ0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zZXRCdXkoKSB9KVxuICAgIGJpbmQocGFnZS5zZWxsQnR0biwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNldFNlbGwoKSB9KVxuXG4gICAgYmluZChwYWdlLmxpbWl0QnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgc3dhcEJ0dG5zKHBhZ2UubWFya2V0QnR0biwgcGFnZS5saW1pdEJ0dG4pXG4gICAgICB0aGlzLnNldE9yZGVyVmlzaWJpbGl0eSgpXG4gICAgICBpZiAoIXBhZ2UucmF0ZUZpZWxkLnZhbHVlKSByZXR1cm5cbiAgICAgIHRoaXMuZGVwdGhMaW5lcy5pbnB1dCA9IFt7XG4gICAgICAgIHJhdGU6IHBhcnNlRmxvYXREZWZhdWx0KHBhZ2UucmF0ZUZpZWxkLnZhbHVlLCAwKSxcbiAgICAgICAgY29sb3I6IHRoaXMuaXNTZWxsKCkgPyB0aGlzLmRlcHRoQ2hhcnQudGhlbWUuc2VsbExpbmUgOiB0aGlzLmRlcHRoQ2hhcnQudGhlbWUuYnV5TGluZVxuICAgICAgfV1cbiAgICAgIHRoaXMuZHJhd0NoYXJ0TGluZXMoKVxuICAgIH0pXG4gICAgYmluZChwYWdlLm1hcmtldEJ0dG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIHN3YXBCdHRucyhwYWdlLmxpbWl0QnR0biwgcGFnZS5tYXJrZXRCdHRuKVxuICAgICAgdGhpcy5zZXRPcmRlclZpc2liaWxpdHkoKVxuICAgICAgdGhpcy5zZXRNYXJrZXRCdXlPcmRlckVzdGltYXRlKClcbiAgICAgIHRoaXMuZGVwdGhMaW5lcy5pbnB1dCA9IFtdXG4gICAgICB0aGlzLmRyYXdDaGFydExpbmVzKClcbiAgICB9KVxuICAgIGJpbmQocGFnZS5tYXhPcmQsICdjbGljaycsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmlzU2VsbCgpKSB7XG4gICAgICAgIGNvbnN0IG1heFNlbGwgPSB0aGlzLm1hcmtldC5tYXhTZWxsXG4gICAgICAgIGlmICghbWF4U2VsbCkgcmV0dXJuXG4gICAgICAgIHBhZ2UubG90RmllbGQudmFsdWUgPSBTdHJpbmcobWF4U2VsbC5zd2FwLmxvdHMpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBtYXhCdXkgPSB0aGlzLm1hcmtldC5tYXhCdXlzW3RoaXMuYWRqdXN0ZWRSYXRlKCldXG4gICAgICAgIGlmICghbWF4QnV5KSByZXR1cm5cbiAgICAgICAgcGFnZS5sb3RGaWVsZC52YWx1ZSA9IFN0cmluZyhtYXhCdXkuc3dhcC5sb3RzKVxuICAgICAgfVxuICAgICAgdGhpcy5sb3RDaGFuZ2VkKClcbiAgICB9KVxuXG4gICAgRG9jLmRpc2FibGVNb3VzZVdoZWVsKHBhZ2UucmF0ZUZpZWxkLCBwYWdlLmxvdEZpZWxkLCBwYWdlLnF0eUZpZWxkLCBwYWdlLm1rdEJ1eUZpZWxkKVxuXG4gICAgLy8gSGFuZGxlIHRoZSBmdWxsIG9yZGVyYm9vayBzZW50IG9uIHRoZSAnYm9vaycgcm91dGUuXG4gICAgd3MucmVnaXN0ZXJSb3V0ZShib29rUm91dGUsIChkYXRhOiBCb29rVXBkYXRlKSA9PiB7IHRoaXMuaGFuZGxlQm9va1JvdXRlKGRhdGEpIH0pXG4gICAgLy8gSGFuZGxlIHRoZSBuZXcgb3JkZXIgZm9yIHRoZSBvcmRlciBib29rIG9uIHRoZSAnYm9va19vcmRlcicgcm91dGUuXG4gICAgd3MucmVnaXN0ZXJSb3V0ZShib29rT3JkZXJSb3V0ZSwgKGRhdGE6IEJvb2tVcGRhdGUpID0+IHsgdGhpcy5oYW5kbGVCb29rT3JkZXJSb3V0ZShkYXRhKSB9KVxuICAgIC8vIFJlbW92ZSB0aGUgb3JkZXIgc2VudCBvbiB0aGUgJ3VuYm9va19vcmRlcicgcm91dGUgZnJvbSB0aGUgb3JkZXJib29rLlxuICAgIHdzLnJlZ2lzdGVyUm91dGUodW5ib29rT3JkZXJSb3V0ZSwgKGRhdGE6IEJvb2tVcGRhdGUpID0+IHsgdGhpcy5oYW5kbGVVbmJvb2tPcmRlclJvdXRlKGRhdGEpIH0pXG4gICAgLy8gVXBkYXRlIHRoZSByZW1haW5pbmcgcXVhbnRpdHkgb24gYSBib29rZWQgb3JkZXIuXG4gICAgd3MucmVnaXN0ZXJSb3V0ZSh1cGRhdGVSZW1haW5pbmdSb3V0ZSwgKGRhdGE6IEJvb2tVcGRhdGUpID0+IHsgdGhpcy5oYW5kbGVVcGRhdGVSZW1haW5pbmdSb3V0ZShkYXRhKSB9KVxuICAgIC8vIEhhbmRsZSB0aGUgbmV3IG9yZGVyIGZvciB0aGUgb3JkZXIgYm9vayBvbiB0aGUgJ2Vwb2NoX29yZGVyJyByb3V0ZS5cbiAgICB3cy5yZWdpc3RlclJvdXRlKGVwb2NoT3JkZXJSb3V0ZSwgKGRhdGE6IEJvb2tVcGRhdGUpID0+IHsgdGhpcy5oYW5kbGVFcG9jaE9yZGVyUm91dGUoZGF0YSkgfSlcbiAgICAvLyBIYW5kbGUgdGhlIGluaXRpYWwgY2FuZGxlc3RpY2sgZGF0YSBvbiB0aGUgJ2NhbmRsZXMnIHJvdXRlLlxuICAgIHdzLnJlZ2lzdGVyUm91dGUoY2FuZGxlc1JvdXRlLCAoZGF0YTogQm9va1VwZGF0ZSkgPT4geyB0aGlzLmhhbmRsZUNhbmRsZXNSb3V0ZShkYXRhKSB9KVxuICAgIC8vIEhhbmRsZSB0aGUgY2FuZGxlcyB1cGRhdGUgb24gdGhlICdjYW5kbGVzJyByb3V0ZS5cbiAgICB3cy5yZWdpc3RlclJvdXRlKGNhbmRsZVVwZGF0ZVJvdXRlLCAoZGF0YTogQm9va1VwZGF0ZSkgPT4geyB0aGlzLmhhbmRsZUNhbmRsZVVwZGF0ZVJvdXRlKGRhdGEpIH0pXG5cbiAgICAvLyBIYW5kbGUgdGhlIHJlY2VudCBtYXRjaGVzIHVwZGF0ZSBvbiB0aGUgJ2Vwb2NoX3JlcG9ydCcgcm91dGUuXG4gICAgd3MucmVnaXN0ZXJSb3V0ZShlcG9jaE1hdGNoU3VtbWFyeVJvdXRlLCAoZGF0YTogQm9va1VwZGF0ZSkgPT4geyB0aGlzLmhhbmRsZUVwb2NoTWF0Y2hTdW1tYXJ5KGRhdGEpIH0pXG4gICAgLy8gQ3JlYXRlIGEgd2FsbGV0XG4gICAgdGhpcy5uZXdXYWxsZXRGb3JtID0gbmV3IE5ld1dhbGxldEZvcm0ocGFnZS5uZXdXYWxsZXRGb3JtLCBhc3luYyAoKSA9PiB7IHRoaXMuY3JlYXRlV2FsbGV0KCkgfSlcbiAgICAvLyBNYWluIG9yZGVyIGZvcm0uXG4gICAgYmluZEZvcm0ocGFnZS5vcmRlckZvcm0sIHBhZ2Uuc3VibWl0QnR0biwgYXN5bmMgKCkgPT4geyB0aGlzLnN0ZXBTdWJtaXQoKSB9KVxuICAgIC8vIE9yZGVyIHZlcmlmaWNhdGlvbiBmb3JtLlxuICAgIGJpbmRGb3JtKHBhZ2UudmVyaWZ5Rm9ybSwgcGFnZS52U3VibWl0LCBhc3luYyAoKSA9PiB7IHRoaXMuc3VibWl0T3JkZXIoKSB9KVxuICAgIC8vIENhbmNlbCBvcmRlciBmb3JtLlxuICAgIGJpbmRGb3JtKHBhZ2UuY2FuY2VsRm9ybSwgcGFnZS5jYW5jZWxTdWJtaXQsIGFzeW5jICgpID0+IHsgdGhpcy5zdWJtaXRDYW5jZWwoKSB9KVxuICAgIC8vIE9yZGVyIGRldGFpbCB2aWV3LlxuICAgIERvYy5iaW5kKHBhZ2UudkZlZURldGFpbHMsICdjbGljaycsICgpID0+IHRoaXMuZm9ybXMuc2hvdyhwYWdlLnZEZXRhaWxQYW5lKSlcbiAgICBEb2MuYmluZChwYWdlLmNsb3NlRGV0YWlsUGFuZSwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93VmVyaWZ5Rm9ybSgpKVxuICAgIC8vIC8vIEJpbmQgYWN0aXZlIG9yZGVycyBsaXN0J3MgaGVhZGVyIHNvcnQgZXZlbnRzLlxuICAgIHBhZ2UucmVjZW50TWF0Y2hlc1RhYmxlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW9yZGVyY29sXScpXG4gICAgICAuZm9yRWFjaCgodGg6IEhUTUxFbGVtZW50KSA9PiBiaW5kKFxuICAgICAgICB0aCwgJ2NsaWNrJywgKCkgPT4gc2V0UmVjZW50TWF0Y2hlc1NvcnRDb2wodGguZGF0YXNldC5vcmRlcmNvbCB8fCAnJylcbiAgICAgICkpXG5cbiAgICBjb25zdCBzZXRSZWNlbnRNYXRjaGVzU29ydENvbCA9IChrZXk6IHN0cmluZykgPT4ge1xuICAgICAgLy8gRmlyc3QgdW5zZXQgaGVhZGVyJ3MgY3VycmVudCBzb3J0ZWQgY29sIGNsYXNzZXMuXG4gICAgICB1bnNldFJlY2VudE1hdGNoZXNTb3J0Q29sQ2xhc3NlcygpXG4gICAgICBpZiAodGhpcy5yZWNlbnRNYXRjaGVzU29ydEtleSA9PT0ga2V5KSB7XG4gICAgICAgIHRoaXMucmVjZW50TWF0Y2hlc1NvcnREaXJlY3Rpb24gKj0gLTFcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVjZW50TWF0Y2hlc1NvcnRLZXkgPSBrZXlcbiAgICAgICAgdGhpcy5yZWNlbnRNYXRjaGVzU29ydERpcmVjdGlvbiA9IDFcbiAgICAgIH1cbiAgICAgIHRoaXMucmVmcmVzaFJlY2VudE1hdGNoZXNUYWJsZSgpXG4gICAgICBzZXRSZWNlbnRNYXRjaGVzU29ydENvbENsYXNzZXMoKVxuICAgIH1cblxuICAgIC8vIHNvcnRDbGFzc0J5RGlyZWN0aW9uIHJlY2VpdmVzIGEgc29ydCBkaXJlY3Rpb24gYW5kIHJldHVybiBhIGNsYXNzIGJhc2VkIG9uIGl0LlxuICAgIGNvbnN0IHNvcnRDbGFzc0J5RGlyZWN0aW9uID0gKGVsZW1lbnQ6IDEgfCAtMSkgPT4ge1xuICAgICAgaWYgKGVsZW1lbnQgPT09IDEpIHJldHVybiAnc29ydGVkLWFzYydcbiAgICAgIHJldHVybiAnc29ydGVkLWRzYydcbiAgICB9XG5cbiAgICBjb25zdCB1bnNldFJlY2VudE1hdGNoZXNTb3J0Q29sQ2xhc3NlcyA9ICgpID0+IHtcbiAgICAgIHBhZ2UucmVjZW50TWF0Y2hlc1RhYmxlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW9yZGVyY29sXScpXG4gICAgICAgIC5mb3JFYWNoKHRoID0+IHRoLmNsYXNzTGlzdC5yZW1vdmUoJ3NvcnRlZC1hc2MnLCAnc29ydGVkLWRzYycpKVxuICAgIH1cblxuICAgIGNvbnN0IHNldFJlY2VudE1hdGNoZXNTb3J0Q29sQ2xhc3NlcyA9ICgpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IHRoaXMucmVjZW50TWF0Y2hlc1NvcnRLZXlcbiAgICAgIGNvbnN0IHNvcnRDbHMgPSBzb3J0Q2xhc3NCeURpcmVjdGlvbih0aGlzLnJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uKVxuICAgICAgRG9jLnNhZmVTZWxlY3RvcihwYWdlLnJlY2VudE1hdGNoZXNUYWJsZSwgYFtkYXRhLW9yZGVyY29sPSR7a2V5fV1gKS5jbGFzc0xpc3QuYWRkKHNvcnRDbHMpXG4gICAgfVxuXG4gICAgLy8gU2V0IGRlZmF1bHQncyBzb3J0ZWQgY29sIGhlYWRlciBjbGFzc2VzLlxuICAgIHNldFJlY2VudE1hdGNoZXNTb3J0Q29sQ2xhc3NlcygpXG5cbiAgICBjb25zdCBjbG9zZVBvcHVwcyA9ICgpID0+IHtcbiAgICAgIHRoaXMuZm9ybXMuY2xvc2UoKVxuICAgIH1cblxuICAgIC8vIElmIHRoZSB1c2VyIGNsaWNrcyBvdXRzaWRlIG9mIGEgZm9ybSwgaXQgc2hvdWxkIGNsb3NlIHRoZSBwYWdlIG92ZXJsYXkuXG4gICAgYmluZChwYWdlLmZvcm1zLCAnbW91c2Vkb3duJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmIChEb2MuaXNEaXNwbGF5ZWQocGFnZS52RGV0YWlsUGFuZSkgJiYgIURvYy5tb3VzZUluRWxlbWVudChlLCBwYWdlLnZEZXRhaWxQYW5lKSkgcmV0dXJuIHRoaXMuc2hvd1ZlcmlmeUZvcm0oKVxuICAgICAgaWYgKCFEb2MubW91c2VJbkVsZW1lbnQoZSwgdGhpcy5jdXJyZW50Rm9ybSkpIHtcbiAgICAgICAgY2xvc2VQb3B1cHMoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLmtleXVwID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgY2xvc2VQb3B1cHMoKVxuICAgICAgfVxuICAgIH1cbiAgICBiaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuXG4gICAgcGFnZS5mb3Jtcy5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIERvYy5iaW5kKGVsLCAnY2xpY2snLCAoKSA9PiB7IGNsb3NlUG9wdXBzKCkgfSlcbiAgICB9KVxuXG4gICAgLy8gRXZlbnQgbGlzdGVuZXJzIGZvciBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgdmFyaW91cyBpbnB1dCBmaWVsZHMuXG4gICAgYmluZChwYWdlLmxvdEZpZWxkLCBbJ2NoYW5nZScsICdrZXl1cCddLCAoKSA9PiB7IHRoaXMubG90Q2hhbmdlZCgpIH0pXG4gICAgYmluZChwYWdlLnF0eUZpZWxkLCAnY2hhbmdlJywgKCkgPT4geyB0aGlzLnF1YW50aXR5Q2hhbmdlZCh0cnVlKSB9KVxuICAgIGJpbmQocGFnZS5xdHlGaWVsZCwgJ2tleXVwJywgKCkgPT4geyB0aGlzLnF1YW50aXR5Q2hhbmdlZChmYWxzZSkgfSlcbiAgICBiaW5kKHBhZ2UubWt0QnV5RmllbGQsIFsnY2hhbmdlJywgJ2tleXVwJ10sICgpID0+IHsgdGhpcy5tYXJrZXRCdXlDaGFuZ2VkKCkgfSlcbiAgICBiaW5kKHBhZ2UucmF0ZUZpZWxkLCAnY2hhbmdlJywgKCkgPT4geyB0aGlzLnJhdGVGaWVsZENoYW5nZWQoKSB9KVxuICAgIGJpbmQocGFnZS5yYXRlRmllbGQsICdrZXl1cCcsICgpID0+IHsgdGhpcy5wcmV2aWV3UXVvdGVBbXQodHJ1ZSkgfSlcblxuICAgIC8vIE1hcmtldCBzZWFyY2ggaW5wdXQgYmluZGluZ3MuXG4gICAgYmluZChwYWdlLm1hcmtldFNlYXJjaFYxLCBbJ2NoYW5nZScsICdrZXl1cCddLCAoKSA9PiB7IHRoaXMuZmlsdGVyTWFya2V0cygpIH0pXG5cbiAgICAvLyBBY2tub3dsZWRnZSB0aGUgb3JkZXIgZGlzY2xhaW1lci5cbiAgICBjb25zdCBzZXREaXNjbGFpbWVyQWNrVml6ID0gKGFja2VkOiBib29sZWFuKSA9PiB7XG4gICAgICBEb2Muc2V0VmlzKCFhY2tlZCwgcGFnZS5kaXNjbGFpbWVyLCBwYWdlLmRpc2NsYWltZXJBY2spXG4gICAgICBEb2Muc2V0VmlzKGFja2VkLCBwYWdlLnNob3dEaXNjbGFpbWVyKVxuICAgIH1cbiAgICBiaW5kKHBhZ2UuZGlzY2xhaW1lckFjaywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5vcmRlckRpc2NsYWltZXJBY2tlZExLLCB0cnVlKVxuICAgICAgc2V0RGlzY2xhaW1lckFja1Zpeih0cnVlKVxuICAgIH0pXG4gICAgYmluZChwYWdlLnNob3dEaXNjbGFpbWVyLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLm9yZGVyRGlzY2xhaW1lckFja2VkTEssIGZhbHNlKVxuICAgICAgc2V0RGlzY2xhaW1lckFja1ZpeihmYWxzZSlcbiAgICB9KVxuICAgIHNldERpc2NsYWltZXJBY2tWaXooU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5vcmRlckRpc2NsYWltZXJBY2tlZExLKSlcblxuICAgIGNvbnN0IGNsZWFyQ2hhcnRMaW5lcyA9ICgpID0+IHtcbiAgICAgIHRoaXMuZGVwdGhMaW5lcy5ob3ZlciA9IFtdXG4gICAgICB0aGlzLmRyYXdDaGFydExpbmVzKClcbiAgICB9XG4gICAgYmluZChwYWdlLmJ1eVJvd3MsICdtb3VzZWxlYXZlJywgY2xlYXJDaGFydExpbmVzKVxuICAgIGJpbmQocGFnZS5zZWxsUm93cywgJ21vdXNlbGVhdmUnLCBjbGVhckNoYXJ0TGluZXMpXG4gICAgYmluZChwYWdlLnVzZXJPcmRlcnMsICdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgdGhpcy5hY3RpdmVNYXJrZXJSYXRlID0gbnVsbFxuICAgICAgdGhpcy5zZXREZXB0aE1hcmtlcnMoKVxuICAgIH0pXG5cbiAgICBjb25zdCBzdGF0czAgPSBwYWdlLm1hcmtldFN0YXRzXG4gICAgY29uc3Qgc3RhdHMxID0gc3RhdHMwLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIHN0YXRzMS5jbGFzc0xpc3QuYWRkKCdsaXN0b3BlbicpXG4gICAgRG9jLmhpZGUoc3RhdHMwLCBzdGF0czEpXG4gICAgc3RhdHMxLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKVxuICAgIGFwcCgpLmhlYWRlclNwYWNlLmFwcGVuZENoaWxkKHN0YXRzMSlcbiAgICB0aGlzLnN0YXRzID0gW3sgcm93OiBzdGF0czAsIHRtcGw6IERvYy5wYXJzZVRlbXBsYXRlKHN0YXRzMCkgfSwgeyByb3c6IHN0YXRzMSwgdG1wbDogRG9jLnBhcnNlVGVtcGxhdGUoc3RhdHMxKSB9XVxuXG4gICAgY29uc3QgY2xvc2VNYXJrZXRzTGlzdCA9ICgpID0+IHtcbiAgICAgIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUubGVmdE1hcmtldERvY2tMSywgJzAnKVxuICAgICAgcGFnZS5sZWZ0TWFya2V0RG9jay5jbGFzc0xpc3QucmVtb3ZlKCdkZWZhdWx0JylcbiAgICAgIHBhZ2UubGVmdE1hcmtldERvY2suY2xhc3NMaXN0LmFkZCgnc3Rhc2hlZCcpXG4gICAgICBmb3IgKGNvbnN0IHMgb2YgdGhpcy5zdGF0cykgcy5yb3cuY2xhc3NMaXN0LnJlbW92ZSgnbGlzdG9wZW4nKVxuICAgIH1cbiAgICBjb25zdCBvcGVuTWFya2V0c0xpc3QgPSAoKSA9PiB7XG4gICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmxlZnRNYXJrZXREb2NrTEssICcxJylcbiAgICAgIHBhZ2UubGVmdE1hcmtldERvY2suY2xhc3NMaXN0LnJlbW92ZSgnZGVmYXVsdCcsICdzdGFzaGVkJylcbiAgICAgIGZvciAoY29uc3QgcyBvZiB0aGlzLnN0YXRzKSBzLnJvdy5jbGFzc0xpc3QuYWRkKCdsaXN0b3BlbicpXG4gICAgfVxuICAgIERvYy5iaW5kKHBhZ2UubGVmdEhpZGVyLCAnY2xpY2snLCAoKSA9PiBjbG9zZU1hcmtldHNMaXN0KCkpXG4gICAgRG9jLmJpbmQocGFnZS5tYXJrZXRSZW9wZW5lciwgJ2NsaWNrJywgKCkgPT4gb3Blbk1hcmtldHNMaXN0KCkpXG4gICAgZm9yIChjb25zdCBzIG9mIHRoaXMuc3RhdHMpIHtcbiAgICAgIERvYy5iaW5kKHMudG1wbC5tYXJrZXRTZWxlY3QsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKHBhZ2UubGVmdE1hcmtldERvY2suY2xpZW50V2lkdGggPT09IDApIG9wZW5NYXJrZXRzTGlzdCgpXG4gICAgICAgIGVsc2UgY2xvc2VNYXJrZXRzTGlzdCgpXG4gICAgICB9KVxuICAgIH1cbiAgICB0aGlzLm1hcmtldExpc3QgPSBuZXcgTWFya2V0TGlzdChwYWdlLm1hcmtldExpc3RWMSlcbiAgICAvLyBQcmVwYXJlIHRoZSBsaXN0IG9mIG1hcmtldHMuXG4gICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5tYXJrZXRMaXN0Lm1hcmtldHMpIHtcbiAgICAgIGJpbmQocm93Lm5vZGUsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgLy8gcmV0dXJuIGVhcmx5IGlmIHRoZSBtYXJrZXQgaXMgYWxyZWFkeSBzZXRcbiAgICAgICAgY29uc3QgeyBxdW90ZWlkOiBxdW90ZUlELCBiYXNlaWQ6IGJhc2VJRCwgeGM6IHsgaG9zdCB9IH0gPSByb3cubWt0XG4gICAgICAgIGlmICh0aGlzLm1hcmtldD8uYmFzZT8uaWQgPT09IGJhc2VJRCAmJiB0aGlzLm1hcmtldD8ucXVvdGU/LmlkID09PSBxdW90ZUlEKSByZXR1cm5cbiAgICAgICAgdGhpcy5zdGFydExvYWRpbmdBbmltYXRpb25zKClcbiAgICAgICAgdGhpcy5zZXRNYXJrZXQoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgICAgfSlcbiAgICB9XG4gICAgaWYgKFN0YXRlLmZldGNoTG9jYWwoU3RhdGUubGVmdE1hcmtldERvY2tMSykgIT09ICcxJykgeyAvLyBJdCBpcyBzaG93biBieSBkZWZhdWx0LCBoaWRpbmcgaWYgbmVjZXNzYXJ5LlxuICAgICAgY2xvc2VNYXJrZXRzTGlzdCgpXG4gICAgfVxuXG4gICAgLy8gTm90aWZpY2F0aW9uIGZpbHRlcnMuXG4gICAgYXBwKCkucmVnaXN0ZXJOb3RlRmVlZGVyKHtcbiAgICAgIG9yZGVyOiAobm90ZTogT3JkZXJOb3RlKSA9PiB7IHRoaXMuaGFuZGxlT3JkZXJOb3RlKG5vdGUpIH0sXG4gICAgICBtYXRjaDogKG5vdGU6IE1hdGNoTm90ZSkgPT4geyB0aGlzLmhhbmRsZU1hdGNoTm90ZShub3RlKSB9LFxuICAgICAgZXBvY2g6IChub3RlOiBFcG9jaE5vdGUpID0+IHsgdGhpcy5oYW5kbGVFcG9jaE5vdGUobm90ZSkgfSxcbiAgICAgIGNvbm46IChub3RlOiBDb25uRXZlbnROb3RlKSA9PiB7IHRoaXMuaGFuZGxlQ29ubk5vdGUobm90ZSkgfSxcbiAgICAgIGJhbGFuY2U6IChub3RlOiBCYWxhbmNlTm90ZSkgPT4geyB0aGlzLmhhbmRsZUJhbGFuY2VOb3RlKG5vdGUpIH0sXG4gICAgICBib25kcG9zdDogKG5vdGU6IEJvbmROb3RlKSA9PiB7IHRoaXMuaGFuZGxlQm9uZFVwZGF0ZShub3RlKSB9LFxuICAgICAgc3BvdHM6IChub3RlOiBTcG90UHJpY2VOb3RlKSA9PiB7IHRoaXMuaGFuZGxlUHJpY2VVcGRhdGUobm90ZSkgfSxcbiAgICAgIHdhbGxldHN0YXRlOiAobm90ZTogV2FsbGV0U3RhdGVOb3RlKSA9PiB7IHRoaXMuaGFuZGxlV2FsbGV0U3RhdGUobm90ZSkgfSxcbiAgICAgIHJlcHV0YXRpb246ICgpID0+IHsgdGhpcy51cGRhdGVSZXB1dGF0aW9uKCkgfSxcbiAgICAgIGZlZXBheW1lbnQ6ICgpID0+IHsgdGhpcy51cGRhdGVSZXB1dGF0aW9uKCkgfSxcbiAgICAgIHJ1bnN0YXRzOiAobm90ZTogUnVuU3RhdHNOb3RlKSA9PiB7XG4gICAgICAgIHRoaXMubW0udXBkYXRlKClcbiAgICAgICAgaWYgKG5vdGUuYmFzZUlEICE9PSB0aGlzLm1hcmtldC5iYXNlLmlkIHx8IG5vdGUucXVvdGVJRCAhPT0gdGhpcy5tYXJrZXQucXVvdGUuaWQgfHwgbm90ZS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCkgcmV0dXJuXG4gICAgICAgIGlmIChCb29sZWFuKHRoaXMubW1SdW5uaW5nKSAhPT0gQm9vbGVhbihub3RlLnN0YXRzKSkge1xuICAgICAgICAgIHRoaXMubW1SdW5uaW5nID0gQm9vbGVhbihub3RlLnN0YXRzKVxuICAgICAgICAgIHRoaXMucmVzb2x2ZU9yZGVyRm9ybVZpc2liaWxpdHkoKVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZXBvY2hyZXBvcnQ6IChub3RlOiBFcG9jaFJlcG9ydE5vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUuYmFzZUlEICE9PSB0aGlzLm1hcmtldC5iYXNlLmlkIHx8IG5vdGUucXVvdGVJRCAhPT0gdGhpcy5tYXJrZXQucXVvdGUuaWQgfHwgbm90ZS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCkgcmV0dXJuXG4gICAgICAgIHRoaXMubW0uaGFuZGxlRXBvY2hSZXBvcnROb3RlKG5vdGUpXG4gICAgICB9LFxuICAgICAgY2V4cHJvYmxlbXM6IChub3RlOiBDRVhQcm9ibGVtc05vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUuYmFzZUlEICE9PSB0aGlzLm1hcmtldC5iYXNlLmlkIHx8IG5vdGUucXVvdGVJRCAhPT0gdGhpcy5tYXJrZXQucXVvdGUuaWQgfHwgbm90ZS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCkgcmV0dXJuXG4gICAgICAgIHRoaXMubW0uaGFuZGxlQ2V4UHJvYmxlbXNOb3RlKG5vdGUpXG4gICAgICB9LFxuICAgICAgcnVuZXZlbnQ6IChub3RlOiBSdW5FdmVudE5vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUuYmFzZUlEICE9PSB0aGlzLm1hcmtldC5iYXNlLmlkIHx8IG5vdGUucXVvdGVJRCAhPT0gdGhpcy5tYXJrZXQucXVvdGUuaWQgfHwgbm90ZS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCkgcmV0dXJuXG4gICAgICAgIHRoaXMubW0udXBkYXRlKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5sb2FkaW5nQW5pbWF0aW9ucyA9IHt9XG4gICAgdGhpcy5zdGFydExvYWRpbmdBbmltYXRpb25zKClcblxuICAgIC8vIFN0YXJ0IGEgdGlja2VyIHRvIHVwZGF0ZSB0aW1lLXNpbmNlIHZhbHVlcy5cbiAgICB0aGlzLnNlY29uZFRpY2tlciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IG1vcmQgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLm1ldGFPcmRlcnMpKSB7XG4gICAgICAgIG1vcmQuZGV0YWlscy5hZ2UudGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKG1vcmQub3JkLnN1Ym1pdFRpbWUpXG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IHRkIG9mIERvYy5hcHBseVNlbGVjdG9yKHBhZ2UucmVjZW50TWF0Y2hlc0xpdmVMaXN0LCAnW2RhdGEtdG1wbD1hZ2VdJykpIHtcbiAgICAgICAgdGQudGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKHBhcnNlRmxvYXQodGQuZGF0YXNldC5zaW5jZVN0YW1wID8/ICcwJykpXG4gICAgICB9XG4gICAgfSwgMTAwMClcblxuICAgIHRoaXMuaW5pdChwYWdlUGFyYW1zKVxuICB9XG5cbiAgYXN5bmMgaW5pdCAocGFnZVBhcmFtcz86IE1hcmtldHNQYWdlUGFyYW1zKSB7XG4gICAgLy8gRmV0Y2ggdGhlIGZpcnN0IG1hcmtldCBpbiB0aGUgbGlzdCwgb3IgdGhlIHVzZXJzIGxhc3Qgc2VsZWN0ZWQgbWFya2V0LCBpZlxuICAgIC8vIGl0IGV4aXN0cy5cbiAgICBsZXQgc2VsZWN0ZWRcbiAgICBpZiAocGFnZVBhcmFtcz8uaG9zdCkge1xuICAgICAgc2VsZWN0ZWQgPSBtYWtlTWFya2V0KHBhZ2VQYXJhbXMuaG9zdCwgcGFyc2VJbnQocGFnZVBhcmFtcy5iYXNlSUQpLCBwYXJzZUludChwYWdlUGFyYW1zLnF1b3RlSUQpKVxuICAgIH0gZWxzZSB7XG4gICAgICBzZWxlY3RlZCA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUubGFzdE1hcmtldExLKVxuICAgIH1cbiAgICBpZiAoIXNlbGVjdGVkIHx8ICF0aGlzLm1hcmtldExpc3QuZXhpc3RzKHNlbGVjdGVkLmhvc3QsIHNlbGVjdGVkLmJhc2UsIHNlbGVjdGVkLnF1b3RlKSkge1xuICAgICAgY29uc3QgZmlyc3QgPSB0aGlzLm1hcmtldExpc3QuZmlyc3QoKVxuICAgICAgaWYgKGZpcnN0KSBzZWxlY3RlZCA9IHsgaG9zdDogZmlyc3QubWt0LnhjLmhvc3QsIGJhc2U6IGZpcnN0Lm1rdC5iYXNlaWQsIHF1b3RlOiBmaXJzdC5ta3QucXVvdGVpZCB9XG4gICAgfVxuICAgIGlmIChzZWxlY3RlZCkgdGhpcy5zZXRNYXJrZXQoc2VsZWN0ZWQuaG9zdCwgc2VsZWN0ZWQuYmFzZSwgc2VsZWN0ZWQucXVvdGUpXG4gICAgZWxzZSB0aGlzLmJhbGFuY2VXZ3Quc2V0QmFsYW5jZVZpc2liaWxpdHkoZmFsc2UpIC8vIG5vIG1hcmtldCB0byBkaXNwbGF5IGJhbGFuY2Ugd2lkZ2V0IGZvci5cblxuICAgIC8vIHNldCB0aGUgaW5pdGlhbCBzdGF0ZSBmb3IgdGhlIHJlZ2lzdHJhdGlvbiBzdGF0dXNcbiAgICB0aGlzLnNldFJlZ2lzdHJhdGlvblN0YXR1c1Zpc2liaWxpdHkoKVxuICB9XG5cbiAgc3RhcnRMb2FkaW5nQW5pbWF0aW9ucyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBsb2FkaW5nQW5pbWF0aW9uczogYW5pcywgZGVwdGhDaGFydCwgY2FuZGxlQ2hhcnQgfSA9IHRoaXNcbiAgICBkZXB0aENoYXJ0LmNhbnZhcy5jbGFzc0xpc3QuYWRkKCdpbnZpc2libGUnKVxuICAgIGNhbmRsZUNoYXJ0LmNhbnZhcy5jbGFzc0xpc3QuYWRkKCdpbnZpc2libGUnKVxuICAgIGlmIChhbmlzLmNhbmRsZXMpIGFuaXMuY2FuZGxlcy5zdG9wKClcbiAgICBhbmlzLmNhbmRsZXMgPSBuZXcgV2F2ZShwYWdlLmNhbmRsZXNDaGFydCwgeyBtZXNzYWdlOiBpbnRsLnByZXAoaW50bC5JRF9DQU5ETEVTX0xPQURJTkcpIH0pXG4gICAgaWYgKGFuaXMuZGVwdGgpIGFuaXMuZGVwdGguc3RvcCgpXG4gICAgYW5pcy5kZXB0aCA9IG5ldyBXYXZlKHBhZ2UuZGVwdGhDaGFydCwgeyBtZXNzYWdlOiBpbnRsLnByZXAoaW50bC5JRF9ERVBUSF9MT0FESU5HKSB9KVxuICB9XG5cbiAgLyogaXNTZWxsIGlzIHRydWUgaWYgdGhlIHVzZXIgaGFzIHNlbGVjdGVkIHNlbGwgaW4gdGhlIG9yZGVyIG9wdGlvbnMuICovXG4gIGlzU2VsbCAoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFnZS5zZWxsQnR0bi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJylcbiAgfVxuXG4gIC8qIGlzTGltaXQgaXMgdHJ1ZSBpZiB0aGUgdXNlciBoYXMgc2VsZWN0ZWQgdGhlIFwibGltaXQgb3JkZXJcIiB0YWIuICovXG4gIGlzTGltaXQgKCkge1xuICAgIHJldHVybiB0aGlzLnBhZ2UubGltaXRCdHRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKVxuICB9XG5cbiAgc2V0QnV5ICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBzd2FwQnR0bnMocGFnZS5zZWxsQnR0biwgcGFnZS5idXlCdHRuKVxuICAgIHBhZ2Uuc3VibWl0QnR0bi5jbGFzc0xpc3QucmVtb3ZlKHNlbGxCdG5DbGFzcylcbiAgICBwYWdlLnN1Ym1pdEJ0dG4uY2xhc3NMaXN0LmFkZChidXlCdG5DbGFzcylcbiAgICBwYWdlLm1heExibC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0JVWSlcbiAgICB0aGlzLnNldE9yZGVyQnR0blRleHQoKVxuICAgIHRoaXMuc2V0T3JkZXJWaXNpYmlsaXR5KClcbiAgICB0aGlzLmRyYXdDaGFydExpbmVzKClcbiAgICBpZiAoIXRoaXMuaXNMaW1pdCgpKSB7XG4gICAgICB0aGlzLm1hcmtldEJ1eUNoYW5nZWQoKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmN1cnJlbnRPcmRlciA9IHRoaXMucGFyc2VPcmRlcigpXG4gICAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgICB9XG4gIH1cblxuICBzZXRTZWxsICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBzd2FwQnR0bnMocGFnZS5idXlCdHRuLCBwYWdlLnNlbGxCdHRuKVxuICAgIHBhZ2Uuc3VibWl0QnR0bi5jbGFzc0xpc3QuYWRkKHNlbGxCdG5DbGFzcylcbiAgICBwYWdlLnN1Ym1pdEJ0dG4uY2xhc3NMaXN0LnJlbW92ZShidXlCdG5DbGFzcylcbiAgICBwYWdlLm1heExibC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1NFTEwpXG4gICAgdGhpcy5zZXRPcmRlckJ0dG5UZXh0KClcbiAgICB0aGlzLnNldE9yZGVyVmlzaWJpbGl0eSgpXG4gICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgdGhpcy5jdXJyZW50T3JkZXIgPSB0aGlzLnBhcnNlT3JkZXIoKVxuICAgIHRoaXMudXBkYXRlT3JkZXJCdHRuU3RhdGUoKVxuICB9XG5cbiAgLyogaGFzUGVuZGluZ0JvbmRzIGlzIHRydWUgaWYgdGhlcmUgYXJlIHBlbmRpbmcgYm9uZHMgKi9cbiAgaGFzUGVuZGluZ0JvbmRzICgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5tYXJrZXQuZGV4LmF1dGgucGVuZGluZ0JvbmRzIHx8IFtdKS5sZW5ndGggPiAwXG4gIH1cblxuICAvKiBzZXRDdXJyTWFya2V0UHJpY2UgdXBkYXRlcyB0aGUgY3VycmVudCBtYXJrZXQgcHJpY2Ugb24gdGhlIHN0YXRzIGRpc3BsYXlzXG4gICAgIGFuZCB0aGUgb3JkZXJib29rIGRpc3BsYXkuICovXG4gIHNldEN1cnJNYXJrZXRQcmljZSAoKTogdm9pZCB7XG4gICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLm1hcmtldFxuICAgIGlmICghc2VsZWN0ZWQpIHJldHVyblxuICAgIC8vIEdldCBhbiB1cC10by1kYXRlIE1hcmtldC5cbiAgICBjb25zdCB4YyA9IGFwcCgpLmV4Y2hhbmdlc1tzZWxlY3RlZC5kZXguaG9zdF1cbiAgICBjb25zdCBta3QgPSB4Yy5tYXJrZXRzW3NlbGVjdGVkLmNmZy5uYW1lXVxuICAgIGlmICghbWt0LnNwb3QpIHJldHVyblxuXG4gICAgZm9yIChjb25zdCBzIG9mIHRoaXMuc3RhdHMpIHtcbiAgICAgIGNvbnN0IHsgdW5pdEluZm86IHsgY29udmVudGlvbmFsOiB7IGNvbnZlcnNpb25GYWN0b3I6IGNGYWN0b3IsIHVuaXQgfSB9IH0gPSB4Yy5hc3NldHNbbWt0LmJhc2VpZF1cbiAgICAgIGNvbnN0IGZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW21rdC5iYXNlaWRdXG4gICAgICBpZiAoZmlhdFJhdGUpIHtcbiAgICAgICAgcy50bXBsLnZvbHVtZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhta3Quc3BvdC52b2wyNCAvIGNGYWN0b3IgKiBmaWF0UmF0ZSlcbiAgICAgICAgcy50bXBsLnZvbFVuaXQudGV4dENvbnRlbnQgPSAnVVNEJ1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcy50bXBsLnZvbHVtZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhta3Quc3BvdC52b2wyNCAvIGNGYWN0b3IpXG4gICAgICAgIHMudG1wbC52b2xVbml0LnRleHRDb250ZW50ID0gdW5pdFxuICAgICAgfVxuICAgICAgc2V0UHJpY2VBbmRDaGFuZ2Uocy50bXBsLCB4YywgbWt0KVxuICAgIH1cblxuICAgIHRoaXMucGFnZS5vYlByaWNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKG1rdC5zcG90LnJhdGUgLyB0aGlzLm1hcmtldC5yYXRlQ29udmVyc2lvbkZhY3RvcilcbiAgICB0aGlzLnBhZ2Uub2JQcmljZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxsY29sb3InLCAnYnV5Y29sb3InKVxuICAgIHRoaXMucGFnZS5vYlByaWNlLmNsYXNzTGlzdC5hZGQobWt0LnNwb3QuY2hhbmdlMjQgPj0gMCA/ICdidXljb2xvcicgOiAnc2VsbGNvbG9yJylcbiAgICBEb2Muc2V0VmlzKG1rdC5zcG90LmNoYW5nZTI0ID49IDAsIHRoaXMucGFnZS5vYlVwKVxuICAgIERvYy5zZXRWaXMobWt0LnNwb3QuY2hhbmdlMjQgPCAwLCB0aGlzLnBhZ2Uub2JEb3duKVxuICB9XG5cbiAgLyogc2V0TWFya2V0RGV0YWlscyB1cGRhdGVzIHRoZSBjdXJyZW5jeSBuYW1lcyBvbiB0aGUgc3RhdHMgZGlzcGxheXMuICovXG4gIHNldE1hcmtldERldGFpbHMgKCkge1xuICAgIGlmICghdGhpcy5tYXJrZXQpIHJldHVyblxuICAgIGZvciAoY29uc3QgcyBvZiB0aGlzLnN0YXRzKSB7XG4gICAgICBjb25zdCB7IGJhc2VDZmc6IGJhLCBxdW90ZUNmZzogcWEgfSA9IHRoaXMubWFya2V0XG4gICAgICBzLnRtcGwuYmFzZUljb24uc3JjID0gRG9jLmxvZ29QYXRoKGJhLnN5bWJvbClcbiAgICAgIHMudG1wbC5xdW90ZUljb24uc3JjID0gRG9jLmxvZ29QYXRoKHFhLnN5bWJvbClcbiAgICAgIERvYy5lbXB0eShzLnRtcGwuYmFzZVN5bWJvbCwgcy50bXBsLnF1b3RlU3ltYm9sKVxuICAgICAgcy50bXBsLmJhc2VTeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShiYSwgdHJ1ZSkpXG4gICAgICBzLnRtcGwucXVvdGVTeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShxYSwgdHJ1ZSkpXG4gICAgfVxuICB9XG5cbiAgLyogc2V0SGlnaExvdyBjYWxjdWxhdGVzIHRoZSBoaWdoIGFuZCBsb3cgcmF0ZXMgb3ZlciB0aGUgbGFzdCAyNCBob3Vycy4gKi9cbiAgc2V0SGlnaExvdyAoKSB7XG4gICAgbGV0IFtoaWdoLCBsb3ddID0gWzAsIDBdXG4gICAgY29uc3Qgc3BvdCA9IHRoaXMubWFya2V0LmNmZy5zcG90XG4gICAgLy8gVXNlIHNwb3QgdmFsdWVzIGZvciAyNCBob3VycyBoaWdoIGFuZCBsb3cgcmF0ZXMgaWYgaXQgaXMgYXZhaWxhYmxlLiBXZVxuICAgIC8vIHdpbGwgZGVmYXVsdCB0byBzZXR0aW5nIGl0IGZyb20gY2FuZGxlcyBpZiBpdCdzIG5vdC5cbiAgICBpZiAoc3BvdCAmJiBzcG90LmxvdzI0ICYmIHNwb3QuaGlnaDI0KSB7XG4gICAgICBoaWdoID0gc3BvdC5oaWdoMjRcbiAgICAgIGxvdyA9IHNwb3QubG93MjRcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLm1hcmtldD8uY2FuZGxlQ2FjaGVzW2ZpdmVNaW5CaW5LZXldXG4gICAgICBpZiAoIWNhY2hlKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbmRsZUR1ciAhPT0gZml2ZU1pbkJpbktleSkge1xuICAgICAgICAgIHRoaXMucmVxdWVzdENhbmRsZXMoZml2ZU1pbkJpbktleSlcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHMgb2YgdGhpcy5zdGF0cykge1xuICAgICAgICAgIHMudG1wbC5oaWdoLnRleHRDb250ZW50ID0gJy0nXG4gICAgICAgICAgcy50bXBsLmxvdy50ZXh0Q29udGVudCA9ICctJ1xuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICAvLyBTZXQgaGlnaCBhbmQgbG93IHJhdGVzIGZyb20gY2FuZGxlcy5cbiAgICAgIGNvbnN0IGFEYXlBZ28gPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIDg2NDAwMDAwXG4gICAgICBmb3IgKGxldCBpID0gY2FjaGUuY2FuZGxlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICBjb25zdCBjID0gY2FjaGUuY2FuZGxlc1tpXVxuICAgICAgICBpZiAoYy5lbmRTdGFtcCA8IGFEYXlBZ28pIGJyZWFrXG4gICAgICAgIGlmIChsb3cgPT09IDAgfHwgKGMubG93UmF0ZSA+IDAgJiYgYy5sb3dSYXRlIDwgbG93KSkgbG93ID0gYy5sb3dSYXRlXG4gICAgICAgIGlmIChjLmhpZ2hSYXRlID4gaGlnaCkgaGlnaCA9IGMuaGlnaFJhdGVcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBiYXNlSUQgPSB0aGlzLm1hcmtldC5iYXNlLmlkXG4gICAgY29uc3QgcXVvdGVJRCA9IHRoaXMubWFya2V0LnF1b3RlLmlkXG4gICAgY29uc3QgZGV4ID0gdGhpcy5tYXJrZXQuZGV4XG4gICAgZm9yIChjb25zdCBzIG9mIHRoaXMuc3RhdHMpIHtcbiAgICAgIHMudG1wbC5oaWdoLnRleHRDb250ZW50ID0gaGlnaCA+IDAgPyBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIGhpZ2gsIGRleCkpIDogJy0nXG4gICAgICBzLnRtcGwubG93LnRleHRDb250ZW50ID0gbG93ID4gMCA/IERvYy5mb3JtYXRGb3VyU2lnRmlncyhhcHAoKS5jb252ZW50aW9uYWxSYXRlKGJhc2VJRCwgcXVvdGVJRCwgbG93LCBkZXgpKSA6ICctJ1xuICAgIH1cbiAgfVxuXG4gIC8qIGFzc2V0c0FyZVN1cHBvcnRlZCBpcyB0cnVlIGlmIGFsbCB0aGUgYXNzZXRzIG9mIHRoZSBjdXJyZW50IG1hcmtldCBhcmVcbiAgICogc3VwcG9ydGVkXG4gICAqL1xuICBhc3NldHNBcmVTdXBwb3J0ZWQgKCk6IHtcbiAgICBpc1N1cHBvcnRlZDogYm9vbGVhbjtcbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgfSB7XG4gICAgY29uc3QgeyBtYXJrZXQ6IHsgYmFzZSwgcXVvdGUsIGJhc2VDZmcsIHF1b3RlQ2ZnIH0gfSA9IHRoaXNcbiAgICBpZiAoIWJhc2UgfHwgIXF1b3RlKSB7XG4gICAgICBjb25zdCBzeW1ib2wgPSBiYXNlID8gcXVvdGVDZmcuc3ltYm9sIDogYmFzZUNmZy5zeW1ib2xcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzU3VwcG9ydGVkOiBmYWxzZSxcbiAgICAgICAgdGV4dDogaW50bC5wcmVwKGludGwuSURfTk9UX1NVUFBPUlRFRCwgeyBhc3NldDogc3ltYm9sLnRvVXBwZXJDYXNlKCkgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gY2hlY2sgaWYgdmVyc2lvbnMgYXJlIHN1cHBvcnRlZC4gSWYgYXNzZXQgaXMgYSB0b2tlbiwgd2UgY2hlY2sgaWYgaXRzXG4gICAgLy8gcGFyZW50IHN1cHBvcnRzIHRoZSB2ZXJzaW9uLlxuICAgIGNvbnN0IGJWZXJzID0gKGJhc2UudG9rZW4gPyBhcHAoKS5hc3NldHNbYmFzZS50b2tlbi5wYXJlbnRJRF0uaW5mbz8udmVyc2lvbnMgOiBiYXNlLmluZm8/LnZlcnNpb25zKSBhcyBudW1iZXJbXVxuICAgIGNvbnN0IHFWZXJzID0gKHF1b3RlLnRva2VuID8gYXBwKCkuYXNzZXRzW3F1b3RlLnRva2VuLnBhcmVudElEXS5pbmZvPy52ZXJzaW9ucyA6IHF1b3RlLmluZm8/LnZlcnNpb25zKSBhcyBudW1iZXJbXVxuICAgIC8vIGlmIG5vbmUgdGhlbSBhcmUgdG9rZW4sIGp1c3QgY2hlY2sgaWYgb3duIGFzc2V0IGlzIHN1cHBvcnRlZC5cbiAgICBsZXQgdGV4dCA9ICcnXG4gICAgaWYgKCFiVmVycy5pbmNsdWRlcyhiYXNlQ2ZnLnZlcnNpb24pKSB7XG4gICAgICB0ZXh0ID0gaW50bC5wcmVwKGludGwuSURfVkVSU0lPTl9OT1RfU1VQUE9SVEVELCB7IGFzc2V0OiBiYXNlLnN5bWJvbC50b1VwcGVyQ2FzZSgpLCB2ZXJzaW9uOiBiYXNlQ2ZnLnZlcnNpb24gKyAnJyB9KVxuICAgIH0gZWxzZSBpZiAoIXFWZXJzLmluY2x1ZGVzKHF1b3RlQ2ZnLnZlcnNpb24pKSB7XG4gICAgICB0ZXh0ID0gaW50bC5wcmVwKGludGwuSURfVkVSU0lPTl9OT1RfU1VQUE9SVEVELCB7IGFzc2V0OiBxdW90ZS5zeW1ib2wudG9VcHBlckNhc2UoKSwgdmVyc2lvbjogcXVvdGVDZmcudmVyc2lvbiArICcnIH0pXG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBpc1N1cHBvcnRlZDogYlZlcnMuaW5jbHVkZXMoYmFzZUNmZy52ZXJzaW9uKSAmJiBxVmVycy5pbmNsdWRlcyhxdW90ZUNmZy52ZXJzaW9uKSxcbiAgICAgIHRleHRcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBzZXRPcmRlclZpc2liaWxpdHkgc2V0cyB3aGljaCBmb3JtIGlzIHZpc2libGUgYmFzZWQgb24gdGhlIHNwZWNpZmllZFxuICAgKiBvcHRpb25zLlxuICAgKi9cbiAgc2V0T3JkZXJWaXNpYmlsaXR5ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgaWYgKHRoaXMuaXNMaW1pdCgpKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnByaWNlQm94LCBwYWdlLnRpZkJveCwgcGFnZS5xdHlCb3gsIHBhZ2UubWF4Qm94KVxuICAgICAgRG9jLmhpZGUocGFnZS5ta3RCdXlCb3gpXG4gICAgICB0aGlzLnByZXZpZXdRdW90ZUFtdCh0cnVlKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnRpZkJveCwgcGFnZS5tYXhCb3gsIHBhZ2UucHJpY2VCb3gpXG4gICAgICBpZiAodGhpcy5pc1NlbGwoKSkge1xuICAgICAgICBEb2MuaGlkZShwYWdlLm1rdEJ1eUJveClcbiAgICAgICAgRG9jLnNob3cocGFnZS5xdHlCb3gpXG4gICAgICAgIHRoaXMucHJldmlld1F1b3RlQW10KHRydWUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLm1rdEJ1eUJveClcbiAgICAgICAgRG9jLmhpZGUocGFnZS5xdHlCb3gpXG4gICAgICAgIHRoaXMucHJldmlld1F1b3RlQW10KGZhbHNlKVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgfVxuXG4gIC8qIHJlc29sdmVPcmRlckZvcm1WaXNpYmlsaXR5IGRpc3BsYXlzIG9yIGhpZGVzIHRoZSAnb3JkZXJGb3JtJyBiYXNlZCBvblxuICAgKiBhIHNldCBvZiBjb25kaXRpb25zIHRvIGJlIG1ldC5cbiAgICovXG4gIGFzeW5jIHJlc29sdmVPcmRlckZvcm1WaXNpYmlsaXR5ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG5cbiAgICBjb25zdCBzaG93T3JkZXJGb3JtID0gYXN5bmMgKCkgOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgIGlmICghdGhpcy5hc3NldHNBcmVTdXBwb3J0ZWQoKS5pc1N1cHBvcnRlZCkgcmV0dXJuIGZhbHNlIC8vIGFzc2V0cyBub3Qgc3VwcG9ydGVkXG5cbiAgICAgIGlmICghdGhpcy5tYXJrZXQgfHwgdGhpcy5tYXJrZXQuZGV4LmF1dGguZWZmZWN0aXZlVGllciA8IDEpIHJldHVybiBmYWxzZS8vIGFjY3Qgc3VzcGVuZGVkIG9yIG5vdCByZWdpc3RlcmVkXG5cbiAgICAgIGNvbnN0IHsgYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMsIHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1cyB9ID0gdGhpcy50b2tlbkFzc2V0QXBwcm92YWxTdGF0dXNlcygpXG4gICAgICBpZiAoYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMgIT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkIHx8IHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1cyAhPT0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWQpIHJldHVybiBmYWxzZVxuXG4gICAgICBjb25zdCB7IGJhc2UsIHF1b3RlIH0gPSB0aGlzLm1hcmtldFxuICAgICAgY29uc3QgaGFzV2FsbGV0cyA9IGJhc2UgJiYgYXBwKCkuYXNzZXRzW2Jhc2UuaWRdLndhbGxldCAmJiBxdW90ZSAmJiBhcHAoKS5hc3NldHNbcXVvdGUuaWRdLndhbGxldFxuICAgICAgaWYgKCFoYXNXYWxsZXRzKSByZXR1cm4gZmFsc2VcbiAgICAgIGlmICh0aGlzLm1tUnVubmluZykgcmV0dXJuIGZhbHNlXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIERvYy5zZXRWaXMoYXdhaXQgc2hvd09yZGVyRm9ybSgpLCBwYWdlLm9yZGVyRm9ybSwgcGFnZS5vcmRlclR5cGVCdHRucylcblxuICAgIGlmICh0aGlzLm1hcmtldCkge1xuICAgICAgY29uc3QgeyBhdXRoOiB7IGVmZmVjdGl2ZVRpZXIsIHBlbmRpbmdTdHJlbmd0aCB9IH0gPSB0aGlzLm1hcmtldC5kZXhcbiAgICAgIERvYy5zZXRWaXMoZWZmZWN0aXZlVGllciA+IDAgfHwgcGVuZGluZ1N0cmVuZ3RoID4gMCwgcGFnZS5yZXB1dGF0aW9uQW5kVHJhZGluZ1RpZXJCb3gpXG4gICAgfVxuXG4gICAgY29uc3QgbW1TdGF0dXMgPSBhcHAoKS5tbVN0YXR1c1xuICAgIGlmIChtbVN0YXR1cyAmJiB0aGlzLm1tUnVubmluZyA9PT0gdW5kZWZpbmVkICYmIHRoaXMubWFya2V0LmJhc2UgJiYgdGhpcy5tYXJrZXQucXVvdGUpIHtcbiAgICAgIGNvbnN0IHsgYmFzZTogeyBpZDogYmFzZUlEIH0sIHF1b3RlOiB7IGlkOiBxdW90ZUlEIH0sIGRleDogeyBob3N0IH0gfSA9IHRoaXMubWFya2V0XG4gICAgICBjb25zdCBib3RTdGF0dXMgPSBtbVN0YXR1cy5ib3RzLmZpbmQoKHsgY29uZmlnOiBjZmcgfSkgPT4gY2ZnLmJhc2VJRCA9PT0gYmFzZUlEICYmIGNmZy5xdW90ZUlEID09PSBxdW90ZUlEICYmIGNmZy5ob3N0ID09PSBob3N0KVxuICAgICAgdGhpcy5tbVJ1bm5pbmcgPSBCb29sZWFuKGJvdFN0YXR1cz8ucnVubmluZylcbiAgICB9XG5cbiAgICBEb2Muc2V0VmlzKHRoaXMubW1SdW5uaW5nLCBwYWdlLm1tUnVubmluZylcbiAgICBpZiAodGhpcy5tbVJ1bm5pbmcpIERvYy5oaWRlKHBhZ2Uub3JkZXJGb3JtLCBwYWdlLm9yZGVyVHlwZUJ0dG5zKVxuICB9XG5cbiAgLyogc2V0TG9hZGVyTXNnVmlzaWJpbGl0eSBkaXNwbGF5cyBhIG1lc3NhZ2UgaW4gY2FzZSBhIGRleCBhc3NldCBpcyBub3RcbiAgICogc3VwcG9ydGVkXG4gICAqL1xuICBzZXRMb2FkZXJNc2dWaXNpYmlsaXR5ICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcblxuICAgIGNvbnN0IHsgaXNTdXBwb3J0ZWQsIHRleHQgfSA9IHRoaXMuYXNzZXRzQXJlU3VwcG9ydGVkKClcbiAgICBpZiAoaXNTdXBwb3J0ZWQpIHtcbiAgICAgIC8vIG1ha2Ugc3VyZSB0byBoaWRlIHRoZSBsb2FkZXIgbXNnXG4gICAgICBEb2MuaGlkZShwYWdlLmxvYWRlck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwYWdlLmxvYWRlck1zZy50ZXh0Q29udGVudCA9IHRleHRcbiAgICBEb2Muc2hvdyhwYWdlLmxvYWRlck1zZylcbiAgICBEb2MuaGlkZShwYWdlLm5vdFJlZ2lzdGVyZWQpXG4gICAgRG9jLmhpZGUocGFnZS5ub1dhbGxldClcbiAgfVxuXG4gIC8qXG4gICAqIHNob3dUb2tlbkFwcHJvdmFsRm9ybSBkaXNwbGF5cyB0aGUgZm9ybSB1c2VkIHRvIGdpdmUgYWxsb3dhbmNlIHRvIHRoZVxuICAgKiBzd2FwIGNvbnRyYWN0IG9mIGEgdG9rZW4uXG4gICAqL1xuICBhc3luYyBzaG93VG9rZW5BcHByb3ZhbEZvcm0gKGlzQmFzZTogYm9vbGVhbikge1xuICAgIGNvbnN0IGFzc2V0SUQgPSBpc0Jhc2UgPyB0aGlzLm1hcmtldC5iYXNlLmlkIDogdGhpcy5tYXJrZXQucXVvdGUuaWRcbiAgICB0aGlzLmFwcHJvdmVUb2tlbkZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGhpcy5tYXJrZXQuZGV4Lmhvc3QpXG4gICAgdGhpcy5mb3Jtcy5zaG93KHRoaXMucGFnZS5hcHByb3ZlVG9rZW5Gb3JtKVxuICB9XG5cbiAgLypcbiAgICogdG9rZW5Bc3NldEFwcHJvdmFsU3RhdHVzZXMgcmV0dXJucyB0aGUgYXBwcm92YWwgc3RhdHVzIG9mIHRoZSBiYXNlIGFuZFxuICAgKiBxdW90ZSBhc3NldHMuIElmIHRoZSBhc3NldCBpcyBub3QgYSB0b2tlbiwgaXQgaXMgY29uc2lkZXJlZCBhcHByb3ZlZC5cbiAgICovXG4gIHRva2VuQXNzZXRBcHByb3ZhbFN0YXR1c2VzICgpOiB7XG4gICAgYmFzZUFzc2V0QXBwcm92YWxTdGF0dXM6IEFwcHJvdmFsU3RhdHVzO1xuICAgIHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1czogQXBwcm92YWxTdGF0dXM7XG4gICAgfSB7XG4gICAgY29uc3QgeyBtYXJrZXQ6IHsgYmFzZSwgcXVvdGUgfSB9ID0gdGhpc1xuICAgIGxldCBiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyA9IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkXG4gICAgbGV0IHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1cyA9IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkXG5cbiAgICBpZiAoYmFzZT8udG9rZW4pIHtcbiAgICAgIGNvbnN0IGJhc2VBc3NldCA9IGFwcCgpLmFzc2V0c1tiYXNlLmlkXVxuICAgICAgY29uc3QgYmFzZVZlcnNpb24gPSB0aGlzLm1hcmtldC5kZXguYXNzZXRzW2Jhc2UuaWRdLnZlcnNpb25cbiAgICAgIGlmIChiYXNlQXNzZXQ/LndhbGxldD8uYXBwcm92ZWQgJiYgYmFzZUFzc2V0LndhbGxldC5hcHByb3ZlZFtiYXNlVmVyc2lvbl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyA9IGJhc2VBc3NldC53YWxsZXQuYXBwcm92ZWRbYmFzZVZlcnNpb25dXG4gICAgICB9XG4gICAgfVxuICAgIGlmIChxdW90ZT8udG9rZW4pIHtcbiAgICAgIGNvbnN0IHF1b3RlQXNzZXQgPSBhcHAoKS5hc3NldHNbcXVvdGUuaWRdXG4gICAgICBjb25zdCBxdW90ZVZlcnNpb24gPSB0aGlzLm1hcmtldC5kZXguYXNzZXRzW3F1b3RlLmlkXS52ZXJzaW9uXG4gICAgICBpZiAocXVvdGVBc3NldD8ud2FsbGV0Py5hcHByb3ZlZCAmJiBxdW90ZUFzc2V0LndhbGxldC5hcHByb3ZlZFtxdW90ZVZlcnNpb25dICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID0gcXVvdGVBc3NldC53YWxsZXQuYXBwcm92ZWRbcXVvdGVWZXJzaW9uXVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyxcbiAgICAgIHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1c1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIHNldFRva2VuQXBwcm92YWxWaXNpYmlsaXR5IHNldHMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIHRva2VuIGFwcHJvdmFsXG4gICAqIHBhbmVsIGVsZW1lbnRzLlxuICAgKi9cbiAgc2V0VG9rZW5BcHByb3ZhbFZpc2liaWxpdHkgKCkge1xuICAgIGNvbnN0IHsgcGFnZSB9ID0gdGhpc1xuXG4gICAgY29uc3QgeyBiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cywgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzIH0gPSB0aGlzLnRva2VuQXNzZXRBcHByb3ZhbFN0YXR1c2VzKClcblxuICAgIGlmIChiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyA9PT0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWQgJiYgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID09PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCkge1xuICAgICAgRG9jLmhpZGUocGFnZS50b2tlbkFwcHJvdmFsKVxuICAgICAgcGFnZS5zZWxsQnR0bi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcbiAgICAgIHBhZ2UuYnV5QnR0bi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmIChiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyAhPT0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWQgJiYgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID09PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCkge1xuICAgICAgcGFnZS5zZWxsQnR0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJylcbiAgICAgIHBhZ2UuYnV5QnR0bi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcbiAgICAgIHRoaXMuc2V0QnV5KClcbiAgICAgIERvYy5zaG93KHBhZ2UuYXBwcm92YWxSZXF1aXJlZFNlbGwpXG4gICAgICBEb2MuaGlkZShwYWdlLmFwcHJvdmFsUmVxdWlyZWRCdXksIHBhZ2UuYXBwcm92YWxSZXF1aXJlZEJvdGgpXG4gICAgfVxuXG4gICAgaWYgKGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzID09PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCAmJiBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgIT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkKSB7XG4gICAgICBwYWdlLmJ1eUJ0dG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpXG4gICAgICBwYWdlLnNlbGxCdHRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxuICAgICAgdGhpcy5zZXRTZWxsKClcbiAgICAgIERvYy5zaG93KHBhZ2UuYXBwcm92YWxSZXF1aXJlZEJ1eSlcbiAgICAgIERvYy5oaWRlKHBhZ2UuYXBwcm92YWxSZXF1aXJlZFNlbGwsIHBhZ2UuYXBwcm92YWxSZXF1aXJlZEJvdGgpXG4gICAgfVxuXG4gICAgLy8gSWYgdGhleSBhcmUgYm90aCB1bmFwcHJvdmVkIHRva2VucywgdGhlIG9yZGVyIGZvcm0gd2lsbCBub3QgYmUgc2hvd24uXG4gICAgaWYgKGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzICE9PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCAmJiBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgIT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLmFwcHJvdmFsUmVxdWlyZWRCb3RoKVxuICAgICAgRG9jLmhpZGUocGFnZS5hcHByb3ZhbFJlcXVpcmVkU2VsbCwgcGFnZS5hcHByb3ZhbFJlcXVpcmVkQnV5KVxuICAgIH1cblxuICAgIERvYy5zaG93KHBhZ2UudG9rZW5BcHByb3ZhbClcbiAgICBwYWdlLmFwcHJvdmFsUGVuZGluZ0Jhc2VTeW1ib2wudGV4dENvbnRlbnQgPSBwYWdlLmJhc2VUb2tlbkFzc2V0LnRleHRDb250ZW50ID0gdGhpcy5tYXJrZXQuYmFzZS5zeW1ib2wudG9VcHBlckNhc2UoKVxuICAgIHBhZ2UuYXBwcm92YWxQZW5kaW5nUXVvdGVTeW1ib2wudGV4dENvbnRlbnQgPSBwYWdlLnF1b3RlVG9rZW5Bc3NldC50ZXh0Q29udGVudCA9IHRoaXMubWFya2V0LnF1b3RlLnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgRG9jLnNldFZpcyhiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyA9PT0gQXBwcm92YWxTdGF0dXMuTm90QXBwcm92ZWQsIHBhZ2UuYXBwcm92ZUJhc2VCdHRuKVxuICAgIERvYy5zZXRWaXMocXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID09PSBBcHByb3ZhbFN0YXR1cy5Ob3RBcHByb3ZlZCwgcGFnZS5hcHByb3ZlUXVvdGVCdHRuKVxuICAgIERvYy5zZXRWaXMoYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMgPT09IEFwcHJvdmFsU3RhdHVzLlBlbmRpbmcsIHBhZ2UuYXBwcm92YWxQZW5kaW5nQmFzZSlcbiAgICBEb2Muc2V0VmlzKHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1cyA9PT0gQXBwcm92YWxTdGF0dXMuUGVuZGluZywgcGFnZS5hcHByb3ZhbFBlbmRpbmdRdW90ZSlcbiAgfVxuXG4gIC8qIHNldFJlZ2lzdHJhdGlvblN0YXR1c1ZpZXcgc2V0cyB0aGUgdGV4dCBjb250ZW50IGFuZCBjbGFzcyBmb3IgdGhlXG4gICAqIHJlZ2lzdHJhdGlvbiBzdGF0dXMgdmlld1xuICAgKi9cbiAgc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlldyAodGl0bGVDb250ZW50OiBzdHJpbmcsIGNvbmZTdGF0dXNNc2c6IHN0cmluZywgdGl0bGVDbGFzczogc3RyaW5nKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UucmVnU3RhdHVzVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZUNvbnRlbnRcbiAgICBwYWdlLnJlZ1N0YXR1c0NvbmZzRGlzcGxheS50ZXh0Q29udGVudCA9IGNvbmZTdGF0dXNNc2dcbiAgICBwYWdlLnJlZ2lzdHJhdGlvblN0YXR1cy5jbGFzc0xpc3QucmVtb3ZlKCdjb21wbGV0ZWQnLCAnZXJyb3InLCAnd2FpdGluZycpXG4gICAgcGFnZS5yZWdpc3RyYXRpb25TdGF0dXMuY2xhc3NMaXN0LmFkZCh0aXRsZUNsYXNzKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlUmVnaXN0cmF0aW9uU3RhdHVzVmlldyB1cGRhdGVzIHRoZSB2aWV3IGJhc2VkIG9uIHRoZSBjdXJyZW50XG4gICAqIHJlZ2lzdHJhdGlvbiBzdGF0dXNcbiAgICovXG4gIHVwZGF0ZVJlZ2lzdHJhdGlvblN0YXR1c1ZpZXcgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0OiB7IGRleCB9IH0gPSB0aGlzXG4gICAgcGFnZS5yZWdTdGF0dXNEZXgudGV4dENvbnRlbnQgPSBkZXguaG9zdFxuICAgIHBhZ2UucG9zdGluZ0JvbmRzRGV4LnRleHRDb250ZW50ID0gZGV4Lmhvc3RcblxuICAgIGlmIChkZXguYXV0aC5lZmZlY3RpdmVUaWVyID49IDEpIHtcbiAgICAgIHRoaXMuc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlldyhpbnRsLnByZXAoaW50bC5JRF9SRUdJU1RSQVRJT05fRkVFX1NVQ0NFU1MpLCAnJywgJ2NvbXBsZXRlZCcpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBjb25mU3RhdHVzZXMgPSAoZGV4LmF1dGgucGVuZGluZ0JvbmRzIHx8IFtdKS5tYXAocGVuZGluZyA9PiB7XG4gICAgICBjb25zdCBjb25maXJtYXRpb25zUmVxdWlyZWQgPSBkZXguYm9uZEFzc2V0c1twZW5kaW5nLnN5bWJvbF0uY29uZnNcbiAgICAgIHJldHVybiBgJHtwZW5kaW5nLmNvbmZzfSAvICR7Y29uZmlybWF0aW9uc1JlcXVpcmVkfWBcbiAgICB9KVxuICAgIGNvbnN0IGNvbmZTdGF0dXNNc2cgPSBjb25mU3RhdHVzZXMuam9pbignLCAnKVxuICAgIHRoaXMuc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlldyhpbnRsLnByZXAoaW50bC5JRF9XQUlUSU5HX0ZPUl9DT05GUyksIGNvbmZTdGF0dXNNc2csICd3YWl0aW5nJylcbiAgfVxuXG4gIC8qXG4gICAqIHNldFJlZ2lzdHJhdGlvblN0YXR1c1Zpc2liaWxpdHkgdG9nZ2xlcyB0aGUgcmVnaXN0cmF0aW9uIHN0YXR1cyB2aWV3IGJhc2VkXG4gICAqIG9uIHRoZSBkZXggZGF0YS5cbiAgICovXG4gIHNldFJlZ2lzdHJhdGlvblN0YXR1c1Zpc2liaWxpdHkgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0IH0gPSB0aGlzXG4gICAgaWYgKCFtYXJrZXQgfHwgIW1hcmtldC5kZXgpIHJldHVyblxuXG4gICAgLy8gSWYgZGV4IGlzIG5vdCBjb25uZWN0ZWQgdG8gc2VydmVyLCBpcyBub3QgcG9zc2libGUgdG8ga25vdyB0aGVcbiAgICAvLyByZWdpc3RyYXRpb24gc3RhdHVzLlxuICAgIGlmIChtYXJrZXQuZGV4LmNvbm5lY3Rpb25TdGF0dXMgIT09IENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGVkKSByZXR1cm5cblxuICAgIHRoaXMudXBkYXRlUmVnaXN0cmF0aW9uU3RhdHVzVmlldygpXG5cbiAgICBjb25zdCBzaG93U2VjdGlvbiA9IChzZWN0aW9uOiBQYWdlRWxlbWVudCB8IHVuZGVmaW5lZCkgPT4ge1xuICAgICAgY29uc3QgZWxlbWVudHMgPSBbcGFnZS5yZWdpc3RyYXRpb25TdGF0dXMsIHBhZ2UuYm9uZFJlcXVpcmVkLCBwYWdlLmJvbmRDcmVhdGlvblBlbmRpbmcsIHBhZ2Uubm90UmVnaXN0ZXJlZF1cbiAgICAgIGZvciAoY29uc3QgZWwgb2YgZWxlbWVudHMpIHtcbiAgICAgICAgRG9jLnNldFZpcyhlbCA9PT0gc2VjdGlvbiwgZWwpXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hcmtldC5kZXguYXV0aC5lZmZlY3RpdmVUaWVyID49IDEpIHtcbiAgICAgIGNvbnN0IHRvZ2dsZSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgc2hvd1NlY3Rpb24odW5kZWZpbmVkKVxuICAgICAgICB0aGlzLnJlc29sdmVPcmRlckZvcm1WaXNpYmlsaXR5KClcbiAgICAgIH1cbiAgICAgIGlmIChEb2MuaXNIaWRkZW4ocGFnZS5vcmRlckZvcm0pKSB7XG4gICAgICAgIC8vIHdhaXQgYSBjb3VwbGUgb2Ygc2Vjb25kcyBiZWZvcmUgc2hvd2luZyB0aGUgZm9ybSBzbyB0aGUgc3VjY2Vzc1xuICAgICAgICAvLyBtZXNzYWdlIGlzIHNob3duIHRvIHRoZSB1c2VyXG4gICAgICAgIHNldFRpbWVvdXQodG9nZ2xlLCA1MDAwKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHRvZ2dsZSgpXG4gICAgfSBlbHNlIGlmIChtYXJrZXQuZGV4LnZpZXdPbmx5KSB7XG4gICAgICBwYWdlLnVucmVnaXN0ZXJlZERleC50ZXh0Q29udGVudCA9IG1hcmtldC5kZXguaG9zdFxuICAgICAgc2hvd1NlY3Rpb24ocGFnZS5ub3RSZWdpc3RlcmVkKVxuICAgIH0gZWxzZSBpZiAodGhpcy5oYXNQZW5kaW5nQm9uZHMoKSkge1xuICAgICAgc2hvd1NlY3Rpb24ocGFnZS5yZWdpc3RyYXRpb25TdGF0dXMpXG4gICAgfSBlbHNlIGlmIChtYXJrZXQuZGV4LmF1dGgudGFyZ2V0VGllciA+IDApIHtcbiAgICAgIHNob3dTZWN0aW9uKHBhZ2UuYm9uZENyZWF0aW9uUGVuZGluZylcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5hY2N0VGllci50ZXh0Q29udGVudCA9IGAke21hcmtldC5kZXguYXV0aC5lZmZlY3RpdmVUaWVyfWBcbiAgICAgIHBhZ2UuZGV4U2V0dGluZ3NMaW5rLmhyZWYgPSBgL2RleHNldHRpbmdzLyR7bWFya2V0LmRleC5ob3N0fWBcbiAgICAgIHNob3dTZWN0aW9uKHBhZ2UuYm9uZFJlcXVpcmVkKVxuICAgIH1cbiAgfVxuXG4gIHNldE9yZGVyQnR0blRleHQgKCkge1xuICAgIGlmICh0aGlzLmlzU2VsbCgpKSB7XG4gICAgICB0aGlzLnBhZ2Uuc3VibWl0QnR0bi50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1NFVF9CVVRUT05fU0VMTCwgeyBhc3NldDogRG9jLnNob3J0U3ltYm9sKHRoaXMubWFya2V0LmJhc2VDZmcudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQpIH0pXG4gICAgfSBlbHNlIHRoaXMucGFnZS5zdWJtaXRCdHRuLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfU0VUX0JVVFRPTl9CVVksIHsgYXNzZXQ6IERvYy5zaG9ydFN5bWJvbCh0aGlzLm1hcmtldC5iYXNlQ2ZnLnVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0KSB9KVxuICB9XG5cbiAgc2V0T3JkZXJCdHRuRW5hYmxlZCAoaXNFbmFibGVkOiBib29sZWFuLCBkaXNhYmxlZFRvb2x0aXBNc2c/OiBzdHJpbmcpIHtcbiAgICBjb25zdCBidG4gPSB0aGlzLnBhZ2Uuc3VibWl0QnR0blxuICAgIGlmIChpc0VuYWJsZWQpIHtcbiAgICAgIGJ0bi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcbiAgICAgIGJ0bi5yZW1vdmVBdHRyaWJ1dGUoJ3RpdGxlJylcbiAgICB9IGVsc2Uge1xuICAgICAgYnRuLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAndHJ1ZScpXG4gICAgICBpZiAoZGlzYWJsZWRUb29sdGlwTXNnKSBidG4uc2V0QXR0cmlidXRlKCd0aXRsZScsIGRpc2FibGVkVG9vbHRpcE1zZylcbiAgICB9XG4gIH1cblxuICB1cGRhdGVPcmRlckJ0dG5TdGF0ZSAoKSB7XG4gICAgY29uc3QgeyBtYXJrZXQ6IG1rdCwgY3VycmVudE9yZGVyOiB7IHF0eTogb3JkZXJRdHksIHJhdGU6IG9yZGVyUmF0ZSwgaXNMaW1pdCwgc2VsbCB9IH0gPSB0aGlzXG4gICAgY29uc3QgYmFzZVdhbGxldCA9IGFwcCgpLmFzc2V0c1t0aGlzLm1hcmtldC5iYXNlLmlkXS53YWxsZXRcbiAgICBjb25zdCBxdW90ZVdhbGxldCA9IGFwcCgpLmFzc2V0c1tta3QucXVvdGUuaWRdLndhbGxldFxuICAgIGlmICghYmFzZVdhbGxldCB8fCAhcXVvdGVXYWxsZXQpIHJldHVyblxuXG4gICAgaWYgKG9yZGVyUXR5IDw9IDAgfHwgb3JkZXJRdHkgPCBta3QuY2ZnLmxvdHNpemUpIHtcbiAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChmYWxzZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX1FUWV9FUlJPUikpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBNYXJrZXQgb3JkZXJzXG4gICAgaWYgKCFpc0xpbWl0KSB7XG4gICAgICBpZiAoc2VsbCkge1xuICAgICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQob3JkZXJRdHkgPD0gYmFzZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX1NFTExfQkFMQU5DRV9FUlJPUikpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQob3JkZXJRdHkgPD0gcXVvdGVXYWxsZXQuYmFsYW5jZS5hdmFpbGFibGUsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9CVVlfQkFMQU5DRV9FUlJPUikpXG4gICAgICB9XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBpZiAoIW9yZGVyUmF0ZSkge1xuICAgICAgdGhpcy5zZXRPcmRlckJ0dG5FbmFibGVkKGZhbHNlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fUVRZX1JBVEVfRVJST1IpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gTGltaXQgc2VsbFxuICAgIGlmIChzZWxsKSB7XG4gICAgICBpZiAoYmFzZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA8IG1rdC5jZmcubG90c2l6ZSkge1xuICAgICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQoZmFsc2UsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9TRUxMX0JBTEFOQ0VfRVJST1IpKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGlmIChta3QubWF4U2VsbCkge1xuICAgICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQob3JkZXJRdHkgPD0gbWt0Lm1heFNlbGwuc3dhcC52YWx1ZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX1NFTExfQkFMQU5DRV9FUlJPUikpXG4gICAgICB9XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBMaW1pdCBidXlcbiAgICBjb25zdCByYXRlID0gdGhpcy5hZGp1c3RlZFJhdGUoKVxuICAgIGNvbnN0IGFMb3QgPSBta3QuY2ZnLmxvdHNpemUgKiAocmF0ZSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IpXG4gICAgaWYgKHF1b3RlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIDwgYUxvdCkge1xuICAgICAgdGhpcy5zZXRPcmRlckJ0dG5FbmFibGVkKGZhbHNlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fQlVZX0JBTEFOQ0VfRVJST1IpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmIChta3QubWF4QnV5c1tyYXRlXSkge1xuICAgICAgY29uc3QgZW5hYmxlID0gb3JkZXJRdHkgPD0gbWt0Lm1heEJ1eXNbcmF0ZV0uc3dhcC5sb3RzICogbWt0LmNmZy5sb3RzaXplXG4gICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQoZW5hYmxlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fQlVZX0JBTEFOQ0VfRVJST1IpKVxuICAgIH1cbiAgfVxuXG4gIHNldENhbmRsZUR1ckJ0dG5zICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIG1hcmtldCB9ID0gdGhpc1xuICAgIERvYy5lbXB0eShwYWdlLmR1ckJ0dG5Cb3gpXG4gICAgZm9yIChjb25zdCBkdXIgb2YgbWFya2V0LmRleC5jYW5kbGVEdXJzKSB7XG4gICAgICBjb25zdCBidHRuID0gcGFnZS5kdXJCdHRuVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpXG4gICAgICBidHRuLnRleHRDb250ZW50ID0gZHVyXG4gICAgICBEb2MuYmluZChidHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLmNhbmRsZUR1cmF0aW9uU2VsZWN0ZWQoZHVyKSlcbiAgICAgIHBhZ2UuZHVyQnR0bkJveC5hcHBlbmRDaGlsZChidHRuKVxuICAgIH1cblxuICAgIC8vIGxvYWQgY2FuZGxlc3RpY2tzIGhlcmUgc2luY2Ugd2UgYXJlIHJlc2V0dGluZyBwYWdlLmR1ckJ0dG5Cb3ggYWJvdmUuXG4gICAgdGhpcy5sb2FkQ2FuZGxlcygpXG4gIH1cblxuICAvKiBzZXRNYXJrZXQgc2V0cyB0aGUgY3VycmVudGx5IGRpc3BsYXllZCBtYXJrZXQuICovXG4gIGFzeW5jIHNldE1hcmtldCAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgZGV4ID0gYXBwKCkudXNlci5leGNoYW5nZXNbaG9zdF1cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG5cbiAgICB3aW5kb3cuY2V4Qm9vayA9IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2NleGJvb2snLCB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCB9KVxuICAgICAgY29uc29sZS5sb2cocmVzLmJvb2spXG4gICAgfVxuXG4gICAgLy8gcmVzZXQgZm9ybSBpbnB1dHNcbiAgICBwYWdlLmxvdEZpZWxkLnZhbHVlID0gJydcbiAgICBwYWdlLnF0eUZpZWxkLnZhbHVlID0gJydcbiAgICBwYWdlLnJhdGVGaWVsZC52YWx1ZSA9ICcnXG5cbiAgICAvLyBjbGVhciBkZXB0aCBjaGFydCBhbmQgb3JkZXJib29rLlxuICAgIHRoaXMuZGVwdGhDaGFydC5jbGVhcigpXG4gICAgRG9jLmVtcHR5KHRoaXMucGFnZS5idXlSb3dzKVxuICAgIERvYy5lbXB0eSh0aGlzLnBhZ2Uuc2VsbFJvd3MpXG5cbiAgICAvLyBDbGVhciByZWNlbnQgbWF0Y2hlcyBmb3IgdGhlIHByZXZpb3VzIG1hcmtldC4gVGhpcyB3aWxsIGJlIHNldCB3aGVuIHdlXG4gICAgLy8gcmVjZWl2ZSB0aGUgb3JkZXIgYm9vayBzdWJzY3JpcHRpb24gcmVzcG9uc2UuXG4gICAgdGhpcy5yZWNlbnRNYXRjaGVzID0gW11cbiAgICBEb2MuZW1wdHkocGFnZS5yZWNlbnRNYXRjaGVzTGl2ZUxpc3QpXG5cbiAgICAvLyBIaWRlIHRoZSBiYWxhbmNlIHdpZGdldFxuICAgIHRoaXMuYmFsYW5jZVdndC5zZXRCYWxhbmNlVmlzaWJpbGl0eShmYWxzZSlcblxuICAgIERvYy5oaWRlKHBhZ2Uubm90UmVnaXN0ZXJlZCwgcGFnZS5ib25kUmVxdWlyZWQsIHBhZ2Uubm9XYWxsZXQpXG5cbiAgICAvLyBJZiB3ZSBoYXZlIG5vdCB5ZXQgY29ubmVjdGVkLCB0aGVyZSBpcyBubyBkZXguYXNzZXRzIG9yIGFueSBvdGhlclxuICAgIC8vIGV4Y2hhbmdlIGRhdGEsIHNvIGp1c3QgcHV0IHVwIGEgbWVzc2FnZSBhbmQgd2FpdCBmb3IgdGhlIGNvbm5lY3Rpb24gdG8gYmVcbiAgICAvLyBlc3RhYmxpc2hlZCwgYXQgd2hpY2ggdGltZSBoYW5kbGVDb25uTm90ZSB3aWxsIHJlZnJlc2ggYW5kIHJlbG9hZC5cbiAgICBpZiAoIWRleCB8fCAhZGV4Lm1hcmtldHMgfHwgZGV4LmNvbm5lY3Rpb25TdGF0dXMgIT09IENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGVkKSB7XG4gICAgICBsZXQgZXJyTXNnID0gaW50bC5wcmVwKGludGwuSURfQ09OTkVDVElPTl9GQUlMRUQpXG4gICAgICBpZiAoZGV4LmRpc2FibGVkKSBlcnJNc2cgPSBpbnRsLnByZXAoaW50bC5JRF9ERVhfRElTQUJMRURfTVNHKVxuICAgICAgcGFnZS5jaGFydEVyck1zZy50ZXh0Q29udGVudCA9IGVyck1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5jaGFydEVyck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGZvciAoY29uc3QgcyBvZiB0aGlzLnN0YXRzKSBEb2Muc2hvdyhzLnJvdylcblxuICAgIGNvbnN0IGJhc2VDZmcgPSBkZXguYXNzZXRzW2Jhc2VJRF1cbiAgICBjb25zdCBxdW90ZUNmZyA9IGRleC5hc3NldHNbcXVvdGVJRF1cblxuICAgIGNvbnN0IFtidWksIHF1aV0gPSBbYXBwKCkudW5pdEluZm8oYmFzZUlELCBkZXgpLCBhcHAoKS51bml0SW5mbyhxdW90ZUlELCBkZXgpXVxuXG4gICAgY29uc3QgcmF0ZUNvbnZlcnNpb25GYWN0b3IgPSBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yIC8gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yICogcXVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgRG9jLmhpZGUocGFnZS5tYXhPcmQsIHBhZ2UuY2hhcnRFcnJNc2cpXG4gICAgaWYgKHRoaXMubWF4RXN0aW1hdGVUaW1lcikge1xuICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLm1heEVzdGltYXRlVGltZXIpXG4gICAgICB0aGlzLm1heEVzdGltYXRlVGltZXIgPSBudWxsXG4gICAgfVxuICAgIGNvbnN0IG1rdElkID0gbWFya2V0SUQoYmFzZUNmZy5zeW1ib2wsIHF1b3RlQ2ZnLnN5bWJvbClcbiAgICBjb25zdCBiYXNlQXNzZXQgPSBhcHAoKS5hc3NldHNbYmFzZUlEXVxuICAgIGNvbnN0IHF1b3RlQXNzZXQgPSBhcHAoKS5hc3NldHNbcXVvdGVJRF1cblxuICAgIGNvbnN0IG1rdCA9IHtcbiAgICAgIGRleDogZGV4LFxuICAgICAgc2lkOiBta3RJZCwgLy8gQSBzdHJpbmcgbWFya2V0IGlkZW50aWZpZXIgdXNlZCBieSB0aGUgREVYLlxuICAgICAgY2ZnOiBkZXgubWFya2V0c1tta3RJZF0sXG4gICAgICAvLyBhcHAoKS5hc3NldHMgaXMgYSBtYXAgb2YgY29yZS5TdXBwb3J0ZWRBc3NldCB0eXBlLCB3aGljaCBjYW4gYmUgZm91bmQgYXRcbiAgICAgIC8vIGNsaWVudC9jb3JlL3R5cGVzLmdvLlxuICAgICAgYmFzZTogYmFzZUFzc2V0LFxuICAgICAgcXVvdGU6IHF1b3RlQXNzZXQsXG4gICAgICBiYXNlVW5pdEluZm86IGJ1aSxcbiAgICAgIHF1b3RlVW5pdEluZm86IHF1aSxcbiAgICAgIG1heFNlbGw6IG51bGwsXG4gICAgICBtYXhCdXlzOiB7fSxcbiAgICAgIG1heFNlbGxSZXF1ZXN0ZWQ6IGZhbHNlLFxuICAgICAgY2FuZGxlQ2FjaGVzOiB7fSxcbiAgICAgIGJhc2VDZmcsXG4gICAgICBxdW90ZUNmZyxcbiAgICAgIHJhdGVDb252ZXJzaW9uRmFjdG9yLFxuICAgICAgc2VsbEJhbGFuY2U6IDAsXG4gICAgICBidXlCYWxhbmNlOiAwLFxuICAgICAgYm9va0xvYWRlZDogZmFsc2VcbiAgICB9XG5cbiAgICB0aGlzLm1hcmtldCA9IG1rdFxuICAgIHRoaXMubW0uc2V0TWFya2V0KGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICB0aGlzLm1tUnVubmluZyA9IHVuZGVmaW5lZFxuICAgIHBhZ2UubG90U2l6ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWt0LmNmZy5sb3RzaXplLCBta3QuYmFzZVVuaXRJbmZvKVxuICAgIHBhZ2UucmF0ZVN0ZXAudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG1rdC5jZmcucmF0ZXN0ZXAgLyByYXRlQ29udmVyc2lvbkZhY3RvcilcblxuICAgIHRoaXMuZGlzcGxheU1lc3NhZ2VJZk1pc3NpbmdXYWxsZXQoKVxuICAgIHRoaXMuYmFsYW5jZVdndC5zZXRXYWxsZXRzKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICB0aGlzLnNldE1hcmtldERldGFpbHMoKVxuICAgIHRoaXMuc2V0Q3Vyck1hcmtldFByaWNlKClcblxuICAgIC8vIGlmICghZGV4LmNhbmRsZUR1cnMgfHwgZGV4LmNhbmRsZUR1cnMubGVuZ3RoID09PSAwKSB0aGlzLmN1cnJlbnRDaGFydCA9IGRlcHRoQ2hhcnRcblxuICAgIC8vIGRlcHRoIGNoYXJ0XG4gICAgd3MucmVxdWVzdCgnbG9hZG1hcmtldCcsIG1ha2VNYXJrZXQoaG9zdCwgYmFzZUlELCBxdW90ZUlEKSlcblxuICAgIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUubGFzdE1hcmtldExLLCB7XG4gICAgICBob3N0OiBob3N0LFxuICAgICAgYmFzZTogYmFzZUlELFxuICAgICAgcXVvdGU6IHF1b3RlSURcbiAgICB9KVxuICAgIGFwcCgpLnVwZGF0ZU1hcmtldEVsZW1lbnRzKHRoaXMubWFpbiwgYmFzZUlELCBxdW90ZUlELCBkZXgpXG4gICAgdGhpcy5tYXJrZXRMaXN0LnNlbGVjdChob3N0LCBiYXNlSUQsIHF1b3RlSUQpXG4gICAgdGhpcy5zZXRMb2FkZXJNc2dWaXNpYmlsaXR5KClcbiAgICB0aGlzLnNldFRva2VuQXBwcm92YWxWaXNpYmlsaXR5KClcbiAgICB0aGlzLnNldFJlZ2lzdHJhdGlvblN0YXR1c1Zpc2liaWxpdHkoKVxuICAgIHRoaXMucmVzb2x2ZU9yZGVyRm9ybVZpc2liaWxpdHkoKVxuICAgIHRoaXMuc2V0T3JkZXJCdHRuVGV4dCgpXG4gICAgdGhpcy5zZXRPcmRlckJ0dG5FbmFibGVkKGZhbHNlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fUVRZX1JBVEVfRVJST1IpKVxuICAgIHRoaXMuc2V0Q2FuZGxlRHVyQnR0bnMoKVxuICAgIHRoaXMucHJldmlld1F1b3RlQW10KGZhbHNlKVxuICAgIHRoaXMudXBkYXRlVGl0bGUoKVxuICAgIHRoaXMucmVwdXRhdGlvbk1ldGVyLnNldEhvc3QoZGV4Lmhvc3QpXG4gICAgdGhpcy51cGRhdGVSZXB1dGF0aW9uKClcbiAgICB0aGlzLmxvYWRVc2VyT3JkZXJzKClcbiAgfVxuXG4gIC8qXG4gICAgZGlzcGxheU1lc3NhZ2VGb3JNaXNzaW5nV2FsbGV0IGRpc3BsYXlzIGEgY3VzdG9tIG1lc3NhZ2Ugb24gdGhlIG1hcmtldCdzXG4gICAgdmlldyBpZiBvbmUgb3IgbW9yZSBvZiB0aGUgc2VsZWN0ZWQgbWFya2V0J3Mgd2FsbGV0IGlzIG1pc3NpbmcuXG4gICovXG4gIGRpc3BsYXlNZXNzYWdlSWZNaXNzaW5nV2FsbGV0ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbWt0ID0gdGhpcy5tYXJrZXRcbiAgICBjb25zdCBiYXNlU3ltID0gbWt0LmJhc2VDZmcuc3ltYm9sLnRvTG9jYWxlVXBwZXJDYXNlKClcbiAgICBjb25zdCBxdW90ZVN5bSA9IG1rdC5xdW90ZUNmZy5zeW1ib2wudG9Mb2NhbGVVcHBlckNhc2UoKVxuICAgIGxldCBub1dhbGxldE1zZyA9ICcnXG4gICAgRG9jLmhpZGUocGFnZS5ub1dhbGxldClcbiAgICBpZiAoIW1rdC5iYXNlPy53YWxsZXQgJiYgIW1rdC5xdW90ZT8ud2FsbGV0KSBub1dhbGxldE1zZyA9IGludGwucHJlcChpbnRsLklEX05PX1dBTExFVF9NU0csIHsgYXNzZXQxOiBiYXNlU3ltLCBhc3NldDI6IHF1b3RlU3ltIH0pXG4gICAgZWxzZSBpZiAoIW1rdC5iYXNlPy53YWxsZXQpIG5vV2FsbGV0TXNnID0gaW50bC5wcmVwKGludGwuSURfQ1JFQVRFX0FTU0VUX1dBTExFVF9NU0csIHsgYXNzZXQ6IGJhc2VTeW0gfSlcbiAgICBlbHNlIGlmICghbWt0LnF1b3RlPy53YWxsZXQpIG5vV2FsbGV0TXNnID0gaW50bC5wcmVwKGludGwuSURfQ1JFQVRFX0FTU0VUX1dBTExFVF9NU0csIHsgYXNzZXQ6IHF1b3RlU3ltIH0pXG4gICAgZWxzZSByZXR1cm5cblxuICAgIHBhZ2Uubm9XYWxsZXQudGV4dENvbnRlbnQgPSBub1dhbGxldE1zZ1xuICAgIERvYy5zaG93KHBhZ2Uubm9XYWxsZXQpXG4gIH1cblxuICAvKlxuICAgKiByZXBvcnREZXB0aENsaWNrIGlzIGEgY2FsbGJhY2sgdXNlZCBieSB0aGUgRGVwdGhDaGFydCB3aGVuIHRoZSB1c2VyIGNsaWNrc1xuICAgKiBvbiB0aGUgY2hhcnQgYXJlYS4gVGhlIHJhdGUgZmllbGQgaXMgc2V0IHRvIHRoZSB4LXZhbHVlIG9mIHRoZSBjbGljay5cbiAgICovXG4gIHJlcG9ydERlcHRoQ2xpY2sgKHI6IG51bWJlcikge1xuICAgIHRoaXMucGFnZS5yYXRlRmllbGQudmFsdWUgPSBTdHJpbmcocilcbiAgICB0aGlzLnJhdGVGaWVsZENoYW5nZWQoKVxuICB9XG5cbiAgLypcbiAgICogcmVwb3J0RGVwdGhWb2x1bWUgYWNjZXB0cyBhIHZvbHVtZSByZXBvcnQgZnJvbSB0aGUgRGVwdGhDaGFydCBhbmQgc2V0cyB0aGVcbiAgICogdmFsdWVzIGluIHRoZSBjaGFydCBsZWdlbmQuXG4gICAqL1xuICByZXBvcnREZXB0aFZvbHVtZSAocjogVm9sdW1lUmVwb3J0KSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IHsgYmFzZVVuaXRJbmZvOiBiLCBxdW90ZVVuaXRJbmZvOiBxIH0gPSB0aGlzLm1hcmtldFxuICAgIC8vIERlcHRoQ2hhcnQgcmVwb3J0cyB2b2x1bWVzIGluIGNvbnZlbnRpb25hbCB1bml0cy4gV2UnbGwgc3RpbGwgdXNlXG4gICAgLy8gZm9ybWF0Q29pblZhbHVlIGZvciBmb3JtYXR0aW5nIHRob3VnaC5cbiAgICBwYWdlLnNlbGxCb29rZWRCYXNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyLnNlbGxCYXNlICogYi5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciwgYilcbiAgICBwYWdlLnNlbGxCb29rZWRRdW90ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoci5zZWxsUXVvdGUgKiBxLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yLCBxKVxuICAgIHBhZ2UuYnV5Qm9va2VkQmFzZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoci5idXlCYXNlICogYi5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciwgYilcbiAgICBwYWdlLmJ1eUJvb2tlZFF1b3RlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyLmJ1eVF1b3RlICogcS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciwgcSlcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydERlcHRoTW91c2UgYWNjZXB0cyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbW91c2UgcG9zaXRpb24gb24gdGhlIGNoYXJ0XG4gICAqIGFyZWEuXG4gICAqL1xuICByZXBvcnREZXB0aE1vdXNlIChyOiBNb3VzZVJlcG9ydCkge1xuICAgIHdoaWxlICh0aGlzLmhvdmVycy5sZW5ndGgpICh0aGlzLmhvdmVycy5zaGlmdCgpIGFzIEhUTUxFbGVtZW50KS5jbGFzc0xpc3QucmVtb3ZlKCdob3ZlcicpXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGlmICghcikge1xuICAgICAgRG9jLmhpZGUocGFnZS5kZXB0aExlZ2VuZClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLmRlcHRoTGVnZW5kKVxuXG4gICAgLy8gSWYgdGhlIHVzZXIgaXMgaG92ZXJlZCB0byB3aXRoaW4gYSBzbWFsbCBwZXJjZW50IChiYXNlZCBvbiBjaGFydCB3aWR0aClcbiAgICAvLyBvZiBhIHVzZXIgb3JkZXIsIGhpZ2hsaWdodCB0aGF0IG9yZGVyJ3Mgcm93LlxuICAgIGZvciAoY29uc3QgeyBkaXYsIG9yZCB9IG9mIE9iamVjdC52YWx1ZXModGhpcy5tZXRhT3JkZXJzKSkge1xuICAgICAgaWYgKG9yZC5zdGF0dXMgIT09IE9yZGVyVXRpbC5TdGF0dXNCb29rZWQpIGNvbnRpbnVlXG4gICAgICBpZiAoci5ob3Zlck1hcmtlcnMuaW5kZXhPZihvcmQucmF0ZSkgPiAtMSkge1xuICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZCgnaG92ZXInKVxuICAgICAgICB0aGlzLmhvdmVycy5wdXNoKGRpdilcbiAgICAgIH1cbiAgICB9XG5cbiAgICBwYWdlLmhvdmVyUHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHIucmF0ZSlcbiAgICBwYWdlLmhvdmVyVm9sdW1lLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyLmRlcHRoKVxuICAgIHBhZ2UuaG92ZXJWb2x1bWUuc3R5bGUuY29sb3IgPSByLmRvdENvbG9yXG4gIH1cblxuICAvKlxuICAgKiByZXBvcnREZXB0aFpvb20gYWNjZXB0cyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgY3VycmVudCBkZXB0aCBjaGFydCB6b29tXG4gICAqIGxldmVsLiBUaGlzIGluZm9ybWF0aW9uIGlzIHNhdmVkIHRvIGRpc2sgc28gdGhhdCB0aGUgem9vbSBsZXZlbCBjYW4gYmVcbiAgICogbWFpbnRhaW5lZCBhY3Jvc3MgcmVsb2Fkcy5cbiAgICovXG4gIHJlcG9ydERlcHRoWm9vbSAoem9vbTogbnVtYmVyKSB7XG4gICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5kZXB0aFpvb21MSywgem9vbSlcbiAgfVxuXG4gIHJlcG9ydE1vdXNlQ2FuZGxlIChjYW5kbGU6IENhbmRsZSB8IG51bGwpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgaWYgKCFjYW5kbGUpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuY2FuZGxlc0xlZ2VuZClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLmNhbmRsZXNMZWdlbmQpXG4gICAgcGFnZS5jYW5kbGVTdGFydC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoY2FuZGxlLnN0YXJ0UmF0ZSAvIHRoaXMubWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yKVxuICAgIHBhZ2UuY2FuZGxlRW5kLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShjYW5kbGUuZW5kUmF0ZSAvIHRoaXMubWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yKVxuICAgIHBhZ2UuY2FuZGxlSGlnaC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoY2FuZGxlLmhpZ2hSYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgcGFnZS5jYW5kbGVMb3cudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGNhbmRsZS5sb3dSYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgcGFnZS5jYW5kbGVWb2wudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGNhbmRsZS5tYXRjaFZvbHVtZSwgdGhpcy5tYXJrZXQuYmFzZVVuaXRJbmZvKVxuICB9XG5cbiAgLypcbiAgICogcGFyc2VPcmRlciBwdWxscyB0aGUgb3JkZXIgaW5mb3JtYXRpb24gZnJvbSB0aGUgZm9ybSBmaWVsZHMuIERhdGEgaXMgbm90XG4gICAqIHZhbGlkYXRlZCBpbiBhbnkgd2F5LlxuICAgKi9cbiAgcGFyc2VPcmRlciAoKTogVHJhZGVGb3JtIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgbGV0IHF0eUZpZWxkID0gcGFnZS5xdHlGaWVsZFxuICAgIGNvbnN0IGxpbWl0ID0gdGhpcy5pc0xpbWl0KClcbiAgICBjb25zdCBzZWxsID0gdGhpcy5pc1NlbGwoKVxuICAgIGNvbnN0IG1hcmtldCA9IHRoaXMubWFya2V0XG4gICAgbGV0IHF0eUNvbnYgPSBtYXJrZXQuYmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgaWYgKCFsaW1pdCAmJiAhc2VsbCkge1xuICAgICAgcXR5RmllbGQgPSBwYWdlLm1rdEJ1eUZpZWxkXG4gICAgICBxdHlDb252ID0gbWFya2V0LnF1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGhvc3Q6IG1hcmtldC5kZXguaG9zdCxcbiAgICAgIGlzTGltaXQ6IGxpbWl0LFxuICAgICAgc2VsbDogc2VsbCxcbiAgICAgIGJhc2U6IG1hcmtldC5iYXNlLmlkLFxuICAgICAgcXVvdGU6IG1hcmtldC5xdW90ZS5pZCxcbiAgICAgIHF0eTogY29udmVydFRvQXRvbXMocXR5RmllbGQudmFsdWUgfHwgJycsIHF0eUNvbnYpLFxuICAgICAgcmF0ZTogY29udmVydFRvQXRvbXMocGFnZS5yYXRlRmllbGQudmFsdWUgfHwgJycsIG1hcmtldC5yYXRlQ29udmVyc2lvbkZhY3RvciksIC8vIG1lc3NhZ2UtcmF0ZVxuICAgICAgdGlmbm93OiBwYWdlLnRpZk5vdy5jaGVja2VkIHx8IGZhbHNlLFxuICAgICAgb3B0aW9uczoge31cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogcHJldmlld1F1b3RlQW10IHNob3dzIHF1b3RlIGFtb3VudCB3aGVuIHJhdGUgb3IgcXVhbnRpdHkgaW5wdXQgYXJlIGNoYW5nZWRcbiAgICovXG4gIHByZXZpZXdRdW90ZUFtdCAoc2hvdzogYm9vbGVhbikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBpZiAoIXRoaXMubWFya2V0LmJhc2UgfHwgIXRoaXMubWFya2V0LnF1b3RlKSByZXR1cm4gLy8gTm90IGEgc3VwcG9ydGVkIGFzc2V0XG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLmN1cnJlbnRPcmRlciA9IHRoaXMucGFyc2VPcmRlcigpXG4gICAgY29uc3QgYWRqdXN0ZWQgPSB0aGlzLmFkanVzdGVkUmF0ZSgpXG4gICAgcGFnZS5vcmRlckVyci50ZXh0Q29udGVudCA9ICcnXG4gICAgaWYgKGFkanVzdGVkKSB7XG4gICAgICBpZiAob3JkZXIuc2VsbCkgdGhpcy5wcmVTZWxsKClcbiAgICAgIGVsc2UgdGhpcy5wcmVCdXkoKVxuICAgIH1cbiAgICB0aGlzLmRlcHRoTGluZXMuaW5wdXQgPSBbXVxuICAgIGlmIChhZGp1c3RlZCAmJiB0aGlzLmlzTGltaXQoKSkge1xuICAgICAgdGhpcy5kZXB0aExpbmVzLmlucHV0ID0gW3tcbiAgICAgICAgcmF0ZTogb3JkZXIucmF0ZSAvIHRoaXMubWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yLFxuICAgICAgICBjb2xvcjogb3JkZXIuc2VsbCA/IHRoaXMuZGVwdGhDaGFydC50aGVtZS5zZWxsTGluZSA6IHRoaXMuZGVwdGhDaGFydC50aGVtZS5idXlMaW5lXG4gICAgICB9XVxuICAgIH1cbiAgICB0aGlzLmRyYXdDaGFydExpbmVzKClcbiAgICBpZiAoIXNob3cgfHwgIWFkanVzdGVkIHx8ICFvcmRlci5xdHkpIHtcbiAgICAgIHBhZ2Uub3JkZXJQcmV2aWV3LnRleHRDb250ZW50ID0gJydcbiAgICAgIHRoaXMuZHJhd0NoYXJ0TGluZXMoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IHsgdW5pdEluZm86IHsgY29udmVudGlvbmFsOiB7IHVuaXQgfSB9IH0gPSBhcHAoKS5hc3NldHNbb3JkZXIucXVvdGVdXG4gICAgY29uc3QgcXVvdGVRdHkgPSBvcmRlci5xdHkgKiBvcmRlci5yYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvclxuICAgIGNvbnN0IHRvdGFsID0gRG9jLmZvcm1hdENvaW5WYWx1ZShxdW90ZVF0eSwgdGhpcy5tYXJrZXQucXVvdGVVbml0SW5mbylcblxuICAgIHBhZ2Uub3JkZXJQcmV2aWV3LnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfT1JERVJfUFJFVklFVywgeyB0b3RhbCwgYXNzZXQ6IHVuaXQgfSlcbiAgICBpZiAodGhpcy5pc1NlbGwoKSkgdGhpcy5wcmVTZWxsKClcbiAgICBlbHNlIHRoaXMucHJlQnV5KClcbiAgfVxuXG4gIC8qKlxuICAgKiBwcmVTZWxsIHBvcHVsYXRlcyB0aGUgbWF4IG9yZGVyIG1lc3NhZ2UgZm9yIHRoZSBsYXJnZXN0IGF2YWlsYWJsZSBzZWxsLlxuICAgKi9cbiAgcHJlU2VsbCAoKSB7XG4gICAgY29uc3QgbWt0ID0gdGhpcy5tYXJrZXRcbiAgICBjb25zdCBiYXNlV2FsbGV0ID0gYXBwKCkuYXNzZXRzW21rdC5iYXNlLmlkXS53YWxsZXRcbiAgICBpZiAoYmFzZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA8IG1rdC5jZmcubG90c2l6ZSkge1xuICAgICAgdGhpcy5zZXRNYXhPcmRlcihudWxsKVxuICAgICAgdGhpcy51cGRhdGVPcmRlckJ0dG5TdGF0ZSgpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKG1rdC5tYXhTZWxsKSB7XG4gICAgICB0aGlzLnNldE1heE9yZGVyKG1rdC5tYXhTZWxsLnN3YXApXG4gICAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmIChta3QubWF4U2VsbFJlcXVlc3RlZCkgcmV0dXJuXG4gICAgbWt0Lm1heFNlbGxSZXF1ZXN0ZWQgPSB0cnVlXG4gICAgLy8gV2Ugb25seSBmZXRjaCBwcmUtc2VsbCBvbmNlIHBlciBiYWxhbmNlIHVwZGF0ZSwgc28gZG9uJ3QgZGVsYXkuXG4gICAgdGhpcy5zY2hlZHVsZU1heEVzdGltYXRlKCcvYXBpL21heHNlbGwnLCB7fSwgMCwgKHJlczogTWF4U2VsbCkgPT4ge1xuICAgICAgbWt0Lm1heFNlbGxSZXF1ZXN0ZWQgPSBmYWxzZVxuICAgICAgbWt0Lm1heFNlbGwgPSByZXMubWF4U2VsbFxuICAgICAgbWt0LnNlbGxCYWxhbmNlID0gYmFzZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZVxuICAgICAgdGhpcy5zZXRNYXhPcmRlcihyZXMubWF4U2VsbC5zd2FwKVxuICAgICAgdGhpcy51cGRhdGVPcmRlckJ0dG5TdGF0ZSgpXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBwcmVCdXkgcG9wdWxhdGVzIHRoZSBtYXggb3JkZXIgbWVzc2FnZSBmb3IgdGhlIGxhcmdlc3QgYXZhaWxhYmxlIGJ1eS5cbiAgICovXG4gIHByZUJ1eSAoKSB7XG4gICAgY29uc3QgbWt0ID0gdGhpcy5tYXJrZXRcbiAgICBjb25zdCByYXRlID0gdGhpcy5hZGp1c3RlZFJhdGUoKVxuICAgIGNvbnN0IHF1b3RlV2FsbGV0ID0gYXBwKCkuYXNzZXRzW21rdC5xdW90ZS5pZF0ud2FsbGV0XG4gICAgaWYgKCFxdW90ZVdhbGxldCkgcmV0dXJuXG4gICAgY29uc3QgYUxvdCA9IG1rdC5jZmcubG90c2l6ZSAqIChyYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvcilcbiAgICBpZiAocXVvdGVXYWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgPCBhTG90KSB7XG4gICAgICB0aGlzLnNldE1heE9yZGVyKG51bGwpXG4gICAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAobWt0Lm1heEJ1eXNbcmF0ZV0pIHtcbiAgICAgIHRoaXMuc2V0TWF4T3JkZXIobWt0Lm1heEJ1eXNbcmF0ZV0uc3dhcClcbiAgICAgIHRoaXMudXBkYXRlT3JkZXJCdHRuU3RhdGUoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIDAgZGVsYXkgZm9yIGZpcnN0IGZldGNoIGFmdGVyIGJhbGFuY2UgdXBkYXRlIG9yIG1hcmtldCBjaGFuZ2UsIG90aGVyd2lzZVxuICAgIC8vIG1ldGVyIHRoZXNlIGF0IDEgLyBzZWMuXG4gICAgY29uc3QgZGVsYXkgPSBPYmplY3Qua2V5cyhta3QubWF4QnV5cykubGVuZ3RoID8gMzUwIDogMFxuICAgIHRoaXMuc2NoZWR1bGVNYXhFc3RpbWF0ZSgnL2FwaS9tYXhidXknLCB7IHJhdGUgfSwgZGVsYXksIChyZXM6IE1heEJ1eSkgPT4ge1xuICAgICAgbWt0Lm1heEJ1eXNbcmF0ZV0gPSByZXMubWF4QnV5XG4gICAgICBta3QuYnV5QmFsYW5jZSA9IGFwcCgpLmFzc2V0c1tta3QucXVvdGUuaWRdLndhbGxldC5iYWxhbmNlLmF2YWlsYWJsZVxuICAgICAgdGhpcy5zZXRNYXhPcmRlcihyZXMubWF4QnV5LnN3YXApXG4gICAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIHNjaGVkdWxlTWF4RXN0aW1hdGUgc2hvd3MgdGhlIGxvYWRpbmcgaWNvbiBhbmQgc2NoZWR1bGVzIGEgY2FsbCB0byBhbiBvcmRlclxuICAgKiBlc3RpbWF0ZSBhcGkgZW5kcG9pbnQuIElmIGFub3RoZXIgY2FsbCB0byBzY2hlZHVsZU1heEVzdGltYXRlIGlzIG1hZGUgYmVmb3JlXG4gICAqIHRoaXMgb25lIGlzIGZpcmVkIChhZnRlciBkZWxheSksIHRoaXMgY2FsbCB3aWxsIGJlIGNhbmNlbGVkLlxuICAgKi9cbiAgc2NoZWR1bGVNYXhFc3RpbWF0ZSAocGF0aDogc3RyaW5nLCBhcmdzOiBhbnksIGRlbGF5OiBudW1iZXIsIHN1Y2Nlc3M6IChyZXM6IGFueSkgPT4gdm9pZCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBpZiAoIXRoaXMubWF4TG9hZGVkKSB0aGlzLm1heExvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5tYXhPcmQpXG4gICAgY29uc3QgW2JpZCwgcWlkXSA9IFt0aGlzLm1hcmtldC5iYXNlLmlkLCB0aGlzLm1hcmtldC5xdW90ZS5pZF1cbiAgICBjb25zdCBbYldhbGxldCwgcVdhbGxldF0gPSBbYXBwKCkuYXNzZXRzW2JpZF0ud2FsbGV0LCBhcHAoKS5hc3NldHNbcWlkXS53YWxsZXRdXG4gICAgaWYgKCFiV2FsbGV0IHx8ICFiV2FsbGV0LnJ1bm5pbmcgfHwgIXFXYWxsZXQgfHwgIXFXYWxsZXQucnVubmluZykgcmV0dXJuXG4gICAgaWYgKHRoaXMubWF4RXN0aW1hdGVUaW1lcikgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLm1heEVzdGltYXRlVGltZXIpXG5cbiAgICBEb2Muc2hvdyhwYWdlLm1heE9yZCwgcGFnZS5tYXhMb3RCb3gpXG4gICAgRG9jLmhpZGUocGFnZS5tYXhBYm92ZVplcm8sIHBhZ2UubWF4WmVyb05vRmVlcywgcGFnZS5tYXhaZXJvTm9CYWwpXG4gICAgcGFnZS5tYXhGcm9tTG90cy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0NBTENVTEFUSU5HKVxuICAgIHBhZ2UubWF4RnJvbUxvdHNMYmwudGV4dENvbnRlbnQgPSAnJ1xuICAgIHRoaXMubWF4T3JkZXJVcGRhdGVDb3VudGVyKytcbiAgICBjb25zdCBjb3VudGVyID0gdGhpcy5tYXhPcmRlclVwZGF0ZUNvdW50ZXJcbiAgICB0aGlzLm1heEVzdGltYXRlVGltZXIgPSB3aW5kb3cuc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLm1heEVzdGltYXRlVGltZXIgPSBudWxsXG4gICAgICBpZiAoY291bnRlciAhPT0gdGhpcy5tYXhPcmRlclVwZGF0ZUNvdW50ZXIpIHJldHVyblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04ocGF0aCwge1xuICAgICAgICBob3N0OiB0aGlzLm1hcmtldC5kZXguaG9zdCxcbiAgICAgICAgYmFzZTogYmlkLFxuICAgICAgICBxdW90ZTogcWlkLFxuICAgICAgICAuLi5hcmdzXG4gICAgICB9KVxuICAgICAgaWYgKGNvdW50ZXIgIT09IHRoaXMubWF4T3JkZXJVcGRhdGVDb3VudGVyKSByZXR1cm5cbiAgICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignbWF4IG9yZGVyIGVzdGltYXRlIG5vdCBhdmFpbGFibGU6JywgcmVzKVxuICAgICAgICBwYWdlLm1heEZyb21Mb3RzLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfRVNUSU1BVEVfVU5BVkFJTEFCTEUpXG4gICAgICAgIGlmICh0aGlzLm1heExvYWRlZCkge1xuICAgICAgICAgIHRoaXMubWF4TG9hZGVkKClcbiAgICAgICAgICB0aGlzLm1heExvYWRlZCA9IG51bGxcbiAgICAgICAgfVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHN1Y2Nlc3MocmVzKVxuICAgIH0sIGRlbGF5KVxuICB9XG5cbiAgLyogc2V0TWF4T3JkZXIgc2V0cyB0aGUgbWF4IG9yZGVyIHRleHQuICovXG4gIHNldE1heE9yZGVyIChtYXhPcmRlcjogU3dhcEVzdGltYXRlIHwgbnVsbCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBpZiAodGhpcy5tYXhMb2FkZWQpIHtcbiAgICAgIHRoaXMubWF4TG9hZGVkKClcbiAgICAgIHRoaXMubWF4TG9hZGVkID0gbnVsbFxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLm1heE9yZCwgcGFnZS5tYXhMb3RCb3gpXG4gICAgY29uc3Qgc2VsbCA9IHRoaXMuaXNTZWxsKClcblxuICAgIGxldCBsb3RzID0gMFxuICAgIGlmIChtYXhPcmRlcikgbG90cyA9IG1heE9yZGVyLmxvdHNcblxuICAgIHBhZ2UubWF4RnJvbUxvdHMudGV4dENvbnRlbnQgPSBsb3RzLnRvU3RyaW5nKClcbiAgICAvLyBYWFggYWRkIHBsdXJhbCBpbnRvIGZvcm1hdCBkZXRhaWxzLCBzbyB3ZSBkb24ndCBuZWVkIHRoaXNcbiAgICBwYWdlLm1heEZyb21Mb3RzTGJsLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGxvdHMgPT09IDEgPyBpbnRsLklEX0xPVCA6IGludGwuSURfTE9UUylcbiAgICBpZiAoIW1heE9yZGVyKSByZXR1cm5cblxuICAgIGNvbnN0IGZyb21Bc3NldCA9IHNlbGwgPyB0aGlzLm1hcmtldC5iYXNlIDogdGhpcy5tYXJrZXQucXVvdGVcblxuICAgIGlmIChsb3RzID09PSAwKSB7XG4gICAgICAvLyBJZiB3ZSBoYXZlIGEgbWF4T3JkZXIsIHNlZSBpZiB3ZSBjYW4gZ3Vlc3Mgd2h5IHdlIGhhdmUgbm8gbG90cy5cbiAgICAgIGxldCBsb3RTaXplID0gdGhpcy5tYXJrZXQuY2ZnLmxvdHNpemVcbiAgICAgIGlmICghc2VsbCkge1xuICAgICAgICBjb25zdCBjb252ZXJzaW9uUmF0ZSA9IHRoaXMuYW55UmF0ZSgpWzFdXG4gICAgICAgIGlmIChjb252ZXJzaW9uUmF0ZSA9PT0gMCkgcmV0dXJuXG4gICAgICAgIGxvdFNpemUgPSBsb3RTaXplICogY29udmVyc2lvblJhdGVcbiAgICAgIH1cbiAgICAgIGNvbnN0IGhhdmVRdHkgPSBmcm9tQXNzZXQud2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC8gbG90U2l6ZSA+IDBcbiAgICAgIGlmIChoYXZlUXR5KSB7XG4gICAgICAgIGlmIChmcm9tQXNzZXQudG9rZW4pIHtcbiAgICAgICAgICBjb25zdCB7IHdhbGxldDogeyBiYWxhbmNlOiB7IGF2YWlsYWJsZTogZmVlQXZhaWwgfSB9LCB1bml0SW5mbyB9ID0gYXBwKCkuYXNzZXRzW2Zyb21Bc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgICAgICAgICBpZiAoZmVlQXZhaWwgPCBtYXhPcmRlci5mZWVSZXNlcnZlc1BlckxvdCkge1xuICAgICAgICAgICAgRG9jLnNob3cocGFnZS5tYXhaZXJvTm9GZWVzKVxuICAgICAgICAgICAgcGFnZS5tYXhaZXJvTm9GZWVzVGlja2VyLnRleHRDb250ZW50ID0gdW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICAgICAgICAgIHBhZ2UubWF4WmVyb01pbkZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG1heE9yZGVyLmZlZVJlc2VydmVzUGVyTG90LCB1bml0SW5mbylcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gSXQgbG9va3MgbGlrZSB3ZSBzaG91bGQgYmUgYWJsZSB0byBhZmZvcmQgaXQsIGJ1dCBtYXliZSBzb21lIGZlZXMgd2UncmUgbm90IHNlZWluZy5cbiAgICAgICAgICAvLyBTaG93IG5vdGhpbmcuXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgLy8gTm90IGEgdG9rZW4uIE1heWJlIHdlIGhhdmUgZW5vdWdoIGZvciB0aGUgc3dhcCBidXQgbm90IGZvciBmZWVzLlxuICAgICAgICBjb25zdCBmdW5kZWRMb3RzID0gZnJvbUFzc2V0LndhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSAvIChsb3RTaXplICsgbWF4T3JkZXIuZmVlUmVzZXJ2ZXNQZXJMb3QpXG4gICAgICAgIGlmIChmdW5kZWRMb3RzID4gMCkgcmV0dXJuIC8vIE5vdCBzdXJlIHdoeS4gQ291bGQgYmUgc3BsaXQgdHhzIG9yIHV0eG9zLiBKdXN0IHNob3cgbm90aGluZy5cbiAgICAgIH1cbiAgICAgIERvYy5zaG93KHBhZ2UubWF4WmVyb05vQmFsKVxuICAgICAgcGFnZS5tYXhaZXJvTm9CYWxUaWNrZXIudGV4dENvbnRlbnQgPSBmcm9tQXNzZXQudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLm1heEFib3ZlWmVybylcblxuICAgIHBhZ2UubWF4RnJvbUFtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWF4T3JkZXIudmFsdWUgfHwgMCwgZnJvbUFzc2V0LnVuaXRJbmZvKVxuICAgIHBhZ2UubWF4RnJvbVRpY2tlci50ZXh0Q29udGVudCA9IGZyb21Bc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgIC8vIENvdWxkIHN1YnRyYWN0IHRoZSBtYXhPcmRlci5yZWRlbXB0aW9uRmVlcyBoZXJlLlxuICAgIC8vIFRoZSBxdHkgY29udmVyc2lvbiBkb2Vzbid0IGZpdCB3ZWxsIHdpdGggdGhlIG5ldyBkZXNpZ24uXG4gICAgLy8gVE9ETzogTWFrZSB0aGlzIHdvcmsgc29tZWhvdz9cbiAgICAvLyBjb25zdCB0b0NvbnZlcnNpb24gPSBzZWxsID8gdGhpcy5hZGp1c3RlZFJhdGUoKSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgOiBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yIC8gdGhpcy5hZGp1c3RlZFJhdGUoKVxuICAgIC8vIHBhZ2UubWF4VG9BbXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKChtYXhPcmRlci52YWx1ZSB8fCAwKSAqIHRvQ29udmVyc2lvbiwgdG9Bc3NldC51bml0SW5mbylcbiAgICAvLyBwYWdlLm1heFRvVGlja2VyLnRleHRDb250ZW50ID0gdG9Bc3NldC5zeW1ib2wudG9VcHBlckNhc2UoKVxuICB9XG5cbiAgLypcbiAgICogdmFsaWRhdGVPcmRlciBwZXJmb3JtcyBzb21lIGJhc2ljIG9yZGVyIHNhbml0eSBjaGVja3MsIHJldHVybmluZyBib29sZWFuXG4gICAqIHRydWUgaWYgdGhlIG9yZGVyIGFwcGVhcnMgdmFsaWQuXG4gICAqL1xuICB2YWxpZGF0ZU9yZGVyIChvcmRlcjogVHJhZGVGb3JtKSB7XG4gICAgY29uc3QgeyBwYWdlLCBtYXJrZXQ6IHsgY2ZnOiB7IG1pbmltdW1SYXRlIH0sIHJhdGVDb252ZXJzaW9uRmFjdG9yIH0gfSA9IHRoaXNcbiAgICBpZiAob3JkZXIuaXNMaW1pdCkge1xuICAgICAgaWYgKCFvcmRlci5yYXRlKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2Uub3JkZXJFcnIpXG4gICAgICAgIHBhZ2Uub3JkZXJFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9OT19aRVJPX1JBVEUpXG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgICAgaWYgKG9yZGVyLnJhdGUgPCBtaW5pbXVtUmF0ZSkge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLm9yZGVyRXJyKVxuICAgICAgICBjb25zdCBbciwgbWluUmF0ZV0gPSBbb3JkZXIucmF0ZSAvIHJhdGVDb252ZXJzaW9uRmFjdG9yLCBtaW5pbXVtUmF0ZSAvIHJhdGVDb252ZXJzaW9uRmFjdG9yXVxuICAgICAgICBwYWdlLm9yZGVyRXJyLnRleHRDb250ZW50ID0gYHJhdGUgaXMgbG93ZXIgdGhhbiB0aGUgbWFya2V0J3MgbWluaW11bSByYXRlLiAke3J9IDwgJHttaW5SYXRlfWBcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfVxuICAgIGlmICghb3JkZXIucXR5KSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLm9yZGVyRXJyKVxuICAgICAgcGFnZS5vcmRlckVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX1pFUk9fUVVBTlRJVFkpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8qIGhhbmRsZUJvb2sgYWNjZXB0cyB0aGUgZGF0YSBzZW50IGluIHRoZSAnYm9vaycgbm90aWZpY2F0aW9uLiAqL1xuICBoYW5kbGVCb29rIChkYXRhOiBNYXJrZXRPcmRlckJvb2spIHtcbiAgICBjb25zdCB7IGNmZywgYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvLCBiYXNlQ2ZnLCBxdW90ZUNmZyB9ID0gdGhpcy5tYXJrZXRcbiAgICB0aGlzLmJvb2sgPSBuZXcgT3JkZXJCb29rKGRhdGEsIGJhc2VDZmcuc3ltYm9sLCBxdW90ZUNmZy5zeW1ib2wpXG4gICAgdGhpcy5sb2FkVGFibGUoKVxuICAgIGZvciAoY29uc3Qgb3JkZXIgb2YgKGRhdGEuYm9vay5lcG9jaCB8fCBbXSkpIHtcbiAgICAgIGlmIChvcmRlci5yYXRlID4gMCkgdGhpcy5ib29rLmFkZChvcmRlcilcbiAgICAgIHRoaXMuYWRkVGFibGVPcmRlcihvcmRlcilcbiAgICB9XG4gICAgaWYgKCF0aGlzLmJvb2spIHtcbiAgICAgIHRoaXMuZGVwdGhDaGFydC5jbGVhcigpXG4gICAgICBEb2MuZW1wdHkodGhpcy5wYWdlLmJ1eVJvd3MpXG4gICAgICBEb2MuZW1wdHkodGhpcy5wYWdlLnNlbGxSb3dzKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHRoaXMucGFnZS5lcG9jaExpbmUpXG4gICAgaWYgKHRoaXMubG9hZGluZ0FuaW1hdGlvbnMuZGVwdGgpIHRoaXMubG9hZGluZ0FuaW1hdGlvbnMuZGVwdGguc3RvcCgpXG4gICAgdGhpcy5kZXB0aENoYXJ0LmNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCdpbnZpc2libGUnKVxuICAgIHRoaXMuZGVwdGhDaGFydC5zZXQodGhpcy5ib29rLCBjZmcubG90c2l6ZSwgY2ZnLnJhdGVzdGVwLCBiYXNlVW5pdEluZm8sIHF1b3RlVW5pdEluZm8pXG4gICAgdGhpcy5yZWNlbnRNYXRjaGVzID0gZGF0YS5ib29rLnJlY2VudE1hdGNoZXMgPz8gW11cbiAgICB0aGlzLnJlZnJlc2hSZWNlbnRNYXRjaGVzVGFibGUoKVxuICB9XG5cbiAgLypcbiAgICogbWlkR2FwQ29udmVudGlvbmFsIGlzIHRoZSBzYW1lIGFzIG1pZEdhcCwgYnV0IHJldHVybnMgdGhlIG1pZC1nYXAgcmF0ZSBhc1xuICAgKiB0aGUgY29udmVudGlvbmFsIHJhdGlvLiBUaGlzIGlzIHVzZWQgdG8gY29udmVydCBmcm9tIGEgY29udmVudGlvbmFsXG4gICAqIHF1YW50aXR5IGZyb20gYmFzZSB0byBxdW90ZSBvciB2aWNlLXZlcnNhLCBvciBmb3IgZGlzcGxheSBwdXJwb3Nlcy5cbiAgICovXG4gIG1pZEdhcENvbnZlbnRpb25hbCAoKSB7XG4gICAgY29uc3QgZ2FwID0gdGhpcy5taWRHYXAoKVxuICAgIGlmICghZ2FwKSByZXR1cm4gZ2FwXG4gICAgY29uc3QgeyBiYXNlVW5pdEluZm86IGIsIHF1b3RlVW5pdEluZm86IHEgfSA9IHRoaXMubWFya2V0XG4gICAgcmV0dXJuIGdhcCAqIGIuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgLyBxLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gIH1cblxuICAvKlxuICAgKiBtaWRHYXAgcmV0dXJucyB0aGUgdmFsdWUgaW4gdGhlIG1pZGRsZSBvZiB0aGUgYmVzdCBidXkgYW5kIGJlc3Qgc2VsbC4gSWZcbiAgICogZWl0aGVyIG9uZSBvZiB0aGUgYnV5IG9yIHNlbGwgc2lkZXMgYXJlIGVtcHR5LCBtaWRHYXAgcmV0dXJucyB0aGUgYmVzdCByYXRlXG4gICAqIGZyb20gdGhlIG90aGVyIHNpZGUuIElmIGJvdGggc2lkZXMgYXJlIGVtcHR5LCBtaWRHYXAgcmV0dXJucyB0aGUgdmFsdWVcbiAgICogbnVsbC4gVGhlIHJhdGUgcmV0dXJuZWQgaXMgdGhlIGF0b21pYyByYXRpbywgdXNlZCBmb3IgY29udmVyc2lvbi4gRm9yIGFcbiAgICogY29udmVudGlvbmFsIHJhdGUgZm9yIGRpc3BsYXkgb3IgdG8gY29udmVydCBjb252ZW50aW9uYWwgdW5pdHMsIHVzZVxuICAgKiBtaWRHYXBDb252ZW50aW9uYWxcbiAgICovXG4gIG1pZEdhcCAoKSB7XG4gICAgY29uc3QgYm9vayA9IHRoaXMuYm9va1xuICAgIGlmICghYm9vaykgcmV0dXJuXG4gICAgaWYgKGJvb2suYnV5cyAmJiBib29rLmJ1eXMubGVuZ3RoKSB7XG4gICAgICBpZiAoYm9vay5zZWxscyAmJiBib29rLnNlbGxzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gKGJvb2suYnV5c1swXS5tc2dSYXRlICsgYm9vay5zZWxsc1swXS5tc2dSYXRlKSAvIDIgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yXG4gICAgICB9XG4gICAgICByZXR1cm4gYm9vay5idXlzWzBdLm1zZ1JhdGUgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yXG4gICAgfVxuICAgIGlmIChib29rLnNlbGxzICYmIGJvb2suc2VsbHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gYm9vay5zZWxsc1swXS5tc2dSYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvclxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLypcbiAgICogc2V0TWFya2V0QnV5T3JkZXJFc3RpbWF0ZSBzZXRzIHRoZSBcIm1pbi4gYnV5XCIgZGlzcGxheSBmb3IgdGhlIGN1cnJlbnRcbiAgICogbWFya2V0LlxuICAgKi9cbiAgc2V0TWFya2V0QnV5T3JkZXJFc3RpbWF0ZSAoKSB7XG4gICAgY29uc3QgbWFya2V0ID0gdGhpcy5tYXJrZXRcbiAgICBjb25zdCBsb3RTaXplID0gbWFya2V0LmNmZy5sb3RzaXplXG4gICAgY29uc3QgeGMgPSBhcHAoKS51c2VyLmV4Y2hhbmdlc1ttYXJrZXQuZGV4Lmhvc3RdXG4gICAgY29uc3QgYnVmZmVyID0geGMubWFya2V0c1ttYXJrZXQuc2lkXS5idXlidWZmZXJcbiAgICBjb25zdCBnYXAgPSB0aGlzLm1pZEdhcENvbnZlbnRpb25hbCgpXG4gICAgaWYgKGdhcCkge1xuICAgICAgdGhpcy5wYWdlLm1pbk1rdEJ1eS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobG90U2l6ZSAqIGJ1ZmZlciAqIGdhcCwgbWFya2V0LmJhc2VVbml0SW5mbylcbiAgICB9XG4gIH1cblxuICBtYXhVc2VyT3JkZXJDb3VudCAoKTogbnVtYmVyIHtcbiAgICBjb25zdCB7IGRleDogeyBob3N0IH0sIGNmZzogeyBuYW1lOiBta3RJRCB9IH0gPSB0aGlzLm1hcmtldFxuICAgIHJldHVybiBNYXRoLm1heChtYXhVc2VyT3JkZXJzU2hvd24sIGFwcCgpLm9yZGVycyhob3N0LCBta3RJRCkubGVuZ3RoKVxuICB9XG5cbiAgYXN5bmMgbG9hZFVzZXJPcmRlcnMgKCkge1xuICAgIGNvbnN0IHsgYmFzZTogYiwgcXVvdGU6IHEsIGRleDogeyBob3N0IH0sIGNmZzogeyBuYW1lOiBta3RJRCB9IH0gPSB0aGlzLm1hcmtldFxuICAgIGZvciAoY29uc3Qgb2lkIGluIHRoaXMubWV0YU9yZGVycykgZGVsZXRlIHRoaXMubWV0YU9yZGVyc1tvaWRdXG4gICAgaWYgKCFiIHx8ICFxKSByZXR1cm4gdGhpcy5yZXNvbHZlVXNlck9yZGVycyhbXSkgLy8gdW5zdXBwb3J0ZWQgYXNzZXRcbiAgICBjb25zdCBhY3RpdmVPcmRlcnMgPSBhcHAoKS5vcmRlcnMoaG9zdCwgbWt0SUQpXG4gICAgaWYgKGFjdGl2ZU9yZGVycy5sZW5ndGggPj0gbWF4VXNlck9yZGVyc1Nob3duKSByZXR1cm4gdGhpcy5yZXNvbHZlVXNlck9yZGVycyhhY3RpdmVPcmRlcnMpXG4gICAgY29uc3QgZmlsdGVyOiBPcmRlckZpbHRlciA9IHtcbiAgICAgIGhvc3RzOiBbaG9zdF0sXG4gICAgICBtYXJrZXQ6IHsgYmFzZUlEOiBiLmlkLCBxdW90ZUlEOiBxLmlkIH0sXG4gICAgICBuOiB0aGlzLm1heFVzZXJPcmRlckNvdW50KClcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvb3JkZXJzJywgZmlsdGVyKVxuICAgIGNvbnN0IG9yZGVycyA9IHJlcy5vcmRlcnMgfHwgW11cbiAgICAvLyBNYWtlIHN1cmUgYWxsIGFjdGl2ZSBvcmRlcnMgYXJlIGluIHRoZXJlLiBUaGUgL29yZGVycyBBUEkgc29ydHMgYnkgdGltZSxcbiAgICAvLyBzbyBpZiB0aGVyZSBpcyBhcmUgMTAgY2FuY2VsbGVkL2V4ZWN1dGVkIG9yZGVycyBuZXdlciB0aGFuIGFuIG9sZCBhY3RpdmVcbiAgICAvLyBvcmRlciwgdGhlIGFjdGl2ZSBvcmRlciB3b3VsZG4ndCBiZSBpbmNsdWRlZCBpbiB0aGUgcmVzdWx0LlxuICAgIGZvciAoY29uc3QgYWN0aXZlT3JkIG9mIGFjdGl2ZU9yZGVycykgaWYgKCFvcmRlcnMuc29tZSgoZGJPcmQ6IE9yZGVyKSA9PiBkYk9yZC5pZCA9PT0gYWN0aXZlT3JkLmlkKSkgb3JkZXJzLnB1c2goYWN0aXZlT3JkKVxuICAgIHJldHVybiB0aGlzLnJlc29sdmVVc2VyT3JkZXJzKHJlcy5vcmRlcnMgfHwgW10pXG4gIH1cblxuICAvKiByZWZyZXNoQWN0aXZlT3JkZXJzIHJlZnJlc2hlcyB0aGUgdXNlcidzIGFjdGl2ZSBvcmRlciBsaXN0LiAqL1xuICByZWZyZXNoQWN0aXZlT3JkZXJzICgpIHtcbiAgICBjb25zdCBvcmRlcnMgPSBhcHAoKS5vcmRlcnModGhpcy5tYXJrZXQuZGV4Lmhvc3QsIG1hcmtldElEKHRoaXMubWFya2V0LmJhc2VDZmcuc3ltYm9sLCB0aGlzLm1hcmtldC5xdW90ZUNmZy5zeW1ib2wpKVxuICAgIHJldHVybiB0aGlzLnJlc29sdmVVc2VyT3JkZXJzKG9yZGVycylcbiAgfVxuXG4gIHJlc29sdmVVc2VyT3JkZXJzIChvcmRlcnM6IE9yZGVyW10pIHtcbiAgICBjb25zdCB7IHBhZ2UsIG1ldGFPcmRlcnMsIG1hcmtldCB9ID0gdGhpc1xuICAgIGNvbnN0IGNmZyA9IG1hcmtldC5jZmdcblxuICAgIGNvbnN0IG9yZGVySXNBY3RpdmUgPSAob3JkOiBPcmRlcikgPT4gb3JkLnN0YXR1cyA8IE9yZGVyVXRpbC5TdGF0dXNFeGVjdXRlZCB8fCBPcmRlclV0aWwuaGFzQWN0aXZlTWF0Y2hlcyhvcmQpXG5cbiAgICBmb3IgKGNvbnN0IG9yZCBvZiBvcmRlcnMpIG1ldGFPcmRlcnNbb3JkLmlkXSA9IHsgb3JkOiBvcmQgfSBhcyBNZXRhT3JkZXJcbiAgICBsZXQgc29ydGVkT3JkZXJzID0gT2JqZWN0LmtleXMobWV0YU9yZGVycykubWFwKChvaWQ6IHN0cmluZykgPT4gbWV0YU9yZGVyc1tvaWRdKVxuICAgIHNvcnRlZE9yZGVycy5zb3J0KChhOiBNZXRhT3JkZXIsIGI6IE1ldGFPcmRlcikgPT4ge1xuICAgICAgY29uc3QgW2FBY3RpdmUsIGJBY3RpdmVdID0gW29yZGVySXNBY3RpdmUoYS5vcmQpLCBvcmRlcklzQWN0aXZlKGIub3JkKV1cbiAgICAgIGlmIChhQWN0aXZlICYmICFiQWN0aXZlKSByZXR1cm4gLTFcbiAgICAgIGVsc2UgaWYgKCFhQWN0aXZlICYmIGJBY3RpdmUpIHJldHVybiAxXG4gICAgICByZXR1cm4gYi5vcmQuc3VibWl0VGltZSAtIGEub3JkLnN1Ym1pdFRpbWVcbiAgICB9KVxuICAgIGNvbnN0IG4gPSB0aGlzLm1heFVzZXJPcmRlckNvdW50KClcbiAgICBpZiAoc29ydGVkT3JkZXJzLmxlbmd0aCA+IG4pIHsgc29ydGVkT3JkZXJzID0gc29ydGVkT3JkZXJzLnNsaWNlKDAsIG4pIH1cblxuICAgIGZvciAoY29uc3Qgb2lkIGluIG1ldGFPcmRlcnMpIGRlbGV0ZSBtZXRhT3JkZXJzW29pZF1cblxuICAgIERvYy5lbXB0eShwYWdlLnVzZXJPcmRlcnMpXG4gICAgRG9jLnNldFZpcyhzb3J0ZWRPcmRlcnM/Lmxlbmd0aCwgcGFnZS51c2VyT3JkZXJzKVxuICAgIERvYy5zZXRWaXMoIXNvcnRlZE9yZGVycz8ubGVuZ3RoLCBwYWdlLnVzZXJOb09yZGVycylcblxuICAgIGxldCB1bnJlYWR5T3JkZXJzID0gZmFsc2VcbiAgICBmb3IgKGNvbnN0IG1vcmQgb2Ygc29ydGVkT3JkZXJzKSB7XG4gICAgICBjb25zdCBkaXYgPSBwYWdlLnVzZXJPcmRlclRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgICBwYWdlLnVzZXJPcmRlcnMuYXBwZW5kQ2hpbGQoZGl2KVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICAgIGNvbnN0IGhlYWRlciA9IERvYy5wYXJzZVRlbXBsYXRlKHRtcGwuaGVhZGVyKVxuICAgICAgY29uc3QgZGV0YWlscyA9IERvYy5wYXJzZVRlbXBsYXRlKHRtcGwuZGV0YWlscylcblxuICAgICAgbW9yZC5kaXYgPSBkaXZcbiAgICAgIG1vcmQuaGVhZGVyID0gaGVhZGVyXG4gICAgICBtb3JkLmRldGFpbHMgPSBkZXRhaWxzXG4gICAgICBjb25zdCBvcmQgPSBtb3JkLm9yZFxuXG4gICAgICBjb25zdCBvcmRlcklEID0gb3JkLmlkXG4gICAgICBjb25zdCBpc0FjdGl2ZSA9IG9yZGVySXNBY3RpdmUob3JkKVxuXG4gICAgICAvLyBObyBuZWVkIHRvIHRyYWNrIGluLWZsaWdodCBvcmRlcnMgaGVyZS4gV2UndmUgYWxyZWFkeSBhZGRlZCBpdCB0b1xuICAgICAgLy8gZGlzcGxheS5cbiAgICAgIGlmIChvcmRlcklEKSBtZXRhT3JkZXJzW29yZGVySURdID0gbW9yZFxuXG4gICAgICBpZiAoIW9yZC5yZWFkeVRvVGljayAmJiBPcmRlclV0aWwuaGFzQWN0aXZlTWF0Y2hlcyhvcmQpKSB7XG4gICAgICAgIHRtcGwuaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ3VucmVhZHktdXNlci1vcmRlcicpXG4gICAgICAgIHVucmVhZHlPcmRlcnMgPSB0cnVlXG4gICAgICB9XG4gICAgICBoZWFkZXIuc2lkZUxpZ2h0LmNsYXNzTGlzdC5hZGQob3JkLnNlbGwgPyAnc2VsbCcgOiAnYnV5JylcbiAgICAgIGlmICghaXNBY3RpdmUpIGhlYWRlci5zaWRlTGlnaHQuY2xhc3NMaXN0LmFkZCgnaW5hY3RpdmUnKVxuICAgICAgZGV0YWlscy5zaWRlLnRleHRDb250ZW50ID0gbW9yZC5oZWFkZXIuc2lkZS50ZXh0Q29udGVudCA9IE9yZGVyVXRpbC5zZWxsU3RyaW5nKG9yZClcbiAgICAgIGRldGFpbHMuc2lkZS5jbGFzc0xpc3QuYWRkKG9yZC5zZWxsID8gJ3NlbGxjb2xvcicgOiAnYnV5Y29sb3InKVxuICAgICAgaGVhZGVyLnNpZGUuY2xhc3NMaXN0LmFkZChvcmQuc2VsbCA/ICdzZWxsY29sb3InIDogJ2J1eWNvbG9yJylcbiAgICAgIGRldGFpbHMucXR5LnRleHRDb250ZW50ID0gbW9yZC5oZWFkZXIucXR5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmQucXR5LCBtYXJrZXQuYmFzZVVuaXRJbmZvKVxuICAgICAgbGV0IHJhdGVTdHI6IHN0cmluZ1xuICAgICAgaWYgKG9yZC50eXBlID09PSBPcmRlclV0aWwuTWFya2V0KSByYXRlU3RyID0gdGhpcy5tYXJrZXRPcmRlclJhdGVTdHJpbmcob3JkLCBtYXJrZXQpXG4gICAgICBlbHNlIHJhdGVTdHIgPSBEb2MuZm9ybWF0UmF0ZUZ1bGxQcmVjaXNpb24ob3JkLnJhdGUsIG1hcmtldC5iYXNlVW5pdEluZm8sIG1hcmtldC5xdW90ZVVuaXRJbmZvLCBjZmcucmF0ZXN0ZXApXG4gICAgICBkZXRhaWxzLnJhdGUudGV4dENvbnRlbnQgPSBtb3JkLmhlYWRlci5yYXRlLnRleHRDb250ZW50ID0gcmF0ZVN0clxuICAgICAgaGVhZGVyLmJhc2VTeW1ib2wudGV4dENvbnRlbnQgPSBtYXJrZXQuYmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XG4gICAgICBkZXRhaWxzLnR5cGUudGV4dENvbnRlbnQgPSBPcmRlclV0aWwub3JkZXJUeXBlVGV4dChvcmQudHlwZSlcbiAgICAgIHRoaXMudXBkYXRlTWV0YU9yZGVyKG1vcmQpXG5cbiAgICAgIERvYy5iaW5kKGRpdiwgJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuYWN0aXZlTWFya2VyUmF0ZSA9IG9yZC5yYXRlXG4gICAgICAgIHRoaXMuc2V0RGVwdGhNYXJrZXJzKClcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHNob3dDYW5jZWwgPSAoZTogRXZlbnQpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICB0aGlzLnNob3dDYW5jZWwoZGl2LCBvcmRlcklEKVxuICAgICAgfVxuXG4gICAgICBjb25zdCBzaG93QWNjZWxlcmF0ZSA9IChlOiBFdmVudCkgPT4ge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgIHRoaXMuc2hvd0FjY2VsZXJhdGUob3JkKVxuICAgICAgfVxuXG4gICAgICBpZiAoIW9yZGVySUQpIHtcbiAgICAgICAgRG9jLmhpZGUoZGV0YWlscy5hY2NlbGVyYXRlQnR0bilcbiAgICAgICAgRG9jLmhpZGUoZGV0YWlscy5jYW5jZWxCdHRuKVxuICAgICAgICBEb2MuaGlkZShkZXRhaWxzLmxpbmspXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoT3JkZXJVdGlsLmlzQ2FuY2VsbGFibGUob3JkKSkge1xuICAgICAgICAgIERvYy5zaG93KGRldGFpbHMuY2FuY2VsQnR0bilcbiAgICAgICAgICBiaW5kKGRldGFpbHMuY2FuY2VsQnR0biwgJ2NsaWNrJywgKGU6IEV2ZW50KSA9PiB7IHNob3dDYW5jZWwoZSkgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGJpbmQoZGV0YWlscy5hY2NlbGVyYXRlQnR0biwgJ2NsaWNrJywgKGU6IEV2ZW50KSA9PiB7IHNob3dBY2NlbGVyYXRlKGUpIH0pXG4gICAgICAgIGlmIChhcHAoKS5jYW5BY2NlbGVyYXRlT3JkZXIob3JkKSkge1xuICAgICAgICAgIERvYy5zaG93KGRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4pXG4gICAgICAgIH1cblxuICAgICAgICBkZXRhaWxzLmxpbmsuaHJlZiA9IGBvcmRlci8ke29yZGVySUR9YFxuICAgICAgICBhcHAoKS5iaW5kSW50ZXJuYWxOYXZpZ2F0aW9uKGRpdilcbiAgICAgIH1cbiAgICAgIGxldCBjdXJyZW50RmxvYXRlcjogKFBhZ2VFbGVtZW50IHwgbnVsbClcbiAgICAgIERvYy5iaW5kKHRtcGwuaGVhZGVyLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmIChEb2MuaXNEaXNwbGF5ZWQodG1wbC5kZXRhaWxzKSkge1xuICAgICAgICAgIERvYy5oaWRlKHRtcGwuZGV0YWlscylcbiAgICAgICAgICBoZWFkZXIuZXhwYW5kZXIuY2xhc3NMaXN0LmFkZCgnaWNvLWFycm93ZG93bicpXG4gICAgICAgICAgaGVhZGVyLmV4cGFuZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2ljby1hcnJvd3VwJylcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBEb2Muc2hvdyh0bXBsLmRldGFpbHMpXG4gICAgICAgIGhlYWRlci5leHBhbmRlci5jbGFzc0xpc3QucmVtb3ZlKCdpY28tYXJyb3dkb3duJylcbiAgICAgICAgaGVhZGVyLmV4cGFuZGVyLmNsYXNzTGlzdC5hZGQoJ2ljby1hcnJvd3VwJylcbiAgICAgICAgaWYgKGN1cnJlbnRGbG9hdGVyKSBjdXJyZW50RmxvYXRlci5yZW1vdmUoKVxuICAgICAgfSlcbiAgICAgIC8qKlxuICAgICAgICogV2UnbGwgc2hvdyB0aGUgYnV0dG9uIG1lbnUgd2hlbiB0aGV5IGhvdmVyIG92ZXIgdGhlIGhlYWRlci4gVG8gYXZvaWRcbiAgICAgICAqIHB1c2hpbmcgdGhlIGxheW91dCBhcm91bmQsIHdlJ2xsIHNob3cgdGhlIGJ1dHRvbnMgYXMgYW4gYWJzb2x1dGVseVxuICAgICAgICogcG9zaXRpb25lZCBjb3B5IG9mIHRoZSBidXR0b24gbWVudS5cbiAgICAgICAqL1xuICAgICAgRG9jLmJpbmQodG1wbC5oZWFkZXIsICdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAvLyBEb24ndCBzaG93IHRoZSBjb3B5IGlmIHRoZSBkZXRhaWxzIGFyZSBhbHJlYWR5IGRpc3BsYXllZC5cbiAgICAgICAgaWYgKERvYy5pc0Rpc3BsYXllZCh0bXBsLmRldGFpbHMpKSByZXR1cm5cbiAgICAgICAgaWYgKGN1cnJlbnRGbG9hdGVyKSBjdXJyZW50RmxvYXRlci5yZW1vdmUoKVxuICAgICAgICAvLyBDcmVhdGUgYW5kIHBvc2l0aW9uIHRoZSBlbGVtZW50IGJhc2VkIG9uIHRoZSBwb3NpdGlvbiBvZiB0aGUgaGVhZGVyLlxuICAgICAgICBjb25zdCBmbG9hdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgICAgY3VycmVudEZsb2F0ZXIgPSBmbG9hdGVyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZmxvYXRlcilcbiAgICAgICAgZmxvYXRlci5jbGFzc05hbWUgPSAndXNlci1vcmRlci1mbG9hdHktbWVudSdcbiAgICAgICAgY29uc3QgbSA9IERvYy5sYXlvdXRNZXRyaWNzKHRtcGwuaGVhZGVyKVxuICAgICAgICBjb25zdCB5ID0gbS5ib2R5VG9wICsgbS5oZWlnaHRcbiAgICAgICAgZmxvYXRlci5zdHlsZS50b3AgPSBgJHt5IC0gMX1weGAgLy8gLSAxIHRvIGhpZGUgYm9yZGVyIG9uIGhlYWRlciBkaXZcbiAgICAgICAgZmxvYXRlci5zdHlsZS5sZWZ0ID0gYCR7bS5ib2R5TGVmdH1weGBcbiAgICAgICAgLy8gR2V0IHRoZSB1cGRhdGVkIHZlcnNpb24gb2YgdGhlIG9yZGVyXG4gICAgICAgIGNvbnN0IG1vcmQgPSB0aGlzLm1ldGFPcmRlcnNbb3JkZXJJRF1cbiAgICAgICAgY29uc3Qgb3JkID0gbW9yZC5vcmRcblxuICAgICAgICBjb25zdCBhZGRCdXR0b24gPSAoYmFzZUJ0dG46IFBhZ2VFbGVtZW50LCBjYjogKChlOiBFdmVudCkgPT4gdm9pZCkpID0+IHtcbiAgICAgICAgICBjb25zdCBpY29uID0gYmFzZUJ0dG4uY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgICAgZmxvYXRlci5hcHBlbmRDaGlsZChpY29uKVxuICAgICAgICAgIERvYy5zaG93KGljb24pXG4gICAgICAgICAgRG9jLmJpbmQoaWNvbiwgJ2NsaWNrJywgKGU6IEV2ZW50KSA9PiB7IGNiKGUpIH0pXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoT3JkZXJVdGlsLmlzQ2FuY2VsbGFibGUob3JkKSkgYWRkQnV0dG9uKGRldGFpbHMuY2FuY2VsQnR0biwgKGU6IEV2ZW50KSA9PiB7IHNob3dDYW5jZWwoZSkgfSlcbiAgICAgICAgaWYgKGFwcCgpLmNhbkFjY2VsZXJhdGVPcmRlcihvcmQpKSBhZGRCdXR0b24oZGV0YWlscy5hY2NlbGVyYXRlQnR0biwgKGU6IEV2ZW50KSA9PiB7IHNob3dBY2NlbGVyYXRlKGUpIH0pXG4gICAgICAgIGZsb2F0ZXIuYXBwZW5kQ2hpbGQoZGV0YWlscy5saW5rLmNsb25lTm9kZSh0cnVlKSlcblxuICAgICAgICBjb25zdCBvZ1Njcm9sbFkgPSBwYWdlLm9yZGVyU2Nyb2xsZXIuc2Nyb2xsVG9wXG4gICAgICAgIC8vIFNldCB1cCB0aGUgaG92ZXIgaW50ZXJhY3Rpb25zLlxuICAgICAgICBjb25zdCBtb3ZlZCA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgLy8gSWYgdGhlIHVzZXIgc2Nyb2xsZWQsIHJlcG9zaXRpb24gdGhlIGZsb2F0IG1lbnUuIFRoaXMga2VlcHMgdGhlXG4gICAgICAgICAgLy8gbWVudSBmcm9tIGZvbGxvd2luZyB1cyBhcm91bmQsIHdoaWNoIGNhbiBwcmV2ZW50IHJlbW92YWwgYmVsb3cuXG4gICAgICAgICAgY29uc3QgeVNoaWZ0ID0gcGFnZS5vcmRlclNjcm9sbGVyLnNjcm9sbFRvcCAtIG9nU2Nyb2xsWVxuICAgICAgICAgIGZsb2F0ZXIuc3R5bGUudG9wID0gYCR7eSArIHlTaGlmdH1weGBcbiAgICAgICAgICBpZiAoRG9jLm1vdXNlSW5FbGVtZW50KGUsIGZsb2F0ZXIpIHx8IERvYy5tb3VzZUluRWxlbWVudChlLCBkaXYpKSByZXR1cm5cbiAgICAgICAgICBmbG9hdGVyLnJlbW92ZSgpXG4gICAgICAgICAgY3VycmVudEZsb2F0ZXIgPSBudWxsXG4gICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgbW92ZWQpXG4gICAgICAgICAgcGFnZS5vcmRlclNjcm9sbGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIG1vdmVkKVxuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdmVkKVxuICAgICAgICBwYWdlLm9yZGVyU2Nyb2xsZXIuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgbW92ZWQpXG4gICAgICB9KVxuICAgICAgYXBwKCkuYmluZFRvb2x0aXBzKGRpdilcbiAgICB9XG4gICAgRG9jLnNldFZpcyh1bnJlYWR5T3JkZXJzLCBwYWdlLnVucmVhZHlPcmRlcnNNc2cpXG4gICAgdGhpcy5zZXREZXB0aE1hcmtlcnMoKVxuICB9XG5cbiAgLypcbiAgIG1hcmtldE9yZGVyUmF0ZVN0cmluZyB1c2VzIHRoZSBtYXJrZXQgY29uZmlnIHJhdGUgc3RlcCB0byBmb3JtYXQgdGhlIGF2ZXJhZ2VcbiAgIG1hcmtldCBvcmRlciByYXRlLlxuICAqL1xuICBtYXJrZXRPcmRlclJhdGVTdHJpbmcgKG9yZDogT3JkZXIsIG1rdDogQ3VycmVudE1hcmtldCkgOnN0cmluZyB7XG4gICAgaWYgKCFvcmQubWF0Y2hlcz8ubGVuZ3RoKSByZXR1cm4gaW50bC5wcmVwKGludGwuSURfTUFSS0VUX09SREVSKVxuICAgIGxldCByYXRlU3RyID0gRG9jLmZvcm1hdFJhdGVGdWxsUHJlY2lzaW9uKE9yZGVyVXRpbC5hdmVyYWdlUmF0ZShvcmQpLCBta3QuYmFzZVVuaXRJbmZvLCBta3QucXVvdGVVbml0SW5mbywgbWt0LmNmZy5yYXRlc3RlcClcbiAgICBpZiAob3JkLm1hdGNoZXMubGVuZ3RoID4gMSkgcmF0ZVN0ciA9ICd+ICcgKyByYXRlU3RyIC8vIH4gb25seSBtYWtlcyBzZW5zZSBpZiB0aGUgb3JkZXIgaGFzIG1vcmUgdGhhbiBvbmUgbWF0Y2hcbiAgICByZXR1cm4gcmF0ZVN0clxuICB9XG5cbiAgLypcbiAgKiB1cGRhdGVNZXRhT3JkZXIgc2V0cyB0aGUgdGQgY29udGVudHMgb2YgdGhlIHVzZXIncyBvcmRlciB0YWJsZSByb3cuXG4gICovXG4gIHVwZGF0ZU1ldGFPcmRlciAobW9yZDogTWV0YU9yZGVyKSB7XG4gICAgY29uc3QgeyBoZWFkZXIsIGRldGFpbHMsIG9yZCB9ID0gbW9yZFxuICAgIGlmIChvcmQuc3RhdHVzIDw9IE9yZGVyVXRpbC5TdGF0dXNCb29rZWQgfHwgT3JkZXJVdGlsLmhhc0FjdGl2ZU1hdGNoZXMob3JkKSkgaGVhZGVyLmFjdGl2ZUxpZ2h0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgZWxzZSBoZWFkZXIuYWN0aXZlTGlnaHQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICBkZXRhaWxzLnN0YXR1cy50ZXh0Q29udGVudCA9IGhlYWRlci5zdGF0dXMudGV4dENvbnRlbnQgPSBPcmRlclV0aWwuc3RhdHVzU3RyaW5nKG9yZClcbiAgICBkZXRhaWxzLmFnZS50ZXh0Q29udGVudCA9IERvYy50aW1lU2luY2Uob3JkLnN1Ym1pdFRpbWUpXG4gICAgZGV0YWlscy5maWxsZWQudGV4dENvbnRlbnQgPSBgJHsoT3JkZXJVdGlsLmZpbGxlZChvcmQpIC8gb3JkLnF0eSAqIDEwMCkudG9GaXhlZCgxKX0lYFxuICAgIGRldGFpbHMuc2V0dGxlZC50ZXh0Q29udGVudCA9IGAkeyhPcmRlclV0aWwuc2V0dGxlZChvcmQpIC8gb3JkLnF0eSAqIDEwMCkudG9GaXhlZCgxKX0lYFxuICB9XG5cbiAgLyogc2V0TWFya2VycyBzZXRzIHRoZSBkZXB0aCBjaGFydCBtYXJrZXJzIGZvciBib29rZWQgb3JkZXJzLiAqL1xuICBzZXREZXB0aE1hcmtlcnMgKCkge1xuICAgIGNvbnN0IG1hcmtlcnM6IFJlY29yZDxzdHJpbmcsIERlcHRoTWFya2VyW10+ID0ge1xuICAgICAgYnV5czogW10sXG4gICAgICBzZWxsczogW11cbiAgICB9XG4gICAgY29uc3QgcmF0ZUZhY3RvciA9IHRoaXMubWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yXG4gICAgZm9yIChjb25zdCB7IG9yZCB9IG9mIE9iamVjdC52YWx1ZXModGhpcy5tZXRhT3JkZXJzKSkge1xuICAgICAgaWYgKG9yZC5yYXRlICYmIG9yZC5zdGF0dXMgPT09IE9yZGVyVXRpbC5TdGF0dXNCb29rZWQpIHtcbiAgICAgICAgaWYgKG9yZC5zZWxsKSB7XG4gICAgICAgICAgbWFya2Vycy5zZWxscy5wdXNoKHtcbiAgICAgICAgICAgIHJhdGU6IG9yZC5yYXRlIC8gcmF0ZUZhY3RvcixcbiAgICAgICAgICAgIGFjdGl2ZTogb3JkLnJhdGUgPT09IHRoaXMuYWN0aXZlTWFya2VyUmF0ZVxuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWFya2Vycy5idXlzLnB1c2goe1xuICAgICAgICAgICAgcmF0ZTogb3JkLnJhdGUgLyByYXRlRmFjdG9yLFxuICAgICAgICAgICAgYWN0aXZlOiBvcmQucmF0ZSA9PT0gdGhpcy5hY3RpdmVNYXJrZXJSYXRlXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmRlcHRoQ2hhcnQuc2V0TWFya2VycyhtYXJrZXJzKVxuICAgIGlmICh0aGlzLmJvb2spIHRoaXMuZGVwdGhDaGFydC5kcmF3KClcbiAgfVxuXG4gIC8qIHVwZGF0ZVRpdGxlIHVwZGF0ZSB0aGUgYnJvd3NlciB0aXRsZSBiYXNlZCBvbiB0aGUgbWlkZ2FwIHZhbHVlIGFuZCB0aGVcbiAgICogc2VsZWN0ZWQgYXNzZXRzLlxuICAgKi9cbiAgdXBkYXRlVGl0bGUgKCkge1xuICAgIC8vIGdldHMgZmlyc3QgcHJpY2UgdmFsdWUgZnJvbSBidXkgb3IgZnJvbSBzZWxsLCBzbyB3ZSBjYW4gc2hvdyBpdCBvblxuICAgIC8vIHRpdGxlLlxuICAgIGNvbnN0IG1pZEdhcFZhbHVlID0gdGhpcy5taWRHYXBDb252ZW50aW9uYWwoKVxuICAgIGNvbnN0IHsgYmFzZVVuaXRJbmZvOiB7IGNvbnZlbnRpb25hbDogeyB1bml0OiBiVW5pdCB9IH0sIHF1b3RlVW5pdEluZm86IHsgY29udmVudGlvbmFsOiB7IHVuaXQ6IHFVbml0IH0gfSB9ID0gdGhpcy5tYXJrZXRcbiAgICBpZiAoIW1pZEdhcFZhbHVlKSBkb2N1bWVudC50aXRsZSA9IGAke2JVbml0fSR7cVVuaXR9IHwgJHt0aGlzLm9nVGl0bGV9YFxuICAgIGVsc2UgZG9jdW1lbnQudGl0bGUgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKG1pZEdhcFZhbHVlKX0gfCAke2JVbml0fSR7cVVuaXR9IHwgJHt0aGlzLm9nVGl0bGV9YCAvLyBtb3JlIHRoYW4gNiBudW1iZXJzIGl0IGdldHMgdG9vIGJpZyBmb3IgdGhlIHRpdGxlLlxuICB9XG5cbiAgLyogaGFuZGxlQm9va1JvdXRlIGlzIHRoZSBoYW5kbGVyIGZvciB0aGUgJ2Jvb2snIG5vdGlmaWNhdGlvbiwgd2hpY2ggaXMgc2VudFxuICAgKiBpbiByZXNwb25zZSB0byBhIG5ldyBtYXJrZXQgc3Vic2NyaXB0aW9uLiBUaGUgZGF0YSByZWNlaXZlZCB3aWxsIGNvbnRhaW5cbiAgICogdGhlIGVudGlyZSBvcmRlciBib29rLlxuICAgKi9cbiAgaGFuZGxlQm9va1JvdXRlIChub3RlOiBCb29rVXBkYXRlKSB7XG4gICAgYXBwKCkubG9nKCdib29rJywgJ2hhbmRsZUJvb2tSb3V0ZTonLCBub3RlKVxuICAgIGNvbnN0IG1rdEJvb2sgPSBub3RlLnBheWxvYWRcbiAgICBjb25zdCB7IGJhc2VDZmc6IGIsIHF1b3RlQ2ZnOiBxLCBkZXg6IHsgaG9zdCB9IH0gPSB0aGlzLm1hcmtldFxuICAgIGlmIChta3RCb29rLmJhc2UgIT09IGIuaWQgfHwgbWt0Qm9vay5xdW90ZSAhPT0gcS5pZCB8fCBub3RlLmhvc3QgIT09IGhvc3QpIHJldHVybiAvLyB1c2VyIGFscmVhZHkgY2hhbmdlZCBtYXJrZXRzXG4gICAgdGhpcy5oYW5kbGVCb29rKG1rdEJvb2spXG4gICAgdGhpcy5tYXJrZXQuYm9va0xvYWRlZCA9IHRydWVcbiAgICB0aGlzLnVwZGF0ZVRpdGxlKClcbiAgICB0aGlzLnNldE1hcmtldEJ1eU9yZGVyRXN0aW1hdGUoKVxuICB9XG5cbiAgLyogaGFuZGxlQm9va09yZGVyUm91dGUgaXMgdGhlIGhhbmRsZXIgZm9yICdib29rX29yZGVyJyBub3RpZmljYXRpb25zLiAqL1xuICBoYW5kbGVCb29rT3JkZXJSb3V0ZSAoZGF0YTogQm9va1VwZGF0ZSkge1xuICAgIGFwcCgpLmxvZygnYm9vaycsICdoYW5kbGVCb29rT3JkZXJSb3V0ZTonLCBkYXRhKVxuICAgIGlmIChkYXRhLmhvc3QgIT09IHRoaXMubWFya2V0LmRleC5ob3N0IHx8IGRhdGEubWFya2V0SUQgIT09IHRoaXMubWFya2V0LnNpZCkgcmV0dXJuXG4gICAgY29uc3Qgb3JkZXIgPSBkYXRhLnBheWxvYWQgYXMgTWluaU9yZGVyXG4gICAgaWYgKG9yZGVyLnJhdGUgPiAwKSB0aGlzLmJvb2suYWRkKG9yZGVyKVxuICAgIHRoaXMuYWRkVGFibGVPcmRlcihvcmRlcilcbiAgICB0aGlzLnVwZGF0ZVRpdGxlKClcbiAgICB0aGlzLmRlcHRoQ2hhcnQuZHJhdygpXG4gIH1cblxuICAvKiBoYW5kbGVVbmJvb2tPcmRlclJvdXRlIGlzIHRoZSBoYW5kbGVyIGZvciAndW5ib29rX29yZGVyJyBub3RpZmljYXRpb25zLiAqL1xuICBoYW5kbGVVbmJvb2tPcmRlclJvdXRlIChkYXRhOiBCb29rVXBkYXRlKSB7XG4gICAgYXBwKCkubG9nKCdib29rJywgJ2hhbmRsZVVuYm9va09yZGVyUm91dGU6JywgZGF0YSlcbiAgICBpZiAoZGF0YS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCB8fCBkYXRhLm1hcmtldElEICE9PSB0aGlzLm1hcmtldC5zaWQpIHJldHVyblxuICAgIGNvbnN0IG9yZGVyID0gZGF0YS5wYXlsb2FkXG4gICAgdGhpcy5ib29rLnJlbW92ZShvcmRlci50b2tlbilcbiAgICB0aGlzLnJlbW92ZVRhYmxlT3JkZXIob3JkZXIpXG4gICAgdGhpcy51cGRhdGVUaXRsZSgpXG4gICAgdGhpcy5kZXB0aENoYXJ0LmRyYXcoKVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlVXBkYXRlUmVtYWluaW5nUm91dGUgaXMgdGhlIGhhbmRsZXIgZm9yICd1cGRhdGVfcmVtYWluaW5nJ1xuICAgKiBub3RpZmljYXRpb25zLlxuICAgKi9cbiAgaGFuZGxlVXBkYXRlUmVtYWluaW5nUm91dGUgKGRhdGE6IEJvb2tVcGRhdGUpIHtcbiAgICBhcHAoKS5sb2coJ2Jvb2snLCAnaGFuZGxlVXBkYXRlUmVtYWluaW5nUm91dGU6JywgZGF0YSlcbiAgICBpZiAoZGF0YS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCB8fCBkYXRhLm1hcmtldElEICE9PSB0aGlzLm1hcmtldC5zaWQpIHJldHVyblxuICAgIGNvbnN0IHVwZGF0ZSA9IGRhdGEucGF5bG9hZFxuICAgIHRoaXMuYm9vay51cGRhdGVSZW1haW5pbmcodXBkYXRlLnRva2VuLCB1cGRhdGUucXR5LCB1cGRhdGUucXR5QXRvbWljKVxuICAgIHRoaXMudXBkYXRlVGFibGVPcmRlcih1cGRhdGUpXG4gICAgdGhpcy5kZXB0aENoYXJ0LmRyYXcoKVxuICB9XG5cbiAgLyogaGFuZGxlRXBvY2hPcmRlclJvdXRlIGlzIHRoZSBoYW5kbGVyIGZvciAnZXBvY2hfb3JkZXInIG5vdGlmaWNhdGlvbnMuICovXG4gIGhhbmRsZUVwb2NoT3JkZXJSb3V0ZSAoZGF0YTogQm9va1VwZGF0ZSkge1xuICAgIGFwcCgpLmxvZygnYm9vaycsICdoYW5kbGVFcG9jaE9yZGVyUm91dGU6JywgZGF0YSlcbiAgICBpZiAoZGF0YS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCB8fCBkYXRhLm1hcmtldElEICE9PSB0aGlzLm1hcmtldC5zaWQpIHJldHVyblxuICAgIGNvbnN0IG9yZGVyID0gZGF0YS5wYXlsb2FkXG4gICAgaWYgKG9yZGVyLm1zZ1JhdGUgPiAwKSB0aGlzLmJvb2suYWRkKG9yZGVyKSAvLyBObyBjYW5jZWxzIG9yIG1hcmtldCBvcmRlcnNcbiAgICBpZiAob3JkZXIucXR5QXRvbWljID4gMCkgdGhpcy5hZGRUYWJsZU9yZGVyKG9yZGVyKSAvLyBObyBjYW5jZWwgb3JkZXJzXG4gICAgdGhpcy5kZXB0aENoYXJ0LmRyYXcoKVxuICB9XG5cbiAgLyogaGFuZGxlQ2FuZGxlc1JvdXRlIGlzIHRoZSBoYW5kbGVyIGZvciAnY2FuZGxlcycgbm90aWZpY2F0aW9ucy4gKi9cbiAgaGFuZGxlQ2FuZGxlc1JvdXRlIChkYXRhOiBCb29rVXBkYXRlKSB7XG4gICAgaWYgKHRoaXMuY2FuZGxlc0xvYWRpbmcpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNhbmRsZXNMb2FkaW5nLnRpbWVyKVxuICAgICAgdGhpcy5jYW5kbGVzTG9hZGluZy5sb2FkZWQoKVxuICAgICAgdGhpcy5jYW5kbGVzTG9hZGluZyA9IG51bGxcbiAgICB9XG4gICAgaWYgKGRhdGEuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QgfHwgZGF0YS5tYXJrZXRJRCAhPT0gdGhpcy5tYXJrZXQuY2ZnLm5hbWUpIHJldHVyblxuICAgIGNvbnN0IGR1ciA9IGRhdGEucGF5bG9hZC5kdXJcbiAgICB0aGlzLm1hcmtldC5jYW5kbGVDYWNoZXNbZHVyXSA9IGRhdGEucGF5bG9hZFxuICAgIHRoaXMuc2V0SGlnaExvdygpXG4gICAgaWYgKHRoaXMuY2FuZGxlRHVyICE9PSBkdXIpIHJldHVyblxuICAgIGlmICh0aGlzLmxvYWRpbmdBbmltYXRpb25zLmNhbmRsZXMpIHRoaXMubG9hZGluZ0FuaW1hdGlvbnMuY2FuZGxlcy5zdG9wKClcbiAgICB0aGlzLmNhbmRsZUNoYXJ0LmNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCdpbnZpc2libGUnKVxuICAgIHRoaXMuY2FuZGxlQ2hhcnQuc2V0Q2FuZGxlcyhkYXRhLnBheWxvYWQsIHRoaXMubWFya2V0LmNmZywgdGhpcy5tYXJrZXQuYmFzZVVuaXRJbmZvLCB0aGlzLm1hcmtldC5xdW90ZVVuaXRJbmZvKVxuICB9XG5cbiAgaGFuZGxlRXBvY2hNYXRjaFN1bW1hcnkgKGRhdGE6IEJvb2tVcGRhdGUpIHtcbiAgICB0aGlzLmFkZFJlY2VudE1hdGNoZXMoZGF0YS5wYXlsb2FkLm1hdGNoU3VtbWFyaWVzKVxuICAgIHRoaXMucmVmcmVzaFJlY2VudE1hdGNoZXNUYWJsZSgpXG4gIH1cblxuICAvKiBoYW5kbGVDYW5kbGVVcGRhdGVSb3V0ZSBpcyB0aGUgaGFuZGxlciBmb3IgJ2NhbmRsZV91cGRhdGUnIG5vdGlmaWNhdGlvbnMuICovXG4gIGhhbmRsZUNhbmRsZVVwZGF0ZVJvdXRlIChkYXRhOiBCb29rVXBkYXRlKSB7XG4gICAgaWYgKGRhdGEuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QpIHJldHVyblxuICAgIGNvbnN0IHsgZHVyLCBjYW5kbGUgfSA9IGRhdGEucGF5bG9hZFxuICAgIGNvbnN0IGNhY2hlID0gdGhpcy5tYXJrZXQuY2FuZGxlQ2FjaGVzW2R1cl1cbiAgICBpZiAoIWNhY2hlKSByZXR1cm4gLy8gbXVzdCBub3QgaGF2ZSBzZWVuIHRoZSAnY2FuZGxlcycgbm90aWZpY2F0aW9uIHlldD9cbiAgICBjb25zdCBjYW5kbGVzID0gY2FjaGUuY2FuZGxlc1xuICAgIGlmIChjYW5kbGVzLmxlbmd0aCA9PT0gMCkgY2FuZGxlcy5wdXNoKGNhbmRsZSlcbiAgICBlbHNlIHtcbiAgICAgIGNvbnN0IGxhc3QgPSBjYW5kbGVzW2NhbmRsZXMubGVuZ3RoIC0gMV1cbiAgICAgIGlmIChsYXN0LnN0YXJ0U3RhbXAgPT09IGNhbmRsZS5zdGFydFN0YW1wKSBjYW5kbGVzW2NhbmRsZXMubGVuZ3RoIC0gMV0gPSBjYW5kbGVcbiAgICAgIGVsc2UgY2FuZGxlcy5wdXNoKGNhbmRsZSlcbiAgICB9XG4gICAgaWYgKHRoaXMuY2FuZGxlRHVyICE9PSBkdXIpIHJldHVyblxuICAgIHRoaXMuY2FuZGxlQ2hhcnQuZHJhdygpXG4gIH1cblxuICAvKlxuICAgKiBzaG93VG9nZ2xlV2FsbGV0U3RhdHVzIGRpc3BsYXlzIHRoZSB0b2dnbGVXYWxsZXRTdGF0dXNDb25maXJtIGZvcm0gdG9cbiAgICogZW5hYmxlIGEgd2FsbGV0LlxuICAgKi9cbiAgc2hvd1RvZ2dsZVdhbGxldFN0YXR1cyAoYXNzZXQ6IFN1cHBvcnRlZEFzc2V0KSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHRoaXMub3BlbkFzc2V0ID0gYXNzZXRcbiAgICBEb2MuaGlkZShwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0VyciwgcGFnZS53YWxsZXRTdGF0dXNEaXNhYmxlLCBwYWdlLmRpc2FibGVXYWxsZXRNc2cpXG4gICAgRG9jLnNob3cocGFnZS53YWxsZXRTdGF0dXNFbmFibGUsIHBhZ2UuZW5hYmxlV2FsbGV0TXNnKVxuICAgIHRoaXMuZm9ybXMuc2hvdyhwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0NvbmZpcm0pXG4gIH1cblxuICAvKlxuICAgKiB0b2dnbGVXYWxsZXRTdGF0dXMgdG9nZ2xlIHdhbGxldHMgc3RhdHVzIHRvIGVuYWJsZWQuXG4gICAqL1xuICBhc3luYyB0b2dnbGVXYWxsZXRTdGF0dXMgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0VycilcblxuICAgIGNvbnN0IHVybCA9ICcvYXBpL3RvZ2dsZXdhbGxldHN0YXR1cydcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBhc3NldElEOiB0aGlzLm9wZW5Bc3NldC5pZCxcbiAgICAgIGRpc2FibGU6IGZhbHNlXG4gICAgfVxuXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0NvbmZpcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04odXJsLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS50b2dnbGVXYWxsZXRTdGF0dXNFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0VycilcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIERvYy5oaWRlKHRoaXMucGFnZS5mb3JtcylcbiAgICB0aGlzLmJhbGFuY2VXZ3QudXBkYXRlQXNzZXQodGhpcy5vcGVuQXNzZXQuaWQpXG4gIH1cblxuICAvKiBzaG93VmVyaWZ5IHNob3dzIHRoZSBmb3JtIHRvIGFjY2VwdCB0aGUgY3VycmVudGx5IHBhcnNlZCBvcmRlciBpbmZvcm1hdGlvblxuICAgKiBhbmQgY29uZmlybSBzdWJtaXNzaW9uIG9mIHRoZSBvcmRlciB0byB0aGUgZGV4LlxuICAgKi9cbiAgc2hvd1ZlcmlmeSAoKSB7XG4gICAgdGhpcy5wcmVvcmRlckNhY2hlID0ge31cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLmN1cnJlbnRPcmRlciA9IHRoaXMucGFyc2VPcmRlcigpXG4gICAgY29uc3QgaXNTZWxsID0gb3JkZXIuc2VsbFxuICAgIGNvbnN0IGJhc2VBc3NldCA9IGFwcCgpLmFzc2V0c1tvcmRlci5iYXNlXVxuICAgIGNvbnN0IHF1b3RlQXNzZXQgPSBhcHAoKS5hc3NldHNbb3JkZXIucXVvdGVdXG4gICAgY29uc3QgdG9Bc3NldCA9IGlzU2VsbCA/IHF1b3RlQXNzZXQgOiBiYXNlQXNzZXRcbiAgICBjb25zdCBmcm9tQXNzZXQgPSBpc1NlbGwgPyBiYXNlQXNzZXQgOiBxdW90ZUFzc2V0XG5cbiAgICBjb25zdCBzZXRJY29uID0gKGljb246IFBhZ2VFbGVtZW50KSA9PiB7XG4gICAgICBzd2l0Y2ggKGljb24uZGF0YXNldC5pY29uKSB7XG4gICAgICAgIGNhc2UgJ2Zyb20nOlxuICAgICAgICAgIGlmIChmcm9tQXNzZXQudG9rZW4pIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudEFzc2V0ID0gYXBwKCkuYXNzZXRzW2Zyb21Bc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgICAgICAgICAgIGljb24uc3JjID0gRG9jLmxvZ29QYXRoKHBhcmVudEFzc2V0LnN5bWJvbClcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWNvbi5zcmMgPSBEb2MubG9nb1BhdGgoZnJvbUFzc2V0LnN5bWJvbClcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAndG8nOlxuICAgICAgICAgIGlmICh0b0Fzc2V0LnRva2VuKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJlbnRBc3NldCA9IGFwcCgpLmFzc2V0c1t0b0Fzc2V0LnRva2VuLnBhcmVudElEXVxuICAgICAgICAgICAgaWNvbi5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50QXNzZXQuc3ltYm9sKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpY29uLnNyYyA9IERvYy5sb2dvUGF0aCh0b0Fzc2V0LnN5bWJvbClcbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2V0IHRoZSB0byBhbmQgZnJvbSBpY29ucyBpbiB0aGUgZmVlIGRldGFpbHMgcGFuZS5cbiAgICBmb3IgKGNvbnN0IGljb24gb2YgRG9jLmFwcGx5U2VsZWN0b3IocGFnZS52RGV0YWlsUGFuZSwgJ1tkYXRhLWljb25dJykpIHtcbiAgICAgIHNldEljb24oaWNvbilcbiAgICB9XG5cbiAgICAvLyBTZXQgdGhlIHRvIGFuZCBmcm9tIGljb25zIGluIHRoZSBmZWUgc3VtbWFyeSBwYW5lLlxuICAgIGZvciAoY29uc3QgaWNvbiBvZiBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLnZGZWVTdW1tYXJ5LCAnW2RhdGEtaWNvbl0nKSkge1xuICAgICAgc2V0SWNvbihpY29uKVxuICAgIH1cblxuICAgIERvYy5oaWRlKHBhZ2UudlByZW9yZGVyRXJyKVxuICAgIERvYy5zaG93KHBhZ2UudlByZW9yZGVyKVxuXG4gICAgcGFnZS52QnV5U2VsbC50ZXh0Q29udGVudCA9IGlzU2VsbCA/IGludGwucHJlcChpbnRsLklEX1NFTExJTkcpIDogaW50bC5wcmVwKGludGwuSURfQlVZSU5HKVxuICAgIGNvbnN0IGJ1eVNlbGxTdHIgPSBpc1NlbGwgPyBpbnRsLnByZXAoaW50bC5JRF9TRUxMKSA6IGludGwucHJlcChpbnRsLklEX0JVWSlcbiAgICBwYWdlLnZTaWRlU3VibWl0LnRleHRDb250ZW50ID0gYnV5U2VsbFN0clxuICAgIHBhZ2Uudk9yZGVySG9zdC50ZXh0Q29udGVudCA9IG9yZGVyLmhvc3RcbiAgICBpZiAob3JkZXIuaXNMaW1pdCkge1xuICAgICAgRG9jLnNob3cocGFnZS52ZXJpZnlMaW1pdClcbiAgICAgIERvYy5oaWRlKHBhZ2UudmVyaWZ5TWFya2V0KVxuICAgICAgY29uc3Qgb3JkZXJEZXNjID0gYExpbWl0ICR7YnV5U2VsbFN0cn0gT3JkZXJgXG4gICAgICBwYWdlLnZPcmRlclR5cGUudGV4dENvbnRlbnQgPSBvcmRlci50aWZub3cgPyBvcmRlckRlc2MgKyAnIChpbW1lZGlhdGUpJyA6IG9yZGVyRGVzY1xuICAgICAgcGFnZS52UmF0ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkZXIucmF0ZSAvIHRoaXMubWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yKVxuICAgICAgcGFnZS52UXR5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmRlci5xdHksIGJhc2VBc3NldC51bml0SW5mbylcbiAgICAgIGNvbnN0IHRvdGFsID0gb3JkZXIucmF0ZSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgKiBvcmRlci5xdHlcbiAgICAgIHBhZ2UudlRvdGFsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZSh0b3RhbCwgcXVvdGVBc3NldC51bml0SW5mbylcbiAgICAgIC8vIEZvcm1hdCB0b3RhbCBmaWF0IHZhbHVlLlxuICAgICAgdGhpcy5zaG93RmlhdFZhbHVlKHF1b3RlQXNzZXQuaWQsIHRvdGFsLCBwYWdlLnZGaWF0VG90YWwpXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UudmVyaWZ5TGltaXQpXG4gICAgICBEb2Muc2hvdyhwYWdlLnZlcmlmeU1hcmtldClcbiAgICAgIHBhZ2Uudk9yZGVyVHlwZS50ZXh0Q29udGVudCA9IGBNYXJrZXQgJHtidXlTZWxsU3RyfSBPcmRlcmBcbiAgICAgIGNvbnN0IHVpID0gb3JkZXIuc2VsbCA/IHRoaXMubWFya2V0LmJhc2VVbml0SW5mbyA6IHRoaXMubWFya2V0LnF1b3RlVW5pdEluZm9cbiAgICAgIHBhZ2Uudm1Gcm9tVG90YWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZGVyLnF0eSwgdWkpXG4gICAgICBwYWdlLnZtRnJvbUFzc2V0LnRleHRDb250ZW50ID0gZnJvbUFzc2V0LnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgICAvLyBGb3JtYXQgZnJvbUFzc2V0IGZpYXQgdmFsdWUuXG4gICAgICB0aGlzLnNob3dGaWF0VmFsdWUoZnJvbUFzc2V0LmlkLCBvcmRlci5xdHksIHBhZ2Uudm1Gcm9tVG90YWxGaWF0KVxuICAgICAgY29uc3QgZ2FwID0gdGhpcy5taWRHYXAoKVxuICAgICAgaWYgKGdhcCkge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLnZNYXJrZXRFc3RpbWF0ZSlcbiAgICAgICAgY29uc3QgcmVjZWl2ZWQgPSBvcmRlci5zZWxsID8gb3JkZXIucXR5ICogZ2FwIDogb3JkZXIucXR5IC8gZ2FwXG4gICAgICAgIHBhZ2Uudm1Ub1RvdGFsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyZWNlaXZlZCwgdG9Bc3NldC51bml0SW5mbylcbiAgICAgICAgcGFnZS52bVRvQXNzZXQudGV4dENvbnRlbnQgPSB0b0Fzc2V0LnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgICAgIC8vIEZvcm1hdCByZWNlaXZlZCB2YWx1ZSB0byBmaWF0IGVxdWl2YWxlbnQuXG4gICAgICAgIHRoaXMuc2hvd0ZpYXRWYWx1ZSh0b0Fzc2V0LmlkLCByZWNlaXZlZCwgcGFnZS52bVRvdGFsRmlhdClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIERvYy5oaWRlKHBhZ2Uudk1hcmtldEVzdGltYXRlKVxuICAgICAgfVxuICAgIH1cbiAgICAvLyBWaXN1YWxseSBkaWZmZXJlbnRpYXRlIGJldHdlZW4gYnV5L3NlbGwgb3JkZXJzLlxuICAgIGlmIChpc1NlbGwpIHtcbiAgICAgIHBhZ2UudkhlYWRlci5jbGFzc0xpc3QuYWRkKHNlbGxCdG5DbGFzcylcbiAgICAgIHBhZ2UudkhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKGJ1eUJ0bkNsYXNzKVxuICAgICAgcGFnZS52U3VibWl0LmNsYXNzTGlzdC5hZGQoc2VsbEJ0bkNsYXNzKVxuICAgICAgcGFnZS52U3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoYnV5QnRuQ2xhc3MpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2UudkhlYWRlci5jbGFzc0xpc3QuYWRkKGJ1eUJ0bkNsYXNzKVxuICAgICAgcGFnZS52SGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoc2VsbEJ0bkNsYXNzKVxuICAgICAgcGFnZS52U3VibWl0LmNsYXNzTGlzdC5hZGQoYnV5QnRuQ2xhc3MpXG4gICAgICBwYWdlLnZTdWJtaXQuY2xhc3NMaXN0LnJlbW92ZShzZWxsQnRuQ2xhc3MpXG4gICAgfVxuICAgIHRoaXMuc2hvd1ZlcmlmeUZvcm0oKVxuXG4gICAgaWYgKGJhc2VBc3NldC53YWxsZXQub3BlbiAmJiBxdW90ZUFzc2V0LndhbGxldC5vcGVuKSB0aGlzLnByZU9yZGVyKG9yZGVyKVxuICAgIGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS52UHJlb3JkZXIpXG4gICAgICB0aGlzLnVubG9ja1dhbGxldHNGb3JFc3RpbWF0ZXMoKVxuICAgIH1cbiAgfVxuXG4gIC8vIHNob3dGaWF0VmFsdWUgZGlzcGxheXMgdGhlIGZpYXQgZXF1aXZhbGVudCBmb3IgYW4gb3JkZXIgcXVhbnRpdHkuXG4gIHNob3dGaWF0VmFsdWUgKGFzc2V0SUQ6IG51bWJlciwgcXR5OiBudW1iZXIsIGRpc3BsYXk6IFBhZ2VFbGVtZW50KSB7XG4gICAgaWYgKGRpc3BsYXkpIHtcbiAgICAgIGNvbnN0IHJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RmlhdENvbnZlcnNpb24ocXR5LCByYXRlLCBhcHAoKS51bml0SW5mbyhhc3NldElEKSlcbiAgICAgIGlmIChyYXRlKSBEb2Muc2hvdyhkaXNwbGF5LnBhcmVudEVsZW1lbnQgYXMgRWxlbWVudClcbiAgICAgIGVsc2UgRG9jLmhpZGUoZGlzcGxheS5wYXJlbnRFbGVtZW50IGFzIEVsZW1lbnQpXG4gICAgfVxuICB9XG5cbiAgLyogc2hvd1ZlcmlmeUZvcm0gZGlzcGxheXMgZm9ybSB0byB2ZXJpZnkgYW4gb3JkZXIgKi9cbiAgYXN5bmMgc2hvd1ZlcmlmeUZvcm0gKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnZFcnIpXG4gICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UudmVyaWZ5Rm9ybSlcbiAgfVxuXG4gIC8qXG4gICAqIHVubG9ja1dhbGxldHNGb3JFc3RpbWF0ZXMgdW5sb2NrcyBhbnkgbG9ja2VkIHdhbGxldHMgd2l0aCB0aGUgcHJvdmlkZWRcbiAgICogcGFzc3dvcmQuXG4gICAqL1xuICBhc3luYyB1bmxvY2tXYWxsZXRzRm9yRXN0aW1hdGVzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnZlcmlmeUZvcm0pXG4gICAgYXdhaXQgdGhpcy51bmxvY2tNYXJrZXRXYWxsZXRzKClcbiAgICBsb2FkZWQoKVxuICAgIERvYy5zaG93KHBhZ2UudlByZW9yZGVyKVxuICAgIHRoaXMucHJlT3JkZXIodGhpcy5wYXJzZU9yZGVyKCkpXG4gIH1cblxuICBhc3luYyB1bmxvY2tXYWxsZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL29wZW53YWxsZXQnLCB7IGFzc2V0SUQgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ2Vycm9yIHVubG9ja2luZyB3YWxsZXQgJyArIHJlcy5tc2cpXG4gICAgfVxuICAgIHRoaXMuYmFsYW5jZVdndC51cGRhdGVBc3NldChhc3NldElEKVxuICB9XG5cbiAgLypcbiAgICogdW5sb2NrTWFya2V0V2FsbGV0cyB1bmxvY2tzIGJvdGggdGhlIGJhc2UgYW5kIHF1b3RlIHdhbGxldHMgZm9yIHRoZSBjdXJyZW50XG4gICAqIG1hcmtldCwgaWYgbG9ja2VkLlxuICAgKi9cbiAgYXN5bmMgdW5sb2NrTWFya2V0V2FsbGV0cyAoKSB7XG4gICAgY29uc3QgeyBiYXNlLCBxdW90ZSB9ID0gdGhpcy5tYXJrZXRcbiAgICBjb25zdCBhc3NldElEcyA9IFtdXG4gICAgaWYgKCFiYXNlLndhbGxldC5vcGVuKSBhc3NldElEcy5wdXNoKGJhc2UuaWQpXG4gICAgaWYgKCFxdW90ZS53YWxsZXQub3BlbikgYXNzZXRJRHMucHVzaChxdW90ZS5pZClcbiAgICBmb3IgKGNvbnN0IGFzc2V0SUQgb2YgYXNzZXRJRHMpIHtcbiAgICAgIHRoaXMudW5sb2NrV2FsbGV0KGFzc2V0SUQpXG4gICAgfVxuICB9XG5cbiAgLyogZmV0Y2hQcmVvcmRlciBmZXRjaGVzIHRoZSBwcmUtb3JkZXIgZXN0aW1hdGVzIGFuZCBvcHRpb25zLiAqL1xuICBhc3luYyBmZXRjaFByZW9yZGVyIChvcmRlcjogVHJhZGVGb3JtKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGNhY2hlS2V5ID0gSlNPTi5zdHJpbmdpZnkob3JkZXIub3B0aW9ucylcbiAgICBjb25zdCBjYWNoZWQgPSB0aGlzLnByZW9yZGVyQ2FjaGVbY2FjaGVLZXldXG4gICAgaWYgKGNhY2hlZCkgcmV0dXJuIGNhY2hlZFxuXG4gICAgRG9jLmhpZGUocGFnZS52UHJlb3JkZXJFcnIpXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnZlcmlmeUZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvcHJlb3JkZXInLCB3aXJlT3JkZXIob3JkZXIpKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHJldHVybiB7IGVycjogcmVzLm1zZyB9XG4gICAgdGhpcy5wcmVvcmRlckNhY2hlW2NhY2hlS2V5XSA9IHJlcy5lc3RpbWF0ZVxuICAgIHJldHVybiByZXMuZXN0aW1hdGVcbiAgfVxuXG4gIC8qXG4gICAqIHNldFByZW9yZGVyRXJyIHNldHMgYW5kIGRpc3BsYXlzIHRoZSBwcmUtb3JkZXIgZXJyb3IgbWVzc2FnZSBhbmQgaGlkZXMgdGhlXG4gICAqIHByZS1vcmRlciBkZXRhaWxzIGJveC5cbiAgICovXG4gIHNldFByZW9yZGVyRXJyIChtc2c6IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnZQcmVvcmRlcilcbiAgICBEb2Muc2hvdyhwYWdlLnZQcmVvcmRlckVycilcbiAgICBwYWdlLnZQcmVvcmRlckVyclRpcC5kYXRhc2V0LnRvb2x0aXAgPSBtc2dcbiAgfVxuXG4gIHNob3dQcmVPcmRlckFkdmFuY2VkT3B0aW9ucyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2Uuc2hvd0FkdmFuY2VkT3B0aW9ucylcbiAgICBEb2Muc2hvdyhwYWdlLmhpZGVBZHZhbmNlZE9wdGlvbnMsIHBhZ2Uudk90aGVyT3JkZXJPcHRzKVxuICB9XG5cbiAgaGlkZVByZU9yZGVyQWR2YW5jZWRPcHRpb25zICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5oaWRlQWR2YW5jZWRPcHRpb25zLCBwYWdlLnZPdGhlck9yZGVyT3B0cylcbiAgICBEb2Muc2hvdyhwYWdlLnNob3dBZHZhbmNlZE9wdGlvbnMpXG4gIH1cblxuICByZWxvYWRPcmRlck9wdHMgKG9yZGVyOiBUcmFkZUZvcm0sIHN3YXA6IFByZVN3YXAsIHJlZGVlbTogUHJlUmVkZWVtLCBjaGFuZ2VkOiAoKT0+dm9pZCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuZW1wdHkocGFnZS52RGVmYXVsdE9yZGVyT3B0cywgcGFnZS52T3RoZXJPcmRlck9wdHMpXG4gICAgY29uc3QgYWRkT3B0aW9uID0gKG9wdDogT3JkZXJPcHRpb24sIGlzU3dhcDogYm9vbGVhbikgPT4ge1xuICAgICAgY29uc3QgZWwgPSBPcmRlclV0aWwub3B0aW9uRWxlbWVudChvcHQsIG9yZGVyLCBjaGFuZ2VkLCBpc1N3YXApXG4gICAgICBpZiAob3B0LnNob3dCeURlZmF1bHQpIHBhZ2UudkRlZmF1bHRPcmRlck9wdHMuYXBwZW5kQ2hpbGQoZWwpXG4gICAgICBlbHNlIHBhZ2Uudk90aGVyT3JkZXJPcHRzLmFwcGVuZENoaWxkKGVsKVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IG9wdCBvZiBzd2FwLm9wdGlvbnMgfHwgW10pIGFkZE9wdGlvbihvcHQsIHRydWUpXG4gICAgZm9yIChjb25zdCBvcHQgb2YgcmVkZWVtLm9wdGlvbnMgfHwgW10pIGFkZE9wdGlvbihvcHQsIGZhbHNlKVxuICAgIGFwcCgpLmJpbmRUb29sdGlwcyhwYWdlLnZEZWZhdWx0T3JkZXJPcHRzKVxuICAgIGFwcCgpLmJpbmRUb29sdGlwcyhwYWdlLnZPdGhlck9yZGVyT3B0cylcbiAgfVxuXG4gIC8qIHByZU9yZGVyIGxvYWRzIHRoZSBvcHRpb25zIGFuZCBmZXRjaGVzIHByZS1vcmRlciBlc3RpbWF0ZXMgKi9cbiAgYXN5bmMgcHJlT3JkZXIgKG9yZGVyOiBUcmFkZUZvcm0pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG5cbiAgICAvLyBBZGQgc3dhcCBvcHRpb25zLlxuICAgIGNvbnN0IHJlZnJlc2hQcmVvcmRlciA9IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlczogQVBJUmVzcG9uc2UgPSBhd2FpdCB0aGlzLmZldGNoUHJlb3JkZXIob3JkZXIpXG4gICAgICBpZiAocmVzLmVycikgcmV0dXJuIHRoaXMuc2V0UHJlb3JkZXJFcnIocmVzLmVycilcbiAgICAgIGNvbnN0IGVzdCA9IChyZXMgYXMgYW55KSBhcyBPcmRlckVzdGltYXRlXG4gICAgICBEb2MuaGlkZShwYWdlLnZQcmVvcmRlckVycilcbiAgICAgIERvYy5zaG93KHBhZ2UudlByZW9yZGVyKVxuICAgICAgY29uc3QgeyBzd2FwLCByZWRlZW0gfSA9IGVzdFxuICAgICAgc3dhcC5vcHRpb25zID0gc3dhcC5vcHRpb25zIHx8IFtdXG4gICAgICByZWRlZW0ub3B0aW9ucyA9IHJlZGVlbS5vcHRpb25zIHx8IFtdXG4gICAgICB0aGlzLnNldEZlZUVzdGltYXRlcyhzd2FwLCByZWRlZW0sIG9yZGVyKVxuXG4gICAgICBjb25zdCBjaGFuZ2VkID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCByZWZyZXNoUHJlb3JkZXIoKVxuICAgICAgICBEb2MuYW5pbWF0ZSg0MDAsIHByb2dyZXNzID0+IHtcbiAgICAgICAgICBwYWdlLnZGZWVTdW1tYXJ5LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2JhKDEyOCwgMTI4LCAxMjgsICR7MC41IC0gMC41ICogcHJvZ3Jlc3N9KWBcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIC8vIGJpbmQgc2hvdyBvciBoaWRlIGFkdmFuY2VkIHByZSBvcmRlciBvcHRpb25zLlxuICAgICAgRG9jLmJpbmQocGFnZS5zaG93QWR2YW5jZWRPcHRpb25zLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1ByZU9yZGVyQWR2YW5jZWRPcHRpb25zKCkgfSlcbiAgICAgIERvYy5iaW5kKHBhZ2UuaGlkZUFkdmFuY2VkT3B0aW9ucywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmhpZGVQcmVPcmRlckFkdmFuY2VkT3B0aW9ucygpIH0pXG4gICAgICB0aGlzLnJlbG9hZE9yZGVyT3B0cyhvcmRlciwgc3dhcCwgcmVkZWVtLCBjaGFuZ2VkKVxuICAgIH1cblxuICAgIHJlZnJlc2hQcmVvcmRlcigpXG4gIH1cblxuICAvKiBzZXRGZWVFc3RpbWF0ZXMgc2V0cyBhbGwgb2YgdGhlIHByZS1vcmRlciBlc3RpbWF0ZSBmaWVsZHMgKi9cbiAgc2V0RmVlRXN0aW1hdGVzIChzd2FwOiBQcmVTd2FwLCByZWRlZW06IFByZVJlZGVlbSwgb3JkZXI6IFRyYWRlRm9ybSkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0IH0gPSB0aGlzXG4gICAgaWYgKCFzd2FwLmVzdGltYXRlIHx8ICFyZWRlZW0uZXN0aW1hdGUpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UudlByZW9yZGVyRXN0aW1hdGVzKVxuICAgICAgcmV0dXJuIC8vIHByZU9yZGVyIG1heSByZXR1cm4ganVzdCBvcHRpb25zLCBubyBmZWUgZXN0aW1hdGVzXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UudlByZW9yZGVyRXN0aW1hdGVzKVxuICAgIGNvbnN0IHsgYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvLCByYXRlQ29udmVyc2lvbkZhY3RvciB9ID0gbWFya2V0XG4gICAgY29uc3QgZm10UGN0ID0gKHZhbHVlOiBudW1iZXIpID0+IHtcbiAgICAgIGlmICh2YWx1ZSA8IDAuMDUpIHJldHVybiAnPCAwLjEnXG4gICAgICByZXR1cm4gcGVyY2VudEZvcm1hdHRlci5mb3JtYXQodmFsdWUpXG4gICAgfVxuXG4gICAgLy8gSWYgdGhlIGFzc2V0IGlzIGEgdG9rZW4sIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSB0aGUgZmVlIGFzIGEgcGVyY2VudGFnZVxuICAgIC8vIG9mIHRoZSB0b3RhbCBvcmRlciwgd2UgdHJ5IHRvICB1c2UgdGhlIGZpYXQgcmF0ZXMgdG8gZmluZCBvdXQgdGhlXG4gICAgLy8gZXhjaGFuZ2UgcmF0ZSBiZXR3ZWVuIHRoZSB0b2tlbiBhbmQgcGFyZW50IGFzc2V0cy5cbiAgICAvLyBJbml0aWFsbHkgdGhlc2UgYXJlIHNldCB0byAxLCB3aGljaCB3ZSB3b3VsZCB1c2UgaWYgdGhlIGFzc2V0IGlzIG5vdCBhXG4gICAgLy8gdG9rZW4gYW5kIG5vIGNvbnZlcnNpb24gaXMgbmVlZGVkLlxuICAgIGxldCBiYXNlRXhjaGFuZ2VSYXRlID0gMVxuICAgIGxldCBxdW90ZUV4Y2hhbmdlUmF0ZSA9IDFcbiAgICBsZXQgYmFzZUZlZUFzc2V0VUkgPSBiYXNlVW5pdEluZm9cbiAgICBsZXQgcXVvdGVGZWVBc3NldFVJID0gcXVvdGVVbml0SW5mb1xuXG4gICAgaWYgKG1hcmtldC5iYXNlLnRva2VuKSB7XG4gICAgICBjb25zdCBwYXJlbnQgPSBhcHAoKS5hc3NldHNbbWFya2V0LmJhc2UudG9rZW4ucGFyZW50SURdXG4gICAgICBiYXNlRmVlQXNzZXRVSSA9IHBhcmVudC51bml0SW5mb1xuICAgICAgY29uc3QgdG9rZW5GaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFttYXJrZXQuYmFzZS5pZF1cbiAgICAgIGNvbnN0IHBhcmVudEZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW3BhcmVudC5pZF1cbiAgICAgIGlmICh0b2tlbkZpYXRSYXRlICYmIHBhcmVudEZpYXRSYXRlKSB7XG4gICAgICAgIGNvbnN0IGNvbnZlbnRpb25hbFJhdGUgPSBwYXJlbnRGaWF0UmF0ZSAvIHRva2VuRmlhdFJhdGVcbiAgICAgICAgYmFzZUV4Y2hhbmdlUmF0ZSA9IGNvbnZlbnRpb25hbFJhdGUgKiBiYXNlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgLyBwYXJlbnQudW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJhc2VFeGNoYW5nZVJhdGUgPSAwXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hcmtldC5xdW90ZS50b2tlbikge1xuICAgICAgY29uc3QgcGFyZW50ID0gYXBwKCkuYXNzZXRzW21hcmtldC5xdW90ZS50b2tlbi5wYXJlbnRJRF1cbiAgICAgIHF1b3RlRmVlQXNzZXRVSSA9IHBhcmVudC51bml0SW5mb1xuICAgICAgY29uc3QgdG9rZW5GaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFttYXJrZXQucXVvdGUuaWRdXG4gICAgICBjb25zdCBwYXJlbnRGaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtwYXJlbnQuaWRdXG4gICAgICBpZiAodG9rZW5GaWF0UmF0ZSAmJiBwYXJlbnRGaWF0UmF0ZSkge1xuICAgICAgICBjb25zdCBjb252ZW50aW9uYWxSYXRlID0gcGFyZW50RmlhdFJhdGUgLyB0b2tlbkZpYXRSYXRlXG4gICAgICAgIHF1b3RlRXhjaGFuZ2VSYXRlID0gY29udmVudGlvbmFsUmF0ZSAqIHF1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgLyBwYXJlbnQudW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHF1b3RlRXhjaGFuZ2VSYXRlID0gMFxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBbdG9GZWVBc3NldFVJLCBmcm9tRmVlQXNzZXRVSV0gPSBbYmFzZUZlZUFzc2V0VUksIHF1b3RlRmVlQXNzZXRVSV1cbiAgICBsZXQgW3RvRXhjaGFuZ2VSYXRlLCBmcm9tRXhjaGFuZ2VSYXRlXSA9IFtiYXNlRXhjaGFuZ2VSYXRlLCBxdW90ZUV4Y2hhbmdlUmF0ZV1cbiAgICBpZiAodGhpcy5jdXJyZW50T3JkZXIuc2VsbCkge1xuICAgICAgW2Zyb21GZWVBc3NldFVJLCB0b0ZlZUFzc2V0VUldID0gW3RvRmVlQXNzZXRVSSwgZnJvbUZlZUFzc2V0VUldO1xuICAgICAgW2Zyb21FeGNoYW5nZVJhdGUsIHRvRXhjaGFuZ2VSYXRlXSA9IFt0b0V4Y2hhbmdlUmF0ZSwgZnJvbUV4Y2hhbmdlUmF0ZV1cbiAgICB9XG5cbiAgICBjb25zdCBzd2FwcGVkID0gc3dhcC5lc3RpbWF0ZS52YWx1ZSB8fCAwXG4gICAgY29uc3Qgc3dhcHBlZEluUGFyZW50VW5pdHMgPSBmcm9tRXhjaGFuZ2VSYXRlID4gMCA/IHN3YXBwZWQgLyBmcm9tRXhjaGFuZ2VSYXRlIDogc3dhcHBlZFxuXG4gICAgLy8gU2V0IHN3YXAgZmVlIGVzdGltYXRlcyBpbiB0aGUgZGV0YWlscyBwYW5lLlxuICAgIGNvbnN0IGJlc3RTd2FwUGN0ID0gc3dhcC5lc3RpbWF0ZS5yZWFsaXN0aWNCZXN0Q2FzZSAvIHN3YXBwZWRJblBhcmVudFVuaXRzICogMTAwXG4gICAgcGFnZS52U3dhcEZlZXNMb3dQY3QudGV4dENvbnRlbnQgPSBmcm9tRXhjaGFuZ2VSYXRlIDw9IDAgPyAnJyA6IGAoJHtmbXRQY3QoYmVzdFN3YXBQY3QpfSUpYFxuICAgIHBhZ2UudlN3YXBGZWVzTG93LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShzd2FwLmVzdGltYXRlLnJlYWxpc3RpY0Jlc3RDYXNlLCBmcm9tRmVlQXNzZXRVSSlcblxuICAgIGNvbnN0IHdvcnN0U3dhcFBjdCA9IHN3YXAuZXN0aW1hdGUucmVhbGlzdGljV29yc3RDYXNlIC8gc3dhcHBlZEluUGFyZW50VW5pdHMgKiAxMDBcbiAgICBwYWdlLnZTd2FwRmVlc0hpZ2hQY3QudGV4dENvbnRlbnQgPSBmcm9tRXhjaGFuZ2VSYXRlIDw9IDAgPyAnJyA6IGAoJHtmbXRQY3Qod29yc3RTd2FwUGN0KX0lKWBcbiAgICBwYWdlLnZTd2FwRmVlc0hpZ2gudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHN3YXAuZXN0aW1hdGUucmVhbGlzdGljV29yc3RDYXNlLCBmcm9tRmVlQXNzZXRVSSlcblxuICAgIGNvbnN0IHN3YXBGZWVzTWF4UGN0ID0gc3dhcC5lc3RpbWF0ZS5tYXhGZWVzIC8gc3dhcHBlZEluUGFyZW50VW5pdHMgKiAxMDBcbiAgICBwYWdlLnZTd2FwRmVlc01heFBjdC50ZXh0Q29udGVudCA9IGZyb21FeGNoYW5nZVJhdGUgPD0gMCA/ICcnIDogYCgke2ZtdFBjdChzd2FwRmVlc01heFBjdCl9JSlgXG4gICAgcGFnZS52U3dhcEZlZXNNYXgudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHN3YXAuZXN0aW1hdGUubWF4RmVlcywgZnJvbUZlZUFzc2V0VUkpXG5cbiAgICAvLyBTZXQgcmVkZW1wdGlvbiBmZWUgZXN0aW1hdGVzIGluIHRoZSBkZXRhaWxzIHBhbmUuXG4gICAgY29uc3QgbWlkR2FwID0gdGhpcy5taWRHYXAoKVxuICAgIGNvbnN0IGVzdFJhdGUgPSBtaWRHYXAgfHwgb3JkZXIucmF0ZSAvIHJhdGVDb252ZXJzaW9uRmFjdG9yXG4gICAgY29uc3QgcmVjZWl2ZWQgPSBvcmRlci5zZWxsID8gc3dhcHBlZCAqIGVzdFJhdGUgOiBzd2FwcGVkIC8gZXN0UmF0ZVxuICAgIGNvbnN0IHJlY2VpdmVkSW5QYXJlbnRVbml0cyA9IHRvRXhjaGFuZ2VSYXRlID4gMCA/IHJlY2VpdmVkIC8gdG9FeGNoYW5nZVJhdGUgOiByZWNlaXZlZFxuXG4gICAgY29uc3QgYmVzdFJlZGVlbVBjdCA9IHJlZGVlbS5lc3RpbWF0ZS5yZWFsaXN0aWNCZXN0Q2FzZSAvIHJlY2VpdmVkSW5QYXJlbnRVbml0cyAqIDEwMFxuICAgIHBhZ2UudlJlZGVlbUZlZXNMb3dQY3QudGV4dENvbnRlbnQgPSB0b0V4Y2hhbmdlUmF0ZSA8PSAwID8gJycgOiBgKCR7Zm10UGN0KGJlc3RSZWRlZW1QY3QpfSUpYFxuICAgIHBhZ2UudlJlZGVlbUZlZXNMb3cudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlZGVlbS5lc3RpbWF0ZS5yZWFsaXN0aWNCZXN0Q2FzZSwgdG9GZWVBc3NldFVJKVxuXG4gICAgY29uc3Qgd29yc3RSZWRlZW1QY3QgPSByZWRlZW0uZXN0aW1hdGUucmVhbGlzdGljV29yc3RDYXNlIC8gcmVjZWl2ZWRJblBhcmVudFVuaXRzICogMTAwXG4gICAgcGFnZS52UmVkZWVtRmVlc0hpZ2hQY3QudGV4dENvbnRlbnQgPSB0b0V4Y2hhbmdlUmF0ZSA8PSAwID8gJycgOiBgKCR7Zm10UGN0KHdvcnN0UmVkZWVtUGN0KX0lKWBcbiAgICBwYWdlLnZSZWRlZW1GZWVzSGlnaC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocmVkZWVtLmVzdGltYXRlLnJlYWxpc3RpY1dvcnN0Q2FzZSwgdG9GZWVBc3NldFVJKVxuXG4gICAgaWYgKGJhc2VFeGNoYW5nZVJhdGUgJiYgcXVvdGVFeGNoYW5nZVJhdGUpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudkZlZVN1bW1hcnlQY3QpXG4gICAgICBEb2MuaGlkZShwYWdlLnZGZWVTdW1tYXJ5KVxuICAgICAgcGFnZS52RmVlU3VtbWFyeUxvdy50ZXh0Q29udGVudCA9IGZtdFBjdChiZXN0U3dhcFBjdCArIGJlc3RSZWRlZW1QY3QpXG4gICAgICBwYWdlLnZGZWVTdW1tYXJ5SGlnaC50ZXh0Q29udGVudCA9IGZtdFBjdCh3b3JzdFN3YXBQY3QgKyB3b3JzdFJlZGVlbVBjdClcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS52RmVlU3VtbWFyeVBjdClcbiAgICAgIERvYy5zaG93KHBhZ2UudkZlZVN1bW1hcnkpXG4gICAgICBwYWdlLnN1bW1hcnlTd2FwRmVlc0xvdy50ZXh0Q29udGVudCA9IHBhZ2UudlN3YXBGZWVzTG93LnRleHRDb250ZW50XG4gICAgICBwYWdlLnN1bW1hcnlTd2FwRmVlc0hpZ2gudGV4dENvbnRlbnQgPSBwYWdlLnZTd2FwRmVlc0hpZ2gudGV4dENvbnRlbnRcbiAgICAgIHBhZ2Uuc3VtbWFyeVJlZGVlbUZlZXNMb3cudGV4dENvbnRlbnQgPSBwYWdlLnZSZWRlZW1GZWVzTG93LnRleHRDb250ZW50XG4gICAgICBwYWdlLnN1bW1hcnlSZWRlZW1GZWVzSGlnaC50ZXh0Q29udGVudCA9IHBhZ2UudlJlZGVlbUZlZXNIaWdoLnRleHRDb250ZW50XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3VibWl0Q2FuY2VsICgpIHtcbiAgICAvLyB0aGlzIHdpbGwgYmUgdGhlIHBhZ2UuY2FuY2VsU3VibWl0IGJ1dHRvbiAoZXZ0LmN1cnJlbnRUYXJnZXQpXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGNhbmNlbERhdGEgPSB0aGlzLmNhbmNlbERhdGFcbiAgICBjb25zdCBvcmRlciA9IGNhbmNlbERhdGEub3JkZXJcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBvcmRlcklEOiBvcmRlci5pZFxuICAgIH1cbiAgICAvLyBUb2dnbGUgdGhlIGxvYWRlciBhbmQgc3VibWl0IGJ1dHRvbi5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuY2FuY2VsU3VibWl0KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2NhbmNlbCcsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIC8vIERpc3BsYXkgZXJyb3Igb24gY29uZmlybWF0aW9uIG1vZGFsLlxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmNhbmNlbEVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UuY2FuY2VsRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIEhpZGUgY29uZmlybWF0aW9uIG1vZGFsIG9ubHkgb24gc3VjY2Vzcy5cbiAgICBEb2MuaGlkZShjYW5jZWxEYXRhLmJ0dG4sIHBhZ2UuZm9ybXMpXG4gICAgb3JkZXIuY2FuY2VsbGluZyA9IHRydWVcbiAgfVxuXG4gIC8qIHNob3dDYW5jZWwgc2hvd3MgYSBmb3JtIHRvIGNvbmZpcm0gc3VibWlzc2lvbiBvZiBhIGNhbmNlbCBvcmRlci4gKi9cbiAgc2hvd0NhbmNlbCAocm93OiBIVE1MRWxlbWVudCwgb3JkZXJJRDogc3RyaW5nKSB7XG4gICAgY29uc3Qgb3JkID0gdGhpcy5tZXRhT3JkZXJzW29yZGVySURdLm9yZFxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCByZW1haW5pbmcgPSBvcmQucXR5IC0gb3JkLmZpbGxlZFxuICAgIGNvbnN0IGFzc2V0ID0gT3JkZXJVdGlsLmlzTWFya2V0QnV5KG9yZCkgPyB0aGlzLm1hcmtldC5xdW90ZSA6IHRoaXMubWFya2V0LmJhc2VcbiAgICBwYWdlLmNhbmNlbFJlbWFpbi50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocmVtYWluaW5nLCBhc3NldC51bml0SW5mbylcbiAgICBwYWdlLmNhbmNlbFVuaXQudGV4dENvbnRlbnQgPSBhc3NldC5zeW1ib2wudG9VcHBlckNhc2UoKVxuICAgIERvYy5oaWRlKHBhZ2UuY2FuY2VsRXJyKVxuICAgIHRoaXMuZm9ybXMuc2hvdyhwYWdlLmNhbmNlbEZvcm0pXG4gICAgdGhpcy5jYW5jZWxEYXRhID0ge1xuICAgICAgYnR0bjogRG9jLnRtcGxFbGVtZW50KHJvdywgJ2NhbmNlbEJ0dG4nKSxcbiAgICAgIG9yZGVyOiBvcmRcbiAgICB9XG4gIH1cblxuICAvKiBzaG93QWNjZWxlcmF0ZSBzaG93cyB0aGUgYWNjZWxlcmF0ZSBvcmRlciBmb3JtLiAqL1xuICBzaG93QWNjZWxlcmF0ZSAob3JkZXI6IE9yZGVyKSB7XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLm1haW4pXG4gICAgdGhpcy5hY2NlbGVyYXRlT3JkZXJGb3JtLnJlZnJlc2gob3JkZXIpXG4gICAgbG9hZGVkKClcbiAgICB0aGlzLmZvcm1zLnNob3codGhpcy5wYWdlLmFjY2VsZXJhdGVGb3JtKVxuICB9XG5cbiAgLyogc2hvd0NyZWF0ZSBzaG93cyB0aGUgbmV3IHdhbGxldCBjcmVhdGlvbiBmb3JtLiAqL1xuICBzaG93Q3JlYXRlIChhc3NldDogU3VwcG9ydGVkQXNzZXQpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5jdXJyZW50Q3JlYXRlID0gYXNzZXRcbiAgICB0aGlzLm5ld1dhbGxldEZvcm0uc2V0QXNzZXQoYXNzZXQuaWQpXG4gICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgfVxuXG4gIC8qXG4gICAqIHN0ZXBTdWJtaXQgd2lsbCBleGFtaW5lIHRoZSBjdXJyZW50IHN0YXRlIG9mIHdhbGxldHMgYW5kIHN0ZXAgdGhlIHVzZXJcbiAgICogdGhyb3VnaCB0aGUgcHJvY2VzcyBvZiBvcmRlciBzdWJtaXNzaW9uLlxuICAgKiBOT1RFOiBJIGV4cGVjdCB0aGlzIHByb2Nlc3Mgd2lsbCBiZSBzdHJlYW1saW5lZCBzb29uIHN1Y2ggdGhhdCB0aGUgd2FsbGV0c1xuICAgKiB3aWxsIGF0dGVtcHQgdG8gYmUgdW5sb2NrZWQgaW4gdGhlIG9yZGVyIHN1Ym1pc3Npb24gcHJvY2VzcywgbmVnYXRpbmcgdGhlXG4gICAqIG5lZWQgdG8gdW5sb2NrIGFoZWFkIG9mIHRpbWUuXG4gICAqL1xuICBzdGVwU3VibWl0ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbWFya2V0ID0gdGhpcy5tYXJrZXRcbiAgICBEb2MuaGlkZShwYWdlLm9yZGVyRXJyKVxuICAgIGlmICghdGhpcy52YWxpZGF0ZU9yZGVyKHRoaXMucGFyc2VPcmRlcigpKSkgcmV0dXJuXG4gICAgY29uc3QgYmFzZVdhbGxldCA9IGFwcCgpLndhbGxldE1hcFttYXJrZXQuYmFzZS5pZF1cbiAgICBjb25zdCBxdW90ZVdhbGxldCA9IGFwcCgpLndhbGxldE1hcFttYXJrZXQucXVvdGUuaWRdXG4gICAgaWYgKCFiYXNlV2FsbGV0KSB7XG4gICAgICBwYWdlLm9yZGVyRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fQVNTRVRfV0FMTEVULCB7IGFzc2V0OiBtYXJrZXQuYmFzZS5zeW1ib2wgfSlcbiAgICAgIERvYy5zaG93KHBhZ2Uub3JkZXJFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKCFxdW90ZVdhbGxldCkge1xuICAgICAgcGFnZS5vcmRlckVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX0FTU0VUX1dBTExFVCwgeyBhc3NldDogbWFya2V0LnF1b3RlLnN5bWJvbCB9KVxuICAgICAgRG9jLnNob3cocGFnZS5vcmRlckVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnNob3dWZXJpZnkoKVxuICB9XG5cbiAgLyogRGlzcGxheSBhIGRlcG9zaXQgYWRkcmVzcy4gKi9cbiAgYXN5bmMgc2hvd0RlcG9zaXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIHRoaXMuZGVwb3NpdEFkZHJGb3JtLnNldEFzc2V0KGFzc2V0SUQpXG4gICAgdGhpcy5mb3Jtcy5zaG93KHRoaXMucGFnZS5kZXBvc2l0KVxuICB9XG5cbiAgc2hvd0N1c3RvbVByb3ZpZGVyRGlhbG9nIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBhcHAoKS5sb2FkUGFnZSgnd2FsbGV0cycsIHsgcHJvbXB0UHJvdmlkZXI6IGFzc2V0SUQsIGdvQmFjazogJ21hcmtldHMnIH0pXG4gIH1cblxuICAvKlxuICAgKiBoYW5kbGVQcmljZVVwZGF0ZSBpcyB0aGUgaGFuZGxlciBmb3IgdGhlICdzcG90cycgbm90aWZpY2F0aW9uLlxuICAgKi9cbiAgaGFuZGxlUHJpY2VVcGRhdGUgKG5vdGU6IFNwb3RQcmljZU5vdGUpIHtcbiAgICBpZiAoIXRoaXMubWFya2V0KSByZXR1cm4gLy8gVGhpcyBub3RlIGNhbiBhcnJpdmUgYmVmb3JlIHRoZSBtYXJrZXQgaXMgc2V0LlxuICAgIGlmIChub3RlLmhvc3QgPT09IHRoaXMubWFya2V0LmRleC5ob3N0ICYmIG5vdGUuc3BvdHNbdGhpcy5tYXJrZXQuY2ZnLm5hbWVdKSB7XG4gICAgICB0aGlzLnNldEN1cnJNYXJrZXRQcmljZSgpXG4gICAgfVxuICAgIHRoaXMubWFya2V0TGlzdC51cGRhdGVTcG90cyhub3RlKVxuICB9XG5cbiAgYXN5bmMgaGFuZGxlV2FsbGV0U3RhdGUgKG5vdGU6IFdhbGxldFN0YXRlTm90ZSkge1xuICAgIGlmICghdGhpcy5tYXJrZXQpIHJldHVybiAvLyBUaGlzIG5vdGUgY2FuIGFycml2ZSBiZWZvcmUgdGhlIG1hcmtldCBpcyBzZXQuXG4gICAgLy8gaWYgKG5vdGUudG9waWMgIT09ICdUb2tlbkFwcHJvdmFsJykgcmV0dXJuXG4gICAgaWYgKG5vdGUud2FsbGV0LmFzc2V0SUQgIT09IHRoaXMubWFya2V0LmJhc2U/LmlkICYmIG5vdGUud2FsbGV0LmFzc2V0SUQgIT09IHRoaXMubWFya2V0LnF1b3RlPy5pZCkgcmV0dXJuXG4gICAgdGhpcy5zZXRUb2tlbkFwcHJvdmFsVmlzaWJpbGl0eSgpXG4gICAgdGhpcy5yZXNvbHZlT3JkZXJGb3JtVmlzaWJpbGl0eSgpXG4gIH1cblxuICAvKlxuICAgKiBoYW5kbGVCb25kVXBkYXRlIGlzIHRoZSBoYW5kbGVyIGZvciB0aGUgJ2JvbmRwb3N0JyBub3RpZmljYXRpb24gdHlwZS5cbiAgICogVGhpcyBpcyB1c2VkIHRvIHVwZGF0ZSB0aGUgcmVnaXN0cmF0aW9uIHN0YXR1cyBvZiB0aGUgY3VycmVudCBleGNoYW5nZS5cbiAgICovXG4gIGFzeW5jIGhhbmRsZUJvbmRVcGRhdGUgKG5vdGU6IEJvbmROb3RlKSB7XG4gICAgY29uc3QgZGV4QWRkciA9IG5vdGUuZGV4XG4gICAgaWYgKCF0aGlzLm1hcmtldCkgcmV0dXJuIC8vIFRoaXMgbm90ZSBjYW4gYXJyaXZlIGJlZm9yZSB0aGUgbWFya2V0IGlzIHNldC5cbiAgICBpZiAoZGV4QWRkciAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QpIHJldHVyblxuICAgIC8vIElmIHdlIGp1c3QgZmluaXNoZWQgbGVnYWN5IHJlZ2lzdHJhdGlvbiwgd2UgbmVlZCB0byB1cGRhdGUgdGhlIEV4Y2hhbmdlLlxuICAgIC8vIFRPRE86IFVzZSB0aWVyIGNoYW5nZSBub3RpZmljYXRpb24gb25jZSBhdmFpbGFibGUuXG4gICAgaWYgKG5vdGUudG9waWMgPT09ICdBY2NvdW50UmVnaXN0ZXJlZCcpIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgLy8gVXBkYXRlIGxvY2FsIGNvcHkgb2YgRXhjaGFuZ2UuXG4gICAgdGhpcy5tYXJrZXQuZGV4ID0gYXBwKCkuZXhjaGFuZ2VzW2RleEFkZHJdXG4gICAgdGhpcy5zZXRSZWdpc3RyYXRpb25TdGF0dXNWaXNpYmlsaXR5KClcbiAgICB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKVxuICB9XG5cbiAgdXBkYXRlUmVwdXRhdGlvbiAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBtYXJrZXQ6IHsgZGV4OiB7IGhvc3QgfSwgY2ZnOiBta3QsIGJhc2VDZmc6IHsgdW5pdEluZm86IGJ1aSB9LCBxdW90ZUNmZzogeyB1bml0SW5mbzogcXVpIH0gfSB9ID0gdGhpc1xuICAgIGNvbnN0IHsgYXV0aCB9ID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdXG5cbiAgICBwYWdlLnBhcmNlbFNpemVMb3RzLnRleHRDb250ZW50ID0gU3RyaW5nKG1rdC5wYXJjZWxzaXplKVxuICAgIHBhZ2UubWFya2V0TGltaXRCYXNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKG1rdC5wYXJjZWxzaXplICogbWt0LmxvdHNpemUgLyBidWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgcGFnZS5tYXJrZXRMaW1pdEJhc2VVbml0LnRleHRDb250ZW50ID0gYnVpLmNvbnZlbnRpb25hbC51bml0XG4gICAgcGFnZS5tYXJrZXRMaW1pdFF1b3RlVW5pdC50ZXh0Q29udGVudCA9IHF1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIGNvbnN0IGNvbnZlcnNpb25SYXRlID0gdGhpcy5hbnlSYXRlKClbMV1cbiAgICBpZiAoY29udmVyc2lvblJhdGUpIHtcbiAgICAgIGNvbnN0IHF1b3RlTG90ID0gbWt0LmxvdHNpemUgKiBjb252ZXJzaW9uUmF0ZVxuICAgICAgcGFnZS5tYXJrZXRMaW1pdFF1b3RlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKG1rdC5wYXJjZWxzaXplICogcXVvdGVMb3QgLyBxdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgfSBlbHNlIHBhZ2UubWFya2V0TGltaXRRdW90ZS50ZXh0Q29udGVudCA9ICctJ1xuXG4gICAgY29uc3QgdGllciA9IHN0cm9uZ1RpZXIoYXV0aClcbiAgICBwYWdlLnRyYWRpbmdUaWVyLnRleHRDb250ZW50ID0gU3RyaW5nKHRpZXIpXG4gICAgY29uc3QgW3VzZWRQYXJjZWxzLCBwYXJjZWxMaW1pdF0gPSB0cmFkaW5nTGltaXRzKGhvc3QpXG4gICAgcGFnZS50cmFkaW5nTGltaXQudGV4dENvbnRlbnQgPSAocGFyY2VsTGltaXQgKiBta3QucGFyY2Vsc2l6ZSkudG9GaXhlZCgyKVxuICAgIHBhZ2UubGltaXRVc2FnZS50ZXh0Q29udGVudCA9IHBhcmNlbExpbWl0ID4gMCA/ICh1c2VkUGFyY2VscyAvIHBhcmNlbExpbWl0ICogMTAwKS50b0ZpeGVkKDEpIDogJzAnXG5cbiAgICBwYWdlLm9yZGVyTGltaXRSZW1haW4udGV4dENvbnRlbnQgPSAoKHBhcmNlbExpbWl0IC0gdXNlZFBhcmNlbHMpICogbWt0LnBhcmNlbHNpemUpLnRvRml4ZWQoMSlcbiAgICBwYWdlLm9yZGVyVHJhZGluZ1RpZXIudGV4dENvbnRlbnQgPSBTdHJpbmcodGllcilcblxuICAgIHRoaXMucmVwdXRhdGlvbk1ldGVyLnVwZGF0ZSgpXG4gIH1cblxuICAvKlxuICAgKiBhbnlSYXRlIGZpbmRzIHRoZSBiZXN0IHJhdGUgZnJvbSBhbnkgb2YsIGluIG9yZGVyIG9mIHByaW9yaXR5LCB0aGUgb3JkZXJcbiAgICogYm9vaywgdGhlIHNlcnZlcidzIHJlcG9ydGVkIHNwb3QgcmF0ZSwgb3IgdGhlIGZpYXQgZXhjaGFuZ2UgcmF0ZXMuIEFcbiAgICogMy10dXBsZSBvZiBtZXNzYWdlLXJhdGUgZW5jb2RpbmcsIGEgY29udmVyc2lvbiByYXRlLCBhbmQgYSBjb252ZW50aW9uYWxcbiAgICogcmF0ZSBpcyBnZW5lcmF0ZWQuXG4gICAqL1xuICBhbnlSYXRlICgpOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlcl0ge1xuICAgIGNvbnN0IHsgY2ZnOiB7IHNwb3QgfSwgYmFzZUNmZzogeyBpZDogYmFzZUlEIH0sIHF1b3RlQ2ZnOiB7IGlkOiBxdW90ZUlEIH0sIHJhdGVDb252ZXJzaW9uRmFjdG9yLCBib29rTG9hZGVkIH0gPSB0aGlzLm1hcmtldFxuICAgIGlmIChib29rTG9hZGVkKSB7XG4gICAgICBjb25zdCBtaWRHYXAgPSB0aGlzLm1pZEdhcCgpXG4gICAgICBpZiAobWlkR2FwKSByZXR1cm4gW21pZEdhcCAqIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IsIG1pZEdhcCwgdGhpcy5taWRHYXBDb252ZW50aW9uYWwoKSB8fCAwXVxuICAgIH1cbiAgICBpZiAoc3BvdCAmJiBzcG90LnJhdGUpIHJldHVybiBbc3BvdC5yYXRlLCBzcG90LnJhdGUgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yLCBzcG90LnJhdGUgLyByYXRlQ29udmVyc2lvbkZhY3Rvcl1cbiAgICBjb25zdCBbYmFzZVVTRCwgcXVvdGVVU0RdID0gW2FwcCgpLmZpYXRSYXRlc01hcFtiYXNlSURdLCBhcHAoKS5maWF0UmF0ZXNNYXBbcXVvdGVJRF1dXG4gICAgaWYgKGJhc2VVU0QgJiYgcXVvdGVVU0QpIHtcbiAgICAgIGNvbnN0IGNvbnZlbnRpb25hbFJhdGUgPSBiYXNlVVNEIC8gcXVvdGVVU0RcbiAgICAgIGNvbnN0IG1zZ1JhdGUgPSBjb252ZW50aW9uYWxSYXRlICogcmF0ZUNvbnZlcnNpb25GYWN0b3JcbiAgICAgIGNvbnN0IGNvbnZlcnNpb25SYXRlID0gbXNnUmF0ZSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3JcbiAgICAgIHJldHVybiBbbXNnUmF0ZSwgY29udmVyc2lvblJhdGUsIGNvbnZlbnRpb25hbFJhdGVdXG4gICAgfVxuICAgIHJldHVybiBbMCwgMCwgMF1cbiAgfVxuXG4gIGhhbmRsZU1hdGNoTm90ZSAobm90ZTogTWF0Y2hOb3RlKSB7XG4gICAgY29uc3QgbW9yZCA9IHRoaXMubWV0YU9yZGVyc1tub3RlLm9yZGVySURdXG4gICAgY29uc3QgbWF0Y2ggPSBub3RlLm1hdGNoXG4gICAgaWYgKCFtb3JkKSByZXR1cm4gdGhpcy5yZWZyZXNoQWN0aXZlT3JkZXJzKClcbiAgICBlbHNlIGlmIChtb3JkLm9yZC50eXBlID09PSBPcmRlclV0aWwuTWFya2V0ICYmIG1hdGNoLnN0YXR1cyA9PT0gT3JkZXJVdGlsLk5ld2x5TWF0Y2hlZCkgeyAvLyBVcGRhdGUgdGhlIGF2ZXJhZ2UgbWFya2V0IHJhdGUgZGlzcGxheS5cbiAgICAgIC8vIEZldGNoIGFuZCB1c2UgdGhlIHVwZGF0ZWQgb3JkZXIuXG4gICAgICBjb25zdCBvcmQgPSBhcHAoKS5vcmRlcihub3RlLm9yZGVySUQpXG4gICAgICBpZiAob3JkKSBtb3JkLmRldGFpbHMucmF0ZS50ZXh0Q29udGVudCA9IG1vcmQuaGVhZGVyLnJhdGUudGV4dENvbnRlbnQgPSB0aGlzLm1hcmtldE9yZGVyUmF0ZVN0cmluZyhvcmQsIHRoaXMubWFya2V0KVxuICAgIH1cbiAgICBpZiAoXG4gICAgICAobWF0Y2guc2lkZSA9PT0gT3JkZXJVdGlsLk1hdGNoU2lkZU1ha2VyICYmIG1hdGNoLnN0YXR1cyA9PT0gT3JkZXJVdGlsLk1ha2VyUmVkZWVtZWQpIHx8XG4gICAgICAobWF0Y2guc2lkZSA9PT0gT3JkZXJVdGlsLk1hdGNoU2lkZVRha2VyICYmIG1hdGNoLnN0YXR1cyA9PT0gT3JkZXJVdGlsLk1hdGNoQ29tcGxldGUpXG4gICAgKSB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKVxuICAgIGlmIChhcHAoKS5jYW5BY2NlbGVyYXRlT3JkZXIobW9yZC5vcmQpKSBEb2Muc2hvdyhtb3JkLmRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4pXG4gICAgZWxzZSBEb2MuaGlkZShtb3JkLmRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4pXG4gIH1cblxuICAvKlxuICAgKiBoYW5kbGVPcmRlck5vdGUgaXMgdGhlIGhhbmRsZXIgZm9yIHRoZSAnb3JkZXInLXR5cGUgbm90aWZpY2F0aW9uLCB3aGljaCBhcmVcbiAgICogdXNlZCB0byB1cGRhdGUgYSB1c2VyJ3Mgb3JkZXIncyBzdGF0dXMuXG4gICAqL1xuICBoYW5kbGVPcmRlck5vdGUgKG5vdGU6IE9yZGVyTm90ZSkge1xuICAgIGNvbnN0IG9yZCA9IG5vdGUub3JkZXJcbiAgICBjb25zdCBtb3JkID0gdGhpcy5tZXRhT3JkZXJzW29yZC5pZF1cbiAgICAvLyAtIElmIG1ldGFPcmRlciBkb2Vzbid0IGV4aXN0IGZvciB0aGUgZ2l2ZW4gb3JkZXIgaXQgbWVhbnMgaXQgd2FzIGNyZWF0ZWRcbiAgICAvLyAgdmlhIGJ3Y3RsIGFuZCB0aGUgR1VJIGlzbid0IGF3YXJlIG9mIGl0IG9yIGl0IHdhcyBhbiBpbmZsaWdodCBvcmRlci5cbiAgICAvLyAgcmVmcmVzaEFjdGl2ZU9yZGVycyBtdXN0IGJlIGNhbGxlZCB0byBncmFiIHRoaXMgb3JkZXIuXG4gICAgLy8gLSBJZiBhbiBPcmRlckxvYWRlZCBub3RpZmljYXRpb24gaXMgcmVjaWV2ZWQsIGl0IG1lYW5zIGFuIG9yZGVyIHRoYXQgd2FzXG4gICAgLy8gICBwcmV2aW91c2x5IG5vdCBcInJlYWR5IHRvIHRpY2tcIiAoZHVlIHRvIGl0cyB3YWxsZXRzIG5vdCBiZWluZyBjb25uZWN0ZWRcbiAgICAvLyAgIGFuZCB1bmxvY2tlZCkgaGFzIG5vdyBiZWNvbWUgcmVhZHkgdG8gdGljay4gVGhlIGFjdGl2ZSBvcmRlcnMgc2VjdGlvblxuICAgIC8vICAgbmVlZHMgdG8gYmUgcmVmcmVzaGVkLlxuICAgIGNvbnN0IHdhc0luZmxpZ2h0ID0gbm90ZS50b3BpYyA9PT0gJ0FzeW5jT3JkZXJGYWlsdXJlJyB8fCBub3RlLnRvcGljID09PSAnQXN5bmNPcmRlclN1Ym1pdHRlZCdcbiAgICBpZiAoIW1vcmQgfHwgd2FzSW5mbGlnaHQgfHwgKG5vdGUudG9waWMgPT09ICdPcmRlckxvYWRlZCcgJiYgb3JkLnJlYWR5VG9UaWNrKSkge1xuICAgICAgcmV0dXJuIHRoaXMucmVmcmVzaEFjdGl2ZU9yZGVycygpXG4gICAgfVxuICAgIGNvbnN0IG9sZFN0YXR1cyA9IG1vcmQub3JkLnN0YXR1c1xuICAgIG1vcmQub3JkID0gb3JkXG4gICAgaWYgKG5vdGUudG9waWMgPT09ICdNaXNzZWRDYW5jZWwnKSBEb2Muc2hvdyhtb3JkLmRldGFpbHMuY2FuY2VsQnR0bilcbiAgICBpZiAob3JkLmZpbGxlZCA9PT0gb3JkLnF0eSkgRG9jLmhpZGUobW9yZC5kZXRhaWxzLmNhbmNlbEJ0dG4pXG4gICAgaWYgKGFwcCgpLmNhbkFjY2VsZXJhdGVPcmRlcihvcmQpKSBEb2Muc2hvdyhtb3JkLmRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4pXG4gICAgZWxzZSBEb2MuaGlkZShtb3JkLmRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4pXG4gICAgdGhpcy51cGRhdGVNZXRhT3JkZXIobW9yZClcbiAgICAvLyBPbmx5IHJlc2V0IG1hcmtlcnMgaWYgdGhlcmUgaXMgYSBjaGFuZ2UsIHNpbmNlIHRoZSBjaGFydCBpcyByZWRyYXduLlxuICAgIGlmIChcbiAgICAgIChvbGRTdGF0dXMgPT09IE9yZGVyVXRpbC5TdGF0dXNFcG9jaCAmJiBvcmQuc3RhdHVzID09PSBPcmRlclV0aWwuU3RhdHVzQm9va2VkKSB8fFxuICAgICAgKG9sZFN0YXR1cyA9PT0gT3JkZXJVdGlsLlN0YXR1c0Jvb2tlZCAmJiBvcmQuc3RhdHVzID4gT3JkZXJVdGlsLlN0YXR1c0Jvb2tlZClcbiAgICApIHtcbiAgICAgIHRoaXMuc2V0RGVwdGhNYXJrZXJzKClcbiAgICAgIHRoaXMudXBkYXRlUmVwdXRhdGlvbigpXG4gICAgICB0aGlzLm1tLnJlYWRCb29rKClcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBoYW5kbGVFcG9jaE5vdGUgaGFuZGxlcyBub3RpZmljYXRpb25zIHNpZ25hbGxpbmcgdGhlIHN0YXJ0IG9mIGEgbmV3IGVwb2NoLlxuICAgKi9cbiAgaGFuZGxlRXBvY2hOb3RlIChub3RlOiBFcG9jaE5vdGUpIHtcbiAgICBhcHAoKS5sb2coJ2Jvb2snLCAnaGFuZGxlRXBvY2hOb3RlOicsIG5vdGUpXG4gICAgaWYgKCF0aGlzLm1hcmtldCkgcmV0dXJuIC8vIFRoaXMgbm90ZSBjYW4gYXJyaXZlIGJlZm9yZSB0aGUgbWFya2V0IGlzIHNldC5cbiAgICBpZiAobm90ZS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCB8fCBub3RlLm1hcmtldElEICE9PSB0aGlzLm1hcmtldC5zaWQpIHJldHVyblxuICAgIGlmICh0aGlzLmJvb2spIHtcbiAgICAgIHRoaXMuYm9vay5zZXRFcG9jaChub3RlLmVwb2NoKVxuICAgICAgdGhpcy5kZXB0aENoYXJ0LmRyYXcoKVxuICAgIH1cblxuICAgIHRoaXMuY2xlYXJPcmRlclRhYmxlRXBvY2hzKClcbiAgICBmb3IgKGNvbnN0IHsgb3JkLCBkZXRhaWxzLCBoZWFkZXIgfSBvZiBPYmplY3QudmFsdWVzKHRoaXMubWV0YU9yZGVycykpIHtcbiAgICAgIGNvbnN0IGFscmVhZHlNYXRjaGVkID0gbm90ZS5lcG9jaCA+IG9yZC5lcG9jaFxuICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgIGNhc2Ugb3JkLnR5cGUgPT09IE9yZGVyVXRpbC5MaW1pdCAmJiBvcmQuc3RhdHVzID09PSBPcmRlclV0aWwuU3RhdHVzRXBvY2ggJiYgYWxyZWFkeU1hdGNoZWQ6IHtcbiAgICAgICAgICBjb25zdCBzdGF0dXMgPSBvcmQudGlmID09PSBPcmRlclV0aWwuSW1tZWRpYXRlVGlGID8gaW50bC5wcmVwKGludGwuSURfRVhFQ1VURUQpIDogaW50bC5wcmVwKGludGwuSURfQk9PS0VEKVxuICAgICAgICAgIGRldGFpbHMuc3RhdHVzLnRleHRDb250ZW50ID0gaGVhZGVyLnN0YXR1cy50ZXh0Q29udGVudCA9IHN0YXR1c1xuICAgICAgICAgIG9yZC5zdGF0dXMgPSBvcmQudGlmID09PSBPcmRlclV0aWwuSW1tZWRpYXRlVGlGID8gT3JkZXJVdGlsLlN0YXR1c0V4ZWN1dGVkIDogT3JkZXJVdGlsLlN0YXR1c0Jvb2tlZFxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBvcmQudHlwZSA9PT0gT3JkZXJVdGlsLk1hcmtldCAmJiBvcmQuc3RhdHVzID09PSBPcmRlclV0aWwuU3RhdHVzRXBvY2g6XG4gICAgICAgICAgLy8gVGVjaG5pY2FsbHkgZG9uJ3Qga25vdyBpZiB0aGlzIHNob3VsZCBiZSAnZXhlY3V0ZWQnIG9yICdzZXR0bGluZycuXG4gICAgICAgICAgZGV0YWlscy5zdGF0dXMudGV4dENvbnRlbnQgPSBoZWFkZXIuc3RhdHVzLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfRVhFQ1VURUQpXG4gICAgICAgICAgb3JkLnN0YXR1cyA9IE9yZGVyVXRpbC5TdGF0dXNFeGVjdXRlZFxuICAgICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogcmVjZW50TWF0Y2hlc1NvcnRDb21wYXJlIHJldHVybnMgc29ydCBjb21wYXJlIGZ1bmN0aW9uIGFjY29yZGluZyB0byB0aGUgYWN0aXZlXG4gICAqIHNvcnQga2V5IGFuZCBkaXJlY3Rpb24uXG4gICAqL1xuICByZWNlbnRNYXRjaGVzU29ydENvbXBhcmUgKCkge1xuICAgIHN3aXRjaCAodGhpcy5yZWNlbnRNYXRjaGVzU29ydEtleSkge1xuICAgICAgY2FzZSAncmF0ZSc6XG4gICAgICAgIHJldHVybiAoYTogUmVjZW50TWF0Y2gsIGI6IFJlY2VudE1hdGNoKSA9PiB0aGlzLnJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uICogKGEucmF0ZSAtIGIucmF0ZSlcbiAgICAgIGNhc2UgJ3F0eSc6XG4gICAgICAgIHJldHVybiAoYTogUmVjZW50TWF0Y2gsIGI6IFJlY2VudE1hdGNoKSA9PiB0aGlzLnJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uICogKGEucXR5IC0gYi5xdHkpXG4gICAgICBjYXNlICdhZ2UnOlxuICAgICAgICByZXR1cm4gKGE6IFJlY2VudE1hdGNoLCBiOlJlY2VudE1hdGNoKSA9PiB0aGlzLnJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uICogKGEuc3RhbXAgLSBiLnN0YW1wKVxuICAgIH1cbiAgfVxuXG4gIHJlZnJlc2hSZWNlbnRNYXRjaGVzVGFibGUgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCByZWNlbnRNYXRjaGVzID0gdGhpcy5yZWNlbnRNYXRjaGVzXG4gICAgRG9jLmVtcHR5KHBhZ2UucmVjZW50TWF0Y2hlc0xpdmVMaXN0KVxuICAgIGlmICghcmVjZW50TWF0Y2hlcykgcmV0dXJuXG4gICAgY29uc3QgY29tcGFyZSA9IHRoaXMucmVjZW50TWF0Y2hlc1NvcnRDb21wYXJlKClcbiAgICByZWNlbnRNYXRjaGVzLnNvcnQoY29tcGFyZSlcbiAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIHJlY2VudE1hdGNoZXMpIHtcbiAgICAgIGNvbnN0IHJvdyA9IHBhZ2UucmVjZW50TWF0Y2hlc1RlbXBsYXRlLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIGFwcCgpLmJpbmRUb29sdGlwcyhyb3cpXG4gICAgICB0bXBsLnJhdGUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG1hdGNoLnJhdGUgLyB0aGlzLm1hcmtldC5yYXRlQ29udmVyc2lvbkZhY3RvcilcbiAgICAgIHRtcGwucXR5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShtYXRjaC5xdHksIHRoaXMubWFya2V0LmJhc2VVbml0SW5mbylcbiAgICAgIHRtcGwuYWdlLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShtYXRjaC5zdGFtcClcbiAgICAgIHRtcGwuYWdlLmRhdGFzZXQuc2luY2VTdGFtcCA9IFN0cmluZyhtYXRjaC5zdGFtcClcbiAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKG1hdGNoLnNlbGwgPyAnc2VsbGNvbG9yJyA6ICdidXljb2xvcicpXG4gICAgICBwYWdlLnJlY2VudE1hdGNoZXNMaXZlTGlzdC5hcHBlbmQocm93KVxuICAgIH1cbiAgfVxuXG4gIGFkZFJlY2VudE1hdGNoZXMgKG1hdGNoZXM6IFJlY2VudE1hdGNoW10pIHtcbiAgICB0aGlzLnJlY2VudE1hdGNoZXMgPSBbLi4ubWF0Y2hlcywgLi4udGhpcy5yZWNlbnRNYXRjaGVzXS5zbGljZSgwLCAxMDApXG4gIH1cblxuICAvKiBoYW5kbGVCYWxhbmNlTm90ZSBoYW5kbGVzIG5vdGlmaWNhdGlvbnMgdXBkYXRpbmcgYSB3YWxsZXQncyBiYWxhbmNlLiAqL1xuICBoYW5kbGVCYWxhbmNlTm90ZSAobm90ZTogQmFsYW5jZU5vdGUpIHtcbiAgICB0aGlzLmFwcHJvdmVUb2tlbkZvcm0uaGFuZGxlQmFsYW5jZU5vdGUobm90ZSlcbiAgICB0aGlzLnByZW9yZGVyQ2FjaGUgPSB7fSAvLyBpbnZhbGlkYXRlIHByZXZpb3VzIHByZW9yZGVyIHJlc3VsdHNcbiAgICAvLyBpZiBjb25uZWN0aW9uIHRvIGRleCBzZXJ2ZXIgZmFpbHMsIGl0IGlzIG5vdCBwb3NzaWJsZSB0byByZXRyaWV2ZVxuICAgIC8vIG1hcmtldHMuXG4gICAgY29uc3QgbWt0ID0gdGhpcy5tYXJrZXRcbiAgICBpZiAoIW1rdCB8fCAhbWt0LmRleCB8fCBta3QuZGV4LmNvbm5lY3Rpb25TdGF0dXMgIT09IENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGVkKSByZXR1cm5cblxuICAgIHRoaXMubW0uaGFuZGxlQmFsYW5jZU5vdGUobm90ZSlcbiAgICBjb25zdCB3Z3QgPSB0aGlzLmJhbGFuY2VXZ3RcbiAgICAvLyBEaXNwbGF5IHRoZSB3aWRnZXQgaWYgdGhlIGJhbGFuY2Ugbm90ZSBpcyBmb3IgaXRzIGJhc2Ugb3IgcXVvdGUgd2FsbGV0LlxuICAgIGlmICgobm90ZS5hc3NldElEID09PSB3Z3QuYmFzZS5pZCB8fCBub3RlLmFzc2V0SUQgPT09IHdndC5xdW90ZS5pZCkpIHdndC5zZXRCYWxhbmNlVmlzaWJpbGl0eSh0cnVlKVxuXG4gICAgLy8gSWYgdGhlcmUncyBhIGJhbGFuY2UgdXBkYXRlLCByZWZyZXNoIHRoZSBtYXggb3JkZXIgc2VjdGlvbi5cbiAgICBjb25zdCBhdmFpbCA9IG5vdGUuYmFsYW5jZS5hdmFpbGFibGVcbiAgICBzd2l0Y2ggKG5vdGUuYXNzZXRJRCkge1xuICAgICAgY2FzZSBta3QuYmFzZUNmZy5pZDpcbiAgICAgICAgLy8gSWYgd2UncmUgbm90IHNob3dpbmcgdGhlIG1heCBvcmRlciBwYW5lbCB5ZXQsIGRvbid0IGRvIGFueXRoaW5nLlxuICAgICAgICBpZiAoIW1rdC5tYXhTZWxsKSBicmVha1xuICAgICAgICBpZiAodHlwZW9mIG1rdC5zZWxsQmFsYW5jZSA9PT0gJ251bWJlcicgJiYgbWt0LnNlbGxCYWxhbmNlICE9PSBhdmFpbCkgbWt0Lm1heFNlbGwgPSBudWxsXG4gICAgICAgIGlmICh0aGlzLmlzU2VsbCgpKSB0aGlzLnByZVNlbGwoKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBta3QucXVvdGVDZmcuaWQ6XG4gICAgICAgIGlmICghT2JqZWN0LmtleXMobWt0Lm1heEJ1eXMpLmxlbmd0aCkgYnJlYWtcbiAgICAgICAgaWYgKHR5cGVvZiBta3QuYnV5QmFsYW5jZSA9PT0gJ251bWJlcicgJiYgbWt0LmJ1eUJhbGFuY2UgIT09IGF2YWlsKSBta3QubWF4QnV5cyA9IHt9XG4gICAgICAgIGlmICghdGhpcy5pc1NlbGwoKSkgdGhpcy5wcmVCdXkoKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIHN1Ym1pdE9yZGVyIGlzIGF0dGFjaGVkIHRvIHRoZSBhZmZpcm1hdGl2ZSBidXR0b24gb24gdGhlIG9yZGVyIHZhbGlkYXRpb25cbiAgICogZm9ybS4gQ2xpY2tpbmcgdGhlIGJ1dHRvbiBpcyB0aGUgbGFzdCBzdGVwIGluIHRoZSBvcmRlciBzdWJtaXNzaW9uIHByb2Nlc3MuXG4gICAqL1xuICBhc3luYyBzdWJtaXRPcmRlciAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2Uub3JkZXJFcnIsIHBhZ2UudkVycilcbiAgICBjb25zdCBvcmRlciA9IHRoaXMuY3VycmVudE9yZGVyXG4gICAgY29uc3QgcmVxID0geyBvcmRlcjogd2lyZU9yZGVyKG9yZGVyKSB9XG4gICAgaWYgKCF0aGlzLnZhbGlkYXRlT3JkZXIob3JkZXIpKSByZXR1cm5cbiAgICAvLyBTaG93IGxvYWRlciBhbmQgaGlkZSBzdWJtaXQgYnV0dG9uLlxuICAgIHBhZ2UudlN1Ym1pdC5jbGFzc0xpc3QuYWRkKCdkLWhpZGUnKVxuICAgIHBhZ2UudkxvYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdkLWhpZGUnKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3RyYWRlYXN5bmMnLCByZXEpXG4gICAgLy8gSGlkZSBsb2FkZXIgYW5kIHNob3cgc3VibWl0IGJ1dHRvbi5cbiAgICBwYWdlLnZTdWJtaXQuY2xhc3NMaXN0LnJlbW92ZSgnZC1oaWRlJylcbiAgICBwYWdlLnZMb2FkZXIuY2xhc3NMaXN0LmFkZCgnZC1oaWRlJylcbiAgICAvLyBJZiBlcnJvciwgZGlzcGxheSBlcnJvciBvbiBjb25maXJtYXRpb24gbW9kYWwuXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UudkVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UudkVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyBIaWRlIGNvbmZpcm1hdGlvbiBtb2RhbCBvbmx5IG9uIHN1Y2Nlc3MuXG4gICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICB0aGlzLnJlZnJlc2hBY3RpdmVPcmRlcnMoKVxuICB9XG5cbiAgLypcbiAgICogY3JlYXRlV2FsbGV0IGlzIGF0dGFjaGVkIHRvIHN1Y2Nlc3NmdWwgc3VibWlzc2lvbiBvZiB0aGUgd2FsbGV0IGNyZWF0aW9uXG4gICAqIGZvcm0uIGNyZWF0ZVdhbGxldCBpcyBvbmx5IGNhbGxlZCBvbmNlIHRoZSBmb3JtIGlzIHN1Ym1pdHRlZCBhbmQgYSBzdWNjZXNzXG4gICAqIHJlc3BvbnNlIGlzIHJlY2VpdmVkIGZyb20gdGhlIGNsaWVudC5cbiAgICovXG4gIGFzeW5jIGNyZWF0ZVdhbGxldCAoKSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgaWYgKCF1c2VyKSByZXR1cm5cbiAgICBjb25zdCBhc3NldCA9IHVzZXIuYXNzZXRzW3RoaXMuY3VycmVudENyZWF0ZS5pZF1cbiAgICBEb2MuaGlkZSh0aGlzLnBhZ2UuZm9ybXMpXG4gICAgY29uc3QgbWt0ID0gdGhpcy5tYXJrZXRcbiAgICBpZiAobWt0LmJhc2VDZmcuaWQgPT09IGFzc2V0LmlkKSBta3QuYmFzZSA9IGFzc2V0XG4gICAgZWxzZSBpZiAobWt0LnF1b3RlQ2ZnLmlkID09PSBhc3NldC5pZCkgbWt0LnF1b3RlID0gYXNzZXRcbiAgICB0aGlzLmJhbGFuY2VXZ3QudXBkYXRlQXNzZXQoYXNzZXQuaWQpXG4gICAgdGhpcy5kaXNwbGF5TWVzc2FnZUlmTWlzc2luZ1dhbGxldCgpXG4gICAgdGhpcy5yZXNvbHZlT3JkZXJGb3JtVmlzaWJpbGl0eSgpXG4gIH1cblxuICAvKiBsb3RDaGFuZ2VkIGlzIGF0dGFjaGVkIHRvIHRoZSBrZXl1cCBhbmQgY2hhbmdlIGV2ZW50cyBvZiB0aGUgbG90cyBpbnB1dC4gKi9cbiAgbG90Q2hhbmdlZCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGxvdHMgPSBwYXJzZUludChwYWdlLmxvdEZpZWxkLnZhbHVlIHx8ICcwJylcbiAgICBpZiAobG90cyA8PSAwKSB7XG4gICAgICBwYWdlLmxvdEZpZWxkLnZhbHVlID0gcGFnZS5sb3RGaWVsZC52YWx1ZSA9PT0gJycgPyAnJyA6ICcwJ1xuICAgICAgcGFnZS5xdHlGaWVsZC52YWx1ZSA9ICcnXG4gICAgICB0aGlzLnByZXZpZXdRdW90ZUFtdChmYWxzZSlcbiAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChmYWxzZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX1FUWV9FUlJPUikpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgbG90U2l6ZSA9IHRoaXMubWFya2V0LmNmZy5sb3RzaXplXG4gICAgY29uc3Qgb3JkZXJRdHkgPSBsb3RzICogbG90U2l6ZVxuICAgIHBhZ2UubG90RmllbGQudmFsdWUgPSBTdHJpbmcobG90cylcbiAgICAvLyBDb252ZXJzaW9uIGZhY3RvciBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTAuXG4gICAgcGFnZS5xdHlGaWVsZC52YWx1ZSA9IFN0cmluZyhvcmRlclF0eSAvIHRoaXMubWFya2V0LmJhc2VVbml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcblxuICAgIGlmICghdGhpcy5pc0xpbWl0KCkgJiYgdGhpcy5pc1NlbGwoKSkge1xuICAgICAgY29uc3QgYmFzZVdhbGxldCA9IGFwcCgpLmFzc2V0c1t0aGlzLm1hcmtldC5iYXNlLmlkXS53YWxsZXRcbiAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChvcmRlclF0eSA8PSBiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fU0VMTF9CQUxBTkNFX0VSUk9SKSlcbiAgICB9XG4gICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQodHJ1ZSlcbiAgfVxuXG4gIC8qXG4gICAqIHF1YW50aXR5Q2hhbmdlZCBpcyBhdHRhY2hlZCB0byB0aGUga2V5dXAgYW5kIGNoYW5nZSBldmVudHMgb2YgdGhlIHF1YW50aXR5XG4gICAqIGlucHV0LlxuICAgKi9cbiAgcXVhbnRpdHlDaGFuZ2VkIChmaW5hbGl6ZTogYm9vbGVhbikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBvcmRlciA9IHRoaXMuY3VycmVudE9yZGVyID0gdGhpcy5wYXJzZU9yZGVyKClcbiAgICBpZiAob3JkZXIucXR5IDwgMCkge1xuICAgICAgcGFnZS5sb3RGaWVsZC52YWx1ZSA9ICcwJ1xuICAgICAgcGFnZS5xdHlGaWVsZC52YWx1ZSA9ICcnXG4gICAgICB0aGlzLnByZXZpZXdRdW90ZUFtdChmYWxzZSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBsb3RTaXplID0gdGhpcy5tYXJrZXQuY2ZnLmxvdHNpemVcbiAgICBjb25zdCBsb3RzID0gTWF0aC5mbG9vcihvcmRlci5xdHkgLyBsb3RTaXplKVxuICAgIGNvbnN0IGFkanVzdGVkID0gb3JkZXIucXR5ID0gdGhpcy5jdXJyZW50T3JkZXIucXR5ID0gbG90cyAqIGxvdFNpemVcbiAgICBwYWdlLmxvdEZpZWxkLnZhbHVlID0gU3RyaW5nKGxvdHMpXG5cbiAgICBpZiAoIW9yZGVyLmlzTGltaXQgJiYgIW9yZGVyLnNlbGwpIHJldHVyblxuXG4gICAgLy8gQ29udmVyc2lvbiBmYWN0b3IgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDEwLlxuICAgIGlmIChmaW5hbGl6ZSkgcGFnZS5xdHlGaWVsZC52YWx1ZSA9IFN0cmluZyhhZGp1c3RlZCAvIHRoaXMubWFya2V0LmJhc2VVbml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICB0aGlzLnByZXZpZXdRdW90ZUFtdCh0cnVlKVxuICB9XG5cbiAgLypcbiAgICogbWFya2V0QnV5Q2hhbmdlZCBpcyBhdHRhY2hlZCB0byB0aGUga2V5dXAgYW5kIGNoYW5nZSBldmVudHMgb2YgdGhlIHF1YW50aXR5XG4gICAqIGlucHV0IGZvciB0aGUgbWFya2V0LWJ1eSBmb3JtLlxuICAgKi9cbiAgbWFya2V0QnV5Q2hhbmdlZCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IHF0eSA9IGNvbnZlcnRUb0F0b21zKHBhZ2UubWt0QnV5RmllbGQudmFsdWUgfHwgJycsIHRoaXMubWFya2V0LnF1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgY29uc3QgZ2FwID0gdGhpcy5taWRHYXAoKVxuICAgIGlmIChxdHkgPiAwKSB7XG4gICAgICBjb25zdCBxdW90ZVdhbGxldCA9IGFwcCgpLmFzc2V0c1t0aGlzLm1hcmtldC5xdW90ZS5pZF0ud2FsbGV0XG4gICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQocXR5IDw9IHF1b3RlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fQlVZX0JBTEFOQ0VfRVJST1IpKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQoZmFsc2UsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9RVFlfRVJST1IpKVxuICAgIH1cbiAgICBpZiAoIWdhcCB8fCAhcXR5KSB7XG4gICAgICBwYWdlLm1rdEJ1eUxvdHMudGV4dENvbnRlbnQgPSAnMCdcbiAgICAgIHBhZ2UubWt0QnV5U2NvcmUudGV4dENvbnRlbnQgPSAnMCdcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBsb3RTaXplID0gdGhpcy5tYXJrZXQuY2ZnLmxvdHNpemVcbiAgICBjb25zdCByZWNlaXZlZCA9IHF0eSAvIGdhcFxuICAgIGNvbnN0IGxvdHMgPSAocmVjZWl2ZWQgLyBsb3RTaXplKVxuICAgIHBhZ2UubWt0QnV5TG90cy50ZXh0Q29udGVudCA9IGxvdHMudG9GaXhlZCgxKVxuICAgIHBhZ2UubWt0QnV5U2NvcmUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlY2VpdmVkLCB0aGlzLm1hcmtldC5iYXNlVW5pdEluZm8pXG4gIH1cblxuICAvKlxuICAgKiByYXRlRmllbGRDaGFuZ2VkIGlzIGF0dGFjaGVkIHRvIHRoZSBrZXl1cCBhbmQgY2hhbmdlIGV2ZW50cyBvZiB0aGUgcmF0ZVxuICAgKiBpbnB1dC5cbiAgICovXG4gIHJhdGVGaWVsZENoYW5nZWQgKCkge1xuICAgIC8vIFRydW5jYXRlIHRvIHJhdGUgc3RlcC4gSWYgaXQgaXMgYSBtYXJrZXQgYnV5IG9yZGVyLCBkbyBub3QgYWRqdXN0LlxuICAgIGNvbnN0IGFkanVzdGVkID0gdGhpcy5hZGp1c3RlZFJhdGUoKVxuICAgIGlmIChhZGp1c3RlZCA8PSAwKSB7XG4gICAgICB0aGlzLmRlcHRoTGluZXMuaW5wdXQgPSBbXVxuICAgICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgICB0aGlzLnBhZ2UucmF0ZUZpZWxkLnZhbHVlID0gJzAnXG4gICAgICB0aGlzLnByZXZpZXdRdW90ZUFtdCh0cnVlKVxuICAgICAgdGhpcy51cGRhdGVPcmRlckJ0dG5TdGF0ZSgpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLmN1cnJlbnRPcmRlciA9IHRoaXMucGFyc2VPcmRlcigpXG4gICAgY29uc3QgciA9IGFkanVzdGVkIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3JcbiAgICB0aGlzLnBhZ2UucmF0ZUZpZWxkLnZhbHVlID0gU3RyaW5nKHIpXG4gICAgdGhpcy5kZXB0aExpbmVzLmlucHV0ID0gW3tcbiAgICAgIHJhdGU6IHIsXG4gICAgICBjb2xvcjogb3JkZXIuc2VsbCA/IHRoaXMuZGVwdGhDaGFydC50aGVtZS5zZWxsTGluZSA6IHRoaXMuZGVwdGhDaGFydC50aGVtZS5idXlMaW5lXG4gICAgfV1cbiAgICB0aGlzLmRyYXdDaGFydExpbmVzKClcbiAgICB0aGlzLnByZXZpZXdRdW90ZUFtdCh0cnVlKVxuICAgIHRoaXMudXBkYXRlT3JkZXJCdHRuU3RhdGUoKVxuICB9XG5cbiAgLypcbiAgICogYWRqdXN0ZWRSYXRlIGlzIHRoZSBjdXJyZW50IHJhdGUgZmllbGQgcmF0ZSwgcm91bmRlZCBkb3duIHRvIGFcbiAgICogbXVsdGlwbGUgb2YgcmF0ZVN0ZXAuXG4gICAqL1xuICBhZGp1c3RlZFJhdGUgKCk6IG51bWJlciB7XG4gICAgY29uc3QgdiA9IHRoaXMucGFnZS5yYXRlRmllbGQudmFsdWVcbiAgICBpZiAoIXYpIHJldHVybiBOYU5cbiAgICBjb25zdCByYXRlID0gY29udmVydFRvQXRvbXModiwgdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgY29uc3QgcmF0ZVN0ZXAgPSB0aGlzLm1hcmtldC5jZmcucmF0ZXN0ZXBcbiAgICByZXR1cm4gcmF0ZSAtIChyYXRlICUgcmF0ZVN0ZXApXG4gIH1cblxuICAvKiBsb2FkVGFibGUgcmVsb2FkcyB0aGUgdGFibGUgZnJvbSB0aGUgY3VycmVudCBvcmRlciBib29rIGluZm9ybWF0aW9uLiAqL1xuICBsb2FkVGFibGUgKCkge1xuICAgIHRoaXMubG9hZFRhYmxlU2lkZSh0cnVlKVxuICAgIHRoaXMubG9hZFRhYmxlU2lkZShmYWxzZSlcbiAgfVxuXG4gIC8qIGJpbk9yZGVyc0J5UmF0ZUFuZEVwb2NoIHRha2VzIGEgbGlzdCBvZiBzb3J0ZWQgb3JkZXJzIGFuZCByZXR1cm5zIHRoZVxuICAgICBzYW1lIG9yZGVycyBncm91cGVkIGludG8gYXJyYXlzLiBUaGUgb3JkZXJzIGFyZSBncm91cGVkIGJ5IHRoZWlyIHJhdGVcbiAgICAgYW5kIHdoZXRoZXIgb3Igbm90IHRoZXkgYXJlIGVwb2NoIHF1ZXVlIG9yZGVycy4gRXBvY2ggcXVldWUgb3JkZXJzXG4gICAgIHdpbGwgY29tZSBhZnRlciBub24gZXBvY2ggcXVldWUgb3JkZXJzIHdpdGggdGhlIHNhbWUgcmF0ZS4gKi9cbiAgYmluT3JkZXJzQnlSYXRlQW5kRXBvY2ggKG9yZGVyczogTWluaU9yZGVyW10pIHtcbiAgICBpZiAoIW9yZGVycyB8fCAhb3JkZXJzLmxlbmd0aCkgcmV0dXJuIFtdXG4gICAgY29uc3QgYmlucyA9IFtdXG4gICAgbGV0IGN1cnJFcG9jaEJpbiA9IFtdXG4gICAgbGV0IGN1cnJOb25FcG9jaEJpbiA9IFtdXG4gICAgbGV0IGN1cnJSYXRlID0gb3JkZXJzWzBdLm1zZ1JhdGVcbiAgICBpZiAob3JkZXJzWzBdLmVwb2NoKSBjdXJyRXBvY2hCaW4ucHVzaChvcmRlcnNbMF0pXG4gICAgZWxzZSBjdXJyTm9uRXBvY2hCaW4ucHVzaChvcmRlcnNbMF0pXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCBvcmRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChvcmRlcnNbaV0ubXNnUmF0ZSAhPT0gY3VyclJhdGUpIHtcbiAgICAgICAgYmlucy5wdXNoKGN1cnJOb25FcG9jaEJpbilcbiAgICAgICAgYmlucy5wdXNoKGN1cnJFcG9jaEJpbilcbiAgICAgICAgY3VyckVwb2NoQmluID0gW11cbiAgICAgICAgY3Vyck5vbkVwb2NoQmluID0gW11cbiAgICAgICAgY3VyclJhdGUgPSBvcmRlcnNbaV0ubXNnUmF0ZVxuICAgICAgfVxuICAgICAgaWYgKG9yZGVyc1tpXS5lcG9jaCkgY3VyckVwb2NoQmluLnB1c2gob3JkZXJzW2ldKVxuICAgICAgZWxzZSBjdXJyTm9uRXBvY2hCaW4ucHVzaChvcmRlcnNbaV0pXG4gICAgfVxuICAgIGJpbnMucHVzaChjdXJyTm9uRXBvY2hCaW4pXG4gICAgYmlucy5wdXNoKGN1cnJFcG9jaEJpbilcbiAgICByZXR1cm4gYmlucy5maWx0ZXIoYmluID0+IGJpbi5sZW5ndGggPiAwKVxuICB9XG5cbiAgLyogbG9hZFRhYmxlcyBsb2FkcyB0aGUgb3JkZXIgYm9vayBzaWRlIGludG8gaXRzIHRhYmxlLiAqL1xuICBsb2FkVGFibGVTaWRlIChzZWxsOiBib29sZWFuKSB7XG4gICAgY29uc3QgYm9va1NpZGUgPSBzZWxsID8gdGhpcy5ib29rLnNlbGxzIDogdGhpcy5ib29rLmJ1eXNcbiAgICBjb25zdCB0Ym9keSA9IHNlbGwgPyB0aGlzLnBhZ2Uuc2VsbFJvd3MgOiB0aGlzLnBhZ2UuYnV5Um93c1xuICAgIERvYy5lbXB0eSh0Ym9keSlcbiAgICBpZiAoIWJvb2tTaWRlIHx8ICFib29rU2lkZS5sZW5ndGgpIHJldHVyblxuICAgIGNvbnN0IG9yZGVyQmlucyA9IHRoaXMuYmluT3JkZXJzQnlSYXRlQW5kRXBvY2goYm9va1NpZGUpXG4gICAgb3JkZXJCaW5zLmZvckVhY2goYmluID0+IHsgdGJvZHkuYXBwZW5kQ2hpbGQodGhpcy5vcmRlclRhYmxlUm93KGJpbikpIH0pXG4gIH1cblxuICAvKiBhZGRUYWJsZU9yZGVyIGFkZHMgYSBzaW5nbGUgb3JkZXIgdG8gdGhlIGFwcHJvcHJpYXRlIHRhYmxlLiAqL1xuICBhZGRUYWJsZU9yZGVyIChvcmRlcjogTWluaU9yZGVyKSB7XG4gICAgY29uc3QgdGJvZHkgPSBvcmRlci5zZWxsID8gdGhpcy5wYWdlLnNlbGxSb3dzIDogdGhpcy5wYWdlLmJ1eVJvd3NcbiAgICBsZXQgcm93ID0gdGJvZHkuZmlyc3RDaGlsZCBhcyBPcmRlclJvd1xuICAgIC8vIEhhbmRsZSBtYXJrZXQgb3JkZXIgZGlmZmVyZW50bHkuXG4gICAgaWYgKG9yZGVyLnJhdGUgPT09IDApIHtcbiAgICAgIGlmIChvcmRlci5xdHlBdG9taWMgPT09IDApIHJldHVybiAvLyBhIGNhbmNlbCBvcmRlci4gVE9ETzogbWF5YmUgbWFrZSBhbiBpbmRpY2F0b3Igb24gdGhlIHRhcmdldCBvcmRlciwgbWF5YmUgZ3JheSBvdXRcbiAgICAgIC8vIFRoaXMgaXMgYSBtYXJrZXQgb3JkZXIuXG4gICAgICBpZiAocm93ICYmIHJvdy5tYW5hZ2VyLmdldFJhdGUoKSA9PT0gMCkge1xuICAgICAgICByb3cubWFuYWdlci5pbnNlcnRPcmRlcihvcmRlcilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJvdyA9IHRoaXMub3JkZXJUYWJsZVJvdyhbb3JkZXJdKVxuICAgICAgICB0Ym9keS5pbnNlcnRCZWZvcmUocm93LCB0Ym9keS5maXJzdENoaWxkKVxuICAgICAgfVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIE11c3QgYmUgYSBsaW1pdCBvcmRlci4gU29ydCBieSByYXRlLiBTa2lwIHRoZSBtYXJrZXQgb3JkZXIgcm93LlxuICAgIGlmIChyb3cgJiYgcm93Lm1hbmFnZXIuZ2V0UmF0ZSgpID09PSAwKSByb3cgPSByb3cubmV4dFNpYmxpbmcgYXMgT3JkZXJSb3dcbiAgICB3aGlsZSAocm93KSB7XG4gICAgICBpZiAocm93Lm1hbmFnZXIuY29tcGFyZShvcmRlcikgPT09IDApIHtcbiAgICAgICAgcm93Lm1hbmFnZXIuaW5zZXJ0T3JkZXIob3JkZXIpXG4gICAgICAgIHJldHVyblxuICAgICAgfSBlbHNlIGlmIChyb3cubWFuYWdlci5jb21wYXJlKG9yZGVyKSA+IDApIHtcbiAgICAgICAgY29uc3QgdHIgPSB0aGlzLm9yZGVyVGFibGVSb3coW29yZGVyXSlcbiAgICAgICAgdGJvZHkuaW5zZXJ0QmVmb3JlKHRyLCByb3cpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgcm93ID0gcm93Lm5leHRTaWJsaW5nIGFzIE9yZGVyUm93XG4gICAgfVxuICAgIGNvbnN0IHRyID0gdGhpcy5vcmRlclRhYmxlUm93KFtvcmRlcl0pXG4gICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpXG4gIH1cblxuICAvKiByZW1vdmVUYWJsZU9yZGVyIHJlbW92ZXMgYSBzaW5nbGUgb3JkZXIgZnJvbSBpdHMgdGFibGUuICovXG4gIHJlbW92ZVRhYmxlT3JkZXIgKG9yZGVyOiBNaW5pT3JkZXIpIHtcbiAgICBjb25zdCB0b2tlbiA9IG9yZGVyLnRva2VuXG4gICAgZm9yIChjb25zdCB0Ym9keSBvZiBbdGhpcy5wYWdlLnNlbGxSb3dzLCB0aGlzLnBhZ2UuYnV5Um93c10pIHtcbiAgICAgIGZvciAoY29uc3QgdHIgb2YgKEFycmF5LmZyb20odGJvZHkuY2hpbGRyZW4pIGFzIE9yZGVyUm93W10pKSB7XG4gICAgICAgIGlmICh0ci5tYW5hZ2VyLnJlbW92ZU9yZGVyKHRva2VuKSkge1xuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyogdXBkYXRlVGFibGVPcmRlciBsb29rcyBmb3IgdGhlIG9yZGVyIGluIHRoZSB0YWJsZSBhbmQgdXBkYXRlcyB0aGUgcXR5ICovXG4gIHVwZGF0ZVRhYmxlT3JkZXIgKHU6IFJlbWFpbmRlclVwZGF0ZSkge1xuICAgIGZvciAoY29uc3QgdGJvZHkgb2YgW3RoaXMucGFnZS5zZWxsUm93cywgdGhpcy5wYWdlLmJ1eVJvd3NdKSB7XG4gICAgICBmb3IgKGNvbnN0IHRyIG9mIChBcnJheS5mcm9tKHRib2R5LmNoaWxkcmVuKSBhcyBPcmRlclJvd1tdKSkge1xuICAgICAgICBpZiAodHIubWFuYWdlci51cGRhdGVPcmRlclF0eSh1KSkge1xuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogY2xlYXJPcmRlclRhYmxlRXBvY2hzIHJlbW92ZXMgaW1tZWRpYXRlLXRpZiBvcmRlcnMgd2hvc2UgZXBvY2ggaGFzIGV4cGlyZWQuXG4gICAqL1xuICBjbGVhck9yZGVyVGFibGVFcG9jaHMgKCkge1xuICAgIHRoaXMuY2xlYXJPcmRlclRhYmxlRXBvY2hTaWRlKHRoaXMucGFnZS5zZWxsUm93cylcbiAgICB0aGlzLmNsZWFyT3JkZXJUYWJsZUVwb2NoU2lkZSh0aGlzLnBhZ2UuYnV5Um93cylcbiAgfVxuXG4gIC8qXG4gICAqIGNsZWFyT3JkZXJUYWJsZUVwb2NocyByZW1vdmVzIGltbWVkaWF0ZS10aWYgb3JkZXJzIHdob3NlIGVwb2NoIGhhcyBleHBpcmVkXG4gICAqIGZvciBhIHNpbmdsZSBzaWRlLlxuICAgKi9cbiAgY2xlYXJPcmRlclRhYmxlRXBvY2hTaWRlICh0Ym9keTogSFRNTEVsZW1lbnQpIHtcbiAgICBmb3IgKGNvbnN0IHRyIG9mIChBcnJheS5mcm9tKHRib2R5LmNoaWxkcmVuKSkgYXMgT3JkZXJSb3dbXSkge1xuICAgICAgdHIubWFuYWdlci5yZW1vdmVFcG9jaE9yZGVycygpXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogb3JkZXJUYWJsZVJvdyBjcmVhdGVzIGEgbmV3IDx0cj4gZWxlbWVudCB0byBpbnNlcnQgaW50byBhbiBvcmRlciB0YWJsZS5cbiAgICAgVGFrZXMgYSBiaW4gb2Ygb3JkZXJzIHdpdGggdGhlIHNhbWUgcmF0ZSwgYW5kIGRpc3BsYXlzIHRoZSB0b3RhbCBxdWFudGl0eS5cbiAgICovXG4gIG9yZGVyVGFibGVSb3cgKG9yZGVyQmluOiBNaW5pT3JkZXJbXSk6IE9yZGVyUm93IHtcbiAgICBjb25zdCB0ciA9IHRoaXMucGFnZS5vcmRlclJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIE9yZGVyUm93XG4gICAgY29uc3QgeyBiYXNlVW5pdEluZm8sIHF1b3RlVW5pdEluZm8sIHJhdGVDb252ZXJzaW9uRmFjdG9yLCBjZmc6IHsgcmF0ZXN0ZXA6IHJhdGVTdGVwIH0gfSA9IHRoaXMubWFya2V0XG4gICAgY29uc3QgbWFuYWdlciA9IG5ldyBPcmRlclRhYmxlUm93TWFuYWdlcih0ciwgb3JkZXJCaW4sIGJhc2VVbml0SW5mbywgcXVvdGVVbml0SW5mbywgcmF0ZVN0ZXApXG4gICAgdHIubWFuYWdlciA9IG1hbmFnZXJcbiAgICBiaW5kKHRyLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnJlcG9ydERlcHRoQ2xpY2sodHIubWFuYWdlci5nZXRSYXRlKCkgLyByYXRlQ29udmVyc2lvbkZhY3RvcilcbiAgICB9KVxuICAgIGlmICh0ci5tYW5hZ2VyLmdldFJhdGUoKSAhPT0gMCkge1xuICAgICAgRG9jLmJpbmQodHIsICdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBjaGFydCA9IHRoaXMuZGVwdGhDaGFydFxuICAgICAgICB0aGlzLmRlcHRoTGluZXMuaG92ZXIgPSBbe1xuICAgICAgICAgIHJhdGU6IHRyLm1hbmFnZXIuZ2V0UmF0ZSgpIC8gcmF0ZUNvbnZlcnNpb25GYWN0b3IsXG4gICAgICAgICAgY29sb3I6IHRyLm1hbmFnZXIuaXNTZWxsKCkgPyBjaGFydC50aGVtZS5zZWxsTGluZSA6IGNoYXJ0LnRoZW1lLmJ1eUxpbmVcbiAgICAgICAgfV1cbiAgICAgICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgICB9KVxuICAgIH1cbiAgICByZXR1cm4gdHJcbiAgfVxuXG4gIC8qIGhhbmRsZUNvbm5Ob3RlIGhhbmRsZXMgdGhlICdjb25uJyBub3RpZmljYXRpb24uXG4gICAqL1xuICBhc3luYyBoYW5kbGVDb25uTm90ZSAobm90ZTogQ29ubkV2ZW50Tm90ZSkge1xuICAgIHRoaXMubWFya2V0TGlzdC5zZXRDb25uZWN0aW9uU3RhdHVzKG5vdGUpXG4gICAgaWYgKG5vdGUuY29ubmVjdGlvblN0YXR1cyA9PT0gQ29ubmVjdGlvblN0YXR1cy5Db25uZWN0ZWQpIHtcbiAgICAgIC8vIEhhdmluZyBiZWVuIGRpc2Nvbm5lY3RlZCBmcm9tIGEgREVYIHNlcnZlciwgYW55dGhpbmcgbWF5IGhhdmUgY2hhbmdlZCxcbiAgICAgIC8vIG9yIHRoaXMgbWF5IGJlIHRoZSBmaXJzdCBvcHBvcnR1bml0eSB0byBnZXQgdGhlIHNlcnZlcidzIGNvbmZpZywgc29cbiAgICAgIC8vIGZldGNoIGl0IGFsbCBiZWZvcmUgcmVsb2FkaW5nIHRoZSBtYXJrZXRzIHBhZ2UuXG4gICAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgICAgYXdhaXQgYXBwKCkubG9hZFBhZ2UoJ21hcmtldHMnKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGZpbHRlck1hcmtldHMgc2V0cyB0aGUgZGlzcGxheSBvZiBtYXJrZXRzIGluIHRoZSBtYXJrZXRzIGxpc3QgYmFzZWQgb24gdGhlXG4gICAqIHZhbHVlIG9mIHRoZSBzZWFyY2ggaW5wdXQuXG4gICAqL1xuICBmaWx0ZXJNYXJrZXRzICgpIHtcbiAgICBjb25zdCBmaWx0ZXJUeHQgPSB0aGlzLnBhZ2UubWFya2V0U2VhcmNoVjEudmFsdWU/LnRvTG93ZXJDYXNlKClcbiAgICBjb25zdCBmaWx0ZXIgPSBmaWx0ZXJUeHQgPyAobWt0OiBNYXJrZXRSb3cpID0+IG1rdC5uYW1lLmluY2x1ZGVzKGZpbHRlclR4dCkgOiAoKSA9PiB0cnVlXG4gICAgdGhpcy5tYXJrZXRMaXN0LnNldEZpbHRlcihmaWx0ZXIpXG4gIH1cblxuICAvKiBkcmF3Q2hhcnRMaW5lcyBkcmF3cyB0aGUgaG92ZXIgYW5kIGlucHV0IGxpbmVzIG9uIHRoZSBjaGFydC4gKi9cbiAgZHJhd0NoYXJ0TGluZXMgKCkge1xuICAgIHRoaXMuZGVwdGhDaGFydC5zZXRMaW5lcyhbLi4udGhpcy5kZXB0aExpbmVzLmhvdmVyLCAuLi50aGlzLmRlcHRoTGluZXMuaW5wdXRdKVxuICAgIHRoaXMuZGVwdGhDaGFydC5kcmF3KClcbiAgfVxuXG4gIC8qIGNhbmRsZUR1cmF0aW9uU2VsZWN0ZWQgc2V0cyB0aGUgY2FuZGxlRHVyIGFuZCBsb2FkcyB0aGUgY2FuZGxlcy4gSXQgd2lsbFxuICBkZWZhdWx0IHRvIHRoZSBvbmVIckJpbktleSBpZiBkdXIgaXMgbm90IHZhbGlkLiAqL1xuICBjYW5kbGVEdXJhdGlvblNlbGVjdGVkIChkdXI6IHN0cmluZykge1xuICAgIGlmICghdGhpcy5tYXJrZXQ/LmRleD8uY2FuZGxlRHVycy5pbmNsdWRlcyhkdXIpKSBkdXIgPSBvbmVIckJpbktleVxuICAgIHRoaXMuY2FuZGxlRHVyID0gZHVyXG4gICAgdGhpcy5sb2FkQ2FuZGxlcygpXG4gICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5sYXN0Q2FuZGxlRHVyYXRpb25MSywgZHVyKVxuICB9XG5cbiAgLypcbiAgICogbG9hZENhbmRsZXMgbG9hZHMgdGhlIGNhbmRsZXMgZm9yIHRoZSBjdXJyZW50IGNhbmRsZUR1ci4gSWYgYSBjYWNoZSBpcyBhbHJlYWR5XG4gICAqIGFjdGl2ZSwgdGhlIGNhY2hlIHdpbGwgYmUgdXNlZCB3aXRob3V0IGEgbG9hZGNhbmRsZXMgcmVxdWVzdC5cbiAgICovXG4gIGxvYWRDYW5kbGVzICgpIHtcbiAgICBmb3IgKGNvbnN0IGJ0dG4gb2YgRG9jLmtpZHModGhpcy5wYWdlLmR1ckJ0dG5Cb3gpKSB7XG4gICAgICBpZiAoYnR0bi50ZXh0Q29udGVudCA9PT0gdGhpcy5jYW5kbGVEdXIpIGJ0dG4uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuICAgICAgZWxzZSBidHRuLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICB9XG4gICAgY29uc3QgeyBjYW5kbGVDYWNoZXMsIGNmZywgYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvIH0gPSB0aGlzLm1hcmtldFxuICAgIGNvbnN0IGNhY2hlID0gY2FuZGxlQ2FjaGVzW3RoaXMuY2FuZGxlRHVyXVxuICAgIGlmIChjYWNoZSkge1xuICAgICAgLy8gdGhpcy5kZXB0aENoYXJ0LmhpZGUoKVxuICAgICAgLy8gdGhpcy5jYW5kbGVDaGFydC5zaG93KClcbiAgICAgIHRoaXMuY2FuZGxlQ2hhcnQuc2V0Q2FuZGxlcyhjYWNoZSwgY2ZnLCBiYXNlVW5pdEluZm8sIHF1b3RlVW5pdEluZm8pXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5yZXF1ZXN0Q2FuZGxlcygpXG4gIH1cblxuICAvKiByZXF1ZXN0Q2FuZGxlcyBzZW5kcyB0aGUgbG9hZGNhbmRsZXMgcmVxdWVzdC4gSXQgYWNjZXB0cyBhbiBvcHRpb25hbCBjYW5kbGVcbiAgICogZHVyYXRpb24gd2hpY2ggd2lsbCBiZSByZXF1ZXN0ZWQgaWYgaXQgaXMgcHJvdmlkZWQuXG4gICAqL1xuICByZXF1ZXN0Q2FuZGxlcyAoY2FuZGxlRHVyPzogc3RyaW5nKSB7XG4gICAgdGhpcy5jYW5kbGVzTG9hZGluZyA9IHtcbiAgICAgIGxvYWRlZDogKCkgPT4geyAvKiBwYXNzICovIH0sXG4gICAgICB0aW1lcjogd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5jYW5kbGVzTG9hZGluZykge1xuICAgICAgICAgIHRoaXMuY2FuZGxlc0xvYWRpbmcgPSBudWxsXG4gICAgICAgICAgY29uc29sZS5lcnJvcignY2FuZGxlcyBub3QgcmVjZWl2ZWQnKVxuICAgICAgICB9XG4gICAgICB9LCAxMDAwMClcbiAgICB9XG4gICAgY29uc3QgeyBkZXgsIGJhc2VDZmcsIHF1b3RlQ2ZnIH0gPSB0aGlzLm1hcmtldFxuICAgIHdzLnJlcXVlc3QoJ2xvYWRjYW5kbGVzJywgeyBob3N0OiBkZXguaG9zdCwgYmFzZTogYmFzZUNmZy5pZCwgcXVvdGU6IHF1b3RlQ2ZnLmlkLCBkdXI6IGNhbmRsZUR1ciB8fCB0aGlzLmNhbmRsZUR1ciB9KVxuICB9XG5cbiAgLypcbiAgICogdW5sb2FkIGlzIGNhbGxlZCBieSB0aGUgQXBwbGljYXRpb24gd2hlbiB0aGUgdXNlciBuYXZpZ2F0ZXMgYXdheSBmcm9tXG4gICAqIHRoZSAvbWFya2V0cyBwYWdlLlxuICAgKi9cbiAgdW5sb2FkICgpIHtcbiAgICB3cy5yZXF1ZXN0KHVubWFya2V0Um91dGUsIHt9KVxuICAgIHdzLmRlcmVnaXN0ZXJSb3V0ZShib29rUm91dGUpXG4gICAgd3MuZGVyZWdpc3RlclJvdXRlKGJvb2tPcmRlclJvdXRlKVxuICAgIHdzLmRlcmVnaXN0ZXJSb3V0ZSh1bmJvb2tPcmRlclJvdXRlKVxuICAgIHdzLmRlcmVnaXN0ZXJSb3V0ZSh1cGRhdGVSZW1haW5pbmdSb3V0ZSlcbiAgICB3cy5kZXJlZ2lzdGVyUm91dGUoZXBvY2hPcmRlclJvdXRlKVxuICAgIHdzLmRlcmVnaXN0ZXJSb3V0ZShjYW5kbGVzUm91dGUpXG4gICAgd3MuZGVyZWdpc3RlclJvdXRlKGNhbmRsZVVwZGF0ZVJvdXRlKVxuICAgIHRoaXMuZGVwdGhDaGFydC51bmF0dGFjaCgpXG4gICAgdGhpcy5jYW5kbGVDaGFydC51bmF0dGFjaCgpXG4gICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5rZXl1cClcbiAgICBjbGVhckludGVydmFsKHRoaXMuc2Vjb25kVGlja2VyKVxuICB9XG59XG5cbi8qXG4gKiAgTWFya2V0TGlzdCByZXByZXNlbnRzIHRoZSBsaXN0IG9mIGV4Y2hhbmdlcyBhbmQgbWFya2V0cyBvbiB0aGUgbGVmdCBzaWRlIG9mXG4gKiBtYXJrZXRzIHZpZXcuIFRoZSBNYXJrZXRMaXN0IHByb3ZpZGVzIHV0aWxpdGllcyBmb3IgYWRqdXN0aW5nIHRoZSB2aXNpYmlsaXR5XG4gKiBhbmQgc29ydCBvcmRlciBvZiBtYXJrZXRzLlxuICovXG5jbGFzcyBNYXJrZXRMaXN0IHtcbiAgLy8geGNTZWN0aW9uczogRXhjaGFuZ2VTZWN0aW9uW11cbiAgZGl2OiBQYWdlRWxlbWVudFxuICByb3dUbXBsOiBQYWdlRWxlbWVudFxuICBtYXJrZXRzOiBNYXJrZXRSb3dbXVxuICBzZWxlY3RlZDogTWFya2V0Um93XG5cbiAgY29uc3RydWN0b3IgKGRpdjogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmRpdiA9IGRpdlxuICAgIHRoaXMucm93VG1wbCA9IERvYy5pZGVsKGRpdiwgJ21hcmtldFRtcGxWMScpXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHRoaXMucm93VG1wbClcbiAgICB0aGlzLnJlbG9hZE1hcmtldHNQYW5lKClcbiAgfVxuXG4gIHVwZGF0ZVNwb3RzIChub3RlOiBTcG90UHJpY2VOb3RlKSB7XG4gICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5tYXJrZXRzKSB7XG4gICAgICBpZiAocm93Lm1rdC54Yy5ob3N0ICE9PSBub3RlLmhvc3QpIGNvbnRpbnVlXG4gICAgICBjb25zdCB4YyA9IGFwcCgpLmV4Y2hhbmdlc1tyb3cubWt0LnhjLmhvc3RdXG4gICAgICBjb25zdCBta3QgPSB4Yy5tYXJrZXRzW3Jvdy5ta3QubmFtZV1cbiAgICAgIHNldFByaWNlQW5kQ2hhbmdlKHJvdy50bXBsLCB4YywgbWt0KVxuICAgIH1cbiAgfVxuXG4gIHJlbG9hZE1hcmtldHNQYW5lICgpOiB2b2lkIHtcbiAgICBEb2MuZW1wdHkodGhpcy5kaXYpXG4gICAgdGhpcy5tYXJrZXRzID0gW11cblxuICAgIGNvbnN0IGFkZE1hcmtldCA9IChta3Q6IEV4Y2hhbmdlTWFya2V0KSA9PiB7XG4gICAgICBjb25zdCBidWkgPSBhcHAoKS51bml0SW5mbyhta3QuYmFzZWlkLCBta3QueGMpXG4gICAgICBjb25zdCBxdWkgPSBhcHAoKS51bml0SW5mbyhta3QucXVvdGVpZCwgbWt0LnhjKVxuICAgICAgY29uc3QgcmF0ZUNvbnZlcnNpb25GYWN0b3IgPSBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yIC8gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yICogcXVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgICBjb25zdCByb3cgPSBuZXcgTWFya2V0Um93KHRoaXMucm93VG1wbCwgbWt0LCByYXRlQ29udmVyc2lvbkZhY3RvcilcbiAgICAgIHRoaXMuZGl2LmFwcGVuZENoaWxkKHJvdy5ub2RlKVxuICAgICAgcmV0dXJuIHJvd1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgbWt0IG9mIHNvcnRlZE1hcmtldHMoKSkgdGhpcy5tYXJrZXRzLnB1c2goYWRkTWFya2V0KG1rdCkpXG4gICAgYXBwKCkuYmluZFRvb2x0aXBzKHRoaXMuZGl2KVxuICB9XG5cbiAgZmluZCAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKTogTWFya2V0Um93IHwgbnVsbCB7XG4gICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5tYXJrZXRzKSB7XG4gICAgICBpZiAocm93Lm1rdC54Yy5ob3N0ID09PSBob3N0ICYmIHJvdy5ta3QuYmFzZWlkID09PSBiYXNlSUQgJiYgcm93Lm1rdC5xdW90ZWlkID09PSBxdW90ZUlEKSByZXR1cm4gcm93XG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKiBleGlzdHMgd2lsbCBiZSB0cnVlIGlmIHRoZSBzcGVjaWZpZWQgbWFya2V0IGV4aXN0cy4gKi9cbiAgZXhpc3RzIChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKGhvc3QsIGJhc2VJRCwgcXVvdGVJRCkgIT09IG51bGxcbiAgfVxuXG4gIC8qIGZpcnN0IGdldHMgdGhlIGZpcnN0IG1hcmtldCBmcm9tIHRoZSBmaXJzdCBleGNoYW5nZSwgYWxwaGFiZXRpY2FsbHkuICovXG4gIGZpcnN0ICgpOiBNYXJrZXRSb3cge1xuICAgIHJldHVybiB0aGlzLm1hcmtldHNbMF1cbiAgfVxuXG4gIC8qIHNlbGVjdCBzZXRzIHRoZSBzcGVjaWZpZWQgbWFya2V0IGFzIHNlbGVjdGVkLiAqL1xuICBzZWxlY3QgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHJvdyA9IHRoaXMuZmluZChob3N0LCBiYXNlSUQsIHF1b3RlSUQpXG4gICAgaWYgKCFyb3cpIHJldHVybiBjb25zb2xlLmVycm9yKGBzZWxlY3Q6IG5vIG1hcmtldCByb3cgZm9yICR7aG9zdH0sICR7YmFzZUlEfS0ke3F1b3RlSUR9YClcbiAgICBmb3IgKGNvbnN0IG1rdCBvZiB0aGlzLm1hcmtldHMpIG1rdC5ub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICB0aGlzLnNlbGVjdGVkID0gcm93XG4gICAgdGhpcy5zZWxlY3RlZC5ub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgfVxuXG4gIC8qIHNldENvbm5lY3Rpb25TdGF0dXMgc2V0cyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgZGlzY29ubmVjdGVkIGljb24gYmFzZWRcbiAgICogb24gdGhlIGNvcmUuQ29ubkV2ZW50Tm90ZS5cbiAgICovXG4gIHNldENvbm5lY3Rpb25TdGF0dXMgKG5vdGU6IENvbm5FdmVudE5vdGUpIHtcbiAgICBmb3IgKGNvbnN0IHJvdyBvZiB0aGlzLm1hcmtldHMpIHtcbiAgICAgIGlmIChyb3cubWt0LnhjLmhvc3QgIT09IG5vdGUuaG9zdCkgY29udGludWVcbiAgICAgIGlmIChub3RlLmNvbm5lY3Rpb25TdGF0dXMgPT09IENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGVkKSBEb2MuaGlkZShyb3cudG1wbC5kaXNjb25uZWN0ZWRJY28pXG4gICAgICBlbHNlIERvYy5zaG93KHJvdy50bXBsLmRpc2Nvbm5lY3RlZEljbylcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBzZXRGaWx0ZXIgc2V0cyB0aGUgdmlzaWJpbGl0eSBvZiBtYXJrZXQgcm93cyBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgZmlsdGVyLlxuICAgKi9cbiAgc2V0RmlsdGVyIChmaWx0ZXI6IChta3Q6IE1hcmtldFJvdykgPT4gYm9vbGVhbikge1xuICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMubWFya2V0cykge1xuICAgICAgaWYgKGZpbHRlcihyb3cpKSBEb2Muc2hvdyhyb3cubm9kZSlcbiAgICAgIGVsc2UgRG9jLmhpZGUocm93Lm5vZGUpXG4gICAgfVxuICB9XG59XG5cbi8qXG4gKiBNYXJrZXRSb3cgcmVwcmVzZW50cyBvbmUgcm93IGluIHRoZSBNYXJrZXRMaXN0LiBBIE1hcmtldFJvdyBpcyBhIHN1YnNlY3Rpb25cbiAqIG9mIHRoZSBFeGNoYW5nZVNlY3Rpb24uXG4gKi9cbmNsYXNzIE1hcmtldFJvdyB7XG4gIG5vZGU6IEhUTUxFbGVtZW50XG4gIG1rdDogRXhjaGFuZ2VNYXJrZXRcbiAgbmFtZTogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICBsb3RTaXplOiBudW1iZXJcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIHJhdGVDb252ZXJzaW9uRmFjdG9yOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAodGVtcGxhdGU6IEhUTUxFbGVtZW50LCBta3Q6IEV4Y2hhbmdlTWFya2V0LCByYXRlQ29udmVyc2lvbkZhY3RvcjogbnVtYmVyKSB7XG4gICAgdGhpcy5ta3QgPSBta3RcbiAgICB0aGlzLm5hbWUgPSBta3QubmFtZVxuICAgIHRoaXMuYmFzZUlEID0gbWt0LmJhc2VpZFxuICAgIHRoaXMucXVvdGVJRCA9IG1rdC5xdW90ZWlkXG4gICAgdGhpcy5sb3RTaXplID0gbWt0LmxvdHNpemVcbiAgICB0aGlzLnJhdGVDb252ZXJzaW9uRmFjdG9yID0gcmF0ZUNvbnZlcnNpb25GYWN0b3JcbiAgICB0aGlzLm5vZGUgPSB0ZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gdGhpcy50bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodGhpcy5ub2RlKVxuICAgIHRtcGwuYmFzZUljb24uc3JjID0gRG9jLmxvZ29QYXRoKG1rdC5iYXNlc3ltYm9sKVxuICAgIHRtcGwucXVvdGVJY29uLnNyYyA9IERvYy5sb2dvUGF0aChta3QucXVvdGVzeW1ib2wpXG4gICAgdG1wbC5iYXNlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUobWt0LnhjLmFzc2V0c1tta3QuYmFzZWlkXSwgdHJ1ZSkpXG4gICAgdG1wbC5xdW90ZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKG1rdC54Yy5hc3NldHNbbWt0LnF1b3RlaWRdLCB0cnVlKSlcbiAgICB0bXBsLmJhc2VOYW1lLnRleHRDb250ZW50ID0gbWt0LmJhc2VOYW1lXG4gICAgdG1wbC5ob3N0LnRleHRDb250ZW50ID0gbWt0LnhjLmhvc3RcbiAgICB0bXBsLmhvc3Quc3R5bGUuY29sb3IgPSBob3N0Q29sb3IobWt0LnhjLmhvc3QpXG4gICAgdG1wbC5ob3N0LmRhdGFzZXQudG9vbHRpcCA9IG1rdC54Yy5ob3N0XG4gICAgc2V0UHJpY2VBbmRDaGFuZ2UodG1wbCwgbWt0LnhjLCBta3QpXG4gICAgaWYgKHRoaXMubWt0LnhjLmNvbm5lY3Rpb25TdGF0dXMgIT09IENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGVkKSBEb2Muc2hvdyh0bXBsLmRpc2Nvbm5lY3RlZEljbylcbiAgfVxufVxuXG5pbnRlcmZhY2UgQmFsYW5jZVdpZGdldEVsZW1lbnQge1xuICBpZDogbnVtYmVyXG4gIHBhcmVudElEOiBudW1iZXJcbiAgY2ZnOiBBc3NldCB8IG51bGxcbiAgbm9kZTogUGFnZUVsZW1lbnRcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGljb25Cb3g6IFBhZ2VFbGVtZW50XG4gIHN0YXRlSWNvbnM6IFdhbGxldEljb25zXG4gIHBhcmVudEJhbD86IFBhZ2VFbGVtZW50XG59XG5cbi8qXG4gKiBCYWxhbmNlV2lkZ2V0IGlzIGEgZGlzcGxheSBvZiBiYWxhbmNlIGluZm9ybWF0aW9uLiBCZWNhdXNlIHRoZSB3YWxsZXQgY2FuIGJlXG4gKiBpbiBhbnkgbnVtYmVyIG9mIHN0YXRlcywgYW5kIGJlY2F1c2UgZXZlcnkgZXhjaGFuZ2UgaGFzIGRpZmZlcmVudCBmdW5kaW5nXG4gKiBjb2luIGNvbmZpcm1hdGlvbiByZXF1aXJlbWVudHMsIHRoZSBCYWxhbmNlV2lkZ2V0IGRpc3BsYXlzIGEgbnVtYmVyIG9mIHN0YXRlXG4gKiBpbmRpY2F0b3JzIGFuZCBidXR0b25zLCBhcyB3ZWxsIGFzIHRhYnVsYXRlZCBiYWxhbmNlIGRhdGEgd2l0aCByb3dzIGZvclxuICogbG9ja2VkIGFuZCBpbW1hdHVyZSBiYWxhbmNlLlxuICovXG5jbGFzcyBCYWxhbmNlV2lkZ2V0IHtcbiAgYmFzZTogQmFsYW5jZVdpZGdldEVsZW1lbnRcbiAgcXVvdGU6IEJhbGFuY2VXaWRnZXRFbGVtZW50XG4gIC8vIHBhcmVudFJvdzogUGFnZUVsZW1lbnRcbiAgZGV4OiBFeGNoYW5nZVxuXG4gIGNvbnN0cnVjdG9yIChiYXNlOiBIVE1MRWxlbWVudCwgcXVvdGU6IEhUTUxFbGVtZW50KSB7XG4gICAgRG9jLmhpZGUoYmFzZSwgcXVvdGUpXG4gICAgY29uc3QgYnRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShiYXNlKVxuICAgIHRoaXMuYmFzZSA9IHtcbiAgICAgIGlkOiAwLFxuICAgICAgcGFyZW50SUQ6IHBhcmVudElETm9uZSxcbiAgICAgIGNmZzogbnVsbCxcbiAgICAgIG5vZGU6IGJhc2UsXG4gICAgICB0bXBsOiBidG1wbCxcbiAgICAgIGljb25Cb3g6IGJ0bXBsLndhbGxldFN0YXRlLFxuICAgICAgc3RhdGVJY29uczogbmV3IFdhbGxldEljb25zKGJ0bXBsLndhbGxldFN0YXRlKVxuICAgIH1cbiAgICBidG1wbC5iYWxhbmNlUm93VG1wbC5yZW1vdmUoKVxuXG4gICAgY29uc3QgcXRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShxdW90ZSlcbiAgICB0aGlzLnF1b3RlID0ge1xuICAgICAgaWQ6IDAsXG4gICAgICBwYXJlbnRJRDogcGFyZW50SUROb25lLFxuICAgICAgY2ZnOiBudWxsLFxuICAgICAgbm9kZTogcXVvdGUsXG4gICAgICB0bXBsOiBxdG1wbCxcbiAgICAgIGljb25Cb3g6IHF0bXBsLndhbGxldFN0YXRlLFxuICAgICAgc3RhdGVJY29uczogbmV3IFdhbGxldEljb25zKHF0bXBsLndhbGxldFN0YXRlKVxuICAgIH1cbiAgICBxdG1wbC5iYWxhbmNlUm93VG1wbC5yZW1vdmUoKVxuXG4gICAgYXBwKCkucmVnaXN0ZXJOb3RlRmVlZGVyKHtcbiAgICAgIGJhbGFuY2U6IChub3RlOiBCYWxhbmNlTm90ZSkgPT4geyB0aGlzLnVwZGF0ZUFzc2V0KG5vdGUuYXNzZXRJRCkgfSxcbiAgICAgIHdhbGxldHN0YXRlOiAobm90ZTogV2FsbGV0U3RhdGVOb3RlKSA9PiB7IHRoaXMudXBkYXRlQXNzZXQobm90ZS53YWxsZXQuYXNzZXRJRCkgfSxcbiAgICAgIHdhbGxldHN5bmM6IChub3RlOiBXYWxsZXRTeW5jTm90ZSkgPT4geyB0aGlzLnVwZGF0ZUFzc2V0KG5vdGUuYXNzZXRJRCkgfSxcbiAgICAgIGNyZWF0ZXdhbGxldDogKG5vdGU6IFdhbGxldENyZWF0aW9uTm90ZSkgPT4geyB0aGlzLnVwZGF0ZUFzc2V0KG5vdGUuYXNzZXRJRCkgfVxuICAgIH0pXG4gIH1cblxuICBzZXRCYWxhbmNlVmlzaWJpbGl0eSAoY29ubmVjdGVkOiBib29sZWFuKSB7XG4gICAgaWYgKGNvbm5lY3RlZCkgRG9jLnNob3codGhpcy5iYXNlLm5vZGUsIHRoaXMucXVvdGUubm9kZSlcbiAgICBlbHNlIERvYy5oaWRlKHRoaXMuYmFzZS5ub2RlLCB0aGlzLnF1b3RlLm5vZGUpXG4gIH1cblxuICAvKlxuICAgKiBzZXRXYWxsZXQgc2V0cyB0aGUgYmFsYW5jZSB3aWRnZXQgdG8gZGlzcGxheSBkYXRhIGZvciBzcGVjaWZpZWQgbWFya2V0IGFuZFxuICAgKiB3aWxsIGRpc3BsYXkgdGhlIHdpZGdldC5cbiAgICovXG4gIHNldFdhbGxldHMgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHBhcmVudElEID0gKGFzc2V0SUQ6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICAgIGlmIChhc3NldD8udG9rZW4pIHJldHVybiBhc3NldC50b2tlbi5wYXJlbnRJRFxuICAgICAgcmV0dXJuIHBhcmVudElETm9uZVxuICAgIH1cbiAgICB0aGlzLmRleCA9IGFwcCgpLnVzZXIuZXhjaGFuZ2VzW2hvc3RdXG4gICAgdGhpcy5iYXNlLmlkID0gYmFzZUlEXG4gICAgdGhpcy5iYXNlLnBhcmVudElEID0gcGFyZW50SUQoYmFzZUlEKVxuICAgIHRoaXMuYmFzZS5jZmcgPSB0aGlzLmRleC5hc3NldHNbYmFzZUlEXVxuICAgIHRoaXMucXVvdGUuaWQgPSBxdW90ZUlEXG4gICAgdGhpcy5xdW90ZS5wYXJlbnRJRCA9IHBhcmVudElEKHF1b3RlSUQpXG4gICAgdGhpcy5xdW90ZS5jZmcgPSB0aGlzLmRleC5hc3NldHNbcXVvdGVJRF1cbiAgICB0aGlzLnVwZGF0ZVdhbGxldCh0aGlzLmJhc2UpXG4gICAgdGhpcy51cGRhdGVXYWxsZXQodGhpcy5xdW90ZSlcbiAgICB0aGlzLnNldEJhbGFuY2VWaXNpYmlsaXR5KHRoaXMuZGV4LmNvbm5lY3Rpb25TdGF0dXMgPT09IENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGVkKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlV2FsbGV0IHVwZGF0ZXMgdGhlIGRpc3BsYXllZCB3YWxsZXQgaW5mb3JtYXRpb24gYmFzZWQgb24gdGhlXG4gICAqIGNvcmUuV2FsbGV0IHN0YXRlLlxuICAgKi9cbiAgdXBkYXRlV2FsbGV0IChzaWRlOiBCYWxhbmNlV2lkZ2V0RWxlbWVudCkge1xuICAgIGNvbnN0IHsgY2ZnLCB0bXBsLCBpY29uQm94LCBzdGF0ZUljb25zLCBpZDogYXNzZXRJRCB9ID0gc2lkZVxuICAgIGlmICghY2ZnKSByZXR1cm4gLy8gbm8gd2FsbGV0IHNldCB5ZXRcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIC8vIEp1c3QgaGlkZSBldmVyeXRoaW5nIHRvIHN0YXJ0LlxuICAgIERvYy5oaWRlKFxuICAgICAgdG1wbC5uZXdXYWxsZXRSb3csIHRtcGwuZXhwaXJlZCwgdG1wbC51bnN1cHBvcnRlZCwgdG1wbC5jb25uZWN0LCB0bXBsLnNwaW5uZXIsXG4gICAgICB0bXBsLndhbGxldFN0YXRlLCB0bXBsLmJhbGFuY2VSb3dzLCB0bXBsLndhbGxldEFkZHIsIHRtcGwud2FudFByb3ZpZGVyc0JveFxuICAgIClcbiAgICB0aGlzLmNoZWNrTmVlZHNQcm92aWRlcihhc3NldElELCB0bXBsLndhbnRQcm92aWRlcnNCb3gpXG4gICAgdG1wbC5sb2dvLnNyYyA9IERvYy5sb2dvUGF0aChjZmcuc3ltYm9sKVxuICAgIHRtcGwuYWRkV2FsbGV0U3ltYm9sLnRleHRDb250ZW50ID0gY2ZnLnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgRG9jLmVtcHR5KHRtcGwuc3ltYm9sKVxuXG4gICAgLy8gSGFuZGxlIGFuIHVuc3VwcG9ydGVkIGFzc2V0LlxuICAgIGlmICghYXNzZXQpIHtcbiAgICAgIERvYy5zaG93KHRtcGwudW5zdXBwb3J0ZWQpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdG1wbC5zeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShhc3NldCwgdHJ1ZSkpXG4gICAgRG9jLnNob3coaWNvbkJveClcbiAgICBjb25zdCB3YWxsZXQgPSBhc3NldC53YWxsZXRcbiAgICBzdGF0ZUljb25zLnJlYWRXYWxsZXQod2FsbGV0KVxuICAgIC8vIEhhbmRsZSBubyB3YWxsZXQgY29uZmlndXJlZC5cbiAgICBpZiAoIXdhbGxldCkge1xuICAgICAgaWYgKGFzc2V0LndhbGxldENyZWF0aW9uUGVuZGluZykge1xuICAgICAgICBEb2Muc2hvdyh0bXBsLnNwaW5uZXIpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgRG9jLnNob3codG1wbC5uZXdXYWxsZXRSb3cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLnNob3codG1wbC53YWxsZXRBZGRyKVxuICAgIC8vIFBhcmVudCBhc3NldFxuICAgIGNvbnN0IGJhbCA9IHdhbGxldC5iYWxhbmNlXG4gICAgLy8gSGFuZGxlIG5vdCBjb25uZWN0ZWQgYW5kIG5vIGJhbGFuY2Uga25vd24gZm9yIHRoZSBERVguXG4gICAgaWYgKCFiYWwgJiYgIXdhbGxldC5ydW5uaW5nICYmICF3YWxsZXQuZGlzYWJsZWQpIHtcbiAgICAgIERvYy5zaG93KHRtcGwuY29ubmVjdClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyBJZiB0aGVyZSBpcyBubyBiYWxhbmNlLCBidXQgdGhlIHdhbGxldCBpcyBjb25uZWN0ZWQsIHNob3cgdGhlIGxvYWRpbmdcbiAgICAvLyBpY29uIHdoaWxlIHdlIGZldGNoIGFuIHVwZGF0ZS5cbiAgICBpZiAoIWJhbCkge1xuICAgICAgYXBwKCkuZmV0Y2hCYWxhbmNlKGFzc2V0SUQpXG4gICAgICBEb2Muc2hvdyh0bXBsLnNwaW5uZXIpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBXZSBoYXZlIGEgd2FsbGV0IGFuZCBhIERFWC1zcGVjaWZpYyBiYWxhbmNlLiBTZXQgYWxsIG9mIHRoZSBmaWVsZHMuXG4gICAgRG9jLnNob3codG1wbC5iYWxhbmNlUm93cylcbiAgICBEb2MuZW1wdHkodG1wbC5iYWxhbmNlUm93cylcbiAgICBjb25zdCBhZGRSb3cgPSAodGl0bGU6IHN0cmluZywgYmFsOiBudW1iZXIsIHVpOiBVbml0SW5mbywgaWNvbj86IFBhZ2VFbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCByb3cgPSB0bXBsLmJhbGFuY2VSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgdG1wbC5iYWxhbmNlUm93cy5hcHBlbmRDaGlsZChyb3cpXG4gICAgICBjb25zdCBiYWxUbXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgYmFsVG1wbC50aXRsZS50ZXh0Q29udGVudCA9IHRpdGxlXG4gICAgICBiYWxUbXBsLmJhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYmFsLCB1aSlcbiAgICAgIGlmIChpY29uKSB7XG4gICAgICAgIGJhbFRtcGwuYmFsLmFwcGVuZChpY29uKVxuICAgICAgICBzaWRlLnBhcmVudEJhbCA9IGJhbFRtcGwuYmFsXG4gICAgICB9XG4gICAgfVxuICAgIGFkZFJvdyhpbnRsLnByZXAoaW50bC5JRF9BVkFJTEFCTEUpLCBiYWwuYXZhaWxhYmxlLCBhc3NldC51bml0SW5mbylcbiAgICBhZGRSb3coaW50bC5wcmVwKGludGwuSURfTE9DS0VEKSwgYmFsLmxvY2tlZCArIGJhbC5jb250cmFjdGxvY2tlZCArIGJhbC5ib25kbG9ja2VkLCBhc3NldC51bml0SW5mbylcbiAgICBhZGRSb3coaW50bC5wcmVwKGludGwuSURfSU1NQVRVUkUpLCBiYWwuaW1tYXR1cmUsIGFzc2V0LnVuaXRJbmZvKVxuICAgIGlmIChhc3NldC50b2tlbikge1xuICAgICAgY29uc3QgeyB3YWxsZXQ6IHsgYmFsYW5jZSB9LCB1bml0SW5mbywgc3ltYm9sIH0gPSBhcHAoKS5hc3NldHNbYXNzZXQudG9rZW4ucGFyZW50SURdXG4gICAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICAgIGljb24uc3JjID0gRG9jLmxvZ29QYXRoKHN5bWJvbClcbiAgICAgIGljb24uY2xhc3NMaXN0LmFkZCgnbWljcm8taWNvbicsICdtcy0xJylcbiAgICAgIGFkZFJvdyhpbnRsLnByZXAoaW50bC5JRF9GRUVfQkFMQU5DRSksIGJhbGFuY2UuYXZhaWxhYmxlLCB1bml0SW5mbywgaWNvbilcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgY3VycmVudCBiYWxhbmNlIHVwZGF0ZSB0aW1lIGlzIG9sZGVyIHRoYW4gYW4gaG91ciwgc2hvdyB0aGVcbiAgICAvLyBleHBpcmF0aW9uIGljb24uIFJlcXVlc3QgYSBiYWxhbmNlIHVwZGF0ZSwgaWYgcG9zc2libGUuXG4gICAgY29uc3QgZXhwaXJlZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYmFsLnN0YW1wKS5nZXRUaW1lKCkgPiBhbkhvdXJcbiAgICBpZiAoZXhwaXJlZCAmJiAhd2FsbGV0LmRpc2FibGVkKSB7XG4gICAgICBEb2Muc2hvdyh0bXBsLmV4cGlyZWQpXG4gICAgICBpZiAod2FsbGV0LnJ1bm5pbmcpIGFwcCgpLmZldGNoQmFsYW5jZShhc3NldElEKVxuICAgIH0gZWxzZSBEb2MuaGlkZSh0bXBsLmV4cGlyZWQpXG4gIH1cblxuICBhc3luYyBjaGVja05lZWRzUHJvdmlkZXIgKGFzc2V0SUQ6IG51bWJlciwgZWw6IFBhZ2VFbGVtZW50KSB7XG4gICAgRG9jLnNldFZpcyhhd2FpdCBhcHAoKS5uZWVkc0N1c3RvbVByb3ZpZGVyKGFzc2V0SUQpLCBlbClcbiAgfVxuXG4gIC8qIHVwZGF0ZVBhcmVudCB1cGRhdGVzIHRoZSBzaWRlJ3MgcGFyZW50IGFzc2V0IGJhbGFuY2UuICovXG4gIHVwZGF0ZVBhcmVudCAoc2lkZTogQmFsYW5jZVdpZGdldEVsZW1lbnQpIHtcbiAgICBjb25zdCB7IHdhbGxldDogeyBiYWxhbmNlIH0sIHVuaXRJbmZvIH0gPSBhcHAoKS5hc3NldHNbc2lkZS5wYXJlbnRJRF1cbiAgICAvLyBmaXJzdENoaWxkIGlzIHRoZSB0ZXh0IG5vZGUgc2V0IGJlZm9yZSB0aGUgaW1nIGNoaWxkIG5vZGUgaW4gYWRkUm93LlxuICAgIGlmIChzaWRlLnBhcmVudEJhbD8uZmlyc3RDaGlsZCkgc2lkZS5wYXJlbnRCYWwuZmlyc3RDaGlsZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYmFsYW5jZS5hdmFpbGFibGUsIHVuaXRJbmZvKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlQXNzZXQgdXBkYXRlcyB0aGUgaW5mbyBmb3Igb25lIHNpZGUgb2YgdGhlIGV4aXN0aW5nIG1hcmtldC4gSWYgdGhlXG4gICAqIHNwZWNpZmllZCBhc3NldCBJRCBpcyBub3Qgb25lIG9mIHRoZSBjdXJyZW50IG1hcmtldCdzIGJhc2Ugb3IgcXVvdGUgYXNzZXRzLFxuICAgKiBpdCBpcyBzaWxlbnRseSBpZ25vcmVkLlxuICAgKi9cbiAgdXBkYXRlQXNzZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGlmIChhc3NldElEID09PSB0aGlzLmJhc2UuaWQpIHRoaXMudXBkYXRlV2FsbGV0KHRoaXMuYmFzZSlcbiAgICBlbHNlIGlmIChhc3NldElEID09PSB0aGlzLnF1b3RlLmlkKSB0aGlzLnVwZGF0ZVdhbGxldCh0aGlzLnF1b3RlKVxuICAgIGlmIChhc3NldElEID09PSB0aGlzLmJhc2UucGFyZW50SUQpIHRoaXMudXBkYXRlUGFyZW50KHRoaXMuYmFzZSlcbiAgICBpZiAoYXNzZXRJRCA9PT0gdGhpcy5xdW90ZS5wYXJlbnRJRCkgdGhpcy51cGRhdGVQYXJlbnQodGhpcy5xdW90ZSlcbiAgfVxufVxuXG4vKiBtYWtlTWFya2V0IGNyZWF0ZXMgYSBtYXJrZXQgb2JqZWN0IHRoYXQgc3BlY2lmaWVzIGJhc2ljIG1hcmtldCBkZXRhaWxzLiAqL1xuZnVuY3Rpb24gbWFrZU1hcmtldCAoaG9zdDogc3RyaW5nLCBiYXNlPzogbnVtYmVyLCBxdW90ZT86IG51bWJlcikge1xuICByZXR1cm4ge1xuICAgIGhvc3Q6IGhvc3QsXG4gICAgYmFzZTogYmFzZSxcbiAgICBxdW90ZTogcXVvdGVcbiAgfVxufVxuXG4vKiBtYXJrZXRJRCBjcmVhdGVzIGEgREVYLWNvbXBhdGlibGUgbWFya2V0IG5hbWUgZnJvbSB0aGUgdGlja2VyIHN5bWJvbHMuICovXG5leHBvcnQgZnVuY3Rpb24gbWFya2V0SUQgKGI6IHN0cmluZywgcTogc3RyaW5nKSB7IHJldHVybiBgJHtifV8ke3F9YCB9XG5cbi8qIGNvbnZlcnRUb0F0b21zIGNvbnZlcnRzIHRoZSBmbG9hdCBzdHJpbmcgdG8gdGhlIGJhc2ljIHVuaXQgb2YgYSBjb2luLiAqL1xuZnVuY3Rpb24gY29udmVydFRvQXRvbXMgKHM6IHN0cmluZywgY29udmVyc2lvbkZhY3RvcjogbnVtYmVyKSB7XG4gIGlmICghcykgcmV0dXJuIDBcbiAgcmV0dXJuIE1hdGgucm91bmQocGFyc2VGbG9hdChzKSAqIGNvbnZlcnNpb25GYWN0b3IpXG59XG5cbi8qIHN3YXBCdHRucyBjaGFuZ2VzIHRoZSAnc2VsZWN0ZWQnIGNsYXNzIG9mIHRoZSBidXR0b25zLiAqL1xuZnVuY3Rpb24gc3dhcEJ0dG5zIChiZWZvcmU6IEhUTUxFbGVtZW50LCBub3c6IEhUTUxFbGVtZW50KSB7XG4gIGJlZm9yZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gIG5vdy5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG59XG5cbi8qXG4gKiB3aXJlT3JkZXIgcHJlcGFyZXMgYSBjb3B5IG9mIHRoZSBvcmRlciB3aXRoIHRoZSBvcHRpb25zIGZpZWxkIGNvbnZlcnRlZCB0byBhXG4gKiBzdHJpbmcgLT4gc3RyaW5nIG1hcC5cbiAqL1xuZnVuY3Rpb24gd2lyZU9yZGVyIChvcmRlcjogVHJhZGVGb3JtKSB7XG4gIGNvbnN0IHN0cmluZ3lPcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cbiAgZm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMob3JkZXIub3B0aW9ucykpIHN0cmluZ3lPcHRpb25zW2tdID0gSlNPTi5zdHJpbmdpZnkodilcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIG9yZGVyLCB7IG9wdGlvbnM6IHN0cmluZ3lPcHRpb25zIH0pXG59XG5cbi8vIE9yZGVyVGFibGVSb3dNYW5hZ2VyIG1hbmFnZXMgdGhlIGRhdGEgd2l0aGluIGEgcm93IGluIGFuIG9yZGVyIHRhYmxlLiBFYWNoIHJvd1xuLy8gcmVwcmVzZW50cyBhbGwgdGhlIG9yZGVycyBpbiB0aGUgb3JkZXIgYm9vayB3aXRoIHRoZSBzYW1lIHJhdGUsIGJ1dCBvcmRlcnMgdGhhdFxuLy8gYXJlIGJvb2tlZCBvciBzdGlsbCBpbiB0aGUgZXBvY2ggcXVldWUgYXJlIGRpc3BsYXllZCBpbiBzZXBhcmF0ZSByb3dzLlxuY2xhc3MgT3JkZXJUYWJsZVJvd01hbmFnZXIge1xuICB0YWJsZVJvdzogSFRNTEVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIG9yZGVyQmluOiBNaW5pT3JkZXJbXVxuICBzZWxsOiBib29sZWFuXG4gIG1zZ1JhdGU6IG51bWJlclxuICBlcG9jaDogYm9vbGVhblxuICBiYXNlVW5pdEluZm86IFVuaXRJbmZvXG5cbiAgY29uc3RydWN0b3IgKHRhYmxlUm93OiBIVE1MRWxlbWVudCwgb3JkZXJCaW46IE1pbmlPcmRlcltdLCBiYXNlVW5pdEluZm86IFVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvOiBVbml0SW5mbywgcmF0ZVN0ZXA6IG51bWJlcikge1xuICAgIHRoaXMudGFibGVSb3cgPSB0YWJsZVJvd1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZSh0YWJsZVJvdylcbiAgICB0aGlzLm9yZGVyQmluID0gb3JkZXJCaW5cbiAgICB0aGlzLnNlbGwgPSBvcmRlckJpblswXS5zZWxsXG4gICAgdGhpcy5tc2dSYXRlID0gb3JkZXJCaW5bMF0ubXNnUmF0ZVxuICAgIHRoaXMuZXBvY2ggPSAhIW9yZGVyQmluWzBdLmVwb2NoXG4gICAgdGhpcy5iYXNlVW5pdEluZm8gPSBiYXNlVW5pdEluZm9cbiAgICBjb25zdCByYXRlVGV4dCA9IERvYy5mb3JtYXRSYXRlRnVsbFByZWNpc2lvbih0aGlzLm1zZ1JhdGUsIGJhc2VVbml0SW5mbywgcXVvdGVVbml0SW5mbywgcmF0ZVN0ZXApXG4gICAgRG9jLnNldFZpcyh0aGlzLmlzRXBvY2goKSwgdGhpcy5wYWdlLmVwb2NoKVxuICAgIGlmICh0aGlzLm1zZ1JhdGUgPT09IDApIHtcbiAgICAgIHBhZ2UucmF0ZS5pbm5lclRleHQgPSAnbWFya2V0J1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBjc3NDbGFzcyA9IHRoaXMuaXNTZWxsKCkgPyAnc2VsbGNvbG9yJyA6ICdidXljb2xvcidcbiAgICAgIHBhZ2UucmF0ZS5pbm5lclRleHQgPSByYXRlVGV4dFxuICAgICAgcGFnZS5yYXRlLmNsYXNzTGlzdC5hZGQoY3NzQ2xhc3MpXG4gICAgfVxuICAgIHRoaXMudXBkYXRlUXR5TnVtT3JkZXJzRWwoKVxuICB9XG5cbiAgLy8gdXBkYXRlUXR5TnVtT3JkZXJzRWwgcG9wdWxhdGVzIHRoZSBxdWFudGl0eSBlbGVtZW50IGluIHRoZSByb3csIGFuZCBhbHNvXG4gIC8vIGRpc3BsYXlzIHRoZSBudW1iZXIgb2Ygb3JkZXJzIGlmIHRoZXJlIGlzIG1vcmUgdGhhbiBvbmUgb3JkZXIgaW4gdGhlIG9yZGVyXG4gIC8vIGJpbi5cbiAgdXBkYXRlUXR5TnVtT3JkZXJzRWwgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgb3JkZXJCaW4gfSA9IHRoaXNcbiAgICBjb25zdCBxdHkgPSBvcmRlckJpbi5yZWR1Y2UoKHRvdGFsLCBjdXJyKSA9PiB0b3RhbCArIGN1cnIucXR5QXRvbWljLCAwKVxuICAgIGNvbnN0IG51bU9yZGVycyA9IG9yZGVyQmluLmxlbmd0aFxuICAgIHBhZ2UucXR5LmlubmVyVGV4dCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHF0eSwgdGhpcy5iYXNlVW5pdEluZm8pXG4gICAgaWYgKG51bU9yZGVycyA+IDEpIHtcbiAgICAgIHBhZ2UubnVtT3JkZXJzLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJylcbiAgICAgIHBhZ2UubnVtT3JkZXJzLmlubmVyVGV4dCA9IFN0cmluZyhudW1PcmRlcnMpXG4gICAgICBwYWdlLm51bU9yZGVycy50aXRsZSA9IGBxdWFudGl0eSBpcyBjb21wcmlzZWQgb2YgJHtudW1PcmRlcnN9IG9yZGVyc2BcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5udW1PcmRlcnMuc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAndHJ1ZScpXG4gICAgfVxuICB9XG5cbiAgLy8gaW5zZXJ0T3JkZXIgYWRkcyBhbiBvcmRlciB0byB0aGUgb3JkZXIgYmluIGFuZCB1cGRhdGVzIHRoZSByb3cgZWxlbWVudHNcbiAgLy8gYWNjb3JkaW5nbHkuXG4gIGluc2VydE9yZGVyIChvcmRlcjogTWluaU9yZGVyKSB7XG4gICAgdGhpcy5vcmRlckJpbi5wdXNoKG9yZGVyKVxuICAgIHRoaXMudXBkYXRlUXR5TnVtT3JkZXJzRWwoKVxuICB9XG5cbiAgLy8gdXBkYXRlT3JkZXJRdWFudGl0eSB1cGRhdGVzIHRoZSBxdWFudGl0eSBvZiB0aGUgb3JkZXIgaWRlbnRpZmllZCBieSBhIHRva2VuLFxuICAvLyBpZiBpdCBleGlzdHMgaW4gdGhlIHJvdywgYW5kIHVwZGF0ZXMgdGhlIHJvdyBlbGVtZW50cyBhY2NvcmRpbmdseS4gVGhlIGZ1bmN0aW9uXG4gIC8vIHJldHVybnMgdHJ1ZSBpZiB0aGUgb3JkZXIgaXMgaW4gdGhlIGJpbiwgYW5kIGZhbHNlIG90aGVyd2lzZS5cbiAgdXBkYXRlT3JkZXJRdHkgKHVwZGF0ZTogUmVtYWluZGVyVXBkYXRlKSB7XG4gICAgY29uc3QgeyB0b2tlbiwgcXR5LCBxdHlBdG9taWMgfSA9IHVwZGF0ZVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vcmRlckJpbi5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMub3JkZXJCaW5baV0udG9rZW4gPT09IHRva2VuKSB7XG4gICAgICAgIHRoaXMub3JkZXJCaW5baV0ucXR5ID0gcXR5XG4gICAgICAgIHRoaXMub3JkZXJCaW5baV0ucXR5QXRvbWljID0gcXR5QXRvbWljXG4gICAgICAgIHRoaXMudXBkYXRlUXR5TnVtT3JkZXJzRWwoKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIC8vIHJlbW92ZU9yZGVyIHJlbW92ZXMgdGhlIG9yZGVyIGlkZW50aWZpZWQgYnkgdGhlIHRva2VuLCBpZiBpdCBleGlzdHMgaW4gdGhlIHJvdyxcbiAgLy8gYW5kIHVwZGF0ZXMgdGhlIHJvdyBlbGVtZW50cyBhY2NvcmRpbmdseS4gSWYgdGhlIG9yZGVyIGJpbiBpcyBlbXB0eSwgdGhlIHJvdyBpc1xuICAvLyByZW1vdmVkIGZyb20gdGhlIHNjcmVlbi4gVGhlIGZ1bmN0aW9uIHJldHVybnMgdHJ1ZSBpZiBhbiBvcmRlciB3YXMgcmVtb3ZlZCwgYW5kXG4gIC8vIGZhbHNlIG90aGVyd2lzZS5cbiAgcmVtb3ZlT3JkZXIgKHRva2VuOiBzdHJpbmcpIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMub3JkZXJCaW4uZmluZEluZGV4KG9yZGVyID0+IG9yZGVyLnRva2VuID09PSB0b2tlbilcbiAgICBpZiAoaW5kZXggPCAwKSByZXR1cm4gZmFsc2VcbiAgICB0aGlzLm9yZGVyQmluLnNwbGljZShpbmRleCwgMSlcbiAgICBpZiAoIXRoaXMub3JkZXJCaW4ubGVuZ3RoKSB0aGlzLnRhYmxlUm93LnJlbW92ZSgpXG4gICAgZWxzZSB0aGlzLnVwZGF0ZVF0eU51bU9yZGVyc0VsKClcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgLy8gcmVtb3ZlRXBvY2hPcmRlcnMgcmVtb3ZlcyBhbGwgdGhlIG9yZGVycyBmcm9tIHRoZSByb3cgdGhhdCBhcmUgbm90IGluIHRoZVxuICAvLyBuZXcgZXBvY2gncyBlcG9jaCBxdWV1ZSBhbmQgdXBkYXRlcyB0aGUgZWxlbWVudHMgYWNjb3JkaW5nbHkuXG4gIHJlbW92ZUVwb2NoT3JkZXJzIChuZXdFcG9jaD86IG51bWJlcikge1xuICAgIHRoaXMub3JkZXJCaW4gPSB0aGlzLm9yZGVyQmluLmZpbHRlcigob3JkZXIpID0+IHtcbiAgICAgIHJldHVybiAhKG9yZGVyLmVwb2NoICYmIG9yZGVyLmVwb2NoICE9PSBuZXdFcG9jaClcbiAgICB9KVxuICAgIGlmICghdGhpcy5vcmRlckJpbi5sZW5ndGgpIHRoaXMudGFibGVSb3cucmVtb3ZlKClcbiAgICBlbHNlIHRoaXMudXBkYXRlUXR5TnVtT3JkZXJzRWwoKVxuICB9XG5cbiAgLy8gZ2V0UmF0ZSByZXR1cm5zIHRoZSByYXRlIG9mIHRoZSBvcmRlcnMgaW4gdGhlIHJvdy5cbiAgZ2V0UmF0ZSAoKSB7XG4gICAgcmV0dXJuIHRoaXMubXNnUmF0ZVxuICB9XG5cbiAgLy8gaXNFcG9jaCByZXR1cm5zIHdoZXRoZXIgdGhlIG9yZGVycyBpbiB0aGlzIHJvdyBhcmUgaW4gdGhlIGVwb2NoIHF1ZXVlLlxuICBpc0Vwb2NoICgpIHtcbiAgICByZXR1cm4gdGhpcy5lcG9jaFxuICB9XG5cbiAgLy8gaXNTZWxsIHJldHVybnMgd2hldGhlciB0aGUgb3JkZXJzIGluIHRoaXMgcm93IGFyZSBzZWxsIG9yZGVycy5cbiAgaXNTZWxsICgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxsXG4gIH1cblxuICAvLyBjb21wYXJlIHRha2VzIGFuIG9yZGVyIGFuZCByZXR1cm5zIDAgaWYgdGhlIG9yZGVyIGJlbG9uZ3MgaW4gdGhpcyByb3csXG4gIC8vIDEgaWYgdGhlIG9yZGVyIHNob3VsZCBnbyBhZnRlciB0aGlzIHJvdyBpbiB0aGUgdGFibGUsIGFuZCAtMSBpZiBpdCBzaG91bGRcbiAgLy8gYmUgYmVmb3JlIHRoaXMgcm93IGluIHRoZSB0YWJsZS4gU2VsbCBvcmRlcnMgYXJlIGRpc3BsYXllZCBpbiBhc2NlbmRpbmcgb3JkZXIsXG4gIC8vIGJ1eSBvcmRlcnMgYXJlIGRpc3BsYXllZCBpbiBkZXNjZW5kaW5nIG9yZGVyLCBhbmQgZXBvY2ggb3JkZXJzIGFsd2F5cyBjb21lXG4gIC8vIGFmdGVyIGJvb2tlZCBvcmRlcnMuXG4gIGNvbXBhcmUgKG9yZGVyOiBNaW5pT3JkZXIpIHtcbiAgICBpZiAodGhpcy5nZXRSYXRlKCkgPT09IG9yZGVyLm1zZ1JhdGUgJiYgdGhpcy5pc0Vwb2NoKCkgPT09ICEhb3JkZXIuZXBvY2gpIHtcbiAgICAgIHJldHVybiAwXG4gICAgfSBlbHNlIGlmICh0aGlzLmdldFJhdGUoKSAhPT0gb3JkZXIubXNnUmF0ZSkge1xuICAgICAgcmV0dXJuICh0aGlzLmdldFJhdGUoKSA+IG9yZGVyLm1zZ1JhdGUpID09PSBvcmRlci5zZWxsID8gMSA6IC0xXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmlzRXBvY2goKSA/IDEgOiAtMVxuICAgIH1cbiAgfVxufVxuXG5pbnRlcmZhY2UgRXhjaGFuZ2VNYXJrZXQgZXh0ZW5kcyBNYXJrZXQge1xuICB4YzogRXhjaGFuZ2VcbiAgYmFzZU5hbWU6IHN0cmluZ1xuICBidWk6IFVuaXRJbmZvXG59XG5cbmZ1bmN0aW9uIHNvcnRlZE1hcmtldHMgKCk6IEV4Y2hhbmdlTWFya2V0W10ge1xuICBjb25zdCBta3RzOiBFeGNoYW5nZU1hcmtldFtdID0gW11cbiAgY29uc3QgYXNzZXRzID0gYXBwKCkuYXNzZXRzXG4gIGNvbnN0IGNvbnZlcnRNYXJrZXRzID0gKHhjOiBFeGNoYW5nZSwgbWt0czogTWFya2V0W10pID0+IHtcbiAgICByZXR1cm4gbWt0cy5tYXAoKG1rdDogTWFya2V0KSA9PiB7XG4gICAgICBjb25zdCBhID0gYXNzZXRzW21rdC5iYXNlaWRdXG4gICAgICBjb25zdCBiYXNlTmFtZSA9IGEgPyBhLm5hbWUgOiBta3QuYmFzZXN5bWJvbFxuICAgICAgY29uc3QgYnVpID0gYXBwKCkudW5pdEluZm8obWt0LmJhc2VpZCwgeGMpXG4gICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7IHhjLCBiYXNlTmFtZSwgYnVpIH0sIG1rdClcbiAgICB9KVxuICB9XG4gIGZvciAoY29uc3QgeGMgb2YgT2JqZWN0LnZhbHVlcyhhcHAoKS5leGNoYW5nZXMpKSBta3RzLnB1c2goLi4uY29udmVydE1hcmtldHMoeGMsIE9iamVjdC52YWx1ZXMoeGMubWFya2V0cyB8fCB7fSkpKVxuICBta3RzLnNvcnQoKGE6IEV4Y2hhbmdlTWFya2V0LCBiOiBFeGNoYW5nZU1hcmtldCk6IG51bWJlciA9PiB7XG4gICAgaWYgKCFhLnNwb3QpIHtcbiAgICAgIGlmIChiLnNwb3QpIHJldHVybiAxIC8vIHB1dCBiIGZpcnN0LCBzaW5jZSB3ZSBoYXZlIHRoZSBzcG90XG4gICAgICAvLyBubyBzcG90cy4gY29tcGFyZSBtYXJrZXQgbmFtZSB0aGVuIGhvc3QgbmFtZVxuICAgICAgaWYgKGEubmFtZSA9PT0gYi5uYW1lKSByZXR1cm4gYS54Yy5ob3N0LmxvY2FsZUNvbXBhcmUoYi54Yy5ob3N0KVxuICAgICAgcmV0dXJuIGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSlcbiAgICB9IGVsc2UgaWYgKCFiLnNwb3QpIHJldHVybiAtMSAvLyBwdXQgYSBmaXJzdCwgc2luY2Ugd2UgaGF2ZSB0aGUgc3BvdFxuICAgIGNvbnN0IFthTG90cywgYkxvdHNdID0gW2Euc3BvdC52b2wyNCAvIGEubG90c2l6ZSwgYi5zcG90LnZvbDI0IC8gYi5sb3RzaXplXVxuICAgIHJldHVybiBiTG90cyAtIGFMb3RzIC8vIHdob2V2ZXIgaGFzIG1vcmUgdm9sdW1lIGJ5IGxvdCBjb3VudFxuICB9KVxuICByZXR1cm4gbWt0c1xufVxuXG5mdW5jdGlvbiBzZXRQcmljZUFuZENoYW5nZSAodG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+LCB4YzogRXhjaGFuZ2UsIG1rdDogTWFya2V0KSB7XG4gIGlmICghbWt0LnNwb3QpIHJldHVyblxuICB0bXBsLnByaWNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGFwcCgpLmNvbnZlbnRpb25hbFJhdGUobWt0LmJhc2VpZCwgbWt0LnF1b3RlaWQsIG1rdC5zcG90LnJhdGUsIHhjKSlcbiAgY29uc3Qgc2lnbiA9IG1rdC5zcG90LmNoYW5nZTI0ID4gMCA/ICcrJyA6ICcnXG4gIHRtcGwuY2hhbmdlLmNsYXNzTGlzdC5yZW1vdmUoJ2J1eWNvbG9yJywgJ3NlbGxjb2xvcicpXG4gIHRtcGwuY2hhbmdlLmNsYXNzTGlzdC5hZGQobWt0LnNwb3QuY2hhbmdlMjQgPj0gMCA/ICdidXljb2xvcicgOiAnc2VsbGNvbG9yJylcbiAgdG1wbC5jaGFuZ2UudGV4dENvbnRlbnQgPSBgJHtzaWdufSR7KG1rdC5zcG90LmNoYW5nZTI0ICogMTAwKS50b0ZpeGVkKDEpfSVgXG59XG5cbmNvbnN0IGh1ZXMgPSBbMSAvIDIsIDEgLyA0LCAzIC8gNCwgMSAvIDgsIDUgLyA4LCAzIC8gOCwgNyAvIDhdXG5cbmZ1bmN0aW9uIGdlbmVyYXRlSHVlIChpZHg6IG51bWJlcik6IHN0cmluZyB7XG4gIGNvbnN0IGggPSBodWVzW2lkeCAlIGh1ZXMubGVuZ3RoXVxuICByZXR1cm4gYGhzbCgke2ggKiAzNjB9LCAzNSUsIDUwJSlgXG59XG5cbmZ1bmN0aW9uIGhvc3RDb2xvciAoaG9zdDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgaG9zdHMgPSBPYmplY3Qua2V5cyhhcHAoKS5leGNoYW5nZXMpXG4gIGhvc3RzLnNvcnQoKVxuICByZXR1cm4gZ2VuZXJhdGVIdWUoaG9zdHMuaW5kZXhPZihob3N0KSlcbn1cbiIsImltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnQsXG4gIE1NQm90U3RhdHVzLFxuICBSdW5TdGF0c05vdGUsXG4gIFJ1bkV2ZW50Tm90ZSxcbiAgRXhjaGFuZ2VCYWxhbmNlLFxuICBTdGFydENvbmZpZyxcbiAgT3JkZXJQbGFjZW1lbnQsXG4gIEF1dG9SZWJhbGFuY2VDb25maWcsXG4gIENFWE5vdGlmaWNhdGlvbixcbiAgRXBvY2hSZXBvcnROb3RlLFxuICBDRVhQcm9ibGVtc05vdGVcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7XG4gIE1NLFxuICBDRVhEaXNwbGF5SW5mbyxcbiAgQ0VYRGlzcGxheUluZm9zLFxuICBib3RUeXBlQmFzaWNBcmIsXG4gIGJvdFR5cGVBcmJNTSxcbiAgYm90VHlwZUJhc2ljTU0sXG4gIHNldE1hcmtldEVsZW1lbnRzLFxuICBzZXRDZXhFbGVtZW50cyxcbiAgUGxhY2VtZW50c0NoYXJ0LFxuICBCb3RNYXJrZXQsXG4gIGhvc3RlZE1hcmtldElELFxuICBSdW5uaW5nTWFya2V0TWFrZXJEaXNwbGF5XG59IGZyb20gJy4vbW11dGlsJ1xuaW1wb3J0IERvYywgeyBNaW5pU2xpZGVyIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCAqIGFzIE9yZGVyVXRpbCBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCB7IEZvcm1zLCBDRVhDb25maWd1cmF0aW9uRm9ybSB9IGZyb20gJy4vZm9ybXMnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7IFN0YXR1c0Jvb2tlZCB9IGZyb20gJy4vb3JkZXJ1dGlsJ1xuXG5jb25zdCBtZWRpdW1CcmVha3BvaW50ID0gNzY4XG5cbmludGVyZmFjZSBGdW5kaW5nU2xpZGVyIHtcbiAgbGVmdDoge1xuICAgIGNleDogbnVtYmVyXG4gICAgZGV4OiBudW1iZXJcbiAgfVxuICByaWdodDoge1xuICAgIGNleDogbnVtYmVyXG4gICAgZGV4OiBudW1iZXJcbiAgfVxuICBjZXhSYW5nZTogbnVtYmVyXG4gIGRleFJhbmdlOiBudW1iZXJcbn1cblxuY29uc3QgbmV3U2xpZGVyID0gKCkgPT4ge1xuICByZXR1cm4ge1xuICAgIGxlZnQ6IHtcbiAgICAgIGNleDogMCxcbiAgICAgIGRleDogMFxuICAgIH0sXG4gICAgcmlnaHQ6IHtcbiAgICAgIGNleDogMCxcbiAgICAgIGRleDogMFxuICAgIH0sXG4gICAgY2V4UmFuZ2U6IDAsXG4gICAgZGV4UmFuZ2U6IDBcbiAgfVxufVxuXG5pbnRlcmZhY2UgRnVuZGluZ1NvdXJjZSB7XG4gIGF2YWlsOiBudW1iZXJcbiAgcmVxOiBudW1iZXJcbiAgZnVuZGVkOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBGdW5kaW5nT3V0bG9vayB7XG4gIGRleDogRnVuZGluZ1NvdXJjZVxuICBjZXg6IEZ1bmRpbmdTb3VyY2VcbiAgdHJhbnNmZXJhYmxlOiBudW1iZXJcbiAgZmVlczoge1xuICAgIGF2YWlsOiBudW1iZXJcbiAgICByZXE6IG51bWJlclxuICAgIGZ1bmRlZDogYm9vbGVhblxuICB9LFxuICBmdW5kZWRBbmRCYWxhbmNlZDogYm9vbGVhblxuICBmdW5kZWRBbmROb3RCYWxhbmNlZDogYm9vbGVhblxufVxuXG5mdW5jdGlvbiBwYXJzZUZ1bmRpbmdPcHRpb25zIChmOiBGdW5kaW5nT3V0bG9vayk6IFtudW1iZXIsIG51bWJlciwgRnVuZGluZ1NsaWRlciB8IHVuZGVmaW5lZF0ge1xuICBjb25zdCB7IGNleDogeyBhdmFpbDogY2V4QXZhaWwsIHJlcTogY2V4UmVxIH0sIGRleDogeyBhdmFpbDogZGV4QXZhaWwsIHJlcTogZGV4UmVxIH0sIHRyYW5zZmVyYWJsZSB9ID0gZlxuXG4gIGxldCBwcm9wb3NlZERleCA9IE1hdGgubWluKGRleEF2YWlsLCBkZXhSZXEpXG4gIGxldCBwcm9wb3NlZENleCA9IE1hdGgubWluKGNleEF2YWlsLCBjZXhSZXEpXG4gIGxldCBzbGlkZXI6IEZ1bmRpbmdTbGlkZXIgfCB1bmRlZmluZWRcbiAgaWYgKGYuZnVuZGVkQW5kTm90QmFsYW5jZWQpIHtcbiAgICAvLyBXZSBoYXZlIGV2ZXJ5dGhpbmcgd2UgbmVlZCwgYnV0IG5vdCB3aGVyZSB3ZSBuZWVkIGl0LCBhbmQgd2UgY2FuXG4gICAgLy8gZGVwb3NpdCBhbmQgd2l0aGRyYXcuXG4gICAgaWYgKGRleEF2YWlsID4gZGV4UmVxKSB7XG4gICAgICAvLyBXZSBoYXZlIHRvbyBtdWNoIGRleC1zaWRlLCBzbyB3ZSdsbCBoYXZlIHRvIGRyYXcgb24gZGV4IHRvIGJhbGFuY2VcbiAgICAgIC8vIGNleCdzIHNob3J0Y29taW5ncy5cbiAgICAgIGNvbnN0IGNleFNob3J0ID0gY2V4UmVxIC0gY2V4QXZhaWxcbiAgICAgIGNvbnN0IGRleFJlbWFpbiA9IGRleEF2YWlsIC0gZGV4UmVxXG4gICAgICBpZiAoZGV4UmVtYWluIDwgY2V4U2hvcnQpIHtcbiAgICAgICAgLy8gV2UgZGlkIHNvbWV0aGluZyByZWFsbHkgYmFkIHdpdGggbWF0aCB0byBnZXQgaGVyZS5cbiAgICAgICAgdGhyb3cgRXJyb3IoJ2JhZCBtYXRoIGhhcyB1cyB3aXRoIGRleCBzdXJwbHVzICsgY2V4IHVuZGVyZnVuZCBpbnZhbGlkIHJlbWFpbnMnKVxuICAgICAgfVxuICAgICAgcHJvcG9zZWREZXggKz0gY2V4U2hvcnQgKyB0cmFuc2ZlcmFibGVcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gV2UgZG9uJ3QgaGF2ZSBlbm91Z2ggb24gZGV4LCBidXQgd2UgaGF2ZSBlbm91Z2ggb24gY2V4IHRvIGNvdmVyIHRoZVxuICAgICAgLy8gc2hvcnQuXG4gICAgICBjb25zdCBkZXhTaG9ydCA9IGRleFJlcSAtIGRleEF2YWlsXG4gICAgICBjb25zdCBjZXhSZW1haW4gPSBjZXhBdmFpbCAtIGNleFJlcVxuICAgICAgaWYgKGNleFJlbWFpbiA8IGRleFNob3J0KSB7XG4gICAgICAgIHRocm93IEVycm9yKCdiYWQgbWF0aCBnb3QgdXMgd2l0aCBjZXggc3VycGx1cyArIGRleCB1bmRlcmZ1bmQgaW52YWxpZCByZW1haW5zJylcbiAgICAgIH1cbiAgICAgIHByb3Bvc2VkQ2V4ICs9IGRleFNob3J0ICsgdHJhbnNmZXJhYmxlXG4gICAgfVxuICB9IGVsc2UgaWYgKGYuZnVuZGVkQW5kQmFsYW5jZWQpIHtcbiAgICAvLyBUaGlzIGFzc2V0IGlzIGZ1bGx5IGZ1bmRlZCwgYnV0IHRoZSB1c2VyIG1heSBjaG9vc2UgdG8gZnVuZCBvcmRlclxuICAgIC8vIHJlc2VydmVzIGVpdGhlciBjZXggb3IgZGV4LlxuICAgIGlmICh0cmFuc2ZlcmFibGUgPiAwKSB7XG4gICAgICBjb25zdCBkZXhSZW1haW4gPSBkZXhBdmFpbCAtIGRleFJlcVxuICAgICAgY29uc3QgY2V4UmVtYWluID0gY2V4QXZhaWwgLSBjZXhSZXFcblxuICAgICAgc2xpZGVyID0gbmV3U2xpZGVyKClcblxuICAgICAgaWYgKGNleFJlbWFpbiA+IHRyYW5zZmVyYWJsZSAmJiBkZXhSZW1haW4gPiB0cmFuc2ZlcmFibGUpIHtcbiAgICAgICAgLy8gRWl0aGVyIG9uZSBjb3VsZCBmdWxseSBmdW5kIG9yZGVyIHJlc2VydmVzLiBMZXQgdGhlIHVzZXIgY2hvb3NlLlxuICAgICAgICBzbGlkZXIubGVmdC5jZXggPSB0cmFuc2ZlcmFibGUgKyBjZXhSZXFcbiAgICAgICAgc2xpZGVyLmxlZnQuZGV4ID0gZGV4UmVxXG4gICAgICAgIHNsaWRlci5yaWdodC5jZXggPSBjZXhSZXFcbiAgICAgICAgc2xpZGVyLnJpZ2h0LmRleCA9IHRyYW5zZmVyYWJsZSArIGRleFJlcVxuICAgICAgfSBlbHNlIGlmIChkZXhSZW1haW4gPCB0cmFuc2ZlcmFibGUgJiYgY2V4UmVtYWluIDwgdHJhbnNmZXJhYmxlKSB7XG4gICAgICAgIC8vID0+IGltcGxpZWQgdGhhdCBjZXhSZW1haW4gKyBkZXhSZW1haW4gPiB0cmFuc2ZlcmFibGUuXG4gICAgICAgIC8vIENFWCBjYW4gY29udHJpYnV0ZSBTT01FIGFuZCBERVggY2FuIGNvbnRyaWJ1dGUgU09NRS5cbiAgICAgICAgc2xpZGVyLmxlZnQuY2V4ID0gdHJhbnNmZXJhYmxlIC0gZGV4UmVtYWluICsgY2V4UmVxXG4gICAgICAgIHNsaWRlci5sZWZ0LmRleCA9IGRleFJlbWFpbiArIGRleFJlcVxuICAgICAgICBzbGlkZXIucmlnaHQuY2V4ID0gY2V4UmVtYWluICsgY2V4UmVxXG4gICAgICAgIHNsaWRlci5yaWdodC5kZXggPSB0cmFuc2ZlcmFibGUgLSBjZXhSZW1haW4gKyBkZXhSZXFcbiAgICAgIH0gZWxzZSBpZiAoZGV4UmVtYWluID4gdHJhbnNmZXJhYmxlKSB7XG4gICAgICAgIC8vIFNvIERFWCBoYXMgZW5vdWdoIHRvIGNvdmVyIHJlc2VydmVzLCBidXQgQ0VYIGNvdWxkIHBvdGVudGlhbGx5XG4gICAgICAgIC8vIGNvbnN0cmlidXRlIFNPTUUuIE5PVCBBTEwuXG4gICAgICAgIHNsaWRlci5sZWZ0LmNleCA9IGNleFJlcVxuICAgICAgICBzbGlkZXIubGVmdC5kZXggPSB0cmFuc2ZlcmFibGUgKyBkZXhSZXFcbiAgICAgICAgc2xpZGVyLnJpZ2h0LmNleCA9IGNleFJlbWFpbiArIGNleFJlcVxuICAgICAgICBzbGlkZXIucmlnaHQuZGV4ID0gdHJhbnNmZXJhYmxlIC0gY2V4UmVtYWluICsgZGV4UmVxXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBDRVggaGFzIGVub3VnaCB0byBjb3ZlciByZXNlcnZlcywgYnV0IERFWCBjb3VsZCBjb250cmlidXRlIFNPTUUsXG4gICAgICAgIC8vIE5PVCBBTEwuXG4gICAgICAgIHNsaWRlci5sZWZ0LmNleCA9IHRyYW5zZmVyYWJsZSAtIGRleFJlbWFpbiArIGNleFJlcVxuICAgICAgICBzbGlkZXIubGVmdC5kZXggPSBkZXhSZW1haW4gKyBkZXhSZXFcbiAgICAgICAgc2xpZGVyLnJpZ2h0LmNleCA9IHRyYW5zZmVyYWJsZSArIGNleFJlcVxuICAgICAgICBzbGlkZXIucmlnaHQuZGV4ID0gZGV4UmVxXG4gICAgICB9XG4gICAgICAvLyBXZSBwcmVmZXIgdGhlIHNsaWRlciByaWdodCBpbiB0aGUgY2VudGVyLlxuICAgICAgc2xpZGVyLmNleFJhbmdlID0gc2xpZGVyLnJpZ2h0LmNleCAtIHNsaWRlci5sZWZ0LmNleFxuICAgICAgc2xpZGVyLmRleFJhbmdlID0gc2xpZGVyLnJpZ2h0LmRleCAtIHNsaWRlci5sZWZ0LmRleFxuICAgICAgcHJvcG9zZWREZXggPSBzbGlkZXIubGVmdC5kZXggKyAoc2xpZGVyLmRleFJhbmdlIC8gMilcbiAgICAgIHByb3Bvc2VkQ2V4ID0gc2xpZGVyLmxlZnQuY2V4ICsgKHNsaWRlci5jZXhSYW5nZSAvIDIpXG4gICAgfVxuICB9IGVsc2UgeyAvLyBzdGFydmVkXG4gICAgaWYgKGNleEF2YWlsIDwgY2V4UmVxKSB7XG4gICAgICBwcm9wb3NlZERleCA9IE1hdGgubWluKGRleEF2YWlsLCBkZXhSZXEgKyB0cmFuc2ZlcmFibGUgKyAoY2V4UmVxIC0gY2V4QXZhaWwpKVxuICAgIH0gZWxzZSBpZiAoZGV4QXZhaWwgPCBkZXhSZXEpIHtcbiAgICAgIHByb3Bvc2VkQ2V4ID0gTWF0aC5taW4oY2V4QXZhaWwsIGNleFJlcSArIHRyYW5zZmVyYWJsZSArIChkZXhSZXEgLSBkZXhBdmFpbCkpXG4gICAgfSBlbHNlIHsgLy8ganVzdCB0cmFuc2ZlcmFibGUgd2Fzbid0IGNvdmVyZWRcbiAgICAgIHByb3Bvc2VkRGV4ID0gTWF0aC5taW4oZGV4QXZhaWwsIGRleFJlcSArIHRyYW5zZmVyYWJsZSlcbiAgICAgIHByb3Bvc2VkQ2V4ID0gTWF0aC5taW4oY2V4QXZhaWwsIGRleFJlcSArIGNleFJlcSArIHRyYW5zZmVyYWJsZSAtIHByb3Bvc2VkRGV4KVxuICAgIH1cbiAgfVxuICByZXR1cm4gW3Byb3Bvc2VkRGV4LCBwcm9wb3NlZENleCwgc2xpZGVyXVxufVxuXG5pbnRlcmZhY2UgQ0VYUm93IHtcbiAgY2V4TmFtZTogc3RyaW5nXG4gIHRyOiBQYWdlRWxlbWVudFxuICB0bXBsOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgZGluZm86IENFWERpc3BsYXlJbmZvXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcmtldE1ha2VyUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGZvcm1zOiBGb3Jtc1xuICBjdXJyZW50Rm9ybTogSFRNTEVsZW1lbnRcbiAga2V5dXA6IChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG4gIGNleENvbmZpZ0Zvcm06IENFWENvbmZpZ3VyYXRpb25Gb3JtXG4gIGJvdHM6IFJlY29yZDxzdHJpbmcsIEJvdD5cbiAgc29ydGVkQm90czogQm90W11cbiAgY2V4ZXM6IFJlY29yZDxzdHJpbmcsIENFWFJvdz5cbiAgdHdvQ29sdW1uOiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuXG4gICAgdGhpcy5ib3RzID0ge31cbiAgICB0aGlzLnNvcnRlZEJvdHMgPSBbXVxuICAgIHRoaXMuY2V4ZXMgPSB7fVxuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKG1haW4pXG5cbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXMocGFnZS5ib3RUbXBsLCBwYWdlLmJvdFJvd1RtcGwsIHBhZ2UuZXhjaGFuZ2VSb3dUbXBsKVxuXG4gICAgdGhpcy5mb3JtcyA9IG5ldyBGb3JtcyhwYWdlLmZvcm1zKVxuICAgIHRoaXMuY2V4Q29uZmlnRm9ybSA9IG5ldyBDRVhDb25maWd1cmF0aW9uRm9ybShwYWdlLmNleENvbmZpZ0Zvcm0sIChjZXhOYW1lOiBzdHJpbmcpID0+IHRoaXMuY2V4Q29uZmlndXJlZChjZXhOYW1lKSlcblxuICAgIERvYy5iaW5kKHBhZ2UubmV3Qm90LCAnY2xpY2snLCAoKSA9PiB7IHRoaXMubmV3Qm90KCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmFyY2hpdmVkTG9nc0J0biwgJ2NsaWNrJywgKCkgPT4geyBhcHAoKS5sb2FkUGFnZSgnbW1hcmNoaXZlcycpIH0pXG5cbiAgICB0aGlzLnR3b0NvbHVtbiA9IHdpbmRvdy5pbm5lcldpZHRoID49IG1lZGl1bUJyZWFrcG9pbnRcbiAgICBjb25zdCBybyA9IG5ldyBSZXNpemVPYnNlcnZlcigoKSA9PiB7IHRoaXMucmVzaXplZCgpIH0pXG4gICAgcm8ub2JzZXJ2ZShtYWluKVxuXG4gICAgZm9yIChjb25zdCBbY2V4TmFtZSwgZGluZm9dIG9mIE9iamVjdC5lbnRyaWVzKENFWERpc3BsYXlJbmZvcykpIHtcbiAgICAgIGNvbnN0IHRyID0gcGFnZS5leGNoYW5nZVJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLmNleFJvd3MuYXBwZW5kQ2hpbGQodHIpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodHIpXG4gICAgICBjb25zdCBjb25maWd1cmUgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2V4Q29uZmlnRm9ybS5zZXRDRVgoY2V4TmFtZSlcbiAgICAgICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UuY2V4Q29uZmlnRm9ybSlcbiAgICAgIH1cbiAgICAgIERvYy5iaW5kKHRtcGwuY29uZmlndXJlQnR0biwgJ2NsaWNrJywgY29uZmlndXJlKVxuICAgICAgRG9jLmJpbmQodG1wbC5yZWNvbmZpZ0J0dG4sICdjbGljaycsIGNvbmZpZ3VyZSlcbiAgICAgIERvYy5iaW5kKHRtcGwuZXJyQ29uZmlndXJlQnR0biwgJ2NsaWNrJywgY29uZmlndXJlKVxuICAgICAgY29uc3Qgcm93ID0gdGhpcy5jZXhlc1tjZXhOYW1lXSA9IHsgdHIsIHRtcGwsIGRpbmZvLCBjZXhOYW1lIH1cbiAgICAgIHRoaXMudXBkYXRlQ2V4Um93KHJvdylcbiAgICB9XG5cbiAgICB0aGlzLnNldHVwKClcbiAgfVxuXG4gIHJlc2l6ZWQgKCkge1xuICAgIGNvbnN0IHVzZVR3b0NvbHVtbiA9IHdpbmRvdy5pbm5lcldpZHRoID49IDc2OFxuICAgIGlmICh1c2VUd29Db2x1bW4gIT09IHRoaXMudHdvQ29sdW1uKSB7XG4gICAgICB0aGlzLnR3b0NvbHVtbiA9IHVzZVR3b0NvbHVtblxuICAgICAgdGhpcy5jbGVhckJvdEJveGVzKClcbiAgICAgIGZvciAoY29uc3QgeyBkaXYgfSBvZiB0aGlzLnNvcnRlZEJvdHMpIHRoaXMuYXBwZW5kQm90Qm94KGRpdilcbiAgICB9XG4gIH1cblxuICBhc3luYyBzZXR1cCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IG1tU3RhdHVzID0gYXBwKCkubW1TdGF0dXNcblxuICAgIGNvbnN0IGJvdENvbmZpZ3MgPSBtbVN0YXR1cy5ib3RzLm1hcCgoczogTU1Cb3RTdGF0dXMpID0+IHMuY29uZmlnKVxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBydW5zdGF0czogKG5vdGU6IFJ1blN0YXRzTm90ZSkgPT4geyB0aGlzLmhhbmRsZVJ1blN0YXRzTm90ZShub3RlKSB9LFxuICAgICAgcnVuZXZlbnQ6IChub3RlOiBSdW5FdmVudE5vdGUpID0+IHtcbiAgICAgICAgY29uc3QgYm90ID0gdGhpcy5ib3RzW2hvc3RlZE1hcmtldElEKG5vdGUuaG9zdCwgbm90ZS5iYXNlSUQsIG5vdGUucXVvdGVJRCldXG4gICAgICAgIGlmIChib3QpIHJldHVybiBib3QuaGFuZGxlUnVuU3RhdHMoKVxuICAgICAgfSxcbiAgICAgIGVwb2NocmVwb3J0OiAobm90ZTogRXBvY2hSZXBvcnROb3RlKSA9PiB7XG4gICAgICAgIGNvbnN0IGJvdCA9IHRoaXMuYm90c1tob3N0ZWRNYXJrZXRJRChub3RlLmhvc3QsIG5vdGUuYmFzZUlELCBub3RlLnF1b3RlSUQpXVxuICAgICAgICBpZiAoYm90KSBib3QuaGFuZGxlRXBvY2hSZXBvcnROb3RlKG5vdGUpXG4gICAgICB9LFxuICAgICAgY2V4cHJvYmxlbXM6IChub3RlOiBDRVhQcm9ibGVtc05vdGUpID0+IHtcbiAgICAgICAgY29uc3QgYm90ID0gdGhpcy5ib3RzW2hvc3RlZE1hcmtldElEKG5vdGUuaG9zdCwgbm90ZS5iYXNlSUQsIG5vdGUucXVvdGVJRCldXG4gICAgICAgIGlmIChib3QpIGJvdC5oYW5kbGVDZXhQcm9ibGVtc05vdGUobm90ZSlcbiAgICAgIH0sXG4gICAgICBjZXhub3RlOiAobm90ZTogQ0VYTm90aWZpY2F0aW9uKSA9PiB7IHRoaXMuaGFuZGxlQ0VYTm90ZShub3RlKSB9XG4gICAgICAvLyBUT0RPIGJvdCBzdGFydC1zdG9wIG5vdGlmaWNhdGlvblxuICAgIH0pXG5cbiAgICBjb25zdCBub0JvdHMgPSAhYm90Q29uZmlncyB8fCBib3RDb25maWdzLmxlbmd0aCA9PT0gMFxuICAgIERvYy5zZXRWaXMobm9Cb3RzLCBwYWdlLm5vQm90cylcbiAgICBpZiAobm9Cb3RzKSByZXR1cm5cbiAgICBwYWdlLm5vQm90cy5yZW1vdmUoKVxuXG4gICAgY29uc3Qgc29ydGVkQm90cyA9IFsuLi5tbVN0YXR1cy5ib3RzXS5zb3J0KChhOiBNTUJvdFN0YXR1cywgYjogTU1Cb3RTdGF0dXMpID0+IHtcbiAgICAgIGlmIChhLnJ1bm5pbmcgJiYgIWIucnVubmluZykgcmV0dXJuIC0xXG4gICAgICBpZiAoYi5ydW5uaW5nICYmICFhLnJ1bm5pbmcpIHJldHVybiAxXG4gICAgICAvLyBJZiBub25lIGFyZSBydW5uaW5nLCBqdXN0IGRvIHNvbWV0aGluZyB0byBnZXQgYSByZXNvbmFibHkgcmVwcm9kdWNpYmxlXG4gICAgICAvLyBzb3J0LlxuICAgICAgaWYgKCFhLnJ1bm5pbmcgJiYgIWIucnVubmluZykgcmV0dXJuIChhLmNvbmZpZy5iYXNlSUQgKyBhLmNvbmZpZy5xdW90ZUlEKSAtIChiLmNvbmZpZy5iYXNlSUQgKyBiLmNvbmZpZy5xdW90ZUlEKVxuICAgICAgLy8gQm90aCBhcmUgcnVubmluZy4gU29ydCBieSBydW4gdGltZS5cbiAgICAgIHJldHVybiAoYi5ydW5TdGF0cz8uc3RhcnRUaW1lID8/IDApIC0gKGEucnVuU3RhdHM/LnN0YXJ0VGltZSA/PyAwKVxuICAgIH0pXG5cbiAgICBjb25zdCBzdGFydHVwQmFsYW5jZUNhY2hlOiBSZWNvcmQ8bnVtYmVyLCBQcm9taXNlPEV4Y2hhbmdlQmFsYW5jZT4+ID0ge31cblxuICAgIGZvciAoY29uc3QgYm90U3RhdHVzIG9mIHNvcnRlZEJvdHMpIHRoaXMuYWRkQm90KGJvdFN0YXR1cywgc3RhcnR1cEJhbGFuY2VDYWNoZSlcbiAgfVxuXG4gIGFzeW5jIGhhbmRsZUNFWE5vdGUgKG46IENFWE5vdGlmaWNhdGlvbikge1xuICAgIHN3aXRjaCAobi50b3BpYykge1xuICAgICAgY2FzZSAnQmFsYW5jZVVwZGF0ZSc6XG4gICAgICAgIHJldHVybiB0aGlzLmhhbmRsZUNFWEJhbGFuY2VVcGRhdGUobi5jZXhOYW1lIC8qICwgbi5ub3RlICovKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGhhbmRsZUNFWEJhbGFuY2VVcGRhdGUgKGNleE5hbWU6IHN0cmluZyAvKiAsIG5vdGU6IENFWEJhbGFuY2VVcGRhdGUgKi8pIHtcbiAgICBjb25zdCBjZXhSb3cgPSB0aGlzLmNleGVzW2NleE5hbWVdXG4gICAgaWYgKGNleFJvdykgdGhpcy51cGRhdGVDZXhSb3coY2V4Um93KVxuICB9XG5cbiAgYXN5bmMgaGFuZGxlUnVuU3RhdHNOb3RlIChub3RlOiBSdW5TdGF0c05vdGUpIHtcbiAgICBjb25zdCB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCB9ID0gbm90ZVxuICAgIGNvbnN0IGJvdCA9IHRoaXMuYm90c1tob3N0ZWRNYXJrZXRJRChob3N0LCBiYXNlSUQsIHF1b3RlSUQpXVxuICAgIGlmIChib3QpIHJldHVybiBib3QuaGFuZGxlUnVuU3RhdHMoKVxuICAgIHRoaXMuYWRkQm90KGFwcCgpLmJvdFN0YXR1cyhob3N0LCBiYXNlSUQsIHF1b3RlSUQpIGFzIE1NQm90U3RhdHVzKVxuICB9XG5cbiAgdW5sb2FkICgpOiB2b2lkIHtcbiAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuICB9XG5cbiAgYWRkQm90IChib3RTdGF0dXM6IE1NQm90U3RhdHVzLCBzdGFydHVwQmFsYW5jZUNhY2hlPzogUmVjb3JkPG51bWJlciwgUHJvbWlzZTxFeGNoYW5nZUJhbGFuY2U+Pikge1xuICAgIGNvbnN0IHsgcGFnZSwgYm90cywgc29ydGVkQm90cyB9ID0gdGhpc1xuICAgIC8vIE1ha2Ugc3VyZSB0aGUgbWFya2V0IHN0aWxsIGV4aXN0cy5cbiAgICBjb25zdCB7IGNvbmZpZzogeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QgfSB9ID0gYm90U3RhdHVzXG4gICAgY29uc3QgW2Jhc2VTeW1ib2wsIHF1b3RlU3ltYm9sXSA9IFthcHAoKS5hc3NldHNbYmFzZUlEXS5zeW1ib2wsIGFwcCgpLmFzc2V0c1txdW90ZUlEXS5zeW1ib2xdXG4gICAgY29uc3QgbWt0SUQgPSBgJHtiYXNlU3ltYm9sfV8ke3F1b3RlU3ltYm9sfWBcbiAgICBpZiAoIWFwcCgpLmV4Y2hhbmdlc1tob3N0XT8ubWFya2V0c1tta3RJRF0pIHJldHVyblxuICAgIGNvbnN0IGJvdCA9IG5ldyBCb3QodGhpcywgYm90U3RhdHVzLCBzdGFydHVwQmFsYW5jZUNhY2hlKVxuICAgIHBhZ2UuYm90Um93cy5hcHBlbmRDaGlsZChib3Qucm93LnRyKVxuICAgIHNvcnRlZEJvdHMucHVzaChib3QpXG4gICAgYm90c1tib3QuaWRdID0gYm90XG4gICAgdGhpcy5hcHBlbmRCb3RCb3goYm90LmRpdilcbiAgfVxuXG4gIGFwcGVuZEJvdEJveCAoZGl2OiBQYWdlRWxlbWVudCkge1xuICAgIGNvbnN0IHsgcGFnZTogeyBib3haZXJvLCBib3hPbmUgfSwgdHdvQ29sdW1uIH0gPSB0aGlzXG4gICAgY29uc3QgdXNlWmVyb3RoID0gIXR3b0NvbHVtbiB8fCAoYm94WmVyby5jaGlsZHJlbi5sZW5ndGggKyBib3hPbmUuY2hpbGRyZW4ubGVuZ3RoKSAlIDIgPT09IDBcbiAgICBjb25zdCBib3ggPSB1c2VaZXJvdGggPyBib3haZXJvIDogYm94T25lXG4gICAgYm94LmFwcGVuZChkaXYpXG4gIH1cblxuICBjbGVhckJvdEJveGVzICgpIHtcbiAgICBjb25zdCB7IHBhZ2U6IHsgYm94T25lLCBib3haZXJvIH0gfSA9IHRoaXNcbiAgICB3aGlsZSAoYm94WmVyby5jaGlsZHJlbi5sZW5ndGggPiAxKSBib3haZXJvLnJlbW92ZUNoaWxkKGJveFplcm8ubGFzdENoaWxkIGFzIEVsZW1lbnQpXG4gICAgd2hpbGUgKGJveE9uZS5jaGlsZHJlbi5sZW5ndGggPiAwKSBib3hPbmUucmVtb3ZlQ2hpbGQoYm94T25lLmxhc3RDaGlsZCBhcyBFbGVtZW50KVxuICB9XG5cbiAgc2hvd0JvdCAoYm90SUQ6IHN0cmluZykge1xuICAgIGNvbnN0IHsgc29ydGVkQm90cyB9ID0gdGhpc1xuICAgIGNvbnN0IGlkeCA9IHNvcnRlZEJvdHMuZmluZEluZGV4KChib3Q6IEJvdCkgPT4gYm90LmlkID09PSBib3RJRClcbiAgICBzb3J0ZWRCb3RzLnNwbGljZShpZHgsIDEpXG4gICAgc29ydGVkQm90cy51bnNoaWZ0KHRoaXMuYm90c1tib3RJRF0pXG4gICAgdGhpcy5jbGVhckJvdEJveGVzKClcbiAgICBmb3IgKGNvbnN0IHsgZGl2IH0gb2Ygc29ydGVkQm90cykgdGhpcy5hcHBlbmRCb3RCb3goZGl2KVxuICAgIGNvbnN0IGRpdiA9IHRoaXMuYm90c1tib3RJRF0uZGl2XG4gICAgRG9jLmFuaW1hdGUoMjUwLCAocDogbnVtYmVyKSA9PiB7XG4gICAgICBkaXYuc3R5bGUub3BhY2l0eSA9IGAke3B9YFxuICAgICAgZGl2LnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgkezAuOCArIDAuMiAqIHB9KWBcbiAgICB9KVxuICB9XG5cbiAgbmV3Qm90ICgpIHtcbiAgICBhcHAoKS5sb2FkUGFnZSgnbW1zZXR0aW5ncycpXG4gIH1cblxuICBhc3luYyBjZXhDb25maWd1cmVkIChjZXhOYW1lOiBzdHJpbmcpIHtcbiAgICBhd2FpdCBhcHAoKS5mZXRjaE1NU3RhdHVzKClcbiAgICB0aGlzLnVwZGF0ZUNleFJvdyh0aGlzLmNleGVzW2NleE5hbWVdKVxuICAgIHRoaXMuZm9ybXMuY2xvc2UoKVxuICB9XG5cbiAgdXBkYXRlQ2V4Um93IChyb3c6IENFWFJvdykge1xuICAgIGNvbnN0IHsgdG1wbCwgZGluZm8sIGNleE5hbWUgfSA9IHJvd1xuICAgIHRtcGwubG9nby5zcmMgPSBkaW5mby5sb2dvXG4gICAgdG1wbC5uYW1lLnRleHRDb250ZW50ID0gZGluZm8ubmFtZVxuICAgIGNvbnN0IHN0YXR1cyA9IGFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWVdXG4gICAgRG9jLnNldFZpcyghc3RhdHVzLCB0bXBsLnVuY29uZmlndXJlZClcbiAgICBEb2Muc2V0VmlzKHN0YXR1cyAmJiAhc3RhdHVzLmNvbm5lY3RFcnIsIHRtcGwuY29uZmlndXJlZClcbiAgICBEb2Muc2V0VmlzKHN0YXR1cz8uY29ubmVjdEVyciwgdG1wbC5jb25uZWN0RXJyQm94KVxuICAgIGlmIChzdGF0dXM/LmNvbm5lY3RFcnIpIHtcbiAgICAgIHRtcGwuY29ubmVjdEVyci50ZXh0Q29udGVudCA9ICdjb25uZWN0aW9uIGVycm9yJ1xuICAgICAgdG1wbC5jb25uZWN0RXJyLmRhdGFzZXQudG9vbHRpcCA9IHN0YXR1cy5jb25uZWN0RXJyXG4gICAgfVxuICAgIHRtcGwubG9nby5jbGFzc0xpc3QudG9nZ2xlKCdncmV5c2NhbGUnLCAhc3RhdHVzKVxuICAgIGlmICghc3RhdHVzKSByZXR1cm5cbiAgICBsZXQgdXNkQmFsID0gMFxuICAgIGNvbnN0IGNleFN5bWJvbEFkZGVkIDogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4gPSB7fSAvLyBhdm9pZCBkb3VibGUgY291bnRpbmcgdG9rZW5zIG9yIGNvdW50aW5nIGJvdGggZXRoIGFuZCB3ZXRoXG4gICAgZm9yIChjb25zdCBbYXNzZXRJRFN0ciwgYmFsXSBvZiBPYmplY3QuZW50cmllcyhzdGF0dXMuYmFsYW5jZXMpKSB7XG4gICAgICBjb25zdCBhc3NldElEID0gcGFyc2VJbnQoYXNzZXRJRFN0cilcbiAgICAgIGNvbnN0IGNleFN5bWJvbCA9IERvYy5iaXBDRVhTeW1ib2woYXNzZXRJRClcbiAgICAgIGlmIChjZXhTeW1ib2xBZGRlZFtjZXhTeW1ib2xdKSBjb250aW51ZVxuICAgICAgY2V4U3ltYm9sQWRkZWRbY2V4U3ltYm9sXSA9IHRydWVcbiAgICAgIGNvbnN0IHsgdW5pdEluZm8gfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgICAgY29uc3QgZmlhdFJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICAgIGlmIChmaWF0UmF0ZSkgdXNkQmFsICs9IGZpYXRSYXRlICogKGJhbC5hdmFpbGFibGUgKyBiYWwubG9ja2VkKSAvIHVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgfVxuICAgIHRtcGwudXNkQmFsYW5jZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyh1c2RCYWwpXG4gIH1cblxuICBwZXJjZW50YWdlQmFsYW5jZVN0ciAoYXNzZXRJRDogbnVtYmVyLCBiYWxhbmNlOiBudW1iZXIsIHBlcmNlbnRhZ2U6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICBjb25zdCB1bml0SW5mbyA9IGFzc2V0LnVuaXRJbmZvXG4gICAgY29uc3QgYXNzZXRWYWx1ZSA9IERvYy5mb3JtYXRDb2luVmFsdWUoKGJhbGFuY2UgKiBwZXJjZW50YWdlKSAvIDEwMCwgdW5pdEluZm8pXG4gICAgcmV0dXJuIGAke0RvYy5mb3JtYXRGb3VyU2lnRmlncyhwZXJjZW50YWdlKX0lIC0gJHthc3NldFZhbHVlfSAke2Fzc2V0LnN5bWJvbC50b1VwcGVyQ2FzZSgpfWBcbiAgfVxuXG4gIC8qXG4gICAqIHdhbGxldEJhbGFuY2VTdHIgcmV0dXJucyBhIHN0cmluZyBsaWtlIFwiNTAlIC0gMC4wMDAxIEJUQ1wiIHJlcHJlc2VudGluZ1xuICAgKiB0aGUgcGVyY2VudGFnZSBvZiBhIHdhbGxldCdzIGJhbGFuY2Ugc2VsZWN0ZWQgaW4gdGhlIG1hcmtldCBtYWtlciBzZXR0aW5nLFxuICAgKiBhbmQgdGhlIGFtb3VudCBvZiB0aGF0IGFzc2V0IGluIHRoZSB3YWxsZXQuXG4gICAqL1xuICB3YWxsZXRCYWxhbmNlU3RyIChhc3NldElEOiBudW1iZXIsIHBlcmNlbnRhZ2U6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgeyB3YWxsZXQ6IHsgYmFsYW5jZTogeyBhdmFpbGFibGUgfSB9IH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICByZXR1cm4gdGhpcy5wZXJjZW50YWdlQmFsYW5jZVN0cihhc3NldElELCBhdmFpbGFibGUsIHBlcmNlbnRhZ2UpXG4gIH1cbn1cblxuaW50ZXJmYWNlIEJvdFJvdyB7XG4gIHRyOiBQYWdlRWxlbWVudFxuICB0bXBsOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbn1cblxuY2xhc3MgQm90IGV4dGVuZHMgQm90TWFya2V0IHtcbiAgcGc6IE1hcmtldE1ha2VyUGFnZVxuICBkaXY6IFBhZ2VFbGVtZW50XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBwbGFjZW1lbnRzQ2hhcnQ6IFBsYWNlbWVudHNDaGFydFxuICBiYXNlQWxsb2NTbGlkZXI6IE1pbmlTbGlkZXJcbiAgcXVvdGVBbGxvY1NsaWRlcjogTWluaVNsaWRlclxuICByb3c6IEJvdFJvd1xuICBydW5EaXNwbGF5OiBSdW5uaW5nTWFya2V0TWFrZXJEaXNwbGF5XG5cbiAgY29uc3RydWN0b3IgKHBnOiBNYXJrZXRNYWtlclBhZ2UsIHN0YXR1czogTU1Cb3RTdGF0dXMsIHN0YXJ0dXBCYWxhbmNlQ2FjaGU/OiBSZWNvcmQ8bnVtYmVyLCBQcm9taXNlPEV4Y2hhbmdlQmFsYW5jZT4+KSB7XG4gICAgc3VwZXIoc3RhdHVzLmNvbmZpZylcbiAgICBzdGFydHVwQmFsYW5jZUNhY2hlID0gc3RhcnR1cEJhbGFuY2VDYWNoZSA/PyB7fVxuICAgIHRoaXMucGcgPSBwZ1xuICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlELCBob3N0LCBib3RUeXBlLCBuQnV5UGxhY2VtZW50cywgblNlbGxQbGFjZW1lbnRzLCBjZXhOYW1lIH0gPSB0aGlzXG4gICAgdGhpcy5pZCA9IGhvc3RlZE1hcmtldElEKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcblxuICAgIGNvbnN0IGRpdiA9IHRoaXMuZGl2ID0gcGcucGFnZS5ib3RUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG5cbiAgICB0aGlzLnJ1bkRpc3BsYXkgPSBuZXcgUnVubmluZ01hcmtldE1ha2VyRGlzcGxheShwYWdlLm9uQm94LCBwZy5mb3JtcywgcGcucGFnZS5vcmRlclJlcG9ydEZvcm0sICdtbScpXG5cbiAgICBzZXRNYXJrZXRFbGVtZW50cyhkaXYsIGJhc2VJRCwgcXVvdGVJRCwgaG9zdClcbiAgICBpZiAoY2V4TmFtZSkgc2V0Q2V4RWxlbWVudHMoZGl2LCBjZXhOYW1lKVxuXG4gICAgaWYgKGJvdFR5cGUgPT09IGJvdFR5cGVBcmJNTSkge1xuICAgICAgcGFnZS5ib3RUeXBlRGlzcGxheS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0JPVFRZUEVfQVJCX01NKVxuICAgIH0gZWxzZSBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICBwYWdlLmJvdFR5cGVEaXNwbGF5LnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQk9UVFlQRV9TSU1QTEVfQVJCKVxuICAgIH0gZWxzZSBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljTU0pIHtcbiAgICAgIHBhZ2UuYm90VHlwZURpc3BsYXkudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9CT1RUWVBFX0JBU0lDX01NKVxuICAgIH1cblxuICAgIERvYy5zZXRWaXMoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiLCBwYWdlLnBsYWNlbWVudHNDaGFydEJveCwgcGFnZS5iYXNlVG9rZW5Td2FwRmVlc0JveClcbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICB0aGlzLnBsYWNlbWVudHNDaGFydCA9IG5ldyBQbGFjZW1lbnRzQ2hhcnQocGFnZS5wbGFjZW1lbnRzQ2hhcnQpXG4gICAgICBwYWdlLmJ1eVBsYWNlbWVudENvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKG5CdXlQbGFjZW1lbnRzKVxuICAgICAgcGFnZS5zZWxsUGxhY2VtZW50Q291bnQudGV4dENvbnRlbnQgPSBTdHJpbmcoblNlbGxQbGFjZW1lbnRzKVxuICAgIH1cblxuICAgIERvYy5iaW5kKHBhZ2Uuc3RhcnRCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLnN0YXJ0KCkpXG4gICAgRG9jLmJpbmQocGFnZS5hbGxvY2F0aW9uQnR0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5hbGxvY2F0ZSgpKVxuICAgIERvYy5iaW5kKHBhZ2UucmVjb25maWd1cmVCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLnJlY29uZmlndXJlKCkpXG4gICAgRG9jLmJpbmQocGFnZS5nb0JhY2tGcm9tQWxsb2NhdGlvbiwgJ2NsaWNrJywgKCkgPT4gdGhpcy5oaWRlQWxsb2NhdGlvbkRpYWxvZygpKVxuICAgIERvYy5iaW5kKHBhZ2UubWFya2V0TGluaywgJ2NsaWNrJywgKCkgPT4gYXBwKCkubG9hZFBhZ2UoJ21hcmtldHMnLCB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCB9KSlcblxuICAgIHRoaXMuYmFzZUFsbG9jU2xpZGVyID0gbmV3IE1pbmlTbGlkZXIocGFnZS5iYXNlQWxsb2NTbGlkZXIsICgpID0+IHsgLyogY2FsbGJhY2sgc2V0IGxhdGVyICovIH0pXG4gICAgdGhpcy5xdW90ZUFsbG9jU2xpZGVyID0gbmV3IE1pbmlTbGlkZXIocGFnZS5xdW90ZUFsbG9jU2xpZGVyLCAoKSA9PiB7IC8qIGNhbGxiYWNrIHNldCBsYXRlciAqLyB9KVxuXG4gICAgY29uc3QgdHIgPSBwZy5wYWdlLmJvdFJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgc2V0TWFya2V0RWxlbWVudHModHIsIGJhc2VJRCwgcXVvdGVJRCwgaG9zdClcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodHIpXG4gICAgdGhpcy5yb3cgPSB7IHRyLCB0bXBsIH1cbiAgICBEb2MuYmluZCh0bXBsLmFsbG9jYXRlQnR0biwgJ2NsaWNrJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIHRoaXMuYWxsb2NhdGUoKVxuICAgICAgcGcuc2hvd0JvdCh0aGlzLmlkKVxuICAgIH0pXG4gICAgRG9jLmJpbmQodHIsICdjbGljaycsICgpID0+IHBnLnNob3dCb3QodGhpcy5pZCkpXG5cbiAgICB0aGlzLmluaXRpYWxpemUoc3RhcnR1cEJhbGFuY2VDYWNoZSlcbiAgfVxuXG4gIGFzeW5jIGluaXRpYWxpemUgKHN0YXJ0dXBCYWxhbmNlQ2FjaGU6IFJlY29yZDxudW1iZXIsIFByb21pc2U8RXhjaGFuZ2VCYWxhbmNlPj4pIHtcbiAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHN0YXJ0dXBCYWxhbmNlQ2FjaGUpXG4gICAgdGhpcy5ydW5EaXNwbGF5LnNldEJvdE1hcmtldCh0aGlzKVxuICAgIGNvbnN0IHtcbiAgICAgIHBhZ2UsIGhvc3QsIGNleE5hbWUsIGJvdFR5cGUsIGRpdixcbiAgICAgIGNmZzogeyBhcmJNYXJrZXRNYWtpbmdDb25maWcsIGJhc2ljTWFya2V0TWFraW5nQ29uZmlnIH0sIG1rdElELFxuICAgICAgYmFzZUZhY3RvciwgcXVvdGVGYWN0b3IsIG1hcmtldFJlcG9ydDogeyBiYXNlRmlhdFJhdGUgfVxuICAgIH0gPSB0aGlzXG5cbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICBsZXQgYnV5UGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXSA9IFtdXG4gICAgICBsZXQgc2VsbFBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W10gPSBbXVxuICAgICAgbGV0IHByb2ZpdCA9IDBcbiAgICAgIGlmIChhcmJNYXJrZXRNYWtpbmdDb25maWcpIHtcbiAgICAgICAgYnV5UGxhY2VtZW50cyA9IGFyYk1hcmtldE1ha2luZ0NvbmZpZy5idXlQbGFjZW1lbnRzLm1hcCgocCkgPT4gKHsgbG90czogcC5sb3RzLCBnYXBGYWN0b3I6IHAubXVsdGlwbGllciB9KSlcbiAgICAgICAgc2VsbFBsYWNlbWVudHMgPSBhcmJNYXJrZXRNYWtpbmdDb25maWcuc2VsbFBsYWNlbWVudHMubWFwKChwKSA9PiAoeyBsb3RzOiBwLmxvdHMsIGdhcEZhY3RvcjogcC5tdWx0aXBsaWVyIH0pKVxuICAgICAgICBwcm9maXQgPSBhcmJNYXJrZXRNYWtpbmdDb25maWcucHJvZml0XG4gICAgICB9IGVsc2UgaWYgKGJhc2ljTWFya2V0TWFraW5nQ29uZmlnKSB7XG4gICAgICAgIGJ1eVBsYWNlbWVudHMgPSBiYXNpY01hcmtldE1ha2luZ0NvbmZpZy5idXlQbGFjZW1lbnRzXG4gICAgICAgIHNlbGxQbGFjZW1lbnRzID0gYmFzaWNNYXJrZXRNYWtpbmdDb25maWcuc2VsbFBsYWNlbWVudHNcbiAgICAgICAgbGV0IGJlc3RCdXk6IE9yZGVyUGxhY2VtZW50IHwgdW5kZWZpbmVkXG4gICAgICAgIGxldCBiZXN0U2VsbCA6IE9yZGVyUGxhY2VtZW50IHwgdW5kZWZpbmVkXG4gICAgICAgIGlmIChidXlQbGFjZW1lbnRzLmxlbmd0aCA+IDApIGJlc3RCdXkgPSBidXlQbGFjZW1lbnRzLnJlZHVjZSgocHJldjogT3JkZXJQbGFjZW1lbnQsIGN1cnI6IE9yZGVyUGxhY2VtZW50KSA9PiBjdXJyLmdhcEZhY3RvciA8IHByZXYuZ2FwRmFjdG9yID8gY3VyciA6IHByZXYpXG4gICAgICAgIGlmIChzZWxsUGxhY2VtZW50cy5sZW5ndGggPiAwKSBiZXN0U2VsbCA9IHNlbGxQbGFjZW1lbnRzLnJlZHVjZSgocHJldjogT3JkZXJQbGFjZW1lbnQsIGN1cnI6IE9yZGVyUGxhY2VtZW50KSA9PiBjdXJyLmdhcEZhY3RvciA8IHByZXYuZ2FwRmFjdG9yID8gY3VyciA6IHByZXYpXG4gICAgICAgIGlmIChiZXN0QnV5ICYmIGJlc3RTZWxsKSB7XG4gICAgICAgICAgcHJvZml0ID0gKGJlc3RCdXkuZ2FwRmFjdG9yICsgYmVzdFNlbGwuZ2FwRmFjdG9yKSAvIDJcbiAgICAgICAgfSBlbHNlIGlmIChiZXN0QnV5KSB7XG4gICAgICAgICAgcHJvZml0ID0gYmVzdEJ1eS5nYXBGYWN0b3JcbiAgICAgICAgfSBlbHNlIGlmIChiZXN0U2VsbCkge1xuICAgICAgICAgIHByb2ZpdCA9IGJlc3RTZWxsLmdhcEZhY3RvclxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBtYXJrZXRDb25maWcgPSB7IGNleE5hbWU6IGNleE5hbWUgYXMgc3RyaW5nLCBib3RUeXBlLCBiYXNlRmlhdFJhdGU6IGJhc2VGaWF0UmF0ZSwgZGljdDogeyBwcm9maXQsIGJ1eVBsYWNlbWVudHMsIHNlbGxQbGFjZW1lbnRzIH0gfVxuICAgICAgdGhpcy5wbGFjZW1lbnRzQ2hhcnQuc2V0TWFya2V0KG1hcmtldENvbmZpZylcbiAgICB9XG5cbiAgICBEb2Muc2V0VmlzKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NLCBwYWdlLmNleERhdGFCb3gpXG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NKSB7XG4gICAgICBjb25zdCBjZXggPSBhcHAoKS5tbVN0YXR1cy5jZXhlc1tjZXhOYW1lXVxuICAgICAgaWYgKGNleCkge1xuICAgICAgICBjb25zdCBta3QgPSBjZXgubWFya2V0cyA/IGNleC5tYXJrZXRzW21rdElEXSA6IHVuZGVmaW5lZFxuICAgICAgICBEb2Muc2V0VmlzKG1rdD8uZGF5LCBwYWdlLmNleERhdGFCb3gpXG4gICAgICAgIGlmIChta3Q/LmRheSkge1xuICAgICAgICAgIGNvbnN0IGRheSA9IG1rdC5kYXlcbiAgICAgICAgICBwYWdlLmNleFByaWNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGRheS5sYXN0UHJpY2UpXG4gICAgICAgICAgcGFnZS5jZXhWb2wudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYmFzZUZpYXRSYXRlICogZGF5LnZvbClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBEb2Muc2V0VmlzKEJvb2xlYW4oY2V4TmFtZSksIC4uLkRvYy5hcHBseVNlbGVjdG9yKGRpdiwgJ1tkYXRhLWNleC1zaG93XScpKVxuXG4gICAgY29uc3QgeyBzcG90IH0gPSBhcHAoKS5leGNoYW5nZXNbaG9zdF0ubWFya2V0c1tta3RJRF1cbiAgICBpZiAoc3BvdCkge1xuICAgICAgRG9jLnNob3cocGFnZS5kZXhEYXRhQm94KVxuICAgICAgY29uc3QgYyA9IE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgLyBiYXNlRmFjdG9yICogcXVvdGVGYWN0b3JcbiAgICAgIHBhZ2UuZGV4UHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moc3BvdC5yYXRlIC8gYylcbiAgICAgIHBhZ2UuZGV4Vm9sLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHNwb3Qudm9sMjQgLyBiYXNlRmFjdG9yICogYmFzZUZpYXRSYXRlKVxuICAgIH1cblxuICAgIHRoaXMudXBkYXRlRGlzcGxheSgpXG4gICAgdGhpcy51cGRhdGVUYWJsZVJvdygpXG4gICAgRG9jLmhpZGUocGFnZS5sb2FkaW5nQmcpXG4gIH1cblxuICB1cGRhdGVUYWJsZVJvdyAoKSB7XG4gICAgY29uc3QgeyByb3c6IHsgdG1wbCB9IH0gPSB0aGlzXG4gICAgY29uc3QgeyBydW5uaW5nLCBydW5TdGF0cyB9ID0gdGhpcy5zdGF0dXMoKVxuICAgIERvYy5zZXRWaXMocnVubmluZywgdG1wbC5wcm9maXRMb3NzQm94KVxuICAgIERvYy5zZXRWaXMoIXJ1bm5pbmcsIHRtcGwuYWxsb2NhdGVCdHRuQm94KVxuICAgIGlmIChydW5TdGF0cykge1xuICAgICAgdG1wbC5wcm9maXRMb3NzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHJ1blN0YXRzLnByb2ZpdExvc3MucHJvZml0LCAyKVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZURpc3BsYXkgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0UmVwb3J0OiB7IGJhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSB9LCBiYXNlRmVlRmlhdFJhdGUsIHF1b3RlRmVlRmlhdFJhdGUgfSA9IHRoaXNcbiAgICBpZiAoW2Jhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSwgYmFzZUZlZUZpYXRSYXRlLCBxdW90ZUZlZUZpYXRSYXRlXS5zb21lKChyOiBudW1iZXIpID0+ICFyKSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5vbkJveCwgcGFnZS5vZmZCb3gpXG4gICAgICBEb2Muc2hvdyhwYWdlLm5vRmlhdERpc3BsYXkpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgeyBydW5uaW5nIH0gPSB0aGlzLnN0YXR1cygpXG4gICAgRG9jLnNldFZpcyhydW5uaW5nLCBwYWdlLm9uQm94KVxuICAgIERvYy5zZXRWaXMoIXJ1bm5pbmcsIHBhZ2Uub2ZmQm94KVxuICAgIGlmIChydW5uaW5nKSB0aGlzLnVwZGF0ZVJ1bm5pbmdEaXNwbGF5KClcbiAgICBlbHNlIHRoaXMudXBkYXRlSWRsZURpc3BsYXkoKVxuICB9XG5cbiAgdXBkYXRlUnVubmluZ0Rpc3BsYXkgKCkge1xuICAgIHRoaXMucnVuRGlzcGxheS51cGRhdGUoKVxuICB9XG5cbiAgdXBkYXRlSWRsZURpc3BsYXkgKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHBhZ2UsIHByb2o6IHsgYWxsb2MsIHFQcm9qLCBiUHJvaiB9LCBiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUsIGJ1aSwgcXVpLCBiYXNlRmVlSUQsXG4gICAgICBxdW90ZUZlZUlELCBiYXNlRmFjdG9yLCBxdW90ZUZhY3RvciwgYmFzZUZlZUZhY3RvciwgcXVvdGVGZWVGYWN0b3IsXG4gICAgICBtYXJrZXRSZXBvcnQ6IHsgYmFzZUZpYXRSYXRlLCBxdW90ZUZpYXRSYXRlIH0sIGNmZzogeyB1aUNvbmZpZzogeyBiYXNlQ29uZmlnLCBxdW90ZUNvbmZpZyB9IH0sXG4gICAgICBxdW90ZUZlZVVJLCBiYXNlRmVlVUlcbiAgICB9ID0gdGhpc1xuICAgIHBhZ2UuYmFzZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oYWxsb2NbYmFzZUlEXSwgYnVpKVxuICAgIGNvbnN0IGJhc2VVU0QgPSBhbGxvY1tiYXNlSURdIC8gYmFzZUZhY3RvciAqIGJhc2VGaWF0UmF0ZVxuICAgIGxldCB0b3RhbFVTRCA9IGJhc2VVU0RcbiAgICBwYWdlLmJhc2VBbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhiYXNlVVNEKVxuICAgIHBhZ2UuYmFzZUJvb2tBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGJQcm9qLmJvb2sgKiBiYXNlRmFjdG9yLCBidWkpXG4gICAgcGFnZS5iYXNlT3JkZXJSZXNlcnZlc0FsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oYlByb2oub3JkZXJSZXNlcnZlcyAqIGJhc2VGYWN0b3IsIGJ1aSlcbiAgICBwYWdlLmJhc2VPcmRlclJlc2VydmVzUGN0LnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQoYmFzZUNvbmZpZy5vcmRlclJlc2VydmVzRmFjdG9yICogMTAwKSlcbiAgICBEb2Muc2V0VmlzKGNleE5hbWUsIHBhZ2UuYmFzZUNleEFsbG9jQm94KVxuICAgIGlmIChjZXhOYW1lKSBwYWdlLmJhc2VDZXhBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGJQcm9qLmNleCAqIGJhc2VGYWN0b3IsIGJ1aSlcbiAgICBEb2Muc2V0VmlzKGJhc2VGZWVJRCA9PT0gYmFzZUlELCBwYWdlLmJhc2VCb29raW5nRmVlc0FsbG9jQm94KVxuICAgIERvYy5zZXRWaXMoYmFzZUZlZUlEICE9PSBiYXNlSUQsIHBhZ2UuYmFzZVRva2VuRmVlc0FsbG9jQm94KVxuICAgIGlmIChiYXNlRmVlSUQgPT09IGJhc2VJRCkge1xuICAgICAgY29uc3QgYm9va2luZ0ZlZXMgPSBiYXNlSUQgPT09IHF1b3RlRmVlSUQgPyBiUHJvai5ib29raW5nRmVlcyArIHFQcm9qLmJvb2tpbmdGZWVzIDogYlByb2ouYm9va2luZ0ZlZXNcbiAgICAgIHBhZ2UuYmFzZUJvb2tpbmdGZWVzQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihib29raW5nRmVlcyAqIGJhc2VGZWVGYWN0b3IsIGJhc2VGZWVVSSlcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZmVlQWxsb2MgPSBhbGxvY1tiYXNlRmVlSURdXG4gICAgICBwYWdlLmJhc2VUb2tlbkZlZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oZmVlQWxsb2MsIGJhc2VGZWVVSSlcbiAgICAgIGNvbnN0IGJhc2VGZWVVU0QgPSBmZWVBbGxvYyAvIGJhc2VGZWVGYWN0b3IgKiBhcHAoKS5maWF0UmF0ZXNNYXBbYmFzZUZlZUlEXVxuICAgICAgdG90YWxVU0QgKz0gYmFzZUZlZVVTRFxuICAgICAgcGFnZS5iYXNlVG9rZW5BbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhiYXNlRmVlVVNEKVxuICAgICAgY29uc3Qgd2l0aFF1b3RlID0gYmFzZUZlZUlEID09PSBxdW90ZUZlZUlEXG4gICAgICBjb25zdCBib29raW5nRmVlcyA9IGJQcm9qLmJvb2tpbmdGZWVzICsgKHdpdGhRdW90ZSA/IHFQcm9qLmJvb2tpbmdGZWVzIDogMClcbiAgICAgIHBhZ2UuYmFzZVRva2VuQm9va2luZ0ZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihib29raW5nRmVlcyAqIGJhc2VGZWVGYWN0b3IsIGJhc2VGZWVVSSlcbiAgICAgIHBhZ2UuYmFzZVRva2VuU3dhcEZlZU4udGV4dENvbnRlbnQgPSBTdHJpbmcoYmFzZUNvbmZpZy5zd2FwRmVlTiArICh3aXRoUXVvdGUgPyBxdW90ZUNvbmZpZy5zd2FwRmVlTiA6IDApKVxuICAgICAgY29uc3Qgc3dhcFJlc2VydmVzID0gYlByb2ouc3dhcEZlZVJlc2VydmVzICsgKHdpdGhRdW90ZSA/IHFQcm9qLnN3YXBGZWVSZXNlcnZlcyA6IDApXG4gICAgICBwYWdlLmJhc2VUb2tlblN3YXBGZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oc3dhcFJlc2VydmVzICogYmFzZUZlZUZhY3RvciwgYmFzZUZlZVVJKVxuICAgIH1cblxuICAgIHBhZ2UucXVvdGVBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGFsbG9jW3F1b3RlSURdLCBxdWkpXG4gICAgY29uc3QgcXVvdGVVU0QgPSBhbGxvY1txdW90ZUlEXSAvIHF1b3RlRmFjdG9yICogcXVvdGVGaWF0UmF0ZVxuICAgIHRvdGFsVVNEICs9IHF1b3RlVVNEXG4gICAgcGFnZS5xdW90ZUFsbG9jVVNELnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHF1b3RlVVNEKVxuICAgIHBhZ2UucXVvdGVCb29rQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihxUHJvai5ib29rICogcXVvdGVGYWN0b3IsIHF1aSlcbiAgICBwYWdlLnF1b3RlT3JkZXJSZXNlcnZlc0FsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24ocVByb2oub3JkZXJSZXNlcnZlcyAqIHF1b3RlRmFjdG9yLCBxdWkpXG4gICAgcGFnZS5xdW90ZU9yZGVyUmVzZXJ2ZXNQY3QudGV4dENvbnRlbnQgPSBTdHJpbmcoTWF0aC5yb3VuZChxdW90ZUNvbmZpZy5vcmRlclJlc2VydmVzRmFjdG9yICogMTAwKSlcbiAgICBwYWdlLnF1b3RlU2xpcHBhZ2VBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHFQcm9qLnNsaXBwYWdlQnVmZmVyICogcXVvdGVGYWN0b3IsIHF1aSlcbiAgICBwYWdlLnNsaXBwYWdlQnVmZmVyRmFjdG9yLnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQocXVvdGVDb25maWcuc2xpcHBhZ2VCdWZmZXJGYWN0b3IgKiAxMDApKVxuICAgIERvYy5zZXRWaXMoY2V4TmFtZSwgcGFnZS5xdW90ZUNleEFsbG9jQm94KVxuICAgIGlmIChjZXhOYW1lKSBwYWdlLnF1b3RlQ2V4QWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihxUHJvai5jZXggKiBxdW90ZUZhY3RvciwgcXVpKVxuICAgIERvYy5zZXRWaXMocXVvdGVJRCA9PT0gcXVvdGVGZWVJRCwgcGFnZS5xdW90ZUJvb2tpbmdGZWVzQWxsb2NCb3gpXG4gICAgRG9jLnNldFZpcyhxdW90ZUZlZUlEICE9PSBxdW90ZUlEICYmIHF1b3RlRmVlSUQgIT09IGJhc2VGZWVJRCwgcGFnZS5xdW90ZVRva2VuRmVlc0FsbG9jQm94KVxuICAgIGlmIChxdW90ZUlEID09PSBxdW90ZUZlZUlEKSB7XG4gICAgICBjb25zdCBib29raW5nRmVlcyA9IHF1b3RlSUQgPT09IGJhc2VGZWVJRCA/IGJQcm9qLmJvb2tpbmdGZWVzICsgcVByb2ouYm9va2luZ0ZlZXMgOiBxUHJvai5ib29raW5nRmVlc1xuICAgICAgcGFnZS5xdW90ZUJvb2tpbmdGZWVzQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihib29raW5nRmVlcyAqIHF1b3RlRmVlRmFjdG9yLCBxdW90ZUZlZVVJKVxuICAgIH0gZWxzZSBpZiAocXVvdGVGZWVJRCAhPT0gYmFzZUZlZUlEKSB7XG4gICAgICBwYWdlLnF1b3RlVG9rZW5GZWVBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGFsbG9jW3F1b3RlRmVlSURdLCBxdW90ZUZlZVVJKVxuICAgICAgY29uc3QgcXVvdGVGZWVVU0QgPSBhbGxvY1txdW90ZUZlZUlEXSAvIHF1b3RlRmVlRmFjdG9yICogYXBwKCkuZmlhdFJhdGVzTWFwW3F1b3RlRmVlSURdXG4gICAgICB0b3RhbFVTRCArPSBxdW90ZUZlZVVTRFxuICAgICAgcGFnZS5xdW90ZVRva2VuQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocXVvdGVGZWVVU0QpXG4gICAgICBwYWdlLnF1b3RlVG9rZW5Cb29raW5nRmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHFQcm9qLmJvb2tpbmdGZWVzICogcXVvdGVGZWVGYWN0b3IsIHF1b3RlRmVlVUkpXG4gICAgICBwYWdlLnF1b3RlVG9rZW5Td2FwRmVlTi50ZXh0Q29udGVudCA9IFN0cmluZyhxdW90ZUNvbmZpZy5zd2FwRmVlTilcbiAgICAgIHBhZ2UucXVvdGVUb2tlblN3YXBGZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24ocVByb2ouc3dhcEZlZVJlc2VydmVzICogcXVvdGVGZWVGYWN0b3IsIHF1b3RlRmVlVUkpXG4gICAgfVxuICAgIHBhZ2UudG90YWxBbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyh0b3RhbFVTRClcbiAgfVxuXG4gIC8qXG4gICAqIGFsbG9jYXRlIG9wZW5zIGEgZGlhbG9nIHRvIGNob29zZSBmdW5kaW5nIHNvdXJjZXMgKGlmIGFwcGxpY2FibGUpIGFuZFxuICAgKiBjb25maXJtIGFsbG9jYXRpb25zIGFuZCBzdGFydCB0aGUgYm90LlxuICAgKi9cbiAgYWxsb2NhdGUgKCkge1xuICAgIGNvbnN0IGYgPSB0aGlzLmZ1bmRpbmdTdGF0ZSgpXG4gICAgY29uc3Qge1xuICAgICAgcGFnZSwgbWFya2V0UmVwb3J0OiB7IGJhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSB9LCBiYXNlSUQsIHF1b3RlSUQsXG4gICAgICBiYXNlRmVlSUQsIHF1b3RlRmVlSUQsIGJhc2VGZWVGaWF0UmF0ZSwgcXVvdGVGZWVGaWF0UmF0ZSwgY2V4TmFtZSxcbiAgICAgIGJhc2VGYWN0b3IsIHF1b3RlRmFjdG9yLCBiYXNlRmVlRmFjdG9yLCBxdW90ZUZlZUZhY3RvciwgaG9zdCwgbWt0SURcbiAgICB9ID0gdGhpc1xuXG4gICAgY29uc3QgW3Byb3Bvc2VkRGV4QmFzZSwgcHJvcG9zZWRDZXhCYXNlLCBiYXNlU2xpZGVyXSA9IHBhcnNlRnVuZGluZ09wdGlvbnMoZi5iYXNlKVxuICAgIGNvbnN0IFtwcm9wb3NlZERleFF1b3RlLCBwcm9wb3NlZENleFF1b3RlLCBxdW90ZVNsaWRlcl0gPSBwYXJzZUZ1bmRpbmdPcHRpb25zKGYucXVvdGUpXG5cbiAgICBjb25zdCBhbGxvYyA9IHRoaXMuYWxsb2MgPSB7XG4gICAgICBkZXg6IHtcbiAgICAgICAgW2Jhc2VJRF06IHByb3Bvc2VkRGV4QmFzZSAqIGJhc2VGYWN0b3IsXG4gICAgICAgIFtxdW90ZUlEXTogcHJvcG9zZWREZXhRdW90ZSAqIHF1b3RlRmFjdG9yXG4gICAgICB9LFxuICAgICAgY2V4OiB7XG4gICAgICAgIFtiYXNlSURdOiBwcm9wb3NlZENleEJhc2UgKiBiYXNlRmFjdG9yLFxuICAgICAgICBbcXVvdGVJRF06IHByb3Bvc2VkQ2V4UXVvdGUgKiBxdW90ZUZhY3RvclxuICAgICAgfVxuICAgIH1cblxuICAgIGFsbG9jLmRleFtiYXNlRmVlSURdID0gTWF0aC5taW4oKGFsbG9jLmRleFtiYXNlRmVlSURdID8/IDApICsgKGYuYmFzZS5mZWVzLnJlcSAqIGJhc2VGZWVGYWN0b3IpLCBmLmJhc2UuZmVlcy5hdmFpbCAqIGJhc2VGZWVGYWN0b3IpXG4gICAgYWxsb2MuZGV4W3F1b3RlRmVlSURdID0gTWF0aC5taW4oKGFsbG9jLmRleFtxdW90ZUZlZUlEXSA/PyAwKSArIChmLnF1b3RlLmZlZXMucmVxICogcXVvdGVGZWVGYWN0b3IpLCBmLnF1b3RlLmZlZXMuYXZhaWwgKiBxdW90ZUZlZUZhY3RvcilcblxuICAgIGxldCB0b3RhbFVTRCA9IChhbGxvYy5kZXhbYmFzZUlEXSAvIGJhc2VGYWN0b3IgKiBiYXNlRmlhdFJhdGUpICsgKGFsbG9jLmRleFtxdW90ZUlEXSAvIHF1b3RlRmFjdG9yICogcXVvdGVGaWF0UmF0ZSlcbiAgICB0b3RhbFVTRCArPSAoYWxsb2MuY2V4W2Jhc2VJRF0gLyBiYXNlRmFjdG9yICogYmFzZUZpYXRSYXRlKSArIChhbGxvYy5jZXhbcXVvdGVJRF0gLyBxdW90ZUZhY3RvciAqIHF1b3RlRmlhdFJhdGUpXG4gICAgaWYgKGJhc2VGZWVJRCAhPT0gYmFzZUlEKSB0b3RhbFVTRCArPSBhbGxvYy5kZXhbYmFzZUZlZUlEXSAvIGJhc2VGZWVGYWN0b3IgKiBiYXNlRmVlRmlhdFJhdGVcbiAgICBpZiAocXVvdGVGZWVJRCAhPT0gcXVvdGVJRCAmJiBxdW90ZUZlZUlEICE9PSBiYXNlRmVlSUQpIHRvdGFsVVNEICs9IGFsbG9jLmRleFtxdW90ZUZlZUlEXSAvIHF1b3RlRmVlRmFjdG9yICogcXVvdGVGZWVGaWF0UmF0ZVxuICAgIHBhZ2UuYWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModG90YWxVU0QpXG5cbiAgICBEb2Muc2V0VmlzKGNleE5hbWUsIC4uLkRvYy5hcHBseVNlbGVjdG9yKHBhZ2UuYWxsb2NhdGlvbkRpYWxvZywgJ1tkYXRhLWNleC1vbmx5XScpKVxuICAgIERvYy5zZXRWaXMoZi5mdW5kZWRBbmRCYWxhbmNlZCwgcGFnZS5mdW5kZWRBbmRCYWxhbmNlZEJveClcbiAgICBEb2Muc2V0VmlzKGYuYmFzZS50cmFuc2ZlcmFibGUgKyBmLnF1b3RlLnRyYW5zZmVyYWJsZSA+IDAsIHBhZ2UuaGFzVHJhbnNmZXJhYmxlKVxuICAgIERvYy5zZXRWaXMoZi5mdW5kZWRBbmROb3RCYWxhbmNlZCwgcGFnZS5mdW5kZWRBbmROb3RCYWxhbmNlZEJveClcbiAgICBEb2Muc2V0VmlzKGYuc3RhcnZlZCwgcGFnZS5zdGFydmVkQm94KVxuICAgIHBhZ2Uuc3RhcnRCdHRuLmNsYXNzTGlzdC50b2dnbGUoJ2dvJywgZi5mdW5kZWRBbmRCYWxhbmNlZClcbiAgICBwYWdlLnN0YXJ0QnR0bi5jbGFzc0xpc3QudG9nZ2xlKCd3YXJuaW5nJywgIWYuZnVuZGVkQW5kQmFsYW5jZWQpXG4gICAgcGFnZS5wcm9wb3NlZERleEJhc2VBbGxvYy5jbGFzc0xpc3QudG9nZ2xlKCd0ZXh0LXdhcm5pbmcnLCAhKGYuYmFzZS5mdW5kZWRBbmRCYWxhbmNlZCB8fCBmLmJhc2UuZnVuZGVkQW5kTm90QmFsYW5jZWQpKVxuICAgIHBhZ2UucHJvcG9zZWREZXhRdW90ZUFsbG9jLmNsYXNzTGlzdC50b2dnbGUoJ3RleHQtd2FybmluZycsICEoZi5xdW90ZS5mdW5kZWRBbmRCYWxhbmNlZCB8fCBmLnF1b3RlLmZ1bmRlZEFuZE5vdEJhbGFuY2VkKSlcblxuICAgIGNvbnN0IHNldEJhc2VQcm9wb3NhbCA9IChkZXg6IG51bWJlciwgY2V4OiBudW1iZXIpID0+IHtcbiAgICAgIHBhZ2UucHJvcG9zZWREZXhCYXNlQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4KVxuICAgICAgcGFnZS5wcm9wb3NlZERleEJhc2VBbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhkZXggKiBiYXNlRmlhdFJhdGUpXG4gICAgICBwYWdlLnByb3Bvc2VkQ2V4QmFzZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleClcbiAgICAgIHBhZ2UucHJvcG9zZWRDZXhCYXNlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoY2V4ICogYmFzZUZpYXRSYXRlKVxuICAgIH1cbiAgICBzZXRCYXNlUHJvcG9zYWwocHJvcG9zZWREZXhCYXNlLCBwcm9wb3NlZENleEJhc2UpXG5cbiAgICBEb2Muc2V0VmlzKGJhc2VTbGlkZXIsIHBhZ2UuYmFzZUFsbG9jU2xpZGVyKVxuICAgIGlmIChiYXNlU2xpZGVyKSB7XG4gICAgICBjb25zdCBkZXhSYW5nZSA9IGJhc2VTbGlkZXIucmlnaHQuZGV4IC0gYmFzZVNsaWRlci5sZWZ0LmRleFxuICAgICAgY29uc3QgY2V4UmFuZ2UgPSBiYXNlU2xpZGVyLnJpZ2h0LmNleCAtIGJhc2VTbGlkZXIubGVmdC5jZXhcbiAgICAgIHRoaXMuYmFzZUFsbG9jU2xpZGVyLnNldFZhbHVlKDAuNSlcbiAgICAgIHRoaXMuYmFzZUFsbG9jU2xpZGVyLmNoYW5nZWQgPSAocjogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IGRleEFsbG9jID0gYmFzZVNsaWRlci5sZWZ0LmRleCArIHIgKiBkZXhSYW5nZVxuICAgICAgICBjb25zdCBjZXhBbGxvYyA9IGJhc2VTbGlkZXIubGVmdC5jZXggKyByICogY2V4UmFuZ2VcbiAgICAgICAgYWxsb2MuZGV4W2Jhc2VJRF0gPSBkZXhBbGxvYyAqIGJhc2VGYWN0b3JcbiAgICAgICAgYWxsb2MuY2V4W2Jhc2VJRF0gPSBjZXhBbGxvYyAqIGJhc2VGYWN0b3JcbiAgICAgICAgc2V0QmFzZVByb3Bvc2FsKGRleEFsbG9jLCBjZXhBbGxvYylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZXRRdW90ZVByb3Bvc2FsID0gKGRleDogbnVtYmVyLCBjZXg6IG51bWJlcikgPT4ge1xuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4KVxuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4ICogcXVvdGVGaWF0UmF0ZSlcbiAgICAgIHBhZ2UucHJvcG9zZWRDZXhRdW90ZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleClcbiAgICAgIHBhZ2UucHJvcG9zZWRDZXhRdW90ZUFsbG9jVVNELnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleCAqIHF1b3RlRmlhdFJhdGUpXG4gICAgfVxuICAgIHNldFF1b3RlUHJvcG9zYWwocHJvcG9zZWREZXhRdW90ZSwgcHJvcG9zZWRDZXhRdW90ZSlcblxuICAgIERvYy5zZXRWaXMocXVvdGVTbGlkZXIsIHBhZ2UucXVvdGVBbGxvY1NsaWRlcilcbiAgICBpZiAocXVvdGVTbGlkZXIpIHtcbiAgICAgIGNvbnN0IGRleFJhbmdlID0gcXVvdGVTbGlkZXIucmlnaHQuZGV4IC0gcXVvdGVTbGlkZXIubGVmdC5kZXhcbiAgICAgIGNvbnN0IGNleFJhbmdlID0gcXVvdGVTbGlkZXIucmlnaHQuY2V4IC0gcXVvdGVTbGlkZXIubGVmdC5jZXhcbiAgICAgIHRoaXMucXVvdGVBbGxvY1NsaWRlci5zZXRWYWx1ZSgwLjUpXG4gICAgICB0aGlzLnF1b3RlQWxsb2NTbGlkZXIuY2hhbmdlZCA9IChyOiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgZGV4QWxsb2MgPSBxdW90ZVNsaWRlci5sZWZ0LmRleCArIHIgKiBkZXhSYW5nZVxuICAgICAgICBjb25zdCBjZXhBbGxvYyA9IHF1b3RlU2xpZGVyLmxlZnQuY2V4ICsgciAqIGNleFJhbmdlXG4gICAgICAgIGFsbG9jLmRleFtxdW90ZUlEXSA9IGRleEFsbG9jICogcXVvdGVGYWN0b3JcbiAgICAgICAgYWxsb2MuY2V4W3F1b3RlSURdID0gY2V4QWxsb2MgKiBxdW90ZUZhY3RvclxuICAgICAgICBzZXRRdW90ZVByb3Bvc2FsKGRleEFsbG9jLCBjZXhBbGxvYylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBEb2Muc2V0VmlzKGJhc2VGZWVJRCAhPT0gYmFzZUlELCAuLi5Eb2MuYXBwbHlTZWxlY3RvcihwYWdlLmFsbG9jYXRpb25EaWFsb2csICdbZGF0YS1iYXNlLXRva2VuLWZlZXNdJykpXG4gICAgaWYgKGJhc2VGZWVJRCAhPT0gYmFzZUlEKSB7XG4gICAgICBjb25zdCByZXFGZWVzID0gZi5iYXNlLmZlZXMucmVxICsgKGJhc2VGZWVJRCA9PT0gcXVvdGVGZWVJRCA/IGYucXVvdGUuZmVlcy5yZXEgOiAwKVxuICAgICAgY29uc3QgcHJvcG9zZWRGZWVzID0gTWF0aC5taW4ocmVxRmVlcywgZi5iYXNlLmZlZXMuYXZhaWwpXG4gICAgICBwYWdlLnByb3Bvc2VkRGV4QmFzZUZlZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHByb3Bvc2VkRmVlcylcbiAgICAgIHBhZ2UucHJvcG9zZWREZXhCYXNlRmVlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocHJvcG9zZWRGZWVzICogYmFzZUZlZUZpYXRSYXRlKVxuICAgICAgcGFnZS5wcm9wb3NlZERleEJhc2VGZWVBbGxvYy5jbGFzc0xpc3QudG9nZ2xlKCd0ZXh0LXdhcm5pbmcnLCAhZi5iYXNlLmZlZXMuZnVuZGVkKVxuICAgIH1cblxuICAgIGNvbnN0IG5lZWRRdW90ZVRva2VuRmVlcyA9IHF1b3RlRmVlSUQgIT09IHF1b3RlSUQgJiYgcXVvdGVGZWVJRCAhPT0gYmFzZUZlZUlEXG4gICAgRG9jLnNldFZpcyhuZWVkUXVvdGVUb2tlbkZlZXMsIC4uLkRvYy5hcHBseVNlbGVjdG9yKHBhZ2UuYWxsb2NhdGlvbkRpYWxvZywgJ1tkYXRhLXF1b3RlLXRva2VuLWZlZXNdJykpXG4gICAgaWYgKG5lZWRRdW90ZVRva2VuRmVlcykge1xuICAgICAgY29uc3QgcHJvcG9zZWRGZWVzID0gTWF0aC5taW4oZi5xdW90ZS5mZWVzLnJlcSwgZi5xdW90ZS5mZWVzLmF2YWlsKVxuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlRmVlQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocHJvcG9zZWRGZWVzKVxuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlRmVlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocHJvcG9zZWRGZWVzICogcXVvdGVGZWVGaWF0UmF0ZSlcbiAgICAgIHBhZ2UucHJvcG9zZWREZXhRdW90ZUZlZUFsbG9jLmNsYXNzTGlzdC50b2dnbGUoJ3RleHQtd2FybmluZycsICFmLnF1b3RlLmZlZXMuZnVuZGVkKVxuICAgIH1cblxuICAgIGNvbnN0IG1rdCA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XT8ubWFya2V0c1tta3RJRF1cbiAgICBsZXQgZXhpc3RpbmdPcmRlcnMgPSBmYWxzZVxuICAgIGlmIChta3QgJiYgbWt0Lm9yZGVycykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBta3Qub3JkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChta3Qub3JkZXJzW2ldLnN0YXR1cyA8PSBTdGF0dXNCb29rZWQpIHtcbiAgICAgICAgICBleGlzdGluZ09yZGVycyA9IHRydWVcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIERvYy5zZXRWaXMoZXhpc3RpbmdPcmRlcnMsIHBhZ2UuZXhpc3RpbmdPcmRlcnNCb3gpXG5cbiAgICBEb2Muc2hvdyhwYWdlLmFsbG9jYXRpb25EaWFsb2cpXG4gICAgY29uc3QgY2xvc2VEaWFsb2cgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKERvYy5tb3VzZUluRWxlbWVudChlLCBwYWdlLmFsbG9jYXRpb25EaWFsb2cpKSByZXR1cm5cbiAgICAgIHRoaXMuaGlkZUFsbG9jYXRpb25EaWFsb2coKVxuICAgICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ2NsaWNrJywgY2xvc2VEaWFsb2cpXG4gICAgfVxuICAgIERvYy5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjbG9zZURpYWxvZylcbiAgfVxuXG4gIGhpZGVBbGxvY2F0aW9uRGlhbG9nICgpIHtcbiAgICBEb2MuaGlkZSh0aGlzLnBhZ2UuYWxsb2NhdGlvbkRpYWxvZylcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0ICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGFsbG9jLCBiYXNlSUQsIHF1b3RlSUQsIGhvc3QsIGNleE5hbWUsIGNmZzogeyB1aUNvbmZpZzogeyBjZXhSZWJhbGFuY2UgfSB9IH0gPSB0aGlzXG5cbiAgICBEb2MuaGlkZShwYWdlLmVyck1zZylcbiAgICBpZiAoY2V4TmFtZSAmJiAhYXBwKCkubW1TdGF0dXMuY2V4ZXNbY2V4TmFtZV0/LmNvbm5lY3RlZCkge1xuICAgICAgcGFnZS5lcnJNc2cudGV4dENvbnRlbnQgPSBgJHtjZXhOYW1lfSBub3QgY29ubmVjdGVkYFxuICAgICAgRG9jLnNob3cocGFnZS5lcnJNc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyByb3VuZCBhbGxvY2F0aW9ucyB2YWx1ZXMuXG4gICAgZm9yIChjb25zdCBtIG9mIFthbGxvYy5kZXgsIGFsbG9jLmNleF0pIHtcbiAgICAgIGZvciAoY29uc3QgW2Fzc2V0SUQsIHZdIG9mIE9iamVjdC5lbnRyaWVzKG0pKSBtW3BhcnNlSW50KGFzc2V0SUQpXSA9IE1hdGgucm91bmQodilcbiAgICB9XG5cbiAgICBjb25zdCBzdGFydENvbmZpZzogU3RhcnRDb25maWcgPSB7XG4gICAgICBiYXNlSUQ6IGJhc2VJRCxcbiAgICAgIHF1b3RlSUQ6IHF1b3RlSUQsXG4gICAgICBob3N0OiBob3N0LFxuICAgICAgYWxsb2M6IGFsbG9jXG4gICAgfVxuICAgIGlmIChjZXhOYW1lICYmIGNleFJlYmFsYW5jZSkgc3RhcnRDb25maWcuYXV0b1JlYmFsYW5jZSA9IHRoaXMuYXV0b1JlYmFsYW5jZVNldHRpbmdzKClcblxuICAgIHRyeSB7XG4gICAgICBhcHAoKS5sb2coJ21tJywgJ3N0YXJ0aW5nIG1tIGJvdCcsIHN0YXJ0Q29uZmlnKVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgTU0uc3RhcnRCb3Qoc3RhcnRDb25maWcpXG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkgdGhyb3cgcmVzXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcGFnZS5lcnJNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BUElfRVJST1IsIGUpXG4gICAgICBEb2Muc2hvdyhwYWdlLmVyck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLmhpZGVBbGxvY2F0aW9uRGlhbG9nKClcbiAgfVxuXG4gIGF1dG9SZWJhbGFuY2VTZXR0aW5ncyAoKTogQXV0b1JlYmFsYW5jZUNvbmZpZyB7XG4gICAgY29uc3Qge1xuICAgICAgcHJvajogeyBiUHJvaiwgcVByb2osIGFsbG9jIH0sIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCwgY2ZnOiB7IHVpQ29uZmlnOiB7IGJhc2VDb25maWcsIHF1b3RlQ29uZmlnIH0gfSxcbiAgICAgIGJhc2VJRCwgcXVvdGVJRCwgY2V4TmFtZSwgbWt0SURcbiAgICB9ID0gdGhpc1xuXG4gICAgY29uc3QgdG90YWxCYXNlID0gYWxsb2NbYmFzZUlEXVxuICAgIGxldCBkZXhNaW5CYXNlID0gYlByb2ouYm9va1xuICAgIGlmIChiYXNlSUQgPT09IGJhc2VGZWVJRCkgZGV4TWluQmFzZSArPSBiUHJvai5ib29raW5nRmVlc1xuICAgIGlmIChiYXNlSUQgPT09IHF1b3RlRmVlSUQpIGRleE1pbkJhc2UgKz0gcVByb2ouYm9va2luZ0ZlZXNcbiAgICBsZXQgZGV4TWluUXVvdGUgPSBxUHJvai5ib29rXG4gICAgaWYgKHF1b3RlSUQgPT09IHF1b3RlRmVlSUQpIGRleE1pblF1b3RlICs9IHFQcm9qLmJvb2tpbmdGZWVzXG4gICAgaWYgKHF1b3RlSUQgPT09IGJhc2VGZWVJRCkgZGV4TWluUXVvdGUgKz0gYlByb2ouYm9va2luZ0ZlZXNcbiAgICBjb25zdCBtYXhCYXNlID0gTWF0aC5tYXgodG90YWxCYXNlIC0gZGV4TWluQmFzZSwgdG90YWxCYXNlIC0gYlByb2ouY2V4KVxuICAgIGNvbnN0IHRvdGFsUXVvdGUgPSBhbGxvY1txdW90ZUlEXVxuICAgIGNvbnN0IG1heFF1b3RlID0gTWF0aC5tYXgodG90YWxRdW90ZSAtIGRleE1pblF1b3RlLCB0b3RhbFF1b3RlIC0gcVByb2ouY2V4KVxuICAgIGlmIChtYXhCYXNlIDwgMCB8fCBtYXhRdW90ZSA8IDApIHtcbiAgICAgIHRocm93IEVycm9yKGByZWJhbGFuY2UgbWF0aCBkb2Vzbid0IHdvcms6ICR7SlNPTi5zdHJpbmdpZnkoeyBiUHJvaiwgcVByb2osIG1heEJhc2UsIG1heFF1b3RlIH0pfWApXG4gICAgfVxuICAgIGNvbnN0IGNleCA9IGFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWVdXG4gICAgY29uc3QgbWt0ID0gY2V4Lm1hcmtldHNbbWt0SURdXG4gICAgY29uc3QgW21pbkIsIG1heEJdID0gW21rdC5iYXNlTWluV2l0aGRyYXcsIE1hdGgubWF4KG1rdC5iYXNlTWluV2l0aGRyYXcgKiAyLCBtYXhCYXNlKV1cbiAgICBjb25zdCBtaW5CYXNlVHJhbnNmZXIgPSBNYXRoLnJvdW5kKG1pbkIgKyBiYXNlQ29uZmlnLnRyYW5zZmVyRmFjdG9yICogKG1heEIgLSBtaW5CKSlcbiAgICBjb25zdCBbbWluUSwgbWF4UV0gPSBbbWt0LnF1b3RlTWluV2l0aGRyYXcsIE1hdGgubWF4KG1rdC5xdW90ZU1pbldpdGhkcmF3ICogMiwgbWF4UXVvdGUpXVxuICAgIGNvbnN0IG1pblF1b3RlVHJhbnNmZXIgPSBNYXRoLnJvdW5kKG1pblEgKyBxdW90ZUNvbmZpZy50cmFuc2ZlckZhY3RvciAqIChtYXhRIC0gbWluUSkpXG4gICAgcmV0dXJuIHsgbWluQmFzZVRyYW5zZmVyLCBtaW5RdW90ZVRyYW5zZmVyIH1cbiAgfVxuXG4gIHJlY29uZmlndXJlICgpIHtcbiAgICBjb25zdCB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCwgY2V4TmFtZSwgYm90VHlwZSB9ID0gdGhpc1xuICAgIGFwcCgpLmxvYWRQYWdlKCdtbXNldHRpbmdzJywgeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUsIGJvdFR5cGUgfSlcbiAgfVxuXG4gIGhhbmRsZUVwb2NoUmVwb3J0Tm90ZSAobm90ZTogRXBvY2hSZXBvcnROb3RlKSB7XG4gICAgdGhpcy5ydW5EaXNwbGF5LmhhbmRsZUVwb2NoUmVwb3J0Tm90ZShub3RlKVxuICB9XG5cbiAgaGFuZGxlQ2V4UHJvYmxlbXNOb3RlIChub3RlOiBDRVhQcm9ibGVtc05vdGUpIHtcbiAgICB0aGlzLnJ1bkRpc3BsYXkuaGFuZGxlQ2V4UHJvYmxlbXNOb3RlKG5vdGUpXG4gIH1cblxuICBoYW5kbGVSdW5TdGF0cyAoKSB7XG4gICAgdGhpcy51cGRhdGVEaXNwbGF5KClcbiAgICB0aGlzLnVwZGF0ZVRhYmxlUm93KClcbiAgICB0aGlzLnJ1bkRpc3BsYXkucmVhZEJvb2soKVxuICB9XG59XG4iLCJpbXBvcnQge1xuICBhcHAsXG4gIFBhZ2VFbGVtZW50LFxuICBNYXJrZXRXaXRoSG9zdFxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IHsgZ2V0SlNPTiB9IGZyb20gJy4vaHR0cCdcbmltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCB7IHNldE1hcmtldEVsZW1lbnRzIH0gZnJvbSAnLi9tbXV0aWwnXG5cbmludGVyZmFjZSBNYXJrZXRNYWtpbmdSdW4ge1xuICBzdGFydFRpbWU6IG51bWJlclxuICBtYXJrZXQ6IE1hcmtldFdpdGhIb3N0XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcmtldE1ha2VyQXJjaGl2ZXNQYWdlIGV4dGVuZHMgQmFzZVBhZ2Uge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgYmFzZTogbnVtYmVyXG4gIHF1b3RlOiBudW1iZXJcbiAgaG9zdDogc3RyaW5nXG5cbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhtYWluKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhwYWdlLnJ1blRhYmxlUm93VG1wbClcbiAgICBEb2MuYmluZChwYWdlLmJhY2tCdXR0b24sICdjbGljaycsICgpID0+IHsgYXBwKCkubG9hZFBhZ2UoJ21tJykgfSlcbiAgICB0aGlzLnNldHVwKClcbiAgfVxuXG4gIGFzeW5jIHNldHVwICgpIHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRKU09OKCcvYXBpL2FyY2hpdmVkbW1ydW5zJylcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgY29uc29sZS5lcnJvcignZmFpbGVkIHRvIGdldCBhcmNoaXZlZCBtbSBydW5zJywgcmVzKVxuICAgICAgLy8gVE9ETzogc2hvdyBlcnJvclxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3QgcnVucyA6IE1hcmtldE1ha2luZ1J1bltdID0gcmVzLnJ1bnNcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcnVucy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgeyBzdGFydFRpbWUsIG1hcmtldDogeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QgfSB9ID0gcnVuc1tpXVxuICAgICAgY29uc3Qgcm93ID0gdGhpcy5wYWdlLnJ1blRhYmxlUm93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICB0bXBsLnN0YXJ0VGltZS50ZXh0Q29udGVudCA9IG5ldyBEYXRlKHN0YXJ0VGltZSAqIDEwMDApLnRvTG9jYWxlU3RyaW5nKClcbiAgICAgIHNldE1hcmtldEVsZW1lbnRzKHJvdywgYmFzZUlELCBxdW90ZUlELCBob3N0KVxuXG4gICAgICBEb2MuYmluZCh0bXBsLmxvZ3MsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgYXBwKCkubG9hZFBhZ2UoJ21tbG9ncycsIHsgYmFzZUlELCBxdW90ZUlELCBob3N0LCBzdGFydFRpbWUsIHJldHVyblBhZ2U6ICdtbWFyY2hpdmVzJyB9KVxuICAgICAgfSlcblxuICAgICAgRG9jLmJpbmQodG1wbC5zZXR0aW5ncywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBhcHAoKS5sb2FkUGFnZSgnbW1zZXR0aW5ncycsIHsgaG9zdCwgYmFzZUlELCBxdW90ZUlEIH0pXG4gICAgICB9KVxuXG4gICAgICB0aGlzLnBhZ2UucnVuVGFibGVCb2R5LmFwcGVuZENoaWxkKHJvdylcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnQsXG4gIE1hcmtldE1ha2luZ0V2ZW50LFxuICBERVhPcmRlckV2ZW50LFxuICBDRVhPcmRlckV2ZW50LFxuICBSdW5FdmVudE5vdGUsXG4gIFJ1blN0YXRzTm90ZSxcbiAgRGVwb3NpdEV2ZW50LFxuICBXaXRoZHJhd2FsRXZlbnQsXG4gIE1hcmtldE1ha2luZ1J1bk92ZXJ2aWV3LFxuICBTdXBwb3J0ZWRBc3NldCxcbiAgQmFsYW5jZUVmZmVjdHMsXG4gIE1hcmtldFdpdGhIb3N0LFxuICBQcm9maXRMb3NzXG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgeyBGb3JtcyB9IGZyb20gJy4vZm9ybXMnXG5pbXBvcnQgeyBwb3N0SlNPTiB9IGZyb20gJy4vaHR0cCdcbmltcG9ydCBEb2MsIHsgc2V0dXBDb3B5QnRuIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCB7IHNldE1hcmtldEVsZW1lbnRzLCBsaXZlQm90U3RhdHVzIH0gZnJvbSAnLi9tbXV0aWwnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCAqIGFzIHdhbGxldHMgZnJvbSAnLi93YWxsZXRzJ1xuaW1wb3J0IHsgQ29pbkV4cGxvcmVycyB9IGZyb20gJy4vY29pbmV4cGxvcmVycydcblxuaW50ZXJmYWNlIExvZ3NQYWdlUGFyYW1zIHtcbiAgaG9zdDogc3RyaW5nXG4gIHF1b3RlSUQ6IG51bWJlclxuICBiYXNlSUQ6IG51bWJlclxuICBzdGFydFRpbWU6IG51bWJlclxuICByZXR1cm5QYWdlOiBzdHJpbmdcbn1cblxubGV0IG5ldCA9IDBcblxuY29uc3QgbG9nc0JhdGNoU2l6ZSA9IDUwXG5cbmludGVyZmFjZSBsb2dGaWx0ZXJzIHtcbiAgZGV4U2VsbHM6IGJvb2xlYW5cbiAgZGV4QnV5czogYm9vbGVhblxuICBjZXhTZWxsczogYm9vbGVhblxuICBjZXhCdXlzOiBib29sZWFuXG4gIGRlcG9zaXRzOiBib29sZWFuXG4gIHdpdGhkcmF3YWxzOiBib29sZWFuXG59XG5cbmZ1bmN0aW9uIGV2ZW50UGFzc2VzRmlsdGVyIChlOiBNYXJrZXRNYWtpbmdFdmVudCwgZmlsdGVyczogbG9nRmlsdGVycyk6IGJvb2xlYW4ge1xuICBpZiAoZS5kZXhPcmRlckV2ZW50KSB7XG4gICAgaWYgKGUuZGV4T3JkZXJFdmVudC5zZWxsKSByZXR1cm4gZmlsdGVycy5kZXhTZWxsc1xuICAgIHJldHVybiBmaWx0ZXJzLmRleEJ1eXNcbiAgfVxuICBpZiAoZS5jZXhPcmRlckV2ZW50KSB7XG4gICAgaWYgKGUuY2V4T3JkZXJFdmVudC5zZWxsKSByZXR1cm4gZmlsdGVycy5jZXhTZWxsc1xuICAgIHJldHVybiBmaWx0ZXJzLmNleEJ1eXNcbiAgfVxuICBpZiAoZS5kZXBvc2l0RXZlbnQpIHJldHVybiBmaWx0ZXJzLmRlcG9zaXRzXG4gIGlmIChlLndpdGhkcmF3YWxFdmVudCkgcmV0dXJuIGZpbHRlcnMud2l0aGRyYXdhbHNcbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcmtldE1ha2VyTG9nc1BhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBta3Q6IE1hcmtldFdpdGhIb3N0XG4gIHN0YXJ0VGltZTogbnVtYmVyXG4gIGZpYXRSYXRlczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICBsaXZlQm90OiBib29sZWFuXG4gIG92ZXJ2aWV3OiBNYXJrZXRNYWtpbmdSdW5PdmVydmlld1xuICBldmVudHM6IFJlY29yZDxudW1iZXIsIFtNYXJrZXRNYWtpbmdFdmVudCwgSFRNTEVsZW1lbnRdPlxuICBmb3JtczogRm9ybXNcbiAgZGV4T3JkZXJJRENvcHlMaXN0ZW5lcjogKCkgPT4gdm9pZCB8IHVuZGVmaW5lZFxuICBjZXhPcmRlcklEQ29weUxpc3RlbmVyOiAoKSA9PiB2b2lkIHwgdW5kZWZpbmVkXG4gIGRlcG9zaXRJRENvcHlMaXN0ZW5lcjogKCkgPT4gdm9pZCB8IHVuZGVmaW5lZFxuICB3aXRoZHJhd2FsSURDb3B5TGlzdGVuZXI6ICgpID0+IHZvaWQgfCB1bmRlZmluZWRcbiAgZmlsdGVyczogbG9nRmlsdGVyc1xuICBsb2FkaW5nOiBib29sZWFuXG4gIHJlZklEOiBudW1iZXIgfCB1bmRlZmluZWRcbiAgZG9uZVNjcm9sbGluZzogYm9vbGVhblxuICBzdGF0c1Jvd3M6IFJlY29yZDxudW1iZXIsIEhUTUxFbGVtZW50PlxuXG4gIGNvbnN0cnVjdG9yIChtYWluOiBIVE1MRWxlbWVudCwgcGFyYW1zOiBMb2dzUGFnZVBhcmFtcykge1xuICAgIHN1cGVyKClcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMobWFpbilcbiAgICBuZXQgPSBhcHAoKS51c2VyLm5ldFxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhwYWdlLmV2ZW50VGFibGVSb3dUbXBsLCBwYWdlLmRleE9yZGVyVHhSb3dUbXBsLCBwYWdlLnBlcmZvcm1hbmNlVGFibGVSb3dUbXBsKVxuICAgIERvYy5iaW5kKHRoaXMucGFnZS5iYWNrQnV0dG9uLCAnY2xpY2snLCAoKSA9PiB7IGFwcCgpLmxvYWRQYWdlKHBhcmFtcy5yZXR1cm5QYWdlID8/ICdtbScpIH0pXG4gICAgRG9jLmJpbmQodGhpcy5wYWdlLmZpbHRlckJ1dHRvbiwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmFwcGx5RmlsdGVycygpIH0pXG4gICAgaWYgKHBhcmFtcz8uaG9zdCkge1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZilcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdob3N0JywgcGFyYW1zLmhvc3QpXG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnYmFzZUlEJywgU3RyaW5nKHBhcmFtcy5iYXNlSUQpKVxuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3F1b3RlSUQnLCBTdHJpbmcocGFyYW1zLnF1b3RlSUQpKVxuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3N0YXJ0VGltZScsIFN0cmluZyhwYXJhbXMuc3RhcnRUaW1lKSlcbiAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSh7IHBhZ2U6ICdtbXNldHRpbmdzJywgLi4ucGFyYW1zIH0sICcnLCB1cmwpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaClcbiAgICAgIGlmICghcGFyYW1zKSBwYXJhbXMgPSB7fSBhcyBMb2dzUGFnZVBhcmFtc1xuICAgICAgcGFyYW1zLmhvc3QgPSB1cmxQYXJhbXMuZ2V0KCdob3N0JykgfHwgJydcbiAgICAgIHBhcmFtcy5iYXNlSUQgPSBwYXJzZUludCh1cmxQYXJhbXMuZ2V0KCdiYXNlSUQnKSB8fCAnMCcpXG4gICAgICBwYXJhbXMucXVvdGVJRCA9IHBhcnNlSW50KHVybFBhcmFtcy5nZXQoJ3F1b3RlSUQnKSB8fCAnMCcpXG4gICAgICBwYXJhbXMuc3RhcnRUaW1lID0gcGFyc2VJbnQodXJsUGFyYW1zLmdldCgnc3RhcnRUaW1lJykgfHwgJzAnKVxuICAgIH1cbiAgICBjb25zdCB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCwgc3RhcnRUaW1lIH0gPSBwYXJhbXNcbiAgICB0aGlzLnN0YXJ0VGltZSA9IHN0YXJ0VGltZVxuICAgIHRoaXMuZm9ybXMgPSBuZXcgRm9ybXMocGFnZS5mb3JtcylcbiAgICB0aGlzLmV2ZW50cyA9IHt9XG4gICAgdGhpcy5zdGF0c1Jvd3MgPSB7fVxuICAgIHRoaXMubWt0ID0geyBiYXNlSUQ6IGJhc2VJRCwgcXVvdGVJRDogcXVvdGVJRCwgaG9zdCB9XG4gICAgc2V0TWFya2V0RWxlbWVudHMobWFpbiwgYmFzZUlELCBxdW90ZUlELCBob3N0KVxuICAgIERvYy5iaW5kKG1haW4sICdzY3JvbGwnLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5sb2FkaW5nKSByZXR1cm5cbiAgICAgIGlmICh0aGlzLmRvbmVTY3JvbGxpbmcpIHJldHVyblxuICAgICAgY29uc3QgYmVsb3dCb3R0b20gPSBwYWdlLmV2ZW50c1RhYmxlLm9mZnNldEhlaWdodCAtIG1haW4ub2Zmc2V0SGVpZ2h0IC0gbWFpbi5zY3JvbGxUb3BcbiAgICAgIGlmIChiZWxvd0JvdHRvbSA8IDApIHtcbiAgICAgICAgdGhpcy5uZXh0UGFnZSgpXG4gICAgICB9XG4gICAgfSlcbiAgICB0aGlzLnNldHVwKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgfVxuXG4gIGFzeW5jIG5leHRQYWdlICgpIHtcbiAgICB0aGlzLmxvYWRpbmcgPSB0cnVlXG4gICAgY29uc3QgW2V2ZW50cywgdXBkYXRlZExvZ3MsIG92ZXJ2aWV3XSA9IGF3YWl0IHRoaXMuZ2V0UnVuTG9ncygpXG4gICAgY29uc3QgYXNzZXRzID0gdGhpcy5ta3RBc3NldHMoKVxuICAgIGZvciAoY29uc3QgZXZlbnQgb2YgZXZlbnRzKSB7XG4gICAgICBpZiAodGhpcy5ldmVudHNbZXZlbnQuaWRdKSBjb250aW51ZVxuICAgICAgY29uc3Qgcm93ID0gdGhpcy5uZXdFdmVudFJvdyhldmVudCwgZmFsc2UsIGFzc2V0cylcbiAgICAgIHRoaXMuZXZlbnRzW2V2ZW50LmlkXSA9IFtldmVudCwgcm93XVxuICAgIH1cbiAgICB0aGlzLnBvcHVsYXRlU3RhdHMob3ZlcnZpZXcucHJvZml0TG9zcywgb3ZlcnZpZXcuZW5kVGltZSlcbiAgICB0aGlzLnVwZGF0ZUV4aXN0aW5nUm93cyh1cGRhdGVkTG9ncylcbiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZVxuICB9XG5cbiAgYXN5bmMgZ2V0UnVuTG9ncyAoKTogUHJvbWlzZTxbTWFya2V0TWFraW5nRXZlbnRbXSwgTWFya2V0TWFraW5nRXZlbnRbXSwgTWFya2V0TWFraW5nUnVuT3ZlcnZpZXddPiB7XG4gICAgY29uc3QgeyBta3QsIHN0YXJ0VGltZSB9ID0gdGhpc1xuICAgIGNvbnN0IHJlcTogYW55ID0geyBtYXJrZXQ6IG1rdCwgc3RhcnRUaW1lLCBuOiBsb2dzQmF0Y2hTaXplLCBmaWx0ZXJzOiB0aGlzLmZpbHRlcnMsIHJlZklEOiB0aGlzLnJlZklEIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9tbXJ1bmxvZ3MnLCByZXEpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byBnZXQgYm90IGxvZ3MnLCByZXMpXG4gICAgfVxuICAgIGlmIChyZXMubG9ncy5sZW5ndGggPD0gMSkge1xuICAgICAgdGhpcy5kb25lU2Nyb2xsaW5nID0gdHJ1ZVxuICAgIH1cbiAgICBpZiAocmVzLmxvZ3MubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5yZWZJRCA9IHJlcy5sb2dzW3Jlcy5sb2dzLmxlbmd0aCAtIDFdLmlkXG4gICAgfVxuICAgIHJldHVybiBbcmVzLmxvZ3MsIHJlcy51cGRhdGVkTG9ncyB8fCBbXSwgcmVzLm92ZXJ2aWV3XVxuICB9XG5cbiAgYXN5bmMgYXBwbHlGaWx0ZXJzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5maWx0ZXJzID0ge1xuICAgICAgZGV4U2VsbHM6ICEhcGFnZS5kZXhTZWxsc0NoZWNrYm94LmNoZWNrZWQsXG4gICAgICBkZXhCdXlzOiAhIXBhZ2UuZGV4QnV5c0NoZWNrYm94LmNoZWNrZWQsXG4gICAgICBjZXhTZWxsczogISFwYWdlLmNleFNlbGxzQ2hlY2tib3guY2hlY2tlZCxcbiAgICAgIGNleEJ1eXM6ICEhcGFnZS5jZXhCdXlzQ2hlY2tib3guY2hlY2tlZCxcbiAgICAgIGRlcG9zaXRzOiAhIXBhZ2UuZGVwb3NpdHNDaGVja2JveC5jaGVja2VkLFxuICAgICAgd2l0aGRyYXdhbHM6ICEhcGFnZS53aXRoZHJhd2Fsc0NoZWNrYm94LmNoZWNrZWRcbiAgICB9XG4gICAgdGhpcy5yZWZJRCA9IHVuZGVmaW5lZFxuICAgIGNvbnN0IFtldmVudHMsICwgb3ZlcnZpZXddID0gYXdhaXQgdGhpcy5nZXRSdW5Mb2dzKClcbiAgICB0aGlzLnBvcHVsYXRlVGFibGUoZXZlbnRzKVxuICAgIHRoaXMucG9wdWxhdGVTdGF0cyhvdmVydmlldy5wcm9maXRMb3NzLCBvdmVydmlldy5lbmRUaW1lKVxuICB9XG5cbiAgc2V0RmlsdGVycyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UuZGV4U2VsbHNDaGVja2JveC5jaGVja2VkID0gdHJ1ZVxuICAgIHBhZ2UuZGV4QnV5c0NoZWNrYm94LmNoZWNrZWQgPSB0cnVlXG4gICAgcGFnZS5jZXhTZWxsc0NoZWNrYm94LmNoZWNrZWQgPSB0cnVlXG4gICAgcGFnZS5jZXhCdXlzQ2hlY2tib3guY2hlY2tlZCA9IHRydWVcbiAgICBwYWdlLmRlcG9zaXRzQ2hlY2tib3guY2hlY2tlZCA9IHRydWVcbiAgICBwYWdlLndpdGhkcmF3YWxzQ2hlY2tib3guY2hlY2tlZCA9IHRydWVcbiAgICB0aGlzLmZpbHRlcnMgPSB7XG4gICAgICBkZXhTZWxsczogdHJ1ZSxcbiAgICAgIGRleEJ1eXM6IHRydWUsXG4gICAgICBjZXhTZWxsczogdHJ1ZSxcbiAgICAgIGNleEJ1eXM6IHRydWUsXG4gICAgICBkZXBvc2l0czogdHJ1ZSxcbiAgICAgIHdpdGhkcmF3YWxzOiB0cnVlXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2V0dXAgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLnNldEZpbHRlcnMoKVxuICAgIGNvbnN0IHsgc3RhcnRUaW1lIH0gPSB0aGlzXG4gICAgbGV0IHByb2ZpdExvc3M6IFByb2ZpdExvc3NcbiAgICBsZXQgZW5kVGltZSA9IDBcbiAgICBjb25zdCBib3RTdGF0dXMgPSBsaXZlQm90U3RhdHVzKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICBjb25zdCBbZXZlbnRzLCAsIG92ZXJ2aWV3XSA9IGF3YWl0IHRoaXMuZ2V0UnVuTG9ncygpXG4gICAgaWYgKGJvdFN0YXR1cz8ucnVuU3RhdHM/LnN0YXJ0VGltZSA9PT0gc3RhcnRUaW1lKSB7XG4gICAgICB0aGlzLmxpdmVCb3QgPSB0cnVlXG4gICAgICB0aGlzLmZpYXRSYXRlcyA9IGFwcCgpLmZpYXRSYXRlc01hcFxuICAgICAgcHJvZml0TG9zcyA9IGJvdFN0YXR1cy5ydW5TdGF0cy5wcm9maXRMb3NzXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZmlhdFJhdGVzID0gb3ZlcnZpZXcuZmluYWxTdGF0ZS5maWF0UmF0ZXNcbiAgICAgIHByb2ZpdExvc3MgPSBvdmVydmlldy5wcm9maXRMb3NzXG4gICAgICBlbmRUaW1lID0gb3ZlcnZpZXcuZW5kVGltZVxuICAgIH1cbiAgICB0aGlzLnBvcHVsYXRlU3RhdHMocHJvZml0TG9zcywgZW5kVGltZSlcbiAgICBjb25zdCBhc3NldHMgPSB0aGlzLm1rdEFzc2V0cygpXG4gICAgY29uc3QgcGFyZW50SGVhZGVyID0gcGFnZS5zdW1VU0RIZWFkZXIucGFyZW50RWxlbWVudFxuICAgIGZvciAoY29uc3QgYXNzZXQgb2YgYXNzZXRzKSB7XG4gICAgICBjb25zdCB0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoJykgYXMgUGFnZUVsZW1lbnRcbiAgICAgIHRoLnRleHRDb250ZW50ID0gYCR7YXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKCl9IERlbHRhYFxuICAgICAgaWYgKHBhcmVudEhlYWRlcikge1xuICAgICAgICBwYXJlbnRIZWFkZXIuaW5zZXJ0QmVmb3JlKHRoLCBwYWdlLnN1bVVTREhlYWRlcilcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5wb3B1bGF0ZVRhYmxlKGV2ZW50cylcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBydW5ldmVudDogKG5vdGU6IFJ1bkV2ZW50Tm90ZSkgPT4geyB0aGlzLmhhbmRsZVJ1bkV2ZW50Tm90ZShub3RlKSB9LFxuICAgICAgcnVuc3RhdHM6IChub3RlOiBSdW5TdGF0c05vdGUpID0+IHsgdGhpcy5oYW5kbGVSdW5TdGF0c05vdGUobm90ZSkgfVxuICAgIH0pXG4gIH1cblxuICBoYW5kbGVSdW5FdmVudE5vdGUgKG5vdGU6IFJ1bkV2ZW50Tm90ZSkge1xuICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlELCBob3N0IH0gPSB0aGlzLm1rdFxuICAgIGlmIChub3RlLmhvc3QgIT09IGhvc3QgfHwgbm90ZS5iYXNlSUQgIT09IGJhc2VJRCB8fCBub3RlLnF1b3RlSUQgIT09IHF1b3RlSUQpIHJldHVyblxuICAgIGlmICghZXZlbnRQYXNzZXNGaWx0ZXIobm90ZS5ldmVudCwgdGhpcy5maWx0ZXJzKSkgcmV0dXJuXG4gICAgY29uc3QgZXZlbnQgPSBub3RlLmV2ZW50XG4gICAgY29uc3QgY2FjaGVkRXZlbnQgPSB0aGlzLmV2ZW50c1tldmVudC5pZF1cbiAgICBpZiAoY2FjaGVkRXZlbnQpIHtcbiAgICAgIHRoaXMuc2V0Um93Q29udGVudHMoY2FjaGVkRXZlbnRbMV0sIGV2ZW50LCB0aGlzLm1rdEFzc2V0cygpKVxuICAgICAgY2FjaGVkRXZlbnRbMF0gPSBldmVudFxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IHJvdyA9IHRoaXMubmV3RXZlbnRSb3coZXZlbnQsIHRydWUsIHRoaXMubWt0QXNzZXRzKCkpXG4gICAgdGhpcy5ldmVudHNbZXZlbnQuaWRdID0gW2V2ZW50LCByb3ddXG4gIH1cblxuICBoYW5kbGVSdW5TdGF0c05vdGUgKG5vdGU6IFJ1blN0YXRzTm90ZSkge1xuICAgIGNvbnN0IHsgbWt0OiB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCB9LCBzdGFydFRpbWUgfSA9IHRoaXNcbiAgICBpZiAobm90ZS5ob3N0ICE9PSBob3N0IHx8XG4gICAgICBub3RlLmJhc2VJRCAhPT0gYmFzZUlEIHx8XG4gICAgICBub3RlLnF1b3RlSUQgIT09IHF1b3RlSUQpIHJldHVyblxuICAgIGlmICghbm90ZS5zdGF0cyB8fCBub3RlLnN0YXRzLnN0YXJ0VGltZSAhPT0gc3RhcnRUaW1lKSByZXR1cm5cbiAgICB0aGlzLnBvcHVsYXRlU3RhdHMobm90ZS5zdGF0cy5wcm9maXRMb3NzLCAwKVxuICB9XG5cbiAgcG9wdWxhdGVTdGF0cyAocGw6IFByb2ZpdExvc3MsIGVuZFRpbWU6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLnN0YXJ0VGltZS50ZXh0Q29udGVudCA9IG5ldyBEYXRlKHRoaXMuc3RhcnRUaW1lICogMTAwMCkudG9Mb2NhbGVTdHJpbmcoKVxuICAgIGlmIChlbmRUaW1lID09PSAwKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLmVuZFRpbWVSb3cpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2UuZW5kVGltZS50ZXh0Q29udGVudCA9IG5ldyBEYXRlKGVuZFRpbWUgKiAxMDAwKS50b0xvY2FsZVN0cmluZygpXG4gICAgfVxuICAgIGZvciAoY29uc3QgYXNzZXRJRCBpbiBwbC5kaWZmcykge1xuICAgICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbcGFyc2VJbnQoYXNzZXRJRCldXG4gICAgICBsZXQgcm93ID0gdGhpcy5zdGF0c1Jvd3NbYXNzZXRJRF1cbiAgICAgIGlmICghcm93KSB7XG4gICAgICAgIHJvdyA9IHBhZ2UucGVyZm9ybWFuY2VUYWJsZVJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICAgIHRtcGwubG9nby5zcmMgPSBEb2MubG9nb1BhdGgoYXNzZXQuc3ltYm9sKVxuICAgICAgICB0bXBsLnRpY2tlci50ZXh0Q29udGVudCA9IGFzc2V0LnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgICAgIHRoaXMuc3RhdHNSb3dzW2Fzc2V0SURdID0gcm93XG4gICAgICAgIHBhZ2UucGVyZm9ybWFuY2VUYWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93KVxuICAgICAgfVxuICAgICAgY29uc3QgZGlmZiA9IHBsLmRpZmZzW2Fzc2V0SURdXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgdG1wbC5kaWZmLnRleHRDb250ZW50ID0gZGlmZi5mbXRcbiAgICAgIHRtcGwudXNkRGlmZi50ZXh0Q29udGVudCA9IGRpZmYuZm10VVNEXG4gICAgICB0bXBsLmZpYXRSYXRlLnRleHRDb250ZW50ID0gYCR7RG9jLmZvcm1hdEZpYXRWYWx1ZSh0aGlzLmZpYXRSYXRlc1thc3NldC5pZF0pfSBVU0RgXG4gICAgfVxuICAgIHBhZ2UucHJvZml0TG9zcy50ZXh0Q29udGVudCA9IGAke0RvYy5mb3JtYXRGaWF0VmFsdWUocGwucHJvZml0KX0gVVNEYFxuICB9XG5cbiAgbWt0QXNzZXRzICgpIDogU3VwcG9ydGVkQXNzZXRbXSB7XG4gICAgY29uc3QgYmFzZUFzc2V0ID0gYXBwKCkuYXNzZXRzW3RoaXMubWt0LmJhc2VJRF1cbiAgICBjb25zdCBxdW90ZUFzc2V0ID0gYXBwKCkuYXNzZXRzW3RoaXMubWt0LnF1b3RlSURdXG5cbiAgICBjb25zdCBhc3NldHMgPSBbYmFzZUFzc2V0LCBxdW90ZUFzc2V0XVxuICAgIGNvbnN0IGFzc2V0SURzID0geyBbYmFzZUFzc2V0LmlkXTogdHJ1ZSwgW3F1b3RlQXNzZXQuaWRdOiB0cnVlIH1cblxuICAgIGlmIChiYXNlQXNzZXQudG9rZW4gJiYgIWFzc2V0SURzW2Jhc2VBc3NldC50b2tlbi5wYXJlbnRJRF0pIHtcbiAgICAgIGNvbnN0IGJhc2VUb2tlbkFzc2V0ID0gYXBwKCkuYXNzZXRzW2Jhc2VBc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgICAgIGFzc2V0SURzW2Jhc2VUb2tlbkFzc2V0LmlkXSA9IHRydWVcbiAgICAgIGFzc2V0cy5wdXNoKGJhc2VUb2tlbkFzc2V0KVxuICAgIH1cblxuICAgIGlmIChxdW90ZUFzc2V0LnRva2VuICYmICFhc3NldElEc1txdW90ZUFzc2V0LnRva2VuLnBhcmVudElEXSkge1xuICAgICAgY29uc3QgcXVvdGVUb2tlbkFzc2V0ID0gYXBwKCkuYXNzZXRzW3F1b3RlQXNzZXQudG9rZW4ucGFyZW50SURdXG4gICAgICBhc3NldHMucHVzaChxdW90ZVRva2VuQXNzZXQpXG4gICAgfVxuXG4gICAgcmV0dXJuIGFzc2V0c1xuICB9XG5cbiAgdXBkYXRlRXhpc3RpbmdSb3dzICh1cGRhdGVkTG9nczogTWFya2V0TWFraW5nRXZlbnRbXSkge1xuICAgIGZvciAoY29uc3QgZXZlbnQgb2YgdXBkYXRlZExvZ3MpIHtcbiAgICAgIGNvbnN0IGNhY2hlZEV2ZW50ID0gdGhpcy5ldmVudHNbZXZlbnQuaWRdXG4gICAgICBpZiAoIWNhY2hlZEV2ZW50KSBjb250aW51ZVxuICAgICAgdGhpcy5zZXRSb3dDb250ZW50cyhjYWNoZWRFdmVudFsxXSwgZXZlbnQsIHRoaXMubWt0QXNzZXRzKCkpXG4gICAgICBjYWNoZWRFdmVudFswXSA9IGV2ZW50XG4gICAgfVxuICB9XG5cbiAgcG9wdWxhdGVUYWJsZSAoZXZlbnRzOiBNYXJrZXRNYWtpbmdFdmVudFtdKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5lbXB0eShwYWdlLmV2ZW50c1RhYmxlQm9keSlcbiAgICB0aGlzLmV2ZW50cyA9IHt9XG4gICAgdGhpcy5kb25lU2Nyb2xsaW5nID0gZmFsc2VcbiAgICBjb25zdCBhc3NldHMgPSB0aGlzLm1rdEFzc2V0cygpXG4gICAgZm9yIChjb25zdCBldmVudCBvZiBldmVudHMpIHtcbiAgICAgIGNvbnN0IHJvdyA9IHRoaXMubmV3RXZlbnRSb3coZXZlbnQsIGZhbHNlLCBhc3NldHMpXG4gICAgICB0aGlzLmV2ZW50c1tldmVudC5pZF0gPSBbZXZlbnQsIHJvd11cbiAgICB9XG4gIH1cblxuICBzZXRSb3dDb250ZW50cyAocm93OiBIVE1MRWxlbWVudCwgZXZlbnQ6IE1hcmtldE1ha2luZ0V2ZW50LCBhc3NldHM6IFN1cHBvcnRlZEFzc2V0W10pIHtcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgIHRtcGwudGltZS50ZXh0Q29udGVudCA9IChuZXcgRGF0ZShldmVudC50aW1lc3RhbXAgKiAxMDAwKSkudG9Mb2NhbGVTdHJpbmcoKVxuICAgIHRtcGwuZXZlbnRUeXBlLnRleHRDb250ZW50ID0gdGhpcy5ldmVudFR5cGUoZXZlbnQpXG4gICAgbGV0IGlkXG4gICAgaWYgKGV2ZW50LmRlcG9zaXRFdmVudCkge1xuICAgICAgaWQgPSBldmVudC5kZXBvc2l0RXZlbnQudHJhbnNhY3Rpb24uaWRcbiAgICB9IGVsc2UgaWYgKGV2ZW50LndpdGhkcmF3YWxFdmVudCkge1xuICAgICAgaWQgPSBldmVudC53aXRoZHJhd2FsRXZlbnQuaWRcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmRleE9yZGVyRXZlbnQpIHtcbiAgICAgIGlkID0gZXZlbnQuZGV4T3JkZXJFdmVudC5pZFxuICAgIH0gZWxzZSBpZiAoZXZlbnQuY2V4T3JkZXJFdmVudCkge1xuICAgICAgaWQgPSBldmVudC5jZXhPcmRlckV2ZW50LmlkXG4gICAgfVxuICAgIGlmIChpZCkge1xuICAgICAgdG1wbC5ldmVudElELnRleHRDb250ZW50ID0gdHJpbVN0cmluZ1dpdGhFbGxpcHNpcyhpZCwgMzApXG4gICAgICB0bXBsLmV2ZW50SUQuc2V0QXR0cmlidXRlKCd0aXRsZScsIGlkKVxuICAgIH1cbiAgICBsZXQgdXNkID0gMFxuICAgIGZvciAoY29uc3QgYXNzZXQgb2YgYXNzZXRzKSB7XG4gICAgICBjb25zdCBiZSA9IGV2ZW50LmJhbGFuY2VFZmZlY3RzXG4gICAgICBjb25zdCBzdW0gPSBzdW1CYWxhbmNlRWZmZWN0cyhhc3NldC5pZCwgYmUpXG4gICAgICBjb25zdCB0bXBsSUQgPSBgc3VtJHthc3NldC5zeW1ib2wudG9VcHBlckNhc2UoKX1gXG4gICAgICBsZXQgZWwgOiBQYWdlRWxlbWVudFxuICAgICAgaWYgKHRtcGxbdG1wbElEXSkge1xuICAgICAgICBlbCA9IHRtcGxbdG1wbElEXVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpXG4gICAgICAgIGVsLmRhdGFzZXQudG1wbCA9IHRtcGxJRFxuICAgICAgICBjb25zdCBwYXJlbnQgPSB0bXBsLnN1bVVTRC5wYXJlbnRFbGVtZW50XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGVsLCB0bXBsLnN1bVVTRClcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHN1bSwgYXNzZXQudW5pdEluZm8pXG4gICAgICBjb25zdCBmYWN0b3IgPSBhc3NldC51bml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgICAgdXNkICs9IHN1bSAvIGZhY3RvciAqIHRoaXMuZmlhdFJhdGVzW2Fzc2V0LmlkXSA/PyAwXG4gICAgfVxuICAgIHRtcGwuc3VtVVNELnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHVzZClcbiAgICBEb2MuYmluZCh0bXBsLmRldGFpbHMsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93RXZlbnREZXRhaWxzKGV2ZW50LmlkKSB9KVxuICB9XG5cbiAgbmV3RXZlbnRSb3cgKGV2ZW50OiBNYXJrZXRNYWtpbmdFdmVudCwgcHJlcGVuZDogYm9vbGVhbiwgYXNzZXRzOiBTdXBwb3J0ZWRBc3NldFtdKSA6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3Qgcm93ID0gcGFnZS5ldmVudFRhYmxlUm93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICByb3cuaWQgPSBldmVudC5pZC50b1N0cmluZygpXG4gICAgdGhpcy5zZXRSb3dDb250ZW50cyhyb3csIGV2ZW50LCBhc3NldHMpXG4gICAgaWYgKHByZXBlbmQpIHtcbiAgICAgIHBhZ2UuZXZlbnRzVGFibGVCb2R5Lmluc2VydEJlZm9yZShyb3csIHBhZ2UuZXZlbnRzVGFibGVCb2R5LmZpcnN0Q2hpbGQpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2UuZXZlbnRzVGFibGVCb2R5LmFwcGVuZENoaWxkKHJvdylcbiAgICB9XG4gICAgcmV0dXJuIHJvd1xuICB9XG5cbiAgZXZlbnRUeXBlIChldmVudDogTWFya2V0TWFraW5nRXZlbnQpIDogc3RyaW5nIHtcbiAgICBpZiAoZXZlbnQuZGVwb3NpdEV2ZW50KSB7XG4gICAgICByZXR1cm4gJ0RlcG9zaXQnXG4gICAgfSBlbHNlIGlmIChldmVudC53aXRoZHJhd2FsRXZlbnQpIHtcbiAgICAgIHJldHVybiAnV2l0aGRyYXdhbCdcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmRleE9yZGVyRXZlbnQpIHtcbiAgICAgIHJldHVybiBldmVudC5kZXhPcmRlckV2ZW50LnNlbGwgPyAnREVYIFNlbGwnIDogJ0RFWCBCdXknXG4gICAgfSBlbHNlIGlmIChldmVudC5jZXhPcmRlckV2ZW50KSB7XG4gICAgICByZXR1cm4gZXZlbnQuY2V4T3JkZXJFdmVudC5zZWxsID8gJ0NFWCBTZWxsJyA6ICdDRVggQnV5J1xuICAgIH1cblxuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgc2hvd0RleE9yZGVyRXZlbnREZXRhaWxzIChldmVudDogREVYT3JkZXJFdmVudCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWt0OiB7IGJhc2VJRCwgcXVvdGVJRCB9IH0gPSB0aGlzXG4gICAgY29uc3QgYmFzZUFzc2V0ID0gYXBwKCkuYXNzZXRzW2Jhc2VJRF1cbiAgICBjb25zdCBxdW90ZUFzc2V0ID0gYXBwKCkuYXNzZXRzW3F1b3RlSURdXG4gICAgY29uc3QgW2J1aSwgcXVpXSA9IFtiYXNlQXNzZXQudW5pdEluZm8sIHF1b3RlQXNzZXQudW5pdEluZm9dXG4gICAgY29uc3QgW2Jhc2VUaWNrZXIsIHF1b3RlVGlja2VyXSA9IFtidWkuY29udmVudGlvbmFsLnVuaXQsIHF1aS5jb252ZW50aW9uYWwudW5pdF1cbiAgICBpZiAodGhpcy5kZXhPcmRlcklEQ29weUxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHBhZ2UuY29weURleE9yZGVySUQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmRleE9yZGVySURDb3B5TGlzdGVuZXIpXG4gICAgfVxuICAgIHRoaXMuZGV4T3JkZXJJRENvcHlMaXN0ZW5lciA9ICgpID0+IHsgc2V0dXBDb3B5QnRuKGV2ZW50LmlkLCBwYWdlLmRleE9yZGVySUQsIHBhZ2UuY29weURleE9yZGVySUQsICcjMWU3ZDExJykgfVxuICAgIHBhZ2UuY29weURleE9yZGVySUQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmRleE9yZGVySURDb3B5TGlzdGVuZXIpXG4gICAgcGFnZS5kZXhPcmRlcklELnRleHRDb250ZW50ID0gdHJpbVN0cmluZ1dpdGhFbGxpcHNpcyhldmVudC5pZCwgMjApXG4gICAgcGFnZS5kZXhPcmRlcklELnNldEF0dHJpYnV0ZSgndGl0bGUnLCBldmVudC5pZClcbiAgICBjb25zdCByYXRlID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIGV2ZW50LnJhdGUpXG5cbiAgICBwYWdlLmRleE9yZGVyUmF0ZS50ZXh0Q29udGVudCA9IGAke3JhdGV9ICR7YmFzZVRpY2tlcn0vJHtxdW90ZVRpY2tlcn1gXG4gICAgcGFnZS5kZXhPcmRlclF0eS50ZXh0Q29udGVudCA9IGAke2V2ZW50LnF0eSAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3Rvcn0gJHtiYXNlVGlja2VyfWBcbiAgICBpZiAoZXZlbnQuc2VsbCkge1xuICAgICAgcGFnZS5kZXhPcmRlclNpZGUudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9TRUxMKVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLmRleE9yZGVyU2lkZS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0JVWSlcbiAgICB9XG4gICAgRG9jLmVtcHR5KHBhZ2UuZGV4T3JkZXJUeHNUYWJsZUJvZHkpXG4gICAgRG9jLnNldFZpcyhldmVudC50cmFuc2FjdGlvbnMgJiYgZXZlbnQudHJhbnNhY3Rpb25zLmxlbmd0aCA+IDAsIHBhZ2UuZGV4T3JkZXJUeHNUYWJsZSlcbiAgICBjb25zdCB0eEFzc2V0ID0gKHR4VHlwZTogbnVtYmVyLCBzZWxsOiBib29sZWFuKSA6IFN1cHBvcnRlZEFzc2V0IHwgdW5kZWZpbmVkID0+IHtcbiAgICAgIHN3aXRjaCAodHhUeXBlKSB7XG4gICAgICAgIGNhc2Ugd2FsbGV0cy50eFR5cGVTd2FwOlxuICAgICAgICBjYXNlIHdhbGxldHMudHhUeXBlUmVmdW5kOlxuICAgICAgICBjYXNlIHdhbGxldHMudHhUeXBlU3BsaXQ6XG4gICAgICAgICAgcmV0dXJuIHNlbGwgPyBiYXNlQXNzZXQgOiBxdW90ZUFzc2V0XG4gICAgICAgIGNhc2Ugd2FsbGV0cy50eFR5cGVSZWRlZW06XG4gICAgICAgICAgcmV0dXJuIHNlbGwgPyBxdW90ZUFzc2V0IDogYmFzZUFzc2V0XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGV2ZW50LnRyYW5zYWN0aW9ucyAmJiBpIDwgZXZlbnQudHJhbnNhY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCB0eCA9IGV2ZW50LnRyYW5zYWN0aW9uc1tpXVxuICAgICAgY29uc3Qgcm93ID0gcGFnZS5kZXhPcmRlclR4Um93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICB0bXBsLmlkLnRleHRDb250ZW50ID0gdHJpbVN0cmluZ1dpdGhFbGxpcHNpcyh0eC5pZCwgMjApXG4gICAgICB0bXBsLmlkLnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0eC5pZClcbiAgICAgIHRtcGwudHlwZS50ZXh0Q29udGVudCA9IHdhbGxldHMudHhUeXBlU3RyaW5nKHR4LnR5cGUpXG4gICAgICBjb25zdCBhc3NldCA9IHR4QXNzZXQodHgudHlwZSwgZXZlbnQuc2VsbClcbiAgICAgIGlmICghYXNzZXQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcigndW5leHBlY3RlZCB0eCB0eXBlIGluIGRleCBvcmRlciBldmVudCcsIHR4LnR5cGUpXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICBjb25zdCBhc3NldEV4cGxvcmVyID0gQ29pbkV4cGxvcmVyc1thc3NldC5pZF1cbiAgICAgIGlmIChhc3NldEV4cGxvcmVyICYmIGFzc2V0RXhwbG9yZXJbbmV0XSkge1xuICAgICAgICB0bXBsLmV4cGxvcmVyTGluay5ocmVmID0gYXNzZXRFeHBsb3JlcltuZXRdKHR4LmlkKVxuICAgICAgfVxuICAgICAgdG1wbC5hbXQudGV4dENvbnRlbnQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKHR4LmFtb3VudCwgYXNzZXQudW5pdEluZm8pfSAke2Fzc2V0LnVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0LnRvTG93ZXJDYXNlKCl9YFxuICAgICAgdG1wbC5mZWVzLnRleHRDb250ZW50ID0gYCR7RG9jLmZvcm1hdENvaW5WYWx1ZSh0eC5mZWVzLCBhc3NldC51bml0SW5mbyl9ICR7YXNzZXQudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQudG9Mb3dlckNhc2UoKX1gXG4gICAgICBwYWdlLmRleE9yZGVyVHhzVGFibGVCb2R5LmFwcGVuZENoaWxkKHJvdylcbiAgICB9XG4gICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UuZGV4T3JkZXJEZXRhaWxzRm9ybSlcbiAgfVxuXG4gIHNob3dDZXhPcmRlckV2ZW50RGV0YWlscyAoZXZlbnQ6IENFWE9yZGVyRXZlbnQpIHtcbiAgICBjb25zdCB7IHBhZ2UsIG1rdDogeyBiYXNlSUQsIHF1b3RlSUQgfSB9ID0gdGhpc1xuICAgIGNvbnN0IGJhc2VBc3NldCA9IGFwcCgpLmFzc2V0c1tiYXNlSURdXG4gICAgY29uc3QgcXVvdGVBc3NldCA9IGFwcCgpLmFzc2V0c1txdW90ZUlEXVxuICAgIGNvbnN0IFtidWksIHF1aV0gPSBbYmFzZUFzc2V0LnVuaXRJbmZvLCBxdW90ZUFzc2V0LnVuaXRJbmZvXVxuICAgIGNvbnN0IFtiYXNlVGlja2VyLCBxdW90ZVRpY2tlcl0gPSBbYnVpLmNvbnZlbnRpb25hbC51bml0LCBxdWkuY29udmVudGlvbmFsLnVuaXRdXG5cbiAgICBwYWdlLmNleE9yZGVySUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKGV2ZW50LmlkLCAyMClcbiAgICBpZiAodGhpcy5jZXhPcmRlcklEQ29weUxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHBhZ2UuY29weUNleE9yZGVySUQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNleE9yZGVySURDb3B5TGlzdGVuZXIpXG4gICAgfVxuICAgIHRoaXMuY2V4T3JkZXJJRENvcHlMaXN0ZW5lciA9ICgpID0+IHsgc2V0dXBDb3B5QnRuKGV2ZW50LmlkLCBwYWdlLmNleE9yZGVySUQsIHBhZ2UuY29weUNleE9yZGVySUQsICcjMWU3ZDExJykgfVxuICAgIHBhZ2UuY29weUNleE9yZGVySUQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNleE9yZGVySURDb3B5TGlzdGVuZXIpXG4gICAgcGFnZS5jZXhPcmRlcklELnNldEF0dHJpYnV0ZSgndGl0bGUnLCBldmVudC5pZClcbiAgICBjb25zdCByYXRlID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIGV2ZW50LnJhdGUpXG4gICAgcGFnZS5jZXhPcmRlclJhdGUudGV4dENvbnRlbnQgPSBgJHtyYXRlfSAke2Jhc2VUaWNrZXJ9LyR7cXVvdGVUaWNrZXJ9YFxuICAgIHBhZ2UuY2V4T3JkZXJRdHkudGV4dENvbnRlbnQgPSBgJHtldmVudC5xdHkgLyBidWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3J9ICR7YmFzZVRpY2tlcn1gXG4gICAgaWYgKGV2ZW50LnNlbGwpIHtcbiAgICAgIHBhZ2UuY2V4T3JkZXJTaWRlLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfU0VMTClcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5jZXhPcmRlclNpZGUudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9CVVkpXG4gICAgfVxuICAgIHBhZ2UuY2V4T3JkZXJCYXNlRmlsbGVkLnRleHRDb250ZW50ID0gYCR7ZXZlbnQuYmFzZUZpbGxlZCAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3Rvcn0gJHtiYXNlVGlja2VyfWBcbiAgICBwYWdlLmNleE9yZGVyUXVvdGVGaWxsZWQudGV4dENvbnRlbnQgPSBgJHtldmVudC5xdW90ZUZpbGxlZCAvIHF1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3Rvcn0gJHtxdW90ZVRpY2tlcn1gXG4gICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UuY2V4T3JkZXJEZXRhaWxzRm9ybSlcbiAgfVxuXG4gIHNob3dEZXBvc2l0RXZlbnREZXRhaWxzIChldmVudDogRGVwb3NpdEV2ZW50LCBwZW5kaW5nOiBib29sZWFuKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UuZGVwb3NpdElELnRleHRDb250ZW50ID0gdHJpbVN0cmluZ1dpdGhFbGxpcHNpcyhldmVudC50cmFuc2FjdGlvbi5pZCwgMjApXG4gICAgaWYgKHRoaXMuZGVwb3NpdElEQ29weUxpc3RlbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHBhZ2UuY29weURlcG9zaXRJRC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZGVwb3NpdElEQ29weUxpc3RlbmVyKVxuICAgIH1cbiAgICB0aGlzLmRlcG9zaXRJRENvcHlMaXN0ZW5lciA9ICgpID0+IHsgc2V0dXBDb3B5QnRuKGV2ZW50LnRyYW5zYWN0aW9uLmlkLCBwYWdlLmRlcG9zaXRJRCwgcGFnZS5jb3B5RGVwb3NpdElELCAnIzFlN2QxMScpIH1cbiAgICBwYWdlLmNvcHlEZXBvc2l0SUQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmRlcG9zaXRJRENvcHlMaXN0ZW5lcilcbiAgICBwYWdlLmRlcG9zaXRJRC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZXZlbnQudHJhbnNhY3Rpb24uaWQpXG4gICAgY29uc3QgdW5pdEluZm8gPSBhcHAoKS5hc3NldHNbZXZlbnQuYXNzZXRJRF0udW5pdEluZm9cbiAgICBjb25zdCB1bml0ID0gdW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICBwYWdlLmRlcG9zaXRBbXQudGV4dENvbnRlbnQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKGV2ZW50LnRyYW5zYWN0aW9uLmFtb3VudCwgdW5pdEluZm8pfSAke3VuaXR9YFxuICAgIHBhZ2UuZGVwb3NpdEZlZXMudGV4dENvbnRlbnQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKGV2ZW50LnRyYW5zYWN0aW9uLmZlZXMsIHVuaXRJbmZvKX0gJHt1bml0fWBcbiAgICBwYWdlLmRlcG9zaXRTdGF0dXMudGV4dENvbnRlbnQgPSBwZW5kaW5nID8gaW50bC5wcmVwKGludGwuSURfUEVORElORykgOiBpbnRsLnByZXAoaW50bC5JRF9DT01QTEVURSlcbiAgICBEb2Muc2V0VmlzKCFwZW5kaW5nLCBwYWdlLmRlcG9zaXRDcmVkaXRTZWN0aW9uKVxuICAgIGlmICghcGVuZGluZykge1xuICAgICAgcGFnZS5kZXBvc2l0Q3JlZGl0LnRleHRDb250ZW50ID0gYCR7RG9jLmZvcm1hdENvaW5WYWx1ZShldmVudC5jZXhDcmVkaXQsIHVuaXRJbmZvKX0gJHt1bml0fWBcbiAgICB9XG4gICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UuZGVwb3NpdERldGFpbHNGb3JtKVxuICB9XG5cbiAgc2hvd1dpdGhkcmF3YWxFdmVudERldGFpbHMgKGV2ZW50OiBXaXRoZHJhd2FsRXZlbnQsIHBlbmRpbmc6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS53aXRoZHJhd2FsSUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKGV2ZW50LmlkLCAyMClcbiAgICBpZiAodGhpcy53aXRoZHJhd2FsSURDb3B5TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcGFnZS5jb3B5V2l0aGRyYXdhbElELnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy53aXRoZHJhd2FsSURDb3B5TGlzdGVuZXIpXG4gICAgfVxuICAgIHRoaXMud2l0aGRyYXdhbElEQ29weUxpc3RlbmVyID0gKCkgPT4geyBzZXR1cENvcHlCdG4oZXZlbnQuaWQsIHBhZ2Uud2l0aGRyYXdhbElELCBwYWdlLmNvcHlXaXRoZHJhd2FsSUQsICcjMWU3ZDExJykgfVxuICAgIHBhZ2UuY29weVdpdGhkcmF3YWxJRC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMud2l0aGRyYXdhbElEQ29weUxpc3RlbmVyKVxuICAgIHBhZ2Uud2l0aGRyYXdhbElELnNldEF0dHJpYnV0ZSgndGl0bGUnLCBldmVudC5pZClcbiAgICBjb25zdCB1bml0SW5mbyA9IGFwcCgpLmFzc2V0c1tldmVudC5hc3NldElEXS51bml0SW5mb1xuICAgIGNvbnN0IHVuaXQgPSB1bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgIHBhZ2Uud2l0aGRyYXdhbEFtdC50ZXh0Q29udGVudCA9IGAke0RvYy5mb3JtYXRDb2luVmFsdWUoZXZlbnQuY2V4RGViaXQsIHVuaXRJbmZvKX0gJHt1bml0fWBcbiAgICBwYWdlLndpdGhkcmF3YWxTdGF0dXMudGV4dENvbnRlbnQgPSBwZW5kaW5nID8gaW50bC5wcmVwKGludGwuSURfUEVORElORykgOiBpbnRsLnByZXAoaW50bC5JRF9DT01QTEVURSlcbiAgICBpZiAoZXZlbnQudHJhbnNhY3Rpb24pIHtcbiAgICAgIHBhZ2Uud2l0aGRyYXdhbFR4SUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKGV2ZW50LnRyYW5zYWN0aW9uLmlkLCAyMClcbiAgICAgIHBhZ2Uud2l0aGRyYXdhbFR4SUQuc2V0QXR0cmlidXRlKCd0aXRsZScsIGV2ZW50LnRyYW5zYWN0aW9uLmlkKVxuICAgICAgcGFnZS53aXRoZHJhd2FsUmVjZWl2ZWQudGV4dENvbnRlbnQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKGV2ZW50LnRyYW5zYWN0aW9uLmFtb3VudCwgdW5pdEluZm8pfSAke3VuaXR9YFxuICAgIH1cbiAgICB0aGlzLmZvcm1zLnNob3cocGFnZS53aXRoZHJhd2FsRGV0YWlsc0Zvcm0pXG4gIH1cblxuICBzaG93RXZlbnREZXRhaWxzIChldmVudElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBbZXZlbnRdID0gdGhpcy5ldmVudHNbZXZlbnRJRF1cbiAgICBpZiAoZXZlbnQuZGV4T3JkZXJFdmVudCkgdGhpcy5zaG93RGV4T3JkZXJFdmVudERldGFpbHMoZXZlbnQuZGV4T3JkZXJFdmVudClcbiAgICBpZiAoZXZlbnQuY2V4T3JkZXJFdmVudCkgdGhpcy5zaG93Q2V4T3JkZXJFdmVudERldGFpbHMoZXZlbnQuY2V4T3JkZXJFdmVudClcbiAgICBpZiAoZXZlbnQuZGVwb3NpdEV2ZW50KSB0aGlzLnNob3dEZXBvc2l0RXZlbnREZXRhaWxzKGV2ZW50LmRlcG9zaXRFdmVudCwgZXZlbnQucGVuZGluZylcbiAgICBpZiAoZXZlbnQud2l0aGRyYXdhbEV2ZW50KSB0aGlzLnNob3dXaXRoZHJhd2FsRXZlbnREZXRhaWxzKGV2ZW50LndpdGhkcmF3YWxFdmVudCwgZXZlbnQucGVuZGluZylcbiAgfVxufVxuXG5mdW5jdGlvbiB0cmltU3RyaW5nV2l0aEVsbGlwc2lzIChzdHI6IHN0cmluZywgbWF4TGVuOiBudW1iZXIpOiBzdHJpbmcge1xuICBpZiAoc3RyLmxlbmd0aCA8PSBtYXhMZW4pIHJldHVybiBzdHJcbiAgcmV0dXJuIGAke3N0ci5zdWJzdHJpbmcoMCwgbWF4TGVuIC8gMil9Li4uJHtzdHIuc3Vic3RyaW5nKHN0ci5sZW5ndGggLSBtYXhMZW4gLyAyKX1gXG59XG5cbmZ1bmN0aW9uIHN1bUJhbGFuY2VFZmZlY3RzIChhc3NldElEOiBudW1iZXIsIGJlOiBCYWxhbmNlRWZmZWN0cyk6IG51bWJlciB7XG4gIGxldCBzdW0gPSAwXG4gIGlmIChiZS5zZXR0bGVkW2Fzc2V0SURdKSBzdW0gKz0gYmUuc2V0dGxlZFthc3NldElEXVxuICBpZiAoYmUucGVuZGluZ1thc3NldElEXSkgc3VtICs9IGJlLnBlbmRpbmdbYXNzZXRJRF1cbiAgaWYgKGJlLmxvY2tlZFthc3NldElEXSkgc3VtICs9IGJlLmxvY2tlZFthc3NldElEXVxuICBpZiAoYmUucmVzZXJ2ZWRbYXNzZXRJRF0pIHN1bSArPSBiZS5yZXNlcnZlZFthc3NldElEXVxuICByZXR1cm4gc3VtXG59XG4iLCJpbXBvcnQge1xuICBQYWdlRWxlbWVudCxcbiAgQm90Q29uZmlnLFxuICBPcmRlclBsYWNlbWVudCxcbiAgYXBwLFxuICBTcG90LFxuICBNYXJrZXRSZXBvcnQsXG4gIE9yZGVyT3B0aW9uLFxuICBDRVhDb25maWcsXG4gIEJhc2ljTWFya2V0TWFraW5nQ29uZmlnLFxuICBBcmJNYXJrZXRNYWtpbmdDb25maWcsXG4gIFNpbXBsZUFyYkNvbmZpZyxcbiAgQXJiTWFya2V0TWFraW5nUGxhY2VtZW50LFxuICBFeGNoYW5nZUJhbGFuY2UsXG4gIE1hcmtldE1ha2luZ1N0YXR1cyxcbiAgTU1DRVhTdGF0dXMsXG4gIEJhbGFuY2VOb3RlLFxuICBCb3RBc3NldENvbmZpZyxcbiAgQXBwcm92YWxTdGF0dXMsXG4gIFN1cHBvcnRlZEFzc2V0LFxuICBXYWxsZXRTdGF0ZSxcbiAgVW5pdEluZm8sXG4gIFByb2plY3RlZEFsbG9jLFxuICBBc3NldEJvb2tpbmdGZWVzXG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgRG9jLCB7XG4gIE51bWJlcklucHV0LFxuICBNaW5pU2xpZGVyLFxuICBJbmNyZW1lbnRhbElucHV0LFxuICB0b0ZvdXJTaWdGaWdzLFxuICB0b1ByZWNpc2lvbixcbiAgcGFyc2VGbG9hdERlZmF1bHRcbn0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgU3RhdGUgZnJvbSAnLi9zdGF0ZSdcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgc2V0T3B0aW9uVGVtcGxhdGVzIH0gZnJvbSAnLi9vcHRzJ1xuaW1wb3J0IHtcbiAgTU0sXG4gIENFWERpc3BsYXlJbmZvcyxcbiAgYm90VHlwZUJhc2ljQXJiLFxuICBib3RUeXBlQXJiTU0sXG4gIGJvdFR5cGVCYXNpY01NLFxuICBydW5uaW5nQm90SW52ZW50b3J5LFxuICBzZXRNYXJrZXRFbGVtZW50cyxcbiAgc2V0Q2V4RWxlbWVudHMsXG4gIGNhbGN1bGF0ZVF1b3RlTG90LFxuICBQbGFjZW1lbnRzQ2hhcnQsXG4gIGxpdmVCb3RDb25maWcsXG4gIEdhcFN0cmF0ZWd5TXVsdGlwbGllcixcbiAgR2FwU3RyYXRlZ3lBYnNvbHV0ZSxcbiAgR2FwU3RyYXRlZ3lBYnNvbHV0ZVBsdXMsXG4gIEdhcFN0cmF0ZWd5UGVyY2VudCxcbiAgR2FwU3RyYXRlZ3lQZXJjZW50UGx1cyxcbiAgZmVlc0FuZENvbW1pdFxufSBmcm9tICcuL21tdXRpbCdcbmltcG9ydCB7IEZvcm1zLCBiaW5kIGFzIGJpbmRGb3JtLCBOZXdXYWxsZXRGb3JtLCBUb2tlbkFwcHJvdmFsRm9ybSwgRGVwb3NpdEFkZHJlc3MsIENFWENvbmZpZ3VyYXRpb25Gb3JtIH0gZnJvbSAnLi9mb3JtcydcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0ICogYXMgT3JkZXJVdGlsIGZyb20gJy4vb3JkZXJ1dGlsJ1xuXG5jb25zdCBzcGVjTEsgPSAnbGFzdE1NU3BlY3MnXG5jb25zdCBsYXN0Qm90c0xLID0gJ2xhc3RCb3RzJ1xuY29uc3QgbGFzdEFyYkV4Y2hhbmdlTEsgPSAnbGFzdEFyYkV4Y2hhbmdlJ1xuY29uc3QgYXJiTU1Sb3dDYWNoZUtleSA9ICdhcmJtbSdcblxuY29uc3QgZGVmYXVsdFN3YXBSZXNlcnZlcyA9IHtcbiAgbjogNTAsXG4gIHByZWM6IDAsXG4gIGluYzogMTAsXG4gIG1pblI6IDAsXG4gIG1heFI6IDEwMDAsXG4gIHJhbmdlOiAxMDAwXG59XG5jb25zdCBkZWZhdWx0T3JkZXJSZXNlcnZlcyA9IHtcbiAgZmFjdG9yOiAxLjAsXG4gIG1pblI6IDAsXG4gIG1heFI6IDMsXG4gIHJhbmdlOiAzLFxuICBwcmVjOiAzXG59XG5jb25zdCBkZWZhdWx0VHJhbnNmZXIgPSB7XG4gIGZhY3RvcjogMC4xLFxuICBtaW5SOiAwLFxuICBtYXhSOiAxLFxuICByYW5nZTogMVxufVxuY29uc3QgZGVmYXVsdFNsaXBwYWdlID0ge1xuICBmYWN0b3I6IDAuMDUsXG4gIG1pblI6IDAsXG4gIG1heFI6IDAuMyxcbiAgcmFuZ2U6IDAuMyxcbiAgcHJlYzogM1xufVxuY29uc3QgZGVmYXVsdERyaWZ0VG9sZXJhbmNlID0ge1xuICB2YWx1ZTogMC4wMDIsXG4gIG1pblY6IDAsXG4gIG1heFY6IDAuMDIsXG4gIHJhbmdlOiAwLjAyLFxuICBwcmVjOiA1XG59XG5jb25zdCBkZWZhdWx0T3JkZXJQZXJzaXN0ZW5jZSA9IHtcbiAgdmFsdWU6IDIwLFxuICBtaW5WOiAwLFxuICBtYXhWOiA0MCwgLy8gMTAgbWludXRlcyBAIDE1IHNlY29uZCBlcG9jaHNcbiAgcmFuZ2U6IDQwLFxuICBwcmVjOiAwXG59XG5jb25zdCBkZWZhdWx0UHJvZml0ID0ge1xuICBwcmVjOiAzLFxuICB2YWx1ZTogMC4wMSxcbiAgbWluVjogMC4wMDEsXG4gIG1heFY6IDAuMSxcbiAgcmFuZ2U6IDAuMSAtIDAuMDAxXG59XG5jb25zdCBkZWZhdWx0TGV2ZWxTcGFjaW5nID0ge1xuICBwcmVjOiAzLFxuICB2YWx1ZTogMC4wMDUsXG4gIG1pblY6IDAuMDAxLFxuICBtYXhWOiAwLjAyLFxuICByYW5nZTogMC4wMiAtIDAuMDAwMVxufVxuY29uc3QgZGVmYXVsdE1hdGNoQnVmZmVyID0ge1xuICB2YWx1ZTogMCxcbiAgcHJlYzogMyxcbiAgbWluVjogMCxcbiAgbWF4VjogMSxcbiAgcmFuZ2U6IDFcbn1cbmNvbnN0IGRlZmF1bHRMZXZlbHNQZXJTaWRlID0ge1xuICBwcmVjOiAwLFxuICBpbmM6IDEsXG4gIHZhbHVlOiAxLFxuICBtaW5WOiAxXG59XG5jb25zdCBkZWZhdWx0TG90c1BlckxldmVsID0ge1xuICBwcmVjOiAwLFxuICB2YWx1ZTogMSxcbiAgbWluVjogMSxcbiAgdXNkSW5jcmVtZW50OiAxMDBcbn1cbmNvbnN0IGRlZmF1bHRVU0RQZXJTaWRlID0ge1xuICBwcmVjOiAyXG59XG5cbmNvbnN0IGRlZmF1bHRNYXJrZXRNYWtpbmdDb25maWc6IENvbmZpZ1N0YXRlID0ge1xuICBnYXBTdHJhdGVneTogR2FwU3RyYXRlZ3lQZXJjZW50UGx1cyxcbiAgc2VsbFBsYWNlbWVudHM6IFtdLFxuICBidXlQbGFjZW1lbnRzOiBbXSxcbiAgZHJpZnRUb2xlcmFuY2U6IGRlZmF1bHREcmlmdFRvbGVyYW5jZS52YWx1ZSxcbiAgcHJvZml0OiAwLjAyLFxuICBvcmRlclBlcnNpc3RlbmNlOiBkZWZhdWx0T3JkZXJQZXJzaXN0ZW5jZS52YWx1ZSxcbiAgY2V4UmViYWxhbmNlOiB0cnVlLFxuICBzaW1wbGVBcmJMb3RzOiAxXG59IGFzIGFueSBhcyBDb25maWdTdGF0ZVxuXG5jb25zdCBkZWZhdWx0Qm90QXNzZXRDb25maWc6IEJvdEFzc2V0Q29uZmlnID0ge1xuICBzd2FwRmVlTjogZGVmYXVsdFN3YXBSZXNlcnZlcy5uLFxuICBvcmRlclJlc2VydmVzRmFjdG9yOiBkZWZhdWx0T3JkZXJSZXNlcnZlcy5mYWN0b3IsXG4gIHNsaXBwYWdlQnVmZmVyRmFjdG9yOiBkZWZhdWx0U2xpcHBhZ2UuZmFjdG9yLFxuICB0cmFuc2ZlckZhY3RvcjogZGVmYXVsdFRyYW5zZmVyLmZhY3RvclxufVxuXG4vLyBjZXhCdXR0b24gc3RvcmVzIHBhcnRzIG9mIGEgQ0VYIHNlbGVjdGlvbiBidXR0b24uXG5pbnRlcmZhY2UgY2V4QnV0dG9uIHtcbiAgbmFtZTogc3RyaW5nXG4gIGRpdjogUGFnZUVsZW1lbnRcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG59XG5cbi8qXG4gKiBDb25maWdTdGF0ZSBpcyBhbiBhbWFsZ2FtYXRpb24gb2YgQm90Q29uZmlnLCBBcmJNYXJrZXRNYWtpbmdDZmcsIGFuZFxuICogQmFzaWNNYXJrZXRNYWtpbmdDZmcuIENvbmZpZ1N0YXRlIHRyYWNrcyB0aGUgZ2xvYmFsIHN0YXRlIG9mIHRoZSBvcHRpb25zXG4gKiBwcmVzZW50ZWQgb24gdGhlIHBhZ2UsIHdpdGggYSBzaW5nbGUgZmllbGQgZm9yIGVhY2ggb3B0aW9uIC8gY29udHJvbCBlbGVtZW50LlxuICogQ29uZmlnU3RhdGUgaXMgbmVjZXNzYXJ5IGJlY2F1c2UgdGhlcmUgYXJlIGR1cGxpY2F0ZSBmaWVsZHMgaW4gdGhlIHZhcmlvdXNcbiAqIGNvbmZpZyBzdHJ1Y3RzLCBhbmQgdGhlIHBsYWNlbWVudCB0eXBlcyBhcmUgbm90IGlkZW50aWNhbC5cbiAqL1xuaW50ZXJmYWNlIENvbmZpZ1N0YXRlIHtcbiAgZ2FwU3RyYXRlZ3k6IHN0cmluZ1xuICBwcm9maXQ6IG51bWJlclxuICBkcmlmdFRvbGVyYW5jZTogbnVtYmVyXG4gIG9yZGVyUGVyc2lzdGVuY2U6IG51bWJlciAvLyBlcG9jaHNcbiAgY2V4UmViYWxhbmNlOiBib29sZWFuXG4gIGRpc2FibGVkOiBib29sZWFuXG4gIGJ1eVBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W11cbiAgc2VsbFBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W11cbiAgYmFzZU9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgcXVvdGVPcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gIGJhc2VDb25maWc6IEJvdEFzc2V0Q29uZmlnXG4gIHF1b3RlQ29uZmlnOiBCb3RBc3NldENvbmZpZ1xuICBzaW1wbGVBcmJMb3RzOiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIEJvdFNwZWNzIHtcbiAgaG9zdDogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICBib3RUeXBlOiBzdHJpbmdcbiAgY2V4TmFtZT86IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgTWFya2V0Um93IHtcbiAgdHI6IFBhZ2VFbGVtZW50XG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBob3N0OiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICBhcmJzOiBzdHJpbmdbXVxuICBzcG90OiBTcG90XG59XG5cbmludGVyZmFjZSBVSU9wdHMge1xuICB1c2luZ1VTRFBlclNpZGU/OiBib29sZWFuXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcmtldE1ha2VyU2V0dGluZ3NQYWdlIGV4dGVuZHMgQmFzZVBhZ2Uge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgZm9ybXM6IEZvcm1zXG4gIG9wdHM6IFVJT3B0c1xuICBuZXdXYWxsZXRGb3JtOiBOZXdXYWxsZXRGb3JtXG4gIGFwcHJvdmVUb2tlbkZvcm06IFRva2VuQXBwcm92YWxGb3JtXG4gIHdhbGxldEFkZHJGb3JtOiBEZXBvc2l0QWRkcmVzc1xuICBjZXhDb25maWdGb3JtOiBDRVhDb25maWd1cmF0aW9uRm9ybVxuICBjdXJyZW50TWFya2V0OiBzdHJpbmdcbiAgb3JpZ2luYWxDb25maWc6IENvbmZpZ1N0YXRlXG4gIHVwZGF0ZWRDb25maWc6IENvbmZpZ1N0YXRlXG4gIGNyZWF0aW5nTmV3Qm90OiBib29sZWFuXG4gIG1hcmtldFJlcG9ydDogTWFya2V0UmVwb3J0XG4gIHFjUHJvZml0OiBOdW1iZXJJbnB1dFxuICBxY1Byb2ZpdFNsaWRlcjogTWluaVNsaWRlclxuICBxY0xldmVsU3BhY2luZzogTnVtYmVySW5wdXRcbiAgcWNMZXZlbFNwYWNpbmdTbGlkZXI6IE1pbmlTbGlkZXJcbiAgcWNNYXRjaEJ1ZmZlcjogTnVtYmVySW5wdXRcbiAgcWNNYXRjaEJ1ZmZlclNsaWRlcjogTWluaVNsaWRlclxuICBxY0xldmVsc1BlclNpZGU6IEluY3JlbWVudGFsSW5wdXRcbiAgcWNMb3RzUGVyTGV2ZWw6IEluY3JlbWVudGFsSW5wdXRcbiAgcWNVU0RQZXJTaWRlOiBJbmNyZW1lbnRhbElucHV0XG4gIGNleEJhc2VCYWxhbmNlOiBFeGNoYW5nZUJhbGFuY2VcbiAgY2V4UXVvdGVCYWxhbmNlOiBFeGNoYW5nZUJhbGFuY2VcbiAgc3BlY3M6IEJvdFNwZWNzXG4gIG1rdElEOiBzdHJpbmdcbiAgZm9ybVNwZWNzOiBCb3RTcGVjc1xuICBmb3JtQ2V4ZXM6IFJlY29yZDxzdHJpbmcsIGNleEJ1dHRvbj5cbiAgcGxhY2VtZW50c0NhY2hlOiBSZWNvcmQ8c3RyaW5nLCBbT3JkZXJQbGFjZW1lbnRbXSwgT3JkZXJQbGFjZW1lbnRbXV0+XG4gIGJvdFR5cGVTZWxlY3RvcnM6IFBhZ2VFbGVtZW50W11cbiAgbWFya2V0Um93czogTWFya2V0Um93W11cbiAgbG90c1BlckxldmVsSW5jcmVtZW50OiBudW1iZXJcbiAgcGxhY2VtZW50c0NoYXJ0OiBQbGFjZW1lbnRzQ2hhcnRcbiAgYmFzZVBhbmU6IEFzc2V0UGFuZVxuICBxdW90ZVBhbmU6IEFzc2V0UGFuZVxuICBkcmlmdFRvbGVyYW5jZTogTnVtYmVySW5wdXRcbiAgZHJpZnRUb2xlcmFuY2VTbGlkZXI6IE1pbmlTbGlkZXJcbiAgb3JkZXJQZXJzaXN0ZW5jZTogTnVtYmVySW5wdXRcbiAgb3JkZXJQZXJzaXN0ZW5jZVNsaWRlcjogTWluaVNsaWRlclxuXG4gIGNvbnN0cnVjdG9yIChtYWluOiBIVE1MRWxlbWVudCwgc3BlY3M6IEJvdFNwZWNzKSB7XG4gICAgc3VwZXIoKVxuXG4gICAgdGhpcy5wbGFjZW1lbnRzQ2FjaGUgPSB7fVxuICAgIHRoaXMub3B0cyA9IHt9XG5cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMobWFpbilcblxuICAgIHRoaXMuZm9ybXMgPSBuZXcgRm9ybXMocGFnZS5mb3Jtcywge1xuICAgICAgY2xvc2VkOiAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5zcGVjcz8uaG9zdCB8fCAhdGhpcy5zcGVjcz8uYm90VHlwZSkgYXBwKCkubG9hZFBhZ2UoJ21tJylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5wbGFjZW1lbnRzQ2hhcnQgPSBuZXcgUGxhY2VtZW50c0NoYXJ0KHBhZ2UucGxhY2VtZW50c0NoYXJ0KVxuICAgIHRoaXMuYXBwcm92ZVRva2VuRm9ybSA9IG5ldyBUb2tlbkFwcHJvdmFsRm9ybShwYWdlLmFwcHJvdmVUb2tlbkZvcm0sICgpID0+IHsgdGhpcy5zdWJtaXRCb3RUeXBlKCkgfSlcbiAgICB0aGlzLndhbGxldEFkZHJGb3JtID0gbmV3IERlcG9zaXRBZGRyZXNzKHBhZ2Uud2FsbGV0QWRkckZvcm0pXG4gICAgdGhpcy5jZXhDb25maWdGb3JtID0gbmV3IENFWENvbmZpZ3VyYXRpb25Gb3JtKHBhZ2UuY2V4Q29uZmlnRm9ybSwgKGNleE5hbWU6IHN0cmluZykgPT4gdGhpcy5jZXhDb25maWd1cmVkKGNleE5hbWUpKVxuICAgIHBhZ2UucXVvdGVQYW5lID0gcGFnZS5iYXNlUGFuZS5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBwYWdlLmFzc2V0UGFuZUJveC5hcHBlbmRDaGlsZChwYWdlLnF1b3RlUGFuZSlcbiAgICB0aGlzLmJhc2VQYW5lID0gbmV3IEFzc2V0UGFuZSh0aGlzLCBwYWdlLmJhc2VQYW5lKVxuICAgIHRoaXMucXVvdGVQYW5lID0gbmV3IEFzc2V0UGFuZSh0aGlzLCBwYWdlLnF1b3RlUGFuZSlcblxuICAgIGFwcCgpLmhlYWRlclNwYWNlLmFwcGVuZENoaWxkKHBhZ2UubW1UaXRsZSlcblxuICAgIHNldE9wdGlvblRlbXBsYXRlcyhwYWdlKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhcbiAgICAgIHBhZ2Uub3JkZXJPcHRUbXBsLCBwYWdlLmJvb2xlYW5PcHRUbXBsLCBwYWdlLnJhbmdlT3B0VG1wbCwgcGFnZS5wbGFjZW1lbnRSb3dUbXBsLFxuICAgICAgcGFnZS5vcmFjbGVUbXBsLCBwYWdlLmNleE9wdFRtcGwsIHBhZ2UuYXJiQnR0blRtcGwsIHBhZ2UubWFya2V0Um93VG1wbCwgcGFnZS5uZWVkUmVnVG1wbFxuICAgIClcbiAgICBwYWdlLmJhc2VQYW5lLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKSAvLyBkb24ndCByZW1vdmUgZnJvbSBsYXlvdXRcblxuICAgIERvYy5iaW5kKHBhZ2UucmVzZXRCdXR0b24sICdjbGljaycsICgpID0+IHsgdGhpcy5zZXRPcmlnaW5hbFZhbHVlcygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS51cGRhdGVCdXR0b24sICdjbGljaycsICgpID0+IHsgdGhpcy5zYXZlU2V0dGluZ3MoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuY3JlYXRlQnV0dG9uLCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc2F2ZVNldHRpbmdzKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmRlbGV0ZUJ0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5kZWxldGUoKSB9KVxuICAgIGJpbmRGb3JtKHBhZ2UuYm90VHlwZUZvcm0sIHBhZ2UuYm90VHlwZVN1Ym1pdCwgKCkgPT4geyB0aGlzLnN1Ym1pdEJvdFR5cGUoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uubm9NYXJrZXRCdHRuLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd01hcmtldFNlbGVjdEZvcm0oKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuYm90VHlwZUhlYWRlciwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnJlc2hvd0JvdFR5cGVGb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmJvdFR5cGVDaGFuZ2VNYXJrZXQsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93TWFya2V0U2VsZWN0Rm9ybSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5tYXJrZXRIZWFkZXIsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93TWFya2V0U2VsZWN0Rm9ybSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5tYXJrZXRGaWx0ZXJJbnB1dCwgJ2lucHV0JywgKCkgPT4geyB0aGlzLnNvcnRNYXJrZXRSb3dzKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmNleFJlYmFsYW5jZUNoZWNrYm94LCAnY2hhbmdlJywgKCkgPT4geyB0aGlzLmF1dG9SZWJhbGFuY2VDaGFuZ2VkKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnN3aXRjaFRvQWR2YW5jZWQsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93QWR2YW5jZWRDb25maWcoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc3dpdGNoVG9RdWlja0NvbmZpZywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnN3aXRjaFRvUXVpY2tDb25maWcoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UucWNNYXRjaEJ1ZmZlciwgJ2NoYW5nZScsICgpID0+IHsgdGhpcy5tYXRjaEJ1ZmZlckNoYW5nZWQoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc3dpdGNoVG9VU0RQZXJTaWRlLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuY2hhbmdlU2lkZUNvbW1pdG1lbnREaWFsb2coKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc3dpdGNoVG9Mb3RzUGVyTGV2ZWwsICdjbGljaycsICgpID0+IHsgdGhpcy5jaGFuZ2VTaWRlQ29tbWl0bWVudERpYWxvZygpIH0pXG4gICAgLy8gR2FwIFN0cmF0ZWd5XG4gICAgRG9jLmJpbmQocGFnZS5nYXBTdHJhdGVneVNlbGVjdCwgJ2NoYW5nZScsICgpID0+IHtcbiAgICAgIGlmICghcGFnZS5nYXBTdHJhdGVneVNlbGVjdC52YWx1ZSkgcmV0dXJuXG4gICAgICBjb25zdCBnYXBTdHJhdGVneSA9IHBhZ2UuZ2FwU3RyYXRlZ3lTZWxlY3QudmFsdWVcbiAgICAgIHRoaXMuY2xlYXJQbGFjZW1lbnRzKHRoaXMudXBkYXRlZENvbmZpZy5nYXBTdHJhdGVneSlcbiAgICAgIHRoaXMubG9hZENhY2hlZFBsYWNlbWVudHMoZ2FwU3RyYXRlZ3kpXG4gICAgICB0aGlzLnVwZGF0ZWRDb25maWcuZ2FwU3RyYXRlZ3kgPSBnYXBTdHJhdGVneVxuICAgICAgdGhpcy5zZXRHYXBGYWN0b3JMYWJlbHMoZ2FwU3RyYXRlZ3kpXG4gICAgICB0aGlzLnVwZGF0ZU1vZGlmaWVkTWFya2VycygpXG4gICAgfSlcblxuICAgIC8vIEJ1eS9TZWxsIHBsYWNlbWVudHNcbiAgICBEb2MuYmluZChwYWdlLmFkZEJ1eVBsYWNlbWVudEJ0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5hZGRQbGFjZW1lbnQodHJ1ZSwgbnVsbClcbiAgICAgIHBhZ2UuYWRkQnV5UGxhY2VtZW50TG90cy52YWx1ZSA9ICcnXG4gICAgICBwYWdlLmFkZEJ1eVBsYWNlbWVudEdhcEZhY3Rvci52YWx1ZSA9ICcnXG4gICAgICB0aGlzLnVwZGF0ZU1vZGlmaWVkTWFya2VycygpXG4gICAgICB0aGlzLnBsYWNlbWVudHNDaGFydC5yZW5kZXIoKVxuICAgICAgdGhpcy51cGRhdGVBbGxvY2F0aW9ucygpXG4gICAgfSlcbiAgICBEb2MuYmluZChwYWdlLmFkZFNlbGxQbGFjZW1lbnRCdG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuYWRkUGxhY2VtZW50KGZhbHNlLCBudWxsKVxuICAgICAgcGFnZS5hZGRTZWxsUGxhY2VtZW50TG90cy52YWx1ZSA9ICcnXG4gICAgICBwYWdlLmFkZFNlbGxQbGFjZW1lbnRHYXBGYWN0b3IudmFsdWUgPSAnJ1xuICAgICAgdGhpcy51cGRhdGVNb2RpZmllZE1hcmtlcnMoKVxuICAgICAgdGhpcy5wbGFjZW1lbnRzQ2hhcnQucmVuZGVyKClcbiAgICAgIHRoaXMudXBkYXRlQWxsb2NhdGlvbnMoKVxuICAgIH0pXG5cbiAgICB0aGlzLmRyaWZ0VG9sZXJhbmNlID0gbmV3IE51bWJlcklucHV0KHBhZ2UuZHJpZnRUb2xlcmFuY2VJbnB1dCwge1xuICAgICAgcHJlYzogZGVmYXVsdERyaWZ0VG9sZXJhbmNlLnByZWMgLSAyLCAvLyBjb252ZXJ0aW5nIHRvIHBlcmNlbnQgZm9yIGRpc3BsYXlcbiAgICAgIHNpZ0ZpZ3M6IHRydWUsXG4gICAgICBtaW46IDAsXG4gICAgICBjaGFuZ2VkOiAocmF3VjogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UsIHByZWMgfSA9IGRlZmF1bHREcmlmdFRvbGVyYW5jZVxuICAgICAgICBjb25zdCBbdl0gPSB0b0ZvdXJTaWdGaWdzKHJhd1YgLyAxMDAsIHByZWMpXG4gICAgICAgIHRoaXMuZHJpZnRUb2xlcmFuY2VTbGlkZXIuc2V0VmFsdWUoKHYgLSBtaW5WKSAvIHJhbmdlKVxuICAgICAgICB0aGlzLnVwZGF0ZWRDb25maWcuZHJpZnRUb2xlcmFuY2UgPSB2XG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMuZHJpZnRUb2xlcmFuY2VTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLmRyaWZ0VG9sZXJhbmNlU2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IG1pblYsIHJhbmdlLCBwcmVjIH0gPSBkZWZhdWx0RHJpZnRUb2xlcmFuY2VcbiAgICAgIGNvbnN0IFt2XSA9IHRvRm91clNpZ0ZpZ3MobWluViArIHIgKiByYW5nZSwgcHJlYylcbiAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5kcmlmdFRvbGVyYW5jZSA9IHZcbiAgICAgIHRoaXMuZHJpZnRUb2xlcmFuY2Uuc2V0VmFsdWUodiAqIDEwMClcbiAgICB9KVxuXG4gICAgdGhpcy5vcmRlclBlcnNpc3RlbmNlID0gbmV3IE51bWJlcklucHV0KHBhZ2Uub3JkZXJQZXJzaXN0ZW5jZSwge1xuICAgICAgY2hhbmdlZDogKHY6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IG1pblYsIHJhbmdlIH0gPSBkZWZhdWx0T3JkZXJQZXJzaXN0ZW5jZVxuICAgICAgICB0aGlzLnVwZGF0ZWRDb25maWcub3JkZXJQZXJzaXN0ZW5jZSA9IHZcbiAgICAgICAgdGhpcy5vcmRlclBlcnNpc3RlbmNlU2xpZGVyLnNldFZhbHVlKCh2IC0gbWluVikgLyByYW5nZSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5vcmRlclBlcnNpc3RlbmNlU2xpZGVyID0gbmV3IE1pbmlTbGlkZXIocGFnZS5vcmRlclBlcnNpc3RlbmNlU2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IG1pblYsIHJhbmdlLCBwcmVjIH0gPSBkZWZhdWx0T3JkZXJQZXJzaXN0ZW5jZVxuICAgICAgY29uc3QgcmF3ViA9IG1pblYgKyByICogcmFuZ2VcbiAgICAgIGNvbnN0IFt2XSA9IHRvUHJlY2lzaW9uKHJhd1YsIHByZWMpXG4gICAgICB0aGlzLnVwZGF0ZWRDb25maWcub3JkZXJQZXJzaXN0ZW5jZSA9IHZcbiAgICAgIHRoaXMub3JkZXJQZXJzaXN0ZW5jZS5zZXRWYWx1ZSh2KVxuICAgIH0pXG5cbiAgICB0aGlzLnFjUHJvZml0ID0gbmV3IE51bWJlcklucHV0KHBhZ2UucWNQcm9maXQsIHtcbiAgICAgIHByZWM6IGRlZmF1bHRQcm9maXQucHJlYyAtIDIsIC8vIGNvbnZlcnRpbmcgdG8gcGVyY2VudFxuICAgICAgc2lnRmlnczogdHJ1ZSxcbiAgICAgIG1pbjogZGVmYXVsdFByb2ZpdC5taW5WICogMTAwLFxuICAgICAgY2hhbmdlZDogKHZQY3Q6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IG1pblYsIHJhbmdlIH0gPSBkZWZhdWx0UHJvZml0XG4gICAgICAgIGNvbnN0IHYgPSB2UGN0IC8gMTAwXG4gICAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5wcm9maXQgPSB2XG4gICAgICAgIHBhZ2UucHJvZml0SW5wdXQudmFsdWUgPSB0aGlzLnFjUHJvZml0LmlucHV0LnZhbHVlXG4gICAgICAgIHRoaXMucWNQcm9maXRTbGlkZXIuc2V0VmFsdWUoKHYgLSBtaW5WKSAvIHJhbmdlKVxuICAgICAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMucWNQcm9maXRTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLnFjUHJvZml0U2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IG1pblYsIHJhbmdlLCBwcmVjIH0gPSBkZWZhdWx0UHJvZml0XG4gICAgICBjb25zdCBbdl0gPSB0b0ZvdXJTaWdGaWdzKChtaW5WICsgciAqIHJhbmdlKSAqIDEwMCwgcHJlYylcbiAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5wcm9maXQgPSB2IC8gMTAwXG4gICAgICB0aGlzLnFjUHJvZml0LnNldFZhbHVlKHYpXG4gICAgICBwYWdlLnByb2ZpdElucHV0LnZhbHVlID0gdGhpcy5xY1Byb2ZpdC5pbnB1dC52YWx1ZVxuICAgICAgdGhpcy5xdWlja0NvbmZpZ1VwZGF0ZWQoKVxuICAgIH0pXG5cbiAgICB0aGlzLnFjTGV2ZWxTcGFjaW5nID0gbmV3IE51bWJlcklucHV0KHBhZ2UucWNMZXZlbFNwYWNpbmcsIHtcbiAgICAgIHByZWM6IGRlZmF1bHRMZXZlbFNwYWNpbmcucHJlYyAtIDIsIC8vIGNvbnZlcnRpbmcgdG8gcGVyY2VudFxuICAgICAgc2lnRmlnczogdHJ1ZSxcbiAgICAgIG1pbjogZGVmYXVsdExldmVsU3BhY2luZy5taW5WICogMTAwLFxuICAgICAgY2hhbmdlZDogKHZQY3Q6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IG1pblYsIHJhbmdlIH0gPSBkZWZhdWx0TGV2ZWxTcGFjaW5nXG4gICAgICAgIHRoaXMucWNMZXZlbFNwYWNpbmdTbGlkZXIuc2V0VmFsdWUoKHZQY3QgLyAxMDAgLSBtaW5WKSAvIHJhbmdlKVxuICAgICAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMucWNMZXZlbFNwYWNpbmdTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLnFjTGV2ZWxTcGFjaW5nU2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IG1pblYsIHJhbmdlIH0gPSBkZWZhdWx0TGV2ZWxTcGFjaW5nXG4gICAgICB0aGlzLnFjTGV2ZWxTcGFjaW5nLnNldFZhbHVlKG1pblYgKyByICogcmFuZ2UgKiAxMDApXG4gICAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gICAgfSlcblxuICAgIHRoaXMucWNNYXRjaEJ1ZmZlciA9IG5ldyBOdW1iZXJJbnB1dChwYWdlLnFjTWF0Y2hCdWZmZXIsIHtcbiAgICAgIHByZWM6IGRlZmF1bHRNYXRjaEJ1ZmZlci5wcmVjIC0gMiwgLy8gY29udmVydGluZyB0byBwZXJjZW50XG4gICAgICBzaWdGaWdzOiB0cnVlLFxuICAgICAgbWluOiBkZWZhdWx0TWF0Y2hCdWZmZXIubWluViAqIDEwMCxcbiAgICAgIGNoYW5nZWQ6ICh2UGN0OiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgeyBtaW5WLCByYW5nZSB9ID0gZGVmYXVsdE1hdGNoQnVmZmVyXG4gICAgICAgIHRoaXMucWNNYXRjaEJ1ZmZlclNsaWRlci5zZXRWYWx1ZSgodlBjdCAvIDEwMCAtIG1pblYpIC8gcmFuZ2UpXG4gICAgICAgIHRoaXMucXVpY2tDb25maWdVcGRhdGVkKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5xY01hdGNoQnVmZmVyU2xpZGVyID0gbmV3IE1pbmlTbGlkZXIocGFnZS5xY01hdGNoQnVmZmVyU2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IG1pblYsIHJhbmdlIH0gPSBkZWZhdWx0TWF0Y2hCdWZmZXJcbiAgICAgIHRoaXMucWNNYXRjaEJ1ZmZlci5zZXRWYWx1ZShtaW5WICsgciAqIHJhbmdlICogMTAwKVxuICAgICAgdGhpcy5xdWlja0NvbmZpZ1VwZGF0ZWQoKVxuICAgIH0pXG5cbiAgICB0aGlzLnFjTGV2ZWxzUGVyU2lkZSA9IG5ldyBJbmNyZW1lbnRhbElucHV0KHBhZ2UucWNMZXZlbHNQZXJTaWRlLCB7XG4gICAgICBwcmVjOiBkZWZhdWx0TGV2ZWxzUGVyU2lkZS5wcmVjLFxuICAgICAgbWluOiBkZWZhdWx0TGV2ZWxzUGVyU2lkZS5taW5WLFxuICAgICAgaW5jOiBkZWZhdWx0TGV2ZWxzUGVyU2lkZS5pbmMsXG4gICAgICBjaGFuZ2VkOiAodjogbnVtYmVyKSA9PiB7XG4gICAgICAgIHRoaXMucWNVU0RQZXJTaWRlLnNldFZhbHVlKHRoaXMubG90U2l6ZVVTRCgpICogdiAqIHRoaXMucWNMb3RzUGVyTGV2ZWwudmFsdWUoKSlcbiAgICAgICAgdGhpcy5xdWlja0NvbmZpZ1VwZGF0ZWQoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLnFjTG90c1BlckxldmVsID0gbmV3IEluY3JlbWVudGFsSW5wdXQocGFnZS5xY0xvdHNQZXJMZXZlbCwge1xuICAgICAgcHJlYzogZGVmYXVsdExvdHNQZXJMZXZlbC5wcmVjLFxuICAgICAgbWluOiBkZWZhdWx0TG90c1BlckxldmVsLm1pblYsXG4gICAgICBpbmM6IDEsIC8vIHNldCBzaG93UXVpY2tDb25maWdcbiAgICAgIGNoYW5nZWQ6ICh2OiBudW1iZXIpID0+IHtcbiAgICAgICAgdGhpcy5xY1VTRFBlclNpZGUuc2V0VmFsdWUodGhpcy5sb3RTaXplVVNEKCkgKiB2ICogdGhpcy5xY0xldmVsc1BlclNpZGUudmFsdWUoKSlcbiAgICAgICAgcGFnZS5xY1VTRFBlclNpZGVFY2hvLnRleHRDb250ZW50ID0gdGhpcy5xY1VTRFBlclNpZGUuaW5wdXQudmFsdWUgYXMgc3RyaW5nXG4gICAgICAgIHRoaXMucXVpY2tDb25maWdVcGRhdGVkKClcbiAgICAgIH0sXG4gICAgICBzZXQ6ICh2OiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgWywgc10gPSB0b0ZvdXJTaWdGaWdzKHYgKiB0aGlzLnFjTGV2ZWxzUGVyU2lkZS52YWx1ZSgpICogdGhpcy5sb3RTaXplVVNEKCksIDIpXG4gICAgICAgIHBhZ2UucWNVU0RQZXJTaWRlRWNoby50ZXh0Q29udGVudCA9IHNcbiAgICAgICAgcGFnZS5xY0xvdHNQZXJMZXZlbEVjaG8udGV4dENvbnRlbnQgPSBzXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMucWNVU0RQZXJTaWRlID0gbmV3IEluY3JlbWVudGFsSW5wdXQocGFnZS5xY1VTRFBlclNpZGUsIHtcbiAgICAgIHByZWM6IGRlZmF1bHRVU0RQZXJTaWRlLnByZWMsXG4gICAgICBtaW46IDEsIC8vIGNoYW5nZWQgYnkgc2hvd1F1aWNrQ29uZmlnXG4gICAgICBpbmM6IDEsIC8vIGNoYW5nZWQgYnkgc2hvd1F1aWNrQ29uZmlnXG4gICAgICBjaGFuZ2VkOiAodjogbnVtYmVyKSA9PiB7XG4gICAgICAgIHRoaXMucWNMb3RzUGVyTGV2ZWwuc2V0VmFsdWUodiAvIHRoaXMucWNMZXZlbHNQZXJTaWRlLnZhbHVlKCkgLyB0aGlzLmxvdFNpemVVU0QoKSlcbiAgICAgICAgcGFnZS5xY0xvdHNQZXJMZXZlbEVjaG8udGV4dENvbnRlbnQgPSB0aGlzLnFjTG90c1BlckxldmVsLmlucHV0LnZhbHVlIGFzIHN0cmluZ1xuICAgICAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gICAgICB9LFxuICAgICAgc2V0OiAodjogbnVtYmVyLCBzOiBzdHJpbmcpID0+IHtcbiAgICAgICAgcGFnZS5xY1VTRFBlclNpZGVFY2hvLnRleHRDb250ZW50ID0gc1xuICAgICAgICBwYWdlLnFjTG90c1BlckxldmVsRWNoby50ZXh0Q29udGVudCA9IFN0cmluZyhNYXRoLnJvdW5kKHYgLyB0aGlzLmxvdFNpemVVU0QoKSkpXG4gICAgICB9XG4gICAgfSlcblxuICAgIGNvbnN0IG1heWJlU3VibWl0QnV5Um93ID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSAhPT0gJ0VudGVyJykgcmV0dXJuXG4gICAgICBpZiAoXG4gICAgICAgICFpc05hTihwYXJzZUZsb2F0KHBhZ2UuYWRkQnV5UGxhY2VtZW50R2FwRmFjdG9yLnZhbHVlIHx8ICcnKSkgJiZcbiAgICAgICAgIWlzTmFOKHBhcnNlRmxvYXQocGFnZS5hZGRCdXlQbGFjZW1lbnRMb3RzLnZhbHVlIHx8ICcnKSlcbiAgICAgICkge1xuICAgICAgICBwYWdlLmFkZEJ1eVBsYWNlbWVudEJ0bi5jbGljaygpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkQnV5UGxhY2VtZW50R2FwRmFjdG9yLCAna2V5dXAnLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4geyBtYXliZVN1Ym1pdEJ1eVJvdyhlKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkQnV5UGxhY2VtZW50TG90cywgJ2tleXVwJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHsgbWF5YmVTdWJtaXRCdXlSb3coZSkgfSlcblxuICAgIGNvbnN0IG1heWJlU3VibWl0U2VsbFJvdyA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5rZXkgIT09ICdFbnRlcicpIHJldHVyblxuICAgICAgaWYgKFxuICAgICAgICAhaXNOYU4ocGFyc2VGbG9hdChwYWdlLmFkZFNlbGxQbGFjZW1lbnRHYXBGYWN0b3IudmFsdWUgfHwgJycpKSAmJlxuICAgICAgICAhaXNOYU4ocGFyc2VGbG9hdChwYWdlLmFkZFNlbGxQbGFjZW1lbnRMb3RzLnZhbHVlIHx8ICcnKSlcbiAgICAgICkge1xuICAgICAgICBwYWdlLmFkZFNlbGxQbGFjZW1lbnRCdG4uY2xpY2soKVxuICAgICAgfVxuICAgIH1cbiAgICBEb2MuYmluZChwYWdlLmFkZFNlbGxQbGFjZW1lbnRHYXBGYWN0b3IsICdrZXl1cCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7IG1heWJlU3VibWl0U2VsbFJvdyhlKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkU2VsbFBsYWNlbWVudExvdHMsICdrZXl1cCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7IG1heWJlU3VibWl0U2VsbFJvdyhlKSB9KVxuXG4gICAgRG9jLmJpbmQocGFnZS5wcm9maXRJbnB1dCwgJ2NoYW5nZScsICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UucHJvZml0SW5wdXRFcnIpXG4gICAgICBjb25zdCBzaG93RXJyb3IgPSAoZXJySUQ6IHN0cmluZykgPT4ge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLnByb2ZpdElucHV0RXJyKVxuICAgICAgICBwYWdlLnByb2ZpdElucHV0RXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGVycklEKVxuICAgICAgfVxuICAgICAgY29uc3QgcHJvZml0ID0gcGFyc2VGbG9hdChwYWdlLnByb2ZpdElucHV0LnZhbHVlIHx8ICcnKSAvIDEwMFxuICAgICAgaWYgKGlzTmFOKHByb2ZpdCkpIHJldHVybiBzaG93RXJyb3IoaW50bC5JRF9JTlZBTElEX1ZBTFVFKVxuICAgICAgaWYgKHByb2ZpdCA9PT0gMCkgcmV0dXJuIHNob3dFcnJvcihpbnRsLklEX05PX1pFUk8pXG4gICAgICB0aGlzLnVwZGF0ZWRDb25maWcucHJvZml0ID0gcHJvZml0XG4gICAgICB0aGlzLnVwZGF0ZU1vZGlmaWVkTWFya2VycygpXG4gICAgfSlcblxuICAgIHRoaXMuYm90VHlwZVNlbGVjdG9ycyA9IERvYy5hcHBseVNlbGVjdG9yKHBhZ2UuYm90VHlwZUZvcm0sICdbZGF0YS1ib3QtdHlwZV0nKVxuICAgIGZvciAoY29uc3QgZGl2IG9mIHRoaXMuYm90VHlwZVNlbGVjdG9ycykge1xuICAgICAgRG9jLmJpbmQoZGl2LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmIChkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdkaXNhYmxlZCcpKSByZXR1cm5cbiAgICAgICAgRG9jLmhpZGUocGFnZS5ib3RUeXBlRXJyKVxuICAgICAgICBwYWdlLmNleFNlbGVjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdkaXNhYmxlZCcsIGRpdi5kYXRhc2V0LmJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY01NKVxuICAgICAgICB0aGlzLnNldEJvdFR5cGVTZWxlY3RlZChkaXYuZGF0YXNldC5ib3RUeXBlIGFzIHN0cmluZylcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5uZXdXYWxsZXRGb3JtID0gbmV3IE5ld1dhbGxldEZvcm0oXG4gICAgICBwYWdlLm5ld1dhbGxldEZvcm0sXG4gICAgICBhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgICAgIHRoaXMuc3VibWl0Qm90VHlwZSgpXG4gICAgICB9XG4gICAgKVxuXG4gICAgYXBwKCkucmVnaXN0ZXJOb3RlRmVlZGVyKHtcbiAgICAgIGJhbGFuY2U6IChub3RlOiBCYWxhbmNlTm90ZSkgPT4geyB0aGlzLmhhbmRsZUJhbGFuY2VOb3RlKG5vdGUpIH1cbiAgICB9KVxuXG4gICAgdGhpcy5pbml0aWFsaXplKHNwZWNzKVxuICB9XG5cbiAgdW5sb2FkICgpIHtcbiAgICB0aGlzLmZvcm1zLmV4aXQoKVxuICB9XG5cbiAgYXN5bmMgaW5pdGlhbGl6ZSAoc3BlY3M/OiBCb3RTcGVjcykge1xuICAgIHRoaXMuc2V0dXBDRVhlcygpXG4gICAgdGhpcy5pbml0aWFsaXplTWFya2V0Um93cygpXG5cbiAgICBjb25zdCBpc1JlZnJlc2ggPSBzcGVjcyAmJiBPYmplY3Qua2V5cyhzcGVjcykubGVuZ3RoID09PSAwXG4gICAgaWYgKGlzUmVmcmVzaCkgc3BlY3MgPSBTdGF0ZS5mZXRjaExvY2FsKHNwZWNMSylcbiAgICBpZiAoIXNwZWNzIHx8ICFhcHAoKS53YWxsZXRNYXBbc3BlY3MuYmFzZUlEXSB8fCAhYXBwKCkud2FsbGV0TWFwW3NwZWNzLnF1b3RlSURdKSB7XG4gICAgICB0aGlzLnNob3dNYXJrZXRTZWxlY3RGb3JtKClcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIElmIHdlIGhhdmUgc3BlY3Mgc3BlY2lmeWluZyBvbmx5IGEgbWFya2V0LCBtYWtlIHN1cmUgdGhlIGNleCBuYW1lIGFuZFxuICAgIC8vIGJvdCB0eXBlIGFyZSBzZXQuXG4gICAgaWYgKHNwZWNzICYmICFzcGVjcy5ib3RUeXBlKSB7XG4gICAgICBjb25zdCBib3RDZmcgPSBsaXZlQm90Q29uZmlnKHNwZWNzLmhvc3QsIHNwZWNzLmJhc2VJRCwgc3BlY3MucXVvdGVJRClcbiAgICAgIHNwZWNzLmNleE5hbWUgPSBib3RDZmc/LmNleE5hbWUgPz8gJydcbiAgICAgIHNwZWNzLmJvdFR5cGUgPSBib3RUeXBlQmFzaWNNTVxuICAgICAgaWYgKGJvdENmZz8uYXJiTWFya2V0TWFraW5nQ29uZmlnKSBzcGVjcy5ib3RUeXBlID0gYm90VHlwZUFyYk1NXG4gICAgICBlbHNlIGlmIChib3RDZmc/LnNpbXBsZUFyYkNvbmZpZykgc3BlY3MuYm90VHlwZSA9IGJvdFR5cGVCYXNpY0FyYlxuICAgIH1cblxuICAgIC8vIE11c3QgYmUgYSByZWNvbmZpZy5cbiAgICB0aGlzLnNwZWNzID0gc3BlY3NcbiAgICBhd2FpdCB0aGlzLmZldGNoQ0VYQmFsYW5jZXMoc3BlY3MpXG4gICAgdGhpcy5jb25maWd1cmVVSSgpXG4gIH1cblxuICBhc3luYyBjb25maWd1cmVVSSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzcGVjcyB9ID0gdGhpc1xuICAgIGNvbnN0IHsgaG9zdCwgYmFzZUlELCBxdW90ZUlELCBjZXhOYW1lLCBib3RUeXBlIH0gPSBzcGVjc1xuXG4gICAgY29uc3QgW3sgc3ltYm9sOiBiYXNlU3ltYm9sLCB0b2tlbjogYmFzZVRva2VuIH0sIHsgc3ltYm9sOiBxdW90ZVN5bWJvbCwgdG9rZW46IHF1b3RlVG9rZW4gfV0gPSBbYXBwKCkuYXNzZXRzW2Jhc2VJRF0sIGFwcCgpLmFzc2V0c1txdW90ZUlEXV1cbiAgICB0aGlzLm1rdElEID0gYCR7YmFzZVN5bWJvbH1fJHtxdW90ZVN5bWJvbH1gXG4gICAgRG9jLmhpZGUoXG4gICAgICBwYWdlLmJvdFNldHRpbmdzQ29udGFpbmVyLCBwYWdlLm1hcmtldEJveCwgcGFnZS51cGRhdGVCdXR0b24sIHBhZ2UucmVzZXRCdXR0b24sXG4gICAgICBwYWdlLmNyZWF0ZUJ1dHRvbiwgcGFnZS5ub01hcmtldCwgcGFnZS5taXNzaW5nRmlhdFJhdGVzXG4gICAgKVxuXG4gICAgaWYgKFtiYXNlSUQsIHF1b3RlSUQsIGJhc2VUb2tlbj8ucGFyZW50SUQgPz8gYmFzZUlELCBxdW90ZVRva2VuPy5wYXJlbnRJRCA/PyBxdW90ZUlEXS5zb21lKChhc3NldElEOiBudW1iZXIpID0+ICFhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF0pKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLm1pc3NpbmdGaWF0UmF0ZXMpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBEb2Muc2hvdyhwYWdlLm1hcmtldExvYWRpbmcpXG4gICAgU3RhdGUuc3RvcmVMb2NhbChzcGVjTEssIHNwZWNzKVxuXG4gICAgY29uc3QgbW1TdGF0dXMgPSBhcHAoKS5tbVN0YXR1c1xuICAgIGNvbnN0IHZpZXdPbmx5ID0gaXNWaWV3T25seShzcGVjcywgbW1TdGF0dXMpXG4gICAgbGV0IGJvdENmZyA9IGxpdmVCb3RDb25maWcoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIGlmIChib3RDZmcpIHtcbiAgICAgIGNvbnN0IG9sZEJvdFR5cGUgPSBib3RDZmcuYXJiTWFya2V0TWFraW5nQ29uZmlnID8gYm90VHlwZUFyYk1NIDogYm90Q2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnID8gYm90VHlwZUJhc2ljTU0gOiBib3RUeXBlQmFzaWNBcmJcbiAgICAgIGlmIChvbGRCb3RUeXBlICE9PSBib3RUeXBlKSBib3RDZmcgPSB1bmRlZmluZWRcbiAgICB9XG4gICAgRG9jLnNldFZpcyhib3RDZmcsIHBhZ2UuZGVsZXRlQnR0bkJveClcblxuICAgIGNvbnN0IG9sZENmZyA9IHRoaXMub3JpZ2luYWxDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0TWFya2V0TWFraW5nQ29uZmlnLCB7XG4gICAgICBkaXNhYmxlZDogdmlld09ubHksXG4gICAgICBiYXNlT3B0aW9uczogdGhpcy5kZWZhdWx0V2FsbGV0T3B0aW9ucyhiYXNlSUQpLFxuICAgICAgcXVvdGVPcHRpb25zOiB0aGlzLmRlZmF1bHRXYWxsZXRPcHRpb25zKHF1b3RlSUQpLFxuICAgICAgYnV5UGxhY2VtZW50czogW10sXG4gICAgICBzZWxsUGxhY2VtZW50czogW10sXG4gICAgICBiYXNlQ29uZmlnOiBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0Qm90QXNzZXRDb25maWcpLFxuICAgICAgcXVvdGVDb25maWc6IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRCb3RBc3NldENvbmZpZylcbiAgICB9KSBhcyBDb25maWdTdGF0ZVxuXG4gICAgaWYgKGJvdENmZykge1xuICAgICAgY29uc3QgeyBiYXNpY01hcmtldE1ha2luZ0NvbmZpZzogbW1DZmcsIGFyYk1hcmtldE1ha2luZ0NvbmZpZzogYXJiTU1DZmcsIHNpbXBsZUFyYkNvbmZpZzogYXJiQ2ZnLCB1aUNvbmZpZzogeyBjZXhSZWJhbGFuY2UgfSB9ID0gYm90Q2ZnXG4gICAgICB0aGlzLmNyZWF0aW5nTmV3Qm90ID0gZmFsc2VcbiAgICAgIC8vIFRoaXMgaXMga2luZGEgc2xvcHB5LCBidXQgd2UnbGwgY29weSBhbnkgcmVsZXZhbnQgaXNzdWVzIGZyb20gdGhlXG4gICAgICAvLyBvbGQgY29uZmlnIGludG8gdGhlIG9yaWdpbmFsQ29uZmlnLlxuICAgICAgY29uc3QgaWR4ID0gb2xkQ2ZnIGFzIHsgW2s6IHN0cmluZ106IGFueSB9IC8vIHR5cGVzY3JpcHRcbiAgICAgIGZvciAoY29uc3QgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKGJvdENmZykpIGlmIChpZHhba10gIT09IHVuZGVmaW5lZCkgaWR4W2tdID0gdlxuXG4gICAgICBvbGRDZmcuYmFzZUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRCb3RBc3NldENvbmZpZywgYm90Q2ZnLnVpQ29uZmlnLmJhc2VDb25maWcpXG4gICAgICBvbGRDZmcucXVvdGVDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0Qm90QXNzZXRDb25maWcsIGJvdENmZy51aUNvbmZpZy5xdW90ZUNvbmZpZylcbiAgICAgIG9sZENmZy5iYXNlT3B0aW9ucyA9IGJvdENmZy5iYXNlV2FsbGV0T3B0aW9ucyB8fCB7fVxuICAgICAgb2xkQ2ZnLnF1b3RlT3B0aW9ucyA9IGJvdENmZy5xdW90ZVdhbGxldE9wdGlvbnMgfHwge31cbiAgICAgIG9sZENmZy5jZXhSZWJhbGFuY2UgPSBjZXhSZWJhbGFuY2VcblxuICAgICAgaWYgKG1tQ2ZnKSB7XG4gICAgICAgIG9sZENmZy5idXlQbGFjZW1lbnRzID0gbW1DZmcuYnV5UGxhY2VtZW50c1xuICAgICAgICBvbGRDZmcuc2VsbFBsYWNlbWVudHMgPSBtbUNmZy5zZWxsUGxhY2VtZW50c1xuICAgICAgICBvbGRDZmcuZHJpZnRUb2xlcmFuY2UgPSBtbUNmZy5kcmlmdFRvbGVyYW5jZVxuICAgICAgICBvbGRDZmcuZ2FwU3RyYXRlZ3kgPSBtbUNmZy5nYXBTdHJhdGVneVxuICAgICAgfSBlbHNlIGlmIChhcmJNTUNmZykge1xuICAgICAgICBjb25zdCB7IGJ1eVBsYWNlbWVudHMsIHNlbGxQbGFjZW1lbnRzIH0gPSBhcmJNTUNmZ1xuICAgICAgICBvbGRDZmcuYnV5UGxhY2VtZW50cyA9IEFycmF5LmZyb20oYnV5UGxhY2VtZW50cywgKHA6IEFyYk1hcmtldE1ha2luZ1BsYWNlbWVudCkgPT4geyByZXR1cm4geyBsb3RzOiBwLmxvdHMsIGdhcEZhY3RvcjogcC5tdWx0aXBsaWVyIH0gfSlcbiAgICAgICAgb2xkQ2ZnLnNlbGxQbGFjZW1lbnRzID0gQXJyYXkuZnJvbShzZWxsUGxhY2VtZW50cywgKHA6IEFyYk1hcmtldE1ha2luZ1BsYWNlbWVudCkgPT4geyByZXR1cm4geyBsb3RzOiBwLmxvdHMsIGdhcEZhY3RvcjogcC5tdWx0aXBsaWVyIH0gfSlcbiAgICAgICAgb2xkQ2ZnLnByb2ZpdCA9IGFyYk1NQ2ZnLnByb2ZpdFxuICAgICAgICBvbGRDZmcuZHJpZnRUb2xlcmFuY2UgPSBhcmJNTUNmZy5kcmlmdFRvbGVyYW5jZVxuICAgICAgICBvbGRDZmcub3JkZXJQZXJzaXN0ZW5jZSA9IGFyYk1NQ2ZnLm9yZGVyUGVyc2lzdGVuY2VcbiAgICAgIH0gZWxzZSBpZiAoYXJiQ2ZnKSB7XG4gICAgICAgIC8vIFRPRE86IGV4cG9zZSBtYXhBY3RpdmVBcmJzXG4gICAgICAgIG9sZENmZy5wcm9maXQgPSBhcmJDZmcucHJvZml0VHJpZ2dlclxuICAgICAgICBvbGRDZmcub3JkZXJQZXJzaXN0ZW5jZSA9IGFyYkNmZy5udW1FcG9jaHNMZWF2ZU9wZW5cbiAgICAgICAgb2xkQ2ZnLnNpbXBsZUFyYkxvdHMgPSBib3RDZmcudWlDb25maWcuc2ltcGxlQXJiTG90cyA/PyAxXG4gICAgICB9XG4gICAgICBEb2Muc2V0VmlzKCF2aWV3T25seSwgcGFnZS51cGRhdGVCdXR0b24sIHBhZ2UucmVzZXRCdXR0b24pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY3JlYXRpbmdOZXdCb3QgPSB0cnVlXG4gICAgICBEb2Muc2V0VmlzKCF2aWV3T25seSwgcGFnZS5jcmVhdGVCdXR0b24pXG4gICAgfVxuXG4gICAgLy8gTm93IHRoYXQgd2UndmUgdXBkYXRlZCB0aGUgb3JpZ2luYWxDb25maWcsIHdlJ2xsIGNvcHkgaXQuXG4gICAgdGhpcy51cGRhdGVkQ29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvbGRDZmcpKVxuXG4gICAgc3dpdGNoIChib3RUeXBlKSB7XG4gICAgICBjYXNlIGJvdFR5cGVCYXNpY01NOlxuICAgICAgICBwYWdlLmJvdFR5cGVEaXNwbGF5LnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQk9UVFlQRV9CQVNJQ19NTSlcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgYm90VHlwZUFyYk1NOlxuICAgICAgICBwYWdlLmJvdFR5cGVEaXNwbGF5LnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQk9UVFlQRV9BUkJfTU0pXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIGJvdFR5cGVCYXNpY0FyYjpcbiAgICAgICAgcGFnZS5ib3RUeXBlRGlzcGxheS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0JPVFRZUEVfU0lNUExFX0FSQilcbiAgICB9XG5cbiAgICBzZXRNYXJrZXRFbGVtZW50cyhkb2N1bWVudC5ib2R5LCBiYXNlSUQsIHF1b3RlSUQsIGhvc3QpXG4gICAgRG9jLnNldFZpcyhib3RUeXBlICE9PSBib3RUeXBlQmFzaWNBcmIsIHBhZ2UuZHJpZnRUb2xlcmFuY2VCb3gsIHBhZ2Uuc3dpdGNoVG9BZHZhbmNlZClcbiAgICBEb2Muc2V0VmlzKEJvb2xlYW4oY2V4TmFtZSksIC4uLkRvYy5hcHBseVNlbGVjdG9yKGRvY3VtZW50LmJvZHksICdbZGF0YS1jZXgtc2hvd10nKSlcblxuICAgIERvYy5zZXRWaXModmlld09ubHksIHBhZ2Uudmlld09ubHlSdW5uaW5nKVxuICAgIERvYy5zZXRWaXMoY2V4TmFtZSwgcGFnZS5jZXhSZWJhbGFuY2VTZXR0aW5ncylcbiAgICBpZiAoY2V4TmFtZSkgc2V0Q2V4RWxlbWVudHMoZG9jdW1lbnQuYm9keSwgY2V4TmFtZSlcblxuICAgIGF3YWl0IHRoaXMuZmV0Y2hNYXJrZXRSZXBvcnQoKVxuXG4gICAgY29uc3QgbG90U2l6ZVVTRCA9IHRoaXMubG90U2l6ZVVTRCgpXG4gICAgdGhpcy5sb3RzUGVyTGV2ZWxJbmNyZW1lbnQgPSBNYXRoLnJvdW5kKE1hdGgubWF4KDEsIGRlZmF1bHRMb3RzUGVyTGV2ZWwudXNkSW5jcmVtZW50IC8gbG90U2l6ZVVTRCkpXG4gICAgdGhpcy5xY0xvdHNQZXJMZXZlbC5pbmMgPSB0aGlzLmxvdHNQZXJMZXZlbEluY3JlbWVudFxuICAgIHRoaXMucWNVU0RQZXJTaWRlLmluYyA9IHRoaXMubG90c1BlckxldmVsSW5jcmVtZW50ICogbG90U2l6ZVVTRFxuICAgIHRoaXMucWNVU0RQZXJTaWRlLm1pbiA9IGxvdFNpemVVU0RcblxuICAgIHRoaXMuYmFzZVBhbmUuc2V0QXNzZXQoYmFzZUlELCBmYWxzZSlcbiAgICB0aGlzLnF1b3RlUGFuZS5zZXRBc3NldChxdW90ZUlELCB0cnVlKVxuICAgIGNvbnN0IHsgbWFya2V0UmVwb3J0OiB7IGJhc2VGaWF0UmF0ZSB9IH0gPSB0aGlzXG4gICAgdGhpcy5wbGFjZW1lbnRzQ2hhcnQuc2V0TWFya2V0KHsgY2V4TmFtZTogY2V4TmFtZSBhcyBzdHJpbmcsIGJvdFR5cGUsIGJhc2VGaWF0UmF0ZSwgZGljdDogdGhpcy51cGRhdGVkQ29uZmlnIH0pXG5cbiAgICAvLyBJZiB0aGlzIGlzIGEgbmV3IGJvdCwgc2hvdyB0aGUgcXVpY2sgY29uZmlnIGZvcm0uXG4gICAgY29uc3QgaXNRdWlja1BsYWNlbWVudHMgPSAhYm90Q2ZnIHx8IHRoaXMuaXNRdWlja1BsYWNlbWVudHModGhpcy51cGRhdGVkQ29uZmlnLmJ1eVBsYWNlbWVudHMsIHRoaXMudXBkYXRlZENvbmZpZy5zZWxsUGxhY2VtZW50cylcbiAgICBjb25zdCBnYXBTdHJhdGVneSA9IGJvdENmZz8uYmFzaWNNYXJrZXRNYWtpbmdDb25maWc/LmdhcFN0cmF0ZWd5ID8/IEdhcFN0cmF0ZWd5UGVyY2VudFBsdXNcbiAgICBwYWdlLmdhcFN0cmF0ZWd5U2VsZWN0LnZhbHVlID0gZ2FwU3RyYXRlZ3lcbiAgICBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljQXJiIHx8IChpc1F1aWNrUGxhY2VtZW50cyAmJiBnYXBTdHJhdGVneSA9PT0gR2FwU3RyYXRlZ3lQZXJjZW50UGx1cykpIHRoaXMuc2hvd1F1aWNrQ29uZmlnKClcbiAgICBlbHNlIHRoaXMuc2hvd0FkdmFuY2VkQ29uZmlnKClcblxuICAgIHRoaXMuc2V0T3JpZ2luYWxWYWx1ZXMoKVxuXG4gICAgRG9jLmhpZGUocGFnZS5tYXJrZXRMb2FkaW5nKVxuICAgIERvYy5zaG93KHBhZ2UuYm90U2V0dGluZ3NDb250YWluZXIsIHBhZ2UubWFya2V0Qm94KVxuICB9XG5cbiAgaW5pdGlhbGl6ZU1hcmtldFJvd3MgKCkge1xuICAgIHRoaXMubWFya2V0Um93cyA9IFtdXG4gICAgRG9jLmVtcHR5KHRoaXMucGFnZS5tYXJrZXRTZWxlY3QpXG4gICAgZm9yIChjb25zdCB7IGhvc3QsIG1hcmtldHMsIGFzc2V0cywgYXV0aDogeyBlZmZlY3RpdmVUaWVyLCBwZW5kaW5nU3RyZW5ndGggfSB9IG9mIE9iamVjdC52YWx1ZXMoYXBwKCkuZXhjaGFuZ2VzKSkge1xuICAgICAgaWYgKGVmZmVjdGl2ZVRpZXIgKyBwZW5kaW5nU3RyZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc3QgeyBuZWVkUmVnVG1wbCwgbmVlZFJlZ0JveCB9ID0gdGhpcy5wYWdlXG4gICAgICAgIGNvbnN0IGJ0dG4gPSBuZWVkUmVnVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGJ0dG4pXG4gICAgICAgIERvYy5iaW5kKGJ0dG4sICdjbGljaycsICgpID0+IHsgYXBwKCkubG9hZFBhZ2UoJ3JlZ2lzdGVyJywgeyBob3N0LCBiYWNrVG86ICdtbXNldHRpbmdzJyB9KSB9KVxuICAgICAgICB0bXBsLmhvc3QudGV4dENvbnRlbnQgPSBob3N0XG4gICAgICAgIG5lZWRSZWdCb3guYXBwZW5kQ2hpbGQoYnR0bilcbiAgICAgICAgRG9jLnNob3cobmVlZFJlZ0JveClcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3QgeyBuYW1lLCBiYXNlaWQ6IGJhc2VJRCwgcXVvdGVpZDogcXVvdGVJRCwgc3BvdCwgYmFzZXN5bWJvbDogYmFzZVN5bWJvbCwgcXVvdGVzeW1ib2w6IHF1b3RlU3ltYm9sIH0gb2YgT2JqZWN0LnZhbHVlcyhtYXJrZXRzKSkge1xuICAgICAgICBpZiAoIWFwcCgpLmFzc2V0c1tiYXNlSURdIHx8ICFhcHAoKS5hc3NldHNbcXVvdGVJRF0pIGNvbnRpbnVlXG4gICAgICAgIGNvbnN0IHRyID0gdGhpcy5wYWdlLm1hcmtldFJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZSh0cilcbiAgICAgICAgY29uc3QgbXIgPSB7IHRyLCB0bXBsLCBob3N0OiBob3N0LCBuYW1lLCBiYXNlSUQsIHF1b3RlSUQsIHNwb3Q6IHNwb3QsIGFyYnM6IFtdIH0gYXMgTWFya2V0Um93XG4gICAgICAgIHRoaXMubWFya2V0Um93cy5wdXNoKG1yKVxuICAgICAgICB0aGlzLnBhZ2UubWFya2V0U2VsZWN0LmFwcGVuZENoaWxkKHRyKVxuICAgICAgICB0bXBsLmJhc2VJY29uLnNyYyA9IERvYy5sb2dvUGF0aChiYXNlU3ltYm9sKVxuICAgICAgICB0bXBsLnF1b3RlSWNvbi5zcmMgPSBEb2MubG9nb1BhdGgocXVvdGVTeW1ib2wpXG4gICAgICAgIHRtcGwuYmFzZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKGFzc2V0c1tiYXNlSURdLCB0cnVlKSlcbiAgICAgICAgdG1wbC5xdW90ZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKGFzc2V0c1txdW90ZUlEXSwgdHJ1ZSkpXG4gICAgICAgIHRtcGwuaG9zdC50ZXh0Q29udGVudCA9IGhvc3RcbiAgICAgICAgY29uc3QgY2V4SGFzTWFya2V0ID0gdGhpcy5jZXhNYXJrZXRTdXBwb3J0RmlsdGVyKGJhc2VJRCwgcXVvdGVJRClcbiAgICAgICAgZm9yIChjb25zdCBbY2V4TmFtZSwgZGluZm9dIG9mIE9iamVjdC5lbnRyaWVzKENFWERpc3BsYXlJbmZvcykpIHtcbiAgICAgICAgICBpZiAoY2V4SGFzTWFya2V0KGNleE5hbWUpKSB7XG4gICAgICAgICAgICBjb25zdCBpbWcgPSB0aGlzLnBhZ2UuYXJiQnR0blRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgICAgICBpbWcuc3JjID0gZGluZm8ubG9nb1xuICAgICAgICAgICAgdG1wbC5hcmJzLmFwcGVuZENoaWxkKGltZylcbiAgICAgICAgICAgIG1yLmFyYnMucHVzaChjZXhOYW1lKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBEb2MuYmluZCh0ciwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dCb3RUeXBlRm9ybShob3N0LCBiYXNlSUQsIHF1b3RlSUQpIH0pXG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLm1hcmtldFJvd3MubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCB7IG1hcmtldFNlbGVjdGlvblRhYmxlLCBtYXJrZXRGaWx0ZXJCb3gsIG5vTWFya2V0cyB9ID0gdGhpcy5wYWdlXG4gICAgICBEb2MuaGlkZShtYXJrZXRTZWxlY3Rpb25UYWJsZSwgbWFya2V0RmlsdGVyQm94KVxuICAgICAgRG9jLnNob3cobm9NYXJrZXRzKVxuICAgIH0gZWxzZSBEb2MuaGlkZSh0aGlzLnBhZ2Uubm9NYXJrZXRzKVxuICAgIGNvbnN0IGZpYXRSYXRlcyA9IGFwcCgpLmZpYXRSYXRlc01hcFxuICAgIHRoaXMubWFya2V0Um93cy5zb3J0KChhOiBNYXJrZXRSb3csIGI6IE1hcmtldFJvdykgPT4ge1xuICAgICAgbGV0IFt2b2xBLCB2b2xCXSA9IFthLnNwb3Q/LnZvbDI0ID8/IDAsIGIuc3BvdD8udm9sMjQgPz8gMF1cbiAgICAgIGlmIChmaWF0UmF0ZXNbYS5iYXNlSURdICYmIGZpYXRSYXRlc1tiLmJhc2VJRF0pIHtcbiAgICAgICAgdm9sQSAqPSBmaWF0UmF0ZXNbYS5iYXNlSURdXG4gICAgICAgIHZvbEIgKj0gZmlhdFJhdGVzW2IuYmFzZUlEXVxuICAgICAgfVxuICAgICAgcmV0dXJuIHZvbEIgLSB2b2xBXG4gICAgfSlcbiAgfVxuXG4gIHJ1bm5pbmdCb3RJbnZlbnRvcnkgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIHJldHVybiBydW5uaW5nQm90SW52ZW50b3J5KGFzc2V0SUQpXG4gIH1cblxuICBhZGp1c3RlZEJhbGFuY2VzIChiYXNlV2FsbGV0OiBXYWxsZXRTdGF0ZSwgcXVvdGVXYWxsZXQ6IFdhbGxldFN0YXRlKSB7XG4gICAgY29uc3QgeyBjZXhCYXNlQmFsYW5jZSwgY2V4UXVvdGVCYWxhbmNlIH0gPSB0aGlzXG4gICAgY29uc3QgW2JJbnYsIHFJbnZdID0gW3RoaXMucnVubmluZ0JvdEludmVudG9yeShiYXNlV2FsbGV0LmFzc2V0SUQpLCB0aGlzLnJ1bm5pbmdCb3RJbnZlbnRvcnkocXVvdGVXYWxsZXQuYXNzZXRJRCldXG4gICAgY29uc3QgW2NleEJhc2VBdmFpbCwgY2V4UXVvdGVBdmFpbF0gPSBbKGNleEJhc2VCYWxhbmNlPy5hdmFpbGFibGUgfHwgMCkgLSBiSW52LmNleC50b3RhbCwgKGNleFF1b3RlQmFsYW5jZT8uYXZhaWxhYmxlIHx8IDApIC0gcUludi5jZXgudG90YWxdXG4gICAgY29uc3QgW2RleEJhc2VBdmFpbCwgZGV4UXVvdGVBdmFpbF0gPSBbYmFzZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSAtIGJJbnYuZGV4LnRvdGFsLCBxdW90ZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSAtIHFJbnYuZGV4LnRvdGFsXVxuICAgIGNvbnN0IGJhc2VBdmFpbCA9IGRleEJhc2VBdmFpbCArIGNleEJhc2VBdmFpbFxuICAgIGNvbnN0IHF1b3RlQXZhaWwgPSBkZXhRdW90ZUF2YWlsICsgY2V4UXVvdGVBdmFpbFxuICAgIHJldHVybiB7IGJhc2VBdmFpbCwgcXVvdGVBdmFpbCwgZGV4QmFzZUF2YWlsLCBkZXhRdW90ZUF2YWlsLCBjZXhCYXNlQXZhaWwsIGNleFF1b3RlQXZhaWwgfVxuICB9XG5cbiAgbG90U2l6ZVVTRCAoKSB7XG4gICAgY29uc3QgeyBzcGVjczogeyBob3N0LCBiYXNlSUQgfSwgbWt0SUQsIG1hcmtldFJlcG9ydDogeyBiYXNlRmlhdFJhdGUgfSB9ID0gdGhpc1xuICAgIGNvbnN0IHhjID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdXG4gICAgY29uc3QgbWFya2V0ID0geGMubWFya2V0c1tta3RJRF1cbiAgICBjb25zdCB7IGxvdHNpemU6IGxvdFNpemUgfSA9IG1hcmtldFxuICAgIGNvbnN0IHsgdW5pdEluZm86IHVpIH0gPSBhcHAoKS5hc3NldHNbYmFzZUlEXVxuICAgIHJldHVybiBsb3RTaXplIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgKiBiYXNlRmlhdFJhdGVcbiAgfVxuXG4gIC8qXG4gICAgKiBtYXJrZXRTdHVmZiBpcyBqdXN0IGEgYnVuY2ggb2YgdXNlZnVsIHByb3BlcnRpZXMgZm9yIHRoZSBjdXJyZW50IHNwZWNzXG4gICAgKiBnYXRoZXJlZCBpbiBvbmUgcGxhY2UgYW5kIHdpdGggcHJlZmVyYWJsZSBuYW1lcy5cbiAgICAqL1xuICBtYXJrZXRTdHVmZiAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgcGFnZSwgc3BlY3M6IHsgaG9zdCwgYmFzZUlELCBxdW90ZUlELCBjZXhOYW1lLCBib3RUeXBlIH0sIGJhc2VQYW5lLCBxdW90ZVBhbmUsXG4gICAgICBtYXJrZXRSZXBvcnQ6IHsgYmFzZUZpYXRSYXRlLCBxdW90ZUZpYXRSYXRlLCBiYXNlRmVlcywgcXVvdGVGZWVzIH0sXG4gICAgICBsb3RzUGVyTGV2ZWxJbmNyZW1lbnQsIHVwZGF0ZWRDb25maWc6IGNmZywgb3JpZ2luYWxDb25maWc6IG9sZENmZywgbWt0SURcbiAgICB9ID0gdGhpc1xuICAgIGNvbnN0IHsgc3ltYm9sOiBiYXNlU3ltYm9sLCB1bml0SW5mbzogYnVpIH0gPSBhcHAoKS5hc3NldHNbYmFzZUlEXVxuICAgIGNvbnN0IHsgc3ltYm9sOiBxdW90ZVN5bWJvbCwgdW5pdEluZm86IHF1aSB9ID0gYXBwKCkuYXNzZXRzW3F1b3RlSURdXG4gICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbaG9zdF1cbiAgICBjb25zdCBtYXJrZXQgPSB4Yy5tYXJrZXRzW21rdElEXVxuICAgIGNvbnN0IHsgbG90c2l6ZTogbG90U2l6ZSwgc3BvdCB9ID0gbWFya2V0XG4gICAgY29uc3QgbG90U2l6ZVVTRCA9IGxvdFNpemUgLyBidWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgKiBiYXNlRmlhdFJhdGVcbiAgICBjb25zdCBhdG9taWNSYXRlID0gMSAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAqIGJhc2VGaWF0UmF0ZSAvIHF1b3RlRmlhdFJhdGUgKiBxdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICBjb25zdCB4Y1JhdGUgPSB7XG4gICAgICBjb252OiBxdW90ZUZpYXRSYXRlIC8gYmFzZUZpYXRSYXRlLFxuICAgICAgYXRvbWljOiBhdG9taWNSYXRlLFxuICAgICAgbXNnOiBNYXRoLnJvdW5kKGF0b21pY1JhdGUgKiBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yKSwgLy8gdW5hZGp1c3RlZFxuICAgICAgc3BvdFxuICAgIH1cblxuICAgIGxldCBbZGV4QmFzZUxvdHMsIGRleFF1b3RlTG90c10gPSBbY2ZnLnNpbXBsZUFyYkxvdHMsIGNmZy5zaW1wbGVBcmJMb3RzXVxuICAgIGlmIChib3RUeXBlICE9PSBib3RUeXBlQmFzaWNBcmIpIHtcbiAgICAgIGRleEJhc2VMb3RzID0gdGhpcy51cGRhdGVkQ29uZmlnLnNlbGxQbGFjZW1lbnRzLnJlZHVjZSgobG90czogbnVtYmVyLCBwOiBPcmRlclBsYWNlbWVudCkgPT4gbG90cyArIHAubG90cywgMClcbiAgICAgIGRleFF1b3RlTG90cyA9IHRoaXMudXBkYXRlZENvbmZpZy5idXlQbGFjZW1lbnRzLnJlZHVjZSgobG90czogbnVtYmVyLCBwOiBPcmRlclBsYWNlbWVudCkgPT4gbG90cyArIHAubG90cywgMClcbiAgICB9XG4gICAgY29uc3QgcXVvdGVMb3QgPSBjYWxjdWxhdGVRdW90ZUxvdChsb3RTaXplLCBiYXNlSUQsIHF1b3RlSUQsIHNwb3QpXG4gICAgY29uc3Qgd2FsbGV0U3R1ZmYgPSB0aGlzLndhbGxldFN0dWZmKClcbiAgICBjb25zdCB7IGJhc2VGZWVBc3NldElELCBxdW90ZUZlZUFzc2V0SUQsIGJhc2VJc0FjY291bnRMb2NrZXIsIHF1b3RlSXNBY2NvdW50TG9ja2VyIH0gPSB3YWxsZXRTdHVmZlxuXG4gICAgY29uc3QgeyBjb21taXQsIGZlZXMgfSA9IGZlZXNBbmRDb21taXQoXG4gICAgICBiYXNlSUQsIHF1b3RlSUQsIGJhc2VGZWVzLCBxdW90ZUZlZXMsIGxvdFNpemUsIGRleEJhc2VMb3RzLCBkZXhRdW90ZUxvdHMsXG4gICAgICBiYXNlRmVlQXNzZXRJRCwgcXVvdGVGZWVBc3NldElELCBiYXNlSXNBY2NvdW50TG9ja2VyLCBxdW90ZUlzQWNjb3VudExvY2tlcixcbiAgICAgIGNmZy5iYXNlQ29uZmlnLm9yZGVyUmVzZXJ2ZXNGYWN0b3IsIGNmZy5xdW90ZUNvbmZpZy5vcmRlclJlc2VydmVzRmFjdG9yXG4gICAgKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHBhZ2UsIGNmZywgb2xkQ2ZnLCBob3N0LCB4YywgYmFzZUlELCBxdW90ZUlELCBib3RUeXBlLCBjZXhOYW1lLCBiYXNlRmlhdFJhdGUsIHF1b3RlRmlhdFJhdGUsXG4gICAgICB4Y1JhdGUsIGJhc2VTeW1ib2wsIHF1b3RlU3ltYm9sLCBta3RJRCwgbG90U2l6ZSwgbG90U2l6ZVVTRCwgbG90c1BlckxldmVsSW5jcmVtZW50LFxuICAgICAgcXVvdGVMb3QsIGNvbW1pdCwgYmFzZVBhbmUsIHF1b3RlUGFuZSwgZmVlcywgLi4ud2FsbGV0U3R1ZmZcbiAgICB9XG4gIH1cblxuICB3YWxsZXRTdHVmZiAoKSB7XG4gICAgY29uc3QgeyBzcGVjczogeyBiYXNlSUQsIHF1b3RlSUQgfSB9ID0gdGhpc1xuICAgIGNvbnN0IFtiYXNlV2FsbGV0LCBxdW90ZVdhbGxldF0gPSBbYXBwKCkud2FsbGV0TWFwW2Jhc2VJRF0sIGFwcCgpLndhbGxldE1hcFtxdW90ZUlEXV1cbiAgICBjb25zdCBbeyB0b2tlbjogYmFzZVRva2VuLCB1bml0SW5mbzogYnVpIH0sIHsgdG9rZW46IHF1b3RlVG9rZW4sIHVuaXRJbmZvOiBxdWkgfV0gPSBbYXBwKCkuYXNzZXRzW2Jhc2VJRF0sIGFwcCgpLmFzc2V0c1txdW90ZUlEXV1cbiAgICBjb25zdCBiYXNlRmVlQXNzZXRJRCA9IGJhc2VUb2tlbiA/IGJhc2VUb2tlbi5wYXJlbnRJRCA6IGJhc2VJRFxuICAgIGNvbnN0IHF1b3RlRmVlQXNzZXRJRCA9IHF1b3RlVG9rZW4gPyBxdW90ZVRva2VuLnBhcmVudElEIDogcXVvdGVJRFxuICAgIGNvbnN0IFtiYXNlRmVlVUksIHF1b3RlRmVlVUldID0gW2FwcCgpLmFzc2V0c1tiYXNlRmVlQXNzZXRJRF0udW5pdEluZm8sIGFwcCgpLmFzc2V0c1txdW90ZUZlZUFzc2V0SURdLnVuaXRJbmZvXVxuICAgIGNvbnN0IHRyYWl0QWNjb3VudExvY2tlciA9IDEgPDwgMTRcbiAgICBjb25zdCBiYXNlSXNBY2NvdW50TG9ja2VyID0gKGJhc2VXYWxsZXQudHJhaXRzICYgdHJhaXRBY2NvdW50TG9ja2VyKSA+IDBcbiAgICBjb25zdCBxdW90ZUlzQWNjb3VudExvY2tlciA9IChxdW90ZVdhbGxldC50cmFpdHMgJiB0cmFpdEFjY291bnRMb2NrZXIpID4gMFxuICAgIHJldHVybiB7XG4gICAgICBiYXNlV2FsbGV0LCBxdW90ZVdhbGxldCwgYmFzZUZlZVVJLCBxdW90ZUZlZVVJLCBiYXNlVG9rZW4sIHF1b3RlVG9rZW4sXG4gICAgICBidWksIHF1aSwgYmFzZUZlZUFzc2V0SUQsIHF1b3RlRmVlQXNzZXRJRCwgYmFzZUlzQWNjb3VudExvY2tlciwgcXVvdGVJc0FjY291bnRMb2NrZXIsXG4gICAgICAuLi50aGlzLmFkanVzdGVkQmFsYW5jZXMoYmFzZVdhbGxldCwgcXVvdGVXYWxsZXQpXG4gICAgfVxuICB9XG5cbiAgc2hvd0FkdmFuY2VkQ29uZmlnICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBEb2Muc2hvdyhwYWdlLmFkdmFuY2VkQ29uZmlnKVxuICAgIERvYy5oaWRlKHBhZ2UucXVpY2tDb25maWcpXG4gICAgdGhpcy5wbGFjZW1lbnRzQ2hhcnQucmVuZGVyKClcbiAgfVxuXG4gIGlzUXVpY2tQbGFjZW1lbnRzIChidXlQbGFjZW1lbnRzOiBPcmRlclBsYWNlbWVudFtdLCBzZWxsUGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXSkge1xuICAgIGlmIChidXlQbGFjZW1lbnRzLmxlbmd0aCA9PT0gMCB8fCBidXlQbGFjZW1lbnRzLmxlbmd0aCAhPT0gc2VsbFBsYWNlbWVudHMubGVuZ3RoKSByZXR1cm4gZmFsc2VcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1eVBsYWNlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChidXlQbGFjZW1lbnRzW2ldLmdhcEZhY3RvciAhPT0gc2VsbFBsYWNlbWVudHNbaV0uZ2FwRmFjdG9yKSByZXR1cm4gZmFsc2VcbiAgICAgIGlmIChidXlQbGFjZW1lbnRzW2ldLmxvdHMgIT09IHNlbGxQbGFjZW1lbnRzW2ldLmxvdHMpIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgc3dpdGNoVG9RdWlja0NvbmZpZyAoKSB7XG4gICAgY29uc3QgeyBjZmcsIGJvdFR5cGUsIGxvdFNpemVVU0QgfSA9IHRoaXMubWFya2V0U3R1ZmYoKVxuICAgIGNvbnN0IHsgYnV5UGxhY2VtZW50czogYnV5cywgc2VsbFBsYWNlbWVudHM6IHNlbGxzIH0gPSBjZmdcbiAgICAvLyBJZiB3ZSBoYXZlIGJvdGggYnV5cyBhbmQgc2VsbHMsIGdldCB0aGUgYmVzdCBhcHByb3hpbWF0aW9uIHF1aWNrIGNvbmZpZ1xuICAgIC8vIGFwcHJveGltYXRpb24uXG4gICAgaWYgKGJ1eXMubGVuZ3RoID4gMCAmJiBzZWxscy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBiZXN0QnV5ID0gYnV5cy5yZWR1Y2UoKHByZXY6IE9yZGVyUGxhY2VtZW50LCBjdXJyOiBPcmRlclBsYWNlbWVudCkgPT4gY3Vyci5nYXBGYWN0b3IgPCBwcmV2LmdhcEZhY3RvciA/IGN1cnIgOiBwcmV2KVxuICAgICAgY29uc3QgYmVzdFNlbGwgPSBzZWxscy5yZWR1Y2UoKHByZXY6IE9yZGVyUGxhY2VtZW50LCBjdXJyOiBPcmRlclBsYWNlbWVudCkgPT4gY3Vyci5nYXBGYWN0b3IgPCBwcmV2LmdhcEZhY3RvciA/IGN1cnIgOiBwcmV2KVxuICAgICAgY29uc3QgcGxhY2VtZW50Q291bnQgPSBidXlzLmxlbmd0aCArIHNlbGxzLmxlbmd0aFxuICAgICAgY29uc3QgbGV2ZWxzUGVyU2lkZSA9IE1hdGgubWF4KDEsIE1hdGguZmxvb3IoKHBsYWNlbWVudENvdW50KSAvIDIpKVxuICAgICAgaWYgKGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY01NKSB7XG4gICAgICAgIGNmZy5wcm9maXQgPSAoYmVzdEJ1eS5nYXBGYWN0b3IgKyBiZXN0U2VsbC5nYXBGYWN0b3IpIC8gMlxuICAgICAgICBjb25zdCB3b3JzdEJ1eSA9IGJ1eXMucmVkdWNlKChwcmV2OiBPcmRlclBsYWNlbWVudCwgY3VycjogT3JkZXJQbGFjZW1lbnQpID0+IGN1cnIuZ2FwRmFjdG9yID4gcHJldi5nYXBGYWN0b3IgPyBjdXJyIDogcHJldilcbiAgICAgICAgY29uc3Qgd29yc3RTZWxsID0gc2VsbHMucmVkdWNlKChwcmV2OiBPcmRlclBsYWNlbWVudCwgY3VycjogT3JkZXJQbGFjZW1lbnQpID0+IGN1cnIuZ2FwRmFjdG9yID4gcHJldi5nYXBGYWN0b3IgPyBjdXJyIDogcHJldilcbiAgICAgICAgY29uc3QgcmFuZ2UgPSAoKHdvcnN0QnV5LmdhcEZhY3RvciAtIGJlc3RCdXkuZ2FwRmFjdG9yKSArICh3b3JzdFNlbGwuZ2FwRmFjdG9yIC0gYmVzdFNlbGwuZ2FwRmFjdG9yKSkgLyAyXG4gICAgICAgIGNvbnN0IGluYyA9IHJhbmdlIC8gKGxldmVsc1BlclNpZGUgLSAxKVxuICAgICAgICB0aGlzLnFjUHJvZml0LnNldFZhbHVlKGNmZy5wcm9maXQgKiAxMDApXG4gICAgICAgIHRoaXMucWNQcm9maXRTbGlkZXIuc2V0VmFsdWUoKGNmZy5wcm9maXQgLSBkZWZhdWx0UHJvZml0Lm1pblYpIC8gZGVmYXVsdFByb2ZpdC5yYW5nZSlcbiAgICAgICAgdGhpcy5xY0xldmVsU3BhY2luZy5zZXRWYWx1ZShpbmMgKiAxMDApXG4gICAgICAgIHRoaXMucWNMZXZlbFNwYWNpbmdTbGlkZXIuc2V0VmFsdWUoKGluYyAtIGRlZmF1bHRMZXZlbFNwYWNpbmcubWluVikgLyBkZWZhdWx0TGV2ZWxTcGFjaW5nLnJhbmdlKVxuICAgICAgfSBlbHNlIGlmIChib3RUeXBlID09PSBib3RUeXBlQXJiTU0pIHtcbiAgICAgICAgY29uc3QgbXVsdFN1bSA9IGJ1eXMucmVkdWNlKCh2OiBudW1iZXIsIHA6IE9yZGVyUGxhY2VtZW50KSA9PiB2ICsgcC5nYXBGYWN0b3IsIDApICsgc2VsbHMucmVkdWNlKCh2OiBudW1iZXIsIHA6IE9yZGVyUGxhY2VtZW50KSA9PiB2ICsgcC5nYXBGYWN0b3IsIDApXG4gICAgICAgIGNvbnN0IGJ1ZmZlciA9ICgobXVsdFN1bSAvIHBsYWNlbWVudENvdW50KSAtIDEpIHx8IGRlZmF1bHRNYXRjaEJ1ZmZlci52YWx1ZVxuICAgICAgICB0aGlzLnFjTWF0Y2hCdWZmZXIuc2V0VmFsdWUoYnVmZmVyICogMTAwKVxuICAgICAgICB0aGlzLnFjTWF0Y2hCdWZmZXJTbGlkZXIuc2V0VmFsdWUoKGJ1ZmZlciAtIGRlZmF1bHRNYXRjaEJ1ZmZlci5taW5WKSAvIGRlZmF1bHRNYXRjaEJ1ZmZlci5yYW5nZSlcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxvdHMgPSBidXlzLnJlZHVjZSgodjogbnVtYmVyLCBwOiBPcmRlclBsYWNlbWVudCkgPT4gdiArIHAubG90cywgMCkgKyBzZWxscy5yZWR1Y2UoKHY6IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IHYgKyBwLmxvdHMsIDApXG4gICAgICBjb25zdCBsb3RzUGVyTGV2ZWwgPSBNYXRoLm1heCgxLCBNYXRoLnJvdW5kKGxvdHMgLyAyIC8gbGV2ZWxzUGVyU2lkZSkpXG4gICAgICB0aGlzLnFjTG90c1BlckxldmVsLnNldFZhbHVlKGxvdHNQZXJMZXZlbClcbiAgICAgIHRoaXMucWNVU0RQZXJTaWRlLnNldFZhbHVlKGxvdHNQZXJMZXZlbCAqIGxldmVsc1BlclNpZGUgKiBsb3RTaXplVVNEKVxuICAgICAgdGhpcy5xY0xldmVsc1BlclNpZGUuc2V0VmFsdWUobGV2ZWxzUGVyU2lkZSlcbiAgICB9IGVsc2UgaWYgKGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY0FyYikge1xuICAgICAgdGhpcy5xY0xvdHNQZXJMZXZlbC5zZXRWYWx1ZShjZmcuc2ltcGxlQXJiTG90cylcbiAgICB9XG4gICAgdGhpcy5zaG93UXVpY2tDb25maWcoKVxuICAgIHRoaXMucXVpY2tDb25maWdVcGRhdGVkKClcbiAgfVxuXG4gIHNob3dRdWlja0NvbmZpZyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBsb3RTaXplVVNELCBib3RUeXBlLCBsb3RzUGVyTGV2ZWxJbmNyZW1lbnQgfSA9IHRoaXMubWFya2V0U3R1ZmYoKVxuXG4gICAgaWYgKCF0aGlzLnFjTGV2ZWxzUGVyU2lkZS5pbnB1dC52YWx1ZSkge1xuICAgICAgdGhpcy5xY0xldmVsc1BlclNpZGUuc2V0VmFsdWUoZGVmYXVsdExldmVsc1BlclNpZGUudmFsdWUpXG4gICAgICB0aGlzLnFjVVNEUGVyU2lkZS5zZXRWYWx1ZShkZWZhdWx0TGV2ZWxzUGVyU2lkZS52YWx1ZSAqICh0aGlzLnFjTG90c1BlckxldmVsLnZhbHVlKCkgfHwgbG90c1BlckxldmVsSW5jcmVtZW50KSAqIGxvdFNpemVVU0QpXG4gICAgfVxuICAgIGlmICghdGhpcy5xY0xvdHNQZXJMZXZlbC5pbnB1dC52YWx1ZSkge1xuICAgICAgdGhpcy5xY0xvdHNQZXJMZXZlbC5zZXRWYWx1ZShsb3RzUGVyTGV2ZWxJbmNyZW1lbnQpXG4gICAgICB0aGlzLnFjVVNEUGVyU2lkZS5zZXRWYWx1ZShsb3RTaXplVVNEICogbG90c1BlckxldmVsSW5jcmVtZW50ICogdGhpcy5xY0xldmVsc1BlclNpZGUudmFsdWUoKSlcbiAgICB9XG4gICAgaWYgKCFwYWdlLnFjTGV2ZWxTcGFjaW5nLnZhbHVlKSB7XG4gICAgICB0aGlzLnFjTGV2ZWxTcGFjaW5nLnNldFZhbHVlKGRlZmF1bHRMZXZlbFNwYWNpbmcudmFsdWUgKiAxMDApXG4gICAgICB0aGlzLnFjTGV2ZWxTcGFjaW5nU2xpZGVyLnNldFZhbHVlKChkZWZhdWx0TGV2ZWxTcGFjaW5nLnZhbHVlIC0gZGVmYXVsdExldmVsU3BhY2luZy5taW5WKSAvIGRlZmF1bHRMZXZlbFNwYWNpbmcucmFuZ2UpXG4gICAgfVxuICAgIGlmICghcGFnZS5xY01hdGNoQnVmZmVyLnZhbHVlKSBwYWdlLnFjTWF0Y2hCdWZmZXIudmFsdWUgPSBTdHJpbmcoZGVmYXVsdE1hdGNoQnVmZmVyLnZhbHVlICogMTAwKVxuXG4gICAgRG9jLmhpZGUocGFnZS5hZHZhbmNlZENvbmZpZylcbiAgICBEb2Muc2hvdyhwYWdlLnF1aWNrQ29uZmlnKVxuXG4gICAgdGhpcy5zaG93SW5wdXRzRm9yQm90KGJvdFR5cGUpXG4gIH1cblxuICBzaG93SW5wdXRzRm9yQm90IChib3RUeXBlOiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHBhZ2UsIG9wdHM6IHsgdXNpbmdVU0RQZXJTaWRlIH0gfSA9IHRoaXNcbiAgICBEb2MuaGlkZShcbiAgICAgIHBhZ2UubWF0Y2hNdWx0aXBsaWVyQm94LCBwYWdlLnBsYWNlbWVudHNDaGFydEJveCwgcGFnZS5wbGFjZW1lbnRDaGFydExlZ2VuZCxcbiAgICAgIHBhZ2UubG90c1BlckxldmVsTGFiZWwsIHBhZ2UubGV2ZWxTcGFjaW5nQm94LCBwYWdlLmFyYkxvdHNMYWJlbCwgcGFnZS5xY0xldmVsUGVyU2lkZUJveFxuICAgIClcbiAgICBEb2Muc2V0VmlzKHVzaW5nVVNEUGVyU2lkZSwgcGFnZS5xY1VTRFBlclNpZGVCb3gpXG4gICAgRG9jLnNldFZpcyghdXNpbmdVU0RQZXJTaWRlLCBwYWdlLnFjTG90c0JveClcbiAgICBzd2l0Y2ggKGJvdFR5cGUpIHtcbiAgICAgIGNhc2UgYm90VHlwZUFyYk1NOlxuICAgICAgICBEb2Muc2hvdyhcbiAgICAgICAgICBwYWdlLnFjTGV2ZWxQZXJTaWRlQm94LCBwYWdlLm1hdGNoTXVsdGlwbGllckJveCwgcGFnZS5wbGFjZW1lbnRzQ2hhcnRCb3gsXG4gICAgICAgICAgcGFnZS5wbGFjZW1lbnRDaGFydExlZ2VuZCwgcGFnZS5sb3RzUGVyTGV2ZWxMYWJlbFxuICAgICAgICApXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIGJvdFR5cGVCYXNpY01NOlxuICAgICAgICBEb2Muc2hvdyhcbiAgICAgICAgICBwYWdlLnFjTGV2ZWxQZXJTaWRlQm94LCBwYWdlLmxldmVsU3BhY2luZ0JveCwgcGFnZS5wbGFjZW1lbnRzQ2hhcnRCb3gsXG4gICAgICAgICAgcGFnZS5sb3RzUGVyTGV2ZWxMYWJlbFxuICAgICAgICApXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIGJvdFR5cGVCYXNpY0FyYjpcbiAgICAgICAgRG9jLnNob3cocGFnZS5hcmJMb3RzTGFiZWwpXG4gICAgfVxuICB9XG5cbiAgcXVpY2tDb25maWdVcGRhdGVkICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGNmZywgYm90VHlwZSwgY2V4TmFtZSB9ID0gdGhpcy5tYXJrZXRTdHVmZigpXG5cbiAgICBEb2MuaGlkZShwYWdlLnFjRXJyb3IpXG4gICAgY29uc3Qgc2V0RXJyb3IgPSAobXNnOiBzdHJpbmcpID0+IHtcbiAgICAgIHBhZ2UucWNFcnJvci50ZXh0Q29udGVudCA9IG1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5xY0Vycm9yKVxuICAgIH1cblxuICAgIGNvbnN0IGxldmVsc1BlclNpZGUgPSBib3RUeXBlID09PSBib3RUeXBlQmFzaWNBcmIgPyAxIDogdGhpcy5xY0xldmVsc1BlclNpZGUudmFsdWUoKVxuICAgIGlmIChpc05hTihsZXZlbHNQZXJTaWRlKSkge1xuICAgICAgc2V0RXJyb3IoJ2ludmFsaWQgdmFsdWUgZm9yIGxldmVscyBwZXIgc2lkZScpXG4gICAgfVxuXG4gICAgY29uc3QgbG90c1BlckxldmVsID0gdGhpcy5xY0xvdHNQZXJMZXZlbC52YWx1ZSgpXG4gICAgaWYgKGlzTmFOKGxvdHNQZXJMZXZlbCkpIHtcbiAgICAgIHNldEVycm9yKCdpbnZhbGlkIHZhbHVlIGZvciBsb3RzIHBlciBsZXZlbCcpXG4gICAgfVxuXG4gICAgY29uc3QgcHJvZml0ID0gcGFyc2VGbG9hdChwYWdlLnFjUHJvZml0LnZhbHVlID8/ICcnKSAvIDEwMFxuICAgIGlmIChpc05hTihwcm9maXQpKSB7XG4gICAgICBzZXRFcnJvcignaW52YWxpZCB2YWx1ZSBmb3IgcHJvZml0JylcbiAgICB9XG5cbiAgICBjb25zdCBsZXZlbFNwYWNpbmcgPSBib3RUeXBlID09PSBib3RUeXBlQmFzaWNNTSA/IHBhcnNlRmxvYXQocGFnZS5xY0xldmVsU3BhY2luZy52YWx1ZSA/PyAnJykgLyAxMDAgOiAwXG4gICAgaWYgKGlzTmFOKGxldmVsU3BhY2luZykpIHtcbiAgICAgIHNldEVycm9yKCdpbnZhbGlkIHZhbHVlIGZvciBsZXZlbCBzcGFjaW5nJylcbiAgICB9XG5cbiAgICBjb25zdCBtYXRjaEJ1ZmZlciA9IGJvdFR5cGUgPT09IGJvdFR5cGVBcmJNTSA/IHBhcnNlRmxvYXQocGFnZS5xY01hdGNoQnVmZmVyLnZhbHVlID8/ICcnKSAvIDEwMCA6IDBcbiAgICBpZiAoaXNOYU4obWF0Y2hCdWZmZXIpKSB7XG4gICAgICBzZXRFcnJvcignaW52YWxpZCB2YWx1ZSBmb3IgbWF0Y2ggYnVmZmVyJylcbiAgICB9XG4gICAgY29uc3QgbXVsdGlwbGllciA9IG1hdGNoQnVmZmVyICsgMVxuXG4gICAgY29uc3QgbGV2ZWxTcGFjaW5nRGlzYWJsZWQgPSBsZXZlbHNQZXJTaWRlID09PSAxXG4gICAgcGFnZS5sZXZlbFNwYWNpbmdCb3guY2xhc3NMaXN0LnRvZ2dsZSgnZGlzYWJsZWQnLCBsZXZlbFNwYWNpbmdEaXNhYmxlZClcbiAgICBwYWdlLnFjTGV2ZWxTcGFjaW5nLmRpc2FibGVkID0gbGV2ZWxTcGFjaW5nRGlzYWJsZWRcbiAgICBjZmcuc2ltcGxlQXJiTG90cyA9IGxvdHNQZXJMZXZlbFxuXG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY0FyYikge1xuICAgICAgdGhpcy5jbGVhclBsYWNlbWVudHMoY2V4TmFtZSA/IGFyYk1NUm93Q2FjaGVLZXkgOiBjZmcuZ2FwU3RyYXRlZ3kpXG4gICAgICBmb3IgKGxldCBsZXZlbE4gPSAwOyBsZXZlbE4gPCBsZXZlbHNQZXJTaWRlOyBsZXZlbE4rKykge1xuICAgICAgICBjb25zdCBwbGFjZW1lbnQgPSB7IGxvdHM6IGxvdHNQZXJMZXZlbCB9IGFzIE9yZGVyUGxhY2VtZW50XG4gICAgICAgIHBsYWNlbWVudC5nYXBGYWN0b3IgPSBib3RUeXBlID09PSBib3RUeXBlQmFzaWNNTSA/IHByb2ZpdCArIGxldmVsU3BhY2luZyAqIGxldmVsTiA6IG11bHRpcGxpZXJcbiAgICAgICAgY2ZnLmJ1eVBsYWNlbWVudHMucHVzaChwbGFjZW1lbnQpXG4gICAgICAgIGNmZy5zZWxsUGxhY2VtZW50cy5wdXNoKHBsYWNlbWVudClcbiAgICAgICAgLy8gQWRkIHJvd3MgaW4gdGhlIGFkdmFuY2VkIGNvbmZpZyB0YWJsZS5cbiAgICAgICAgdGhpcy5hZGRQbGFjZW1lbnQodHJ1ZSwgcGxhY2VtZW50KVxuICAgICAgICB0aGlzLmFkZFBsYWNlbWVudChmYWxzZSwgcGxhY2VtZW50KVxuICAgICAgfVxuXG4gICAgICB0aGlzLnBsYWNlbWVudHNDaGFydC5yZW5kZXIoKVxuICAgIH1cblxuICAgIHRoaXMudXBkYXRlQWxsb2NhdGlvbnMoKVxuICB9XG5cbiAgdXBkYXRlQWxsb2NhdGlvbnMgKCkge1xuICAgIHRoaXMudXBkYXRlQmFzZUFsbG9jYXRpb25zKClcbiAgICB0aGlzLnVwZGF0ZVF1b3RlQWxsb2NhdGlvbnMoKVxuICB9XG5cbiAgdXBkYXRlQmFzZUFsbG9jYXRpb25zICgpIHtcbiAgICBjb25zdCB7IGNvbW1pdCwgbG90U2l6ZSwgYmFzZVBhbmUsIGZlZXMgfSA9IHRoaXMubWFya2V0U3R1ZmYoKVxuXG4gICAgYmFzZVBhbmUudXBkYXRlSW52ZW50b3J5KGNvbW1pdC5kZXguYmFzZS5sb3RzLCBjb21taXQuZGV4LnF1b3RlLmxvdHMsIGxvdFNpemUsIGNvbW1pdC5kZXguYmFzZS52YWwsIGNvbW1pdC5jZXguYmFzZS52YWwsIGZlZXMuYmFzZSlcbiAgICBiYXNlUGFuZS51cGRhdGVDb21taXRUb3RhbCgpXG4gIH1cblxuICB1cGRhdGVRdW90ZUFsbG9jYXRpb25zICgpIHtcbiAgICBjb25zdCB7IGNvbW1pdCwgcXVvdGVMb3Q6IGxvdFNpemUsIHF1b3RlUGFuZSwgZmVlcyB9ID0gdGhpcy5tYXJrZXRTdHVmZigpXG5cbiAgICBxdW90ZVBhbmUudXBkYXRlSW52ZW50b3J5KGNvbW1pdC5kZXgucXVvdGUubG90cywgY29tbWl0LmRleC5iYXNlLmxvdHMsIGxvdFNpemUsIGNvbW1pdC5kZXgucXVvdGUudmFsLCBjb21taXQuY2V4LnF1b3RlLnZhbCwgZmVlcy5xdW90ZSlcbiAgICBxdW90ZVBhbmUudXBkYXRlQ29tbWl0VG90YWwoKVxuICB9XG5cbiAgbWF0Y2hCdWZmZXJDaGFuZ2VkICgpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBwYWdlLnFjTWF0Y2hCdWZmZXIudmFsdWUgPSBNYXRoLm1heCgwLCBwYXJzZUZsb2F0KHBhZ2UucWNNYXRjaEJ1ZmZlci52YWx1ZSA/PyAnJykgfHwgZGVmYXVsdE1hdGNoQnVmZmVyLnZhbHVlICogMTAwKS50b0ZpeGVkKDIpXG4gICAgdGhpcy5xdWlja0NvbmZpZ1VwZGF0ZWQoKVxuICB9XG5cbiAgc2hvd0FkZHJlc3MgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIHRoaXMud2FsbGV0QWRkckZvcm0uc2V0QXNzZXQoYXNzZXRJRClcbiAgICB0aGlzLmZvcm1zLnNob3codGhpcy5wYWdlLndhbGxldEFkZHJGb3JtKVxuICB9XG5cbiAgY2hhbmdlU2lkZUNvbW1pdG1lbnREaWFsb2cgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgb3B0cyB9ID0gdGhpc1xuICAgIG9wdHMudXNpbmdVU0RQZXJTaWRlID0gIW9wdHMudXNpbmdVU0RQZXJTaWRlXG4gICAgRG9jLnNldFZpcyhvcHRzLnVzaW5nVVNEUGVyU2lkZSwgcGFnZS5xY1VTRFBlclNpZGVCb3gpXG4gICAgRG9jLnNldFZpcyghb3B0cy51c2luZ1VTRFBlclNpZGUsIHBhZ2UucWNMb3RzQm94KVxuICB9XG5cbiAgYXN5bmMgc2hvd0JvdFR5cGVGb3JtIChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIsIGJvdFR5cGU/OiBzdHJpbmcsIGNvbmZpZ3VyZWRDRVg/OiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICB0aGlzLmZvcm1TcGVjcyA9IHsgaG9zdCwgYmFzZUlELCBxdW90ZUlELCBib3RUeXBlOiAnJyB9XG4gICAgY29uc3Qgdmlld09ubHkgPSBpc1ZpZXdPbmx5KHRoaXMuZm9ybVNwZWNzLCBhcHAoKS5tbVN0YXR1cylcbiAgICBpZiAodmlld09ubHkpIHtcbiAgICAgIGNvbnN0IGJvdENmZyA9IGxpdmVCb3RDb25maWcoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgICAgY29uc3Qgc3BlY3MgPSB0aGlzLnNwZWNzID0gdGhpcy5mb3JtU3BlY3NcbiAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICBjYXNlIEJvb2xlYW4oYm90Q2ZnPy5zaW1wbGVBcmJDb25maWcpOlxuICAgICAgICAgIHNwZWNzLmJvdFR5cGUgPSBib3RUeXBlQmFzaWNBcmJcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIEJvb2xlYW4oYm90Q2ZnPy5hcmJNYXJrZXRNYWtpbmdDb25maWcpOlxuICAgICAgICAgIHNwZWNzLmJvdFR5cGUgPSBib3RUeXBlQXJiTU1cbiAgICAgICAgICBicmVha1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHNwZWNzLmJvdFR5cGUgPSBib3RUeXBlQmFzaWNNTVxuICAgICAgfVxuICAgICAgc3BlY3MuY2V4TmFtZSA9IGJvdENmZz8uY2V4TmFtZVxuICAgICAgYXdhaXQgdGhpcy5mZXRjaENFWEJhbGFuY2VzKHRoaXMuZm9ybVNwZWNzKVxuICAgICAgYXdhaXQgdGhpcy5jb25maWd1cmVVSSgpXG4gICAgICB0aGlzLmZvcm1zLmNsb3NlKClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBzZXRNYXJrZXRFbGVtZW50cyhwYWdlLmJvdFR5cGVGb3JtLCBiYXNlSUQsIHF1b3RlSUQsIGhvc3QpXG4gICAgRG9jLmVtcHR5KHBhZ2UuYm90VHlwZUJhc2VTeW1ib2wsIHBhZ2UuYm90VHlwZVF1b3RlU3ltYm9sKVxuICAgIGNvbnN0IFtiLCBxXSA9IFthcHAoKS5hc3NldHNbYmFzZUlEXSwgYXBwKCkuYXNzZXRzW3F1b3RlSURdXVxuICAgIHBhZ2UuYm90VHlwZUJhc2VTeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShiLCB0cnVlKSlcbiAgICBwYWdlLmJvdFR5cGVRdW90ZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKHEsIHRydWUpKVxuICAgIGZvciAoY29uc3QgZGl2IG9mIHRoaXMuYm90VHlwZVNlbGVjdG9ycykgZGl2LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICBmb3IgKGNvbnN0IHsgZGl2IH0gb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmZvcm1DZXhlcykpIGRpdi5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgdGhpcy5zZXRDRVhBdmFpbGFiaWxpdHkoYmFzZUlELCBxdW90ZUlEKVxuICAgIERvYy5oaWRlKHBhZ2Uubm9DZXhlc0NvbmZpZ3VyZWQsIHBhZ2Uubm9DZXhNYXJrZXQsIHBhZ2Uubm9DZXhNYXJrZXRDb25maWd1cmVNb3JlLCBwYWdlLmJvdFR5cGVFcnIpXG4gICAgY29uc3QgY2V4SGFzTWFya2V0ID0gdGhpcy5jZXhNYXJrZXRTdXBwb3J0RmlsdGVyKGJhc2VJRCwgcXVvdGVJRClcbiAgICBjb25zdCBzdXBwb3J0aW5nQ2V4ZXM6IFJlY29yZDxzdHJpbmcsIENFWENvbmZpZz4gPSB7fVxuICAgIGZvciAoY29uc3QgY2V4IG9mIE9iamVjdC52YWx1ZXMoYXBwKCkubW1TdGF0dXMuY2V4ZXMpKSB7XG4gICAgICBpZiAoY2V4SGFzTWFya2V0KGNleC5jb25maWcubmFtZSkpIHN1cHBvcnRpbmdDZXhlc1tjZXguY29uZmlnLm5hbWVdID0gY2V4LmNvbmZpZ1xuICAgIH1cbiAgICBjb25zdCBuQ2V4ZXMgPSBPYmplY3Qua2V5cyhzdXBwb3J0aW5nQ2V4ZXMpLmxlbmd0aFxuICAgIGNvbnN0IGFyYkVuYWJsZWQgPSBuQ2V4ZXMgPiAwXG4gICAgZm9yIChjb25zdCBkaXYgb2YgdGhpcy5ib3RUeXBlU2VsZWN0b3JzKSBkaXYuY2xhc3NMaXN0LnRvZ2dsZSgnZGlzYWJsZWQnLCBkaXYuZGF0YXNldC5ib3RUeXBlICE9PSBib3RUeXBlQmFzaWNNTSAmJiAhYXJiRW5hYmxlZClcbiAgICBpZiAoT2JqZWN0LmtleXMoYXBwKCkubW1TdGF0dXMuY2V4ZXMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgRG9jLnNob3cocGFnZS5ub0NleGVzQ29uZmlndXJlZClcbiAgICAgIHRoaXMuc2V0Qm90VHlwZVNlbGVjdGVkKGJvdFR5cGVCYXNpY01NKVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsYXN0Qm90cyA9IChTdGF0ZS5mZXRjaExvY2FsKGxhc3RCb3RzTEspIHx8IHt9KSBhcyBSZWNvcmQ8c3RyaW5nLCBCb3RTcGVjcz5cbiAgICAgIGNvbnN0IGxhc3RCb3QgPSBsYXN0Qm90c1tgJHtiYXNlSUR9XyR7cXVvdGVJRH1fJHtob3N0fWBdXG4gICAgICBsZXQgY2V4OiBDRVhDb25maWcgfCB1bmRlZmluZWRcbiAgICAgIGJvdFR5cGUgPSBib3RUeXBlID8/IChsYXN0Qm90ID8gbGFzdEJvdC5ib3RUeXBlIDogYm90VHlwZUFyYk1NKVxuICAgICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NKSB7XG4gICAgICAgIC8vIEZvdXIgd2F5cyB0byBhdXRvLXNlbGVjdCBhIGNleC5cbiAgICAgICAgLy8gMS4gQ29taW5nIGJhY2sgZnJvbSB0aGUgY2V4IGNvbmZpZ3VyYXRpb24gZm9ybS5cbiAgICAgICAgaWYgKGNvbmZpZ3VyZWRDRVgpIGNleCA9IHN1cHBvcnRpbmdDZXhlc1tjb25maWd1cmVkQ0VYXVxuICAgICAgICAvLyAyLiBXZSBoYXZlIGEgc2F2ZWQgY29uZmlndXJhdGlvbi5cbiAgICAgICAgaWYgKCFjZXggJiYgbGFzdEJvdCkgY2V4ID0gc3VwcG9ydGluZ0NleGVzW2xhc3RCb3QuY2V4TmFtZSA/PyAnJ11cbiAgICAgICAgLy8gMy4gVGhlIGxhc3QgZXhjaGFuZ2UgdGhhdCB0aGUgdXNlciBzZWxlY3RlZC5cbiAgICAgICAgaWYgKCFjZXgpIHtcbiAgICAgICAgICBjb25zdCBsYXN0Q0VYID0gU3RhdGUuZmV0Y2hMb2NhbChsYXN0QXJiRXhjaGFuZ2VMSylcbiAgICAgICAgICBpZiAobGFzdENFWCkgY2V4ID0gc3VwcG9ydGluZ0NleGVzW2xhc3RDRVhdXG4gICAgICAgIH1cbiAgICAgICAgLy8gNC4gQW55IHN1cHBvcnRpbmcgY2V4LlxuICAgICAgICBpZiAoIWNleCAmJiBuQ2V4ZXMgPiAwKSBjZXggPSBPYmplY3QudmFsdWVzKHN1cHBvcnRpbmdDZXhlcylbMF1cbiAgICAgIH1cbiAgICAgIGlmIChjZXgpIHtcbiAgICAgICAgcGFnZS5jZXhTZWxlY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKVxuICAgICAgICB0aGlzLnNldEJvdFR5cGVTZWxlY3RlZChib3RUeXBlID8/IChsYXN0Qm90ID8gbGFzdEJvdC5ib3RUeXBlIDogYm90VHlwZUFyYk1NKSlcbiAgICAgICAgdGhpcy5zZWxlY3RGb3JtQ0VYKGNleC5uYW1lKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFnZS5jZXhTZWxlY3Rpb24uY2xhc3NMaXN0LmFkZCgnZGlzYWJsZWQnKVxuICAgICAgICBEb2Muc2hvdyhwYWdlLm5vQ2V4TWFya2V0KVxuICAgICAgICB0aGlzLnNldEJvdFR5cGVTZWxlY3RlZChib3RUeXBlQmFzaWNNTSlcbiAgICAgICAgLy8gSWYgdGhlcmUgYXJlIHVuY29uZmlndXJlZCBjZXhlcywgc2hvdyBjb25maWd1cmVNb3JlIG1lc3NhZ2UuXG4gICAgICAgIGNvbnN0IHVuY29uZmlndXJlZCA9IE9iamVjdC5rZXlzKENFWERpc3BsYXlJbmZvcykuZmlsdGVyKChjZXhOYW1lOiBzdHJpbmcpID0+ICFhcHAoKS5tbVN0YXR1cy5jZXhlc1tjZXhOYW1lXSlcbiAgICAgICAgY29uc3QgYWxsQ29uZmlndXJlZCA9IHVuY29uZmlndXJlZC5sZW5ndGggPT09IDAgfHwgKHVuY29uZmlndXJlZC5sZW5ndGggPT09IDEgJiYgKHVuY29uZmlndXJlZFswXSA9PT0gJ0JpbmFuY2UnIHx8IHVuY29uZmlndXJlZFswXSA9PT0gJ0JpbmFuY2VVUycpKVxuICAgICAgICBpZiAoIWFsbENvbmZpZ3VyZWQpIERvYy5zaG93KHBhZ2Uubm9DZXhNYXJrZXRDb25maWd1cmVNb3JlKVxuICAgICAgfVxuICAgIH1cblxuICAgIERvYy5zaG93KHBhZ2UuY2V4U2VsZWN0aW9uKVxuICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgYW55IGNleGVzIGNvbmZpZ3VyZWQuXG4gICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UuYm90VHlwZUZvcm0pXG4gIH1cblxuICByZXNob3dCb3RUeXBlRm9ybSAoKSB7XG4gICAgaWYgKGlzVmlld09ubHkodGhpcy5zcGVjcywgYXBwKCkubW1TdGF0dXMpKSB0aGlzLnNob3dNYXJrZXRTZWxlY3RGb3JtKClcbiAgICBjb25zdCB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCwgY2V4TmFtZSwgYm90VHlwZSB9ID0gdGhpcy5zcGVjc1xuICAgIHRoaXMuc2hvd0JvdFR5cGVGb3JtKGhvc3QsIGJhc2VJRCwgcXVvdGVJRCwgYm90VHlwZSwgY2V4TmFtZSlcbiAgfVxuXG4gIHNldEJvdFR5cGVTZWxlY3RlZCAoc2VsZWN0ZWRUeXBlOiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IGZvcm1TcGVjczogeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QgfSwgYm90VHlwZVNlbGVjdG9ycywgZm9ybUNleGVzIH0gPSB0aGlzXG4gICAgZm9yIChjb25zdCB7IGNsYXNzTGlzdCwgZGF0YXNldDogeyBib3RUeXBlIH0gfSBvZiBib3RUeXBlU2VsZWN0b3JzKSBjbGFzc0xpc3QudG9nZ2xlKCdzZWxlY3RlZCcsIGJvdFR5cGUgPT09IHNlbGVjdGVkVHlwZSlcbiAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIGEgY2V4IHNlbGVjdGVkLCBhdHRlbXB0IHRvIHNlbGVjdCBvbmVcbiAgICBpZiAoc2VsZWN0ZWRUeXBlID09PSBib3RUeXBlQmFzaWNNTSkgcmV0dXJuXG4gICAgY29uc3QgbW1TdGF0dXMgPSBhcHAoKS5tbVN0YXR1c1xuICAgIGlmIChPYmplY3Qua2V5cyhtbVN0YXR1cy5jZXhlcykubGVuZ3RoID09PSAwKSByZXR1cm5cbiAgICBjb25zdCBjZXhIYXNNYXJrZXQgPSB0aGlzLmNleE1hcmtldFN1cHBvcnRGaWx0ZXIoYmFzZUlELCBxdW90ZUlEKVxuICAgIC8vIElmIHRoZXJlIGlzIG9uZSBjdXJyZW50bHkgc2VsZWN0ZWQgYW5kIGl0IHN1cHBvcnRzIHRoaXMgbWFya2V0LCBsZWF2ZSBpdC5cbiAgICBjb25zdCBzZWxlY3RlZHMgPSBPYmplY3QudmFsdWVzKGZvcm1DZXhlcykuZmlsdGVyKChjZXg6IGNleEJ1dHRvbikgPT4gY2V4LmRpdi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpXG4gICAgaWYgKHNlbGVjdGVkcy5sZW5ndGggJiYgY2V4SGFzTWFya2V0KHNlbGVjdGVkc1swXS5uYW1lKSkgcmV0dXJuXG4gICAgLy8gU2VlIGlmIHdlIGhhdmUgYSBzYXZlZCBjb25maWd1cmF0aW9uLlxuICAgIGNvbnN0IGxhc3RCb3RzID0gKFN0YXRlLmZldGNoTG9jYWwobGFzdEJvdHNMSykgfHwge30pIGFzIFJlY29yZDxzdHJpbmcsIEJvdFNwZWNzPlxuICAgIGNvbnN0IGxhc3RCb3QgPSBsYXN0Qm90c1tgJHtiYXNlSUR9XyR7cXVvdGVJRH1fJHtob3N0fWBdXG4gICAgaWYgKGxhc3RCb3QpIHtcbiAgICAgIGNvbnN0IGNleCA9IG1tU3RhdHVzLmNleGVzW2xhc3RCb3QuY2V4TmFtZSA/PyAnJ11cbiAgICAgIGlmIChjZXggJiYgY2V4SGFzTWFya2V0KGNleC5jb25maWcubmFtZSkpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RGb3JtQ0VYKGNleC5jb25maWcubmFtZSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgfVxuICAgIC8vIDIuIFRoZSBsYXN0IGV4Y2hhbmdlIHRoYXQgdGhlIHVzZXIgc2VsZWN0ZWQuXG4gICAgY29uc3QgbGFzdENFWCA9IFN0YXRlLmZldGNoTG9jYWwobGFzdEFyYkV4Y2hhbmdlTEspXG4gICAgaWYgKGxhc3RDRVgpIHtcbiAgICAgIGNvbnN0IGNleCA9IG1tU3RhdHVzLmNleGVzW2xhc3RDRVhdXG4gICAgICBpZiAoY2V4ICYmIGNleEhhc01hcmtldChjZXguY29uZmlnLm5hbWUpKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0Rm9ybUNFWChjZXguY29uZmlnLm5hbWUpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgIH1cbiAgICAvLyAzLiBBbnkgc3VwcG9ydGluZyBjZXguXG4gICAgY29uc3QgY2V4ZXMgPSBPYmplY3QudmFsdWVzKG1tU3RhdHVzLmNleGVzKS5maWx0ZXIoKGNleDogTU1DRVhTdGF0dXMpID0+IGNleEhhc01hcmtldChjZXguY29uZmlnLm5hbWUpKVxuICAgIGlmIChjZXhlcy5sZW5ndGgpIHRoaXMuc2VsZWN0Rm9ybUNFWChjZXhlc1swXS5jb25maWcubmFtZSlcbiAgfVxuXG4gIHNob3dNYXJrZXRTZWxlY3RGb3JtICgpIHtcbiAgICB0aGlzLnBhZ2UubWFya2V0RmlsdGVySW5wdXQudmFsdWUgPSAnJ1xuICAgIHRoaXMuc29ydE1hcmtldFJvd3MoKVxuICAgIHRoaXMuZm9ybXMuc2hvdyh0aGlzLnBhZ2UubWFya2V0U2VsZWN0Rm9ybSlcbiAgfVxuXG4gIHNvcnRNYXJrZXRSb3dzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgZmlsdGVyID0gcGFnZS5tYXJrZXRGaWx0ZXJJbnB1dC52YWx1ZT8udG9Mb3dlckNhc2UoKVxuICAgIERvYy5lbXB0eShwYWdlLm1hcmtldFNlbGVjdClcbiAgICBmb3IgKGNvbnN0IG1yIG9mIHRoaXMubWFya2V0Um93cykge1xuICAgICAgbXIudHIuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgICAgaWYgKGZpbHRlciAmJiAhbXIubmFtZS5pbmNsdWRlcyhmaWx0ZXIpKSBjb250aW51ZVxuICAgICAgcGFnZS5tYXJrZXRTZWxlY3QuYXBwZW5kQ2hpbGQobXIudHIpXG4gICAgfVxuICB9XG5cbiAgaGFuZGxlQmFsYW5jZU5vdGUgKG46IEJhbGFuY2VOb3RlKSB7XG4gICAgdGhpcy5hcHByb3ZlVG9rZW5Gb3JtLmhhbmRsZUJhbGFuY2VOb3RlKG4pXG4gICAgaWYgKCF0aGlzLm1hcmtldFJlcG9ydCkgcmV0dXJuXG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQsIHF1b3RlVG9rZW4sIGJhc2VUb2tlbiB9ID0gdGhpcy5tYXJrZXRTdHVmZigpXG4gICAgaWYgKG4uYXNzZXRJRCA9PT0gYmFzZUlEIHx8IG4uYXNzZXRJRCA9PT0gYmFzZVRva2VuPy5wYXJlbnRJRCkge1xuICAgICAgdGhpcy5iYXNlUGFuZS51cGRhdGVCYWxhbmNlcygpXG4gICAgfSBlbHNlIGlmIChuLmFzc2V0SUQgPT09IHF1b3RlSUQgfHwgbi5hc3NldElEID09PSBxdW90ZVRva2VuPy5wYXJlbnRJRCkge1xuICAgICAgdGhpcy5xdW90ZVBhbmUudXBkYXRlQmFsYW5jZXMoKVxuICAgIH1cbiAgfVxuXG4gIGF1dG9SZWJhbGFuY2VDaGFuZ2VkICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHVwZGF0ZWRDb25maWc6IGNmZyB9ID0gdGhpc1xuICAgIGNmZy5jZXhSZWJhbGFuY2UgPSBwYWdlLmNleFJlYmFsYW5jZUNoZWNrYm94Py5jaGVja2VkID8/IGZhbHNlXG4gICAgdGhpcy51cGRhdGVBbGxvY2F0aW9ucygpXG4gIH1cblxuICBhc3luYyBzdWJtaXRCb3RUeXBlICgpIHtcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMucGFnZS5ib3RUeXBlRm9ybSlcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zdWJtaXRCb3RXaXRoVmFsaWRhdGlvbigpXG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGxvYWRlZCgpXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3VibWl0Qm90V2l0aFZhbGlkYXRpb24gKCkge1xuICAgIC8vIGNoZWNrIGZvciB3YWxsZXRzXG4gICAgY29uc3QgeyBwYWdlLCBmb3JtcywgZm9ybVNwZWNzOiB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCB9IH0gPSB0aGlzXG5cbiAgICBpZiAoIWFwcCgpLndhbGxldE1hcFtiYXNlSURdKSB7XG4gICAgICB0aGlzLm5ld1dhbGxldEZvcm0uc2V0QXNzZXQoYmFzZUlEKVxuICAgICAgZm9ybXMuc2hvdyh0aGlzLnBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoIWFwcCgpLndhbGxldE1hcFtxdW90ZUlEXSkge1xuICAgICAgdGhpcy5uZXdXYWxsZXRGb3JtLnNldEFzc2V0KHF1b3RlSUQpXG4gICAgICBmb3Jtcy5zaG93KHRoaXMucGFnZS5uZXdXYWxsZXRGb3JtKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIEFyZSB0b2tlbnMgYXBwcm92ZWQ/XG4gICAgY29uc3QgW2JBcHByb3ZhbCwgcUFwcHJvdmFsXSA9IHRva2VuQXNzZXRBcHByb3ZhbFN0YXR1c2VzKGhvc3QsIGFwcCgpLmFzc2V0c1tiYXNlSURdLCBhcHAoKS5hc3NldHNbcXVvdGVJRF0pXG4gICAgaWYgKGJBcHByb3ZhbCA9PT0gQXBwcm92YWxTdGF0dXMuTm90QXBwcm92ZWQpIHtcbiAgICAgIHRoaXMuYXBwcm92ZVRva2VuRm9ybS5zZXRBc3NldChiYXNlSUQsIGhvc3QpXG4gICAgICBmb3Jtcy5zaG93KHBhZ2UuYXBwcm92ZVRva2VuRm9ybSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAocUFwcHJvdmFsID09PSBBcHByb3ZhbFN0YXR1cy5Ob3RBcHByb3ZlZCkge1xuICAgICAgdGhpcy5hcHByb3ZlVG9rZW5Gb3JtLnNldEFzc2V0KHF1b3RlSUQsIGhvc3QpXG4gICAgICBmb3Jtcy5zaG93KHBhZ2UuYXBwcm92ZVRva2VuRm9ybSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHsgYm90VHlwZVNlbGVjdG9ycyB9ID0gdGhpc1xuICAgIGNvbnN0IHNlbGVjdGVkcyA9IGJvdFR5cGVTZWxlY3RvcnMuZmlsdGVyKChkaXY6IFBhZ2VFbGVtZW50KSA9PiBkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKVxuICAgIGlmIChzZWxlY3RlZHMubGVuZ3RoIDwgMSkge1xuICAgICAgcGFnZS5ib3RUeXBlRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fQk9UVFlQRSlcbiAgICAgIERvYy5zaG93KHBhZ2UuYm90VHlwZUVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBib3RUeXBlID0gdGhpcy5mb3JtU3BlY3MuYm90VHlwZSA9IHNlbGVjdGVkc1swXS5kYXRhc2V0LmJvdFR5cGUgPz8gJydcbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljTU0pIHtcbiAgICAgIGNvbnN0IHNlbGVjdGVkcyA9IE9iamVjdC52YWx1ZXModGhpcy5mb3JtQ2V4ZXMpLmZpbHRlcigoY2V4OiBjZXhCdXR0b24pID0+IGNleC5kaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKVxuICAgICAgaWYgKHNlbGVjdGVkcy5sZW5ndGggPCAxKSB7XG4gICAgICAgIHBhZ2UuYm90VHlwZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX0NFWClcbiAgICAgICAgRG9jLnNob3cocGFnZS5ib3RUeXBlRXJyKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvbnN0IGNleE5hbWUgPSBzZWxlY3RlZHNbMF0ubmFtZVxuICAgICAgdGhpcy5mb3JtU3BlY3MuY2V4TmFtZSA9IGNleE5hbWVcbiAgICAgIGF3YWl0IHRoaXMuZmV0Y2hDRVhCYWxhbmNlcyh0aGlzLmZvcm1TcGVjcylcbiAgICB9XG5cbiAgICB0aGlzLnNwZWNzID0gdGhpcy5mb3JtU3BlY3NcblxuICAgIHRoaXMuY29uZmlndXJlVUkoKVxuICAgIHRoaXMuZm9ybXMuY2xvc2UoKVxuICB9XG5cbiAgYXN5bmMgZmV0Y2hDRVhCYWxhbmNlcyAoc3BlY3M6IEJvdFNwZWNzKSB7XG4gICAgY29uc3QgeyBwYWdlIH0gPSB0aGlzXG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUsIGJvdFR5cGUgfSA9IHNwZWNzXG4gICAgaWYgKGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY01NIHx8ICFjZXhOYW1lKSByZXR1cm5cblxuICAgIHRyeSB7XG4gICAgICAvLyBUaGlzIHdvbid0IHdvcmsgaWYgd2UgaW1wbGVtZW50IGxpdmUgcmVjb25maWd1cmF0aW9uLCBiZWNhdXNlIGxvY2tlZFxuICAgICAgLy8gZnVuZHMgd291bGQgbmVlZCB0byBiZSBjb25zaWRlcmVkLlxuICAgICAgdGhpcy5jZXhCYXNlQmFsYW5jZSA9IGF3YWl0IE1NLmNleEJhbGFuY2UoY2V4TmFtZSwgYmFzZUlEKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHBhZ2UuYm90VHlwZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0NFWEJBTEFOQ0VfRVJSLCB7IGNleE5hbWUsIGFzc2V0SUQ6IFN0cmluZyhiYXNlSUQpLCBlcnI6IFN0cmluZyhlKSB9KVxuICAgICAgRG9jLnNob3cocGFnZS5ib3RUeXBlRXJyKVxuICAgICAgdGhyb3cgZVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICB0aGlzLmNleFF1b3RlQmFsYW5jZSA9IGF3YWl0IE1NLmNleEJhbGFuY2UoY2V4TmFtZSwgcXVvdGVJRClcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBwYWdlLmJvdFR5cGVFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9DRVhCQUxBTkNFX0VSUiwgeyBjZXhOYW1lLCBhc3NldElEOiBTdHJpbmcocXVvdGVJRCksIGVycjogU3RyaW5nKGUpIH0pXG4gICAgICBEb2Muc2hvdyhwYWdlLmJvdFR5cGVFcnIpXG4gICAgICB0aHJvdyBlXG4gICAgfVxuICB9XG5cbiAgZGVmYXVsdFdhbGxldE9wdGlvbnMgKGFzc2V0SUQ6IG51bWJlcik6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIGNvbnN0IHdhbGxldERlZiA9IGFwcCgpLmN1cnJlbnRXYWxsZXREZWZpbml0aW9uKGFzc2V0SUQpXG4gICAgaWYgKCF3YWxsZXREZWYubXVsdGlmdW5kaW5nb3B0cykge1xuICAgICAgcmV0dXJuIHt9XG4gICAgfVxuICAgIGNvbnN0IG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuICAgIGZvciAoY29uc3Qgb3B0IG9mIHdhbGxldERlZi5tdWx0aWZ1bmRpbmdvcHRzKSB7XG4gICAgICBpZiAob3B0LnF1b3RlQXNzZXRPbmx5ICYmIGFzc2V0SUQgIT09IHRoaXMuc3BlY3MucXVvdGVJRCkge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgb3B0aW9uc1tvcHQua2V5XSA9IGAke29wdC5kZWZhdWx0fWBcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnNcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZU1vZGlmaWVkTWFya2VycyBjaGVja3MgZWFjaCBvZiB0aGUgaW5wdXQgZWxlbWVudHMgb24gdGhlIHBhZ2UgYW5kXG4gICAqIGlmIHRoZSBjdXJyZW50IHZhbHVlIGRvZXMgbm90IG1hdGNoIHRoZSBvcmlnaW5hbCB2YWx1ZSAoc2luY2UgdGhlIGxhc3RcbiAgICogc2F2ZSksIHRoZW4gdGhlIGlucHV0IHdpbGwgaGF2ZSBhIGNvbG9yZWQgYm9yZGVyLlxuICAgKi9cbiAgdXBkYXRlTW9kaWZpZWRNYXJrZXJzICgpIHtcbiAgICBpZiAodGhpcy5jcmVhdGluZ05ld0JvdCkgcmV0dXJuXG4gICAgY29uc3QgeyBwYWdlLCBvcmlnaW5hbENvbmZpZzogb2xkQ2ZnLCB1cGRhdGVkQ29uZmlnOiBuZXdDZmcgfSA9IHRoaXNcblxuICAgIC8vIEdhcCBzdHJhdGVneSBpbnB1dFxuICAgIGNvbnN0IGdhcFN0cmF0ZWd5TW9kaWZpZWQgPSBvbGRDZmcuZ2FwU3RyYXRlZ3kgIT09IG5ld0NmZy5nYXBTdHJhdGVneVxuICAgIHBhZ2UuZ2FwU3RyYXRlZ3lTZWxlY3QuY2xhc3NMaXN0LnRvZ2dsZSgnbW9kaWZpZWQnLCBnYXBTdHJhdGVneU1vZGlmaWVkKVxuXG4gICAgY29uc3QgcHJvZml0TW9kaWZpZWQgPSBvbGRDZmcucHJvZml0ICE9PSBuZXdDZmcucHJvZml0XG4gICAgcGFnZS5wcm9maXRJbnB1dC5jbGFzc0xpc3QudG9nZ2xlKCdtb2RpZmllZCcsIHByb2ZpdE1vZGlmaWVkKVxuXG4gICAgLy8gQnV5IHBsYWNlbWVudHMgSW5wdXRcbiAgICBsZXQgYnV5UGxhY2VtZW50c01vZGlmaWVkID0gZmFsc2VcbiAgICBpZiAob2xkQ2ZnLmJ1eVBsYWNlbWVudHMubGVuZ3RoICE9PSBuZXdDZmcuYnV5UGxhY2VtZW50cy5sZW5ndGgpIHtcbiAgICAgIGJ1eVBsYWNlbWVudHNNb2RpZmllZCA9IHRydWVcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvbGRDZmcuYnV5UGxhY2VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAob2xkQ2ZnLmJ1eVBsYWNlbWVudHNbaV0ubG90cyAhPT0gbmV3Q2ZnLmJ1eVBsYWNlbWVudHNbaV0ubG90cyB8fFxuICAgICAgICAgIG9sZENmZy5idXlQbGFjZW1lbnRzW2ldLmdhcEZhY3RvciAhPT0gbmV3Q2ZnLmJ1eVBsYWNlbWVudHNbaV0uZ2FwRmFjdG9yKSB7XG4gICAgICAgICAgYnV5UGxhY2VtZW50c01vZGlmaWVkID0gdHJ1ZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcGFnZS5idXlQbGFjZW1lbnRzVGFibGVXcmFwcGVyLmNsYXNzTGlzdC50b2dnbGUoJ21vZGlmaWVkJywgYnV5UGxhY2VtZW50c01vZGlmaWVkKVxuXG4gICAgLy8gU2VsbCBwbGFjZW1lbnRzIGlucHV0XG4gICAgbGV0IHNlbGxQbGFjZW1lbnRzTW9kaWZpZWQgPSBmYWxzZVxuICAgIGlmIChvbGRDZmcuc2VsbFBsYWNlbWVudHMubGVuZ3RoICE9PSBuZXdDZmcuc2VsbFBsYWNlbWVudHMubGVuZ3RoKSB7XG4gICAgICBzZWxsUGxhY2VtZW50c01vZGlmaWVkID0gdHJ1ZVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9sZENmZy5zZWxsUGxhY2VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAob2xkQ2ZnLnNlbGxQbGFjZW1lbnRzW2ldLmxvdHMgIT09IG5ld0NmZy5zZWxsUGxhY2VtZW50c1tpXS5sb3RzIHx8XG4gICAgICAgICAgb2xkQ2ZnLnNlbGxQbGFjZW1lbnRzW2ldLmdhcEZhY3RvciAhPT0gbmV3Q2ZnLnNlbGxQbGFjZW1lbnRzW2ldLmdhcEZhY3Rvcikge1xuICAgICAgICAgIHNlbGxQbGFjZW1lbnRzTW9kaWZpZWQgPSB0cnVlXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBwYWdlLnNlbGxQbGFjZW1lbnRzVGFibGVXcmFwcGVyLmNsYXNzTGlzdC50b2dnbGUoJ21vZGlmaWVkJywgc2VsbFBsYWNlbWVudHNNb2RpZmllZClcbiAgfVxuXG4gIC8qXG4gICAqIGdhcEZhY3RvckhlYWRlclVuaXQgcmV0dXJucyB0aGUgaGVhZGVyIG9uIHRoZSBwbGFjZW1lbnRzIHRhYmxlIGFuZCB0aGVcbiAgICogdW5pdHMgaW4gdGhlIGdhcCBmYWN0b3Igcm93cyBuZWVkZWQgZm9yIGVhY2ggZ2FwIHN0cmF0ZWd5LlxuICAgKi9cbiAgZ2FwRmFjdG9ySGVhZGVyVW5pdCAoZ2FwU3RyYXRlZ3k6IHN0cmluZyk6IFtzdHJpbmcsIHN0cmluZ10ge1xuICAgIHN3aXRjaCAoZ2FwU3RyYXRlZ3kpIHtcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lNdWx0aXBsaWVyOlxuICAgICAgICByZXR1cm4gWydNdWx0aXBsaWVyJywgJ3gnXVxuICAgICAgY2FzZSBHYXBTdHJhdGVneUFic29sdXRlOlxuICAgICAgY2FzZSBHYXBTdHJhdGVneUFic29sdXRlUGx1czoge1xuICAgICAgICBjb25zdCByYXRlVW5pdCA9IGAke2FwcCgpLmFzc2V0c1t0aGlzLnNwZWNzLnF1b3RlSURdLnN5bWJvbH0vJHthcHAoKS5hc3NldHNbdGhpcy5zcGVjcy5iYXNlSURdLnN5bWJvbH1gXG4gICAgICAgIHJldHVybiBbJ1JhdGUnLCByYXRlVW5pdF1cbiAgICAgIH1cbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lQZXJjZW50OlxuICAgICAgY2FzZSBHYXBTdHJhdGVneVBlcmNlbnRQbHVzOlxuICAgICAgICByZXR1cm4gWydQZXJjZW50JywgJyUnXVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGdhcCBzdHJhdGVneSAke2dhcFN0cmF0ZWd5fWApXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogY2hlY2tHYXBGYWN0b3JSYW5nZSByZXR1cm5zIGFuIGVycm9yIHN0cmluZyBpZiB0aGUgdmFsdWUgaW5wdXQgZm9yIGFcbiAgICogZ2FwIGZhY3RvciBpcyB2YWxpZCBmb3IgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCBnYXAgc3RyYXRlZ3kuXG4gICAqL1xuICBjaGVja0dhcEZhY3RvclJhbmdlIChnYXBGYWN0b3I6IHN0cmluZywgdmFsdWU6IG51bWJlcik6IChzdHJpbmcgfCBudWxsKSB7XG4gICAgc3dpdGNoIChnYXBGYWN0b3IpIHtcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lNdWx0aXBsaWVyOlxuICAgICAgICBpZiAodmFsdWUgPCAxIHx8IHZhbHVlID4gMTAwKSB7XG4gICAgICAgICAgcmV0dXJuICdNdWx0aXBsaWVyIG11c3QgYmUgYmV0d2VlbiAxIGFuZCAxMDAnXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lBYnNvbHV0ZTpcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lBYnNvbHV0ZVBsdXM6XG4gICAgICAgIGlmICh2YWx1ZSA8PSAwKSB7XG4gICAgICAgICAgcmV0dXJuICdSYXRlIG11c3QgYmUgZ3JlYXRlciB0aGFuIDAnXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lQZXJjZW50OlxuICAgICAgY2FzZSBHYXBTdHJhdGVneVBlcmNlbnRQbHVzOlxuICAgICAgICBpZiAodmFsdWUgPD0gMCB8fCB2YWx1ZSA+IDEwKSB7XG4gICAgICAgICAgcmV0dXJuICdQZXJjZW50IG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxMCdcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gZ2FwIGZhY3RvciAke2dhcEZhY3Rvcn1gKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGNvbnZlcnRHYXBGYWN0b3IgY29udmVydHMgYmV0d2VlbiB0aGUgZGlzcGxheWVkIGdhcCBmYWN0b3IgaW4gdGhlXG4gICAqIHBsYWNlbWVudCB0YWJsZXMgYW5kIHRoZSBudW1iZXIgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIG1hcmtldCBtYWtlci5cbiAgICogRm9yIGdhcCBzdHJhdGVnaWVzIHRoYXQgaW52b2x2ZSBhIHBlcmNlbnRhZ2UgaXQgY29udmVydHMgYmV0d2VlbiB0aGVcbiAgICogZGVjaW1hbCB2YWx1ZSByZXF1aXJlZCBieSB0aGUgYmFja2VuZCBhbmQgYSBwZXJjZW50YWdlIGRpc3BsYXllZCB0b1xuICAgKiB0aGUgdXNlci5cbiAgICovXG4gIGNvbnZlcnRHYXBGYWN0b3IgKGdhcEZhY3RvcjogbnVtYmVyLCBnYXBTdHJhdGVneTogc3RyaW5nLCB0b0Rpc3BsYXk6IGJvb2xlYW4pOiBudW1iZXIge1xuICAgIHN3aXRjaCAoZ2FwU3RyYXRlZ3kpIHtcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lNdWx0aXBsaWVyOlxuICAgICAgY2FzZSBHYXBTdHJhdGVneUFic29sdXRlOlxuICAgICAgY2FzZSBHYXBTdHJhdGVneUFic29sdXRlUGx1czpcbiAgICAgICAgcmV0dXJuIGdhcEZhY3RvclxuICAgICAgY2FzZSBHYXBTdHJhdGVneVBlcmNlbnQ6XG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5UGVyY2VudFBsdXM6XG4gICAgICAgIGlmICh0b0Rpc3BsYXkpIHtcbiAgICAgICAgICByZXR1cm4gZ2FwRmFjdG9yICogMTAwXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGdhcEZhY3RvciAvIDEwMFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGdhcCBmYWN0b3IgJHtnYXBTdHJhdGVneX1gKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGFkZFBsYWNlbWVudCBhZGRzIGEgcm93IHRvIGEgcGxhY2VtZW50IHRhYmxlLiBUaGlzIGlzIGNhbGxlZCBib3RoIHdoZW5cbiAgICogdGhlIHBhZ2UgaXMgaW5pdGlhbGx5IGxvYWRlZCwgYW5kIHdoZW4gdGhlIFwiYWRkXCIgYnV0dG9uIGlzIHByZXNzZWQgb25cbiAgICogdGhlIHBsYWNlbWVudCB0YWJsZS4gaW5pdGlhbExvYWRQbGFjZW1lbnQgaXMgbm9uLW5pbCBpZiB0aGlzIGlzIGJlaW5nXG4gICAqIGNhbGxlZCBvbiB0aGUgaW5pdGlhbCBsb2FkLlxuICAgKi9cbiAgYWRkUGxhY2VtZW50IChpc0J1eTogYm9vbGVhbiwgaW5pdGlhbExvYWRQbGFjZW1lbnQ6IE9yZGVyUGxhY2VtZW50IHwgbnVsbCwgZ2FwU3RyYXRlZ3k/OiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHVwZGF0ZWRDb25maWc6IGNmZyB9ID0gdGhpc1xuXG4gICAgbGV0IHRhYmxlQm9keTogUGFnZUVsZW1lbnQgPSBwYWdlLnNlbGxQbGFjZW1lbnRzVGFibGVCb2R5XG4gICAgbGV0IGFkZFBsYWNlbWVudFJvdzogUGFnZUVsZW1lbnQgPSBwYWdlLmFkZFNlbGxQbGFjZW1lbnRSb3dcbiAgICBsZXQgbG90c0VsZW1lbnQ6IFBhZ2VFbGVtZW50ID0gcGFnZS5hZGRTZWxsUGxhY2VtZW50TG90c1xuICAgIGxldCBnYXBGYWN0b3JFbGVtZW50OiBQYWdlRWxlbWVudCA9IHBhZ2UuYWRkU2VsbFBsYWNlbWVudEdhcEZhY3RvclxuICAgIGxldCBlcnJFbGVtZW50OiBQYWdlRWxlbWVudCA9IHBhZ2Uuc2VsbFBsYWNlbWVudHNFcnJcbiAgICBpZiAoaXNCdXkpIHtcbiAgICAgIHRhYmxlQm9keSA9IHBhZ2UuYnV5UGxhY2VtZW50c1RhYmxlQm9keVxuICAgICAgYWRkUGxhY2VtZW50Um93ID0gcGFnZS5hZGRCdXlQbGFjZW1lbnRSb3dcbiAgICAgIGxvdHNFbGVtZW50ID0gcGFnZS5hZGRCdXlQbGFjZW1lbnRMb3RzXG4gICAgICBnYXBGYWN0b3JFbGVtZW50ID0gcGFnZS5hZGRCdXlQbGFjZW1lbnRHYXBGYWN0b3JcbiAgICAgIGVyckVsZW1lbnQgPSBwYWdlLmJ1eVBsYWNlbWVudHNFcnJcbiAgICB9XG5cbiAgICBEb2MuaGlkZShlcnJFbGVtZW50KVxuXG4gICAgLy8gdXBkYXRlQXJyb3dWaXMgdXBkYXRlcyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgbW92ZSB1cC9kb3duIGFycm93cyBpblxuICAgIC8vIGVhY2ggcm93IG9mIHRoZSBwbGFjZW1lbnQgdGFibGUuIFRoZSB1cCBhcnJvdyBpcyBub3Qgc2hvd24gb24gdGhlXG4gICAgLy8gdG9wIHJvdywgYW5kIHRoZSBkb3duIGFycm93IGlzIG5vdCBzaG93biBvbiB0aGUgYm90dG9tIHJvdy4gVGhleVxuICAgIC8vIGFyZSBhbGwgaGlkZGVuIGlmIG1hcmtldCBtYWtpbmcgaXMgcnVubmluZy5cbiAgICBjb25zdCB1cGRhdGVBcnJvd1ZpcyA9ICgpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFibGVCb2R5LmNoaWxkcmVuLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICBjb25zdCByb3cgPSBEb2MucGFyc2VUZW1wbGF0ZSh0YWJsZUJvZHkuY2hpbGRyZW5baV0gYXMgSFRNTEVsZW1lbnQpXG4gICAgICAgIERvYy5zZXRWaXMoaSAhPT0gMCwgcm93LnVwQnRuKVxuICAgICAgICBEb2Muc2V0VmlzKGkgIT09IHRhYmxlQm9keS5jaGlsZHJlbi5sZW5ndGggLSAyLCByb3cuZG93bkJ0bilcbiAgICAgIH1cbiAgICB9XG5cbiAgICBEb2MuaGlkZShlcnJFbGVtZW50KVxuICAgIGNvbnN0IHNldEVyciA9IChlcnI6IHN0cmluZykgPT4ge1xuICAgICAgZXJyRWxlbWVudC50ZXh0Q29udGVudCA9IGVyclxuICAgICAgRG9jLnNob3coZXJyRWxlbWVudClcbiAgICB9XG5cbiAgICBsZXQgbG90czogbnVtYmVyXG4gICAgbGV0IGFjdHVhbEdhcEZhY3RvcjogbnVtYmVyXG4gICAgbGV0IGRpc3BsYXllZEdhcEZhY3RvcjogbnVtYmVyXG4gICAgaWYgKCFnYXBTdHJhdGVneSkgZ2FwU3RyYXRlZ3kgPSB0aGlzLnNwZWNzLmNleE5hbWUgPyBHYXBTdHJhdGVneU11bHRpcGxpZXIgOiBjZmcuZ2FwU3RyYXRlZ3lcbiAgICBjb25zdCBwbGFjZW1lbnRzID0gaXNCdXkgPyBjZmcuYnV5UGxhY2VtZW50cyA6IGNmZy5zZWxsUGxhY2VtZW50c1xuICAgIGNvbnN0IHVuaXQgPSB0aGlzLmdhcEZhY3RvckhlYWRlclVuaXQoZ2FwU3RyYXRlZ3kpWzFdXG4gICAgaWYgKGluaXRpYWxMb2FkUGxhY2VtZW50KSB7XG4gICAgICBsb3RzID0gaW5pdGlhbExvYWRQbGFjZW1lbnQubG90c1xuICAgICAgYWN0dWFsR2FwRmFjdG9yID0gaW5pdGlhbExvYWRQbGFjZW1lbnQuZ2FwRmFjdG9yXG4gICAgICBkaXNwbGF5ZWRHYXBGYWN0b3IgPSB0aGlzLmNvbnZlcnRHYXBGYWN0b3IoYWN0dWFsR2FwRmFjdG9yLCBnYXBTdHJhdGVneSwgdHJ1ZSlcbiAgICB9IGVsc2Uge1xuICAgICAgbG90cyA9IHBhcnNlSW50KGxvdHNFbGVtZW50LnZhbHVlIHx8ICcwJylcbiAgICAgIGRpc3BsYXllZEdhcEZhY3RvciA9IHBhcnNlRmxvYXQoZ2FwRmFjdG9yRWxlbWVudC52YWx1ZSB8fCAnMCcpXG4gICAgICBhY3R1YWxHYXBGYWN0b3IgPSB0aGlzLmNvbnZlcnRHYXBGYWN0b3IoZGlzcGxheWVkR2FwRmFjdG9yLCBnYXBTdHJhdGVneSwgZmFsc2UpXG4gICAgICBpZiAobG90cyA9PT0gMCkge1xuICAgICAgICBzZXRFcnIoJ0xvdHMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCcpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICBjb25zdCBnYXBGYWN0b3JFcnIgPSB0aGlzLmNoZWNrR2FwRmFjdG9yUmFuZ2UoZ2FwU3RyYXRlZ3ksIGRpc3BsYXllZEdhcEZhY3RvcilcbiAgICAgIGlmIChnYXBGYWN0b3JFcnIpIHtcbiAgICAgICAgc2V0RXJyKGdhcEZhY3RvckVycilcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGlmIChwbGFjZW1lbnRzLmZpbmQoKHBsYWNlbWVudCkgPT4gcGxhY2VtZW50LmdhcEZhY3RvciA9PT0gYWN0dWFsR2FwRmFjdG9yKVxuICAgICAgKSB7XG4gICAgICAgIHNldEVycignRHVwbGljYXRlIHBsYWNlbWVudCcpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICBwbGFjZW1lbnRzLnB1c2goeyBsb3RzLCBnYXBGYWN0b3I6IGFjdHVhbEdhcEZhY3RvciB9KVxuICAgIH1cblxuICAgIGNvbnN0IG5ld1JvdyA9IHBhZ2UucGxhY2VtZW50Um93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBjb25zdCBuZXdSb3dUbXBsID0gRG9jLnBhcnNlVGVtcGxhdGUobmV3Um93KVxuICAgIG5ld1Jvd1RtcGwucHJpb3JpdHkudGV4dENvbnRlbnQgPSBgJHt0YWJsZUJvZHkuY2hpbGRyZW4ubGVuZ3RofWBcbiAgICBuZXdSb3dUbXBsLmxvdHMudGV4dENvbnRlbnQgPSBgJHtsb3RzfWBcbiAgICBuZXdSb3dUbXBsLmdhcEZhY3Rvci50ZXh0Q29udGVudCA9IGAke2Rpc3BsYXllZEdhcEZhY3Rvcn0gJHt1bml0fWBcbiAgICBEb2MuYmluZChuZXdSb3dUbXBsLnJlbW92ZUJ0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSBwbGFjZW1lbnRzLmZpbmRJbmRleCgocGxhY2VtZW50KSA9PiB7XG4gICAgICAgIHJldHVybiBwbGFjZW1lbnQubG90cyA9PT0gbG90cyAmJiBwbGFjZW1lbnQuZ2FwRmFjdG9yID09PSBhY3R1YWxHYXBGYWN0b3JcbiAgICAgIH0pXG4gICAgICBpZiAoaW5kZXggPT09IC0xKSByZXR1cm5cbiAgICAgIHBsYWNlbWVudHMuc3BsaWNlKGluZGV4LCAxKVxuICAgICAgbmV3Um93LnJlbW92ZSgpXG4gICAgICB1cGRhdGVBcnJvd1ZpcygpXG4gICAgICB0aGlzLnVwZGF0ZU1vZGlmaWVkTWFya2VycygpXG4gICAgICB0aGlzLnBsYWNlbWVudHNDaGFydC5yZW5kZXIoKVxuICAgICAgdGhpcy51cGRhdGVBbGxvY2F0aW9ucygpXG4gICAgfSlcblxuICAgIERvYy5iaW5kKG5ld1Jvd1RtcGwudXBCdG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGxhY2VtZW50cy5maW5kSW5kZXgoKHA6IE9yZGVyUGxhY2VtZW50KSA9PiBwLmxvdHMgPT09IGxvdHMgJiYgcC5nYXBGYWN0b3IgPT09IGFjdHVhbEdhcEZhY3RvcilcbiAgICAgIGlmIChpbmRleCA9PT0gMCkgcmV0dXJuXG4gICAgICBjb25zdCBwcmV2UGxhY2VtZW50ID0gcGxhY2VtZW50c1tpbmRleCAtIDFdXG4gICAgICBwbGFjZW1lbnRzW2luZGV4IC0gMV0gPSBwbGFjZW1lbnRzW2luZGV4XVxuICAgICAgcGxhY2VtZW50c1tpbmRleF0gPSBwcmV2UGxhY2VtZW50XG4gICAgICBuZXdSb3dUbXBsLnByaW9yaXR5LnRleHRDb250ZW50ID0gYCR7aW5kZXh9YFxuICAgICAgbmV3Um93LnJlbW92ZSgpXG4gICAgICB0YWJsZUJvZHkuaW5zZXJ0QmVmb3JlKG5ld1JvdywgdGFibGVCb2R5LmNoaWxkcmVuW2luZGV4IC0gMV0pXG4gICAgICBjb25zdCBtb3ZlZERvd25UbXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoXG4gICAgICAgIHRhYmxlQm9keS5jaGlsZHJlbltpbmRleF0gYXMgSFRNTEVsZW1lbnRcbiAgICAgIClcbiAgICAgIG1vdmVkRG93blRtcGwucHJpb3JpdHkudGV4dENvbnRlbnQgPSBgJHtpbmRleCArIDF9YFxuICAgICAgdXBkYXRlQXJyb3dWaXMoKVxuICAgICAgdGhpcy51cGRhdGVNb2RpZmllZE1hcmtlcnMoKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChuZXdSb3dUbXBsLmRvd25CdG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGxhY2VtZW50cy5maW5kSW5kZXgoKHApID0+IHAubG90cyA9PT0gbG90cyAmJiBwLmdhcEZhY3RvciA9PT0gYWN0dWFsR2FwRmFjdG9yKVxuICAgICAgaWYgKGluZGV4ID09PSBwbGFjZW1lbnRzLmxlbmd0aCAtIDEpIHJldHVyblxuICAgICAgY29uc3QgbmV4dFBsYWNlbWVudCA9IHBsYWNlbWVudHNbaW5kZXggKyAxXVxuICAgICAgcGxhY2VtZW50c1tpbmRleCArIDFdID0gcGxhY2VtZW50c1tpbmRleF1cbiAgICAgIHBsYWNlbWVudHNbaW5kZXhdID0gbmV4dFBsYWNlbWVudFxuICAgICAgbmV3Um93VG1wbC5wcmlvcml0eS50ZXh0Q29udGVudCA9IGAke2luZGV4ICsgMn1gXG4gICAgICBuZXdSb3cucmVtb3ZlKClcbiAgICAgIHRhYmxlQm9keS5pbnNlcnRCZWZvcmUobmV3Um93LCB0YWJsZUJvZHkuY2hpbGRyZW5baW5kZXggKyAxXSlcbiAgICAgIGNvbnN0IG1vdmVkVXBUbXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoXG4gICAgICAgIHRhYmxlQm9keS5jaGlsZHJlbltpbmRleF0gYXMgSFRNTEVsZW1lbnRcbiAgICAgIClcbiAgICAgIG1vdmVkVXBUbXBsLnByaW9yaXR5LnRleHRDb250ZW50ID0gYCR7aW5kZXggKyAxfWBcbiAgICAgIHVwZGF0ZUFycm93VmlzKClcbiAgICAgIHRoaXMudXBkYXRlTW9kaWZpZWRNYXJrZXJzKClcbiAgICB9KVxuXG4gICAgdGFibGVCb2R5Lmluc2VydEJlZm9yZShuZXdSb3csIGFkZFBsYWNlbWVudFJvdylcbiAgICB1cGRhdGVBcnJvd1ZpcygpXG4gIH1cblxuICBzZXRBcmJNTUxhYmVscyAoKSB7XG4gICAgdGhpcy5wYWdlLmJ1eUdhcEZhY3Rvckhkci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX01BVENIX0JVRkZFUilcbiAgICB0aGlzLnBhZ2Uuc2VsbEdhcEZhY3Rvckhkci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX01BVENIX0JVRkZFUilcbiAgfVxuXG4gIC8qXG4gICAqIHNldEdhcEZhY3RvckxhYmVscyBzZXRzIHRoZSBoZWFkZXJzIG9uIHRoZSBnYXAgZmFjdG9yIGNvbHVtbiBvZiBlYWNoXG4gICAqIHBsYWNlbWVudCB0YWJsZS5cbiAgICovXG4gIHNldEdhcEZhY3RvckxhYmVscyAoZ2FwU3RyYXRlZ3k6IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBoZWFkZXIgPSB0aGlzLmdhcEZhY3RvckhlYWRlclVuaXQoZ2FwU3RyYXRlZ3kpWzBdXG4gICAgcGFnZS5idXlHYXBGYWN0b3JIZHIudGV4dENvbnRlbnQgPSBoZWFkZXJcbiAgICBwYWdlLnNlbGxHYXBGYWN0b3JIZHIudGV4dENvbnRlbnQgPSBoZWFkZXJcbiAgICBEb2MuaGlkZShwYWdlLnBlcmNlbnRQbHVzSW5mbywgcGFnZS5wZXJjZW50SW5mbywgcGFnZS5hYnNvbHV0ZVBsdXNJbmZvLCBwYWdlLmFic29sdXRlSW5mbywgcGFnZS5tdWx0aXBsaWVySW5mbylcbiAgICBzd2l0Y2ggKGdhcFN0cmF0ZWd5KSB7XG4gICAgICBjYXNlICdwZXJjZW50LXBsdXMnOlxuICAgICAgICByZXR1cm4gRG9jLnNob3cocGFnZS5wZXJjZW50UGx1c0luZm8pXG4gICAgICBjYXNlICdwZXJjZW50JzpcbiAgICAgICAgcmV0dXJuIERvYy5zaG93KHBhZ2UucGVyY2VudEluZm8pXG4gICAgICBjYXNlICdhYnNvbHV0ZS1wbHVzJzpcbiAgICAgICAgcmV0dXJuIERvYy5zaG93KHBhZ2UuYWJzb2x1dGVQbHVzSW5mbylcbiAgICAgIGNhc2UgJ2Fic29sdXRlJzpcbiAgICAgICAgcmV0dXJuIERvYy5zaG93KHBhZ2UuYWJzb2x1dGVJbmZvKVxuICAgICAgY2FzZSAnbXVsdGlwbGllcic6XG4gICAgICAgIHJldHVybiBEb2Muc2hvdyhwYWdlLm11bHRpcGxpZXJJbmZvKVxuICAgIH1cbiAgfVxuXG4gIGNsZWFyUGxhY2VtZW50cyAoY2FjaGVLZXk6IHN0cmluZykge1xuICAgIGNvbnN0IHsgcGFnZSwgdXBkYXRlZENvbmZpZzogY2ZnIH0gPSB0aGlzXG4gICAgd2hpbGUgKHBhZ2UuYnV5UGxhY2VtZW50c1RhYmxlQm9keS5jaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICBwYWdlLmJ1eVBsYWNlbWVudHNUYWJsZUJvZHkuY2hpbGRyZW5bMF0ucmVtb3ZlKClcbiAgICB9XG4gICAgd2hpbGUgKHBhZ2Uuc2VsbFBsYWNlbWVudHNUYWJsZUJvZHkuY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xuICAgICAgcGFnZS5zZWxsUGxhY2VtZW50c1RhYmxlQm9keS5jaGlsZHJlblswXS5yZW1vdmUoKVxuICAgIH1cbiAgICB0aGlzLnBsYWNlbWVudHNDYWNoZVtjYWNoZUtleV0gPSBbY2ZnLmJ1eVBsYWNlbWVudHMsIGNmZy5zZWxsUGxhY2VtZW50c11cbiAgICBjZmcuYnV5UGxhY2VtZW50cy5zcGxpY2UoMCwgY2ZnLmJ1eVBsYWNlbWVudHMubGVuZ3RoKVxuICAgIGNmZy5zZWxsUGxhY2VtZW50cy5zcGxpY2UoMCwgY2ZnLnNlbGxQbGFjZW1lbnRzLmxlbmd0aClcbiAgfVxuXG4gIGxvYWRDYWNoZWRQbGFjZW1lbnRzIChjYWNoZUtleTogc3RyaW5nKSB7XG4gICAgY29uc3QgYyA9IHRoaXMucGxhY2VtZW50c0NhY2hlW2NhY2hlS2V5XVxuICAgIGlmICghYykgcmV0dXJuXG4gICAgY29uc3QgeyB1cGRhdGVkQ29uZmlnOiBjZmcgfSA9IHRoaXNcbiAgICBjZmcuYnV5UGxhY2VtZW50cy5zcGxpY2UoMCwgY2ZnLmJ1eVBsYWNlbWVudHMubGVuZ3RoKVxuICAgIGNmZy5zZWxsUGxhY2VtZW50cy5zcGxpY2UoMCwgY2ZnLnNlbGxQbGFjZW1lbnRzLmxlbmd0aClcbiAgICBjZmcuYnV5UGxhY2VtZW50cy5wdXNoKC4uLmNbMF0pXG4gICAgY2ZnLnNlbGxQbGFjZW1lbnRzLnB1c2goLi4uY1sxXSlcbiAgICBjb25zdCBnYXBTdHJhdGVneSA9IGNhY2hlS2V5ID09PSBhcmJNTVJvd0NhY2hlS2V5ID8gR2FwU3RyYXRlZ3lNdWx0aXBsaWVyIDogY2FjaGVLZXlcbiAgICBmb3IgKGNvbnN0IHAgb2YgY2ZnLmJ1eVBsYWNlbWVudHMpIHRoaXMuYWRkUGxhY2VtZW50KHRydWUsIHAsIGdhcFN0cmF0ZWd5KVxuICAgIGZvciAoY29uc3QgcCBvZiBjZmcuc2VsbFBsYWNlbWVudHMpIHRoaXMuYWRkUGxhY2VtZW50KGZhbHNlLCBwLCBnYXBTdHJhdGVneSlcbiAgfVxuXG4gIC8qXG4gICAqIHNldE9yaWdpbmFsVmFsdWVzIHNldHMgdGhlIHVwZGF0ZWRDb25maWcgZmllbGQgdG8gYmUgZXF1YWwgdG8gdGhlXG4gICAqIGFuZCBzZXRzIHRoZSB2YWx1ZXMgZGlzcGxheWVkIGJ1eSBlYWNoIGZpZWxkIGlucHV0IHRvIGJlIGVxdWFsXG4gICAqIHRvIHRoZSB2YWx1ZXMgc2luY2UgdGhlIGxhc3Qgc2F2ZS5cbiAgICovXG4gIHNldE9yaWdpbmFsVmFsdWVzICgpIHtcbiAgICBjb25zdCB7XG4gICAgICBwYWdlLCBvcmlnaW5hbENvbmZpZzogb2xkQ2ZnLCB1cGRhdGVkQ29uZmlnOiBjZmcsIHNwZWNzOiB7IGNleE5hbWUsIGJvdFR5cGUgfVxuICAgIH0gPSB0aGlzXG5cbiAgICB0aGlzLmNsZWFyUGxhY2VtZW50cyhjZXhOYW1lID8gYXJiTU1Sb3dDYWNoZUtleSA6IGNmZy5nYXBTdHJhdGVneSlcblxuICAgIGNvbnN0IGFzc2lnbiA9ICh0bzogYW55LCBmcm9tOiBhbnkpID0+IHsgLy8gbm90IHJlY3Vyc2l2ZVxuICAgICAgZm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMoZnJvbSkpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodikpIHtcbiAgICAgICAgICB0b1trXS5zcGxpY2UoMCwgdG9ba10ubGVuZ3RoKVxuICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB2KSB0b1trXS5wdXNoKGkpXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHYgPT09ICdvYmplY3QnKSBPYmplY3QuYXNzaWduKHRvW2tdLCB2KVxuICAgICAgICBlbHNlIHRvW2tdID0gZnJvbVtrXVxuICAgICAgfVxuICAgIH1cbiAgICBhc3NpZ24oY2ZnLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9sZENmZykpKVxuXG4gICAgY29uc3QgdG9sID0gY2ZnLmRyaWZ0VG9sZXJhbmNlID8/IGRlZmF1bHREcmlmdFRvbGVyYW5jZS52YWx1ZVxuICAgIHRoaXMuZHJpZnRUb2xlcmFuY2Uuc2V0VmFsdWUodG9sICogMTAwKVxuICAgIHRoaXMuZHJpZnRUb2xlcmFuY2VTbGlkZXIuc2V0VmFsdWUodG9sIC8gZGVmYXVsdERyaWZ0VG9sZXJhbmNlLm1heFYpXG5cbiAgICBjb25zdCBwZXJzaXN0ID0gY2ZnLm9yZGVyUGVyc2lzdGVuY2UgPz8gZGVmYXVsdE9yZGVyUGVyc2lzdGVuY2UudmFsdWVcbiAgICB0aGlzLm9yZGVyUGVyc2lzdGVuY2Uuc2V0VmFsdWUocGVyc2lzdClcbiAgICB0aGlzLm9yZGVyUGVyc2lzdGVuY2VTbGlkZXIuc2V0VmFsdWUocGVyc2lzdCAvIGRlZmF1bHRPcmRlclBlcnNpc3RlbmNlLm1heFYpXG5cbiAgICBjb25zdCBwcm9maXQgPSBjZmcucHJvZml0ID8/IGRlZmF1bHRQcm9maXQudmFsdWVcbiAgICBwYWdlLnByb2ZpdElucHV0LnZhbHVlID0gU3RyaW5nKHByb2ZpdCAqIDEwMClcbiAgICB0aGlzLnFjUHJvZml0LnNldFZhbHVlKHByb2ZpdCAqIDEwMClcbiAgICB0aGlzLnFjUHJvZml0U2xpZGVyLnNldFZhbHVlKChwcm9maXQgLSBkZWZhdWx0UHJvZml0Lm1pblYpIC8gZGVmYXVsdFByb2ZpdC5yYW5nZSlcblxuICAgIGlmIChjZXhOYW1lKSB7XG4gICAgICBwYWdlLmNleFJlYmFsYW5jZUNoZWNrYm94LmNoZWNrZWQgPSBjZmcuY2V4UmViYWxhbmNlXG4gICAgICB0aGlzLmF1dG9SZWJhbGFuY2VDaGFuZ2VkKClcbiAgICB9XG5cbiAgICAvLyBHYXAgc3RyYXRlZ3lcbiAgICBpZiAoIXBhZ2UuZ2FwU3RyYXRlZ3lTZWxlY3Qub3B0aW9ucykgcmV0dXJuXG4gICAgQXJyYXkuZnJvbShwYWdlLmdhcFN0cmF0ZWd5U2VsZWN0Lm9wdGlvbnMpLmZvckVhY2goKG9wdDogSFRNTE9wdGlvbkVsZW1lbnQpID0+IHsgb3B0LnNlbGVjdGVkID0gb3B0LnZhbHVlID09PSBjZmcuZ2FwU3RyYXRlZ3kgfSlcbiAgICB0aGlzLnNldEdhcEZhY3RvckxhYmVscyhjZmcuZ2FwU3RyYXRlZ3kpXG5cbiAgICBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljTU0pIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuZ2FwU3RyYXRlZ3lCb3gpXG4gICAgICBEb2MuaGlkZShwYWdlLnByb2ZpdFNlbGVjdG9yQm94LCBwYWdlLm9yZGVyUGVyc2lzdGVuY2VCb3gpXG4gICAgICB0aGlzLnNldEdhcEZhY3RvckxhYmVscyhwYWdlLmdhcFN0cmF0ZWd5U2VsZWN0LnZhbHVlIHx8ICcnKVxuICAgIH0gZWxzZSBpZiAoY2V4TmFtZSAmJiBhcHAoKS5tbVN0YXR1cy5jZXhlc1tjZXhOYW1lXSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5nYXBTdHJhdGVneUJveClcbiAgICAgIERvYy5zaG93KHBhZ2UucHJvZml0U2VsZWN0b3JCb3gsIHBhZ2Uub3JkZXJQZXJzaXN0ZW5jZUJveClcbiAgICAgIHRoaXMuc2V0QXJiTU1MYWJlbHMoKVxuICAgIH1cblxuICAgIC8vIEJ1eS9TZWxsIHBsYWNlbWVudHNcbiAgICBvbGRDZmcuYnV5UGxhY2VtZW50cy5mb3JFYWNoKChwKSA9PiB7IHRoaXMuYWRkUGxhY2VtZW50KHRydWUsIHApIH0pXG4gICAgb2xkQ2ZnLnNlbGxQbGFjZW1lbnRzLmZvckVhY2goKHApID0+IHsgdGhpcy5hZGRQbGFjZW1lbnQoZmFsc2UsIHApIH0pXG5cbiAgICB0aGlzLmJhc2VQYW5lLnNldHVwV2FsbGV0U2V0dGluZ3MoKVxuICAgIHRoaXMucXVvdGVQYW5lLnNldHVwV2FsbGV0U2V0dGluZ3MoKVxuXG4gICAgdGhpcy51cGRhdGVNb2RpZmllZE1hcmtlcnMoKVxuICAgIGlmIChEb2MuaXNEaXNwbGF5ZWQocGFnZS5xdWlja0NvbmZpZykpIHRoaXMuc3dpdGNoVG9RdWlja0NvbmZpZygpXG4gIH1cblxuICAvKlxuICAgKiB2YWxpZGF0ZUZpZWxkcyB2YWxpZGF0ZXMgY29uZmlndXJhdGlvbiB2YWx1ZXMgYW5kIG9wdGlvbmFsbHkgc2hvd3MgZXJyb3JcbiAgICogbWVzc2FnZXMuXG4gICAqL1xuICB2YWxpZGF0ZUZpZWxkcyAoc2hvd0Vycm9yczogYm9vbGVhbik6IGJvb2xlYW4ge1xuICAgIGxldCBvayA9IHRydWVcbiAgICBjb25zdCB7XG4gICAgICBwYWdlLCBzcGVjczogeyBib3RUeXBlIH0sXG4gICAgICB1cGRhdGVkQ29uZmlnOiB7IHNlbGxQbGFjZW1lbnRzLCBidXlQbGFjZW1lbnRzLCBwcm9maXQgfVxuICAgIH0gPSB0aGlzXG4gICAgY29uc3Qgc2V0RXJyb3IgPSAoZXJyRWw6IFBhZ2VFbGVtZW50LCBlcnJJRDogc3RyaW5nKSA9PiB7XG4gICAgICBvayA9IGZhbHNlXG4gICAgICBpZiAoIXNob3dFcnJvcnMpIHJldHVyblxuICAgICAgZXJyRWwudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoZXJySUQpXG4gICAgICBEb2Muc2hvdyhlcnJFbClcbiAgICB9XG4gICAgaWYgKHNob3dFcnJvcnMpIHtcbiAgICAgIERvYy5oaWRlKFxuICAgICAgICBwYWdlLmJ1eVBsYWNlbWVudHNFcnIsIHBhZ2Uuc2VsbFBsYWNlbWVudHNFcnIsIHBhZ2UucHJvZml0SW5wdXRFcnJcbiAgICAgIClcbiAgICB9XG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY0FyYiAmJiBidXlQbGFjZW1lbnRzLmxlbmd0aCArIHNlbGxQbGFjZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2V0RXJyb3IocGFnZS5idXlQbGFjZW1lbnRzRXJyLCBpbnRsLklEX05PX1BMQUNFTUVOVFMpXG4gICAgICBzZXRFcnJvcihwYWdlLnNlbGxQbGFjZW1lbnRzRXJyLCBpbnRsLklEX05PX1BMQUNFTUVOVFMpXG4gICAgfVxuICAgIGlmIChib3RUeXBlICE9PSBib3RUeXBlQmFzaWNNTSkge1xuICAgICAgaWYgKGlzTmFOKHByb2ZpdCkpIHNldEVycm9yKHBhZ2UucHJvZml0SW5wdXRFcnIsIGludGwuSURfSU5WQUxJRF9WQUxVRSlcbiAgICAgIGVsc2UgaWYgKHByb2ZpdCA9PT0gMCkgc2V0RXJyb3IocGFnZS5wcm9maXRJbnB1dEVyciwgaW50bC5JRF9OT19aRVJPKVxuICAgIH1cbiAgICByZXR1cm4gb2tcbiAgfVxuXG4gIC8qXG4gICAqIHNhdmVTZXR0aW5ncyB1cGRhdGVzIHRoZSBzZXR0aW5ncyBpbiB0aGUgYmFja2VuZCwgYW5kIHNldHMgdGhlIG9yaWdpbmFsQ29uZmlnXG4gICAqIHRvIGJlIGVxdWFsIHRvIHRoZSB1cGRhdGVkQ29uZmlnLlxuICAgKi9cbiAgYXN5bmMgc2F2ZVNldHRpbmdzICgpIHtcbiAgICAvLyBNYWtlIGEgY29weSBhbmQgZGVsZXRlIGVpdGhlciB0aGUgYmFzaWMgbW0gY29uZmlnIG9yIHRoZSBhcmItbW0gY29uZmlnLFxuICAgIC8vIGRlcGVuZGluZyBvbiB3aGV0aGVyIGEgY2V4IGlzIHNlbGVjdGVkLlxuICAgIGlmICghdGhpcy52YWxpZGF0ZUZpZWxkcyh0cnVlKSkgcmV0dXJuXG4gICAgY29uc3QgeyBjZmcsIGJhc2VJRCwgcXVvdGVJRCwgaG9zdCwgYm90VHlwZSwgY2V4TmFtZSB9ID0gdGhpcy5tYXJrZXRTdHVmZigpXG5cbiAgICBjb25zdCBib3RDZmc6IEJvdENvbmZpZyA9IHtcbiAgICAgIGhvc3Q6IGhvc3QsXG4gICAgICBiYXNlSUQ6IGJhc2VJRCxcbiAgICAgIHF1b3RlSUQ6IHF1b3RlSUQsXG4gICAgICBjZXhOYW1lOiBjZXhOYW1lID8/ICcnLFxuICAgICAgdWlDb25maWc6IHtcbiAgICAgICAgc2ltcGxlQXJiTG90czogY2ZnLnNpbXBsZUFyYkxvdHMsXG4gICAgICAgIGJhc2VDb25maWc6IGNmZy5iYXNlQ29uZmlnLFxuICAgICAgICBxdW90ZUNvbmZpZzogY2ZnLnF1b3RlQ29uZmlnLFxuICAgICAgICBjZXhSZWJhbGFuY2U6IGNmZy5jZXhSZWJhbGFuY2VcbiAgICAgIH0sXG4gICAgICBiYXNlV2FsbGV0T3B0aW9uczogY2ZnLmJhc2VPcHRpb25zLFxuICAgICAgcXVvdGVXYWxsZXRPcHRpb25zOiBjZmcucXVvdGVPcHRpb25zXG4gICAgfVxuICAgIHN3aXRjaCAoYm90VHlwZSkge1xuICAgICAgY2FzZSBib3RUeXBlQmFzaWNNTTpcbiAgICAgICAgYm90Q2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnID0gdGhpcy5iYXNpY01NQ29uZmlnKClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgYm90VHlwZUFyYk1NOlxuICAgICAgICBib3RDZmcuYXJiTWFya2V0TWFraW5nQ29uZmlnID0gdGhpcy5hcmJNTUNvbmZpZygpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIGJvdFR5cGVCYXNpY0FyYjpcbiAgICAgICAgYm90Q2ZnLnNpbXBsZUFyYkNvbmZpZyA9IHRoaXMuYmFzaWNBcmJDb25maWcoKVxuICAgIH1cblxuICAgIGFwcCgpLmxvZygnbW0nLCAnc2F2aW5nIGJvdCBjb25maWcnLCBib3RDZmcpXG4gICAgYXdhaXQgTU0udXBkYXRlQm90Q29uZmlnKGJvdENmZylcbiAgICBhd2FpdCBhcHAoKS5mZXRjaE1NU3RhdHVzKClcbiAgICB0aGlzLm9yaWdpbmFsQ29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjZmcpKVxuICAgIHRoaXMudXBkYXRlTW9kaWZpZWRNYXJrZXJzKClcbiAgICBjb25zdCBsYXN0Qm90cyA9IFN0YXRlLmZldGNoTG9jYWwobGFzdEJvdHNMSykgfHwge31cbiAgICBsYXN0Qm90c1tgJHtiYXNlSUR9XyR7cXVvdGVJRH1fJHtob3N0fWBdID0gdGhpcy5zcGVjc1xuICAgIFN0YXRlLnN0b3JlTG9jYWwobGFzdEJvdHNMSywgbGFzdEJvdHMpXG4gICAgaWYgKGNleE5hbWUpIFN0YXRlLnN0b3JlTG9jYWwobGFzdEFyYkV4Y2hhbmdlTEssIGNleE5hbWUpXG4gICAgYXBwKCkubG9hZFBhZ2UoJ21tJylcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzcGVjczogeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQgfSB9ID0gdGhpc1xuICAgIERvYy5oaWRlKHBhZ2UuZGVsZXRlRXJyKVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5ib3RTZXR0aW5nc0NvbnRhaW5lcilcbiAgICBjb25zdCByZXNwID0gYXdhaXQgTU0ucmVtb3ZlQm90Q29uZmlnKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXNwKSkge1xuICAgICAgcGFnZS5kZWxldGVFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BUElfRVJST1IsIHsgbXNnOiByZXNwLm1zZyB9KVxuICAgICAgRG9jLnNob3cocGFnZS5kZWxldGVFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgYXdhaXQgYXBwKCkuZmV0Y2hNTVN0YXR1cygpXG4gICAgYXBwKCkubG9hZFBhZ2UoJ21tJylcbiAgfVxuXG4gIC8qXG4gICAqIGFyYk1NQ29uZmlnIHBhcnNlcyB0aGUgY29uZmlndXJhdGlvbiBmb3IgdGhlIGFyYi1tbSBib3QuIE9ubHkgb25lIG9mXG4gICAqIGFyYk1NQ29uZmlnIG9yIGJhc2ljTU1Db25maWcgc2hvdWxkIGJlIHVzZWQgd2hlbiB1cGRhdGluZyB0aGUgYm90XG4gICAqIGNvbmZpZ3VyYXRpb24uIFdoaWNoIGlzIHVzZWQgZGVwZW5kcyBvbiBpZiB0aGUgdXNlciBoYXMgY29uZmlndXJlZCBhbmRcbiAgICogc2VsZWN0ZWQgYSBDRVggb3Igbm90LlxuICAgKi9cbiAgYXJiTU1Db25maWcgKCk6IEFyYk1hcmtldE1ha2luZ0NvbmZpZyB7XG4gICAgY29uc3QgeyB1cGRhdGVkQ29uZmlnOiBjZmcgfSA9IHRoaXNcbiAgICBjb25zdCBhcmJDZmc6IEFyYk1hcmtldE1ha2luZ0NvbmZpZyA9IHtcbiAgICAgIGJ1eVBsYWNlbWVudHM6IFtdLFxuICAgICAgc2VsbFBsYWNlbWVudHM6IFtdLFxuICAgICAgcHJvZml0OiBjZmcucHJvZml0LFxuICAgICAgZHJpZnRUb2xlcmFuY2U6IGNmZy5kcmlmdFRvbGVyYW5jZSxcbiAgICAgIG9yZGVyUGVyc2lzdGVuY2U6IGNmZy5vcmRlclBlcnNpc3RlbmNlXG4gICAgfVxuICAgIGZvciAoY29uc3QgcCBvZiBjZmcuYnV5UGxhY2VtZW50cykgYXJiQ2ZnLmJ1eVBsYWNlbWVudHMucHVzaCh7IGxvdHM6IHAubG90cywgbXVsdGlwbGllcjogcC5nYXBGYWN0b3IgfSlcbiAgICBmb3IgKGNvbnN0IHAgb2YgY2ZnLnNlbGxQbGFjZW1lbnRzKSBhcmJDZmcuc2VsbFBsYWNlbWVudHMucHVzaCh7IGxvdHM6IHAubG90cywgbXVsdGlwbGllcjogcC5nYXBGYWN0b3IgfSlcbiAgICByZXR1cm4gYXJiQ2ZnXG4gIH1cblxuICBiYXNpY0FyYkNvbmZpZyAoKTogU2ltcGxlQXJiQ29uZmlnIHtcbiAgICBjb25zdCB7IHVwZGF0ZWRDb25maWc6IGNmZyB9ID0gdGhpc1xuICAgIGNvbnN0IGFyYkNmZzogU2ltcGxlQXJiQ29uZmlnID0ge1xuICAgICAgcHJvZml0VHJpZ2dlcjogY2ZnLnByb2ZpdCxcbiAgICAgIG1heEFjdGl2ZUFyYnM6IDEwMCwgLy8gVE9ET1xuICAgICAgbnVtRXBvY2hzTGVhdmVPcGVuOiBjZmcub3JkZXJQZXJzaXN0ZW5jZVxuICAgIH1cbiAgICByZXR1cm4gYXJiQ2ZnXG4gIH1cblxuICAvKlxuICAgKiBiYXNpY01NQ29uZmlnIHBhcnNlcyB0aGUgY29uZmlndXJhdGlvbiBmb3IgdGhlIGJhc2ljIG1hcmtldG1ha2VyLiBPbmx5IG9mXG4gICAqIG9mIGJhc2lkTU1Db25maWcgb3IgYXJiTU1Db25maWcgc2hvdWxkIGJlIHVzZWQgd2hlbiB1cGRhdGluZyB0aGUgYm90XG4gICAqIGNvbmZpZ3VyYXRpb24uXG4gICAqL1xuICBiYXNpY01NQ29uZmlnICgpOiBCYXNpY01hcmtldE1ha2luZ0NvbmZpZyB7XG4gICAgY29uc3QgeyB1cGRhdGVkQ29uZmlnOiBjZmcgfSA9IHRoaXNcbiAgICBjb25zdCBtbUNmZzogQmFzaWNNYXJrZXRNYWtpbmdDb25maWcgPSB7XG4gICAgICBnYXBTdHJhdGVneTogY2ZnLmdhcFN0cmF0ZWd5LFxuICAgICAgc2VsbFBsYWNlbWVudHM6IGNmZy5zZWxsUGxhY2VtZW50cyxcbiAgICAgIGJ1eVBsYWNlbWVudHM6IGNmZy5idXlQbGFjZW1lbnRzLFxuICAgICAgZHJpZnRUb2xlcmFuY2U6IGNmZy5kcmlmdFRvbGVyYW5jZVxuICAgIH1cbiAgICByZXR1cm4gbW1DZmdcbiAgfVxuXG4gIC8qXG4gICAqIGZldGNoT3JhY2xlcyBmZXRjaGVzIHRoZSBjdXJyZW50IG9yYWNsZSByYXRlcyBhbmQgZmlhdCByYXRlcywgYW5kIGRpc3BsYXlzXG4gICAqIHRoZW0gb24gdGhlIHNjcmVlbi5cbiAgICovXG4gIGFzeW5jIGZldGNoTWFya2V0UmVwb3J0ICgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IHBhZ2UsIHNwZWNzOiB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCB9IH0gPSB0aGlzXG5cbiAgICBjb25zdCByZXMgPSBhd2FpdCBNTS5yZXBvcnQoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIERvYy5oaWRlKHBhZ2Uub3JhY2xlc0xvYWRpbmcsIHBhZ2Uub3JhY2xlc1RhYmxlLCBwYWdlLm5vT3JhY2xlcylcblxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLm9yYWNsZXNFcnJNc2cudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLm9yYWNsZXNFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCByID0gdGhpcy5tYXJrZXRSZXBvcnQgPSByZXMucmVwb3J0IGFzIE1hcmtldFJlcG9ydFxuICAgIGlmICghci5vcmFjbGVzIHx8IHIub3JhY2xlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIERvYy5zaG93KHBhZ2Uubm9PcmFjbGVzKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2MuaGlkZShwYWdlLm5vT3JhY2xlcylcbiAgICAgIERvYy5lbXB0eShwYWdlLm9yYWNsZXMpXG4gICAgICBmb3IgKGNvbnN0IG8gb2Ygci5vcmFjbGVzID8/IFtdKSB7XG4gICAgICAgIGNvbnN0IHRyID0gcGFnZS5vcmFjbGVUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICBwYWdlLm9yYWNsZXMuYXBwZW5kQ2hpbGQodHIpXG4gICAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZSh0cilcbiAgICAgICAgdG1wbC5sb2dvLnNyYyA9ICdpbWcvJyArIG8uaG9zdCArICcucG5nJ1xuICAgICAgICB0bXBsLmhvc3QudGV4dENvbnRlbnQgPSBFeGNoYW5nZU5hbWVzW28uaG9zdF1cbiAgICAgICAgdG1wbC52b2x1bWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moby51c2RWb2wpXG4gICAgICAgIHRtcGwucHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoKG8uYmVzdEJ1eSArIG8uYmVzdFNlbGwpIC8gMilcbiAgICAgIH1cbiAgICAgIHBhZ2UuYXZnUHJpY2UudGV4dENvbnRlbnQgPSByLnByaWNlID8gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHIucHJpY2UpIDogJzAnXG4gICAgICBEb2Muc2hvdyhwYWdlLm9yYWNsZXNUYWJsZSlcbiAgICB9XG5cbiAgICBpZiAoci5iYXNlRmlhdFJhdGUgPiAwKSB7XG4gICAgICBwYWdlLmJhc2VGaWF0UmF0ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhyLmJhc2VGaWF0UmF0ZSlcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5iYXNlRmlhdFJhdGUudGV4dENvbnRlbnQgPSAnTi9BJ1xuICAgIH1cblxuICAgIGlmIChyLnF1b3RlRmlhdFJhdGUgPiAwKSB7XG4gICAgICBwYWdlLnF1b3RlRmlhdFJhdGUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moci5xdW90ZUZpYXRSYXRlKVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLnF1b3RlRmlhdFJhdGUudGV4dENvbnRlbnQgPSAnTi9BJ1xuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLmZpYXRSYXRlcylcbiAgfVxuXG4gIC8qXG4gICAqIGhhbmRsZUNFWFN1Ym1pdCBoYW5kbGVzIGNsaWNrcyBvbiB0aGUgQ0VYIGNvbmZpZ3VyYXRpb24gc3VibWlzc2lvbiBidXR0b24uXG4gICAqL1xuICBhc3luYyBjZXhDb25maWd1cmVkIChjZXhOYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGZvcm1TcGVjczogeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQgfSB9ID0gdGhpc1xuICAgIGNvbnN0IGRpbmZvID0gQ0VYRGlzcGxheUluZm9zW2NleE5hbWVdXG4gICAgZm9yIChjb25zdCB7IGJhc2VJRCwgcXVvdGVJRCwgdG1wbCwgYXJicyB9IG9mIHRoaXMubWFya2V0Um93cykge1xuICAgICAgaWYgKGFyYnMuaW5kZXhPZihjZXhOYW1lKSAhPT0gLTEpIGNvbnRpbnVlXG4gICAgICBjb25zdCBjZXhIYXNNYXJrZXQgPSB0aGlzLmNleE1hcmtldFN1cHBvcnRGaWx0ZXIoYmFzZUlELCBxdW90ZUlEKVxuICAgICAgaWYgKGNleEhhc01hcmtldChjZXhOYW1lKSkge1xuICAgICAgICBjb25zdCBpbWcgPSBwYWdlLmFyYkJ0dG5UbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICBpbWcuc3JjID0gZGluZm8ubG9nb1xuICAgICAgICB0bXBsLmFyYnMuYXBwZW5kQ2hpbGQoaW1nKVxuICAgICAgICBhcmJzLnB1c2goY2V4TmFtZSlcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zZXRDRVhBdmFpbGFiaWxpdHkoYmFzZUlELCBxdW90ZUlELCBjZXhOYW1lKVxuICAgIHRoaXMuc2hvd0JvdFR5cGVGb3JtKGhvc3QsIGJhc2VJRCwgcXVvdGVJRCwgYm90VHlwZUFyYk1NLCBjZXhOYW1lKVxuICB9XG5cbiAgLypcbiAgICogc2V0dXBDRVhlcyBzaG91bGQgYmUgY2FsbGVkIGR1cmluZyBpbml0aWFsaXphdGlvbi5cbiAgICovXG4gIHNldHVwQ0VYZXMgKCkge1xuICAgIHRoaXMuZm9ybUNleGVzID0ge31cbiAgICBmb3IgKGNvbnN0IG5hbWUgb2YgT2JqZWN0LmtleXMoQ0VYRGlzcGxheUluZm9zKSkgdGhpcy5hZGRDRVgobmFtZSlcbiAgfVxuXG4gIC8qXG4gICAqIHNldENFWEF2YWlsYWJpbGl0eSBzZXRzIHRoZSBjb2xvcmluZyBhbmQgbWVzc2FnaW5nIG9mIHRoZSBDRVggc2VsZWN0aW9uXG4gICAqIGJ1dHRvbnMuXG4gICAqL1xuICBzZXRDRVhBdmFpbGFiaWxpdHkgKGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIsIHNlbGVjdGVkQ0VYPzogc3RyaW5nKSB7XG4gICAgY29uc3QgY2V4SGFzTWFya2V0ID0gdGhpcy5jZXhNYXJrZXRTdXBwb3J0RmlsdGVyKGJhc2VJRCwgcXVvdGVJRClcbiAgICBmb3IgKGNvbnN0IHsgbmFtZSwgZGl2LCB0bXBsIH0gb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmZvcm1DZXhlcykpIHtcbiAgICAgIGNvbnN0IGhhcyA9IGNleEhhc01hcmtldChuYW1lKVxuICAgICAgY29uc3QgY2V4U3RhdHVzID0gYXBwKCkubW1TdGF0dXMuY2V4ZXNbbmFtZV1cbiAgICAgIERvYy5oaWRlKHRtcGwudW5hdmFpbGFibGUsIHRtcGwubmVlZHNjb25maWcsIHRtcGwuZGlzY29ubmVjdGVkKVxuICAgICAgRG9jLnNldFZpcyhCb29sZWFuKGNleFN0YXR1cyksIHRtcGwucmVjb25maWcpXG4gICAgICB0bXBsLmxvZ28uY2xhc3NMaXN0LnJlbW92ZSgnZ3JleXNjYWwnKVxuICAgICAgZGl2LmNsYXNzTGlzdC50b2dnbGUoJ2NvbmZpZ3VyZWQnLCBCb29sZWFuKGNleFN0YXR1cykgJiYgIWNleFN0YXR1cy5jb25uZWN0RXJyKVxuICAgICAgaWYgKCFjZXhTdGF0dXMpIHtcbiAgICAgICAgRG9jLnNob3codG1wbC5uZWVkc2NvbmZpZylcbiAgICAgIH0gZWxzZSBpZiAoY2V4U3RhdHVzLmNvbm5lY3RFcnIpIHtcbiAgICAgICAgRG9jLnNob3codG1wbC5kaXNjb25uZWN0ZWQpXG4gICAgICB9IGVsc2UgaWYgKCFoYXMpIHtcbiAgICAgICAgRG9jLnNob3codG1wbC51bmF2YWlsYWJsZSlcbiAgICAgICAgdG1wbC5sb2dvLmNsYXNzTGlzdC5hZGQoJ2dyZXlzY2FsJylcbiAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gc2VsZWN0ZWRDRVgpIHRoaXMuc2VsZWN0Rm9ybUNFWChuYW1lKVxuICAgIH1cbiAgfVxuXG4gIHNlbGVjdEZvcm1DRVggKGNleE5hbWU6IHN0cmluZykge1xuICAgIGZvciAoY29uc3QgeyBuYW1lLCBkaXYgfSBvZiBPYmplY3QudmFsdWVzKHRoaXMuZm9ybUNleGVzKSkge1xuICAgICAgZGl2LmNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdGVkJywgbmFtZSA9PT0gY2V4TmFtZSlcbiAgICB9XG4gIH1cblxuICBhZGRDRVggKGNleE5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IGRpbmZvID0gQ0VYRGlzcGxheUluZm9zW2NleE5hbWVdXG4gICAgY29uc3QgZGl2ID0gdGhpcy5wYWdlLmNleE9wdFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBkaW5mby5uYW1lXG4gICAgdG1wbC5sb2dvLnNyYyA9IGRpbmZvLmxvZ29cbiAgICB0aGlzLnBhZ2UuY2V4U2VsZWN0aW9uLmFwcGVuZENoaWxkKGRpdilcbiAgICB0aGlzLmZvcm1DZXhlc1tjZXhOYW1lXSA9IHsgbmFtZTogY2V4TmFtZSwgZGl2LCB0bXBsIH1cbiAgICBEb2MuYmluZChkaXYsICdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNleFN0YXR1cyA9IGFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWVdXG4gICAgICBpZiAoIWNleFN0YXR1cyB8fCBjZXhTdGF0dXMuY29ubmVjdEVycikge1xuICAgICAgICB0aGlzLnNob3dDRVhDb25maWdGb3JtKGNleE5hbWUpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgY29uc3QgY2V4ID0gdGhpcy5mb3JtQ2V4ZXNbY2V4TmFtZV1cbiAgICAgIGlmIChjZXguZGl2LmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkgeyAvLyB1bnNlbGVjdFxuICAgICAgICBmb3IgKGNvbnN0IGNleCBvZiBPYmplY3QudmFsdWVzKHRoaXMuZm9ybUNleGVzKSkgY2V4LmRpdi5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlEIH0gPSB0aGlzLmZvcm1TcGVjc1xuICAgICAgICB0aGlzLnNldENFWEF2YWlsYWJpbGl0eShiYXNlSUQsIHF1b3RlSUQpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBjZXggb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmZvcm1DZXhlcykpIGNleC5kaXYuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0ZWQnLCBjZXgubmFtZSA9PT0gY2V4TmFtZSlcbiAgICB9KVxuICAgIERvYy5iaW5kKHRtcGwucmVjb25maWcsICdjbGljaycsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICB0aGlzLnNob3dDRVhDb25maWdGb3JtKGNleE5hbWUpXG4gICAgfSlcbiAgfVxuXG4gIHNob3dDRVhDb25maWdGb3JtIChjZXhOYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5jZXhDb25maWdGb3JtLnNldENFWChjZXhOYW1lKVxuICAgIHRoaXMuZm9ybXMuc2hvdyhwYWdlLmNleENvbmZpZ0Zvcm0pXG4gIH1cblxuICAvKlxuICAgKiBjZXhNYXJrZXRTdXBwb3J0RmlsdGVyIHJldHVybnMgYSBsb29rdXAgQ0VYZXMgdGhhdCBoYXZlIGEgbWF0Y2hpbmcgbWFya2V0XG4gICAqIGZvciB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGJhc2UgYW5kIHF1b3RlIGFzc2V0cy5cbiAgICovXG4gIGNleE1hcmtldFN1cHBvcnRGaWx0ZXIgKGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpIHtcbiAgICBjb25zdCBjZXhlczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4gPSB7fVxuICAgIGZvciAoY29uc3QgW2NleE5hbWUsIGNleFN0YXR1c10gb2YgT2JqZWN0LmVudHJpZXMoYXBwKCkubW1TdGF0dXMuY2V4ZXMpKSB7XG4gICAgICBmb3IgKGNvbnN0IHsgYmFzZUlEOiBiLCBxdW90ZUlEOiBxIH0gb2YgT2JqZWN0LnZhbHVlcyhjZXhTdGF0dXMubWFya2V0cyA/PyBbXSkpIHtcbiAgICAgICAgaWYgKGIgPT09IGJhc2VJRCAmJiBxID09PSBxdW90ZUlEKSB7XG4gICAgICAgICAgY2V4ZXNbY2V4TmFtZV0gPSB0cnVlXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKGNleE5hbWU6IHN0cmluZykgPT4gQm9vbGVhbihjZXhlc1tjZXhOYW1lXSlcbiAgfVxufVxuXG5mdW5jdGlvbiBpc1ZpZXdPbmx5IChzcGVjczogQm90U3BlY3MsIG1tU3RhdHVzOiBNYXJrZXRNYWtpbmdTdGF0dXMpOiBib29sZWFuIHtcbiAgY29uc3QgYm90U3RhdHVzID0gbW1TdGF0dXMuYm90cy5maW5kKCh7IGNvbmZpZzogY2ZnIH0pID0+IGNmZy5ob3N0ID09PSBzcGVjcy5ob3N0ICYmIGNmZy5iYXNlSUQgPT09IHNwZWNzLmJhc2VJRCAmJiBjZmcucXVvdGVJRCA9PT0gc3BlY3MucXVvdGVJRClcbiAgcmV0dXJuIEJvb2xlYW4oYm90U3RhdHVzPy5ydW5uaW5nKVxufVxuXG5jb25zdCBFeGNoYW5nZU5hbWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAnYmluYW5jZS5jb20nOiAnQmluYW5jZScsXG4gICdjb2luYmFzZS5jb20nOiAnQ29pbmJhc2UnLFxuICAnYml0dHJleC5jb20nOiAnQml0dHJleCcsXG4gICdoaXRidGMuY29tJzogJ0hpdEJUQycsXG4gICdleG1vLmNvbSc6ICdFWE1PJ1xufVxuXG5mdW5jdGlvbiB0b2tlbkFzc2V0QXBwcm92YWxTdGF0dXNlcyAoaG9zdDogc3RyaW5nLCBiOiBTdXBwb3J0ZWRBc3NldCwgcTogU3VwcG9ydGVkQXNzZXQpIHtcbiAgbGV0IGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzID0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWRcbiAgbGV0IHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1cyA9IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkXG5cbiAgaWYgKGI/LnRva2VuKSB7XG4gICAgY29uc3QgYmFzZUFzc2V0ID0gYXBwKCkuYXNzZXRzW2IuaWRdXG4gICAgY29uc3QgYmFzZVZlcnNpb24gPSBhcHAoKS5leGNoYW5nZXNbaG9zdF0uYXNzZXRzW2IuaWRdLnZlcnNpb25cbiAgICBpZiAoYmFzZUFzc2V0Py53YWxsZXQ/LmFwcHJvdmVkICYmIGJhc2VBc3NldC53YWxsZXQuYXBwcm92ZWRbYmFzZVZlcnNpb25dICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzID0gYmFzZUFzc2V0LndhbGxldC5hcHByb3ZlZFtiYXNlVmVyc2lvbl1cbiAgICB9XG4gIH1cbiAgaWYgKHE/LnRva2VuKSB7XG4gICAgY29uc3QgcXVvdGVBc3NldCA9IGFwcCgpLmFzc2V0c1txLmlkXVxuICAgIGNvbnN0IHF1b3RlVmVyc2lvbiA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XS5hc3NldHNbcS5pZF0udmVyc2lvblxuICAgIGlmIChxdW90ZUFzc2V0Py53YWxsZXQ/LmFwcHJvdmVkICYmIHF1b3RlQXNzZXQud2FsbGV0LmFwcHJvdmVkW3F1b3RlVmVyc2lvbl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID0gcXVvdGVBc3NldC53YWxsZXQuYXBwcm92ZWRbcXVvdGVWZXJzaW9uXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBbXG4gICAgYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMsXG4gICAgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzXG4gIF1cbn1cblxuY2xhc3MgQXNzZXRQYW5lIHtcbiAgcGc6IE1hcmtldE1ha2VyU2V0dGluZ3NQYWdlXG4gIGRpdjogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGFzc2V0SUQ6IG51bWJlclxuICB1aTogVW5pdEluZm9cbiAgd2FsbGV0Q29uZmlnOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gIGZlZUFzc2V0SUQ6IG51bWJlclxuICBmZWVVSTogVW5pdEluZm9cbiAgaXNRdW90ZTogYm9vbGVhblxuICBpc1Rva2VuOiBib29sZWFuXG4gIGxvdFNpemU6IG51bWJlciAvLyBtaWdodCBiZSBxdW90ZSBjb252ZXJ0ZWRcbiAgbG90U2l6ZUNvbnY6IG51bWJlclxuICBjZmc6IEJvdEFzc2V0Q29uZmlnXG4gIGludjogUHJvamVjdGVkQWxsb2NcbiAgblN3YXBGZWVzOiBJbmNyZW1lbnRhbElucHV0XG4gIG5Td2FwRmVlc1NsaWRlcjogTWluaVNsaWRlclxuICBvcmRlclJlc2VydmVzOiBOdW1iZXJJbnB1dFxuICBvcmRlclJlc2VydmVzU2xpZGVyOiBNaW5pU2xpZGVyXG4gIHNsaXBwYWdlQnVmZmVyOiBOdW1iZXJJbnB1dFxuICBzbGlwcGFnZUJ1ZmZlclNsaWRlcjogTWluaVNsaWRlclxuICBtaW5UcmFuc2ZlcjogTnVtYmVySW5wdXRcbiAgbWluVHJhbnNmZXJTbGlkZXI6IE1pbmlTbGlkZXJcblxuICBjb25zdHJ1Y3RvciAocGc6IE1hcmtldE1ha2VyU2V0dGluZ3NQYWdlLCBkaXY6IFBhZ2VFbGVtZW50KSB7XG4gICAgdGhpcy5wZyA9IHBnXG4gICAgdGhpcy5kaXYgPSBkaXZcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuXG4gICAgdGhpcy5uU3dhcEZlZXMgPSBuZXcgSW5jcmVtZW50YWxJbnB1dChwYWdlLm5Td2FwRmVlcywge1xuICAgICAgcHJlYzogZGVmYXVsdFN3YXBSZXNlcnZlcy5wcmVjLFxuICAgICAgaW5jOiBkZWZhdWx0U3dhcFJlc2VydmVzLmluYyxcbiAgICAgIGNoYW5nZWQ6ICh2OiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgeyBtaW5SLCByYW5nZSB9ID0gZGVmYXVsdFN3YXBSZXNlcnZlc1xuICAgICAgICB0aGlzLmNmZy5zd2FwRmVlTiA9IHZcbiAgICAgICAgdGhpcy5uU3dhcEZlZXNTbGlkZXIuc2V0VmFsdWUoKHYgLSBtaW5SKSAvIHJhbmdlKVxuICAgICAgICB0aGlzLnBnLnVwZGF0ZUFsbG9jYXRpb25zKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5uU3dhcEZlZXNTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLm5Td2FwRmVlc1NsaWRlciwgKHI6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3QgeyBtaW5SLCByYW5nZSwgcHJlYyB9ID0gZGVmYXVsdFN3YXBSZXNlcnZlc1xuICAgICAgY29uc3QgW3ZdID0gdG9QcmVjaXNpb24obWluUiArIHIgKiByYW5nZSwgcHJlYylcbiAgICAgIHRoaXMuY2ZnLnN3YXBGZWVOID0gdlxuICAgICAgdGhpcy5uU3dhcEZlZXMuc2V0VmFsdWUodilcbiAgICAgIHRoaXMucGcudXBkYXRlQWxsb2NhdGlvbnMoKVxuICAgIH0pXG4gICAgdGhpcy5vcmRlclJlc2VydmVzID0gbmV3IE51bWJlcklucHV0KHBhZ2Uub3JkZXJSZXNlcnZlc0ZhY3Rvciwge1xuICAgICAgcHJlYzogZGVmYXVsdE9yZGVyUmVzZXJ2ZXMucHJlYyxcbiAgICAgIG1pbjogMCxcbiAgICAgIGNoYW5nZWQ6ICh2OiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgeyBtaW5SLCByYW5nZSB9ID0gZGVmYXVsdE9yZGVyUmVzZXJ2ZXNcbiAgICAgICAgdGhpcy5jZmcub3JkZXJSZXNlcnZlc0ZhY3RvciA9IHZcbiAgICAgICAgdGhpcy5vcmRlclJlc2VydmVzU2xpZGVyLnNldFZhbHVlKCh2IC0gbWluUikgLyByYW5nZSlcbiAgICAgICAgdGhpcy5wZy51cGRhdGVBbGxvY2F0aW9ucygpXG4gICAgICB9XG4gICAgfSlcbiAgICB0aGlzLm9yZGVyUmVzZXJ2ZXNTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLm9yZGVyUmVzZXJ2ZXNTbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgbWluUiwgcmFuZ2UsIHByZWMgfSA9IGRlZmF1bHRPcmRlclJlc2VydmVzXG4gICAgICBjb25zdCBbdl0gPSB0b1ByZWNpc2lvbihtaW5SICsgciAqIHJhbmdlLCBwcmVjKVxuICAgICAgdGhpcy5vcmRlclJlc2VydmVzLnNldFZhbHVlKHYpXG4gICAgICB0aGlzLmNmZy5vcmRlclJlc2VydmVzRmFjdG9yID0gdlxuICAgICAgdGhpcy5wZy51cGRhdGVBbGxvY2F0aW9ucygpXG4gICAgfSlcbiAgICB0aGlzLnNsaXBwYWdlQnVmZmVyID0gbmV3IE51bWJlcklucHV0KHBhZ2Uuc2xpcHBhZ2VCdWZmZXJGYWN0b3IsIHtcbiAgICAgIHByZWM6IGRlZmF1bHRTbGlwcGFnZS5wcmVjLFxuICAgICAgbWluOiAwLFxuICAgICAgY2hhbmdlZDogKHY6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IG1pblIsIHJhbmdlIH0gPSBkZWZhdWx0U2xpcHBhZ2VcbiAgICAgICAgdGhpcy5jZmcuc2xpcHBhZ2VCdWZmZXJGYWN0b3IgPSB2XG4gICAgICAgIHRoaXMuc2xpcHBhZ2VCdWZmZXJTbGlkZXIuc2V0VmFsdWUoKHYgLSBtaW5SKSAvIHJhbmdlKVxuICAgICAgICB0aGlzLnBnLnVwZGF0ZUFsbG9jYXRpb25zKClcbiAgICAgIH1cbiAgICB9KVxuICAgIHRoaXMuc2xpcHBhZ2VCdWZmZXJTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLnNsaXBwYWdlQnVmZmVyU2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IG1pblIsIHJhbmdlLCBwcmVjIH0gPSBkZWZhdWx0U2xpcHBhZ2VcbiAgICAgIGNvbnN0IFt2XSA9IHRvUHJlY2lzaW9uKG1pblIgKyByICogcmFuZ2UsIHByZWMpXG4gICAgICB0aGlzLnNsaXBwYWdlQnVmZmVyLnNldFZhbHVlKG1pblIgKyByICogcmFuZ2UpXG4gICAgICB0aGlzLmNmZy5zbGlwcGFnZUJ1ZmZlckZhY3RvciA9IHZcbiAgICAgIHRoaXMucGcudXBkYXRlQWxsb2NhdGlvbnMoKVxuICAgIH0pXG4gICAgdGhpcy5taW5UcmFuc2ZlciA9IG5ldyBOdW1iZXJJbnB1dChwYWdlLm1pblRyYW5zZmVyLCB7XG4gICAgICBzaWdGaWdzOiB0cnVlLFxuICAgICAgbWluOiAwLFxuICAgICAgY2hhbmdlZDogKHY6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IGNmZyB9ID0gdGhpc1xuICAgICAgICBjb25zdCB0b3RhbEludmVudG9yeSA9IHRoaXMuY29tbWl0KClcbiAgICAgICAgY29uc3QgW21pblYsIG1heFZdID0gW3RoaXMubWluVHJhbnNmZXIubWluLCBNYXRoLm1heCh0aGlzLm1pblRyYW5zZmVyLm1pbiAqIDIsIHRvdGFsSW52ZW50b3J5KV1cbiAgICAgICAgY2ZnLnRyYW5zZmVyRmFjdG9yID0gKHYgLSBtaW5WKSAvIChtYXhWIC0gbWluVilcbiAgICAgICAgdGhpcy5taW5UcmFuc2ZlclNsaWRlci5zZXRWYWx1ZShjZmcudHJhbnNmZXJGYWN0b3IpXG4gICAgICB9XG4gICAgfSlcbiAgICB0aGlzLm1pblRyYW5zZmVyU2xpZGVyID0gbmV3IE1pbmlTbGlkZXIocGFnZS5taW5UcmFuc2ZlclNsaWRlciwgKHI6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3QgeyBjZmcgfSA9IHRoaXNcbiAgICAgIGNvbnN0IHRvdGFsSW52ZW50b3J5ID0gdGhpcy5jb21taXQoKVxuICAgICAgY29uc3QgW21pblYsIG1heFZdID0gW3RoaXMubWluVHJhbnNmZXIubWluLCBNYXRoLm1heCh0aGlzLm1pblRyYW5zZmVyLm1pbiwgdG90YWxJbnZlbnRvcnkpXVxuICAgICAgY2ZnLnRyYW5zZmVyRmFjdG9yID0gclxuICAgICAgdGhpcy5taW5UcmFuc2Zlci5zZXRWYWx1ZShtaW5WICsgciAqIChtYXhWIC0gbWluVikpXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHBhZ2Uuc2hvd0JhbGFuY2UsICdjbGljaycsICgpID0+IHsgcGcuc2hvd0FkZHJlc3ModGhpcy5hc3NldElEKSB9KVxuICB9XG5cbiAgLy8gbG90IHNpemUgY2FuIGNoYW5nZSBpZiB0aGlzIGlzIHRoZSBxdW90ZSBhc3NldCwga2VlcCBpdCB1cGRhdGVkLlxuICBzZXRMb3RTaXplIChsb3RTaXplOiBudW1iZXIpIHtcbiAgICBjb25zdCB7IHVpIH0gPSB0aGlzXG4gICAgdGhpcy5sb3RTaXplID0gbG90U2l6ZVxuICAgIHRoaXMubG90U2l6ZUNvbnYgPSBsb3RTaXplIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgfVxuXG4gIHNldEFzc2V0IChhc3NldElEOiBudW1iZXIsIGlzUXVvdGU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmFzc2V0SUQgPSBhc3NldElEXG4gICAgdGhpcy5pc1F1b3RlID0gaXNRdW90ZVxuICAgIGNvbnN0IGNmZyA9IHRoaXMuY2ZnID0gaXNRdW90ZSA/IHRoaXMucGcudXBkYXRlZENvbmZpZy5xdW90ZUNvbmZpZyA6IHRoaXMucGcudXBkYXRlZENvbmZpZy5iYXNlQ29uZmlnXG4gICAgY29uc3QgeyBwYWdlLCBkaXYsIHBnOiB7IHNwZWNzOiB7IGJvdFR5cGUsIGJhc2VJRCwgY2V4TmFtZSB9LCBta3RJRCwgdXBkYXRlZENvbmZpZzogeyBiYXNlT3B0aW9ucywgcXVvdGVPcHRpb25zIH0gfSB9ID0gdGhpc1xuICAgIGNvbnN0IHsgc3ltYm9sLCBuYW1lLCB0b2tlbiwgdW5pdEluZm86IHVpIH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICB0aGlzLnVpID0gdWlcbiAgICB0aGlzLndhbGxldENvbmZpZyA9IGFzc2V0SUQgPT09IGJhc2VJRCA/IGJhc2VPcHRpb25zIDogcXVvdGVPcHRpb25zXG4gICAgY29uc3QgeyBjb252ZW50aW9uYWw6IHsgdW5pdDogdGlja2VyIH0gfSA9IHVpXG4gICAgdGhpcy5mZWVBc3NldElEID0gdG9rZW4gPyB0b2tlbi5wYXJlbnRJRCA6IGFzc2V0SURcbiAgICBjb25zdCB7IHVuaXRJbmZvOiBmZWVVSSwgbmFtZTogZmVlTmFtZSwgc3ltYm9sOiBmZWVTeW1ib2wgfSA9IGFwcCgpLmFzc2V0c1t0aGlzLmZlZUFzc2V0SURdXG4gICAgdGhpcy5mZWVVSSA9IGZlZVVJXG4gICAgdGhpcy5pbnYgPSB7IGJvb2s6IDAsIGJvb2tpbmdGZWVzOiAwLCBzd2FwRmVlUmVzZXJ2ZXM6IDAsIGNleDogMCwgb3JkZXJSZXNlcnZlczogMCwgc2xpcHBhZ2VCdWZmZXI6IDAgfVxuICAgIHRoaXMuaXNUb2tlbiA9IEJvb2xlYW4odG9rZW4pXG4gICAgRG9jLnNldFZpcyh0aGlzLmlzVG9rZW4sIHBhZ2UuZmVlVG90YWxCb3gsIHBhZ2UuZmVlUmVzZXJ2ZXNCb3gsIHBhZ2UuZmVlQmFsYW5jZXMpXG4gICAgRG9jLnNldFZpcyhpc1F1b3RlLCBwYWdlLnNsaXBwYWdlQnVmZmVyQm94KVxuICAgIERvYy5zZXRTcmMoZGl2LCAnW2RhdGEtbG9nb10nLCBEb2MubG9nb1BhdGgoc3ltYm9sKSlcbiAgICBEb2Muc2V0VGV4dChkaXYsICdbZGF0YS1uYW1lXScsIG5hbWUpXG4gICAgRG9jLnNldFRleHQoZGl2LCAnW2RhdGEtdGlja2VyXScsIHRpY2tlcilcbiAgICBjb25zdCB7IGNvbnZlbnRpb25hbDogeyB1bml0OiBmZWVUaWNrZXIgfSB9ID0gZmVlVUlcbiAgICBEb2Muc2V0VGV4dChkaXYsICdbZGF0YS1mZWUtdGlja2VyXScsIGZlZVRpY2tlcilcbiAgICBEb2Muc2V0VGV4dChkaXYsICdbZGF0YS1mZWUtbmFtZV0nLCBmZWVOYW1lKVxuICAgIERvYy5zZXRTcmMoZGl2LCAnW2RhdGEtZmVlLWxvZ29dJywgRG9jLmxvZ29QYXRoKGZlZVN5bWJvbCkpXG4gICAgRG9jLnNldFZpcyhib3RUeXBlICE9PSBib3RUeXBlQmFzaWNNTSwgcGFnZS5jZXhNaW5JbnZCb3gpXG4gICAgRG9jLnNldFZpcyhib3RUeXBlICE9PSBib3RUeXBlQmFzaWNBcmIsIHBhZ2Uub3JkZXJSZXNlcnZlc0JveClcbiAgICB0aGlzLm5Td2FwRmVlcy5zZXRWYWx1ZShjZmcuc3dhcEZlZU4gPz8gZGVmYXVsdFN3YXBSZXNlcnZlcy5uKVxuICAgIHRoaXMublN3YXBGZWVzU2xpZGVyLnNldFZhbHVlKGNmZy5zd2FwRmVlTiAvIGRlZmF1bHRTd2FwUmVzZXJ2ZXMubWF4UilcbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICBjb25zdCBbdl0gPSB0b1ByZWNpc2lvbihjZmcub3JkZXJSZXNlcnZlc0ZhY3RvciA/PyBkZWZhdWx0T3JkZXJSZXNlcnZlcy5mYWN0b3IsIGRlZmF1bHRPcmRlclJlc2VydmVzLnByZWMpXG4gICAgICB0aGlzLm9yZGVyUmVzZXJ2ZXMuc2V0VmFsdWUodilcbiAgICAgIHRoaXMub3JkZXJSZXNlcnZlc1NsaWRlci5zZXRWYWx1ZSgodiAtIGRlZmF1bHRPcmRlclJlc2VydmVzLm1pblIpIC8gZGVmYXVsdE9yZGVyUmVzZXJ2ZXMucmFuZ2UpXG4gICAgfVxuICAgIGlmIChib3RUeXBlICE9PSBib3RUeXBlQmFzaWNNTSkge1xuICAgICAgdGhpcy5taW5UcmFuc2Zlci5wcmVjID0gTWF0aC5sb2cxMCh1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICAgIGNvbnN0IG1rdCA9IGFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWUgYXMgc3RyaW5nXS5tYXJrZXRzW21rdElEXVxuICAgICAgdGhpcy5taW5UcmFuc2Zlci5taW4gPSAoKGlzUXVvdGUgPyBta3QucXVvdGVNaW5XaXRoZHJhdyA6IG1rdC5iYXNlTWluV2l0aGRyYXcpIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgfVxuICAgIHRoaXMuc2xpcHBhZ2VCdWZmZXIuc2V0VmFsdWUoY2ZnLnNsaXBwYWdlQnVmZmVyRmFjdG9yKVxuICAgIGNvbnN0IHsgbWluUiwgcmFuZ2UgfSA9IGRlZmF1bHRTbGlwcGFnZVxuICAgIHRoaXMuc2xpcHBhZ2VCdWZmZXJTbGlkZXIuc2V0VmFsdWUoKGNmZy5zbGlwcGFnZUJ1ZmZlckZhY3RvciAtIG1pblIpIC8gcmFuZ2UpXG4gICAgdGhpcy5zZXR1cFdhbGxldFNldHRpbmdzKClcbiAgICB0aGlzLnVwZGF0ZUJhbGFuY2VzKClcbiAgfVxuXG4gIGNvbW1pdCAoKSB7XG4gICAgY29uc3QgeyBpbnYsIGlzVG9rZW4gfSA9IHRoaXNcbiAgICBsZXQgY29tbWl0ID0gaW52LmJvb2sgKyBpbnYuY2V4ICsgaW52Lm9yZGVyUmVzZXJ2ZXMgKyBpbnYuc2xpcHBhZ2VCdWZmZXJcbiAgICBpZiAoIWlzVG9rZW4pIGNvbW1pdCArPSBpbnYuYm9va2luZ0ZlZXMgKyBpbnYuc3dhcEZlZVJlc2VydmVzXG4gICAgcmV0dXJuIGNvbW1pdFxuICB9XG5cbiAgdXBkYXRlSW52ZW50b3J5IChsb3RzOiBudW1iZXIsIGNvdW50ZXJMb3RzOiBudW1iZXIsIGxvdFNpemU6IG51bWJlciwgZGV4Q29tbWl0OiBudW1iZXIsIGNleENvbW1pdDogbnVtYmVyLCBmZWVzOiBBc3NldEJvb2tpbmdGZWVzKSB7XG4gICAgdGhpcy5zZXRMb3RTaXplKGxvdFNpemUpXG4gICAgY29uc3QgeyBwYWdlLCBjZmcsIGxvdFNpemVDb252LCBpbnYsIHVpLCBmZWVVSSwgaXNUb2tlbiwgaXNRdW90ZSwgcGc6IHsgc3BlY3M6IHsgY2V4TmFtZSwgYm90VHlwZSB9IH0gfSA9IHRoaXNcbiAgICBwYWdlLmJvb2tMb3RzLnRleHRDb250ZW50ID0gU3RyaW5nKGxvdHMpXG4gICAgcGFnZS5ib29rTG90U2l6ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhsb3RTaXplQ29udilcbiAgICBpbnYuYm9vayA9IGxvdHMgKiBsb3RTaXplQ29udlxuICAgIHBhZ2UuYm9va0NvbW1pdG1lbnQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoaW52LmJvb2spXG4gICAgY29uc3QgZmVlc1BlckxvdENvbnYgPSBmZWVzLmJvb2tpbmdGZWVzUGVyTG90IC8gZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICBwYWdlLmJvb2tpbmdGZWVzUGVyTG90LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGZlZXNQZXJMb3RDb252KVxuICAgIHBhZ2Uuc3dhcFJlc2VydmVzRmFjdG9yLnRleHRDb250ZW50ID0gZmVlcy5zd2FwUmVzZXJ2ZXNGYWN0b3IudG9GaXhlZCgyKVxuICAgIHBhZ2UuYm9va2luZ0ZlZXNMb3RzLnRleHRDb250ZW50ID0gU3RyaW5nKGxvdHMpXG4gICAgaW52LmJvb2tpbmdGZWVzID0gZmVlcy5ib29raW5nRmVlcyAvIGZlZVVJLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgcGFnZS5ib29raW5nRmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhpbnYuYm9va2luZ0ZlZXMpXG4gICAgaWYgKGNleE5hbWUpIHtcbiAgICAgIGludi5jZXggPSBjZXhDb21taXQgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgICAgcGFnZS5jZXhNaW5JbnYudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoaW52LmNleClcbiAgICB9XG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY0FyYikge1xuICAgICAgY29uc3QgdG90YWxJbnZlbnRvcnkgPSBNYXRoLm1heChjZXhDb21taXQsIGRleENvbW1pdCkgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgICAgcGFnZS5vcmRlclJlc2VydmVzQmFzaXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModG90YWxJbnZlbnRvcnkpXG4gICAgICBjb25zdCBvcmRlclJlc2VydmVzID0gdG90YWxJbnZlbnRvcnkgKiBjZmcub3JkZXJSZXNlcnZlc0ZhY3RvclxuICAgICAgaW52Lm9yZGVyUmVzZXJ2ZXMgPSBvcmRlclJlc2VydmVzXG4gICAgICBwYWdlLm9yZGVyUmVzZXJ2ZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Mob3JkZXJSZXNlcnZlcylcbiAgICB9XG4gICAgaWYgKGlzVG9rZW4pIHtcbiAgICAgIGNvbnN0IGZlZXNQZXJTd2FwQ29udiA9IGZlZXMudG9rZW5GZWVzUGVyU3dhcCAvIGZlZVVJLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgICBwYWdlLmZlZVJlc2VydmVzUGVyU3dhcC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVzUGVyU3dhcENvbnYpXG4gICAgICBpbnYuc3dhcEZlZVJlc2VydmVzID0gZmVlc1BlclN3YXBDb252ICogY2ZnLnN3YXBGZWVOXG4gICAgICBwYWdlLmZlZVJlc2VydmVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGludi5zd2FwRmVlUmVzZXJ2ZXMpXG4gICAgfVxuICAgIGlmIChpc1F1b3RlKSB7XG4gICAgICBjb25zdCBiYXNpcyA9IGludi5ib29rICsgaW52LmNleCArIGludi5vcmRlclJlc2VydmVzXG4gICAgICBwYWdlLnNsaXBwYWdlQnVmZmVyQmFzaXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJhc2lzICogdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IsIHVpKVxuICAgICAgaW52LnNsaXBwYWdlQnVmZmVyID0gYmFzaXMgKiBjZmcuc2xpcHBhZ2VCdWZmZXJGYWN0b3JcbiAgICAgIHBhZ2Uuc2xpcHBhZ2VCdWZmZXIudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGludi5zbGlwcGFnZUJ1ZmZlciAqIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yLCB1aSlcbiAgICB9XG4gICAgRG9jLnNldFZpcyhmZWVzLmJvb2tpbmdGZWVzUGVyQ291bnRlckxvdCA+IDAsIHBhZ2UucmVkZW1wdGlvbkZlZXNCb3gpXG4gICAgaWYgKGZlZXMuYm9va2luZ0ZlZXNQZXJDb3VudGVyTG90ID4gMCkge1xuICAgICAgY29uc3QgZmVlc1BlckxvdENvbnYgPSBmZWVzLmJvb2tpbmdGZWVzUGVyQ291bnRlckxvdCAvIGZlZVVJLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgICBwYWdlLnJlZGVtcHRpb25GZWVzUGVyTG90LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGZlZXNQZXJMb3RDb252KVxuICAgICAgcGFnZS5yZWRlbXB0aW9uRmVlc0xvdHMudGV4dENvbnRlbnQgPSBTdHJpbmcoY291bnRlckxvdHMpXG4gICAgICBwYWdlLnJlZGVlbVJlc2VydmVzRmFjdG9yLnRleHRDb250ZW50ID0gZmVlcy5yZWRlZW1SZXNlcnZlc0ZhY3Rvci50b0ZpeGVkKDIpXG4gICAgfVxuICAgIHRoaXMudXBkYXRlQ29tbWl0VG90YWwoKVxuICAgIHRoaXMudXBkYXRlVG9rZW5GZWVzKClcbiAgICB0aGlzLnVwZGF0ZVJlYmFsYW5jZSgpXG4gIH1cblxuICB1cGRhdGVDb21taXRUb3RhbCAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBhc3NldElELCB1aSB9ID0gdGhpc1xuICAgIGNvbnN0IGNvbW1pdCA9IHRoaXMuY29tbWl0KClcbiAgICBwYWdlLmNvbW1pdFRvdGFsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShNYXRoLnJvdW5kKGNvbW1pdCAqIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKSwgdWkpXG4gICAgcGFnZS5jb21taXRUb3RhbEZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoY29tbWl0ICogYXBwKCkuZmlhdFJhdGVzTWFwW2Fzc2V0SURdKVxuICB9XG5cbiAgdXBkYXRlVG9rZW5GZWVzICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGludiwgZmVlQXNzZXRJRCwgZmVlVUksIGlzVG9rZW4gfSA9IHRoaXNcbiAgICBpZiAoIWlzVG9rZW4pIHJldHVyblxuICAgIGNvbnN0IGZlZVJlc2VydmVzID0gaW52LmJvb2tpbmdGZWVzICsgaW52LnN3YXBGZWVSZXNlcnZlc1xuICAgIHBhZ2UuZmVlVG90YWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGZlZVJlc2VydmVzICogZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IsIGZlZVVJKVxuICAgIHBhZ2UuZmVlVG90YWxGaWF0LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGZlZVJlc2VydmVzICogYXBwKCkuZmlhdFJhdGVzTWFwW2ZlZUFzc2V0SURdKVxuICB9XG5cbiAgdXBkYXRlUmViYWxhbmNlICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGNmZywgcGc6IHsgdXBkYXRlZENvbmZpZzogeyBjZXhSZWJhbGFuY2UgfSwgc3BlY3M6IHsgY2V4TmFtZSB9IH0gfSA9IHRoaXNcbiAgICBjb25zdCBzaG93UmViYWxhbmNlID0gY2V4TmFtZSAmJiBjZXhSZWJhbGFuY2VcbiAgICBEb2Muc2V0VmlzKHNob3dSZWJhbGFuY2UsIHBhZ2UucmViYWxhbmNlT3B0cylcbiAgICBpZiAoIXNob3dSZWJhbGFuY2UpIHJldHVyblxuICAgIGNvbnN0IHRvdGFsSW52ZW50b3J5ID0gdGhpcy5jb21taXQoKVxuICAgIGNvbnN0IFttaW5WLCBtYXhWXSA9IFt0aGlzLm1pblRyYW5zZmVyLm1pbiwgTWF0aC5tYXgodGhpcy5taW5UcmFuc2Zlci5taW4gKiAyLCB0b3RhbEludmVudG9yeSldXG4gICAgY29uc3QgcmFuZ2VWID0gbWF4ViAtIG1pblZcbiAgICB0aGlzLm1pblRyYW5zZmVyLnNldFZhbHVlKG1pblYgKyBjZmcudHJhbnNmZXJGYWN0b3IgKiByYW5nZVYpXG4gICAgdGhpcy5taW5UcmFuc2ZlclNsaWRlci5zZXRWYWx1ZSgoY2ZnLnRyYW5zZmVyRmFjdG9yIC0gZGVmYXVsdFRyYW5zZmVyLm1pblIpIC8gZGVmYXVsdFRyYW5zZmVyLnJhbmdlKVxuICB9XG5cbiAgc2V0dXBXYWxsZXRTZXR0aW5ncyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBhc3NldElELCB3YWxsZXRDb25maWcgfSA9IHRoaXNcbiAgICBjb25zdCB3YWxsZXRTZXR0aW5ncyA9IGFwcCgpLmN1cnJlbnRXYWxsZXREZWZpbml0aW9uKGFzc2V0SUQpXG4gICAgRG9jLmVtcHR5KHBhZ2Uud2FsbGV0U2V0dGluZ3MpXG4gICAgRG9jLnNldFZpcyghd2FsbGV0U2V0dGluZ3MubXVsdGlmdW5kaW5nb3B0cywgcGFnZS53YWxsZXRTZXR0aW5nc05vbmUpXG4gICAgaWYgKCF3YWxsZXRTZXR0aW5ncy5tdWx0aWZ1bmRpbmdvcHRzKSByZXR1cm5cbiAgICBjb25zdCBvcHRUb0RpdjogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+ID0ge31cbiAgICBjb25zdCBkZXBlbmRlbnRPcHRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7fVxuICAgIGNvbnN0IGFkZERlcGVuZGVudE9wdCA9IChvcHRLZXk6IHN0cmluZywgb3B0U2V0dGluZzogUGFnZUVsZW1lbnQsIGRlcGVuZGVudE9uOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmICghZGVwZW5kZW50T3B0c1tkZXBlbmRlbnRPbl0pIGRlcGVuZGVudE9wdHNbZGVwZW5kZW50T25dID0gW11cbiAgICAgIGRlcGVuZGVudE9wdHNbZGVwZW5kZW50T25dLnB1c2gob3B0S2V5KVxuICAgICAgb3B0VG9EaXZbb3B0S2V5XSA9IG9wdFNldHRpbmdcbiAgICB9XG4gICAgY29uc3Qgc2V0RGVwZW5kZW50T3B0c1ZpcyA9IChwYXJlbnRPcHRLZXk6IHN0cmluZywgdmlzOiBib29sZWFuKSA9PiB7XG4gICAgICBjb25zdCBvcHRLZXlzID0gZGVwZW5kZW50T3B0c1twYXJlbnRPcHRLZXldXG4gICAgICBpZiAoIW9wdEtleXMpIHJldHVyblxuICAgICAgZm9yIChjb25zdCBvcHRLZXkgb2Ygb3B0S2V5cykgRG9jLnNldFZpcyh2aXMsIG9wdFRvRGl2W29wdEtleV0pXG4gICAgfVxuICAgIGNvbnN0IGFkZE9wdCA9IChvcHQ6IE9yZGVyT3B0aW9uKSA9PiB7XG4gICAgICBpZiAob3B0LnF1b3RlQXNzZXRPbmx5ICYmICF0aGlzLmlzUXVvdGUpIHJldHVyblxuICAgICAgY29uc3QgY3VyclZhbCA9IHdhbGxldENvbmZpZ1tvcHQua2V5XVxuICAgICAgbGV0IGRpdjogUGFnZUVsZW1lbnQgfCB1bmRlZmluZWRcbiAgICAgIGlmIChvcHQuaXNib29sZWFuKSB7XG4gICAgICAgIGRpdiA9IHBhZ2UuYm9vbFNldHRpbmdUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgICAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBvcHQuZGlzcGxheW5hbWVcbiAgICAgICAgdG1wbC5pbnB1dC5jaGVja2VkID0gY3VyclZhbCA9PT0gJ3RydWUnXG4gICAgICAgIERvYy5iaW5kKHRtcGwuaW5wdXQsICdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgd2FsbGV0Q29uZmlnW29wdC5rZXldID0gdG1wbC5pbnB1dC5jaGVja2VkID8gJ3RydWUnIDogJ2ZhbHNlJ1xuICAgICAgICAgIHNldERlcGVuZGVudE9wdHNWaXMob3B0LmtleSwgQm9vbGVhbih0bXBsLmlucHV0LmNoZWNrZWQpKVxuICAgICAgICB9KVxuICAgICAgICBpZiAob3B0LmRlc2NyaXB0aW9uKSB0bXBsLnRvb2x0aXAuZGF0YXNldC50b29sdGlwID0gb3B0LmRlc2NyaXB0aW9uXG4gICAgICB9IGVsc2UgaWYgKG9wdC54eVJhbmdlKSB7XG4gICAgICAgIGNvbnN0IHsgc3RhcnQsIGVuZCwgeFVuaXQgfSA9IG9wdC54eVJhbmdlXG4gICAgICAgIGNvbnN0IHJhbmdlID0gZW5kLnggLSBzdGFydC54XG4gICAgICAgIGRpdiA9IHBhZ2UucmFuZ2VTZXR0aW5nVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICAgICAgdG1wbC5uYW1lLnRleHRDb250ZW50ID0gb3B0LmRpc3BsYXluYW1lXG4gICAgICAgIGlmIChvcHQuZGVzY3JpcHRpb24pIHRtcGwudG9vbHRpcC5kYXRhc2V0LnRvb2x0aXAgPSBvcHQuZGVzY3JpcHRpb25cbiAgICAgICAgaWYgKHhVbml0KSB0bXBsLnVuaXQudGV4dENvbnRlbnQgPSB4VW5pdFxuICAgICAgICBlbHNlIERvYy5oaWRlKHRtcGwudW5pdClcblxuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBOdW1iZXJJbnB1dCh0bXBsLnZhbHVlLCB7XG4gICAgICAgICAgcHJlYzogMSxcbiAgICAgICAgICBjaGFuZ2VkOiAocmF3VjogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbdiwgc10gPSB0b0ZvdXJTaWdGaWdzKHJhd1YsIDEpXG4gICAgICAgICAgICB3YWxsZXRDb25maWdbb3B0LmtleV0gPSBzXG4gICAgICAgICAgICBzbGlkZXIuc2V0VmFsdWUoKHYgLSBzdGFydC54KSAvIHJhbmdlKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgY29uc3Qgc2xpZGVyID0gbmV3IE1pbmlTbGlkZXIodG1wbC5zbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgICAgICBjb25zdCByYXdWID0gc3RhcnQueCArIHIgKiByYW5nZVxuICAgICAgICAgIGNvbnN0IFt2LCBzXSA9IHRvRm91clNpZ0ZpZ3MocmF3ViwgMSlcbiAgICAgICAgICB3YWxsZXRDb25maWdbb3B0LmtleV0gPSBzXG4gICAgICAgICAgaW5wdXQuc2V0VmFsdWUodilcbiAgICAgICAgfSlcbiAgICAgICAgLy8gVE9ETzogZGVmYXVsdCB2YWx1ZSBzaG91bGQgYmUgc21hbGxlciBvciBub25lIGZvciBiYXNlIGFzc2V0LlxuICAgICAgICBjb25zdCBbdiwgc10gPSB0b0ZvdXJTaWdGaWdzKHBhcnNlRmxvYXREZWZhdWx0KGN1cnJWYWwsIHN0YXJ0LngpLCAzKVxuICAgICAgICB3YWxsZXRDb25maWdbb3B0LmtleV0gPSBzXG4gICAgICAgIHNsaWRlci5zZXRWYWx1ZSgodiAtIHN0YXJ0LngpIC8gcmFuZ2UpXG4gICAgICAgIGlucHV0LnNldFZhbHVlKHYpXG4gICAgICAgIHRtcGwudmFsdWUudGV4dENvbnRlbnQgPSBzXG4gICAgICB9XG4gICAgICBpZiAoIWRpdikgcmV0dXJuIGNvbnNvbGUuZXJyb3IoXCJkb24ndCBrbm93IGhvdyB0byBoYW5kbGUgb3B0XCIsIG9wdClcbiAgICAgIHBhZ2Uud2FsbGV0U2V0dGluZ3MuYXBwZW5kQ2hpbGQoZGl2KVxuICAgICAgaWYgKG9wdC5kZXBlbmRzT24pIHtcbiAgICAgICAgYWRkRGVwZW5kZW50T3B0KG9wdC5rZXksIGRpdiwgb3B0LmRlcGVuZHNPbilcbiAgICAgICAgY29uc3QgcGFyZW50T3B0VmFsID0gd2FsbGV0Q29uZmlnW29wdC5kZXBlbmRzT25dXG4gICAgICAgIERvYy5zZXRWaXMocGFyZW50T3B0VmFsID09PSAndHJ1ZScsIGRpdilcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAod2FsbGV0U2V0dGluZ3MubXVsdGlmdW5kaW5nb3B0cyAmJiB3YWxsZXRTZXR0aW5ncy5tdWx0aWZ1bmRpbmdvcHRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAoY29uc3Qgb3B0IG9mIHdhbGxldFNldHRpbmdzLm11bHRpZnVuZGluZ29wdHMpIGFkZE9wdChvcHQpXG4gICAgfVxuICAgIGFwcCgpLmJpbmRUb29sdGlwcyhwYWdlLndhbGxldFNldHRpbmdzKVxuICB9XG5cbiAgdXBkYXRlQmFsYW5jZXMgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgYXNzZXRJRCwgdWksIGZlZUFzc2V0SUQsIGZlZVVJLCBwZzogeyBzcGVjczogeyBjZXhOYW1lLCBiYXNlSUQgfSwgY2V4QmFzZUJhbGFuY2UsIGNleFF1b3RlQmFsYW5jZSB9IH0gPSB0aGlzXG4gICAgY29uc3QgeyBiYWxhbmNlOiB7IGF2YWlsYWJsZSB9IH0gPSBhcHAoKS53YWxsZXRNYXBbYXNzZXRJRF1cbiAgICBjb25zdCBib3RJbnYgPSB0aGlzLnBnLnJ1bm5pbmdCb3RJbnZlbnRvcnkoYXNzZXRJRClcbiAgICBjb25zdCBkZXhBdmFpbCA9IGF2YWlsYWJsZSAtIGJvdEludi5kZXgudG90YWxcbiAgICBsZXQgY2V4QXZhaWwgPSAwXG4gICAgRG9jLnNldFZpcyhjZXhOYW1lLCBwYWdlLmJhbGFuY2VCcmVha2Rvd24pXG4gICAgaWYgKGNleE5hbWUpIHtcbiAgICAgIHBhZ2UuZGV4QXZhaWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4QXZhaWwgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICAgIGNvbnN0IHsgYXZhaWxhYmxlOiBjZXhSYXdBdmFpbCB9ID0gYXNzZXRJRCA9PT0gYmFzZUlEID8gY2V4QmFzZUJhbGFuY2UgOiBjZXhRdW90ZUJhbGFuY2VcbiAgICAgIGNleEF2YWlsID0gY2V4UmF3QXZhaWwgLSBib3RJbnYuY2V4LnRvdGFsXG4gICAgICBwYWdlLmNleEF2YWlsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleEF2YWlsIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgfVxuICAgIHBhZ2UuYXZhaWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoKGRleEF2YWlsICsgY2V4QXZhaWwpIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgaWYgKGFzc2V0SUQgPT09IGZlZUFzc2V0SUQpIHJldHVyblxuICAgIGNvbnN0IHsgYmFsYW5jZTogeyBhdmFpbGFibGU6IGZlZUF2YWlsIH0gfSA9IGFwcCgpLndhbGxldE1hcFtmZWVBc3NldElEXVxuICAgIHBhZ2UuZmVlQXZhaWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZmVlQXZhaWwgLyBmZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgYXBwLFxuICBQYWdlRWxlbWVudCxcbiAgQm90Q29uZmlnLFxuICBNTUJvdFN0YXR1cyxcbiAgQ0VYQ29uZmlnLFxuICBNYXJrZXRNYWtpbmdTdGF0dXMsXG4gIEV4Y2hhbmdlQmFsYW5jZSxcbiAgUnVuU3RhdHMsXG4gIFN0YXJ0Q29uZmlnLFxuICBNYXJrZXRXaXRoSG9zdCxcbiAgUnVubmluZ0JvdEludmVudG9yeSxcbiAgU3BvdCxcbiAgT3JkZXJQbGFjZW1lbnQsXG4gIFRva2VuLFxuICBVbml0SW5mbyxcbiAgTWFya2V0UmVwb3J0LFxuICBCb3RCYWxhbmNlQWxsb2NhdGlvbixcbiAgUHJvamVjdGVkQWxsb2MsXG4gIEJhbGFuY2VOb3RlLFxuICBCb3RCYWxhbmNlLFxuICBPcmRlcixcbiAgTG90RmVlUmFuZ2UsXG4gIEJvb2tpbmdGZWVzLFxuICBCb3RQcm9ibGVtcyxcbiAgRXBvY2hSZXBvcnROb3RlLFxuICBPcmRlclJlcG9ydCxcbiAgRXBvY2hSZXBvcnQsXG4gIFRyYWRlUGxhY2VtZW50LFxuICBTdXBwb3J0ZWRBc3NldCxcbiAgQ0VYUHJvYmxlbXNOb3RlLFxuICBDRVhQcm9ibGVtc1xufSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IHsgZ2V0SlNPTiwgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQgRG9jLCB7IGNsYW1wIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgKiBhcyBPcmRlclV0aWwgZnJvbSAnLi9vcmRlcnV0aWwnXG5pbXBvcnQgeyBDaGFydCwgUmVnaW9uLCBFeHRlbnRzLCBUcmFuc2xhdG9yIH0gZnJvbSAnLi9jaGFydHMnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7IEZvcm1zIH0gZnJvbSAnLi9mb3JtcydcblxuZXhwb3J0IGNvbnN0IEdhcFN0cmF0ZWd5TXVsdGlwbGllciA9ICdtdWx0aXBsaWVyJ1xuZXhwb3J0IGNvbnN0IEdhcFN0cmF0ZWd5QWJzb2x1dGUgPSAnYWJzb2x1dGUnXG5leHBvcnQgY29uc3QgR2FwU3RyYXRlZ3lBYnNvbHV0ZVBsdXMgPSAnYWJzb2x1dGUtcGx1cydcbmV4cG9ydCBjb25zdCBHYXBTdHJhdGVneVBlcmNlbnQgPSAncGVyY2VudCdcbmV4cG9ydCBjb25zdCBHYXBTdHJhdGVneVBlcmNlbnRQbHVzID0gJ3BlcmNlbnQtcGx1cydcblxuZXhwb3J0IGNvbnN0IGJvdFR5cGVCYXNpY01NID0gJ2Jhc2ljTU0nXG5leHBvcnQgY29uc3QgYm90VHlwZUFyYk1NID0gJ2FyYk1NJ1xuZXhwb3J0IGNvbnN0IGJvdFR5cGVCYXNpY0FyYiA9ICdiYXNpY0FyYidcblxuZXhwb3J0IGludGVyZmFjZSBDRVhEaXNwbGF5SW5mbyB7XG4gIG5hbWU6IHN0cmluZ1xuICBsb2dvOiBzdHJpbmdcbn1cblxuZXhwb3J0IGNvbnN0IENFWERpc3BsYXlJbmZvczogUmVjb3JkPHN0cmluZywgQ0VYRGlzcGxheUluZm8+ID0ge1xuICAnQmluYW5jZSc6IHtcbiAgICBuYW1lOiAnQmluYW5jZScsXG4gICAgbG9nbzogJy9pbWcvYmluYW5jZS5jb20ucG5nJ1xuICB9LFxuICAnQmluYW5jZVVTJzoge1xuICAgIG5hbWU6ICdCaW5hbmNlIFUuUy4nLFxuICAgIGxvZ286ICcvaW1nL2JpbmFuY2UudXMucG5nJ1xuICB9XG59XG5cbi8qXG4gKiBNYXJrZXRNYWtlckJvdCBpcyB0aGUgZnJvbnQgZW5kIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBzZXJ2ZXInc1xuICogbW0uTWFya2V0TWFrZXIuIE1hcmtldE1ha2VyQm90IGlzIGEgc2luZ2xldG9uIGFzc2lnbmVkIHRvIE1NIGJlbG93LlxuICovXG5jbGFzcyBNYXJrZXRNYWtlckJvdCB7XG4gIGNleEJhbGFuY2VDYWNoZTogUmVjb3JkPHN0cmluZywgUmVjb3JkPG51bWJlciwgRXhjaGFuZ2VCYWxhbmNlPj4gPSB7fVxuXG4gIC8qXG4gICAqIHVwZGF0ZUJvdENvbmZpZyBhcHBlbmRzIG9yIHVwZGF0ZXMgdGhlIHNwZWNpZmllZCBCb3RDb25maWcuXG4gICAqL1xuICBhc3luYyB1cGRhdGVCb3RDb25maWcgKGNmZzogQm90Q29uZmlnKSB7XG4gICAgcmV0dXJuIHBvc3RKU09OKCcvYXBpL3VwZGF0ZWJvdGNvbmZpZycsIGNmZylcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZUNFWENvbmZpZyBhcHBlbmRzIG9yIHVwZGF0ZXMgdGhlIHNwZWNpZmllZCBDRVhDb25maWcuXG4gICAqL1xuICBhc3luYyB1cGRhdGVDRVhDb25maWcgKGNmZzogQ0VYQ29uZmlnKSB7XG4gICAgcmV0dXJuIHBvc3RKU09OKCcvYXBpL3VwZGF0ZWNleGNvbmZpZycsIGNmZylcbiAgfVxuXG4gIGFzeW5jIHJlbW92ZUJvdENvbmZpZyAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHBvc3RKU09OKCcvYXBpL3JlbW92ZWJvdGNvbmZpZycsIHsgaG9zdCwgYmFzZUlELCBxdW90ZUlEIH0pXG4gIH1cblxuICBhc3luYyByZXBvcnQgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcikge1xuICAgIHJldHVybiBwb3N0SlNPTignL2FwaS9tYXJrZXRyZXBvcnQnLCB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCB9KVxuICB9XG5cbiAgYXN5bmMgc3RhcnRCb3QgKGNvbmZpZzogU3RhcnRDb25maWcpIHtcbiAgICByZXR1cm4gYXdhaXQgcG9zdEpTT04oJy9hcGkvc3RhcnRtYXJrZXRtYWtpbmdib3QnLCB7IGNvbmZpZyB9KVxuICB9XG5cbiAgYXN5bmMgc3RvcEJvdCAobWFya2V0OiBNYXJrZXRXaXRoSG9zdCkgOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBwb3N0SlNPTignL2FwaS9zdG9wbWFya2V0bWFraW5nYm90JywgeyBtYXJrZXQgfSlcbiAgfVxuXG4gIGFzeW5jIHN0YXR1cyAoKSA6IFByb21pc2U8TWFya2V0TWFraW5nU3RhdHVzPiB7XG4gICAgcmV0dXJuIChhd2FpdCBnZXRKU09OKCcvYXBpL21hcmtldG1ha2luZ3N0YXR1cycpKS5zdGF0dXNcbiAgfVxuXG4gIC8vIGJvdFN0YXRzIHJldHVybnMgdGhlIFJ1blN0YXRzIGZvciBhIHJ1bm5pbmcgYm90IHdpdGggdGhlIHNwZWNpZmllZCBwYXJhbWV0ZXJzLlxuICBib3RTdGF0cyAoYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlciwgaG9zdDogc3RyaW5nLCBzdGFydFRpbWU6IG51bWJlcik6IFJ1blN0YXRzIHwgdW5kZWZpbmVkIHtcbiAgICBmb3IgKGNvbnN0IGJvdFN0YXR1cyBvZiBPYmplY3QudmFsdWVzKGFwcCgpLm1tU3RhdHVzLmJvdHMpKSB7XG4gICAgICBpZiAoIWJvdFN0YXR1cy5ydW5TdGF0cykgY29udGludWVcbiAgICAgIGNvbnN0IHJ1blN0YXRzID0gYm90U3RhdHVzLnJ1blN0YXRzXG4gICAgICBjb25zdCBjZmcgPSBib3RTdGF0dXMuY29uZmlnXG4gICAgICBpZiAoY2ZnLmJhc2VJRCA9PT0gYmFzZUlEICYmIGNmZy5xdW90ZUlEID09PSBxdW90ZUlEICYmIGNmZy5ob3N0ID09PSBob3N0ICYmIHJ1blN0YXRzLnN0YXJ0VGltZSA9PT0gc3RhcnRUaW1lKSB7XG4gICAgICAgIHJldHVybiBydW5TdGF0c1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNhY2hlZENleEJhbGFuY2UgKGNleE5hbWU6IHN0cmluZywgYXNzZXRJRDogbnVtYmVyKTogRXhjaGFuZ2VCYWxhbmNlIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jZXhCYWxhbmNlQ2FjaGVbY2V4TmFtZV0/Llthc3NldElEXVxuICB9XG5cbiAgYXN5bmMgY2V4QmFsYW5jZSAoY2V4TmFtZTogc3RyaW5nLCBhc3NldElEOiBudW1iZXIpOiBQcm9taXNlPEV4Y2hhbmdlQmFsYW5jZT4ge1xuICAgIGlmICghdGhpcy5jZXhCYWxhbmNlQ2FjaGVbY2V4TmFtZV0pIHRoaXMuY2V4QmFsYW5jZUNhY2hlW2NleE5hbWVdID0ge31cbiAgICBjb25zdCBjZXhCYWxhbmNlID0gKGF3YWl0IHBvc3RKU09OKCcvYXBpL2NleGJhbGFuY2UnLCB7IGNleE5hbWUsIGFzc2V0SUQgfSkpLmNleEJhbGFuY2VcbiAgICB0aGlzLmNleEJhbGFuY2VDYWNoZVtjZXhOYW1lXVthc3NldElEXSA9IGNleEJhbGFuY2VcbiAgICByZXR1cm4gY2V4QmFsYW5jZVxuICB9XG59XG5cbi8vIE1NIGlzIHRoZSBmcm9udCBlbmQgcmVwcmVzZW50YXRpb24gb2YgdGhlIHNlcnZlcidzIG1tLk1hcmtldE1ha2VyLlxuZXhwb3J0IGNvbnN0IE1NID0gbmV3IE1hcmtldE1ha2VyQm90KClcblxuZXhwb3J0IGZ1bmN0aW9uIHJ1bm5pbmdCb3RJbnZlbnRvcnkgKGFzc2V0SUQ6IG51bWJlcik6IFJ1bm5pbmdCb3RJbnZlbnRvcnkge1xuICByZXR1cm4gYXBwKCkubW1TdGF0dXMuYm90cy5yZWR1Y2UoKHYsIHsgcnVuU3RhdHMsIHJ1bm5pbmcgfSkgPT4ge1xuICAgIGlmICghcnVubmluZyB8fCAhcnVuU3RhdHMpIHJldHVybiB2XG4gICAgY29uc3QgeyBkZXhCYWxhbmNlczogZCwgY2V4QmFsYW5jZXM6IGMgfSA9IHJ1blN0YXRzXG4gICAgdi5jZXgubG9ja2VkICs9IGNbYXNzZXRJRF0/LmxvY2tlZCA/PyAwXG4gICAgdi5jZXgubG9ja2VkICs9IGNbYXNzZXRJRF0/LnJlc2VydmVkID8/IDBcbiAgICB2LmNleC5hdmFpbCArPSBjW2Fzc2V0SURdPy5hdmFpbGFibGUgPz8gMFxuICAgIHYuY2V4LnRvdGFsID0gdi5jZXguYXZhaWwgKyB2LmNleC5sb2NrZWRcbiAgICB2LmRleC5sb2NrZWQgKz0gZFthc3NldElEXT8ubG9ja2VkID8/IDBcbiAgICB2LmRleC5sb2NrZWQgKz0gZFthc3NldElEXT8ucmVzZXJ2ZWQgPz8gMFxuICAgIHYuZGV4LmF2YWlsICs9IGRbYXNzZXRJRF0/LmF2YWlsYWJsZSA/PyAwXG4gICAgdi5kZXgudG90YWwgPSB2LmRleC5hdmFpbCArIHYuZGV4LmxvY2tlZFxuICAgIHYuYXZhaWwgKz0gKGRbYXNzZXRJRF0/LmF2YWlsYWJsZSA/PyAwKSArIChjW2Fzc2V0SURdPy5hdmFpbGFibGUgPz8gMClcbiAgICB2LmxvY2tlZCArPSAoZFthc3NldElEXT8ubG9ja2VkID8/IDApICsgKGNbYXNzZXRJRF0/LmxvY2tlZCA/PyAwKVxuICAgIHJldHVybiB2XG4gIH0sIHsgYXZhaWw6IDAsIGxvY2tlZDogMCwgY2V4OiB7IGF2YWlsOiAwLCBsb2NrZWQ6IDAsIHRvdGFsOiAwIH0sIGRleDogeyBhdmFpbDogMCwgbG9ja2VkOiAwLCB0b3RhbDogMCB9IH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRNYXJrZXRFbGVtZW50cyAoYW5jZXN0b3I6IFBhZ2VFbGVtZW50LCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCBob3N0OiBzdHJpbmcpIHtcbiAgRG9jLnNldFRleHQoYW5jZXN0b3IsICdbZGF0YS1ob3N0XScsIGhvc3QpXG4gIGNvbnN0IHsgdW5pdEluZm86IGJ1aSwgbmFtZTogYmFzZU5hbWUsIHN5bWJvbDogYmFzZVN5bWJvbCwgdG9rZW46IGJhc2VUb2tlbiB9ID0gYXBwKCkuYXNzZXRzW2Jhc2VJRF1cbiAgRG9jLnNldFRleHQoYW5jZXN0b3IsICdbZGF0YS1iYXNlLW5hbWVdJywgYmFzZU5hbWUpXG4gIERvYy5zZXRTcmMoYW5jZXN0b3IsICdbZGF0YS1iYXNlLWxvZ29dJywgRG9jLmxvZ29QYXRoKGJhc2VTeW1ib2wpKVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLWJhc2UtdGlja2VyXScsIGJ1aS5jb252ZW50aW9uYWwudW5pdClcbiAgY29uc3QgeyB1bml0SW5mbzogYmFzZUZlZVVJLCBuYW1lOiBiYXNlRmVlTmFtZSwgc3ltYm9sOiBiYXNlRmVlU3ltYm9sIH0gPSBhcHAoKS5hc3NldHNbYmFzZVRva2VuID8gYmFzZVRva2VuLnBhcmVudElEIDogYmFzZUlEXVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLWJhc2UtZmVlLW5hbWVdJywgYmFzZUZlZU5hbWUpXG4gIERvYy5zZXRTcmMoYW5jZXN0b3IsICdbZGF0YS1iYXNlLWZlZS1sb2dvXScsIERvYy5sb2dvUGF0aChiYXNlRmVlU3ltYm9sKSlcbiAgRG9jLnNldFRleHQoYW5jZXN0b3IsICdbZGF0YS1iYXNlLWZlZS10aWNrZXJdJywgYmFzZUZlZVVJLmNvbnZlbnRpb25hbC51bml0KVxuICBjb25zdCB7IHVuaXRJbmZvOiBxdWksIG5hbWU6IHF1b3RlTmFtZSwgc3ltYm9sOiBxdW90ZVN5bWJvbCwgdG9rZW46IHF1b3RlVG9rZW4gfSA9IGFwcCgpLmFzc2V0c1txdW90ZUlEXVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLXF1b3RlLW5hbWVdJywgcXVvdGVOYW1lKVxuICBEb2Muc2V0U3JjKGFuY2VzdG9yLCAnW2RhdGEtcXVvdGUtbG9nb10nLCBEb2MubG9nb1BhdGgocXVvdGVTeW1ib2wpKVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLXF1b3RlLXRpY2tlcl0nLCBxdWkuY29udmVudGlvbmFsLnVuaXQpXG4gIGNvbnN0IHsgdW5pdEluZm86IHF1b3RlRmVlVUksIG5hbWU6IHF1b3RlRmVlTmFtZSwgc3ltYm9sOiBxdW90ZUZlZVN5bWJvbCB9ID0gYXBwKCkuYXNzZXRzW3F1b3RlVG9rZW4gPyBxdW90ZVRva2VuLnBhcmVudElEIDogcXVvdGVJRF1cbiAgRG9jLnNldFRleHQoYW5jZXN0b3IsICdbZGF0YS1xdW90ZS1mZWUtbmFtZV0nLCBxdW90ZUZlZU5hbWUpXG4gIERvYy5zZXRTcmMoYW5jZXN0b3IsICdbZGF0YS1xdW90ZS1mZWUtbG9nb10nLCBEb2MubG9nb1BhdGgocXVvdGVGZWVTeW1ib2wpKVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLXF1b3RlLWZlZS10aWNrZXJdJywgcXVvdGVGZWVVSS5jb252ZW50aW9uYWwudW5pdClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldENleEVsZW1lbnRzIChhbmNlc3RvcjogUGFnZUVsZW1lbnQsIGNleE5hbWU6IHN0cmluZykge1xuICBjb25zdCBkaW5mbyA9IENFWERpc3BsYXlJbmZvc1tjZXhOYW1lXVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLWNleC1uYW1lXScsIGRpbmZvLm5hbWUpXG4gIERvYy5zZXRTcmMoYW5jZXN0b3IsICdbZGF0YS1jZXgtbG9nb10nLCBkaW5mby5sb2dvKVxuICBmb3IgKGNvbnN0IGltZyBvZiBEb2MuYXBwbHlTZWxlY3RvcihhbmNlc3RvciwgJ1tkYXRhLWNleC1sb2dvXScpKSBEb2Muc2hvdyhpbWcpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVRdW90ZUxvdCAobG90U2l6ZTogbnVtYmVyLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCBzcG90PzogU3BvdCkge1xuICBjb25zdCBiYXNlUmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtiYXNlSURdXG4gIGNvbnN0IHF1b3RlUmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtxdW90ZUlEXVxuICBjb25zdCB7IHVuaXRJbmZvOiB7IGNvbnZlbnRpb25hbDogeyBjb252ZXJzaW9uRmFjdG9yOiBiRmFjdG9yIH0gfSB9ID0gYXBwKCkuYXNzZXRzW2Jhc2VJRF1cbiAgY29uc3QgeyB1bml0SW5mbzogeyBjb252ZW50aW9uYWw6IHsgY29udmVyc2lvbkZhY3RvcjogcUZhY3RvciB9IH0gfSA9IGFwcCgpLmFzc2V0c1txdW90ZUlEXVxuICBpZiAoYmFzZVJhdGUgJiYgcXVvdGVSYXRlKSB7XG4gICAgcmV0dXJuIGxvdFNpemUgKiBiYXNlUmF0ZSAvIHF1b3RlUmF0ZSAqIHFGYWN0b3IgLyBiRmFjdG9yXG4gIH0gZWxzZSBpZiAoc3BvdCkge1xuICAgIHJldHVybiBsb3RTaXplICogc3BvdC5yYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvclxuICB9XG4gIHJldHVybiBxRmFjdG9yXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGxhY2VtZW50Q2hhcnRDb25maWcge1xuICBjZXhOYW1lOiBzdHJpbmdcbiAgYm90VHlwZTogc3RyaW5nXG4gIGJhc2VGaWF0UmF0ZTogbnVtYmVyXG4gIGRpY3Q6IHtcbiAgICBwcm9maXQ6IG51bWJlclxuICAgIGJ1eVBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W11cbiAgICBzZWxsUGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQbGFjZW1lbnRzQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XG4gIGNmZzogUGxhY2VtZW50Q2hhcnRDb25maWdcbiAgbG9hZGVkQ0VYOiBzdHJpbmdcbiAgY2V4TG9nbzogSFRNTEltYWdlRWxlbWVudFxuXG4gIGNvbnN0cnVjdG9yIChwYXJlbnQ6IFBhZ2VFbGVtZW50KSB7XG4gICAgc3VwZXIocGFyZW50LCB7XG4gICAgICByZXNpemU6ICgpID0+IHRoaXMucmVzaXplZCgpLFxuICAgICAgY2xpY2s6ICgvKiBlOiBNb3VzZUV2ZW50ICovKSA9PiB7IC8qIHBhc3MgKi8gfSxcbiAgICAgIHpvb206ICgvKiBiaWdnZXI6IGJvb2xlYW4gKi8pID0+IHsgLyogcGFzcyAqLyB9XG4gICAgfSlcbiAgfVxuXG4gIHJlc2l6ZWQgKCkge1xuICAgIHRoaXMucmVuZGVyKClcbiAgfVxuXG4gIGRyYXcgKCkgeyAvKiBwYXNzICovIH1cblxuICBzZXRNYXJrZXQgKGNmZzogUGxhY2VtZW50Q2hhcnRDb25maWcpIHtcbiAgICB0aGlzLmNmZyA9IGNmZ1xuICAgIGNvbnN0IHsgbG9hZGVkQ0VYLCBjZmc6IHsgY2V4TmFtZSB9IH0gPSB0aGlzXG4gICAgaWYgKGNleE5hbWUgJiYgY2V4TmFtZSAhPT0gbG9hZGVkQ0VYKSB7XG4gICAgICB0aGlzLmxvYWRlZENFWCA9IGNleE5hbWVcbiAgICAgIHRoaXMuY2V4TG9nbyA9IG5ldyBJbWFnZSgpXG4gICAgICBEb2MuYmluZCh0aGlzLmNleExvZ28sICdsb2FkJywgKCkgPT4geyB0aGlzLnJlbmRlcigpIH0pXG4gICAgICB0aGlzLmNleExvZ28uc3JjID0gQ0VYRGlzcGxheUluZm9zW2NleE5hbWUgfHwgJyddLmxvZ29cbiAgICB9XG4gICAgdGhpcy5yZW5kZXIoKVxuICB9XG5cbiAgcmVuZGVyICgpIHtcbiAgICBjb25zdCB7IGN0eCwgY2FudmFzLCB0aGVtZSwgY2ZnIH0gPSB0aGlzXG4gICAgaWYgKGNhbnZhcy53aWR0aCA9PT0gMCB8fCAhY2ZnKSByZXR1cm5cbiAgICBjb25zdCB7IGRpY3Q6IHsgYnV5UGxhY2VtZW50cywgc2VsbFBsYWNlbWVudHMsIHByb2ZpdCB9LCBiYXNlRmlhdFJhdGUsIGJvdFR5cGUgfSA9IGNmZ1xuICAgIGlmIChib3RUeXBlID09PSBib3RUeXBlQmFzaWNBcmIpIHJldHVyblxuXG4gICAgdGhpcy5jbGVhcigpXG5cbiAgICBjb25zdCBkcmF3RGFzaGVkTGluZSA9ICh4MDogbnVtYmVyLCB5MDogbnVtYmVyLCB4MTogbnVtYmVyLCB5MTogbnVtYmVyLCBjb2xvcjogc3RyaW5nKSA9PiB7XG4gICAgICBjdHguc2F2ZSgpXG4gICAgICBjdHguc2V0TGluZURhc2goWzMsIDVdKVxuICAgICAgY3R4LmxpbmVXaWR0aCA9IDEuNVxuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gY29sb3JcbiAgICAgIHRoaXMubGluZSh4MCwgeTAsIHgxLCB5MSlcbiAgICAgIGN0eC5yZXN0b3JlKClcbiAgICB9XG5cbiAgICBjb25zdCBpc0Jhc2ljTU0gPSBib3RUeXBlID09PSBib3RUeXBlQmFzaWNNTVxuICAgIGNvbnN0IGN4ID0gY2FudmFzLndpZHRoIC8gMlxuICAgIGNvbnN0IFtjZXhHYXBMLCBjZXhHYXBSXSA9IGlzQmFzaWNNTSA/IFtjeCwgY3hdIDogWzAuNDggKiBjYW52YXMud2lkdGgsIDAuNTIgKiBjYW52YXMud2lkdGhdXG5cbiAgICBjb25zdCBidXlMb3RzID0gYnV5UGxhY2VtZW50cy5yZWR1Y2UoKHY6IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IHYgKyBwLmxvdHMsIDApXG4gICAgY29uc3Qgc2VsbExvdHMgPSBzZWxsUGxhY2VtZW50cy5yZWR1Y2UoKHY6IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IHYgKyBwLmxvdHMsIDApXG4gICAgY29uc3QgbWF4TG90cyA9IE1hdGgubWF4KGJ1eUxvdHMsIHNlbGxMb3RzKVxuXG4gICAgbGV0IHdpZGVzdCA9IDBcbiAgICBsZXQgZmF1eFNwYWNlciA9IDBcbiAgICBpZiAoaXNCYXNpY01NKSB7XG4gICAgICBjb25zdCBsZWZ0bW9zdCA9IGJ1eVBsYWNlbWVudHMucmVkdWNlKCh2OiBudW1iZXIsIHA6IE9yZGVyUGxhY2VtZW50KSA9PiBNYXRoLm1heCh2LCBwLmdhcEZhY3RvciksIDApXG4gICAgICBjb25zdCByaWdodG1vc3QgPSBzZWxsUGxhY2VtZW50cy5yZWR1Y2UoKHY6IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IE1hdGgubWF4KHYsIHAuZ2FwRmFjdG9yKSwgMClcbiAgICAgIHdpZGVzdCA9IE1hdGgubWF4KGxlZnRtb3N0LCByaWdodG1vc3QpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZvciBhcmItbW0sIHdlIGRvbid0IGtub3cgaG93IHRoZSBvcmRlcnMgd2lsbCBiZSBzcGFjZWQgYmVjYXVzZSBpdFxuICAgICAgLy8gZGVwZW5kcyBvbiB0aGUgdndhcC4gQnV0IHdlJ3JlIGp1c3QgdHJ5aW5nIHRvIGNhcHR1cmUgdGhlIGdlbmVyYWwgc2Vuc2VcbiAgICAgIC8vIG9mIGhvdyB0aGUgcGFyYW1ldGVycyB3aWxsIGFmZmVjdCBvcmRlciBwbGFjZW1lbnQsIHNvIHdlJ2xsIGZha2UgaXQuXG4gICAgICAvLyBIaWdoZXIgbWF0Y2ggYnVmZmVyIHZhbHVlcyB3aWxsIGxlYWQgdG8gb3JkZXJzIHdpdGggbGVzcyBmYXZvcmFibGVcbiAgICAgIC8vIHJhdGVzLCBlLmcuIHRoZSBzcGFjaW5nIHdpbGwgYmUgbGFyZ2VyLlxuICAgICAgY29uc3QgcHMgPSBbLi4uYnV5UGxhY2VtZW50cywgLi4uc2VsbFBsYWNlbWVudHNdXG4gICAgICBjb25zdCBtYXRjaEJ1ZmZlciA9IHBzLnJlZHVjZSgoc3VtOiBudW1iZXIsIHA6IE9yZGVyUGxhY2VtZW50KSA9PiBzdW0gKyBwLmdhcEZhY3RvciwgMCkgLyBwcy5sZW5ndGhcbiAgICAgIGZhdXhTcGFjZXIgPSAwLjAxICogKDEgKyBtYXRjaEJ1ZmZlcilcbiAgICAgIHdpZGVzdCA9IE1hdGgubWluKDEwLCBNYXRoLm1heChidXlQbGFjZW1lbnRzLmxlbmd0aCwgc2VsbFBsYWNlbWVudHMubGVuZ3RoKSkgKiBmYXV4U3BhY2VyIC8vIGFyYi1tbVxuICAgIH1cblxuICAgIC8vIE1ha2UgdGhlIHJhbmdlIDE1JSBvbiBlYWNoIHNpZGUsIHdoaWNoIHdpbGwgaW5jbHVkZSBwcm9maXQgKyBwbGFjZW1lbnRzLFxuICAgIC8vIHVubGVzcyB0aGV5IGhhdmUgb3JkZXJzIHdpdGggbGFyZ2VyIGdhcCBmYWN0b3JzLlxuICAgIGNvbnN0IG1pblJhbmdlID0gcHJvZml0ICsgd2lkZXN0XG4gICAgY29uc3QgZGVmYXVsdFJhbmdlID0gMC4xNTVcbiAgICBjb25zdCByYW5nZSA9IE1hdGgubWF4KG1pblJhbmdlICogMS4wNSwgZGVmYXVsdFJhbmdlKVxuXG4gICAgLy8gSW5jcmVhc2UgZGF0YSBoZWlnaHQgbG9nYXJpdGhtaWNhbGx5IHVwIHRvIDEsMDAwLDAwMCBVU0QuXG4gICAgY29uc3QgbWF4Q29tbWl0VVNEID0gbWF4TG90cyAqIGJhc2VGaWF0UmF0ZVxuICAgIGNvbnN0IHJlZ2lvbkhlaWdodCA9IDAuMiArIDAuNyAqIE1hdGgubG9nKGNsYW1wKG1heENvbW1pdFVTRCwgMCwgMWU2KSkgLyBNYXRoLmxvZygxZTYpXG5cbiAgICAvLyBEcmF3IGEgcmVnaW9uIGluIHRoZSBtaWRkbGUgcmVwcmVzZW50aW5nIHRoZSBjZXggZ2FwLlxuICAgIGNvbnN0IHBsb3RSZWdpb24gPSBuZXcgUmVnaW9uKGN0eCwgbmV3IEV4dGVudHMoMCwgY2FudmFzLndpZHRoLCAwLCBjYW52YXMuaGVpZ2h0KSlcblxuICAgIGlmIChpc0Jhc2ljTU0pIHtcbiAgICAgIGRyYXdEYXNoZWRMaW5lKGN4LCAwLCBjeCwgY2FudmFzLmhlaWdodCwgdGhlbWUuZ2FwTGluZSlcbiAgICB9IGVsc2UgeyAvLyBhcmItbW1cbiAgICAgIHBsb3RSZWdpb24ucGxvdChuZXcgRXh0ZW50cygwLCAxLCAwLCAxKSwgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0b29sczogVHJhbnNsYXRvcikgPT4ge1xuICAgICAgICBjb25zdCBbeTAsIHkxXSA9IFt0b29scy55KDApLCB0b29scy55KDEpXVxuICAgICAgICBkcmF3RGFzaGVkTGluZShjZXhHYXBMLCB5MCwgY2V4R2FwTCwgeTEsIHRoZW1lLmdhcExpbmUpXG4gICAgICAgIGRyYXdEYXNoZWRMaW5lKGNleEdhcFIsIHkwLCBjZXhHYXBSLCB5MSwgdGhlbWUuZ2FwTGluZSlcbiAgICAgICAgY29uc3QgeSA9IHRvb2xzLnkoMC45NSlcbiAgICAgICAgY3R4LmRyYXdJbWFnZSh0aGlzLmNleExvZ28sIGN4IC0gOCwgeSwgMTYsIDE2KVxuICAgICAgICB0aGlzLmFwcGx5TGFiZWxTdHlsZSgxOClcbiAgICAgICAgY3R4LmZpbGxUZXh0KCfOtCcsIGN4LCB5ICsgMjkpXG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IHBsb3RTaWRlID0gKGlzQnV5OiBib29sZWFuLCBwbGFjZW1lbnRzOiBPcmRlclBsYWNlbWVudFtdKSA9PiB7XG4gICAgICBpZiAoIXBsYWNlbWVudHM/Lmxlbmd0aCkgcmV0dXJuXG4gICAgICBjb25zdCBbeE1pbiwgeE1heF0gPSBpc0J1eSA/IFswLCBjZXhHYXBMXSA6IFtjZXhHYXBSLCBjYW52YXMud2lkdGhdXG4gICAgICBjb25zdCByZWcgPSBuZXcgUmVnaW9uKGN0eCwgbmV3IEV4dGVudHMoeE1pbiwgeE1heCwgY2FudmFzLmhlaWdodCAqICgxIC0gcmVnaW9uSGVpZ2h0KSwgY2FudmFzLmhlaWdodCkpXG4gICAgICBjb25zdCBbbCwgcl0gPSBpc0J1eSA/IFstcmFuZ2UsIDBdIDogWzAsIHJhbmdlXVxuICAgICAgcmVnLnBsb3QobmV3IEV4dGVudHMobCwgciwgMCwgbWF4TG90cyksIChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgdG9vbHM6IFRyYW5zbGF0b3IpID0+IHtcbiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDIuNVxuICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBpc0J1eSA/IHRoZW1lLmJ1eUxpbmUgOiB0aGVtZS5zZWxsTGluZVxuICAgICAgICBjdHguZmlsbFN0eWxlID0gaXNCdXkgPyB0aGVtZS5idXlGaWxsIDogdGhlbWUuc2VsbEZpbGxcbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpXG4gICAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSBpc0J1eSA/IC0xIDogMVxuICAgICAgICBjb25zdCBmaXJzdFB0ID0gcGxhY2VtZW50c1swXVxuICAgICAgICBjb25zdCB5MCA9IHRvb2xzLnkoMClcbiAgICAgICAgY29uc3QgZmlyc3RYID0gdG9vbHMueCgoaXNCYXNpY01NID8gZmlyc3RQdC5nYXBGYWN0b3IgOiBwcm9maXQgKyBmYXV4U3BhY2VyKSAqIHNpZGVGYWN0b3IpXG4gICAgICAgIGN0eC5tb3ZlVG8oZmlyc3RYLCB5MClcbiAgICAgICAgbGV0IGN1bXVsYXRpdmVMb3RzID0gMFxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBsYWNlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBwID0gcGxhY2VtZW50c1tpXVxuICAgICAgICAgIC8vIEZvciBhcmItbW0sIHdlIGRvbid0IGtub3cgZXhhY3RseVxuICAgICAgICAgIGNvbnN0IHJhd1ggPSBpc0Jhc2ljTU0gPyBwLmdhcEZhY3RvciA6IHByb2ZpdCArIChpICsgMSkgKiBmYXV4U3BhY2VyXG4gICAgICAgICAgY29uc3QgeCA9IHRvb2xzLngocmF3WCAqIHNpZGVGYWN0b3IpXG4gICAgICAgICAgY3R4LmxpbmVUbyh4LCB0b29scy55KGN1bXVsYXRpdmVMb3RzKSlcbiAgICAgICAgICBjdW11bGF0aXZlTG90cyArPSBwLmxvdHNcbiAgICAgICAgICBjdHgubGluZVRvKHgsIHRvb2xzLnkoY3VtdWxhdGl2ZUxvdHMpKVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHhJbmZpbml0eSA9IGlzQnV5ID8gY2FudmFzLndpZHRoICogLTAuMSA6IGNhbnZhcy53aWR0aCAqIDEuMVxuICAgICAgICBjdHgubGluZVRvKHhJbmZpbml0eSwgdG9vbHMueShjdW11bGF0aXZlTG90cykpXG4gICAgICAgIGN0eC5zdHJva2UoKVxuICAgICAgICBjdHgubGluZVRvKHhJbmZpbml0eSwgeTApXG4gICAgICAgIGN0eC5saW5lVG8oZmlyc3RYLCB5MClcbiAgICAgICAgY3R4LmNsb3NlUGF0aCgpXG4gICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuMjVcbiAgICAgICAgY3R4LmZpbGwoKVxuICAgICAgfSwgdHJ1ZSlcbiAgICB9XG5cbiAgICBwbG90U2lkZShmYWxzZSwgc2VsbFBsYWNlbWVudHMpXG4gICAgcGxvdFNpZGUodHJ1ZSwgYnV5UGxhY2VtZW50cylcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaG9zdGVkTWFya2V0SUQgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcikge1xuICByZXR1cm4gYCR7aG9zdH0tJHtiYXNlSUR9LSR7cXVvdGVJRH1gIC8vIHNhbWUgYXMgTWFya2V0V2l0aEhvc3QuU3RyaW5nKClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpdmVCb3RDb25maWcgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcik6IEJvdENvbmZpZyB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHMgPSBsaXZlQm90U3RhdHVzKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgaWYgKHMpIHJldHVybiBzLmNvbmZpZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGl2ZUJvdFN0YXR1cyAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKTogTU1Cb3RTdGF0dXMgfCB1bmRlZmluZWQge1xuICBjb25zdCBzdGF0dXNlcyA9IChhcHAoKS5tbVN0YXR1cy5ib3RzIHx8IFtdKS5maWx0ZXIoKHM6IE1NQm90U3RhdHVzKSA9PiB7XG4gICAgcmV0dXJuIHMuY29uZmlnLmJhc2VJRCA9PT0gYmFzZUlEICYmIHMuY29uZmlnLnF1b3RlSUQgPT09IHF1b3RlSUQgJiYgcy5jb25maWcuaG9zdCA9PT0gaG9zdFxuICB9KVxuICBpZiAoc3RhdHVzZXMubGVuZ3RoKSByZXR1cm4gc3RhdHVzZXNbMF1cbn1cblxuaW50ZXJmYWNlIExvdHRlciB7XG4gIGxvdHM6IG51bWJlclxufVxuXG5mdW5jdGlvbiBzdW1Mb3RzIChsb3RzOiBudW1iZXIsIHA6IExvdHRlcikge1xuICByZXR1cm4gbG90cyArIHAubG90c1xufVxuXG5pbnRlcmZhY2UgQWxsb2NhdGlvblByb2plY3Rpb24ge1xuICBiUHJvajogUHJvamVjdGVkQWxsb2NcbiAgcVByb2o6IFByb2plY3RlZEFsbG9jXG4gIGFsbG9jOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG59XG5cbmZ1bmN0aW9uIGVtcHR5UHJvamVjdGlvbiAoKTogUHJvamVjdGVkQWxsb2Mge1xuICByZXR1cm4geyBib29rOiAwLCBib29raW5nRmVlczogMCwgc3dhcEZlZVJlc2VydmVzOiAwLCBjZXg6IDAsIG9yZGVyUmVzZXJ2ZXM6IDAsIHNsaXBwYWdlQnVmZmVyOiAwIH1cbn1cblxuZXhwb3J0IGNsYXNzIEJvdE1hcmtldCB7XG4gIGNmZzogQm90Q29uZmlnXG4gIGhvc3Q6IHN0cmluZ1xuICBiYXNlSUQ6IG51bWJlclxuICBiYXNlU3ltYm9sOiBzdHJpbmdcbiAgYmFzZVRpY2tlcjogc3RyaW5nXG4gIGJhc2VGZWVJRDogbnVtYmVyXG4gIGJhc2VJc0FjY291bnRMb2NrZXI6IGJvb2xlYW5cbiAgYmFzZUZlZVN5bWJvbDogc3RyaW5nXG4gIGJhc2VGZWVUaWNrZXI6IHN0cmluZ1xuICBiYXNlVG9rZW4/OiBUb2tlblxuICBxdW90ZUlEOiBudW1iZXJcbiAgcXVvdGVTeW1ib2w6IHN0cmluZ1xuICBxdW90ZVRpY2tlcjogc3RyaW5nXG4gIHF1b3RlRmVlSUQ6IG51bWJlclxuICBxdW90ZUlzQWNjb3VudExvY2tlcjogYm9vbGVhblxuICBxdW90ZUZlZVN5bWJvbDogc3RyaW5nXG4gIHF1b3RlRmVlVGlja2VyOiBzdHJpbmdcbiAgcXVvdGVUb2tlbj86IFRva2VuXG4gIGJvdFR5cGU6IHN0cmluZ1xuICBjZXhOYW1lOiBzdHJpbmdcbiAgZGluZm86IENFWERpc3BsYXlJbmZvXG4gIGFsbG9jOiBCb3RCYWxhbmNlQWxsb2NhdGlvblxuICBwcm9qOiBBbGxvY2F0aW9uUHJvamVjdGlvblxuICBidWk6IFVuaXRJbmZvXG4gIGJhc2VGYWN0b3I6IG51bWJlclxuICBiYXNlRmVlVUk6IFVuaXRJbmZvXG4gIGJhc2VGZWVGYWN0b3I6IG51bWJlclxuICBxdWk6IFVuaXRJbmZvXG4gIHF1b3RlRmFjdG9yOiBudW1iZXJcbiAgcXVvdGVGZWVVSTogVW5pdEluZm9cbiAgcXVvdGVGZWVGYWN0b3I6IG51bWJlclxuICBpZDogc3RyaW5nIC8vIGluY2x1ZGVzIGhvc3RcbiAgbWt0SUQ6IHN0cmluZ1xuICBsb3RTaXplOiBudW1iZXJcbiAgbG90U2l6ZUNvbnY6IG51bWJlclxuICBsb3RTaXplVVNEOiBudW1iZXJcbiAgcXVvdGVMb3Q6IG51bWJlclxuICBxdW90ZUxvdENvbnY6IG51bWJlclxuICBxdW90ZUxvdFVTRDogbnVtYmVyXG4gIHJhdGVTdGVwOiBudW1iZXJcbiAgYmFzZUZlZUZpYXRSYXRlOiBudW1iZXJcbiAgcXVvdGVGZWVGaWF0UmF0ZTogbnVtYmVyXG4gIGJhc2VMb3RzOiBudW1iZXJcbiAgcXVvdGVMb3RzOiBudW1iZXJcbiAgbWFya2V0UmVwb3J0OiBNYXJrZXRSZXBvcnRcbiAgY2V4QmFzZUJhbGFuY2U/OiBFeGNoYW5nZUJhbGFuY2VcbiAgY2V4UXVvdGVCYWxhbmNlPzogRXhjaGFuZ2VCYWxhbmNlXG4gIG5CdXlQbGFjZW1lbnRzOiBudW1iZXJcbiAgblNlbGxQbGFjZW1lbnRzOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAoY2ZnOiBCb3RDb25maWcpIHtcbiAgICBjb25zdCBob3N0ID0gdGhpcy5ob3N0ID0gY2ZnLmhvc3RcbiAgICBjb25zdCBiYXNlSUQgPSB0aGlzLmJhc2VJRCA9IGNmZy5iYXNlSURcbiAgICBjb25zdCBxdW90ZUlEID0gdGhpcy5xdW90ZUlEID0gY2ZnLnF1b3RlSURcbiAgICB0aGlzLmNleE5hbWUgPSBjZmcuY2V4TmFtZVxuICAgIGNvbnN0IHN0YXR1cyA9IGFwcCgpLm1tU3RhdHVzLmJvdHMuZmluZCgoeyBjb25maWc6IGMgfTogTU1Cb3RTdGF0dXMpID0+IGMuYmFzZUlEID09PSBiYXNlSUQgJiYgYy5xdW90ZUlEID09PSBxdW90ZUlEICYmIGMuaG9zdCA9PT0gaG9zdClcbiAgICBpZiAoIXN0YXR1cykgdGhyb3cgRXJyb3IoJ3doZXJlXFwncyB0aGUgYm90IHN0YXR1cz8nKVxuICAgIHRoaXMuY2ZnID0gc3RhdHVzLmNvbmZpZ1xuXG4gICAgY29uc3QgeyB0b2tlbjogYmFzZVRva2VuLCBzeW1ib2w6IGJhc2VTeW1ib2wsIHVuaXRJbmZvOiBidWkgfSA9IGFwcCgpLmFzc2V0c1tiYXNlSURdXG4gICAgdGhpcy5iYXNlU3ltYm9sID0gYmFzZVN5bWJvbFxuICAgIHRoaXMuYmFzZVRpY2tlciA9IGJ1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIHRoaXMuYnVpID0gYnVpXG4gICAgdGhpcy5iYXNlRmFjdG9yID0gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgdGhpcy5iYXNlVG9rZW4gPSBiYXNlVG9rZW5cbiAgICBjb25zdCBiYXNlRmVlSUQgPSB0aGlzLmJhc2VGZWVJRCA9IGJhc2VUb2tlbiA/IGJhc2VUb2tlbi5wYXJlbnRJRCA6IGJhc2VJRFxuICAgIGNvbnN0IHsgdW5pdEluZm86IGJhc2VGZWVVSSwgc3ltYm9sOiBiYXNlRmVlU3ltYm9sLCB3YWxsZXQ6IGJhc2VXYWxsZXQgfSA9IGFwcCgpLmFzc2V0c1t0aGlzLmJhc2VGZWVJRF1cbiAgICBjb25zdCB0cmFpdEFjY291bnRMb2NrZXIgPSAxIDw8IDE0XG4gICAgdGhpcy5iYXNlSXNBY2NvdW50TG9ja2VyID0gKGJhc2VXYWxsZXQudHJhaXRzICYgdHJhaXRBY2NvdW50TG9ja2VyKSA+IDBcbiAgICB0aGlzLmJhc2VGZWVVSSA9IGJhc2VGZWVVSVxuICAgIHRoaXMuYmFzZUZlZVRpY2tlciA9IGJhc2VGZWVVSS5jb252ZW50aW9uYWwudW5pdFxuICAgIHRoaXMuYmFzZUZlZVN5bWJvbCA9IGJhc2VGZWVTeW1ib2xcbiAgICB0aGlzLmJhc2VGZWVGYWN0b3IgPSB0aGlzLmJhc2VGZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuXG4gICAgY29uc3QgeyB0b2tlbjogcXVvdGVUb2tlbiwgc3ltYm9sOiBxdW90ZVN5bWJvbCwgdW5pdEluZm86IHF1aSB9ID0gYXBwKCkuYXNzZXRzW3F1b3RlSURdXG4gICAgdGhpcy5xdW90ZVN5bWJvbCA9IHF1b3RlU3ltYm9sXG4gICAgdGhpcy5xdW90ZVRpY2tlciA9IHF1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIHRoaXMucXVpID0gcXVpXG4gICAgdGhpcy5xdW90ZUZhY3RvciA9IHF1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIHRoaXMucXVvdGVUb2tlbiA9IHF1b3RlVG9rZW5cbiAgICBjb25zdCBxdW90ZUZlZUlEID0gdGhpcy5xdW90ZUZlZUlEID0gcXVvdGVUb2tlbiA/IHF1b3RlVG9rZW4ucGFyZW50SUQgOiBxdW90ZUlEXG4gICAgY29uc3QgeyB1bml0SW5mbzogcXVvdGVGZWVVSSwgc3ltYm9sOiBxdW90ZUZlZVN5bWJvbCwgd2FsbGV0OiBxdW90ZVdhbGxldCB9ID0gYXBwKCkuYXNzZXRzW3RoaXMucXVvdGVGZWVJRF1cbiAgICB0aGlzLnF1b3RlSXNBY2NvdW50TG9ja2VyID0gKHF1b3RlV2FsbGV0LnRyYWl0cyAmIHRyYWl0QWNjb3VudExvY2tlcikgPiAwXG4gICAgdGhpcy5xdW90ZUZlZVVJID0gcXVvdGVGZWVVSVxuICAgIHRoaXMucXVvdGVGZWVUaWNrZXIgPSBxdW90ZUZlZVVJLmNvbnZlbnRpb25hbC51bml0XG4gICAgdGhpcy5xdW90ZUZlZVN5bWJvbCA9IHF1b3RlRmVlU3ltYm9sXG4gICAgdGhpcy5xdW90ZUZlZUZhY3RvciA9IHRoaXMucXVvdGVGZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuXG4gICAgdGhpcy5pZCA9IGhvc3RlZE1hcmtldElEKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICB0aGlzLm1rdElEID0gYCR7YmFzZVN5bWJvbH1fJHtxdW90ZVN5bWJvbH1gXG5cbiAgICBjb25zdCB7IG1hcmtldHMgfSA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XVxuICAgIGNvbnN0IHsgbG90c2l6ZTogbG90U2l6ZSwgcmF0ZXN0ZXA6IHJhdGVTdGVwIH0gPSBtYXJrZXRzW3RoaXMubWt0SURdXG4gICAgdGhpcy5sb3RTaXplID0gbG90U2l6ZVxuICAgIHRoaXMubG90U2l6ZUNvbnYgPSBsb3RTaXplIC8gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgdGhpcy5yYXRlU3RlcCA9IHJhdGVTdGVwXG4gICAgdGhpcy5xdW90ZUxvdCA9IGNhbGN1bGF0ZVF1b3RlTG90KGxvdFNpemUsIGJhc2VJRCwgcXVvdGVJRClcbiAgICB0aGlzLnF1b3RlTG90Q29udiA9IHRoaXMucXVvdGVMb3QgLyBxdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcblxuICAgIHRoaXMuYmFzZUZlZUZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Jhc2VGZWVJRF1cbiAgICB0aGlzLnF1b3RlRmVlRmlhdFJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbcXVvdGVGZWVJRF1cblxuICAgIGlmIChjZmcuYXJiTWFya2V0TWFraW5nQ29uZmlnKSB7XG4gICAgICB0aGlzLmJvdFR5cGUgPSBib3RUeXBlQXJiTU1cbiAgICAgIHRoaXMuYmFzZUxvdHMgPSBjZmcuYXJiTWFya2V0TWFraW5nQ29uZmlnLnNlbGxQbGFjZW1lbnRzLnJlZHVjZShzdW1Mb3RzLCAwKVxuICAgICAgdGhpcy5xdW90ZUxvdHMgPSBjZmcuYXJiTWFya2V0TWFraW5nQ29uZmlnLmJ1eVBsYWNlbWVudHMucmVkdWNlKHN1bUxvdHMsIDApXG4gICAgICB0aGlzLm5CdXlQbGFjZW1lbnRzID0gY2ZnLmFyYk1hcmtldE1ha2luZ0NvbmZpZy5idXlQbGFjZW1lbnRzLmxlbmd0aFxuICAgICAgdGhpcy5uU2VsbFBsYWNlbWVudHMgPSBjZmcuYXJiTWFya2V0TWFraW5nQ29uZmlnLnNlbGxQbGFjZW1lbnRzLmxlbmd0aFxuICAgIH0gZWxzZSBpZiAoY2ZnLnNpbXBsZUFyYkNvbmZpZykge1xuICAgICAgdGhpcy5ib3RUeXBlID0gYm90VHlwZUJhc2ljQXJiXG4gICAgICB0aGlzLmJhc2VMb3RzID0gY2ZnLnVpQ29uZmlnLnNpbXBsZUFyYkxvdHMgYXMgbnVtYmVyXG4gICAgICB0aGlzLnF1b3RlTG90cyA9IGNmZy51aUNvbmZpZy5zaW1wbGVBcmJMb3RzIGFzIG51bWJlclxuICAgIH0gZWxzZSBpZiAoY2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnKSB7IC8vIGJhc2ljbW1cbiAgICAgIHRoaXMuYm90VHlwZSA9IGJvdFR5cGVCYXNpY01NXG4gICAgICB0aGlzLmJhc2VMb3RzID0gY2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnLnNlbGxQbGFjZW1lbnRzLnJlZHVjZShzdW1Mb3RzLCAwKVxuICAgICAgdGhpcy5xdW90ZUxvdHMgPSBjZmcuYmFzaWNNYXJrZXRNYWtpbmdDb25maWcuYnV5UGxhY2VtZW50cy5yZWR1Y2Uoc3VtTG90cywgMClcbiAgICAgIHRoaXMubkJ1eVBsYWNlbWVudHMgPSBjZmcuYmFzaWNNYXJrZXRNYWtpbmdDb25maWcuYnV5UGxhY2VtZW50cy5sZW5ndGhcbiAgICAgIHRoaXMublNlbGxQbGFjZW1lbnRzID0gY2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnLnNlbGxQbGFjZW1lbnRzLmxlbmd0aFxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGluaXRpYWxpemUgKHN0YXJ0dXBCYWxhbmNlQ2FjaGU6IFJlY29yZDxudW1iZXIsIFByb21pc2U8RXhjaGFuZ2VCYWxhbmNlPj4pIHtcbiAgICBjb25zdCB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCwgbG90U2l6ZUNvbnYsIHF1b3RlTG90Q29udiwgY2V4TmFtZSB9ID0gdGhpc1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IE1NLnJlcG9ydChob3N0LCBiYXNlSUQsIHF1b3RlSUQpXG4gICAgY29uc3QgciA9IHRoaXMubWFya2V0UmVwb3J0ID0gcmVzLnJlcG9ydCBhcyBNYXJrZXRSZXBvcnRcbiAgICB0aGlzLmxvdFNpemVVU0QgPSBsb3RTaXplQ29udiAqIHIuYmFzZUZpYXRSYXRlXG4gICAgdGhpcy5xdW90ZUxvdFVTRCA9IHF1b3RlTG90Q29udiAqIHIucXVvdGVGaWF0UmF0ZVxuICAgIHRoaXMucHJvaiA9IHRoaXMucHJvamVjdGVkQWxsb2NhdGlvbnMoKVxuXG4gICAgaWYgKGNleE5hbWUpIHtcbiAgICAgIGNvbnN0IGIgPSBzdGFydHVwQmFsYW5jZUNhY2hlW2Jhc2VJRF0gPSBzdGFydHVwQmFsYW5jZUNhY2hlW2Jhc2VJRF0gfHwgTU0uY2V4QmFsYW5jZShjZXhOYW1lLCBiYXNlSUQpXG4gICAgICBjb25zdCBxID0gc3RhcnR1cEJhbGFuY2VDYWNoZVtxdW90ZUlEXSA9IHN0YXJ0dXBCYWxhbmNlQ2FjaGVbcXVvdGVJRF0gfHwgTU0uY2V4QmFsYW5jZShjZXhOYW1lLCBxdW90ZUlEKVxuICAgICAgdGhpcy5jZXhCYXNlQmFsYW5jZSA9IGF3YWl0IGJcbiAgICAgIHRoaXMuY2V4UXVvdGVCYWxhbmNlID0gYXdhaXQgcVxuICAgIH1cbiAgfVxuXG4gIHN0YXR1cyAoKSB7XG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQgfSA9IHRoaXNcbiAgICBjb25zdCBib3RTdGF0dXMgPSBhcHAoKS5tbVN0YXR1cy5ib3RzLmZpbmQoKHM6IE1NQm90U3RhdHVzKSA9PiBzLmNvbmZpZy5iYXNlSUQgPT09IGJhc2VJRCAmJiBzLmNvbmZpZy5xdW90ZUlEID09PSBxdW90ZUlEKVxuICAgIGlmICghYm90U3RhdHVzKSByZXR1cm4geyBib3RDZmc6IHt9IGFzIEJvdENvbmZpZywgcnVubmluZzogZmFsc2UsIHJ1blN0YXRzOiB7fSBhcyBSdW5TdGF0cyB9XG4gICAgY29uc3QgeyBjb25maWc6IGJvdENmZywgcnVubmluZywgcnVuU3RhdHMsIGxhdGVzdEVwb2NoLCBjZXhQcm9ibGVtcyB9ID0gYm90U3RhdHVzXG4gICAgcmV0dXJuIHsgYm90Q2ZnLCBydW5uaW5nLCBydW5TdGF0cywgbGF0ZXN0RXBvY2gsIGNleFByb2JsZW1zIH1cbiAgfVxuXG4gIC8qXG4gICogYWRqdXN0ZWRCYWxhbmNlcyBjYWxjdWxhdGVzIHRoZSB1c2VyJ3MgYXZhaWxhYmxlIGJhbGFuY2VzIGFuZCBmZWUtYXNzZXRcbiAgKiBiYWxhbmNlcyBmb3IgYSBtYXJrZXQsIHdpdGggY29uc2lkZXJhdGlvbiBmb3IgY3VycmVudGx5IHJ1bm5pbmcgYm90cy5cbiAgKi9cbiAgYWRqdXN0ZWRCYWxhbmNlcyAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgYmFzZUlELCBxdW90ZUlELCBiYXNlRmVlSUQsIHF1b3RlRmVlSUQsIGNleEJhc2VCYWxhbmNlLCBjZXhRdW90ZUJhbGFuY2UsXG4gICAgICBiYXNlRmFjdG9yLCBxdW90ZUZhY3RvciwgYmFzZUZlZUZhY3RvciwgcXVvdGVGZWVGYWN0b3JcbiAgICB9ID0gdGhpc1xuICAgIGNvbnN0IFtiYXNlV2FsbGV0LCBxdW90ZVdhbGxldF0gPSBbYXBwKCkud2FsbGV0TWFwW2Jhc2VJRF0sIGFwcCgpLndhbGxldE1hcFtxdW90ZUlEXV1cbiAgICBjb25zdCBbYkludiwgcUludl0gPSBbcnVubmluZ0JvdEludmVudG9yeShiYXNlSUQpLCBydW5uaW5nQm90SW52ZW50b3J5KHF1b3RlSUQpXVxuICAgIC8vIEluIHRoZXNlIGF2YWlsYWJsZSBiYWxhbmNlIGNhbGNzLCBvbmx5IHN1YnRyYWN0IHRoZSBhdmFpbGFibGUgYmFsYW5jZSBvZlxuICAgIC8vIHJ1bm5pbmcgYm90cywgc2luY2UgdGhlIGxvY2tlZC9yZXNlcnZlZC9pbW1hdHVyZSBpcyBhbHJlYWR5IHN1YnRyYWN0ZWRcbiAgICAvLyBmcm9tIHRoZSB3YWxsZXQncyB0b3RhbCBhdmFpbGFibGUgYmFsYW5jZS5cbiAgICBjb25zdCBbY2V4QmFzZUF2YWlsLCBjZXhRdW90ZUF2YWlsXSA9IFsoY2V4QmFzZUJhbGFuY2U/LmF2YWlsYWJsZSB8fCAwKSAtIGJJbnYuY2V4LmF2YWlsLCAoY2V4UXVvdGVCYWxhbmNlPy5hdmFpbGFibGUgfHwgMCkgLSBxSW52LmNleC5hdmFpbF1cbiAgICBjb25zdCBbZGV4QmFzZUF2YWlsLCBkZXhRdW90ZUF2YWlsXSA9IFtiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC0gYkludi5kZXguYXZhaWwsIHF1b3RlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC0gcUludi5kZXguYXZhaWxdXG4gICAgY29uc3QgYmFzZUF2YWlsID0gZGV4QmFzZUF2YWlsICsgY2V4QmFzZUF2YWlsXG4gICAgY29uc3QgcXVvdGVBdmFpbCA9IGRleFF1b3RlQXZhaWwgKyBjZXhRdW90ZUF2YWlsXG4gICAgY29uc3QgYmFzZUZlZVdhbGxldCA9IGJhc2VGZWVJRCA9PT0gYmFzZUlEID8gYmFzZVdhbGxldCA6IGFwcCgpLndhbGxldE1hcFtiYXNlRmVlSURdXG4gICAgY29uc3QgcXVvdGVGZWVXYWxsZXQgPSBxdW90ZUZlZUlEID09PSBxdW90ZUlEID8gcXVvdGVXYWxsZXQgOiBhcHAoKS53YWxsZXRNYXBbcXVvdGVGZWVJRF1cblxuICAgIGxldCBbYmFzZUZlZUF2YWlsLCBkZXhCYXNlRmVlQXZhaWwsIGNleEJhc2VGZWVBdmFpbF0gPSBbYmFzZUF2YWlsLCBkZXhCYXNlQXZhaWwsIGNleEJhc2VBdmFpbF1cbiAgICBpZiAoYmFzZUZlZUlEICE9PSBiYXNlSUQpIHtcbiAgICAgIGNvbnN0IGJGZWVJbnYgPSBydW5uaW5nQm90SW52ZW50b3J5KGJhc2VJRClcbiAgICAgIGRleEJhc2VGZWVBdmFpbCA9IGJhc2VGZWVXYWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgLSBiRmVlSW52LmRleC50b3RhbFxuICAgICAgY2V4QmFzZUZlZUF2YWlsID0gKGNleEJhc2VCYWxhbmNlPy5hdmFpbGFibGUgfHwgMCkgLSBiRmVlSW52LmNleC50b3RhbFxuICAgICAgYmFzZUZlZUF2YWlsID0gZGV4QmFzZUZlZUF2YWlsICsgY2V4QmFzZUZlZUF2YWlsXG4gICAgfVxuICAgIGxldCBbcXVvdGVGZWVBdmFpbCwgZGV4UXVvdGVGZWVBdmFpbCwgY2V4UXVvdGVGZWVBdmFpbF0gPSBbcXVvdGVBdmFpbCwgZGV4UXVvdGVBdmFpbCwgY2V4UXVvdGVBdmFpbF1cbiAgICBpZiAocXVvdGVGZWVJRCAhPT0gcXVvdGVJRCkge1xuICAgICAgY29uc3QgcUZlZUludiA9IHJ1bm5pbmdCb3RJbnZlbnRvcnkocXVvdGVJRClcbiAgICAgIGRleFF1b3RlRmVlQXZhaWwgPSBxdW90ZUZlZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSAtIHFGZWVJbnYuZGV4LnRvdGFsXG4gICAgICBjZXhRdW90ZUZlZUF2YWlsID0gKGNleFF1b3RlQmFsYW5jZT8uYXZhaWxhYmxlIHx8IDApIC0gcUZlZUludi5jZXgudG90YWxcbiAgICAgIHF1b3RlRmVlQXZhaWwgPSBkZXhRdW90ZUZlZUF2YWlsICsgY2V4UXVvdGVGZWVBdmFpbFxuICAgIH1cbiAgICByZXR1cm4geyAvLyBjb252ZXJ0IHRvIGNvbnZlbnRpb2FubC5cbiAgICAgIGJhc2VBdmFpbDogYmFzZUF2YWlsIC8gYmFzZUZhY3RvcixcbiAgICAgIHF1b3RlQXZhaWw6IHF1b3RlQXZhaWwgLyBxdW90ZUZhY3RvcixcbiAgICAgIGRleEJhc2VBdmFpbDogZGV4QmFzZUF2YWlsIC8gYmFzZUZhY3RvcixcbiAgICAgIGRleFF1b3RlQXZhaWw6IGRleFF1b3RlQXZhaWwgLyBxdW90ZUZhY3RvcixcbiAgICAgIGNleEJhc2VBdmFpbDogY2V4QmFzZUF2YWlsIC8gYmFzZUZhY3RvcixcbiAgICAgIGNleFF1b3RlQXZhaWw6IGNleFF1b3RlQXZhaWwgLyBxdW90ZUZhY3RvcixcbiAgICAgIGJhc2VGZWVBdmFpbDogYmFzZUZlZUF2YWlsIC8gYmFzZUZlZUZhY3RvcixcbiAgICAgIHF1b3RlRmVlQXZhaWw6IHF1b3RlRmVlQXZhaWwgLyBxdW90ZUZlZUZhY3RvcixcbiAgICAgIGRleEJhc2VGZWVBdmFpbDogZGV4QmFzZUZlZUF2YWlsIC8gYmFzZUZlZUZhY3RvcixcbiAgICAgIGRleFF1b3RlRmVlQXZhaWw6IGRleFF1b3RlRmVlQXZhaWwgLyBxdW90ZUZlZUZhY3RvcixcbiAgICAgIGNleEJhc2VGZWVBdmFpbDogY2V4QmFzZUZlZUF2YWlsIC8gYmFzZUZlZUZhY3RvcixcbiAgICAgIGNleFF1b3RlRmVlQXZhaWw6IGNleFF1b3RlRmVlQXZhaWwgLyBxdW90ZUZlZUZhY3RvclxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGZlZXNBbmRDb21taXQgZ2VuZXJhdGVzIGEgc25hcHNob3Qgb2YgY3VycmVudCBtYXJrZXQgZmVlcywgYXMgd2VsbCBhcyBhXG4gICAqIFwiY29tbWl0XCIsIHdoaWNoIGlzIHRoZSBmdW5kaW5nIGRlZGljYXRlZCB0byBiZWluZyBvbiBvcmRlci4gVGhlIGNvbW1pdFxuICAgKiB2YWx1ZXMgZG8gbm90IGluY2x1ZGUgYm9va2luZyBmZWVzLCBvcmRlciByZXNlcnZlcywgZXRjLiBqdXN0IHRoZSBvcmRlclxuICAgKiBxdWFudGl0eS5cbiAgICovXG4gIGZlZXNBbmRDb21taXQgKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGJhc2VJRCwgcXVvdGVJRCwgbWFya2V0UmVwb3J0OiB7IGJhc2VGZWVzLCBxdW90ZUZlZXMgfSwgbG90U2l6ZSxcbiAgICAgIGJhc2VMb3RzLCBxdW90ZUxvdHMsIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCwgYmFzZUlzQWNjb3VudExvY2tlciwgcXVvdGVJc0FjY291bnRMb2NrZXIsXG4gICAgICBjZmc6IHsgdWlDb25maWc6IHsgYmFzZUNvbmZpZywgcXVvdGVDb25maWcgfSB9XG4gICAgfSA9IHRoaXNcblxuICAgIHJldHVybiBmZWVzQW5kQ29tbWl0KFxuICAgICAgYmFzZUlELCBxdW90ZUlELCBiYXNlRmVlcywgcXVvdGVGZWVzLCBsb3RTaXplLCBiYXNlTG90cywgcXVvdGVMb3RzLFxuICAgICAgYmFzZUZlZUlELCBxdW90ZUZlZUlELCBiYXNlSXNBY2NvdW50TG9ja2VyLCBxdW90ZUlzQWNjb3VudExvY2tlcixcbiAgICAgIGJhc2VDb25maWcub3JkZXJSZXNlcnZlc0ZhY3RvciwgcXVvdGVDb25maWcub3JkZXJSZXNlcnZlc0ZhY3RvclxuICAgIClcbiAgfVxuXG4gIC8qXG4gICAqIHByb2plY3RlZEFsbG9jYXRpb25zIGNhbGN1bGF0ZXMgdGhlIHJlcXVpcmVkIGFzc2V0IGFsbG9jYXRpb25zIGZyb20gdGhlXG4gICAqIHVzZXIncyBjb25maWd1cmF0aW9uIHNldHRpbmdzIGFuZCB0aGUgY3VycmVudCBtYXJrZXQgc3RhdGUuXG4gICAqL1xuICBwcm9qZWN0ZWRBbGxvY2F0aW9ucyAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY2ZnOiB7IHVpQ29uZmlnOiB7IHF1b3RlQ29uZmlnLCBiYXNlQ29uZmlnIH0gfSxcbiAgICAgIGJhc2VGYWN0b3IsIHF1b3RlRmFjdG9yLCBiYXNlSUQsIHF1b3RlSUQsIGxvdFNpemVDb252LCBxdW90ZUxvdENvbnYsXG4gICAgICBiYXNlRmVlRmFjdG9yLCBxdW90ZUZlZUZhY3RvciwgYmFzZUZlZUlELCBxdW90ZUZlZUlELCBiYXNlVG9rZW4sXG4gICAgICBxdW90ZVRva2VuLCBjZXhOYW1lXG4gICAgfSA9IHRoaXNcbiAgICBjb25zdCB7IGNvbW1pdCwgZmVlcyB9ID0gdGhpcy5mZWVzQW5kQ29tbWl0KClcblxuICAgIGNvbnN0IGJQcm9qID0gZW1wdHlQcm9qZWN0aW9uKClcbiAgICBjb25zdCBxUHJvaiA9IGVtcHR5UHJvamVjdGlvbigpXG5cbiAgICBiUHJvai5ib29rID0gY29tbWl0LmRleC5iYXNlLmxvdHMgKiBsb3RTaXplQ29udlxuICAgIHFQcm9qLmJvb2sgPSBjb21taXQuY2V4LmJhc2UubG90cyAqIHF1b3RlTG90Q29udlxuXG4gICAgYlByb2oub3JkZXJSZXNlcnZlcyA9IE1hdGgubWF4KGNvbW1pdC5jZXguYmFzZS52YWwsIGNvbW1pdC5kZXguYmFzZS52YWwpICogYmFzZUNvbmZpZy5vcmRlclJlc2VydmVzRmFjdG9yIC8gYmFzZUZhY3RvclxuICAgIHFQcm9qLm9yZGVyUmVzZXJ2ZXMgPSBNYXRoLm1heChjb21taXQuY2V4LnF1b3RlLnZhbCwgY29tbWl0LmRleC5xdW90ZS52YWwpICogcXVvdGVDb25maWcub3JkZXJSZXNlcnZlc0ZhY3RvciAvIHF1b3RlRmFjdG9yXG5cbiAgICBpZiAoY2V4TmFtZSkge1xuICAgICAgYlByb2ouY2V4ID0gY29tbWl0LmNleC5iYXNlLmxvdHMgKiBsb3RTaXplQ29udlxuICAgICAgcVByb2ouY2V4ID0gY29tbWl0LmNleC5xdW90ZS5sb3RzICogcXVvdGVMb3RDb252XG4gICAgfVxuXG4gICAgYlByb2ouYm9va2luZ0ZlZXMgPSBmZWVzLmJhc2UuYm9va2luZ0ZlZXMgLyBiYXNlRmVlRmFjdG9yXG4gICAgcVByb2ouYm9va2luZ0ZlZXMgPSBmZWVzLnF1b3RlLmJvb2tpbmdGZWVzIC8gcXVvdGVGZWVGYWN0b3JcblxuICAgIGlmIChiYXNlVG9rZW4pIGJQcm9qLnN3YXBGZWVSZXNlcnZlcyA9IGZlZXMuYmFzZS50b2tlbkZlZXNQZXJTd2FwICogYmFzZUNvbmZpZy5zd2FwRmVlTiAvIGJhc2VGZWVGYWN0b3JcbiAgICBpZiAocXVvdGVUb2tlbikgcVByb2ouc3dhcEZlZVJlc2VydmVzID0gZmVlcy5xdW90ZS50b2tlbkZlZXNQZXJTd2FwICogcXVvdGVDb25maWcuc3dhcEZlZU4gLyBxdW90ZUZlZUZhY3RvclxuICAgIHFQcm9qLnNsaXBwYWdlQnVmZmVyID0gKHFQcm9qLmJvb2sgKyBxUHJvai5jZXggKyBxUHJvai5vcmRlclJlc2VydmVzKSAqIHF1b3RlQ29uZmlnLnNsaXBwYWdlQnVmZmVyRmFjdG9yXG5cbiAgICBjb25zdCBhbGxvYzogUmVjb3JkPG51bWJlciwgbnVtYmVyPiA9IHt9XG4gICAgY29uc3QgYWRkQWxsb2MgPSAoYXNzZXRJRDogbnVtYmVyLCBhbXQ6IG51bWJlcikgPT4geyBhbGxvY1thc3NldElEXSA9IChhbGxvY1thc3NldElEXSA/PyAwKSArIGFtdCB9XG4gICAgYWRkQWxsb2MoYmFzZUlELCBNYXRoLnJvdW5kKChiUHJvai5ib29rICsgYlByb2ouY2V4ICsgYlByb2oub3JkZXJSZXNlcnZlcykgKiBiYXNlRmFjdG9yKSlcbiAgICBhZGRBbGxvYyhiYXNlRmVlSUQsIE1hdGgucm91bmQoKGJQcm9qLmJvb2tpbmdGZWVzICsgYlByb2ouc3dhcEZlZVJlc2VydmVzKSAqIGJhc2VGZWVGYWN0b3IpKVxuICAgIGFkZEFsbG9jKHF1b3RlSUQsIE1hdGgucm91bmQoKHFQcm9qLmJvb2sgKyBxUHJvai5jZXggKyBxUHJvai5vcmRlclJlc2VydmVzICsgcVByb2ouc2xpcHBhZ2VCdWZmZXIpICogcXVvdGVGYWN0b3IpKVxuICAgIGFkZEFsbG9jKHF1b3RlRmVlSUQsIE1hdGgucm91bmQoKHFQcm9qLmJvb2tpbmdGZWVzICsgcVByb2ouc3dhcEZlZVJlc2VydmVzKSAqIHF1b3RlRmVlRmFjdG9yKSlcblxuICAgIHJldHVybiB7IHFQcm9qLCBiUHJvaiwgYWxsb2MgfVxuICB9XG5cbiAgLypcbiAgICogZnVuZGluZ1N0YXRlIGV4YW1pbmVzIHRoZSBwcm9qZWN0ZWQgYWxsb2NhdGlvbnMgYW5kIHRoZSB1c2VyJ3Mgd2FsbGV0XG4gICAqIGJhbGFuY2VzIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSB1c2VyIGNhbiBmdW5kIHRoZSBib3QgZnVsbHksIHVuYmFsYW5jZWQsXG4gICAqIG9yIHN0YXJ2ZWQsIGFuZCB3aGF0IGZ1bmRpbmcgc291cmNlIG9wdGlvbnMgbWlnaHQgYmUgYXZhaWxhYmxlLlxuICAgKi9cbiAgZnVuZGluZ1N0YXRlICgpIHtcbiAgICBjb25zdCB7XG4gICAgICBwcm9qOiB7IGJQcm9qLCBxUHJvaiB9LCBiYXNlSUQsIHF1b3RlSUQsIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCxcbiAgICAgIGNmZzogeyB1aUNvbmZpZzogeyBjZXhSZWJhbGFuY2UgfSB9LCBjZXhOYW1lXG4gICAgfSA9IHRoaXNcbiAgICBjb25zdCB7XG4gICAgICBiYXNlQXZhaWwsIHF1b3RlQXZhaWwsIGRleEJhc2VBdmFpbCwgZGV4UXVvdGVBdmFpbCwgY2V4QmFzZUF2YWlsLCBjZXhRdW90ZUF2YWlsLFxuICAgICAgZGV4QmFzZUZlZUF2YWlsLCBkZXhRdW90ZUZlZUF2YWlsXG4gICAgfSA9IHRoaXMuYWRqdXN0ZWRCYWxhbmNlcygpXG5cbiAgICBjb25zdCBjYW5SZWJhbGFuY2UgPSBCb29sZWFuKGNleE5hbWUgJiYgY2V4UmViYWxhbmNlKVxuXG4gICAgLy8gVGhyZWUgcG9zc2libGUgc3RhdGVzLlxuICAgIC8vIDEuIFdlIGhhdmUgdGhlIGZ1bmRpbmcgaW4gdGhlIHByb2plY3Rpb24sIGFuZCBpdHMgaW4gdGhlIHJpZ2h0IHBsYWNlcy5cbiAgICAvLyAgICBHaXZlIHRoZW0gc29tZSBvcHRpb25zIGZvciB3aGljaCB3YWxsZXQgdG8gcHVsbCBvcmRlciByZXNlcnZlcyBmcm9tLFxuICAgIC8vICAgIGJ1dCB0aGV5IGNhbiBzdGFydCBpbW1lZGlhdGVseS4uXG4gICAgLy8gMi4gV2UgaGF2ZSB0aGUgZnVuZGluZywgYnV0IGl0J3MgaW4gdGhlIHdyb25nIHBsYWNlIG9yIHRoZSB3cm9uZyBhc3NldCxcbiAgICAvLyAgICBidXQgd2UgaGF2ZSBkZXBvc2l0cyBhbmQgd2l0aGRyYXdzIGVuYWJsZWQuIFdlIGNhbiBvZmZlciB0aGVtIHRoZVxuICAgIC8vICAgIG9wdGlvbiB0byBzdGFydCBpbiBhbiB1bmJhbGFuY2VkIHN0YXRlLlxuICAgIC8vIDMuIFdlIGRvbid0IGhhdmUgdGhlIGZ1bmRzLiBXZSBvZmZlciB0aGVtIGFuIG9wdGlvbiB0byBzdGFydCBpbiBhXG4gICAgLy8gICAgc3RhcnZlZCBzdGF0ZS5cbiAgICBjb25zdCBjZXhNaW5CYXNlQWxsb2MgPSBiUHJvai5jZXhcbiAgICBsZXQgW2RleE1pbkJhc2VBbGxvYywgdHJhbnNmZXJhYmxlQmFzZUFsbG9jLCBkZXhCYXNlRmVlUmVxXSA9IFtiUHJvai5ib29rLCAwLCAwXVxuICAgIC8vIE9ubHkgYWRkIGJvb2tpbmcgZmVlcyBpZiB0aGlzIGlzIHRoZSBmZWUgYXNzZXQuXG4gICAgaWYgKGJhc2VJRCA9PT0gYmFzZUZlZUlEKSBkZXhNaW5CYXNlQWxsb2MgKz0gYlByb2ouYm9va2luZ0ZlZXNcbiAgICAvLyBCYXNlIGFzc2V0IGlzIGEgdG9rZW4uXG4gICAgZWxzZSBkZXhCYXNlRmVlUmVxICs9IGJQcm9qLmJvb2tpbmdGZWVzICsgYlByb2ouc3dhcEZlZVJlc2VydmVzXG4gICAgLy8gSWYgd2UgY2FuIHJlYmFsYW5jZSwgdGhlIG9yZGVyIHJlc2VydmVzIGNvdWxkIHBvdGVudGlhbGx5IGJlIHdpdGhkcmF3bi5cbiAgICBpZiAoY2FuUmViYWxhbmNlKSB0cmFuc2ZlcmFibGVCYXNlQWxsb2MgKz0gYlByb2oub3JkZXJSZXNlcnZlc1xuICAgIC8vIElmIHdlIGNhbid0IHJlYmFsYW5jZSwgb3JkZXIgcmVzZXJ2ZXMgYXJlIHJlcXVpcmVkIGluIGRleCBiYWxhbmNlLlxuICAgIGVsc2UgZGV4TWluQmFzZUFsbG9jICs9IGJQcm9qLm9yZGVyUmVzZXJ2ZXNcbiAgICAvLyBIYW5kbGUgdGhlIHNwZWNpYWwgY2FzZSB3aGVyZSB0aGUgYmFzZSBhc3NldCBpdCB0aGUgcXVvdGUgYXNzZXQncyBmZWVcbiAgICAvLyBhc3NldC5cbiAgICBpZiAoYmFzZUlEID09PSBxdW90ZUZlZUlEKSB7XG4gICAgICBpZiAoY2FuUmViYWxhbmNlKSB0cmFuc2ZlcmFibGVCYXNlQWxsb2MgKz0gcVByb2ouYm9va2luZ0ZlZXMgKyBxUHJvai5zd2FwRmVlUmVzZXJ2ZXNcbiAgICAgIGVsc2UgZGV4TWluQmFzZUFsbG9jICs9IHFQcm9qLmJvb2tpbmdGZWVzICsgcVByb2ouc3dhcEZlZVJlc2VydmVzXG4gICAgfVxuXG4gICAgbGV0IFtkZXhNaW5RdW90ZUFsbG9jLCBjZXhNaW5RdW90ZUFsbG9jLCB0cmFuc2ZlcmFibGVRdW90ZUFsbG9jLCBkZXhRdW90ZUZlZVJlcV0gPSBbcVByb2ouYm9vaywgcVByb2ouY2V4LCAwLCAwXVxuICAgIGlmIChxdW90ZUlEID09PSBxdW90ZUZlZUlEKSBkZXhNaW5RdW90ZUFsbG9jICs9IHFQcm9qLmJvb2tpbmdGZWVzXG4gICAgZWxzZSBkZXhRdW90ZUZlZVJlcSArPSBxUHJvai5ib29raW5nRmVlcyArIHFQcm9qLnN3YXBGZWVSZXNlcnZlc1xuICAgIGlmIChjYW5SZWJhbGFuY2UpIHRyYW5zZmVyYWJsZVF1b3RlQWxsb2MgKz0gcVByb2oub3JkZXJSZXNlcnZlcyArIHFQcm9qLnNsaXBwYWdlQnVmZmVyXG4gICAgZWxzZSB7XG4gICAgICAvLyBUaGUgc2xpcHBhZ2UgcmVzZXJ2ZXMgcmVzZXJ2ZXMgc2hvdWxkIGJlIHNwbGl0IGJldHdlZW4gY2V4IGFuZCBkZXguXG4gICAgICBkZXhNaW5RdW90ZUFsbG9jICs9IHFQcm9qLm9yZGVyUmVzZXJ2ZXNcbiAgICAgIGNvbnN0IGJhc2lzID0gcVByb2ouYm9vayArIHFQcm9qLmNleCArIHFQcm9qLm9yZGVyUmVzZXJ2ZXNcbiAgICAgIGRleE1pblF1b3RlQWxsb2MgKz0gKHFQcm9qLmJvb2sgKyBxUHJvai5vcmRlclJlc2VydmVzKSAvIGJhc2lzICogcVByb2ouc2xpcHBhZ2VCdWZmZXJcbiAgICAgIGNleE1pblF1b3RlQWxsb2MgKz0gcVByb2ouY2V4IC8gYmFzaXMgKiBxUHJvai5zbGlwcGFnZUJ1ZmZlclxuICAgIH1cbiAgICBpZiAocXVvdGVJRCA9PT0gYmFzZUZlZUlEKSB7XG4gICAgICBpZiAoY2FuUmViYWxhbmNlKSB0cmFuc2ZlcmFibGVRdW90ZUFsbG9jICs9IGJQcm9qLmJvb2tpbmdGZWVzICsgYlByb2ouc3dhcEZlZVJlc2VydmVzXG4gICAgICBlbHNlIGRleE1pblF1b3RlQWxsb2MgKz0gYlByb2ouYm9va2luZ0ZlZXMgKyBiUHJvai5zd2FwRmVlUmVzZXJ2ZXNcbiAgICB9XG5cbiAgICBjb25zdCBkZXhCYXNlRnVuZGVkID0gZGV4QmFzZUF2YWlsID49IGRleE1pbkJhc2VBbGxvY1xuICAgIGNvbnN0IGNleEJhc2VGdW5kZWQgPSBjZXhCYXNlQXZhaWwgPj0gY2V4TWluQmFzZUFsbG9jXG4gICAgY29uc3QgZGV4UXVvdGVGdW5kZWQgPSBkZXhRdW90ZUF2YWlsID49IGRleE1pblF1b3RlQWxsb2NcbiAgICBjb25zdCBjZXhRdW90ZUZ1bmRlZCA9IGNleFF1b3RlQXZhaWwgPj0gY2V4TWluUXVvdGVBbGxvY1xuICAgIGNvbnN0IHRvdGFsQmFzZVJlcSA9IGRleE1pbkJhc2VBbGxvYyArIGNleE1pbkJhc2VBbGxvYyArIHRyYW5zZmVyYWJsZUJhc2VBbGxvY1xuICAgIGNvbnN0IHRvdGFsUXVvdGVSZXEgPSBkZXhNaW5RdW90ZUFsbG9jICsgY2V4TWluUXVvdGVBbGxvYyArIHRyYW5zZmVyYWJsZVF1b3RlQWxsb2NcbiAgICBjb25zdCBiYXNlRnVuZGVkQW5kQmFsYW5jZWQgPSBkZXhCYXNlRnVuZGVkICYmIGNleEJhc2VGdW5kZWQgJiYgYmFzZUF2YWlsID49IHRvdGFsQmFzZVJlcVxuICAgIGNvbnN0IHF1b3RlRnVuZGVkQW5kQmFsYW5jZWQgPSBkZXhRdW90ZUZ1bmRlZCAmJiBjZXhRdW90ZUZ1bmRlZCAmJiBxdW90ZUF2YWlsID49IHRvdGFsUXVvdGVSZXFcbiAgICBjb25zdCBiYXNlRmVlc0Z1bmRlZCA9IGRleEJhc2VGZWVBdmFpbCA+PSBkZXhCYXNlRmVlUmVxXG4gICAgY29uc3QgcXVvdGVGZWVzRnVuZGVkID0gZGV4UXVvdGVGZWVBdmFpbCA+PSBkZXhRdW90ZUZlZVJlcVxuXG4gICAgY29uc3QgZnVuZGVkQW5kQmFsYW5jZWQgPSBiYXNlRnVuZGVkQW5kQmFsYW5jZWQgJiYgcXVvdGVGdW5kZWRBbmRCYWxhbmNlZCAmJiBiYXNlRmVlc0Z1bmRlZCAmJiBxdW90ZUZlZXNGdW5kZWRcblxuICAgIC8vIEFyZSB3ZSBmdW5kZWQgYnV0IG5vdCBiYWxhbmNlZCwgYnV0IGFibGUgdG8gcmViYWxhbmNlIHdpdGggYSBjZXg/XG4gICAgbGV0IGZ1bmRlZEFuZE5vdEJhbGFuY2VkID0gIWZ1bmRlZEFuZEJhbGFuY2VkXG4gICAgaWYgKCFmdW5kZWRBbmRCYWxhbmNlZCkge1xuICAgICAgY29uc3Qgb3JkZXJzRnVuZGVkID0gYmFzZUF2YWlsID49IHRvdGFsQmFzZVJlcSAmJiBxdW90ZUF2YWlsID49IHRvdGFsUXVvdGVSZXFcbiAgICAgIGNvbnN0IGZlZXNGdW5kZWQgPSBiYXNlRmVlc0Z1bmRlZCAmJiBxdW90ZUZlZXNGdW5kZWRcbiAgICAgIGZ1bmRlZEFuZE5vdEJhbGFuY2VkID0gb3JkZXJzRnVuZGVkICYmIGZlZXNGdW5kZWQgJiYgY2FuUmViYWxhbmNlXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGJhc2U6IHtcbiAgICAgICAgZGV4OiB7XG4gICAgICAgICAgYXZhaWw6IGRleEJhc2VBdmFpbCxcbiAgICAgICAgICByZXE6IGRleE1pbkJhc2VBbGxvYyxcbiAgICAgICAgICBmdW5kZWQ6IGRleEJhc2VGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgY2V4OiB7XG4gICAgICAgICAgYXZhaWw6IGNleEJhc2VBdmFpbCxcbiAgICAgICAgICByZXE6IGNleE1pbkJhc2VBbGxvYyxcbiAgICAgICAgICBmdW5kZWQ6IGNleEJhc2VGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmZXJhYmxlOiB0cmFuc2ZlcmFibGVCYXNlQWxsb2MsXG4gICAgICAgIGZlZXM6IHtcbiAgICAgICAgICBhdmFpbDogZGV4QmFzZUZlZUF2YWlsLFxuICAgICAgICAgIHJlcTogZGV4QmFzZUZlZVJlcSxcbiAgICAgICAgICBmdW5kZWQ6IGJhc2VGZWVzRnVuZGVkXG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmRlZEFuZEJhbGFuY2VkOiBiYXNlRnVuZGVkQW5kQmFsYW5jZWQsXG4gICAgICAgIGZ1bmRlZEFuZE5vdEJhbGFuY2VkOiAhYmFzZUZ1bmRlZEFuZEJhbGFuY2VkICYmIGJhc2VBdmFpbCA+PSB0b3RhbEJhc2VSZXEgJiYgY2FuUmViYWxhbmNlXG4gICAgICB9LFxuICAgICAgcXVvdGU6IHtcbiAgICAgICAgZGV4OiB7XG4gICAgICAgICAgYXZhaWw6IGRleFF1b3RlQXZhaWwsXG4gICAgICAgICAgcmVxOiBkZXhNaW5RdW90ZUFsbG9jLFxuICAgICAgICAgIGZ1bmRlZDogZGV4UXVvdGVGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgY2V4OiB7XG4gICAgICAgICAgYXZhaWw6IGNleFF1b3RlQXZhaWwsXG4gICAgICAgICAgcmVxOiBjZXhNaW5RdW90ZUFsbG9jLFxuICAgICAgICAgIGZ1bmRlZDogY2V4UXVvdGVGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmZXJhYmxlOiB0cmFuc2ZlcmFibGVRdW90ZUFsbG9jLFxuICAgICAgICBmZWVzOiB7XG4gICAgICAgICAgYXZhaWw6IGRleFF1b3RlRmVlQXZhaWwsXG4gICAgICAgICAgcmVxOiBkZXhRdW90ZUZlZVJlcSxcbiAgICAgICAgICBmdW5kZWQ6IHF1b3RlRmVlc0Z1bmRlZFxuICAgICAgICB9LFxuICAgICAgICBmdW5kZWRBbmRCYWxhbmNlZDogcXVvdGVGdW5kZWRBbmRCYWxhbmNlZCxcbiAgICAgICAgZnVuZGVkQW5kTm90QmFsYW5jZWQ6ICFxdW90ZUZ1bmRlZEFuZEJhbGFuY2VkICYmIHF1b3RlQXZhaWwgPj0gdG90YWxRdW90ZVJlcSAmJiBjYW5SZWJhbGFuY2VcbiAgICAgIH0sXG4gICAgICBmdW5kZWRBbmRCYWxhbmNlZCxcbiAgICAgIGZ1bmRlZEFuZE5vdEJhbGFuY2VkLFxuICAgICAgc3RhcnZlZDogIWZ1bmRlZEFuZEJhbGFuY2VkICYmICFmdW5kZWRBbmROb3RCYWxhbmNlZFxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUnVubmluZ01hcmtldE1ha2VyRGlzcGxheSB7XG4gIGRpdjogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIG1rdDogQm90TWFya2V0XG4gIHN0YXJ0VGltZTogbnVtYmVyXG4gIHRpY2tlcjogYW55XG4gIGN1cnJlbnRGb3JtOiBQYWdlRWxlbWVudFxuICBmb3JtczogRm9ybXNcbiAgbGF0ZXN0RXBvY2g/OiBFcG9jaFJlcG9ydFxuICBjZXhQcm9ibGVtcz86IENFWFByb2JsZW1zXG4gIG9yZGVyUmVwb3J0Rm9ybUVsOiBQYWdlRWxlbWVudFxuICBvcmRlclJlcG9ydEZvcm06IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBkZXhCYWxhbmNlc1Jvd1RtcGw6IFBhZ2VFbGVtZW50XG4gIHBsYWNlbWVudFJvd1RtcGw6IFBhZ2VFbGVtZW50XG4gIHBsYWNlbWVudEFtdFJvd1RtcGw6IFBhZ2VFbGVtZW50XG4gIGRpc3BsYXllZFNpZGU6ICdidXlzJyB8ICdzZWxscydcblxuICBjb25zdHJ1Y3RvciAoZGl2OiBQYWdlRWxlbWVudCwgZm9ybXM6IEZvcm1zLCBvcmRlclJlcG9ydEZvcm06IFBhZ2VFbGVtZW50LCBwYWdlOiBzdHJpbmcpIHtcbiAgICB0aGlzLmRpdiA9IGRpdlxuICAgIHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICB0aGlzLm9yZGVyUmVwb3J0Rm9ybUVsID0gb3JkZXJSZXBvcnRGb3JtXG4gICAgdGhpcy5vcmRlclJlcG9ydEZvcm0gPSBEb2MuaWREZXNjZW5kYW50cyhvcmRlclJlcG9ydEZvcm0pXG4gICAgdGhpcy5kZXhCYWxhbmNlc1Jvd1RtcGwgPSB0aGlzLm9yZGVyUmVwb3J0Rm9ybS5kZXhCYWxhbmNlc1Jvd1RtcGxcbiAgICB0aGlzLnBsYWNlbWVudFJvd1RtcGwgPSB0aGlzLm9yZGVyUmVwb3J0Rm9ybS5wbGFjZW1lbnRSb3dUbXBsXG4gICAgdGhpcy5wbGFjZW1lbnRBbXRSb3dUbXBsID0gdGhpcy5vcmRlclJlcG9ydEZvcm0ucGxhY2VtZW50QW10Um93VG1wbFxuICAgIERvYy5jbGVhblRlbXBsYXRlcyh0aGlzLmRleEJhbGFuY2VzUm93VG1wbCwgdGhpcy5wbGFjZW1lbnRSb3dUbXBsLCB0aGlzLnBsYWNlbWVudEFtdFJvd1RtcGwpXG4gICAgdGhpcy5mb3JtcyA9IGZvcm1zXG4gICAgRG9jLmJpbmQodGhpcy5wYWdlLnN0b3BCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLnN0b3AoKSlcbiAgICBEb2MuYmluZCh0aGlzLnBhZ2UucnVuTG9nc0J0dG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgbWt0OiB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCB9LCBzdGFydFRpbWUgfSA9IHRoaXNcbiAgICAgIGFwcCgpLmxvYWRQYWdlKCdtbWxvZ3MnLCB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCwgc3RhcnRUaW1lLCByZXR1cm5QYWdlOiBwYWdlIH0pXG4gICAgfSlcbiAgICBEb2MuYmluZCh0aGlzLnBhZ2UuYnV5T3JkZXJzQnR0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93T3JkZXJSZXBvcnQoJ2J1eXMnKSlcbiAgICBEb2MuYmluZCh0aGlzLnBhZ2Uuc2VsbE9yZGVyc0J0dG4sICdjbGljaycsICgpID0+IHRoaXMuc2hvd09yZGVyUmVwb3J0KCdzZWxscycpKVxuICB9XG5cbiAgYXN5bmMgc3RvcCAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBta3Q6IHsgaG9zdCwgYmFzZUlELCBxdW90ZUlEIH0gfSA9IHRoaXNcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2Uuc3RvcEJ0dG4pXG4gICAgYXdhaXQgTU0uc3RvcEJvdCh7IGhvc3QsIGJhc2VJRDogYmFzZUlELCBxdW90ZUlEOiBxdW90ZUlEIH0pXG4gICAgbG9hZGVkKClcbiAgfVxuXG4gIGFzeW5jIHNldE1hcmtldCAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgYm90U3RhdHVzID0gYXBwKCkubW1TdGF0dXMuYm90cy5maW5kKCh7IGNvbmZpZzogYyB9OiBNTUJvdFN0YXR1cykgPT4gYy5iYXNlSUQgPT09IGJhc2VJRCAmJiBjLnF1b3RlSUQgPT09IHF1b3RlSUQgJiYgYy5ob3N0ID09PSBob3N0KVxuICAgIGlmICghYm90U3RhdHVzKSByZXR1cm5cbiAgICBjb25zdCBta3QgPSBuZXcgQm90TWFya2V0KGJvdFN0YXR1cy5jb25maWcpXG4gICAgYXdhaXQgbWt0LmluaXRpYWxpemUoe30pXG4gICAgdGhpcy5zZXRCb3RNYXJrZXQobWt0KVxuICB9XG5cbiAgYXN5bmMgc2V0Qm90TWFya2V0IChta3Q6IEJvdE1hcmtldCkge1xuICAgIHRoaXMubWt0ID0gbWt0XG4gICAgY29uc3Qge1xuICAgICAgcGFnZSwgZGl2LCBta3Q6IHtcbiAgICAgICAgaG9zdCwgYmFzZUlELCBxdW90ZUlELCBiYXNlRmVlSUQsIHF1b3RlRmVlSUQsIGNleE5hbWUsIGJhc2VGZWVTeW1ib2wsXG4gICAgICAgIHF1b3RlRmVlU3ltYm9sLCBiYXNlRmVlVGlja2VyLCBxdW90ZUZlZVRpY2tlciwgY2ZnLCBiYXNlRmFjdG9yLCBxdW90ZUZhY3RvclxuICAgICAgfVxuICAgIH0gPSB0aGlzXG4gICAgc2V0TWFya2V0RWxlbWVudHMoZGl2LCBiYXNlSUQsIHF1b3RlSUQsIGhvc3QpXG4gICAgRG9jLnNldFZpcyhiYXNlRmVlSUQgIT09IGJhc2VJRCwgcGFnZS5iYXNlRmVlUmVzZXJ2ZXNCb3gpXG4gICAgRG9jLnNldFZpcyhxdW90ZUZlZUlEICE9PSBxdW90ZUlELCBwYWdlLnF1b3RlRmVlUmVzZXJ2ZXNCb3gpXG4gICAgRG9jLnNldFZpcyhCb29sZWFuKGNleE5hbWUpLCAuLi5Eb2MuYXBwbHlTZWxlY3RvcihkaXYsICdbZGF0YS1jZXgtc2hvd10nKSlcbiAgICBwYWdlLmJhc2VGZWVMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChiYXNlRmVlU3ltYm9sKVxuICAgIHBhZ2UuYmFzZUZlZVRpY2tlci50ZXh0Q29udGVudCA9IGJhc2VGZWVUaWNrZXJcbiAgICBwYWdlLnF1b3RlRmVlTG9nby5zcmMgPSBEb2MubG9nb1BhdGgocXVvdGVGZWVTeW1ib2wpXG4gICAgcGFnZS5xdW90ZUZlZVRpY2tlci50ZXh0Q29udGVudCA9IHF1b3RlRmVlVGlja2VyXG5cbiAgICBjb25zdCBiYXNpY0NmZyA9IGNmZy5iYXNpY01hcmtldE1ha2luZ0NvbmZpZ1xuICAgIGNvbnN0IGdhcFN0cmF0ZWd5ID0gYmFzaWNDZmc/LmdhcFN0cmF0ZWd5ID8/IEdhcFN0cmF0ZWd5UGVyY2VudFxuICAgIGxldCBnYXBGYWN0b3IgPSBjZmcuYXJiTWFya2V0TWFraW5nQ29uZmlnPy5wcm9maXQgPz8gY2ZnLnNpbXBsZUFyYkNvbmZpZz8ucHJvZml0VHJpZ2dlciA/PyAwXG4gICAgaWYgKGJhc2ljQ2ZnKSB7XG4gICAgICBjb25zdCBidXlzID0gWy4uLmJhc2ljQ2ZnLmJ1eVBsYWNlbWVudHNdLnNvcnQoKGE6IE9yZGVyUGxhY2VtZW50LCBiOiBPcmRlclBsYWNlbWVudCkgPT4gYS5nYXBGYWN0b3IgLSBiLmdhcEZhY3RvcilcbiAgICAgIGNvbnN0IHNlbGxzID0gWy4uLmJhc2ljQ2ZnLnNlbGxQbGFjZW1lbnRzXS5zb3J0KChhOiBPcmRlclBsYWNlbWVudCwgYjogT3JkZXJQbGFjZW1lbnQpID0+IGEuZ2FwRmFjdG9yIC0gYi5nYXBGYWN0b3IpXG4gICAgICBpZiAoYnV5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGlmIChzZWxscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZ2FwRmFjdG9yID0gKGJ1eXNbMF0uZ2FwRmFjdG9yICsgc2VsbHNbMF0uZ2FwRmFjdG9yKSAvIDJcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBnYXBGYWN0b3IgPSBidXlzWzBdLmdhcEZhY3RvclxuICAgICAgICB9XG4gICAgICB9IGVsc2UgZ2FwRmFjdG9yID0gc2VsbHNbMF0uZ2FwRmFjdG9yXG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2UucHJvZml0TGFiZWwsIHBhZ2UuZ2FwTGFiZWwsIHBhZ2UubXVsdGlwbGllckxhYmVsLCBwYWdlLnByb2ZpdFVuaXQsIHBhZ2UuZ2FwVW5pdCwgcGFnZS5tdWx0aXBsaWVyVW5pdClcbiAgICBzd2l0Y2ggKGdhcFN0cmF0ZWd5KSB7XG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5UGVyY2VudDpcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lQZXJjZW50UGx1czpcbiAgICAgICAgRG9jLnNob3cocGFnZS5wcm9maXRMYWJlbCwgcGFnZS5wcm9maXRVbml0KVxuICAgICAgICBwYWdlLmdhcEZhY3Rvci50ZXh0Q29udGVudCA9IChnYXBGYWN0b3IgKiAxMDApLnRvRml4ZWQoMilcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lNdWx0aXBsaWVyOlxuICAgICAgICBEb2Muc2hvdyhwYWdlLm11bHRpcGxpZXJMYWJlbCwgcGFnZS5tdWx0aXBsaWVyVW5pdClcbiAgICAgICAgcGFnZS5nYXBGYWN0b3IudGV4dENvbnRlbnQgPSAoZ2FwRmFjdG9yICogMTAwKS50b0ZpeGVkKDIpXG4gICAgICAgIGJyZWFrXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBwYWdlLmdhcEZhY3Rvci50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhnYXBGYWN0b3IgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yICogYmFzZUZhY3RvciAvIHF1b3RlRmFjdG9yKVxuICAgIH1cblxuICAgIHRoaXMudXBkYXRlKClcbiAgICB0aGlzLnJlYWRCb29rKClcbiAgfVxuXG4gIGhhbmRsZUJhbGFuY2VOb3RlIChuOiBCYWxhbmNlTm90ZSkge1xuICAgIGlmICghdGhpcy5ta3QpIHJldHVyblxuICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlELCBiYXNlRmVlSUQsIHF1b3RlRmVlSUQgfSA9IHRoaXMubWt0XG4gICAgaWYgKG4uYXNzZXRJRCAhPT0gYmFzZUlEICYmIG4uYXNzZXRJRCAhPT0gYmFzZUZlZUlEICYmIG4uYXNzZXRJRCAhPT0gcXVvdGVJRCAmJiBuLmFzc2V0SUQgIT09IHF1b3RlRmVlSUQpIHJldHVyblxuICAgIHRoaXMudXBkYXRlKClcbiAgfVxuXG4gIGhhbmRsZUVwb2NoUmVwb3J0Tm90ZSAobjogRXBvY2hSZXBvcnROb3RlKSB7XG4gICAgaWYgKCF0aGlzLm1rdCkgcmV0dXJuXG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QgfSA9IHRoaXMubWt0XG4gICAgaWYgKG4uYmFzZUlEICE9PSBiYXNlSUQgfHwgbi5xdW90ZUlEICE9PSBxdW90ZUlEIHx8IG4uaG9zdCAhPT0gaG9zdCkgcmV0dXJuXG4gICAgaWYgKCFuLnJlcG9ydCkgcmV0dXJuXG4gICAgdGhpcy5sYXRlc3RFcG9jaCA9IG4ucmVwb3J0XG4gICAgaWYgKHRoaXMuZm9ybXMuY3VycmVudEZvcm0gPT09IHRoaXMub3JkZXJSZXBvcnRGb3JtRWwpIHtcbiAgICAgIGNvbnN0IG9yZGVyUmVwb3J0ID0gdGhpcy5kaXNwbGF5ZWRTaWRlID09PSAnYnV5cycgPyBuLnJlcG9ydC5idXlzUmVwb3J0IDogbi5yZXBvcnQuc2VsbHNSZXBvcnRcbiAgICAgIGlmIChvcmRlclJlcG9ydCkgdGhpcy51cGRhdGVPcmRlclJlcG9ydChvcmRlclJlcG9ydCwgdGhpcy5kaXNwbGF5ZWRTaWRlLCBuLnJlcG9ydC5lcG9jaE51bSlcbiAgICAgIGVsc2UgdGhpcy5mb3Jtcy5jbG9zZSgpXG4gICAgfVxuICAgIHRoaXMudXBkYXRlKClcbiAgfVxuXG4gIGhhbmRsZUNleFByb2JsZW1zTm90ZSAobjogQ0VYUHJvYmxlbXNOb3RlKSB7XG4gICAgaWYgKCF0aGlzLm1rdCkgcmV0dXJuXG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QgfSA9IHRoaXMubWt0XG4gICAgaWYgKG4uYmFzZUlEICE9PSBiYXNlSUQgfHwgbi5xdW90ZUlEICE9PSBxdW90ZUlEIHx8IG4uaG9zdCAhPT0gaG9zdCkgcmV0dXJuXG4gICAgdGhpcy5jZXhQcm9ibGVtcyA9IG4ucHJvYmxlbXNcbiAgICB0aGlzLnVwZGF0ZSgpXG4gIH1cblxuICBzZXRUaWNrZXIgKCkge1xuICAgIHRoaXMucGFnZS5ydW5UaW1lLnRleHRDb250ZW50ID0gRG9jLmhtc1NpbmNlKHRoaXMuc3RhcnRUaW1lKVxuICB9XG5cbiAgdXBkYXRlICgpIHtcbiAgICBjb25zdCB7XG4gICAgICBkaXYsIHBhZ2UsIG1rdDoge1xuICAgICAgICBiYXNlSUQsIHF1b3RlSUQsIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCwgYmFzZUZhY3RvciwgcXVvdGVGYWN0b3IsIGJhc2VGZWVGYWN0b3IsXG4gICAgICAgIHF1b3RlRmVlRmFjdG9yLCBtYXJrZXRSZXBvcnQ6IHsgYmFzZUZpYXRSYXRlLCBxdW90ZUZpYXRSYXRlIH1cbiAgICAgIH1cbiAgICB9ID0gdGhpc1xuICAgIC8vIEdldCBmcmVzaCBzdGF0c1xuICAgIGNvbnN0IHsgYm90Q2ZnOiB7IGNleE5hbWUsIGJhc2ljTWFya2V0TWFraW5nQ29uZmlnOiBibW1DZmcgfSwgcnVuU3RhdHMsIGxhdGVzdEVwb2NoLCBjZXhQcm9ibGVtcyB9ID0gdGhpcy5ta3Quc3RhdHVzKClcbiAgICBpZiAobGF0ZXN0RXBvY2gpIHRoaXMubGF0ZXN0RXBvY2ggPSBsYXRlc3RFcG9jaFxuICAgIGlmIChjZXhQcm9ibGVtcykgdGhpcy5jZXhQcm9ibGVtcyA9IGNleFByb2JsZW1zXG5cbiAgICBEb2MuaGlkZShwYWdlLnN0YXRzLCBwYWdlLmNleFJvdywgcGFnZS5wZW5kaW5nRGVwb3NpdEJveCwgcGFnZS5wZW5kaW5nV2l0aGRyYXdhbEJveClcblxuICAgIGlmICghcnVuU3RhdHMpIHtcbiAgICAgIGlmICh0aGlzLnRpY2tlcikge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGlja2VyKVxuICAgICAgICB0aGlzLnRpY2tlciA9IHVuZGVmaW5lZFxuICAgICAgfVxuICAgICAgcmV0dXJuXG4gICAgfSBlbHNlIGlmICghdGhpcy50aWNrZXIpIHtcbiAgICAgIHRoaXMuc3RhcnRUaW1lID0gcnVuU3RhdHMuc3RhcnRUaW1lXG4gICAgICB0aGlzLnNldFRpY2tlcigpXG4gICAgICB0aGlzLnRpY2tlciA9IHNldEludGVydmFsKCgpID0+IHRoaXMuc2V0VGlja2VyKCksIDEwMDApXG4gICAgfVxuXG4gICAgRG9jLnNob3cocGFnZS5zdGF0cylcbiAgICBzZXRTaWduZWRWYWx1ZShydW5TdGF0cy5wcm9maXRMb3NzLnByb2ZpdFJhdGlvICogMTAwLCBwYWdlLnByb2ZpdCwgcGFnZS5wcm9maXRTaWduLCAyKVxuICAgIHNldFNpZ25lZFZhbHVlKHJ1blN0YXRzLnByb2ZpdExvc3MucHJvZml0LCBwYWdlLnByb2ZpdExvc3MsIHBhZ2UucGxTaWduLCAyKVxuICAgIHRoaXMuc3RhcnRUaW1lID0gcnVuU3RhdHMuc3RhcnRUaW1lXG5cbiAgICBjb25zdCBzdW1tZWRCYWxhbmNlID0gKGI6IEJvdEJhbGFuY2UpID0+IHtcbiAgICAgIGlmICghYikgcmV0dXJuIDBcbiAgICAgIHJldHVybiBiLmF2YWlsYWJsZSArIGIubG9ja2VkICsgYi5wZW5kaW5nICsgYi5yZXNlcnZlZFxuICAgIH1cblxuICAgIGNvbnN0IGRleEJhc2VJbnYgPSBzdW1tZWRCYWxhbmNlKHJ1blN0YXRzLmRleEJhbGFuY2VzW2Jhc2VJRF0pIC8gYmFzZUZhY3RvclxuICAgIHBhZ2Uud2FsbGV0QmFzZUludmVudG9yeS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhkZXhCYXNlSW52KVxuICAgIHBhZ2Uud2FsbGV0QmFzZUludkZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4QmFzZUludiAqIGJhc2VGaWF0UmF0ZSwgMilcbiAgICBjb25zdCBkZXhRdW90ZUludiA9IHN1bW1lZEJhbGFuY2UocnVuU3RhdHMuZGV4QmFsYW5jZXNbcXVvdGVJRF0pIC8gcXVvdGVGYWN0b3JcbiAgICBwYWdlLndhbGxldFF1b3RlSW52ZW50b3J5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGRleFF1b3RlSW52KVxuICAgIHBhZ2Uud2FsbGV0UXVvdGVJbnZGaWF0LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGRleFF1b3RlSW52ICogcXVvdGVGaWF0UmF0ZSwgMilcblxuICAgIERvYy5zZXRWaXMoY2V4TmFtZSwgcGFnZS5jZXhSb3cpXG4gICAgaWYgKGNleE5hbWUpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UucGVuZGluZ0RlcG9zaXRCb3gsIHBhZ2UucGVuZGluZ1dpdGhkcmF3YWxCb3gpXG4gICAgICBzZXRDZXhFbGVtZW50cyhkaXYsIGNleE5hbWUpXG4gICAgICBjb25zdCBjZXhCYXNlSW52ID0gc3VtbWVkQmFsYW5jZShydW5TdGF0cy5jZXhCYWxhbmNlc1tiYXNlSURdKSAvIGJhc2VGYWN0b3JcbiAgICAgIHBhZ2UuY2V4QmFzZUludmVudG9yeS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhjZXhCYXNlSW52KVxuICAgICAgcGFnZS5jZXhCYXNlSW52ZW50b3J5RmlhdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhjZXhCYXNlSW52ICogYmFzZUZpYXRSYXRlLCAyKVxuICAgICAgY29uc3QgY2V4UXVvdGVJbnYgPSBzdW1tZWRCYWxhbmNlKHJ1blN0YXRzLmNleEJhbGFuY2VzW3F1b3RlSURdKSAvIHF1b3RlRmFjdG9yXG4gICAgICBwYWdlLmNleFF1b3RlSW52ZW50b3J5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleFF1b3RlSW52KVxuICAgICAgcGFnZS5jZXhRdW90ZUludmVudG9yeUZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoY2V4UXVvdGVJbnYgKiBxdW90ZUZpYXRSYXRlLCAyKVxuICAgIH1cblxuICAgIGlmIChiYXNlRmVlSUQgIT09IGJhc2VJRCkge1xuICAgICAgY29uc3QgZmVlQmFsYW5jZSA9IHN1bW1lZEJhbGFuY2UocnVuU3RhdHMuZGV4QmFsYW5jZXNbYmFzZUZlZUlEXSkgLyBiYXNlRmVlRmFjdG9yXG4gICAgICBwYWdlLmJhc2VGZWVSZXNlcnZlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVCYWxhbmNlKVxuICAgIH1cbiAgICBpZiAocXVvdGVGZWVJRCAhPT0gcXVvdGVJRCkge1xuICAgICAgY29uc3QgZmVlQmFsYW5jZSA9IHN1bW1lZEJhbGFuY2UocnVuU3RhdHMuZGV4QmFsYW5jZXNbcXVvdGVGZWVJRF0pIC8gcXVvdGVGZWVGYWN0b3JcbiAgICAgIHBhZ2UucXVvdGVGZWVSZXNlcnZlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVCYWxhbmNlKVxuICAgIH1cblxuICAgIHBhZ2UucGVuZGluZ0RlcG9zaXRzLnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQocnVuU3RhdHMucGVuZGluZ0RlcG9zaXRzKSlcbiAgICBwYWdlLnBlbmRpbmdXaXRoZHJhd2Fscy50ZXh0Q29udGVudCA9IFN0cmluZyhNYXRoLnJvdW5kKHJ1blN0YXRzLnBlbmRpbmdXaXRoZHJhd2FscykpXG4gICAgcGFnZS5jb21wbGV0ZWRNYXRjaGVzLnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQocnVuU3RhdHMuY29tcGxldGVkTWF0Y2hlcykpXG4gICAgRG9jLnNldFZpcyhydW5TdGF0cy50cmFkZWRVU0QsIHBhZ2UudHJhZGVkVVNEQm94KVxuICAgIGlmIChydW5TdGF0cy50cmFkZWRVU0QgPiAwKSBwYWdlLnRyYWRlZFVTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhydW5TdGF0cy50cmFkZWRVU0QpXG4gICAgRG9jLnNldFZpcyhiYXNlRmlhdFJhdGUsIHBhZ2Uucm91bmRUcmlwRmVlc0JveClcbiAgICBpZiAoYmFzZUZpYXRSYXRlKSBwYWdlLnJvdW5kVHJpcEZlZXNVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoKHJ1blN0YXRzLmZlZUdhcD8ucm91bmRUcmlwRmVlcyAvIGJhc2VGYWN0b3IgKiBiYXNlRmlhdFJhdGUpIHx8IDApXG4gICAgY29uc3QgYmFzaXNQcmljZSA9IGFwcCgpLmNvbnZlbnRpb25hbFJhdGUoYmFzZUlELCBxdW90ZUlELCBydW5TdGF0cy5mZWVHYXA/LmJhc2lzUHJpY2UgfHwgMClcbiAgICBwYWdlLmJhc2lzUHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYmFzaXNQcmljZSlcblxuICAgIGNvbnN0IGRpc3BsYXlGZWVHYXAgPSAhYm1tQ2ZnIHx8IGJtbUNmZy5nYXBTdHJhdGVneSA9PT0gR2FwU3RyYXRlZ3lBYnNvbHV0ZVBsdXMgfHwgYm1tQ2ZnLmdhcFN0cmF0ZWd5ID09PSBHYXBTdHJhdGVneVBlcmNlbnRQbHVzXG4gICAgRG9jLnNldFZpcyhkaXNwbGF5RmVlR2FwLCBwYWdlLmZlZUdhcEJveClcbiAgICBpZiAoZGlzcGxheUZlZUdhcCkge1xuICAgICAgY29uc3QgZmVlR2FwID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIHJ1blN0YXRzLmZlZUdhcD8uZmVlR2FwIHx8IDApXG4gICAgICBwYWdlLmZlZUdhcC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVHYXApXG4gICAgICBwYWdlLmZlZUdhcFBjdC50ZXh0Q29udGVudCA9IChmZWVHYXAgLyBiYXNpc1ByaWNlICogMTAwIHx8IDApLnRvRml4ZWQoMilcbiAgICB9XG4gICAgRG9jLnNldFZpcyhibW1DZmcsIHBhZ2UuZ2FwU3RyYXRlZ3lCb3gpXG4gICAgaWYgKGJtbUNmZykgcGFnZS5nYXBTdHJhdGVneS50ZXh0Q29udGVudCA9IGJtbUNmZy5nYXBTdHJhdGVneVxuXG4gICAgY29uc3QgcmVtb3RlR2FwID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIHJ1blN0YXRzLmZlZUdhcD8ucmVtb3RlR2FwIHx8IDApXG4gICAgRG9jLnNldFZpcyhyZW1vdGVHYXAsIHBhZ2UucmVtb3RlR2FwQm94KVxuICAgIGlmIChyZW1vdGVHYXApIHtcbiAgICAgIHBhZ2UucmVtb3RlR2FwLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHJlbW90ZUdhcClcbiAgICAgIHBhZ2UucmVtb3RlR2FwUGN0LnRleHRDb250ZW50ID0gKHJlbW90ZUdhcCAvIGJhc2lzUHJpY2UgKiAxMDAgfHwgMCkudG9GaXhlZCgyKVxuICAgIH1cblxuICAgIERvYy5zZXRWaXMobGF0ZXN0RXBvY2g/LmJ1eXNSZXBvcnQsIHBhZ2UuYnV5T3JkZXJzUmVwb3J0Qm94KVxuICAgIGlmIChsYXRlc3RFcG9jaD8uYnV5c1JlcG9ydCkge1xuICAgICAgY29uc3QgYWxsUGxhY2VkID0gYWxsT3JkZXJzUGxhY2VkKGxhdGVzdEVwb2NoLmJ1eXNSZXBvcnQpXG4gICAgICBEb2Muc2V0VmlzKGFsbFBsYWNlZCwgcGFnZS5idXlPcmRlcnNTdWNjZXNzKVxuICAgICAgRG9jLnNldFZpcyghYWxsUGxhY2VkLCBwYWdlLmJ1eU9yZGVyc0ZhaWxlZClcbiAgICB9XG5cbiAgICBEb2Muc2V0VmlzKGxhdGVzdEVwb2NoPy5zZWxsc1JlcG9ydCwgcGFnZS5zZWxsT3JkZXJzUmVwb3J0Qm94KVxuICAgIGlmIChsYXRlc3RFcG9jaD8uc2VsbHNSZXBvcnQpIHtcbiAgICAgIGNvbnN0IGFsbFBsYWNlZCA9IGFsbE9yZGVyc1BsYWNlZChsYXRlc3RFcG9jaC5zZWxsc1JlcG9ydClcbiAgICAgIERvYy5zZXRWaXMoYWxsUGxhY2VkLCBwYWdlLnNlbGxPcmRlcnNTdWNjZXNzKVxuICAgICAgRG9jLnNldFZpcyghYWxsUGxhY2VkLCBwYWdlLnNlbGxPcmRlcnNGYWlsZWQpXG4gICAgfVxuXG4gICAgY29uc3QgcHJlT3JkZXJQcm9ibGVtTWVzc2FnZXMgPSBib3RQcm9ibGVtTWVzc2FnZXMobGF0ZXN0RXBvY2g/LnByZU9yZGVyUHJvYmxlbXMsIHRoaXMubWt0LmNleE5hbWUsIHRoaXMubWt0Lmhvc3QpXG4gICAgY29uc3QgY2V4RXJyb3JNZXNzYWdlcyA9IGNleFByb2JsZW1NZXNzYWdlcyh0aGlzLmNleFByb2JsZW1zKVxuICAgIGNvbnN0IGFsbE1lc3NhZ2VzID0gWy4uLnByZU9yZGVyUHJvYmxlbU1lc3NhZ2VzLCAuLi5jZXhFcnJvck1lc3NhZ2VzXVxuICAgIERvYy5zZXRWaXMoYWxsTWVzc2FnZXMubGVuZ3RoID4gMCwgcGFnZS5wcmVPcmRlclByb2JsZW1zQm94KVxuICAgIERvYy5lbXB0eShwYWdlLnByZU9yZGVyUHJvYmxlbXNCb3gpXG4gICAgZm9yIChjb25zdCBtc2cgb2YgYWxsTWVzc2FnZXMpIHtcbiAgICAgIGNvbnN0IHNwYW5FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSBhcyBQYWdlRWxlbWVudFxuICAgICAgc3BhbkVsLnRleHRDb250ZW50ID0gYC0gJHttc2d9YFxuICAgICAgcGFnZS5wcmVPcmRlclByb2JsZW1zQm94LmFwcGVuZENoaWxkKHNwYW5FbClcbiAgICB9XG4gIH1cblxuICB1cGRhdGVPcmRlclJlcG9ydCAocmVwb3J0OiBPcmRlclJlcG9ydCwgc2lkZTogJ2J1eXMnIHwgJ3NlbGxzJywgZXBvY2hOdW06IG51bWJlcikge1xuICAgIGNvbnN0IGZvcm0gPSB0aGlzLm9yZGVyUmVwb3J0Rm9ybVxuICAgIGNvbnN0IHNpZGVUeHQgPSBzaWRlID09PSAnYnV5cycgPyBpbnRsLnByZXAoaW50bC5JRF9CVVkpIDogaW50bC5wcmVwKGludGwuSURfU0VMTClcbiAgICBmb3JtLm9yZGVyUmVwb3J0VGl0bGUudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9SRVBPUlRfVElUTEUsIHsgc2lkZTogc2lkZVR4dCwgZXBvY2hOdW06IGAke2Vwb2NoTnVtfWAgfSlcblxuICAgIERvYy5zZXRWaXMocmVwb3J0LmVycm9yLCBmb3JtLm9yZGVyUmVwb3J0RXJyb3IpXG4gICAgRG9jLnNldFZpcyghcmVwb3J0LmVycm9yLCBmb3JtLm9yZGVyUmVwb3J0RGV0YWlscylcbiAgICBpZiAocmVwb3J0LmVycm9yKSB7XG4gICAgICBjb25zdCBwcm9ibGVtTWVzc2FnZXMgPSBib3RQcm9ibGVtTWVzc2FnZXMocmVwb3J0LmVycm9yLCB0aGlzLm1rdC5jZXhOYW1lLCB0aGlzLm1rdC5ob3N0KVxuICAgICAgRG9jLmVtcHR5KGZvcm0ub3JkZXJSZXBvcnRFcnJvcilcbiAgICAgIGZvciAoY29uc3QgbXNnIG9mIHByb2JsZW1NZXNzYWdlcykge1xuICAgICAgICBjb25zdCBzcGFuRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJykgYXMgUGFnZUVsZW1lbnRcbiAgICAgICAgc3BhbkVsLnRleHRDb250ZW50ID0gYC0gJHttc2d9YFxuICAgICAgICBmb3JtLm9yZGVyUmVwb3J0RXJyb3IuYXBwZW5kQ2hpbGQoc3BhbkVsKVxuICAgICAgfVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgZm9ybS5jZXhMb2dvLnNyYyA9IENFWERpc3BsYXlJbmZvc1t0aGlzLm1rdC5jZXhOYW1lXS5sb2dvXG4gICAgZm9ybS5jZXhCYWxhbmNlc1RpdGxlLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQ0VYX0JBTEFOQ0VTLCB7IGNleE5hbWU6IENFWERpc3BsYXlJbmZvc1t0aGlzLm1rdC5jZXhOYW1lXS5uYW1lIH0pXG4gICAgRG9jLmVtcHR5KGZvcm0uZGV4QmFsYW5jZXNCb2R5LCBmb3JtLnBsYWNlbWVudHNCb2R5KVxuICAgIGNvbnN0IGNyZWF0ZVJvdyA9IChhc3NldElEOiBudW1iZXIpOiBbUGFnZUVsZW1lbnQsIG51bWJlcl0gPT4ge1xuICAgICAgY29uc3Qgcm93ID0gdGhpcy5kZXhCYWxhbmNlc1Jvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgICBjb25zdCByb3dUbXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICAgIHJvd1RtcGwuYXNzZXQudGV4dENvbnRlbnQgPSBhc3NldC5zeW1ib2wudG9VcHBlckNhc2UoKVxuICAgICAgcm93VG1wbC5hc3NldExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGFzc2V0LnN5bWJvbClcbiAgICAgIGNvbnN0IHVuaXRJbmZvID0gYXNzZXQudW5pdEluZm9cbiAgICAgIGNvbnN0IGF2YWlsYWJsZSA9IHJlcG9ydC5hdmFpbGFibGVEZXhCYWxzW2Fzc2V0SURdID8gcmVwb3J0LmF2YWlsYWJsZURleEJhbHNbYXNzZXRJRF0uYXZhaWxhYmxlIDogMFxuICAgICAgY29uc3QgcmVxdWlyZWQgPSByZXBvcnQucmVxdWlyZWREZXhCYWxzW2Fzc2V0SURdID8gcmVwb3J0LnJlcXVpcmVkRGV4QmFsc1thc3NldElEXSA6IDBcbiAgICAgIGNvbnN0IHJlbWFpbmluZyA9IHJlcG9ydC5yZW1haW5pbmdEZXhCYWxzW2Fzc2V0SURdID8gcmVwb3J0LnJlbWFpbmluZ0RleEJhbHNbYXNzZXRJRF0gOiAwXG4gICAgICBjb25zdCBwZW5kaW5nID0gcmVwb3J0LmF2YWlsYWJsZURleEJhbHNbYXNzZXRJRF0gPyByZXBvcnQuYXZhaWxhYmxlRGV4QmFsc1thc3NldElEXS5wZW5kaW5nIDogMFxuICAgICAgY29uc3QgbG9ja2VkID0gcmVwb3J0LmF2YWlsYWJsZURleEJhbHNbYXNzZXRJRF0gPyByZXBvcnQuYXZhaWxhYmxlRGV4QmFsc1thc3NldElEXS5sb2NrZWQgOiAwXG4gICAgICBjb25zdCB1c2VkID0gcmVwb3J0LnVzZWREZXhCYWxzW2Fzc2V0SURdID8gcmVwb3J0LnVzZWREZXhCYWxzW2Fzc2V0SURdIDogMFxuICAgICAgcm93VG1wbC5hdmFpbGFibGUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGF2YWlsYWJsZSwgdW5pdEluZm8pXG4gICAgICByb3dUbXBsLmxvY2tlZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobG9ja2VkLCB1bml0SW5mbylcbiAgICAgIHJvd1RtcGwucmVxdWlyZWQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlcXVpcmVkLCB1bml0SW5mbylcbiAgICAgIHJvd1RtcGwucmVtYWluaW5nLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyZW1haW5pbmcsIHVuaXRJbmZvKVxuICAgICAgcm93VG1wbC5wZW5kaW5nLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShwZW5kaW5nLCB1bml0SW5mbylcbiAgICAgIHJvd1RtcGwudXNlZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUodXNlZCwgdW5pdEluZm8pXG4gICAgICBjb25zdCBkZWZpY2llbmN5ID0gc2FmZVN1YihyZXF1aXJlZCwgYXZhaWxhYmxlKVxuICAgICAgcm93VG1wbC5kZWZpY2llbmN5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShkZWZpY2llbmN5LCB1bml0SW5mbylcbiAgICAgIGlmIChkZWZpY2llbmN5ID4gMCkgcm93VG1wbC5kZWZpY2llbmN5LmNsYXNzTGlzdC5hZGQoJ3RleHQtZGFuZ2VyJylcbiAgICAgIGNvbnN0IGRlZmljaWVuY3lXaXRoUGVuZGluZyA9IHNhZmVTdWIoZGVmaWNpZW5jeSwgcGVuZGluZylcbiAgICAgIHJvd1RtcGwuZGVmaWNpZW5jeVdpdGhQZW5kaW5nLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShkZWZpY2llbmN5V2l0aFBlbmRpbmcsIHVuaXRJbmZvKVxuICAgICAgaWYgKGRlZmljaWVuY3lXaXRoUGVuZGluZyA+IDApIHJvd1RtcGwuZGVmaWNpZW5jeVdpdGhQZW5kaW5nLmNsYXNzTGlzdC5hZGQoJ3RleHQtZGFuZ2VyJylcbiAgICAgIHJldHVybiBbcm93LCBkZWZpY2llbmN5XVxuICAgIH1cbiAgICBjb25zdCBzZXREZWZpY2llbmN5VmlzaWJpbGl0eSA9IChkZWZpY2llbmN5OiBib29sZWFuLCByb3dzOiBIVE1MRWxlbWVudFtdKSA9PiB7XG4gICAgICBEb2Muc2V0VmlzKGRlZmljaWVuY3ksIGZvcm0uZGV4RGVmaWNpZW5jeUhlYWRlciwgZm9ybS5kZXhEZWZpY2llbmN5V2l0aFBlbmRpbmdIZWFkZXIpXG4gICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XG4gICAgICAgIGNvbnN0IHJvd1RtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICAgIERvYy5zZXRWaXMoZGVmaWNpZW5jeSwgcm93VG1wbC5kZWZpY2llbmN5LCByb3dUbXBsLmRlZmljaWVuY3lXaXRoUGVuZGluZylcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgYXNzZXRJRHMgPSBbdGhpcy5ta3QuYmFzZUlELCB0aGlzLm1rdC5xdW90ZUlEXVxuICAgIGlmICghYXNzZXRJRHMuaW5jbHVkZXModGhpcy5ta3QuYmFzZUZlZUlEKSkgYXNzZXRJRHMucHVzaCh0aGlzLm1rdC5iYXNlRmVlSUQpXG4gICAgaWYgKCFhc3NldElEcy5pbmNsdWRlcyh0aGlzLm1rdC5xdW90ZUZlZUlEKSkgYXNzZXRJRHMucHVzaCh0aGlzLm1rdC5xdW90ZUZlZUlEKVxuICAgIGxldCB0b3RhbERlZmljaWVuY3kgPSAwXG4gICAgY29uc3Qgcm93cyA6IFBhZ2VFbGVtZW50W10gPSBbXVxuICAgIGZvciAoY29uc3QgYXNzZXRJRCBvZiBhc3NldElEcykge1xuICAgICAgY29uc3QgW3JvdywgZGVmaWNpZW5jeV0gPSBjcmVhdGVSb3coYXNzZXRJRClcbiAgICAgIHRvdGFsRGVmaWNpZW5jeSArPSBkZWZpY2llbmN5XG4gICAgICBmb3JtLmRleEJhbGFuY2VzQm9keS5hcHBlbmRDaGlsZChyb3cpXG4gICAgICByb3dzLnB1c2gocm93KVxuICAgIH1cbiAgICBzZXREZWZpY2llbmN5VmlzaWJpbGl0eSh0b3RhbERlZmljaWVuY3kgPiAwLCByb3dzKVxuXG4gICAgRG9jLnNldFZpcyh0aGlzLm1rdC5jZXhOYW1lLCBmb3JtLmNleEJhbGFuY2VzVGFibGUsIGZvcm0uY291bnRlclRyYWRlUmF0ZUhlYWRlcilcbiAgICBsZXQgY2V4QXNzZXQ6IFN1cHBvcnRlZEFzc2V0XG4gICAgaWYgKHRoaXMubWt0LmNleE5hbWUpIHtcbiAgICAgIGNvbnN0IGNleEFzc2V0SUQgPSBzaWRlID09PSAnYnV5cycgPyB0aGlzLm1rdC5iYXNlSUQgOiB0aGlzLm1rdC5xdW90ZUlEXG4gICAgICBjZXhBc3NldCA9IGFwcCgpLmFzc2V0c1tjZXhBc3NldElEXVxuICAgICAgZm9ybS5jZXhBc3NldC50ZXh0Q29udGVudCA9IGNleEFzc2V0LnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgICBmb3JtLmNleEFzc2V0TG9nby5zcmMgPSBEb2MubG9nb1BhdGgoY2V4QXNzZXQuc3ltYm9sKVxuICAgICAgY29uc3QgYXZhaWxhYmxlQ2V4QmFsID0gcmVwb3J0LmF2YWlsYWJsZUNleEJhbCA/IHJlcG9ydC5hdmFpbGFibGVDZXhCYWwuYXZhaWxhYmxlIDogMFxuICAgICAgY29uc3QgcmVxdWlyZWRDZXhCYWwgPSByZXBvcnQucmVxdWlyZWRDZXhCYWwgPyByZXBvcnQucmVxdWlyZWRDZXhCYWwgOiAwXG4gICAgICBjb25zdCByZW1haW5pbmdDZXhCYWwgPSByZXBvcnQucmVtYWluaW5nQ2V4QmFsID8gcmVwb3J0LnJlbWFpbmluZ0NleEJhbCA6IDBcbiAgICAgIGNvbnN0IHBlbmRpbmdDZXhCYWwgPSByZXBvcnQuYXZhaWxhYmxlQ2V4QmFsID8gcmVwb3J0LmF2YWlsYWJsZUNleEJhbC5wZW5kaW5nIDogMFxuICAgICAgY29uc3QgcmVzZXJ2ZWRDZXhCYWwgPSByZXBvcnQuYXZhaWxhYmxlQ2V4QmFsID8gcmVwb3J0LmF2YWlsYWJsZUNleEJhbC5yZXNlcnZlZCA6IDBcbiAgICAgIGNvbnN0IHVzZWRDZXhCYWwgPSByZXBvcnQudXNlZENleEJhbCA/IHJlcG9ydC51c2VkQ2V4QmFsIDogMFxuICAgICAgY29uc3QgZGVmaWNpZW5jeUNleEJhbCA9IHNhZmVTdWIocmVxdWlyZWRDZXhCYWwsIGF2YWlsYWJsZUNleEJhbClcbiAgICAgIGNvbnN0IGRlZmljaWVuY3lXaXRoUGVuZGluZ0NleEJhbCA9IHNhZmVTdWIoZGVmaWNpZW5jeUNleEJhbCwgcGVuZGluZ0NleEJhbClcbiAgICAgIGZvcm0uY2V4QXZhaWxhYmxlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShhdmFpbGFibGVDZXhCYWwsIGNleEFzc2V0LnVuaXRJbmZvKVxuICAgICAgZm9ybS5jZXhMb2NrZWQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlc2VydmVkQ2V4QmFsLCBjZXhBc3NldC51bml0SW5mbylcbiAgICAgIGZvcm0uY2V4UmVxdWlyZWQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlcXVpcmVkQ2V4QmFsLCBjZXhBc3NldC51bml0SW5mbylcbiAgICAgIGZvcm0uY2V4UmVtYWluaW5nLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyZW1haW5pbmdDZXhCYWwsIGNleEFzc2V0LnVuaXRJbmZvKVxuICAgICAgZm9ybS5jZXhQZW5kaW5nLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShwZW5kaW5nQ2V4QmFsLCBjZXhBc3NldC51bml0SW5mbylcbiAgICAgIGZvcm0uY2V4VXNlZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUodXNlZENleEJhbCwgY2V4QXNzZXQudW5pdEluZm8pXG4gICAgICBjb25zdCBkZWZpY2llbnQgPSBkZWZpY2llbmN5Q2V4QmFsID4gMFxuICAgICAgRG9jLnNldFZpcyhkZWZpY2llbnQsIGZvcm0uY2V4RGVmaWNpZW5jeUhlYWRlciwgZm9ybS5jZXhEZWZpY2llbmN5V2l0aFBlbmRpbmdIZWFkZXIsXG4gICAgICAgIGZvcm0uY2V4RGVmaWNpZW5jeSwgZm9ybS5jZXhEZWZpY2llbmN5V2l0aFBlbmRpbmcpXG4gICAgICBpZiAoZGVmaWNpZW50KSB7XG4gICAgICAgIGZvcm0uY2V4RGVmaWNpZW5jeS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoZGVmaWNpZW5jeUNleEJhbCwgY2V4QXNzZXQudW5pdEluZm8pXG4gICAgICAgIGZvcm0uY2V4RGVmaWNpZW5jeVdpdGhQZW5kaW5nLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShkZWZpY2llbmN5V2l0aFBlbmRpbmdDZXhCYWwsIGNleEFzc2V0LnVuaXRJbmZvKVxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBhbnlFcnJvcnMgPSBmYWxzZVxuICAgIGZvciAoY29uc3QgcGxhY2VtZW50IG9mIHJlcG9ydC5wbGFjZW1lbnRzKSBpZiAocGxhY2VtZW50LmVycm9yKSB7IGFueUVycm9ycyA9IHRydWU7IGJyZWFrIH1cbiAgICBEb2Muc2V0VmlzKGFueUVycm9ycywgZm9ybS5lcnJvckhlYWRlcilcbiAgICBjb25zdCBjcmVhdGVQbGFjZW1lbnRSb3cgPSAocGxhY2VtZW50OiBUcmFkZVBsYWNlbWVudCwgcHJpb3JpdHk6IG51bWJlcik6IFBhZ2VFbGVtZW50ID0+IHtcbiAgICAgIGNvbnN0IHJvdyA9IHRoaXMucGxhY2VtZW50Um93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGNvbnN0IHJvd1RtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICBjb25zdCBiYXNlVUkgPSBhcHAoKS5hc3NldHNbdGhpcy5ta3QuYmFzZUlEXS51bml0SW5mb1xuICAgICAgY29uc3QgcXVvdGVVSSA9IGFwcCgpLmFzc2V0c1t0aGlzLm1rdC5xdW90ZUlEXS51bml0SW5mb1xuICAgICAgcm93VG1wbC5wcmlvcml0eS50ZXh0Q29udGVudCA9IFN0cmluZyhwcmlvcml0eSlcbiAgICAgIHJvd1RtcGwucmF0ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRSYXRlRnVsbFByZWNpc2lvbihwbGFjZW1lbnQucmF0ZSwgYmFzZVVJLCBxdW90ZVVJLCB0aGlzLm1rdC5yYXRlU3RlcClcbiAgICAgIHJvd1RtcGwubG90cy50ZXh0Q29udGVudCA9IFN0cmluZyhwbGFjZW1lbnQubG90cylcbiAgICAgIHJvd1RtcGwuc3RhbmRpbmdMb3RzLnRleHRDb250ZW50ID0gU3RyaW5nKHBsYWNlbWVudC5zdGFuZGluZ0xvdHMpXG4gICAgICByb3dUbXBsLm9yZGVyZWRMb3RzLnRleHRDb250ZW50ID0gU3RyaW5nKHBsYWNlbWVudC5vcmRlcmVkTG90cylcbiAgICAgIGlmIChwbGFjZW1lbnQuc3RhbmRpbmdMb3RzICsgcGxhY2VtZW50Lm9yZGVyZWRMb3RzIDwgcGxhY2VtZW50LmxvdHMpIHtcbiAgICAgICAgcm93VG1wbC5sb3RzLmNsYXNzTGlzdC5hZGQoJ3RleHQtZGFuZ2VyJylcbiAgICAgICAgcm93VG1wbC5zdGFuZGluZ0xvdHMuY2xhc3NMaXN0LmFkZCgndGV4dC1kYW5nZXInKVxuICAgICAgICByb3dUbXBsLm9yZGVyZWRMb3RzLmNsYXNzTGlzdC5hZGQoJ3RleHQtZGFuZ2VyJylcbiAgICAgIH1cbiAgICAgIERvYy5zZXRWaXMocGxhY2VtZW50LmNvdW50ZXJUcmFkZVJhdGUgPiAwLCByb3dUbXBsLmNvdW50ZXJUcmFkZVJhdGUpXG4gICAgICByb3dUbXBsLmNvdW50ZXJUcmFkZVJhdGUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0UmF0ZUZ1bGxQcmVjaXNpb24ocGxhY2VtZW50LmNvdW50ZXJUcmFkZVJhdGUsIGJhc2VVSSwgcXVvdGVVSSwgdGhpcy5ta3QucmF0ZVN0ZXApXG4gICAgICBmb3IgKGNvbnN0IGFzc2V0SUQgb2YgYXNzZXRJRHMpIHtcbiAgICAgICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICAgICAgY29uc3QgdW5pdEluZm8gPSBhc3NldC51bml0SW5mb1xuICAgICAgICBjb25zdCByZXF1aXJlZEFtdCA9IHBsYWNlbWVudC5yZXF1aXJlZERleFthc3NldElEXSA/IHBsYWNlbWVudC5yZXF1aXJlZERleFthc3NldElEXSA6IDBcbiAgICAgICAgY29uc3QgdXNlZEFtdCA9IHBsYWNlbWVudC51c2VkRGV4W2Fzc2V0SURdID8gcGxhY2VtZW50LnVzZWREZXhbYXNzZXRJRF0gOiAwXG4gICAgICAgIGNvbnN0IHJlcXVpcmVkUm93ID0gdGhpcy5wbGFjZW1lbnRBbXRSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgICBjb25zdCByZXF1aXJlZFJvd1RtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyZXF1aXJlZFJvdylcbiAgICAgICAgY29uc3QgdXNlZFJvdyA9IHRoaXMucGxhY2VtZW50QW10Um93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgICAgY29uc3QgdXNlZFJvd1RtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZSh1c2VkUm93KVxuICAgICAgICByZXF1aXJlZFJvd1RtcGwuYW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyZXF1aXJlZEFtdCwgdW5pdEluZm8pXG4gICAgICAgIHJlcXVpcmVkUm93VG1wbC5hc3NldExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGFzc2V0LnN5bWJvbClcbiAgICAgICAgcmVxdWlyZWRSb3dUbXBsLmFzc2V0U3ltYm9sLnRleHRDb250ZW50ID0gYXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKClcbiAgICAgICAgdXNlZFJvd1RtcGwuYW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZSh1c2VkQW10LCB1bml0SW5mbylcbiAgICAgICAgdXNlZFJvd1RtcGwuYXNzZXRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChhc3NldC5zeW1ib2wpXG4gICAgICAgIHVzZWRSb3dUbXBsLmFzc2V0U3ltYm9sLnRleHRDb250ZW50ID0gYXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKClcbiAgICAgICAgcm93VG1wbC5yZXF1aXJlZERFWC5hcHBlbmRDaGlsZChyZXF1aXJlZFJvdylcbiAgICAgICAgcm93VG1wbC51c2VkREVYLmFwcGVuZENoaWxkKHVzZWRSb3cpXG4gICAgICB9XG4gICAgICBEb2Muc2V0VmlzKHRoaXMubWt0LmNleE5hbWUsIHJvd1RtcGwucmVxdWlyZWRDRVgsIHJvd1RtcGwudXNlZENFWClcbiAgICAgIGlmICh0aGlzLm1rdC5jZXhOYW1lKSB7XG4gICAgICAgIGNvbnN0IHJlcXVpcmVkQW10ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShwbGFjZW1lbnQucmVxdWlyZWRDZXgsIGNleEFzc2V0LnVuaXRJbmZvKVxuICAgICAgICByb3dUbXBsLnJlcXVpcmVkQ0VYLnRleHRDb250ZW50ID0gYCR7cmVxdWlyZWRBbXR9ICR7Y2V4QXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKCl9YFxuICAgICAgICBjb25zdCB1c2VkQW10ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShwbGFjZW1lbnQudXNlZENleCwgY2V4QXNzZXQudW5pdEluZm8pXG4gICAgICAgIHJvd1RtcGwudXNlZENFWC50ZXh0Q29udGVudCA9IGAke3VzZWRBbXR9ICR7Y2V4QXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKCl9YFxuICAgICAgfVxuICAgICAgRG9jLnNldFZpcyhhbnlFcnJvcnMsIHJvd1RtcGwuZXJyb3IpXG4gICAgICBpZiAocGxhY2VtZW50LmVycm9yKSB7XG4gICAgICAgIGNvbnN0IGVyck1lc3NhZ2VzID0gYm90UHJvYmxlbU1lc3NhZ2VzKHBsYWNlbWVudC5lcnJvciwgdGhpcy5ta3QuY2V4TmFtZSwgdGhpcy5ta3QuaG9zdClcbiAgICAgICAgcm93VG1wbC5lcnJvci50ZXh0Q29udGVudCA9IGVyck1lc3NhZ2VzLmpvaW4oJ1xcbicpXG4gICAgICB9XG4gICAgICByZXR1cm4gcm93XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVwb3J0LnBsYWNlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZvcm0ucGxhY2VtZW50c0JvZHkuYXBwZW5kQ2hpbGQoY3JlYXRlUGxhY2VtZW50Um93KHJlcG9ydC5wbGFjZW1lbnRzW2ldLCBpICsgMSkpXG4gICAgfVxuICB9XG5cbiAgc2hvd09yZGVyUmVwb3J0IChzaWRlOiAnYnV5cycgfCAnc2VsbHMnKSB7XG4gICAgaWYgKCF0aGlzLmxhdGVzdEVwb2NoKSByZXR1cm5cbiAgICBjb25zdCByZXBvcnQgPSBzaWRlID09PSAnYnV5cycgPyB0aGlzLmxhdGVzdEVwb2NoLmJ1eXNSZXBvcnQgOiB0aGlzLmxhdGVzdEVwb2NoLnNlbGxzUmVwb3J0XG4gICAgaWYgKCFyZXBvcnQpIHJldHVyblxuICAgIHRoaXMudXBkYXRlT3JkZXJSZXBvcnQocmVwb3J0LCBzaWRlLCB0aGlzLmxhdGVzdEVwb2NoLmVwb2NoTnVtKVxuICAgIHRoaXMuZGlzcGxheWVkU2lkZSA9IHNpZGVcbiAgICB0aGlzLmZvcm1zLnNob3codGhpcy5vcmRlclJlcG9ydEZvcm1FbClcbiAgfVxuXG4gIHJlYWRCb29rICgpIHtcbiAgICBpZiAoIXRoaXMubWt0KSByZXR1cm5cbiAgICBjb25zdCB7IHBhZ2UsIG1rdDogeyBob3N0LCBta3RJRCB9IH0gPSB0aGlzXG4gICAgY29uc3Qgb3JkZXJzID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdLm1hcmtldHNbbWt0SURdLm9yZGVycyB8fCBbXVxuICAgIHBhZ2UubkJvb2tlZE9yZGVycy50ZXh0Q29udGVudCA9IFN0cmluZyhvcmRlcnMuZmlsdGVyKChvcmQ6IE9yZGVyKSA9PiBvcmQuc3RhdHVzID09PSBPcmRlclV0aWwuU3RhdHVzQm9va2VkKS5sZW5ndGgpXG4gIH1cbn1cblxuZnVuY3Rpb24gYWxsT3JkZXJzUGxhY2VkIChyZXBvcnQ6IE9yZGVyUmVwb3J0KSB7XG4gIGlmIChyZXBvcnQuZXJyb3IpIHJldHVybiBmYWxzZVxuICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcG9ydC5wbGFjZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcGxhY2VtZW50ID0gcmVwb3J0LnBsYWNlbWVudHNbaV1cbiAgICBpZiAocGxhY2VtZW50Lm9yZGVyZWRMb3RzICsgcGxhY2VtZW50LnN0YW5kaW5nTG90cyA8IHBsYWNlbWVudC5sb3RzKSByZXR1cm4gZmFsc2VcbiAgICBpZiAocGxhY2VtZW50LmVycm9yKSByZXR1cm4gZmFsc2VcbiAgfVxuICByZXR1cm4gdHJ1ZVxufVxuXG5mdW5jdGlvbiBzZXRTaWduZWRWYWx1ZSAodjogbnVtYmVyLCB2RWw6IFBhZ2VFbGVtZW50LCBzaWduRWw6IFBhZ2VFbGVtZW50LCBtYXhEZWNpbWFscz86IG51bWJlcikge1xuICB2RWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModiwgbWF4RGVjaW1hbHMpXG4gIHNpZ25FbC5jbGFzc0xpc3QudG9nZ2xlKCdpY28tcGx1cycsIHYgPiAwKVxuICBzaWduRWwuY2xhc3NMaXN0LnRvZ2dsZSgndGV4dC1nb29kJywgdiA+IDApXG4gIC8vIHNpZ25FbC5jbGFzc0xpc3QudG9nZ2xlKCdpY28tbWludXMnLCB2IDwgMClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZlZXNBbmRDb21taXQgKFxuICBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCBiYXNlRmVlczogTG90RmVlUmFuZ2UsIHF1b3RlRmVlczogTG90RmVlUmFuZ2UsXG4gIGxvdFNpemU6IG51bWJlciwgYmFzZUxvdHM6IG51bWJlciwgcXVvdGVMb3RzOiBudW1iZXIsIGJhc2VGZWVJRDogbnVtYmVyLCBxdW90ZUZlZUlEOiBudW1iZXIsXG4gIGJhc2VJc0FjY291bnRMb2NrZXI6IGJvb2xlYW4sIHF1b3RlSXNBY2NvdW50TG9ja2VyOiBib29sZWFuLCBiYXNlT3JkZXJSZXNlcnZlc0ZhY3RvcjogbnVtYmVyLFxuICBxdW90ZU9yZGVyUmVzZXJ2ZXNGYWN0b3I6IG51bWJlclxuKSB7XG4gIGNvbnN0IHF1b3RlTG90ID0gY2FsY3VsYXRlUXVvdGVMb3QobG90U2l6ZSwgYmFzZUlELCBxdW90ZUlEKVxuICBjb25zdCBbY2V4QmFzZUxvdHMsIGNleFF1b3RlTG90c10gPSBbcXVvdGVMb3RzLCBiYXNlTG90c11cbiAgY29uc3QgY29tbWl0ID0ge1xuICAgIGRleDoge1xuICAgICAgYmFzZToge1xuICAgICAgICBsb3RzOiBiYXNlTG90cyxcbiAgICAgICAgdmFsOiBiYXNlTG90cyAqIGxvdFNpemVcbiAgICAgIH0sXG4gICAgICBxdW90ZToge1xuICAgICAgICBsb3RzOiBxdW90ZUxvdHMsXG4gICAgICAgIHZhbDogcXVvdGVMb3RzICogcXVvdGVMb3RcbiAgICAgIH1cbiAgICB9LFxuICAgIGNleDoge1xuICAgICAgYmFzZToge1xuICAgICAgICBsb3RzOiBjZXhCYXNlTG90cyxcbiAgICAgICAgdmFsOiBjZXhCYXNlTG90cyAqIGxvdFNpemVcbiAgICAgIH0sXG4gICAgICBxdW90ZToge1xuICAgICAgICBsb3RzOiBjZXhRdW90ZUxvdHMsXG4gICAgICAgIHZhbDogY2V4UXVvdGVMb3RzICogcXVvdGVMb3RcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBsZXQgYmFzZVRva2VuRmVlc1BlclN3YXAgPSAwXG4gIGxldCBiYXNlUmVkZWVtUmVzZXJ2ZXNQZXJMb3QgPSAwXG4gIGlmIChiYXNlSUQgIT09IGJhc2VGZWVJRCkgeyAvLyB0b2tlblxuICAgIGJhc2VUb2tlbkZlZXNQZXJTd2FwICs9IGJhc2VGZWVzLmVzdGltYXRlZC5zd2FwXG4gICAgaWYgKGJhc2VGZWVJRCA9PT0gcXVvdGVGZWVJRCkgYmFzZVRva2VuRmVlc1BlclN3YXAgKz0gcXVvdGVGZWVzLmVzdGltYXRlZC5yZWRlZW1cbiAgfVxuICBsZXQgYmFzZUJvb2tpbmdGZWVzUGVyTG90ID0gYmFzZUZlZXMubWF4LnN3YXBcbiAgaWYgKGJhc2VJRCA9PT0gcXVvdGVGZWVJRCkgYmFzZUJvb2tpbmdGZWVzUGVyTG90ICs9IHF1b3RlRmVlcy5tYXgucmVkZWVtXG4gIGlmIChiYXNlSXNBY2NvdW50TG9ja2VyKSB7XG4gICAgYmFzZUJvb2tpbmdGZWVzUGVyTG90ICs9IGJhc2VGZWVzLm1heC5yZWZ1bmRcbiAgICBpZiAoIXF1b3RlSXNBY2NvdW50TG9ja2VyICYmIGJhc2VGZWVJRCAhPT0gcXVvdGVGZWVJRCkgYmFzZVJlZGVlbVJlc2VydmVzUGVyTG90ID0gYmFzZUZlZXMubWF4LnJlZGVlbVxuICB9XG5cbiAgbGV0IHF1b3RlVG9rZW5GZWVzUGVyU3dhcCA9IDBcbiAgbGV0IHF1b3RlUmVkZWVtUmVzZXJ2ZXNQZXJMb3QgPSAwXG4gIGlmIChxdW90ZUlEICE9PSBxdW90ZUZlZUlEKSB7XG4gICAgcXVvdGVUb2tlbkZlZXNQZXJTd2FwICs9IHF1b3RlRmVlcy5lc3RpbWF0ZWQuc3dhcFxuICAgIGlmIChxdW90ZUZlZUlEID09PSBiYXNlRmVlSUQpIHF1b3RlVG9rZW5GZWVzUGVyU3dhcCArPSBiYXNlRmVlcy5lc3RpbWF0ZWQucmVkZWVtXG4gIH1cbiAgbGV0IHF1b3RlQm9va2luZ0ZlZXNQZXJMb3QgPSBxdW90ZUZlZXMubWF4LnN3YXBcbiAgaWYgKHF1b3RlSUQgPT09IGJhc2VGZWVJRCkgcXVvdGVCb29raW5nRmVlc1BlckxvdCArPSBiYXNlRmVlcy5tYXgucmVkZWVtXG4gIGlmIChxdW90ZUlzQWNjb3VudExvY2tlcikge1xuICAgIHF1b3RlQm9va2luZ0ZlZXNQZXJMb3QgKz0gcXVvdGVGZWVzLm1heC5yZWZ1bmRcbiAgICBpZiAoIWJhc2VJc0FjY291bnRMb2NrZXIgJiYgcXVvdGVGZWVJRCAhPT0gYmFzZUZlZUlEKSBxdW90ZVJlZGVlbVJlc2VydmVzUGVyTG90ID0gcXVvdGVGZWVzLm1heC5yZWRlZW1cbiAgfVxuXG4gIGNvbnN0IGJhc2VSZXNlcnZlc0ZhY3RvciA9IDEgKyBiYXNlT3JkZXJSZXNlcnZlc0ZhY3RvclxuICBjb25zdCBxdW90ZVJlc2VydmVzRmFjdG9yID0gMSArIHF1b3RlT3JkZXJSZXNlcnZlc0ZhY3RvclxuXG4gIGNvbnN0IGJhc2VCb29raW5nRmVlcyA9IChiYXNlQm9va2luZ0ZlZXNQZXJMb3QgKiBiYXNlTG90cykgKiBiYXNlUmVzZXJ2ZXNGYWN0b3JcbiAgY29uc3QgYmFzZVJlZGVlbUZlZXMgPSAoYmFzZVJlZGVlbVJlc2VydmVzUGVyTG90ICogcXVvdGVMb3RzKSAqIHF1b3RlUmVzZXJ2ZXNGYWN0b3JcbiAgY29uc3QgcXVvdGVCb29raW5nRmVlcyA9IChxdW90ZUJvb2tpbmdGZWVzUGVyTG90ICogcXVvdGVMb3RzKSAqIHF1b3RlUmVzZXJ2ZXNGYWN0b3JcbiAgY29uc3QgcXVvdGVSZWRlZW1GZWVzID0gKHF1b3RlUmVkZWVtUmVzZXJ2ZXNQZXJMb3QgKiBiYXNlTG90cykgKiBiYXNlUmVzZXJ2ZXNGYWN0b3JcblxuICBjb25zdCBmZWVzOiBCb29raW5nRmVlcyA9IHtcbiAgICBiYXNlOiB7XG4gICAgICAuLi5iYXNlRmVlcyxcbiAgICAgIGJvb2tpbmdGZWVzUGVyTG90OiBiYXNlQm9va2luZ0ZlZXNQZXJMb3QsXG4gICAgICBib29raW5nRmVlc1BlckNvdW50ZXJMb3Q6IGJhc2VSZWRlZW1SZXNlcnZlc1BlckxvdCxcbiAgICAgIGJvb2tpbmdGZWVzOiBiYXNlQm9va2luZ0ZlZXMgKyBiYXNlUmVkZWVtRmVlcyxcbiAgICAgIHN3YXBSZXNlcnZlc0ZhY3RvcjogYmFzZVJlc2VydmVzRmFjdG9yLFxuICAgICAgcmVkZWVtUmVzZXJ2ZXNGYWN0b3I6IHF1b3RlUmVzZXJ2ZXNGYWN0b3IsXG4gICAgICB0b2tlbkZlZXNQZXJTd2FwOiBiYXNlVG9rZW5GZWVzUGVyU3dhcFxuICAgIH0sXG4gICAgcXVvdGU6IHtcbiAgICAgIC4uLnF1b3RlRmVlcyxcbiAgICAgIGJvb2tpbmdGZWVzUGVyTG90OiBxdW90ZUJvb2tpbmdGZWVzUGVyTG90LFxuICAgICAgYm9va2luZ0ZlZXNQZXJDb3VudGVyTG90OiBxdW90ZVJlZGVlbVJlc2VydmVzUGVyTG90LFxuICAgICAgYm9va2luZ0ZlZXM6IHF1b3RlQm9va2luZ0ZlZXMgKyBxdW90ZVJlZGVlbUZlZXMsXG4gICAgICBzd2FwUmVzZXJ2ZXNGYWN0b3I6IHF1b3RlUmVzZXJ2ZXNGYWN0b3IsXG4gICAgICByZWRlZW1SZXNlcnZlc0ZhY3RvcjogYmFzZVJlc2VydmVzRmFjdG9yLFxuICAgICAgdG9rZW5GZWVzUGVyU3dhcDogcXVvdGVUb2tlbkZlZXNQZXJTd2FwXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgY29tbWl0LCBmZWVzIH1cbn1cblxuZnVuY3Rpb24gYm90UHJvYmxlbU1lc3NhZ2VzIChwcm9ibGVtczogQm90UHJvYmxlbXMgfCB1bmRlZmluZWQsIGNleE5hbWU6IHN0cmluZywgZGV4SG9zdDogc3RyaW5nKTogc3RyaW5nW10ge1xuICBpZiAoIXByb2JsZW1zKSByZXR1cm4gW11cbiAgY29uc3QgbXNnczogc3RyaW5nW10gPSBbXVxuXG4gIGlmIChwcm9ibGVtcy53YWxsZXROb3RTeW5jZWQpIHtcbiAgICBmb3IgKGNvbnN0IFthc3NldElELCBub3RTeW5jZWRdIG9mIE9iamVjdC5lbnRyaWVzKHByb2JsZW1zLndhbGxldE5vdFN5bmNlZCkpIHtcbiAgICAgIGlmIChub3RTeW5jZWQpIHtcbiAgICAgICAgbXNncy5wdXNoKGludGwucHJlcChpbnRsLklEX1dBTExFVF9OT1RfU1lOQ0VELCB7IGFzc2V0U3ltYm9sOiBhcHAoKS5hc3NldHNbTnVtYmVyKGFzc2V0SUQpXS5zeW1ib2wudG9VcHBlckNhc2UoKSB9KSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAocHJvYmxlbXMubm9XYWxsZXRQZWVycykge1xuICAgIGZvciAoY29uc3QgW2Fzc2V0SUQsIG5vUGVlcnNdIG9mIE9iamVjdC5lbnRyaWVzKHByb2JsZW1zLm5vV2FsbGV0UGVlcnMpKSB7XG4gICAgICBpZiAobm9QZWVycykge1xuICAgICAgICBtc2dzLnB1c2goaW50bC5wcmVwKGludGwuSURfV0FMTEVUX05PX1BFRVJTLCB7IGFzc2V0U3ltYm9sOiBhcHAoKS5hc3NldHNbTnVtYmVyKGFzc2V0SUQpXS5zeW1ib2wudG9VcHBlckNhc2UoKSB9KSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAocHJvYmxlbXMuYWNjb3VudFN1c3BlbmRlZCkge1xuICAgIG1zZ3MucHVzaChpbnRsLnByZXAoaW50bC5JRF9BQ0NPVU5UX1NVU1BFTkRFRCwgeyBkZXhIb3N0OiBkZXhIb3N0IH0pKVxuICB9XG5cbiAgaWYgKHByb2JsZW1zLnVzZXJMaW1pdFRvb0xvdykge1xuICAgIG1zZ3MucHVzaChpbnRsLnByZXAoaW50bC5JRF9VU0VSX0xJTUlUX1RPT19MT1csIHsgZGV4SG9zdDogZGV4SG9zdCB9KSlcbiAgfVxuXG4gIGlmIChwcm9ibGVtcy5ub1ByaWNlU291cmNlKSB7XG4gICAgbXNncy5wdXNoKGludGwucHJlcChpbnRsLklEX05PX1BSSUNFX1NPVVJDRSkpXG4gIH1cblxuICBpZiAocHJvYmxlbXMuY2V4T3JkZXJib29rVW5zeW5jZWQpIHtcbiAgICBtc2dzLnB1c2goaW50bC5wcmVwKGludGwuSURfQ0VYX09SREVSQk9PS19VTlNZTkNFRCwgeyBjZXhOYW1lOiBjZXhOYW1lIH0pKVxuICB9XG5cbiAgaWYgKHByb2JsZW1zLmNhdXNlc1NlbGZNYXRjaCkge1xuICAgIG1zZ3MucHVzaChpbnRsLnByZXAoaW50bC5JRF9DQVVTRVNfU0VMRl9NQVRDSCkpXG4gIH1cblxuICByZXR1cm4gbXNnc1xufVxuXG5mdW5jdGlvbiBjZXhQcm9ibGVtTWVzc2FnZXMgKHByb2JsZW1zOiBDRVhQcm9ibGVtcyB8IHVuZGVmaW5lZCk6IHN0cmluZ1tdIHtcbiAgaWYgKCFwcm9ibGVtcykgcmV0dXJuIFtdXG4gIGNvbnN0IG1zZ3M6IHN0cmluZ1tdID0gW11cbiAgaWYgKHByb2JsZW1zLmRlcG9zaXRFcnIpIHtcbiAgICBmb3IgKGNvbnN0IFthc3NldElELCBkZXBvc2l0RXJyXSBvZiBPYmplY3QuZW50cmllcyhwcm9ibGVtcy5kZXBvc2l0RXJyKSkge1xuICAgICAgbXNncy5wdXNoKGludGwucHJlcChpbnRsLklEX0RFUE9TSVRfRVJST1IsXG4gICAgICAgIHtcbiAgICAgICAgICBhc3NldFN5bWJvbDogYXBwKCkuYXNzZXRzW051bWJlcihhc3NldElEKV0uc3ltYm9sLnRvVXBwZXJDYXNlKCksXG4gICAgICAgICAgdGltZTogbmV3IERhdGUoZGVwb3NpdEVyci5zdGFtcCAqIDEwMDApLnRvTG9jYWxlU3RyaW5nKCksXG4gICAgICAgICAgZXJyb3I6IGRlcG9zaXRFcnIuZXJyb3JcbiAgICAgICAgfSkpXG4gICAgfVxuICB9XG4gIGlmIChwcm9ibGVtcy53aXRoZHJhd0Vycikge1xuICAgIGZvciAoY29uc3QgW2Fzc2V0SUQsIHdpdGhkcmF3RXJyXSBvZiBPYmplY3QuZW50cmllcyhwcm9ibGVtcy53aXRoZHJhd0VycikpIHtcbiAgICAgIG1zZ3MucHVzaChpbnRsLnByZXAoaW50bC5JRF9XSVRIRFJBV19FUlJPUixcbiAgICAgICAge1xuICAgICAgICAgIGFzc2V0U3ltYm9sOiBhcHAoKS5hc3NldHNbTnVtYmVyKGFzc2V0SUQpXS5zeW1ib2wudG9VcHBlckNhc2UoKSxcbiAgICAgICAgICB0aW1lOiBuZXcgRGF0ZSh3aXRoZHJhd0Vyci5zdGFtcCAqIDEwMDApLnRvTG9jYWxlU3RyaW5nKCksXG4gICAgICAgICAgZXJyb3I6IHdpdGhkcmF3RXJyLmVycm9yXG4gICAgICAgIH0pKVxuICAgIH1cbiAgfVxuICBpZiAocHJvYmxlbXMudHJhZGVFcnIpIHtcbiAgICBtc2dzLnB1c2goaW50bC5wcmVwKGludGwuSURfQ0VYX1RSQURFX0VSUk9SLFxuICAgICAge1xuICAgICAgICB0aW1lOiBuZXcgRGF0ZShwcm9ibGVtcy50cmFkZUVyci5zdGFtcCAqIDEwMDApLnRvTG9jYWxlU3RyaW5nKCksXG4gICAgICAgIGVycm9yOiBwcm9ibGVtcy50cmFkZUVyci5lcnJvclxuICAgICAgfSkpXG4gIH1cbiAgcmV0dXJuIG1zZ3Ncbn1cblxuZnVuY3Rpb24gc2FmZVN1YiAoYTogbnVtYmVyLCBiOiBudW1iZXIpIHtcbiAgcmV0dXJuIGEgLSBiID4gMCA/IGEgLSBiIDogMFxufVxuXG53aW5kb3cubW1zdGF0dXMgPSBmdW5jdGlvbiAoKSA6IFByb21pc2U8TWFya2V0TWFraW5nU3RhdHVzPiB7XG4gIHJldHVybiBNTS5zdGF0dXMoKVxufVxuIiwiaW1wb3J0IHsgQ29yZU5vdGUsIFBhZ2VFbGVtZW50IH0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0IFN0YXRlIGZyb20gJy4vc3RhdGUnXG5pbXBvcnQgeyBzZXRDb2luSHJlZiB9IGZyb20gJy4vY29pbmV4cGxvcmVycydcbmltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5cbmV4cG9ydCBjb25zdCBJR05PUkUgPSAwXG5leHBvcnQgY29uc3QgREFUQSA9IDFcbmV4cG9ydCBjb25zdCBQT0tFID0gMlxuZXhwb3J0IGNvbnN0IFNVQ0NFU1MgPSAzXG5leHBvcnQgY29uc3QgV0FSTklORyA9IDRcbmV4cG9ydCBjb25zdCBFUlJPUiA9IDVcblxuLypcbiAqIG1ha2UgY29uc3RydWN0cyBhIG5ldyBub3RpZmljYXRpb24uIFRoZSBub3RpZmljYXRpb24gc3RydWN0dXJlIGlzIGEgbWlycm9yIG9mXG4gKiB0aGUgc3RydWN0dXJlIG9mIG5vdGlmaWNhdGlvbnMgc2VudCBmcm9tIHRoZSB3ZWIgc2VydmVyLlxuICogTk9URTogSSdtIGhvcGluZyB0byBtYWtlIHRoaXMgZnVuY3Rpb24gb2Jzb2xldGUsIHNpbmNlIGVycm9ycyBnZW5lcmF0ZWQgaW5cbiAqIGphdmFzY3JpcHQgc2hvdWxkIHVzdWFsbHkgYmUgZGlzcGxheWVkL2NhY2hlZCBzb21ld2hlcmUgYmV0dGVyLiBGb3IgZXhhbXBsZSxcbiAqIGlmIHRoZSBlcnJvciBpcyBnZW5lcmF0ZWQgZHVyaW5nIHN1Ym1pc3Npb24gb2YgYSBmb3JtLCB0aGUgZXJyb3Igc2hvdWxkIGJlXG4gKiBkaXNwbGF5ZWQgb24gb3IgbmVhciB0aGUgZm9ybSBpdHNlbGYsIG5vdCBpbiB0aGUgbm90aWZpY2F0aW9ucy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1ha2UgKHN1YmplY3Q6IHN0cmluZywgZGV0YWlsczogc3RyaW5nLCBzZXZlcml0eTogbnVtYmVyKTogQ29yZU5vdGUge1xuICByZXR1cm4ge1xuICAgIHN1YmplY3Q6IHN1YmplY3QsXG4gICAgZGV0YWlsczogZGV0YWlscyxcbiAgICBzZXZlcml0eTogc2V2ZXJpdHksXG4gICAgc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxuICAgIGFja2VkOiBmYWxzZSxcbiAgICB0eXBlOiAnaW50ZXJuYWwnLFxuICAgIHRvcGljOiAnaW50ZXJuYWwnLFxuICAgIGlkOiAnJ1xuICB9XG59XG5cbmNvbnN0IE5vdGVUeXBlT3JkZXIgPSAnb3JkZXInXG5jb25zdCBOb3RlVHlwZU1hdGNoID0gJ21hdGNoJ1xuY29uc3QgTm90ZVR5cGVCb25kUG9zdCA9ICdib25kcG9zdCdcbmNvbnN0IE5vdGVUeXBlQ29ubkV2ZW50ID0gJ2Nvbm4nXG5cbnR5cGUgRGVza3RvcE50Zm5TZXR0aW5nTGFiZWwgPSB7XG4gIFt4OiBzdHJpbmddOiBzdHJpbmdcbn1cblxuZXhwb3J0IHR5cGUgRGVza3RvcE50Zm5TZXR0aW5nID0ge1xuICBbeDogc3RyaW5nXTogYm9vbGVhblxufVxuXG5mdW5jdGlvbiBkZXNrdG9wTnRmblNldHRpbmdzS2V5ICgpOiBzdHJpbmcge1xuICByZXR1cm4gYGRlc2t0b3Bfbm90aWZpY2F0aW9ucy0ke3dpbmRvdy5sb2NhdGlvbi5ob3N0fWBcbn1cblxuZXhwb3J0IGNvbnN0IGRlc2t0b3BOdGZuTGFiZWxzOiBEZXNrdG9wTnRmblNldHRpbmdMYWJlbCA9IHtcbiAgW05vdGVUeXBlT3JkZXJdOiBpbnRsLklEX0JST1dTRVJfTlRGTl9PUkRFUlMsXG4gIFtOb3RlVHlwZU1hdGNoXTogaW50bC5JRF9CUk9XU0VSX05URk5fTUFUQ0hFUyxcbiAgW05vdGVUeXBlQm9uZFBvc3RdOiBpbnRsLklEX0JST1dTRVJfTlRGTl9CT05EUyxcbiAgW05vdGVUeXBlQ29ubkV2ZW50XTogaW50bC5JRF9CUk9XU0VSX05URk5fQ09OTkVDVElPTlNcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHREZXNrdG9wTnRmblNldHRpbmdzOiBEZXNrdG9wTnRmblNldHRpbmcgPSB7XG4gIFtOb3RlVHlwZU9yZGVyXTogdHJ1ZSxcbiAgW05vdGVUeXBlTWF0Y2hdOiB0cnVlLFxuICBbTm90ZVR5cGVCb25kUG9zdF06IHRydWUsXG4gIFtOb3RlVHlwZUNvbm5FdmVudF06IHRydWVcbn1cblxubGV0IGRlc2t0b3BOdGZuU2V0dGluZ3M6IERlc2t0b3BOdGZuU2V0dGluZ1xuXG4vLyBCcm93c2VyTm90aWZpZXIgaXMgYSB3cmFwcGVyIGFyb3VuZCB0aGUgYnJvd3NlcidzIG5vdGlmaWNhdGlvbiBBUEkuXG5jbGFzcyBCcm93c2VyTm90aWZpZXIge1xuICBzdGF0aWMgbnRmblBlcm1pc3Npb25HcmFudGVkICgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gd2luZG93Lk5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uID09PSAnZ3JhbnRlZCdcbiAgfVxuXG4gIHN0YXRpYyBudGZuUGVybWlzc2lvbkRlbmllZCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHdpbmRvdy5Ob3RpZmljYXRpb24ucGVybWlzc2lvbiA9PT0gJ2RlbmllZCdcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyByZXF1ZXN0TnRmblBlcm1pc3Npb24gKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghKCdOb3RpZmljYXRpb24nIGluIHdpbmRvdykpIHtcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoQnJvd3Nlck5vdGlmaWVyLm50Zm5QZXJtaXNzaW9uR3JhbnRlZCgpKSB7XG4gICAgICBCcm93c2VyTm90aWZpZXIuc2VuZERlc2t0b3BOb3RpZmljYXRpb24oaW50bC5wcmVwKGludGwuSURfQlJPV1NFUl9OVEZOX0VOQUJMRUQpKVxuICAgIH0gZWxzZSBpZiAoIUJyb3dzZXJOb3RpZmllci5udGZuUGVybWlzc2lvbkRlbmllZCgpKSB7XG4gICAgICBhd2FpdCBOb3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oKVxuICAgICAgQnJvd3Nlck5vdGlmaWVyLnNlbmREZXNrdG9wTm90aWZpY2F0aW9uKGludGwucHJlcChpbnRsLklEX0JST1dTRVJfTlRGTl9FTkFCTEVEKSlcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgc2VuZERlc2t0b3BOb3RpZmljYXRpb24gKHRpdGxlOiBzdHJpbmcsIGJvZHk/OiBzdHJpbmcpIHtcbiAgICBpZiAoIUJyb3dzZXJOb3RpZmllci5udGZuUGVybWlzc2lvbkdyYW50ZWQoKSkgcmV0dXJuXG4gICAgY29uc3QgbnRmbiA9IG5ldyB3aW5kb3cuTm90aWZpY2F0aW9uKHRpdGxlLCB7XG4gICAgICBib2R5OiBib2R5LFxuICAgICAgaWNvbjogJy9pbWcvc29mdGVuZWQtaWNvbi5wbmcnXG4gICAgfSlcbiAgICByZXR1cm4gbnRmblxuICB9XG59XG5cbi8vIE9TRGVza3RvcE5vdGlmaWVyIG1hbmFnZXMgT1MgZGVza3RvcCBub3RpZmljYXRpb25zIHZpYSB0aGUgc2FtZSBpbnRlcmZhY2Vcbi8vIGFzIEJyb3dzZXJOb3RpZmllciwgYnV0IHNlbmRzIG5vdGlmaWNhdGlvbnMgdXNpbmcgYW4gdW5kZXJseWluZyBHb1xuLy8gbm90aWZpY2F0aW9uIGxpYnJhcnkgZXhwb3NlZCB0byB0aGUgd2Vidmlldy5cbmNsYXNzIE9TRGVza3RvcE5vdGlmaWVyIHtcbiAgc3RhdGljIG50Zm5QZXJtaXNzaW9uR3JhbnRlZCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIHN0YXRpYyBudGZuUGVybWlzc2lvbkRlbmllZCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBzdGF0aWMgYXN5bmMgcmVxdWVzdE50Zm5QZXJtaXNzaW9uICgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBPU0Rlc2t0b3BOb3RpZmllci5zZW5kRGVza3RvcE5vdGlmaWNhdGlvbihpbnRsLnByZXAoaW50bC5JRF9CUk9XU0VSX05URk5fRU5BQkxFRCkpXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG4gIH1cblxuICBzdGF0aWMgYXN5bmMgc2VuZERlc2t0b3BOb3RpZmljYXRpb24gKHRpdGxlOiBzdHJpbmcsIGJvZHk/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyB3ZWJ2aWV3L2xpbnV4IG9yIHdlYnZpZXcvd2luZG93c1xuICAgIGlmIChpc0Rlc2t0b3BXZWJ2aWV3KCkpIGF3YWl0IHdpbmRvdy5zZW5kT1NOb3RpZmljYXRpb24odGl0bGUsIGJvZHkpXG4gICAgLy8gd2Via2l0L2RhcndpblxuICAgIC8vIFNlZTogY2xpZW50L2NtZC9iaXNvbnctZGVza3RvcC9hcHBfZGFyd2luLmdvI0w2NzMtI0w2OTdcbiAgICBlbHNlIGlmIChpc0Rlc2t0b3BXZWJraXQoKSkgYXdhaXQgd2luZG93LndlYmtpdC5tZXNzYWdlSGFuZGxlcnMuYndIYW5kbGVyLnBvc3RNZXNzYWdlKFsnc2VuZE9TTm90aWZpY2F0aW9uJywgdGl0bGUsIGJvZHldKVxuICAgIGVsc2UgY29uc29sZS5lcnJvcignc2VuZERlc2t0b3BOb3RpZmljYXRpb246IHVua25vd24gZW52aXJvbm1lbnQnKVxuICB9XG59XG5cbi8vIGlzRGVza3RvcFdlYnZpZXcgY2hlY2tzIGlmIHdlIGFyZSBydW5uaW5nIGluIHdlYnZpZXdcbmZ1bmN0aW9uIGlzRGVza3RvcFdlYnZpZXcgKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gd2luZG93LmlzV2VidmlldyAhPT0gdW5kZWZpbmVkXG59XG5cbi8vIGlzRGVza3RvcERhcndpbiByZXR1cm5zIHRydWUgaWYgd2UgYXJlIHJ1bm5pbmcgaW4gYSB3ZWJ2aWV3IG9uIGRhcndpblxuLy8gSXQgdGVzdHMgZm9yIHRoZSBleGlzdGVuY2Ugb2YgdGhlIGJ3SGFuZGxlciB3ZWJraXQgbWVzc2FnZSBoYW5kbGVyLlxuZnVuY3Rpb24gaXNEZXNrdG9wV2Via2l0ICgpOiBib29sZWFuIHtcbiAgcmV0dXJuIHdpbmRvdy53ZWJraXQ/Lm1lc3NhZ2VIYW5kbGVycz8uYndIYW5kbGVyICE9PSB1bmRlZmluZWRcbn1cblxuLy8gZGV0ZXJtaW5lIHdoZXRoZXIgd2UncmUgcnVubmluZyBpbiBhIHdlYnZpZXcgb3IgaW4gYnJvd3NlciwgYW5kIGV4cG9ydFxuLy8gdGhlIGFwcHJvcHJpYXRlIG5vdGlmaWVyIGFjY29yZGluZ2x5LlxuZXhwb3J0IGNvbnN0IE5vdGlmaWVyID0gaXNEZXNrdG9wV2VidmlldygpIHx8IGlzRGVza3RvcFdlYmtpdCgpID8gT1NEZXNrdG9wTm90aWZpZXIgOiBCcm93c2VyTm90aWZpZXJcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlc2t0b3BOb3RpZnkgKG5vdGU6IENvcmVOb3RlKSB7XG4gIGlmICghZGVza3RvcE50Zm5TZXR0aW5ncy5icm93c2VyTnRmbkVuYWJsZWQgfHwgIWRlc2t0b3BOdGZuU2V0dGluZ3Nbbm90ZS50eXBlXSkgcmV0dXJuXG4gIGF3YWl0IE5vdGlmaWVyLnNlbmREZXNrdG9wTm90aWZpY2F0aW9uKG5vdGUuc3ViamVjdCwgcGxhaW5Ob3RlKG5vdGUuZGV0YWlscykpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmZXRjaERlc2t0b3BOdGZuU2V0dGluZ3MgKCk6IERlc2t0b3BOdGZuU2V0dGluZyB7XG4gIGlmIChkZXNrdG9wTnRmblNldHRpbmdzICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gZGVza3RvcE50Zm5TZXR0aW5nc1xuICB9XG4gIGNvbnN0IGsgPSBkZXNrdG9wTnRmblNldHRpbmdzS2V5KClcbiAgZGVza3RvcE50Zm5TZXR0aW5ncyA9IChTdGF0ZS5mZXRjaExvY2FsKGspID8/IHt9KSBhcyBEZXNrdG9wTnRmblNldHRpbmdcbiAgcmV0dXJuIGRlc2t0b3BOdGZuU2V0dGluZ3Ncbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU50Zm5TZXR0aW5nIChub3RlVHlwZTogc3RyaW5nLCBlbmFibGVkOiBib29sZWFuKSB7XG4gIGZldGNoRGVza3RvcE50Zm5TZXR0aW5ncygpXG4gIGRlc2t0b3BOdGZuU2V0dGluZ3Nbbm90ZVR5cGVdID0gZW5hYmxlZFxuICBTdGF0ZS5zdG9yZUxvY2FsKGRlc2t0b3BOdGZuU2V0dGluZ3NLZXkoKSwgZGVza3RvcE50Zm5TZXR0aW5ncylcbn1cblxuY29uc3QgY29pbkV4cGxvcmVyVG9rZW5SZSA9IC9cXHtcXHtcXHsoW158XSspXFx8KFtefV0rKVxcfVxcfVxcfS9nXG5jb25zdCBvcmRlclRva2VuUmUgPSAvXFx7XFx7XFx7b3JkZXJcXHwoW159XSspXFx9XFx9XFx9L2dcblxuLypcbiAqIGluc2VydFJpY2hOb3RlIHJlcGxhY2VzIHR4IGFuZCBvcmRlciBoYXNoIHRva2VucyBpbiB0aGUgaW5wdXQgc3RyaW5nIHdpdGhcbiAqIDxhPiBlbGVtZW50cyB0aGF0IGxpbmsgdG8gdGhlIGFzc2V0J3MgY2hhaW4gZXhwbG9yZXIgYW5kIG9yZGVyIGRldGFpbHNcbiAqIHZpZXcsIGFuZCBpbnNlcnRzIHRoZSByZXN1bHRpbmcgSFRNTCBpbnRvIHRoZSBzdXBwbGllZCBwYXJlbnQgZWxlbWVudC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc2VydFJpY2hOb3RlIChwYXJlbnQ6IFBhZ2VFbGVtZW50LCBpbnB1dFN0cmluZzogc3RyaW5nKSB7XG4gIGNvbnN0IHMgPSBpbnB1dFN0cmluZy5yZXBsYWNlKG9yZGVyVG9rZW5SZSwgKF9tYXRjaCwgb3JkZXJUb2tlbikgPT4ge1xuICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJylcbiAgICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsICcvb3JkZXIvJyArIG9yZGVyVG9rZW4pXG4gICAgbGluay5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3N1YnRsZWxpbmsnKVxuICAgIGxpbmsudGV4dENvbnRlbnQgPSBvcmRlclRva2VuLnNsaWNlKDAsIDgpXG4gICAgcmV0dXJuIGxpbmsub3V0ZXJIVE1MXG4gIH0pLnJlcGxhY2UoY29pbkV4cGxvcmVyVG9rZW5SZSwgKF9tYXRjaCwgYXNzZXRJRCwgaGFzaCkgPT4ge1xuICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJylcbiAgICBsaW5rLnNldEF0dHJpYnV0ZSgnZGF0YS1leHBsb3Jlci1jb2luJywgaGFzaClcbiAgICBsaW5rLnNldEF0dHJpYnV0ZSgndGFyZ2V0JywgJ19ibGFuaycpXG4gICAgbGluay50ZXh0Q29udGVudCA9IGhhc2guc2xpY2UoMCwgOClcbiAgICBzZXRDb2luSHJlZihhc3NldElELCBsaW5rKVxuICAgIHJldHVybiBsaW5rLm91dGVySFRNTFxuICB9KVxuICBjb25zdCBlbHMgPSBEb2Mubm9kZXJpemUocykuYm9keVxuICB3aGlsZSAoZWxzLmZpcnN0Q2hpbGQpIHBhcmVudC5hcHBlbmRDaGlsZChlbHMuZmlyc3RDaGlsZClcbn1cblxuLypcbiAqIHBsYWluTm90ZSByZXBsYWNlcyB0eCBhbmQgb3JkZXIgaGFzaCB0b2tlbnMgdG9rZW5zIGluIHRoZSBpbnB1dCBzdHJpbmcgd2l0aFxuICogc2hvcnRlbmVkIGhhc2hlcywgZm9yIHJlbmRlcmluZyBpbiBicm93c2VyIG5vdGlmaWNhdGlvbnMgYW5kIHBvcHVwcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBsYWluTm90ZSAoaW5wdXRTdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHJlcGxhY2VkU3RyaW5nID0gaW5wdXRTdHJpbmcucmVwbGFjZShjb2luRXhwbG9yZXJUb2tlblJlLCAoX21hdGNoLCBfYXNzZXRJRCwgaGFzaCkgPT4ge1xuICAgIHJldHVybiBoYXNoLnNsaWNlKDAsIDgpXG4gIH0pXG4gIHJldHVybiByZXBsYWNlZFN0cmluZ1xufVxuIiwiaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCB7XG4gIFBhZ2VFbGVtZW50LFxuICBYWVJhbmdlLFxuICBPcmRlck9wdGlvblxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuXG5pbnRlcmZhY2UgT3B0aW9uc1JlcG9ydGVycyB7XG4gIGVuYWJsZTogKCkgPT4gdm9pZFxuICBkaXNhYmxlOiAoKSA9PiB2b2lkXG59XG5cbi8vIEhhdmluZyB0aGUgY2FsbGVyIHNldCB0aGVzZSB2YXJzIG9uIGxvYWQgdXNpbmcgYW4gZXhwb3J0ZWQgZnVuY3Rpb24gbWFrZXNcbi8vIGxpZmUgZWFzaWVyLlxubGV0IG9yZGVyT3B0VG1wbDogSFRNTEVsZW1lbnQsIGJvb2xlYW5PcHRUbXBsOiBIVE1MRWxlbWVudCwgcmFuZ2VPcHRUbXBsOiBIVE1MRWxlbWVudFxuXG4vLyBzZXRPcHRpb25UZW1wbGF0ZXMgc2V0cyB0aGUgcGFja2FnZSB2YXJzIGZvciB0aGUgdGVtcGxhdGVzIGFuZCBhcHBsaWNhdGlvbi5cbmV4cG9ydCBmdW5jdGlvbiBzZXRPcHRpb25UZW1wbGF0ZXMgKHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50Pik6IHZvaWQge1xuICBbYm9vbGVhbk9wdFRtcGwsIHJhbmdlT3B0VG1wbCwgb3JkZXJPcHRUbXBsXSA9IFtwYWdlLmJvb2xlYW5PcHRUbXBsLCBwYWdlLnJhbmdlT3B0VG1wbCwgcGFnZS5vcmRlck9wdFRtcGxdXG59XG5cbmNvbnN0IHRocmVlU2lnRmlncyA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChEb2MubGFuZ3VhZ2VzKCksIHtcbiAgbWluaW11bVNpZ25pZmljYW50RGlnaXRzOiAzLFxuICBtYXhpbXVtU2lnbmlmaWNhbnREaWdpdHM6IDNcbn0pXG5cbi8qXG4gKiBPcHRpb24gaXMgYSBiYXNlIGNsYXNzIGZvciBvcHRpb24gZWxlbWVudHMuIE9wdGlvbiBzdG9yZXMgc29tZSBjb21tb25cbiAqIHBhcmFtZXRlcnMgYW5kIG1vbml0b3JzIHRoZSB0b2dnbGUgc3dpdGNoLCBjYWxsaW5nIHRoZSBjaGlsZCBjbGFzcydzXG4gKiBlbmFibGUvZGlzYWJsZSBtZXRob2RzIHdoZW4gdGhlIHVzZXIgbWFudWFsbHkgdHVybnMgdGhlIG9wdGlvbiBvbiBvciBvZmYuXG4gKi9cbmV4cG9ydCBjbGFzcyBPcHRpb24ge1xuICBvcHQ6IE9yZGVyT3B0aW9uXG4gIG5vZGU6IEhUTUxFbGVtZW50XG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBvbjogYm9vbGVhblxuXG4gIGNvbnN0cnVjdG9yIChvcHQ6IE9yZGVyT3B0aW9uLCBzeW1ib2w6IHN0cmluZywgcmVwb3J0OiBPcHRpb25zUmVwb3J0ZXJzKSB7XG4gICAgdGhpcy5vcHQgPSBvcHRcbiAgICBjb25zdCBub2RlID0gdGhpcy5ub2RlID0gb3JkZXJPcHRUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgIGNvbnN0IHRtcGwgPSB0aGlzLnRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShub2RlKVxuXG4gICAgdG1wbC5vcHROYW1lLnRleHRDb250ZW50ID0gb3B0LmRpc3BsYXluYW1lXG4gICAgdG1wbC50b29sdGlwLmRhdGFzZXQudG9vbHRpcCA9IG9wdC5kZXNjcmlwdGlvblxuXG4gICAgLy8gY29uc3QgaXNCYXNlQ2hhaW4gPSAoaXNTd2FwT3B0aW9uICYmIG9yZGVyLnNlbGwpIHx8ICghaXNTd2FwT3B0aW9uICYmICFvcmRlci5zZWxsKVxuICAgIC8vIGNvbnN0IHN5bWJvbCA9IGlzQmFzZUNoYWluID8gdGhpcy5iYXNlU3ltYm9sKCkgOiB0aGlzLnF1b3RlU3ltYm9sKClcbiAgICBpZiAoc3ltYm9sKSB0bXBsLmNoYWluSWNvbi5zcmMgPSBEb2MubG9nb1BhdGgoc3ltYm9sKVxuICAgIGVsc2UgRG9jLmhpZGUodG1wbC5jaGFpbkljb24pXG5cbiAgICB0aGlzLm9uID0gZmFsc2VcbiAgICBEb2MuYmluZChub2RlLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5vbikgcmV0dXJuXG4gICAgICB0aGlzLm9uID0gdHJ1ZVxuICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgICByZXBvcnQuZW5hYmxlKClcbiAgICB9KVxuICAgIERvYy5iaW5kKHRtcGwudG9nZ2xlLCAnY2xpY2snLCBlID0+IHtcbiAgICAgIGlmICghdGhpcy5vbikgcmV0dXJuXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICB0aGlzLm9uID0gZmFsc2VcbiAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgICAgcmVwb3J0LmRpc2FibGUoKVxuICAgIH0pXG4gIH1cbn1cblxuLypcbiAqIEJvb2xlYW5PcHRpb24gaXMgYSBzaW1wbGUgb24vb2ZmIG9wdGlvbiB3aXRoIGEgc2hvcnQgc3VtbWFyeSBvZiBpdCdzIGVmZmVjdHMuXG4gKiBCb29sZWFuT3JkZXJPcHRpb24gaXMgdGhlIGhhbmRsZXIgZm9yIGEgKkJvb2xlYW5Db25maWcgZnJvbSBjbGllbnQvYXNzZXQuXG4gKi9cbmV4cG9ydCBjbGFzcyBCb29sZWFuT3B0aW9uIGV4dGVuZHMgT3B0aW9uIHtcbiAgY29udHJvbDogSFRNTEVsZW1lbnRcbiAgY2hhbmdlZDogKCkgPT4gdm9pZFxuICBkaWN0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG5cbiAgY29uc3RydWN0b3IgKG9wdDogT3JkZXJPcHRpb24sIHN5bWJvbDogc3RyaW5nLCBkaWN0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBjaGFuZ2VkOiAoKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIob3B0LCBzeW1ib2wsIHtcbiAgICAgIGVuYWJsZTogKCkgPT4gdGhpcy5lbmFibGUoKSxcbiAgICAgIGRpc2FibGU6ICgpID0+IHRoaXMuZGlzYWJsZSgpXG4gICAgfSlcbiAgICB0aGlzLmRpY3QgPSBkaWN0XG4gICAgdGhpcy5jaGFuZ2VkID0gKCkgPT4gY2hhbmdlZCgpXG4gICAgaWYgKG9wdC5ib29sZWFuID09PSB1bmRlZmluZWQpIHRocm93IEVycm9yKCdub3QgYSBib29sZWFuIG9wdCcpXG4gICAgY29uc3QgY2ZnID0gb3B0LmJvb2xlYW5cbiAgICBjb25zdCBjb250cm9sID0gdGhpcy5jb250cm9sID0gYm9vbGVhbk9wdFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgLy8gQXBwZW5kIHRvIHBhcmVudCdzIG9wdGlvbnMgZGl2LlxuICAgIHRoaXMudG1wbC5jb250cm9scy5hcHBlbmRDaGlsZChjb250cm9sKVxuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShjb250cm9sKVxuICAgIHRtcGwucmVhc29uLnRleHRDb250ZW50ID0gY2ZnLnJlYXNvblxuICAgIHRoaXMub24gPSB0eXBlb2YgZGljdFtvcHQua2V5XSAhPT0gJ3VuZGVmaW5lZCcgPyBkaWN0W29wdC5rZXldIDogb3B0LmRlZmF1bHRcbiAgICBpZiAodGhpcy5vbikgdGhpcy5ub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgfVxuXG4gIHN0b3JlICgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5vbiA9PT0gdGhpcy5vcHQuZGVmYXVsdCkgZGVsZXRlIHRoaXMuZGljdFt0aGlzLm9wdC5rZXldXG4gICAgZWxzZSB0aGlzLmRpY3RbdGhpcy5vcHQua2V5XSA9IHRoaXMub25cbiAgICB0aGlzLmNoYW5nZWQoKVxuICB9XG5cbiAgZW5hYmxlICgpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3JlKClcbiAgfVxuXG4gIGRpc2FibGUgKCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcmUoKVxuICB9XG59XG5cbi8qXG4gKiBYWVJhbmdlT3B0aW9uIGlzIGFuIG9yZGVyIG9wdGlvbiB0aGF0IGNvbnRhaW5zIGFuIFhZUmFuZ2VIYW5kbGVyLiBUaGUgbG9naWNcbiAqIGZvciBoYW5kbGluZyB0aGUgc2xpZGVyIHRvIGlzIGRlZmluZWQgaW4gWFlSYW5nZUhhbmRsZXIgc28gdGhhdCB0aGUgc2xpZGVyXG4gKiBjYW4gYmUgdXNlZCB3aXRob3V0IGJlaW5nIGNvbnRhaW5lZCBpbiBhbiBvcmRlciBvcHRpb24uXG4gKi9cbmV4cG9ydCBjbGFzcyBYWVJhbmdlT3B0aW9uIGV4dGVuZHMgT3B0aW9uIHtcbiAgaGFuZGxlcjogWFlSYW5nZUhhbmRsZXJcbiAgeDogbnVtYmVyXG4gIGNoYW5nZWQ6ICgpID0+IHZvaWRcbiAgZGljdDogUmVjb3JkPHN0cmluZywgYW55PlxuXG4gIGNvbnN0cnVjdG9yIChvcHQ6IE9yZGVyT3B0aW9uLCBzeW1ib2w6IHN0cmluZywgZGljdDogUmVjb3JkPHN0cmluZywgYW55PiwgY2hhbmdlZDogKCkgPT4gdm9pZCkge1xuICAgIHN1cGVyKG9wdCwgc3ltYm9sLCB7XG4gICAgICBlbmFibGU6ICgpID0+IHRoaXMuZW5hYmxlKCksXG4gICAgICBkaXNhYmxlOiAoKSA9PiB0aGlzLmRpc2FibGUoKVxuICAgIH0pXG4gICAgdGhpcy5kaWN0ID0gZGljdFxuICAgIHRoaXMuY2hhbmdlZCA9IGNoYW5nZWRcbiAgICBpZiAob3B0Lnh5UmFuZ2UgPT09IHVuZGVmaW5lZCkgdGhyb3cgRXJyb3IoJ25vdCBhbiB4eSByYW5nZSBvcHQnKVxuICAgIGNvbnN0IGNmZyA9IG9wdC54eVJhbmdlXG4gICAgY29uc3Qgc2V0VmFsID0gZGljdFtvcHQua2V5XVxuICAgIHRoaXMub24gPSB0eXBlb2Ygc2V0VmFsICE9PSAndW5kZWZpbmVkJ1xuICAgIGlmICh0aGlzLm9uKSB7XG4gICAgICB0aGlzLm5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuICAgICAgdGhpcy54ID0gc2V0VmFsXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMueCA9IG9wdC5kZWZhdWx0XG4gICAgfVxuICAgIGNvbnN0IHNlbGVjdGVkID0gKCkgPT4geyB0aGlzLm5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKSB9XG4gICAgdGhpcy5oYW5kbGVyID0gbmV3IFhZUmFuZ2VIYW5kbGVyKGNmZywgdGhpcy54LCB7IGNoYW5nZWQsIHNlbGVjdGVkLCBzZXR0aW5nc0RpY3Q6IGRpY3QsIHNldHRpbmdzS2V5OiBvcHQua2V5IH0pXG4gICAgdGhpcy50bXBsLmNvbnRyb2xzLmFwcGVuZENoaWxkKHRoaXMuaGFuZGxlci5jb250cm9sKVxuICB9XG5cbiAgZW5hYmxlICgpOiB2b2lkIHtcbiAgICB0aGlzLmRpY3RbdGhpcy5vcHQua2V5XSA9IHRoaXMueFxuICAgIHRoaXMuY2hhbmdlZCgpXG4gIH1cblxuICBkaXNhYmxlICgpOiB2b2lkIHtcbiAgICBkZWxldGUgdGhpcy5kaWN0W3RoaXMub3B0LmtleV1cbiAgICB0aGlzLmNoYW5nZWQoKVxuICB9XG5cbiAgc2V0VmFsdWUgKHg6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuaGFuZGxlci5zZXRWYWx1ZSh4KVxuICAgIHRoaXMub24gPSB0cnVlXG4gICAgdGhpcy5ub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgfVxufVxuXG5pbnRlcmZhY2UgQWNjZXB0T3B0cyB7XG4gIHNraXBDaGFuZ2U/OiBib29sZWFuXG4gIHNraXBVcGRhdGU/OiBib29sZWFuIC8vIEltcGxpZXMgc2tpcENoYW5nZVxufVxuXG5pbnRlcmZhY2UgUmFuZ2VIYW5kbGVyT3B0cyB7XG4gIHJvdW5kWT86IGJvb2xlYW5cbiAgcm91bmRYPzogYm9vbGVhblxuICB1cGRhdGVkPzogKHg6bnVtYmVyLCB5Om51bWJlcikgPT4gdm9pZCwgLy8gZmlyZXMgd2hpbGUgZHJhZ2dpbmcuXG4gIGNoYW5nZWQ/OiAoKSA9PiB2b2lkLCAvLyBkb2VzIG5vdCBmaXJlIHdoaWxlIGRyYWdnaW5nIGJ1dCBkb2VzIHdoZW4gZHJhZ2dpbmcgZW5kcy5cbiAgc2VsZWN0ZWQ/OiAoKSA9PiB2b2lkLFxuICBkaXNhYmxlZD86IGJvb2xlYW5cbiAgc2V0dGluZ3NEaWN0Pzoge1trZXk6IHN0cmluZ106IGFueX1cbiAgc2V0dGluZ3NLZXk/OiBzdHJpbmdcbiAgY29udmVydD86ICh4OiBudW1iZXIsIHk6IG51bWJlcikgPT4gYW55XG59XG5cbi8qXG4gKiBYWVJhbmdlSGFuZGxlciBpcyB0aGUgaGFuZGxlciBmb3IgYW4gKlhZUmFuZ2UgZnJvbSBjbGllbnQvYXNzZXQuIFhZUmFuZ2VcbiAqIGhhcyBhIHNsaWRlciB3aGljaCBhbGxvd3MgYWRqdXN0aW5nIHRoZSB4IGFuZCB5LCBsaW5lYXJseSBiZXR3ZWVuIHR3byBsaW1pdHMuXG4gKiBUaGUgdXNlciBjYW4gYWxzbyBtYW51YWxseSBlbnRlciB2YWx1ZXMgZm9yIHggb3IgeS5cbiAqL1xuZXhwb3J0IGNsYXNzIFhZUmFuZ2VIYW5kbGVyIHtcbiAgY29udHJvbDogSFRNTEVsZW1lbnRcbiAgcmFuZ2U6IFhZUmFuZ2VcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGluaXRWYWw6IG51bWJlclxuICBzZXR0aW5nc0RpY3Q/OiB7W2tleTogc3RyaW5nXTogYW55fVxuICBzZXR0aW5nc0tleTogc3RyaW5nXG4gIHg6IG51bWJlclxuICBzY3JvbGxpbmdYOiBudW1iZXJcbiAgeTogbnVtYmVyXG4gIHI6IG51bWJlclxuICByb3VuZFg6IGJvb2xlYW5cbiAgcm91bmRZOiBib29sZWFuXG4gIGRpc2FibGVkOiBib29sZWFuXG4gIHVwZGF0ZWQ6ICh4Om51bWJlciwgeTpudW1iZXIpID0+IHZvaWQgLy8gY2FsbGVkIHdoaWxlIGRyYWdnaW5nXG4gIGNoYW5nZWQ6ICgpID0+IHZvaWQgLy8gbm90IGNhbGxlZCB3aGlsZSBkcmFnZ2luZywgYnV0IGNhbGxlZCB3aGVuIGRvbmUgZHJhZ2dpbmdcbiAgc2VsZWN0ZWQ6ICgpID0+IHZvaWRcbiAgY29udmVydDogKHg6IG51bWJlciwgeTogbnVtYmVyKSA9PiBhbnlcblxuICBjb25zdHJ1Y3RvciAoXG4gICAgcmFuZ2U6IFhZUmFuZ2UsXG4gICAgaW5pdFZhbDogbnVtYmVyLFxuICAgIG9wdHM6IFJhbmdlSGFuZGxlck9wdHNcbiAgKSB7XG4gICAgY29uc3QgY29udHJvbCA9IHRoaXMuY29udHJvbCA9IHJhbmdlT3B0VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gdGhpcy50bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoY29udHJvbClcbiAgICB0bXBsLnJhbmdlTGJsU3RhcnQudGV4dENvbnRlbnQgPSByYW5nZS5zdGFydC5sYWJlbFxuICAgIHRtcGwucmFuZ2VMYmxFbmQudGV4dENvbnRlbnQgPSByYW5nZS5lbmQubGFiZWxcbiAgICB0bXBsLnhVbml0LnRleHRDb250ZW50ID0gcmFuZ2UueFVuaXRcbiAgICB0bXBsLnlVbml0LnRleHRDb250ZW50ID0gcmFuZ2UueVVuaXRcbiAgICB0aGlzLnJhbmdlID0gcmFuZ2VcbiAgICB0aGlzLmluaXRWYWwgPSBpbml0VmFsXG4gICAgdGhpcy5zZXR0aW5nc0RpY3QgPSBvcHRzLnNldHRpbmdzRGljdFxuICAgIHRoaXMuc2V0dGluZ3NLZXkgPSBvcHRzLnNldHRpbmdzS2V5ID8/ICcnXG4gICAgdGhpcy5yb3VuZFggPSBCb29sZWFuKG9wdHMucm91bmRYKVxuICAgIHRoaXMucm91bmRZID0gQm9vbGVhbihvcHRzLnJvdW5kWSlcblxuICAgIHRoaXMuc2V0RGlzYWJsZWQoQm9vbGVhbihvcHRzLmRpc2FibGVkKSlcbiAgICB0aGlzLmNoYW5nZWQgPSBvcHRzLmNoYW5nZWQgPz8gKCgpID0+IHsgLyogcGFzcyAqLyB9KVxuICAgIHRoaXMuc2VsZWN0ZWQgPSBvcHRzLnNlbGVjdGVkID8/ICgoKSA9PiB7IC8qIHBhc3MgKi8gfSlcbiAgICB0aGlzLnVwZGF0ZWQgPSBvcHRzLnVwZGF0ZWQgPz8gKCgpID0+IHsgLyogcGFzcyAqLyB9KVxuICAgIHRoaXMuY29udmVydCA9IG9wdHMuY29udmVydCB8fCAoKHg6IG51bWJlcikgPT4geClcblxuICAgIGNvbnN0IHsgc2xpZGVyLCBoYW5kbGUgfSA9IHRtcGxcbiAgICBjb25zdCByYW5nZVggPSByYW5nZS5lbmQueCAtIHJhbmdlLnN0YXJ0LnhcbiAgICBjb25zdCByYW5nZVkgPSByYW5nZS5lbmQueSAtIHJhbmdlLnN0YXJ0LnlcbiAgICBjb25zdCBub3JtYWxpemVYID0gKHg6IG51bWJlcikgPT4gKHggLSByYW5nZS5zdGFydC54KSAvIHJhbmdlWFxuXG4gICAgLy8gciwgeCwgYW5kIHkgd2lsbCBiZSB1cGRhdGVkIGJ5IHRoZSB2YXJpb3VzIGlucHV0IGV2ZW50IGhhbmRsZXJzLiByIGlzXG4gICAgLy8geCAob3IgeSkgbm9ybWFsaXplZCBvbiBpdHMgcmFuZ2UsIGUuZy4gW3hfbWluLCB4X21heF0gLT4gWzAsIDFdXG4gICAgdGhpcy5yID0gbm9ybWFsaXplWChpbml0VmFsKVxuICAgIHRoaXMuc2Nyb2xsaW5nWCA9IHRoaXMueCA9IGluaXRWYWxcbiAgICB0aGlzLnkgPSB0aGlzLnIgKiByYW5nZVkgKyByYW5nZS5zdGFydC55XG4gICAgdGhpcy5hY2NlcHQodGhpcy5zY3JvbGxpbmdYLCB7IHNraXBVcGRhdGU6IHRydWUgfSlcblxuICAgIC8vIFNldCB1cCB0aGUgaGFuZGxlcnMgZm9yIHRoZSB4IGFuZCB5IHRleHQgaW5wdXQgZmllbGRzLlxuICAgIGNvbnN0IGNsaWNrT3V0WCA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAodGhpcy5kaXNhYmxlZCkgcmV0dXJuXG4gICAgICBpZiAoZS50eXBlICE9PSAnY2hhbmdlJyAmJiBlLnRhcmdldCA9PT0gdG1wbC54SW5wdXQpIHJldHVyblxuICAgICAgY29uc3QgcyA9IHRtcGwueElucHV0LnZhbHVlXG4gICAgICBpZiAocykge1xuICAgICAgICBjb25zdCB4eCA9IHBhcnNlRmxvYXQocylcbiAgICAgICAgaWYgKCFpc05hTih4eCkpIHtcbiAgICAgICAgICB0aGlzLnNjcm9sbGluZ1ggPSBjbGFtcCh4eCwgcmFuZ2Uuc3RhcnQueCwgcmFuZ2UuZW5kLngpXG4gICAgICAgICAgdGhpcy5yID0gbm9ybWFsaXplWCh0aGlzLnNjcm9sbGluZ1gpXG4gICAgICAgICAgdGhpcy55ID0gdGhpcy5yICogcmFuZ2VZICsgcmFuZ2Uuc3RhcnQueVxuICAgICAgICAgIHRoaXMuYWNjZXB0KHRoaXMuc2Nyb2xsaW5nWClcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgRG9jLmhpZGUodG1wbC54SW5wdXQpXG4gICAgICBEb2Muc2hvdyh0bXBsLngpXG4gICAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjbGlja091dFgpXG4gICAgICB0aGlzLmNoYW5nZWQoKVxuICAgIH1cblxuICAgIERvYy5iaW5kKHRtcGwueCwgJ2NsaWNrJywgZSA9PiB7XG4gICAgICBpZiAodGhpcy5kaXNhYmxlZCkgcmV0dXJuXG4gICAgICBEb2MuaGlkZSh0bXBsLngpXG4gICAgICBEb2Muc2hvdyh0bXBsLnhJbnB1dClcbiAgICAgIHRtcGwueElucHV0LmZvY3VzKClcbiAgICAgIHRtcGwueElucHV0LnZhbHVlID0gdGhyZWVTaWdGaWdzLmZvcm1hdCh0aGlzLnNjcm9sbGluZ1gpXG4gICAgICBEb2MuYmluZChkb2N1bWVudCwgJ2NsaWNrJywgY2xpY2tPdXRYKVxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZCh0bXBsLnhJbnB1dCwgJ2NoYW5nZScsIGNsaWNrT3V0WClcblxuICAgIGNvbnN0IGNsaWNrT3V0WSA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAodGhpcy5kaXNhYmxlZCkgcmV0dXJuXG4gICAgICBpZiAoZS50eXBlICE9PSAnY2hhbmdlJyAmJiBlLnRhcmdldCA9PT0gdG1wbC55SW5wdXQpIHJldHVyblxuICAgICAgY29uc3QgcyA9IHRtcGwueUlucHV0LnZhbHVlXG4gICAgICBpZiAocykge1xuICAgICAgICBjb25zdCB5eSA9IHBhcnNlRmxvYXQocylcbiAgICAgICAgaWYgKCFpc05hTih5eSkpIHtcbiAgICAgICAgICB0aGlzLnkgPSBjbGFtcCh5eSwgcmFuZ2Uuc3RhcnQueSwgcmFuZ2UuZW5kLnkpXG4gICAgICAgICAgdGhpcy5yID0gKHRoaXMueSAtIHJhbmdlLnN0YXJ0LnkpIC8gcmFuZ2VZXG4gICAgICAgICAgdGhpcy5zY3JvbGxpbmdYID0gcmFuZ2Uuc3RhcnQueCArIHRoaXMuciAqIHJhbmdlWFxuICAgICAgICAgIHRoaXMuYWNjZXB0KHRoaXMuc2Nyb2xsaW5nWClcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgRG9jLmhpZGUodG1wbC55SW5wdXQpXG4gICAgICBEb2Muc2hvdyh0bXBsLnkpXG4gICAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjbGlja091dFkpXG4gICAgICB0aGlzLmNoYW5nZWQoKVxuICAgIH1cblxuICAgIERvYy5iaW5kKHRtcGwueSwgJ2NsaWNrJywgZSA9PiB7XG4gICAgICBpZiAodGhpcy5kaXNhYmxlZCkgcmV0dXJuXG4gICAgICBEb2MuaGlkZSh0bXBsLnkpXG4gICAgICBEb2Muc2hvdyh0bXBsLnlJbnB1dClcbiAgICAgIHRtcGwueUlucHV0LmZvY3VzKClcbiAgICAgIHRtcGwueUlucHV0LnZhbHVlID0gdGhyZWVTaWdGaWdzLmZvcm1hdCh0aGlzLnkpXG4gICAgICBEb2MuYmluZChkb2N1bWVudCwgJ2NsaWNrJywgY2xpY2tPdXRZKVxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZCh0bXBsLnlJbnB1dCwgJ2NoYW5nZScsIGNsaWNrT3V0WSlcblxuICAgIC8vIFJlYWQgdGhlIHNsaWRlci5cbiAgICBEb2MuYmluZChoYW5kbGUsICdtb3VzZWRvd24nLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHJldHVyblxuICAgICAgaWYgKGUuYnV0dG9uICE9PSAwKSByZXR1cm5cbiAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgdGhpcy5zZWxlY3RlZCgpXG4gICAgICBjb25zdCBzdGFydFggPSBlLnBhZ2VYXG4gICAgICBjb25zdCB3ID0gc2xpZGVyLmNsaWVudFdpZHRoIC0gaGFuZGxlLm9mZnNldFdpZHRoXG4gICAgICBjb25zdCBzdGFydExlZnQgPSBub3JtYWxpemVYKHRoaXMuc2Nyb2xsaW5nWCkgKiB3XG4gICAgICBjb25zdCBsZWZ0ID0gKGVlOiBNb3VzZUV2ZW50KSA9PiBNYXRoLm1heChNYXRoLm1pbihzdGFydExlZnQgKyAoZWUucGFnZVggLSBzdGFydFgpLCB3KSwgMClcbiAgICAgIGNvbnN0IHRyYWNrTW91c2UgPSAoZWU6IE1vdXNlRXZlbnQsIGVtaXQ/OiBib29sZWFuKSA9PiB7XG4gICAgICAgIGVlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgdGhpcy5yID0gbGVmdChlZSkgLyB3XG4gICAgICAgIHRoaXMuc2Nyb2xsaW5nWCA9IHRoaXMuciAqIHJhbmdlWCArIHJhbmdlLnN0YXJ0LnhcbiAgICAgICAgdGhpcy55ID0gdGhpcy5yICogcmFuZ2VZICsgcmFuZ2Uuc3RhcnQueVxuICAgICAgICB0aGlzLmFjY2VwdCh0aGlzLnNjcm9sbGluZ1gsIHsgc2tpcENoYW5nZTogIWVtaXQgfSlcbiAgICAgIH1cbiAgICAgIGNvbnN0IG1vdXNlVXAgPSAoZWU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgdHJhY2tNb3VzZShlZSwgdHJ1ZSlcbiAgICAgICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ21vdXNlbW92ZScsIHRyYWNrTW91c2UpXG4gICAgICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdtb3VzZXVwJywgbW91c2VVcClcbiAgICAgICAgdGhpcy5jaGFuZ2VkKClcbiAgICAgIH1cbiAgICAgIERvYy5iaW5kKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdHJhY2tNb3VzZSlcbiAgICAgIERvYy5iaW5kKGRvY3VtZW50LCAnbW91c2V1cCcsIG1vdXNlVXApXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHRtcGwuc2xpZGVyQm94LCAnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHJldHVyblxuICAgICAgaWYgKGUuYnV0dG9uICE9PSAwKSByZXR1cm5cbiAgICAgIGNvbnN0IHggPSBlLnBhZ2VYXG4gICAgICBjb25zdCBtID0gRG9jLmxheW91dE1ldHJpY3ModG1wbC5zbGlkZXIpXG4gICAgICB0aGlzLnIgPSBjbGFtcCgoeCAtIG0uYm9keUxlZnQpIC8gbS53aWR0aCwgMCwgMSlcbiAgICAgIHRoaXMuc2Nyb2xsaW5nWCA9IHRoaXMuciAqIHJhbmdlWCArIHJhbmdlLnN0YXJ0LnhcbiAgICAgIHRoaXMueSA9IHRoaXMuciAqIHJhbmdlWSArIHJhbmdlLnN0YXJ0LnlcbiAgICAgIHRoaXMuYWNjZXB0KHRoaXMuc2Nyb2xsaW5nWClcbiAgICB9KVxuICB9XG5cbiAgc2V0RGlzYWJsZWQgKGRpc2FibGVkOiBib29sZWFuKSB7XG4gICAgdGhpcy5jb250cm9sLmNsYXNzTGlzdC50b2dnbGUoJ2Rpc2FibGVkJywgZGlzYWJsZWQpXG4gICAgdGhpcy5kaXNhYmxlZCA9IGRpc2FibGVkXG4gIH1cblxuICBzZXRYTGFiZWwgKHM6IHN0cmluZykge1xuICAgIHRoaXMudG1wbC54LnRleHRDb250ZW50ID0gc1xuICB9XG5cbiAgc2V0WUxhYmVsIChzOiBzdHJpbmcpIHtcbiAgICB0aGlzLnRtcGwueS50ZXh0Q29udGVudCA9IHNcbiAgfVxuXG4gIGFjY2VwdCAoeDogbnVtYmVyLCBjZmc/OiBBY2NlcHRPcHRzKTogdm9pZCB7XG4gICAgY29uc3QgdG1wbCA9IHRoaXMudG1wbFxuICAgIGlmICh0aGlzLnJvdW5kWCkgeCA9IE1hdGgucm91bmQoeClcbiAgICBpZiAodGhpcy5yb3VuZFkpIHRoaXMueSA9IE1hdGgucm91bmQodGhpcy55KVxuICAgIHRtcGwueC50ZXh0Q29udGVudCA9IHRocmVlU2lnRmlncy5mb3JtYXQoeClcbiAgICB0bXBsLnkudGV4dENvbnRlbnQgPSB0aHJlZVNpZ0ZpZ3MuZm9ybWF0KHRoaXMueSlcbiAgICBpZiAodGhpcy5yb3VuZFkpIHRtcGwueS50ZXh0Q29udGVudCA9IGAke3RoaXMueX1gXG4gICAgY29uc3QgckVmZmVjdGl2ZSA9IGNsYW1wKHRoaXMuciwgMCwgMSlcbiAgICB0bXBsLmhhbmRsZS5zdHlsZS5sZWZ0ID0gYGNhbGMoJHtyRWZmZWN0aXZlICogMTAwfSUgLSAke3JFZmZlY3RpdmUgKiAxNH1weClgXG4gICAgdGhpcy54ID0geFxuICAgIHRoaXMuc2Nyb2xsaW5nWCA9IHhcbiAgICBjZmcgPSBjZmcgPz8ge31cbiAgICBpZiAodGhpcy5zZXR0aW5nc0RpY3QpIHRoaXMuc2V0dGluZ3NEaWN0W3RoaXMuc2V0dGluZ3NLZXldID0gdGhpcy5jb252ZXJ0KHRoaXMueCwgdGhpcy55KVxuICAgIGlmICghY2ZnLnNraXBVcGRhdGUpIHtcbiAgICAgIHRoaXMudXBkYXRlZCh4LCB0aGlzLnkpXG4gICAgICBpZiAoIWNmZy5za2lwQ2hhbmdlKSB0aGlzLmNoYW5nZWQoKVxuICAgIH1cbiAgfVxuXG4gIHNldFZhbHVlICh4OiBudW1iZXIsIHNraXBVcGRhdGU/OiBib29sZWFuKSB7XG4gICAgY29uc3QgcmFuZ2UgPSB0aGlzLnJhbmdlXG4gICAgdGhpcy5yID0gKHggLSByYW5nZS5zdGFydC54KSAvIChyYW5nZS5lbmQueCAtIHJhbmdlLnN0YXJ0LngpXG4gICAgdGhpcy55ID0gcmFuZ2Uuc3RhcnQueSArIHRoaXMuciAqIChyYW5nZS5lbmQueSAtIHJhbmdlLnN0YXJ0LnkpXG4gICAgdGhpcy5hY2NlcHQoeCwgeyBza2lwVXBkYXRlIH0pXG4gIH1cblxuICBtb2RpZmllZCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMueCAhPT0gdGhpcy5pbml0VmFsXG4gIH1cblxuICByZXNldCAoKSB7XG4gICAgdGhpcy5zZXRWYWx1ZSh0aGlzLmluaXRWYWwsIHRydWUpXG4gIH1cbn1cblxuY29uc3QgY2xhbXAgPSAodjogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIgPT4gdiA8IG1pbiA/IG1pbiA6IHYgPiBtYXggPyBtYXggOiB2XG4iLCJpbXBvcnQgRG9jIGZyb20gJy4vZG9jJ1xuaW1wb3J0IEJhc2VQYWdlIGZyb20gJy4vYmFzZXBhZ2UnXG5pbXBvcnQgKiBhcyBPcmRlclV0aWwgZnJvbSAnLi9vcmRlcnV0aWwnXG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRGb3JtLCBBY2NlbGVyYXRlT3JkZXJGb3JtIH0gZnJvbSAnLi9mb3JtcydcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQge1xuICBhcHAsXG4gIE9yZGVyLFxuICBQYWdlRWxlbWVudCxcbiAgT3JkZXJOb3RlLFxuICBNYXRjaE5vdGUsXG4gIE1hdGNoLFxuICBDb2luXG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgeyBzZXRPcHRpb25UZW1wbGF0ZXMgfSBmcm9tICcuL29wdHMnXG5pbXBvcnQgeyBmb3JtYXRDb2luSUQsIHNldENvaW5IcmVmIH0gZnJvbSAnLi9jb2luZXhwbG9yZXJzJ1xuXG4vLyBsb2NrVGltZU1ha2VyTXMgbXVzdCBtYXRjaCB0aGUgdmFsdWUgcmV0dXJuZWQgZnJvbSBMb2NrVGltZU1ha2VyIGZ1bmMgaW5cbi8vIGJpc29udy5cbmNvbnN0IGxvY2tUaW1lTWFrZXJNcyA9IDIwICogNjAgKiA2MCAqIDEwMDBcbi8vIGxvY2tUaW1lVGFrZXJNcyBtdXN0IG1hdGNoIHRoZSB2YWx1ZSByZXR1cm5lZCBmcm9tIExvY2tUaW1lVGFrZXIgZnVuYyBpblxuLy8gYmlzb253LlxuY29uc3QgbG9ja1RpbWVUYWtlck1zID0gOCAqIDYwICogNjAgKiAxMDAwXG5cbmNvbnN0IGFuaW1hdGlvbkxlbmd0aCA9IDUwMFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPcmRlclBhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIG9yZGVySUQ6IHN0cmluZ1xuICBvcmRlcjogT3JkZXJcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGN1cnJlbnRGb3JtOiBIVE1MRWxlbWVudFxuICBzZWNvbmRUaWNrZXI6IG51bWJlclxuICByZWZyZXNoT25Qb3B1cENsb3NlOiBib29sZWFuXG4gIGFjY2VsZXJhdGVPcmRlckZvcm06IEFjY2VsZXJhdGVPcmRlckZvcm1cbiAgc3RhbXBlcnM6IFBhZ2VFbGVtZW50W11cblxuICBjb25zdHJ1Y3RvciAobWFpbjogSFRNTEVsZW1lbnQpIHtcbiAgICBzdXBlcigpXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKG1haW4pXG4gICAgdGhpcy5zdGFtcGVycyA9IERvYy5hcHBseVNlbGVjdG9yKG1haW4sICdbZGF0YS1zdGFtcF0nKVxuICAgIC8vIEZpbmQgdGhlIG9yZGVyXG4gICAgdGhpcy5vcmRlcklEID0gbWFpbi5kYXRhc2V0Lm9pZCB8fCAnJ1xuXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UubWF0Y2hDYXJkVG1wbClcblxuICAgIGNvbnN0IHNldFN0YW1wID0gKCkgPT4ge1xuICAgICAgZm9yIChjb25zdCBzcGFuIG9mIHRoaXMuc3RhbXBlcnMpIHtcbiAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IERvYy50aW1lU2luY2UocGFyc2VJbnQoc3Bhbi5kYXRhc2V0LnN0YW1wIHx8ICcnKSlcbiAgICAgIH1cbiAgICB9XG4gICAgc2V0U3RhbXAoKVxuXG4gICAgcGFnZS5mb3Jtcy5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIERvYy5iaW5kKGVsLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnJlZnJlc2hPblBvcHVwQ2xvc2UpIHtcbiAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZSh3aW5kb3cubG9jYXRpb24uaHJlZilcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBEb2MuaGlkZShwYWdlLmZvcm1zKVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgLy8gU29tZSBzdGF0aWMgZWxlbWVudHMgb24gdGhpcyBwYWdlIGNvbnRhaW4gYXNzZXRzIHRoYXQgY2FuIGJlIGxpbmtlZFxuICAgIC8vIHRvIGJsb2NrY2hhaW4gZXhwbG9yZXJzIChzdWNoIGFzIEV0aGVyc2Nhbikgc28gdXNlcnMgY2FuIGVhc2lseVxuICAgIC8vIGV4YW1pbmUgZnVuZGluZy9hY2NlbGVyYXRpb24gY29pbnMgZGF0YSB0aGVyZS4gV2UnZCBuZWVkIHRvIHNldCB1cFxuICAgIC8vIHN1Y2ggaHlwZXJsaW5rcyBoZXJlLlxuICAgIG1haW4ucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZXhwbG9yZXItaWRdJykuZm9yRWFjaCgobGluazogUGFnZUVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IGFzc2V0SUQgPSBwYXJzZUludChsaW5rLmRhdGFzZXQuZXhwbG9yZXJJZCB8fCAnJylcbiAgICAgIHNldENvaW5IcmVmKGFzc2V0SUQsIGxpbmspXG4gICAgfSlcblxuICAgIGlmIChwYWdlLmNhbmNlbEJ0dG4pIHtcbiAgICAgIERvYy5iaW5kKHBhZ2UuY2FuY2VsQnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnNob3dGb3JtKHBhZ2UuY2FuY2VsRm9ybSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgRG9jLmJpbmQocGFnZS5hY2NlbGVyYXRlQnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zaG93QWNjZWxlcmF0ZUZvcm0oKVxuICAgIH0pXG5cbiAgICBjb25zdCBzdWNjZXNzID0gKCkgPT4ge1xuICAgICAgdGhpcy5yZWZyZXNoT25Qb3B1cENsb3NlID0gdHJ1ZVxuICAgIH1cbiAgICAvLyBEbyBub3QgY2FsbCBjbGVhblRlbXBsYXRlcyBiZWZvcmUgY3JlYXRpbmcgdGhlIEFjY2VsZXJhdGVPcmRlckZvcm1cbiAgICBzZXRPcHRpb25UZW1wbGF0ZXMocGFnZSlcbiAgICB0aGlzLmFjY2VsZXJhdGVPcmRlckZvcm0gPSBuZXcgQWNjZWxlcmF0ZU9yZGVyRm9ybShwYWdlLmFjY2VsZXJhdGVGb3JtLCBzdWNjZXNzKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhwYWdlLmJvb2xlYW5PcHRUbXBsLCBwYWdlLnJhbmdlT3B0VG1wbCwgcGFnZS5vcmRlck9wdFRtcGwpXG5cbiAgICAvLyBJZiB0aGUgdXNlciBjbGlja3Mgb3V0c2lkZSBvZiBhIGZvcm0sIGl0IHNob3VsZCBjbG9zZSB0aGUgcGFnZSBvdmVybGF5LlxuICAgIERvYy5iaW5kKHBhZ2UuZm9ybXMsICdtb3VzZWRvd24nLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKCFEb2MubW91c2VJbkVsZW1lbnQoZSwgdGhpcy5jdXJyZW50Rm9ybSkpIHtcbiAgICAgICAgaWYgKHRoaXMucmVmcmVzaE9uUG9wdXBDbG9zZSkge1xuICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIENhbmNlbCBvcmRlciBmb3JtXG4gICAgYmluZEZvcm0ocGFnZS5jYW5jZWxGb3JtLCBwYWdlLmNhbmNlbFN1Ym1pdCwgYXN5bmMgKCkgPT4geyB0aGlzLnN1Ym1pdENhbmNlbCgpIH0pXG5cbiAgICB0aGlzLnNlY29uZFRpY2tlciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBzZXRTdGFtcCgpXG4gICAgfSwgMTAwMDApIC8vIHVwZGF0ZSBldmVyeSAxMCBzZWNvbmRzXG5cbiAgICBhcHAoKS5yZWdpc3Rlck5vdGVGZWVkZXIoe1xuICAgICAgb3JkZXI6IChub3RlOiBPcmRlck5vdGUpID0+IHsgdGhpcy5oYW5kbGVPcmRlck5vdGUobm90ZSkgfSxcbiAgICAgIG1hdGNoOiAobm90ZTogTWF0Y2hOb3RlKSA9PiB7IHRoaXMuaGFuZGxlTWF0Y2hOb3RlKG5vdGUpIH1cbiAgICB9KVxuXG4gICAgdGhpcy5zdGFydCgpXG4gIH1cblxuICBhc3luYyBzdGFydCAoKSB7XG4gICAgbGV0IG9yZCA9IGFwcCgpLm9yZGVyKHRoaXMub3JkZXJJRClcbiAgICAvLyBhcHAoKS5vcmRlciBjYW4gb25seSBhY2Nlc3MgYWN0aXZlIG9yZGVycy4gSWYgdGhlIG9yZGVyIGlzIG5vdCBhY3RpdmUsXG4gICAgLy8gd2UnbGwgbmVlZCB0byBnZXQgdGhlIGRhdGEgZnJvbSB0aGUgZGF0YWJhc2UuXG4gICAgaWYgKG9yZCkgdGhpcy5vcmRlciA9IG9yZFxuICAgIGVsc2Uge1xuICAgICAgb3JkID0gYXdhaXQgdGhpcy5mZXRjaE9yZGVyKClcbiAgICB9XG4gICAgLy8gU3dhcCBvdXQgdGhlIGRvdC1ub3RhdGlvbiBzeW1ib2xzIHdpdGggdG9rZW4tYXdhcmUgc3ltYm9scy5cbiAgICB0aGlzLnBhZ2UubWt0QmFzZVN5bWJvbC5yZXBsYWNlV2l0aChEb2Muc3ltYm9saXplKGFwcCgpLmFzc2V0c1tvcmQuYmFzZUlEXSkpXG4gICAgdGhpcy5wYWdlLm1rdFF1b3RlU3ltYm9sLnJlcGxhY2VXaXRoKERvYy5zeW1ib2xpemUoYXBwKCkuYXNzZXRzW29yZC5xdW90ZUlEXSkpXG5cbiAgICB0aGlzLnNldEFjY2VsZXJhdGlvbkJ1dHRvblZpcygpXG4gICAgdGhpcy5zaG93TWF0Y2hDYXJkcygpXG4gIH1cblxuICB1bmxvYWQgKCkge1xuICAgIGNsZWFySW50ZXJ2YWwodGhpcy5zZWNvbmRUaWNrZXIpXG4gIH1cblxuICAvKiBmZXRjaE9yZGVyIGZldGNoZXMgdGhlIG9yZGVyIGZyb20gdGhlIGNsaWVudC4gKi9cbiAgYXN5bmMgZmV0Y2hPcmRlciAoKTogUHJvbWlzZTxPcmRlcj4ge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL29yZGVyJywgdGhpcy5vcmRlcklEKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB0aHJvdyByZXMubXNnXG4gICAgdGhpcy5vcmRlciA9IHJlcy5vcmRlclxuICAgIHJldHVybiB0aGlzLm9yZGVyXG4gIH1cblxuICAvKlxuICAgKiBzZXRJbW11dGFibGVNYXRjaENhcmRFbGVtZW50cyBzZXRzIHRoZSBtYXRjaCBjYXJkIGVsZW1lbnRzIHRoYXQgYXJlIG5ldmVyXG4gICAqIGNoYW5nZWQuXG4gICAqL1xuICBzZXRJbW11dGFibGVNYXRjaENhcmRFbGVtZW50cyAobWF0Y2hDYXJkOiBIVE1MRWxlbWVudCwgbWF0Y2g6IE1hdGNoKSB7XG4gICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKG1hdGNoQ2FyZClcblxuICAgIHRtcGwubWF0Y2hJRC50ZXh0Q29udGVudCA9IG1hdGNoLm1hdGNoSURcblxuICAgIGNvbnN0IHRpbWUgPSBuZXcgRGF0ZShtYXRjaC5zdGFtcClcbiAgICB0bXBsLm1hdGNoVGltZS50ZXh0Q29udGVudCA9IHRpbWUudG9Mb2NhbGVUaW1lU3RyaW5nKERvYy5sYW5ndWFnZXMoKSwge1xuICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgICAgbW9udGg6ICdzaG9ydCcsXG4gICAgICBkYXk6ICdudW1lcmljJ1xuICAgIH0pXG5cbiAgICB0bXBsLm1hdGNoVGltZUFnby5kYXRhc2V0LnN0YW1wID0gbWF0Y2guc3RhbXAudG9TdHJpbmcoKVxuICAgIHRtcGwubWF0Y2hUaW1lQWdvLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShtYXRjaC5zdGFtcClcbiAgICB0aGlzLnN0YW1wZXJzLnB1c2godG1wbC5tYXRjaFRpbWVBZ28pXG5cbiAgICBjb25zdCBvcmRlclBvcnRpb24gPSBPcmRlclV0aWwub3JkZXJQb3J0aW9uKHRoaXMub3JkZXIsIG1hdGNoKVxuICAgIGNvbnN0IGJhc2VTeW1ib2wgPSBEb2MuYmlwU3ltYm9sKHRoaXMub3JkZXIuYmFzZUlEKVxuICAgIGNvbnN0IHF1b3RlU3ltYm9sID0gRG9jLmJpcFN5bWJvbCh0aGlzLm9yZGVyLnF1b3RlSUQpXG4gICAgY29uc3QgYmFzZVVuaXRJbmZvID0gYXBwKCkudW5pdEluZm8odGhpcy5vcmRlci5iYXNlSUQpXG4gICAgY29uc3QgcXVvdGVVbml0SW5mbyA9IGFwcCgpLnVuaXRJbmZvKHRoaXMub3JkZXIucXVvdGVJRClcbiAgICBjb25zdCBbYlVuaXQsIHFVbml0XSA9IFtiYXNlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQudG9Mb3dlckNhc2UoKSwgcXVvdGVVbml0SW5mby5jb252ZW50aW9uYWwudW5pdC50b0xvd2VyQ2FzZSgpXVxuICAgIGNvbnN0IHF1b3RlQW1vdW50ID0gT3JkZXJVdGlsLmJhc2VUb1F1b3RlKG1hdGNoLnJhdGUsIG1hdGNoLnF0eSlcblxuICAgIGlmIChtYXRjaC5pc0NhbmNlbCkge1xuICAgICAgRG9jLnNob3codG1wbC5jYW5jZWxJbmZvRGl2KVxuICAgICAgRG9jLmhpZGUodG1wbC5pbmZvRGl2LCB0bXBsLnN0YXR1cywgdG1wbC5zdGF0dXNIZHIpXG5cbiAgICAgIGlmICh0aGlzLm9yZGVyLnNlbGwpIHtcbiAgICAgICAgdG1wbC5jYW5jZWxBbW91bnQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG1hdGNoLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgICB0bXBsLmNhbmNlbEljb24uc3JjID0gRG9jLmxvZ29QYXRoRnJvbUlEKHRoaXMub3JkZXIuYmFzZUlEKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG1wbC5jYW5jZWxBbW91bnQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHF1b3RlQW1vdW50LCBxdW90ZVVuaXRJbmZvKVxuICAgICAgICB0bXBsLmNhbmNlbEljb24uc3JjID0gRG9jLmxvZ29QYXRoRnJvbUlEKHRoaXMub3JkZXIucXVvdGVJRClcbiAgICAgIH1cblxuICAgICAgdG1wbC5jYW5jZWxPcmRlclBvcnRpb24udGV4dENvbnRlbnQgPSBvcmRlclBvcnRpb25cblxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgRG9jLnNob3codG1wbC5pbmZvRGl2KVxuICAgIERvYy5oaWRlKHRtcGwuY2FuY2VsSW5mb0RpdilcblxuICAgIHRtcGwub3JkZXJQb3J0aW9uLnRleHRDb250ZW50ID0gb3JkZXJQb3J0aW9uXG5cbiAgICBpZiAobWF0Y2guc2lkZSA9PT0gT3JkZXJVdGlsLk1ha2VyKSB7XG4gICAgICB0bXBsLnNpZGUudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9NQUtFUilcbiAgICAgIERvYy5zaG93KFxuICAgICAgICB0bXBsLm1ha2VyU3dhcFlvdSxcbiAgICAgICAgdG1wbC5tYWtlclJlZGVlbVlvdSxcbiAgICAgICAgdG1wbC50YWtlclN3YXBUaGVtLFxuICAgICAgICB0bXBsLnRha2VyUmVkZWVtVGhlbVxuICAgICAgKVxuICAgICAgRG9jLmhpZGUoXG4gICAgICAgIHRtcGwudGFrZXJTd2FwWW91LFxuICAgICAgICB0bXBsLnRha2VyUmVkZWVtWW91LFxuICAgICAgICB0bXBsLm1ha2VyU3dhcFRoZW0sXG4gICAgICAgIHRtcGwubWFrZXJSZWRlZW1UaGVtXG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgIHRtcGwuc2lkZS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1RBS0VSKVxuICAgICAgRG9jLmhpZGUoXG4gICAgICAgIHRtcGwubWFrZXJTd2FwWW91LFxuICAgICAgICB0bXBsLm1ha2VyUmVkZWVtWW91LFxuICAgICAgICB0bXBsLnRha2VyU3dhcFRoZW0sXG4gICAgICAgIHRtcGwudGFrZXJSZWRlZW1UaGVtXG4gICAgICApXG4gICAgICBEb2Muc2hvdyhcbiAgICAgICAgdG1wbC50YWtlclN3YXBZb3UsXG4gICAgICAgIHRtcGwudGFrZXJSZWRlZW1Zb3UsXG4gICAgICAgIHRtcGwubWFrZXJTd2FwVGhlbSxcbiAgICAgICAgdG1wbC5tYWtlclJlZGVlbVRoZW1cbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAoKG1hdGNoLnNpZGUgPT09IE9yZGVyVXRpbC5NYWtlciAmJiB0aGlzLm9yZGVyLnNlbGwpIHx8XG4gICAgICAgICAgKG1hdGNoLnNpZGUgPT09IE9yZGVyVXRpbC5UYWtlciAmJiAhdGhpcy5vcmRlci5zZWxsKSkge1xuICAgICAgdG1wbC5tYWtlclN3YXBBc3NldC50ZXh0Q29udGVudCA9IGJVbml0XG4gICAgICB0bXBsLnRha2VyU3dhcEFzc2V0LnRleHRDb250ZW50ID0gcVVuaXRcbiAgICAgIHRtcGwubWFrZXJSZWRlZW1Bc3NldC50ZXh0Q29udGVudCA9IHFVbml0XG4gICAgICB0bXBsLnRha2VyUmVkZWVtQXNzZXQudGV4dENvbnRlbnQgPSBiVW5pdFxuICAgIH0gZWxzZSB7XG4gICAgICB0bXBsLm1ha2VyU3dhcEFzc2V0LnRleHRDb250ZW50ID0gcVVuaXRcbiAgICAgIHRtcGwudGFrZXJTd2FwQXNzZXQudGV4dENvbnRlbnQgPSBiVW5pdFxuICAgICAgdG1wbC5tYWtlclJlZGVlbUFzc2V0LnRleHRDb250ZW50ID0gYlVuaXRcbiAgICAgIHRtcGwudGFrZXJSZWRlZW1Bc3NldC50ZXh0Q29udGVudCA9IHFVbml0XG4gICAgfVxuXG4gICAgY29uc3QgcmF0ZSA9IGFwcCgpLmNvbnZlbnRpb25hbFJhdGUodGhpcy5vcmRlci5iYXNlSUQsIHRoaXMub3JkZXIucXVvdGVJRCwgbWF0Y2gucmF0ZSlcbiAgICB0bXBsLnJhdGUudGV4dENvbnRlbnQgPSBgJHtyYXRlfSAke2JVbml0fS8ke3FVbml0fWBcblxuICAgIGlmICh0aGlzLm9yZGVyLnNlbGwpIHtcbiAgICAgIHRtcGwucmVmdW5kQXNzZXQudGV4dENvbnRlbnQgPSBiYXNlU3ltYm9sXG4gICAgICB0bXBsLmZyb21BbW91bnQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG1hdGNoLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgdG1wbC50b0Ftb3VudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocXVvdGVBbW91bnQsIHF1b3RlVW5pdEluZm8pXG4gICAgICB0bXBsLmZyb21JY29uLnNyYyA9IERvYy5sb2dvUGF0aEZyb21JRCh0aGlzLm9yZGVyLmJhc2VJRClcbiAgICAgIHRtcGwudG9JY29uLnNyYyA9IERvYy5sb2dvUGF0aEZyb21JRCh0aGlzLm9yZGVyLnF1b3RlSUQpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRtcGwucmVmdW5kQXNzZXQudGV4dENvbnRlbnQgPSBxdW90ZVN5bWJvbFxuICAgICAgdG1wbC5mcm9tQW1vdW50LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShxdW90ZUFtb3VudCwgcXVvdGVVbml0SW5mbylcbiAgICAgIHRtcGwudG9BbW91bnQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG1hdGNoLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgdG1wbC5mcm9tSWNvbi5zcmMgPSBEb2MubG9nb1BhdGhGcm9tSUQodGhpcy5vcmRlci5xdW90ZUlEKVxuICAgICAgdG1wbC50b0ljb24uc3JjID0gRG9jLmxvZ29QYXRoRnJvbUlEKHRoaXMub3JkZXIuYmFzZUlEKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIHNldE11dGFibGVNYXRjaENhcmRFbGVtZW50cyBzZXRzIHRoZSBtYXRjaCBjYXJkIGVsZW1lbnRzIHdoaWNoIG1heSBnZXRcbiAgICogdXBkYXRlZCBvbiBlYWNoIHVwZGF0ZSB0byB0aGUgbWF0Y2guXG4gICAqL1xuICBzZXRNdXRhYmxlTWF0Y2hDYXJkRWxlbWVudHMgKG1hdGNoQ2FyZDogSFRNTEVsZW1lbnQsIG06IE1hdGNoKSB7XG4gICAgaWYgKG0uaXNDYW5jZWwpIHJldHVyblxuXG4gICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKG1hdGNoQ2FyZClcbiAgICB0bXBsLnN0YXR1cy50ZXh0Q29udGVudCA9IE9yZGVyVXRpbC5tYXRjaFN0YXR1c1N0cmluZyhtKVxuXG4gICAgY29uc3QgdHJ5U2hvd0NvaW4gPSAocGVuZGluZ0VsOiBQYWdlRWxlbWVudCwgY29pbkxpbms6IFBhZ2VFbGVtZW50LCBjb2luOiBDb2luKSA9PiB7XG4gICAgICBpZiAoIWNvaW4pIHtcbiAgICAgICAgRG9jLmhpZGUoY29pbkxpbmspXG4gICAgICAgIERvYy5zaG93KHBlbmRpbmdFbClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb2luTGluay50ZXh0Q29udGVudCA9IGZvcm1hdENvaW5JRChjb2luLnN0cmluZ0lEKVxuICAgICAgY29pbkxpbmsuZGF0YXNldC5leHBsb3JlckNvaW4gPSBjb2luLnN0cmluZ0lEXG4gICAgICBzZXRDb2luSHJlZihjb2luLmFzc2V0SUQsIGNvaW5MaW5rKVxuICAgICAgRG9jLnNob3coY29pbkxpbmspXG4gICAgICBEb2MuaGlkZShwZW5kaW5nRWwpXG4gICAgfVxuXG4gICAgdHJ5U2hvd0NvaW4odG1wbC5tYWtlclN3YXBQZW5kaW5nLCB0bXBsLm1ha2VyU3dhcENvaW4sIG1ha2VyU3dhcENvaW4obSkpXG4gICAgdHJ5U2hvd0NvaW4odG1wbC50YWtlclN3YXBQZW5kaW5nLCB0bXBsLnRha2VyU3dhcENvaW4sIHRha2VyU3dhcENvaW4obSkpXG4gICAgdHJ5U2hvd0NvaW4odG1wbC5tYWtlclJlZGVlbVBlbmRpbmcsIHRtcGwubWFrZXJSZWRlZW1Db2luLCBtYWtlclJlZGVlbUNvaW4obSkpXG4gICAgdHJ5U2hvd0NvaW4odG1wbC50YWtlclJlZGVlbVBlbmRpbmcsIHRtcGwudGFrZXJSZWRlZW1Db2luLCB0YWtlclJlZGVlbUNvaW4obSkpXG4gICAgaWYgKCFtLnJlZnVuZCkge1xuICAgICAgLy8gU3BlY2lhbCBtZXNzYWdpbmcgZm9yIHBlbmRpbmcgcmVmdW5kcy5cbiAgICAgIGxldCBsb2NrVGltZSA9IGxvY2tUaW1lTWFrZXJNc1xuICAgICAgaWYgKG0uc2lkZSA9PT0gT3JkZXJVdGlsLlRha2VyKSBsb2NrVGltZSA9IGxvY2tUaW1lVGFrZXJNc1xuICAgICAgY29uc3QgcmVmdW5kQWZ0ZXIgPSBuZXcgRGF0ZShtLnN0YW1wICsgbG9ja1RpbWUpXG4gICAgICBpZiAoRGF0ZS5ub3coKSA+IHJlZnVuZEFmdGVyLmdldFRpbWUoKSkgdG1wbC5yZWZ1bmRQZW5kaW5nLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfUkVGVU5EX0lNTUlORU5UKVxuICAgICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHJlZnVuZEFmdGVyU3RyID0gcmVmdW5kQWZ0ZXIudG9Mb2NhbGVUaW1lU3RyaW5nKERvYy5sYW5ndWFnZXMoKSwge1xuICAgICAgICAgIHllYXI6ICdudW1lcmljJyxcbiAgICAgICAgICBtb250aDogJ3Nob3J0JyxcbiAgICAgICAgICBkYXk6ICdudW1lcmljJ1xuICAgICAgICB9KVxuICAgICAgICB0bXBsLnJlZnVuZFBlbmRpbmcudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9SRUZVTkRfV0lMTF9IQVBQRU5fQUZURVIsIHsgcmVmdW5kQWZ0ZXJUaW1lOiByZWZ1bmRBZnRlclN0ciB9KVxuICAgICAgfVxuICAgICAgRG9jLmhpZGUodG1wbC5yZWZ1bmRDb2luKVxuICAgICAgRG9jLnNob3codG1wbC5yZWZ1bmRQZW5kaW5nKVxuICAgIH0gZWxzZSB7XG4gICAgICB0bXBsLnJlZnVuZENvaW4udGV4dENvbnRlbnQgPSBmb3JtYXRDb2luSUQobS5yZWZ1bmQuc3RyaW5nSUQpXG4gICAgICB0bXBsLnJlZnVuZENvaW4uZGF0YXNldC5leHBsb3JlckNvaW4gPSBtLnJlZnVuZC5zdHJpbmdJRFxuICAgICAgc2V0Q29pbkhyZWYobS5yZWZ1bmQuYXNzZXRJRCwgdG1wbC5yZWZ1bmRDb2luKVxuICAgICAgRG9jLnNob3codG1wbC5yZWZ1bmRDb2luKVxuICAgICAgRG9jLmhpZGUodG1wbC5yZWZ1bmRQZW5kaW5nKVxuICAgIH1cblxuICAgIGlmIChtLnN0YXR1cyA9PT0gT3JkZXJVdGlsLk1ha2VyU3dhcENhc3QgJiYgIW0ucmV2b2tlZCAmJiAhbS5yZWZ1bmQpIHtcbiAgICAgIGNvbnN0IGMgPSBtYWtlclN3YXBDb2luKG0pXG4gICAgICB0bXBsLm1ha2VyU3dhcE1zZy50ZXh0Q29udGVudCA9IGNvbmZpcm1hdGlvblN0cmluZyhjKVxuICAgICAgRG9jLmhpZGUodG1wbC50YWtlclN3YXBNc2csIHRtcGwubWFrZXJSZWRlZW1Nc2csIHRtcGwudGFrZXJSZWRlZW1Nc2cpXG4gICAgICBEb2Muc2hvdyh0bXBsLm1ha2VyU3dhcE1zZylcbiAgICB9IGVsc2UgaWYgKG0uc3RhdHVzID09PSBPcmRlclV0aWwuVGFrZXJTd2FwQ2FzdCAmJiAhbS5yZXZva2VkICYmICFtLnJlZnVuZCkge1xuICAgICAgY29uc3QgYyA9IHRha2VyU3dhcENvaW4obSlcbiAgICAgIHRtcGwudGFrZXJTd2FwTXNnLnRleHRDb250ZW50ID0gY29uZmlybWF0aW9uU3RyaW5nKGMpXG4gICAgICBEb2MuaGlkZSh0bXBsLm1ha2VyU3dhcE1zZywgdG1wbC5tYWtlclJlZGVlbU1zZywgdG1wbC50YWtlclJlZGVlbU1zZylcbiAgICAgIERvYy5zaG93KHRtcGwudGFrZXJTd2FwTXNnKVxuICAgIH0gZWxzZSBpZiAoaW5Db25maXJtaW5nTWFrZXJSZWRlZW0obSkgJiYgIW0ucmV2b2tlZCAmJiAhbS5yZWZ1bmQpIHtcbiAgICAgIHRtcGwubWFrZXJSZWRlZW1Nc2cudGV4dENvbnRlbnQgPSBjb25maXJtYXRpb25TdHJpbmcobS5yZWRlZW0pXG4gICAgICBEb2MuaGlkZSh0bXBsLm1ha2VyU3dhcE1zZywgdG1wbC50YWtlclN3YXBNc2csIHRtcGwudGFrZXJSZWRlZW1Nc2cpXG4gICAgICBEb2Muc2hvdyh0bXBsLm1ha2VyUmVkZWVtTXNnKVxuICAgIH0gZWxzZSBpZiAoaW5Db25maXJtaW5nVGFrZXJSZWRlZW0obSkgJiYgIW0ucmV2b2tlZCAmJiAhbS5yZWZ1bmQpIHtcbiAgICAgIHRtcGwudGFrZXJSZWRlZW1Nc2cudGV4dENvbnRlbnQgPSBjb25maXJtYXRpb25TdHJpbmcobS5yZWRlZW0pXG4gICAgICBEb2MuaGlkZSh0bXBsLm1ha2VyU3dhcE1zZywgdG1wbC50YWtlclN3YXBNc2csIHRtcGwubWFrZXJSZWRlZW1Nc2cpXG4gICAgICBEb2Muc2hvdyh0bXBsLnRha2VyUmVkZWVtTXNnKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2MuaGlkZSh0bXBsLm1ha2VyU3dhcE1zZywgdG1wbC50YWtlclN3YXBNc2csIHRtcGwubWFrZXJSZWRlZW1Nc2csIHRtcGwudGFrZXJSZWRlZW1Nc2cpXG4gICAgfVxuXG4gICAgaWYgKCFtLnJldm9rZWQpIHtcbiAgICAgIC8vIE1hdGNoIGlzIHN0aWxsIGZvbGxvd2luZyB0aGUgdXN1YWwgc3VjY2Vzcy1wYXRoLCBpdCBpcyBkZXNpcmFibGUgZm9yIHRoZVxuICAgICAgLy8gdXNlciB0byBzZWUgaXQgaW4gZnVsbCAoZXZlbiBpZiB0byBsZWFybiBob3cgYXRvbWljIHN3YXAgaXMgc3VwcG9zZWQgdG9cbiAgICAgIC8vIHdvcmspLlxuXG4gICAgICBEb2Muc2V0VmlzKG1ha2VyU3dhcENvaW4obSkgfHwgbS5hY3RpdmUsIHRtcGwubWFrZXJTd2FwKVxuICAgICAgRG9jLnNldFZpcyh0YWtlclN3YXBDb2luKG0pIHx8IG0uYWN0aXZlLCB0bXBsLnRha2VyU3dhcClcbiAgICAgIERvYy5zZXRWaXMobWFrZXJSZWRlZW1Db2luKG0pIHx8IG0uYWN0aXZlLCB0bXBsLm1ha2VyUmVkZWVtKVxuICAgICAgLy8gV2hlbiBtYWtlciBpc24ndCBhd2FyZSBvZiB0YWtlciByZWRlZW0gY29pbiwgb25jZSB0aGUgbWF0Y2ggYmVjb21lcyBpbmFjdGl2ZVxuICAgICAgLy8gKG5vdGhpbmcgZWxzZSBtYWtlciBpcyBleHBlY3RlZCB0byBkbyBpbiB0aGlzIG1hdGNoKSBqdXN0IGhpZGUgdGFrZXIgcmVkZWVtLlxuICAgICAgRG9jLnNldFZpcyh0YWtlclJlZGVlbUNvaW4obSkgfHwgbS5hY3RpdmUsIHRtcGwudGFrZXJSZWRlZW0pXG4gICAgICAvLyBSZWZ1bmRpbmcgaXNuJ3QgYSB1c3VhbCBwYXJ0IG9mIHN1Y2Nlc3MtcGF0aCwgYnV0IGRvbid0IHJ1bGUgaXQgb3V0LlxuICAgICAgRG9jLnNldFZpcyhtLnJlZnVuZCwgdG1wbC5yZWZ1bmQpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE1hdGNoIGRpdmVyZ2VkIGZyb20gdGhlIHVzdWFsIHN1Y2Nlc3MtcGF0aCwgc2luY2UgdGhpcyBjb3VsZCBoYXZlIGhhcHBlbmVkXG4gICAgICAvLyBhdCBhbnkgc3RlcCBpdCBpcyBoYXJkIChtYXliZSBpbXBvc3NpYmxlKSB0byBwcmVkaWN0IHRoZSBmaW5hbCBzdGF0ZSB0aGlzXG4gICAgICAvLyBtYXRjaCB3aWxsIGVuZCB1cCBpbiwgc28gc2hvdyBvbmx5IHN0ZXBzIHRoYXQgYWxyZWFkeSBoYXBwZW5lZCBwbHVzIGFsbFxuICAgICAgLy8gdGhlIHBvc3NpYmlsaXRpZXMgb24gdGhlIG5leHQgc3RlcCBhaGVhZC5cblxuICAgICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBzd2FwIGNvaW5zIGFmdGVyIHJldm9jYXRpb24sIHdlIHdvbid0IHNob3cgdGhlIHBlbmRpbmcgbWVzc2FnZS5cbiAgICAgIERvYy5zZXRWaXMobWFrZXJTd2FwQ29pbihtKSwgdG1wbC5tYWtlclN3YXApXG4gICAgICBEb2Muc2V0VmlzKHRha2VyU3dhcENvaW4obSksIHRtcGwudGFrZXJTd2FwKVxuICAgICAgY29uc3QgdGFrZXJSZWZ1bmRzQWZ0ZXIgPSBuZXcgRGF0ZShtLnN0YW1wICsgbG9ja1RpbWVUYWtlck1zKVxuICAgICAgY29uc3QgdGFrZXJMb2NrVGltZUV4cGlyZWQgPSBEYXRlLm5vdygpID4gdGFrZXJSZWZ1bmRzQWZ0ZXIuZ2V0VGltZSgpXG4gICAgICAvLyBXaGVuIG1hdGNoIGlzIHJldm9rZWQgYW5kIGJvdGggc3dhcHMgYXJlIHByZXNlbnQsIG1ha2VyIHJlZGVlbSBtaWdodCBzdGlsbCBzaG93IHVwOlxuICAgICAgLy8gLSBhcyBtYWtlciwgd2UnbGwgdHJ5IHRvIHJlZGVlbSB1bnRpbCB0YWtlciBsb2NrdGltZSBleHBpcmVzIChpZiB0YWtlciByZWZ1bmRzXG4gICAgICAvLyAgIHdlIHdvbid0IGJlIGFibGUgdG8gcmVkZWVtOyBldmVuIGlmIHRha2VyIGhhc24ndCByZWZ1bmRlZCBqdXN0IHlldCAtIGl0XG4gICAgICAvLyAgIGJlY29tZXMgdG9vIGRhbmdlcm91cyB0byByZWRlZW0gYWZ0ZXIgdGFrZXIgbG9ja3RpbWUgZXhwaXJlZCBiZWNhdXNlIG1ha2VyXG4gICAgICAvLyAgIHJldmVhbHMgaGlzIHNlY3JldCB3aGVuIHJlZGVlbWluZywgYW5kIHRha2VyIG1pZ2h0IGJlIGFibGUgdG8gc3VibWl0IGJvdGhcbiAgICAgIC8vICAgcmVkZWVtIGFuZCByZWZ1bmQgdHJhbnNhY3Rpb25zIGJlZm9yZSBtYWtlcidzIHJlZGVlbSBnZXRzIG1pbmVkKSwgc28gd2UnbGxcbiAgICAgIC8vICAgaGF2ZSB0byBzaG93IHJlZGVlbSBwZW5kaW5nIGVsZW1lbnQgdW50aWwgbWFrZXIgcmVkZWVtIHNob3dzIHVwLCBvciB1bnRpbFxuICAgICAgLy8gICB3ZSBnaXZlIHVwIG9uIHJlZGVlbWluZyBkdWUgdG8gdGFrZXIgbG9ja3RpbWUgZXhwaXJ5LlxuICAgICAgLy8gLSBhcyB0YWtlciwgd2Ugc2hvdWxkIGV4cGVjdCBtYWtlciByZWRlZW1pbmcgYW55IHRpbWUsIHNvIHdlJ2xsIGhhdmUgdG8gc2hvd1xuICAgICAgLy8gICByZWRlZW0gcGVuZGluZyBlbGVtZW50IHVudGlsIG1ha2VyIHJlZGVlbSBzaG93cyB1cCwgb3IgdW50aWwgd2UgcmVmdW5kLlxuICAgICAgRG9jLnNldFZpcyhtYWtlclJlZGVlbUNvaW4obSkgfHwgKHRha2VyU3dhcENvaW4obSkgJiYgbS5hY3RpdmUgJiYgIW0ucmVmdW5kICYmICF0YWtlckxvY2tUaW1lRXhwaXJlZCksIHRtcGwubWFrZXJSZWRlZW0pXG4gICAgICAvLyBXaGVuIG1ha2VyIGlzbid0IGF3YXJlIG9mIHRha2VyIHJlZGVlbSBjb2luLCBvbmNlIHRoZSBtYXRjaCBiZWNvbWVzIGluYWN0aXZlXG4gICAgICAvLyAobm90aGluZyBlbHNlIG1ha2VyIGlzIGV4cGVjdGVkIHRvIGRvIGluIHRoaXMgbWF0Y2gpIGp1c3QgaGlkZSB0YWtlciByZWRlZW0uXG4gICAgICBEb2Muc2V0VmlzKHRha2VyUmVkZWVtQ29pbihtKSB8fCAobWFrZXJSZWRlZW1Db2luKG0pICYmIG0uYWN0aXZlICYmICFtLnJlZnVuZCksIHRtcGwudGFrZXJSZWRlZW0pXG4gICAgICAvLyBBcyB0YWtlciwgc2hvdyByZWZ1bmQgcGxhY2Vob2xkZXIgb25seSBpZiB3ZSBoYXZlIG91dHN0YW5kaW5nIHN3YXAgdG8gcmVmdW5kLlxuICAgICAgLy8gVGhlcmUgaXMgbm8gbmVlZCB0byB3YWl0IGZvciBhbnl0aGluZyBlbHNlLCB3ZSBjYW4gc2hvdyByZWZ1bmQgcGxhY2Vob2xkZXJcbiAgICAgIC8vICh0byBpbmZvcm0gdGhlIHVzZXIgdGhhdCBpdCBpcyBsaWtlbHkgdG8gaGFwcGVuKSByaWdodCBhZnRlciBtYXRjaCByZXZvY2F0aW9uLlxuICAgICAgbGV0IGV4cGVjdGluZ1JlZnVuZCA9IEJvb2xlYW4odGFrZXJTd2FwQ29pbihtKSkgLy8gYXMgdGFrZXJcbiAgICAgIGlmIChtLnNpZGUgPT09IE9yZGVyVXRpbC5NYWtlcikge1xuICAgICAgICAvLyBBcyBtYWtlciwgc2hvdyByZWZ1bmQgcGxhY2Vob2xkZXIgb25seSBpZiB3ZSBoYXZlIG91dHN0YW5kaW5nIHN3YXAgdG8gcmVmdW5kLlxuICAgICAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIHRha2VyIHN3YXAgdGhlcmUgaXMgbm8gbmVlZCB0byB3YWl0IGZvciBhbnl0aGluZyBlbHNlLCB3ZVxuICAgICAgICAvLyBjYW4gc2hvdyByZWZ1bmQgcGxhY2Vob2xkZXIgKHRvIGluZm9ybSB0aGUgdXNlciB0aGF0IGl0IGlzIGxpa2VseSB0byBoYXBwZW4pXG4gICAgICAgIC8vIHJpZ2h0IGFmdGVyIG1hdGNoIHJldm9jYXRpb24uXG4gICAgICAgIGV4cGVjdGluZ1JlZnVuZCA9IEJvb2xlYW4obWFrZXJTd2FwQ29pbihtKSlcbiAgICAgICAgLy8gSWYgd2UgZGlzY292ZXIgdGFrZXIgc3dhcCB3ZSdsbCBiZSB0cnlpbmcgdG8gcmVkZWVtIGl0IChpbnN0ZWFkIG9mIHRyeWluZ1xuICAgICAgICAvLyB0byByZWZ1bmQgb3VyIG93biBzd2FwKSB1bnRpbCB0YWtlciByZWZ1bmRzLCBzbyBzdGFydCBzaG93aW5nIHJlZnVuZFxuICAgICAgICAvLyBwbGFjZWhvbGRlciBvbmx5IGFmdGVyIHRha2VyIGlzIGV4cGVjdGVkIHRvIHN0YXJ0IGhpcyByZWZ1bmQgcHJvY2VzcyBpblxuICAgICAgICAvLyB0aGlzIGNhc2UuXG4gICAgICAgIGlmICh0YWtlclN3YXBDb2luKG0pKSB7XG4gICAgICAgICAgZXhwZWN0aW5nUmVmdW5kID0gZXhwZWN0aW5nUmVmdW5kICYmIHRha2VyTG9ja1RpbWVFeHBpcmVkXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIERvYy5zZXRWaXMobS5yZWZ1bmQgfHwgKG0uYWN0aXZlICYmICFtLnJlZGVlbSAmJiAhbS5jb3VudGVyUmVkZWVtICYmIGV4cGVjdGluZ1JlZnVuZCksIHRtcGwucmVmdW5kKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGFkZE5ld01hdGNoQ2FyZCBhZGRzIGEgbmV3IGNhcmQgdG8gdGhlIGxpc3Qgb2YgbWF0Y2ggY2FyZHMuXG4gICAqL1xuICBhZGROZXdNYXRjaENhcmQgKG1hdGNoOiBNYXRjaCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBtYXRjaENhcmQgPSBwYWdlLm1hdGNoQ2FyZFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgYXBwKCkuYmluZFVybEhhbmRsZXJzKG1hdGNoQ2FyZClcbiAgICBtYXRjaENhcmQuZGF0YXNldC5tYXRjaElEID0gbWF0Y2gubWF0Y2hJRFxuICAgIHRoaXMuc2V0SW1tdXRhYmxlTWF0Y2hDYXJkRWxlbWVudHMobWF0Y2hDYXJkLCBtYXRjaClcbiAgICB0aGlzLnNldE11dGFibGVNYXRjaENhcmRFbGVtZW50cyhtYXRjaENhcmQsIG1hdGNoKVxuICAgIHBhZ2UubWF0Y2hCb3guYXBwZW5kQ2hpbGQobWF0Y2hDYXJkKVxuICB9XG5cbiAgLypcbiAgICogc2hvd01hdGNoQ2FyZHMgY3JlYXRlcyBjYXJkcyBmb3IgZWFjaCBtYXRjaCBpbiB0aGUgb3JkZXIuXG4gICAqL1xuICBzaG93TWF0Y2hDYXJkcyAoKSB7XG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLm9yZGVyXG4gICAgaWYgKCFvcmRlcikgcmV0dXJuXG4gICAgaWYgKCFvcmRlci5tYXRjaGVzKSByZXR1cm5cbiAgICBvcmRlci5tYXRjaGVzLnNvcnQoKGEsIGIpID0+IGEuc3RhbXAgLSBiLnN0YW1wKVxuICAgIG9yZGVyLm1hdGNoZXMuZm9yRWFjaCgobWF0Y2gpID0+IHRoaXMuYWRkTmV3TWF0Y2hDYXJkKG1hdGNoKSlcbiAgfVxuXG4gIC8qIHNob3dDYW5jZWwgc2hvd3MgYSBmb3JtIHRvIGNvbmZpcm0gc3VibWlzc2lvbiBvZiBhIGNhbmNlbCBvcmRlci4gKi9cbiAgc2hvd0NhbmNlbCAoKSB7XG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLm9yZGVyXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IHJlbWFpbmluZyA9IG9yZGVyLnF0eSAtIG9yZGVyLmZpbGxlZFxuICAgIGNvbnN0IGFzc2V0ID0gT3JkZXJVdGlsLmlzTWFya2V0QnV5KG9yZGVyKSA/IGFwcCgpLmFzc2V0c1tvcmRlci5xdW90ZUlEXSA6IGFwcCgpLmFzc2V0c1tvcmRlci5iYXNlSURdXG4gICAgcGFnZS5jYW5jZWxSZW1haW4udGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlbWFpbmluZywgYXNzZXQudW5pdEluZm8pXG4gICAgcGFnZS5jYW5jZWxVbml0LnRleHRDb250ZW50ID0gYXNzZXQudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQudG9VcHBlckNhc2UoKVxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5jYW5jZWxGb3JtKVxuICB9XG5cbiAgLyogc2hvd0Zvcm0gc2hvd3MgYSBtb2RhbCBmb3JtIHdpdGggYSBsaXR0bGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBzaG93Rm9ybSAoZm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gZm9ybVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmNhbmNlbEZvcm0sIHBhZ2UuYWNjZWxlcmF0ZUZvcm0pXG4gICAgZm9ybS5zdHlsZS5yaWdodCA9ICcxMDAwMHB4J1xuICAgIERvYy5zaG93KHBhZ2UuZm9ybXMsIGZvcm0pXG4gICAgY29uc3Qgc2hpZnQgPSAocGFnZS5mb3Jtcy5vZmZzZXRXaWR0aCArIGZvcm0ub2Zmc2V0V2lkdGgpIC8gMlxuICAgIGF3YWl0IERvYy5hbmltYXRlKGFuaW1hdGlvbkxlbmd0aCwgcHJvZ3Jlc3MgPT4ge1xuICAgICAgZm9ybS5zdHlsZS5yaWdodCA9IGAkeygxIC0gcHJvZ3Jlc3MpICogc2hpZnR9cHhgXG4gICAgfSwgJ2Vhc2VPdXRIYXJkJylcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzBweCdcbiAgfVxuXG4gIC8qIHN1Ym1pdENhbmNlbCBzdWJtaXRzIGEgY2FuY2VsbGF0aW9uIGZvciB0aGUgb3JkZXIuICovXG4gIGFzeW5jIHN1Ym1pdENhbmNlbCAoKSB7XG4gICAgLy8gdGhpcyB3aWxsIGJlIHRoZSBwYWdlLmNhbmNlbFN1Ym1pdCBidXR0b24gKGV2dC5jdXJyZW50VGFyZ2V0KVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBvcmRlciA9IHRoaXMub3JkZXJcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBvcmRlcklEOiBvcmRlci5pZFxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuY2FuY2VsRm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9jYW5jZWwnLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkgcmV0dXJuXG4gICAgcGFnZS5zdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9DQU5DRUxJTkcpXG4gICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICBvcmRlci5jYW5jZWxsaW5nID0gdHJ1ZVxuICB9XG5cbiAgLypcbiAgICogc2V0QWNjZWxlcmF0aW9uQnV0dG9uVmlzIHNob3dzIHRoZSBhY2NlbGVyYXRpb24gYnV0dG9uIGlmIHRoZSBvcmRlciBjYW5cbiAgICogYmUgYWNjZWxlcmF0ZWQuXG4gICAqL1xuICBzZXRBY2NlbGVyYXRpb25CdXR0b25WaXMgKCkge1xuICAgIGNvbnN0IG9yZGVyID0gdGhpcy5vcmRlclxuICAgIGlmICghb3JkZXIpIHJldHVyblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2Muc2V0VmlzKGFwcCgpLmNhbkFjY2VsZXJhdGVPcmRlcihvcmRlciksIHBhZ2UuYWNjZWxlcmF0ZUJ0dG4sIHBhZ2UuYWN0aW9uc0xhYmVsKVxuICB9XG5cbiAgLyogc2hvd0FjY2VsZXJhdGVGb3JtIHNob3dzIGEgZm9ybSB0byBhY2NlbGVyYXRlIGFuIG9yZGVyICovXG4gIGFzeW5jIHNob3dBY2NlbGVyYXRlRm9ybSAoKSB7XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLnBhZ2UuYWNjZWxlcmF0ZUJ0dG4pXG4gICAgdGhpcy5hY2NlbGVyYXRlT3JkZXJGb3JtLnJlZnJlc2godGhpcy5vcmRlcilcbiAgICBsb2FkZWQoKVxuICAgIHRoaXMuc2hvd0Zvcm0odGhpcy5wYWdlLmFjY2VsZXJhdGVGb3JtKVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlT3JkZXJOb3RlIGlzIHRoZSBoYW5kbGVyIGZvciB0aGUgJ29yZGVyJy10eXBlIG5vdGlmaWNhdGlvbiwgd2hpY2ggYXJlXG4gICAqIHVzZWQgdG8gdXBkYXRlIGFuIG9yZGVyJ3Mgc3RhdHVzLlxuICAgKi9cbiAgaGFuZGxlT3JkZXJOb3RlIChub3RlOiBPcmRlck5vdGUpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3Qgb3JkZXIgPSBub3RlLm9yZGVyXG4gICAgaWYgKG9yZGVyLmlkICE9PSB0aGlzLm9yZGVySUQpIHJldHVyblxuICAgIHRoaXMub3JkZXIgPSBvcmRlclxuICAgIGNvbnN0IGJ0dG4gPSBwYWdlLmNhbmNlbEJ0dG5cbiAgICBpZiAoYnR0biAmJiBvcmRlci5zdGF0dXMgPiBPcmRlclV0aWwuU3RhdHVzQm9va2VkKSBEb2MuaGlkZShidHRuKVxuICAgIHBhZ2Uuc3RhdHVzLnRleHRDb250ZW50ID0gT3JkZXJVdGlsLnN0YXR1c1N0cmluZyhvcmRlcilcbiAgICBmb3IgKGNvbnN0IG0gb2Ygb3JkZXIubWF0Y2hlcyB8fCBbXSkgdGhpcy5wcm9jZXNzTWF0Y2gobSlcbiAgICB0aGlzLnNldEFjY2VsZXJhdGlvbkJ1dHRvblZpcygpXG4gIH1cblxuICAvKiBoYW5kbGVNYXRjaE5vdGUgaGFuZGxlcyBhICdtYXRjaCcgbm90aWZpY2F0aW9uLiAqL1xuICBoYW5kbGVNYXRjaE5vdGUgKG5vdGU6IE1hdGNoTm90ZSkge1xuICAgIGlmIChub3RlLm9yZGVySUQgIT09IHRoaXMub3JkZXJJRCkgcmV0dXJuXG4gICAgdGhpcy5wcm9jZXNzTWF0Y2gobm90ZS5tYXRjaClcbiAgICB0aGlzLnNldEFjY2VsZXJhdGlvbkJ1dHRvblZpcygpXG4gIH1cblxuICAvKlxuICAgKiBwcm9jZXNzTWF0Y2ggc3luY2hyb25pemVzIGEgbWF0Y2gncyBjYXJkIHdpdGggYSBtYXRjaCByZWNlaXZlZCBpbiBhXG4gICAqICdvcmRlcicgb3IgJ21hdGNoJyBub3RpZmljYXRpb24uXG4gICAqL1xuICBwcm9jZXNzTWF0Y2ggKG06IE1hdGNoKSB7XG4gICAgbGV0IGNhcmQ6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGxcbiAgICBmb3IgKGNvbnN0IGRpdiBvZiBEb2MuYXBwbHlTZWxlY3Rvcih0aGlzLnBhZ2UubWF0Y2hCb3gsICcubWF0Y2gtY2FyZCcpKSB7XG4gICAgICBpZiAoZGl2LmRhdGFzZXQubWF0Y2hJRCA9PT0gbS5tYXRjaElEKSB7XG4gICAgICAgIGNhcmQgPSBkaXZcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNhcmQpIHtcbiAgICAgIHRoaXMuc2V0TXV0YWJsZU1hdGNoQ2FyZEVsZW1lbnRzKGNhcmQsIG0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWRkTmV3TWF0Y2hDYXJkKG0pXG4gICAgfVxuICB9XG59XG5cbi8qXG4gKiBjb25maXJtYXRpb25TdHJpbmcgaXMgYSBzdHJpbmcgZGVzY3JpYmluZyB0aGUgc3RhdGUgb2YgY29uZmlybWF0aW9ucyBmb3IgYVxuICogY29pbi5cbiAqICovXG5mdW5jdGlvbiBjb25maXJtYXRpb25TdHJpbmcgKGNvaW46IENvaW4pIHtcbiAgaWYgKCFjb2luLmNvbmZzIHx8IGNvaW4uY29uZnMucmVxdWlyZWQgPT09IDApIHJldHVybiAnJ1xuICByZXR1cm4gYCR7Y29pbi5jb25mcy5jb3VudH0gLyAke2NvaW4uY29uZnMucmVxdWlyZWR9ICR7aW50bC5wcmVwKGludGwuSURfQ09ORklSTUFUSU9OUyl9YFxufVxuXG4vLyBtYWtlclN3YXBDb2luIHJldHVybidzIHRoZSBtYWtlcidzIHN3YXAgY29pbi5cbmZ1bmN0aW9uIG1ha2VyU3dhcENvaW4gKG06IE1hdGNoKSA6IENvaW4ge1xuICByZXR1cm4gKG0uc2lkZSA9PT0gT3JkZXJVdGlsLk1ha2VyKSA/IG0uc3dhcCA6IG0uY291bnRlclN3YXBcbn1cblxuLy8gdGFrZXJTd2FwQ29pbiByZXR1cm4ncyB0aGUgdGFrZXIncyBzd2FwIGNvaW4uXG5mdW5jdGlvbiB0YWtlclN3YXBDb2luIChtOiBNYXRjaCkge1xuICByZXR1cm4gKG0uc2lkZSA9PT0gT3JkZXJVdGlsLk1ha2VyKSA/IG0uY291bnRlclN3YXAgOiBtLnN3YXBcbn1cblxuLy8gbWFrZXJSZWRlZW1Db2luIHJldHVybidzIHRoZSBtYWtlcidzIHJlZGVlbSBjb2luLlxuZnVuY3Rpb24gbWFrZXJSZWRlZW1Db2luIChtOiBNYXRjaCkge1xuICByZXR1cm4gKG0uc2lkZSA9PT0gT3JkZXJVdGlsLk1ha2VyKSA/IG0ucmVkZWVtIDogbS5jb3VudGVyUmVkZWVtXG59XG5cbi8vIHRha2VyUmVkZWVtQ29pbiByZXR1cm4ncyB0aGUgdGFrZXIncyByZWRlZW0gY29pbi5cbmZ1bmN0aW9uIHRha2VyUmVkZWVtQ29pbiAobTogTWF0Y2gpIHtcbiAgcmV0dXJuIChtLnNpZGUgPT09IE9yZGVyVXRpbC5NYWtlcikgPyBtLmNvdW50ZXJSZWRlZW0gOiBtLnJlZGVlbVxufVxuXG4vKlxuKiBpbkNvbmZpcm1pbmdNYWtlclJlZGVlbSB3aWxsIGJlIHRydWUgaWYgd2UgYXJlIHRoZSBtYWtlciwgYW5kIHdlIGFyZSB3YWl0aW5nXG4qIG9uIGNvbmZpcm1hdGlvbnMgZm9yIG91ciBvd24gcmVkZWVtLlxuKi9cbmZ1bmN0aW9uIGluQ29uZmlybWluZ01ha2VyUmVkZWVtIChtOiBNYXRjaCkge1xuICByZXR1cm4gbS5zdGF0dXMgPCBPcmRlclV0aWwuTWF0Y2hDb25maXJtZWQgJiYgbS5zaWRlID09PSBPcmRlclV0aWwuTWFrZXIgJiYgbS5zdGF0dXMgPj0gT3JkZXJVdGlsLk1ha2VyUmVkZWVtZWRcbn1cblxuLypcbiogaW5Db25maXJtaW5nVGFrZXJSZWRlZW0gd2lsbCBiZSB0cnVlIGlmIHdlIGFyZSB0aGUgdGFrZXIsIGFuZCB3ZSBhcmUgd2FpdGluZ1xuKiBvbiBjb25maXJtYXRpb25zIGZvciBvdXIgb3duIHJlZGVlbS5cbiovXG5mdW5jdGlvbiBpbkNvbmZpcm1pbmdUYWtlclJlZGVlbSAobTogTWF0Y2gpIHtcbiAgcmV0dXJuIG0uc3RhdHVzIDwgT3JkZXJVdGlsLk1hdGNoQ29uZmlybWVkICYmIG0uc2lkZSA9PT0gT3JkZXJVdGlsLlRha2VyICYmIG0uc3RhdHVzID49IE9yZGVyVXRpbC5NYXRjaENvbXBsZXRlXG59XG4iLCJpbXBvcnQge1xuICBNYXJrZXRPcmRlckJvb2ssXG4gIE1pbmlPcmRlclxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPcmRlckJvb2sge1xuICBiYXNlOiBudW1iZXJcbiAgYmFzZVN5bWJvbDogc3RyaW5nXG4gIHF1b3RlOiBudW1iZXJcbiAgcXVvdGVTeW1ib2w6IHN0cmluZ1xuICBidXlzOiBNaW5pT3JkZXJbXVxuICBzZWxsczogTWluaU9yZGVyW11cblxuICBjb25zdHJ1Y3RvciAobWt0Qm9vazogTWFya2V0T3JkZXJCb29rLCBiYXNlU3ltYm9sOiBzdHJpbmcsIHF1b3RlU3ltYm9sOiBzdHJpbmcpIHtcbiAgICB0aGlzLmJhc2UgPSBta3RCb29rLmJhc2VcbiAgICB0aGlzLmJhc2VTeW1ib2wgPSBiYXNlU3ltYm9sXG4gICAgdGhpcy5xdW90ZSA9IG1rdEJvb2sucXVvdGVcbiAgICB0aGlzLnF1b3RlU3ltYm9sID0gcXVvdGVTeW1ib2xcbiAgICAvLyBCb29rcyBhcmUgc29ydGVkIG1pZC1nYXAgZmlyc3QuXG4gICAgdGhpcy5idXlzID0gbWt0Qm9vay5ib29rLmJ1eXMgfHwgW11cbiAgICB0aGlzLnNlbGxzID0gbWt0Qm9vay5ib29rLnNlbGxzIHx8IFtdXG4gIH1cblxuICAvKiBhZGQgYWRkcyBhbiBvcmRlciB0byB0aGUgb3JkZXIgYm9vay4gKi9cbiAgYWRkIChvcmQ6IE1pbmlPcmRlcikge1xuICAgIGlmIChvcmQucXR5QXRvbWljID09PSAwKSB7XG4gICAgICAvLyBUT0RPOiBTb21lYm9keSwgZm9yIHRoZSBsb3ZlIG9mIGdvZCwgZmlndXJlIG91dCB3aHkgdGhlIGhlbGwgdGhpcyBoZWxwc1xuICAgICAgLy8gd2l0aCB0aGUgZ2hvc3Qgb3JkZXJzIHByb2JsZW0uIEFzIGZhciBhcyBJIGtub3csIHRoaXMgb3JkZXIgaXMgYSBib29rZWRcbiAgICAgIC8vIG9yZGVyIHRoYXQgaGFkIG1vcmUgdGhhbiBvbmUgbWF0Y2ggaW4gYW4gZXBvY2ggYW5kIGNvbXBsZXRlbHkgZmlsbGVkLlxuICAgICAgLy8gQmVjYXVzZSB0aGUgZmlyc3QgbWF0Y2ggZGlkbid0IGV4aGF1c3QgdGhlIG9yZGVyLCB0aGVyZSB3b3VsZCBiZSBhXG4gICAgICAvLyAndXBkYXRlX3JlbWFpbmluZycgbm90aWZpY2F0aW9uIHNjaGVkdWxlZCBmb3IgdGhlIG9yZGVyLiBCdXQgYnkgdGhlXG4gICAgICAvLyB0aW1lIE9yZGVyUm91dGVyIGdlbmVyYXRlcyB0aGUgbm90aWZpY2F0aW9uIGxvbmcgYWZ0ZXIgbWF0Y2hpbmcsIHRoZVxuICAgICAgLy8gb3JkZXIgaGFzIHplcm8gcXR5IGxlZnQgdG8gZmlsbC4gSXQncyBhbGwgZ29vZCB0aG91Z2gsIGtpbmRhLCBiZWNhdXNlXG4gICAgICAvLyB0aGUgbm90aWZpY2F0aW9uIGlzIHF1aWNrbHkgZm9sbG93ZWQgd2l0aCBhbiAndW5ib29rX29yZGVyJ1xuICAgICAgLy8gbm90aWZpY2F0aW9uLiBJIGhhdmUgdHJpZWQgbXkgZGFtbmVkZXN0IHRvIGNhdGNoIGFuIHVwZGF0ZV9yZW1haW5pbmdcbiAgICAgIC8vIG5vdGUgd2l0aG91dCBhbiBhY2NvbXBhbnlpbmcgdW5ib29rX29yZGVyIG5vdGUsIGFuZCBoYXZlIHRodXMgZmFpbGVkLlxuICAgICAgLy8gWWV0LCB0aGlzIGZpeCBzb21laG93IHNlZW1zIHRvIHdvcmsuIEl0J3MgaW5mdXJpYXRpbmcsIHRiaC5cbiAgICAgIHdpbmRvdy5sb2coJ3plcm9xdHknLCAnemVybyBxdWFudGl0eSBvcmRlciBlbmNvdW50ZXJlZCcsIG9yZClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBzaWRlID0gb3JkLnNlbGwgPyB0aGlzLnNlbGxzIDogdGhpcy5idXlzXG4gICAgc2lkZS5zcGxpY2UoZmluZElkeChzaWRlLCBvcmQucmF0ZSwgIW9yZC5zZWxsKSwgMCwgb3JkKVxuICB9XG5cbiAgLyogcmVtb3ZlIHJlbW92ZXMgYW4gb3JkZXIgZnJvbSB0aGUgb3JkZXIgYm9vay4gKi9cbiAgcmVtb3ZlICh0b2tlbjogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMucmVtb3ZlRnJvbVNpZGUodGhpcy5zZWxscywgdG9rZW4pKSByZXR1cm5cbiAgICB0aGlzLnJlbW92ZUZyb21TaWRlKHRoaXMuYnV5cywgdG9rZW4pXG4gIH1cblxuICAvKiByZW1vdmVGcm9tU2lkZSByZW1vdmVzIGFuIG9yZGVyIGZyb20gdGhlIGxpc3Qgb2Ygb3JkZXJzLiAqL1xuICByZW1vdmVGcm9tU2lkZSAoc2lkZTogTWluaU9yZGVyW10sIHRva2VuOiBzdHJpbmcpIHtcbiAgICBjb25zdCBbb3JkLCBpXSA9IHRoaXMuZmluZE9yZGVyKHNpZGUsIHRva2VuKVxuICAgIGlmIChvcmQpIHtcbiAgICAgIHNpZGUuc3BsaWNlKGksIDEpXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIC8qIGZpbmRPcmRlciBmaW5kcyBhbiBvcmRlciBpbiBhIHNwZWNpZmllZCBzaWRlICovXG4gIGZpbmRPcmRlciAoc2lkZTogTWluaU9yZGVyW10sIHRva2VuOiBzdHJpbmcpOiBbTWluaU9yZGVyIHwgbnVsbCwgbnVtYmVyXSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaWRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoc2lkZVtpXS50b2tlbiA9PT0gdG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIFtzaWRlW2ldLCBpXVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gW251bGwsIC0xXVxuICB9XG5cbiAgLyogdXBkYXRlcyB0aGUgcmVtYWluaW5nIHF1YW50aXR5IG9mIGFuIG9yZGVyLiAqL1xuICB1cGRhdGVSZW1haW5pbmcgKHRva2VuOiBzdHJpbmcsIHF0eTogbnVtYmVyLCBxdHlBdG9taWM6IG51bWJlcikge1xuICAgIGlmICh0aGlzLnVwZGF0ZVJlbWFpbmluZ1NpZGUodGhpcy5zZWxscywgdG9rZW4sIHF0eSwgcXR5QXRvbWljKSkgcmV0dXJuXG4gICAgdGhpcy51cGRhdGVSZW1haW5pbmdTaWRlKHRoaXMuYnV5cywgdG9rZW4sIHF0eSwgcXR5QXRvbWljKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlUmVtYWluaW5nU2lkZSBsb29rcyBmb3IgdGhlIG9yZGVyIGluIHRoZSBzaWRlIGFuZCB1cGRhdGVzIHRoZVxuICAgKiBxdWFudGl0eSwgcmV0dXJuaW5nIHRydWUgb24gc3VjY2VzcywgZmFsc2UgaWYgb3JkZXIgbm90IGZvdW5kLlxuICAgKi9cbiAgdXBkYXRlUmVtYWluaW5nU2lkZSAoc2lkZTogTWluaU9yZGVyW10sIHRva2VuOiBzdHJpbmcsIHF0eTogbnVtYmVyLCBxdHlBdG9taWM6IG51bWJlcikge1xuICAgIGNvbnN0IG9yZCA9IHRoaXMuZmluZE9yZGVyKHNpZGUsIHRva2VuKVswXVxuICAgIGlmIChvcmQpIHtcbiAgICAgIG9yZC5xdHkgPSBxdHlcbiAgICAgIG9yZC5xdHlBdG9taWMgPSBxdHlBdG9taWNcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgLypcbiAgICogc2V0RXBvY2ggc2V0cyB0aGUgY3VycmVudCBlcG9jaCBhbmQgY2xlYXIgYW55IG9yZGVycyBmcm9tIHByZXZpb3VzIGVwb2Nocy5cbiAgICovXG4gIHNldEVwb2NoIChlcG9jaElkeDogbnVtYmVyKSB7XG4gICAgY29uc3QgYXBwcm92ZSA9IChvcmQ6IE1pbmlPcmRlcikgPT4gb3JkLmVwb2NoID09PSB1bmRlZmluZWQgfHwgb3JkLmVwb2NoID09PSAwIHx8IG9yZC5lcG9jaCA9PT0gZXBvY2hJZHhcbiAgICB0aGlzLnNlbGxzID0gdGhpcy5zZWxscy5maWx0ZXIoYXBwcm92ZSlcbiAgICB0aGlzLmJ1eXMgPSB0aGlzLmJ1eXMuZmlsdGVyKGFwcHJvdmUpXG4gIH1cblxuICAvKiBlbXB0eSB3aWxsIHJldHVybiB0cnVlIGlmIGJvdGggdGhlIGJ1eXMgYW5kIHNlbGxzIGxpc3RzIGFyZSBlbXB0eS4gKi9cbiAgZW1wdHkgKCkge1xuICAgIHJldHVybiAhdGhpcy5zZWxscy5sZW5ndGggJiYgIXRoaXMuYnV5cy5sZW5ndGhcbiAgfVxuXG4gIC8qIGNvdW50IGlzIHRoZSB0b3RhbCBjb3VudCBvZiBib3RoIGJ1eSBhbmQgc2VsbCBvcmRlcnMuICovXG4gIGNvdW50ICgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxscy5sZW5ndGggKyB0aGlzLmJ1eXMubGVuZ3RoXG4gIH1cblxuICAvKiBiZXN0R2FwT3JkZXIgd2lsbCByZXR1cm4gdGhlIGJlc3Qgbm9uLWVwb2NoIG9yZGVyIGlmIG9uZSBleGlzdHMsIG9yIHRoZVxuICAgKiBiZXN0IGVwb2NoIG9yZGVyIGlmIHRoZXJlIGFyZSBvbmx5IGVwb2NoIG9yZGVycywgb3IgbnVsbCBpZiB0aGVyZSBhcmUgbm9cbiAgICogb3JkZXJzLlxuICAgKi9cbiAgYmVzdEdhcE9yZGVyIChzaWRlOiBNaW5pT3JkZXJbXSkge1xuICAgIGxldCBiZXN0ID0gbnVsbFxuICAgIGZvciAoY29uc3Qgb3JkIG9mIHNpZGUpIHtcbiAgICAgIGlmICghb3JkLmVwb2NoKSByZXR1cm4gb3JkXG4gICAgICBpZiAoIWJlc3QpIHtcbiAgICAgICAgYmVzdCA9IG9yZFxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYmVzdFxuICB9XG5cbiAgYmVzdEdhcEJ1eSAoKSB7XG4gICAgcmV0dXJuIHRoaXMuYmVzdEdhcE9yZGVyKHRoaXMuYnV5cylcbiAgfVxuXG4gIGJlc3RHYXBTZWxsICgpIHtcbiAgICByZXR1cm4gdGhpcy5iZXN0R2FwT3JkZXIodGhpcy5zZWxscylcbiAgfVxufVxuXG4vKlxuICogZmluZElkeCBmaW5kIHRoZSBpbmRleCBhdCB3aGljaCB0byBpbnNlcnQgdGhlIG9yZGVyIGludG8gdGhlIGxpc3Qgb2Ygb3JkZXJzLlxuICovXG5mdW5jdGlvbiBmaW5kSWR4IChzaWRlOiBNaW5pT3JkZXJbXSwgcmF0ZTogbnVtYmVyLCBsZXNzOiBib29sZWFuKTogbnVtYmVyIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaWRlLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKChzaWRlW2ldLnJhdGUgPCByYXRlKSA9PT0gbGVzcykgcmV0dXJuIGlcbiAgfVxuICByZXR1cm4gc2lkZS5sZW5ndGhcbn1cbiIsImltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCAqIGFzIE9yZGVyVXRpbCBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0IHsgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQge1xuICBhcHAsXG4gIFBhZ2VFbGVtZW50LFxuICBPcmRlckZpbHRlcixcbiAgT3JkZXJcbn0gZnJvbSAnLi9yZWdpc3RyeSdcblxuY29uc3Qgb3JkZXJCYXRjaFNpemUgPSA1MFxuY29uc3QgYW5pbWF0aW9uTGVuZ3RoID0gNTAwXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9yZGVyc1BhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIG1haW46IEhUTUxFbGVtZW50XG4gIG9mZnNldDogc3RyaW5nXG4gIGxvYWRpbmc6IGJvb2xlYW5cbiAgY3VycmVudEZvcm06IFBhZ2VFbGVtZW50XG4gIG9yZGVyVG1wbDogUGFnZUVsZW1lbnRcbiAgZmlsdGVyU3RhdGU6IE9yZGVyRmlsdGVyXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuXG4gIGNvbnN0cnVjdG9yIChtYWluOiBIVE1MRWxlbWVudCkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLm1haW4gPSBtYWluXG4gICAgLy8gaWYgb2Zmc2V0IGlzICcnLCB0aGVyZSBhcmUgbm8gbW9yZSBvcmRlcnMgYXZhaWxhYmxlIHRvIGF1dG8tbG9hZCBmb3JcbiAgICAvLyBuZXZlci1lbmRpbmcgc2Nyb2xsaW5nLlxuICAgIHRoaXMub2Zmc2V0ID0gJydcbiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhtYWluKVxuICAgIHRoaXMub3JkZXJUbXBsID0gcGFnZS5yb3dUbXBsXG4gICAgdGhpcy5vcmRlclRtcGwucmVtb3ZlKClcblxuICAgIC8vIGZpbHRlclN0YXRlIHdpbGwgc3RvcmUgYXJyYXlzIG9mIHN0cmluZ3MuIFRoZSBhc3NldHMgYW5kIHN0YXR1c2VzXG4gICAgLy8gc3ViLWZpbHRlcnMgd2lsbCBuZWVkIHRvIGJlIGNvbnZlcnRlZCB0byBpbnRzIGZvciBKU09OIGVuY29kaW5nLlxuICAgIGNvbnN0IGZpbHRlclN0YXRlOiBPcmRlckZpbHRlciA9IHRoaXMuZmlsdGVyU3RhdGUgPSB7XG4gICAgICBob3N0czogW10sXG4gICAgICBhc3NldHM6IFtdLFxuICAgICAgc3RhdHVzZXM6IFtdXG4gICAgfVxuXG4gICAgY29uc3Qgc2VhcmNoID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKVxuICAgIGNvbnN0IHJlYWRGaWx0ZXIgPSAoZm9ybTogSFRNTEVsZW1lbnQsIGZpbHRlcktleTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCB2ID0gc2VhcmNoLmdldChmaWx0ZXJLZXkpXG4gICAgICBpZiAoIXYgfHwgdi5sZW5ndGggPT09IDApIHJldHVyblxuICAgICAgY29uc3Qgc3ViRmlsdGVyID0gdi5zcGxpdCgnLCcpXG4gICAgICBpZiAodikge1xuICAgICAgICAoZmlsdGVyU3RhdGUgYXMgYW55KVtmaWx0ZXJLZXldID0gc3ViRmlsdGVyIC8vIEtpbmRhIGphbmt5XG4gICAgICB9XG4gICAgICBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JykuZm9yRWFjaChidHRuID0+IHtcbiAgICAgICAgaWYgKHN1YkZpbHRlci5pbmRleE9mKGJ0dG4udmFsdWUpID49IDApIGJ0dG4uY2hlY2tlZCA9IHRydWVcbiAgICAgIH0pXG4gICAgfVxuICAgIHJlYWRGaWx0ZXIocGFnZS5ob3N0RmlsdGVyLCAnaG9zdHMnKVxuICAgIHJlYWRGaWx0ZXIocGFnZS5hc3NldEZpbHRlciwgJ2Fzc2V0cycpXG4gICAgcmVhZEZpbHRlcihwYWdlLnN0YXR1c0ZpbHRlciwgJ3N0YXR1c2VzJylcblxuICAgIGNvbnN0IGFwcGx5QnV0dG9uczogSFRNTEVsZW1lbnRbXSA9IFtdXG4gICAgY29uc3QgbW9uaXRvckZpbHRlciA9IChmb3JtOiBIVE1MRWxlbWVudCwgZmlsdGVyS2V5OiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IGFwcGx5QnR0biA9IGZvcm0ucXVlcnlTZWxlY3RvcignLmFwcGx5LWJ0dG4nKSBhcyBIVE1MRWxlbWVudFxuICAgICAgYXBwbHlCdXR0b25zLnB1c2goYXBwbHlCdHRuKVxuICAgICAgRG9jLmJpbmQoYXBwbHlCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuc3VibWl0RmlsdGVyKClcbiAgICAgICAgYXBwbHlCdXR0b25zLmZvckVhY2goYnR0biA9PiBEb2MuaGlkZShidHRuKSlcbiAgICAgIH0pXG4gICAgICBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JykuZm9yRWFjaChidHRuID0+IHtcbiAgICAgICAgRG9jLmJpbmQoYnR0biwgJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICBjb25zdCBzdWJGaWx0ZXIgPSBwYXJzZVN1YkZpbHRlcihmb3JtKVxuICAgICAgICAgIGlmIChjb21wYXJlU3ViRmlsdGVyKHN1YkZpbHRlciwgKGZpbHRlclN0YXRlIGFzIGFueSlbZmlsdGVyS2V5XSkpIHtcbiAgICAgICAgICAgIC8vIFNhbWUgYXMgY3VycmVudGx5IGxvYWRlZC4gSGlkZSB0aGUgYXBwbHkgYnV0dG9uLlxuICAgICAgICAgICAgRG9jLmhpZGUoYXBwbHlCdHRuKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBEb2Muc2hvdyhhcHBseUJ0dG4pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBtb25pdG9yRmlsdGVyKHBhZ2UuaG9zdEZpbHRlciwgJ2hvc3RzJylcbiAgICBtb25pdG9yRmlsdGVyKHBhZ2UuYXNzZXRGaWx0ZXIsICdhc3NldHMnKVxuICAgIG1vbml0b3JGaWx0ZXIocGFnZS5zdGF0dXNGaWx0ZXIsICdzdGF0dXNlcycpXG5cbiAgICBEb2MuYmluZCh0aGlzLm1haW4sICdzY3JvbGwnLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5sb2FkaW5nKSByZXR1cm5cbiAgICAgIGNvbnN0IGJlbG93Qm90dG9tID0gcGFnZS5vcmRlcnNUYWJsZS5vZmZzZXRIZWlnaHQgLSB0aGlzLm1haW4ub2Zmc2V0SGVpZ2h0IC0gdGhpcy5tYWluLnNjcm9sbFRvcFxuICAgICAgaWYgKGJlbG93Qm90dG9tIDwgMCkge1xuICAgICAgICB0aGlzLm5leHRQYWdlKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcGFnZS5mb3Jtcy5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIERvYy5iaW5kKGVsLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICAvLyBJZiB0aGUgdXNlciBjbGlja3Mgb3V0c2lkZSBvZiBhIGZvcm0sIGl0IHNob3VsZCBjbG9zZSB0aGUgcGFnZSBvdmVybGF5LlxuICAgIERvYy5iaW5kKHBhZ2UuZm9ybXMsICdtb3VzZWRvd24nLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKCFEb2MubW91c2VJbkVsZW1lbnQoZSwgdGhpcy5jdXJyZW50Rm9ybSkpIHtcbiAgICAgICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgRG9jLmJpbmQocGFnZS5leHBvcnRPcmRlcnMsICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuZXhwb3J0T3JkZXJzKClcbiAgICB9KVxuXG4gICAgcGFnZS5zaG93QXJjaGl2ZWREYXRlRmllbGQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgaWYgKHBhZ2Uuc2hvd0FyY2hpdmVkRGF0ZUZpZWxkLmNoZWNrZWQpIERvYy5zaG93KHBhZ2UuYXJjaGl2ZWREYXRlRmllbGQpXG4gICAgICBlbHNlIERvYy5oaWRlKHBhZ2UuYXJjaGl2ZWREYXRlRmllbGQsIHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzRXJyKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3JkcywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgICAgcGFnZS5zaG93QXJjaGl2ZWREYXRlRmllbGQuY2hlY2tlZCA9IGZhbHNlXG4gICAgICBwYWdlLnNhdmVNYXRjaGVzVG9GaWxlLmNoZWNrZWQgPSBmYWxzZVxuICAgICAgcGFnZS5zYXZlT3JkZXJzVG9GaWxlLmNoZWNrZWQgPSBmYWxzZVxuICAgICAgcGFnZS5kZWxldGVBcmNoaXZlZFJlY29yZHNFcnIudGV4dENvbnRlbnQgPSAnJ1xuICAgICAgcGFnZS5hcmNoaXZlZFJlY29yZHNMb2NhdGlvbi50ZXh0Q29udGVudCA9ICcnXG4gICAgICBwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc01zZy50ZXh0Q29udGVudCA9ICcnXG4gICAgICBEb2MuaGlkZShwYWdlLmRlbGV0ZUFyY2hpdmVkUmVzdWx0LCBwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc0VycixcbiAgICAgICAgcGFnZS5kZWxldGVBcmNoaXZlZFJlY29yZHNNc2csIHBhZ2UuYXJjaGl2ZWRSZWNvcmRzTG9jYXRpb24sIHBhZ2UuYXJjaGl2ZWREYXRlRmllbGQpXG4gICAgICB0aGlzLnNob3dGb3JtKHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzRm9ybSlcbiAgICB9KVxuXG4gICAgRG9jLmJpbmQocGFnZS5kZWxldGVBcmNoaXZlZFJlY29yZHNTdWJtaXQsICdjbGljaycsICgpID0+IHtcbiAgICAgIGxldCBkYXRlID0gMFxuICAgICAgaWYgKHBhZ2Uuc2hvd0FyY2hpdmVkRGF0ZUZpZWxkLmNoZWNrZWQpIHtcbiAgICAgICAgZGF0ZSA9IERhdGUucGFyc2UocGFnZS5vbGRlclRoYW4udmFsdWUgfHwgJycpXG4gICAgICAgIGlmIChpc05hTihkYXRlKSB8fCBkYXRlIDw9IDApIHtcbiAgICAgICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc0VyciwgaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9EQVRFX0VSUl9NU0cpKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLmRlbGV0ZUFyY2hpdmVkUmVjb3JkcyhkYXRlKVxuICAgIH0pXG5cbiAgICB0aGlzLnN1Ym1pdEZpbHRlcigpXG4gIH1cblxuICAvKiBzaG93Rm9ybSBzaG93cyBhIG1vZGFsIGZvcm0gd2l0aCBhIGxpdHRsZSBhbmltYXRpb24uICovXG4gIGFzeW5jIHNob3dGb3JtIChmb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIHRoaXMuY3VycmVudEZvcm0gPSBmb3JtXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzRm9ybSlcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzEwMDAwcHgnXG4gICAgRG9jLnNob3cocGFnZS5mb3JtcywgZm9ybSlcbiAgICBjb25zdCBzaGlmdCA9IChwYWdlLmZvcm1zLm9mZnNldFdpZHRoICsgZm9ybS5vZmZzZXRXaWR0aCkgLyAyXG4gICAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pbWF0aW9uTGVuZ3RoLCBwcm9ncmVzcyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gYCR7KDEgLSBwcm9ncmVzcykgKiBzaGlmdH1weGBcbiAgICB9LCAnZWFzZU91dEhhcmQnKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMHB4J1xuICB9XG5cbiAgLyogc2V0T3JkZXJzIGVtcHRpZXMgdGhlIG9yZGVyIHRhYmxlIGFuZCBhcHBlbmRzIHRoZSBzcGVjaWZpZWQgb3JkZXJzLiAqL1xuICBzZXRPcmRlcnMgKG9yZGVyczogT3JkZXJbXSkge1xuICAgIERvYy5lbXB0eSh0aGlzLnBhZ2UudGFibGVCb2R5KVxuICAgIHRoaXMuYXBwZW5kT3JkZXJzKG9yZGVycylcbiAgfVxuXG4gIC8qIGFwcGVuZE9yZGVycyBhcHBlbmRzIG9yZGVycyB0byB0aGUgb3JkZXJzIHRhYmxlLiAqL1xuICBhcHBlbmRPcmRlcnMgKG9yZGVyczogT3JkZXJbXSkge1xuICAgIGNvbnN0IHRib2R5ID0gdGhpcy5wYWdlLnRhYmxlQm9keVxuICAgIGZvciAoY29uc3Qgb3JkIG9mIG9yZGVycykge1xuICAgICAgY29uc3QgdHIgPSB0aGlzLm9yZGVyVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZSh0cilcbiAgICAgIGxldCBmcm9tU3ltYm9sLCB0b1N5bWJvbCwgZnJvbVVuaXQsIHRvVW5pdCwgZnJvbVF0eVxuICAgICAgbGV0IHRvUXR5ID0gJydcbiAgICAgIGNvbnN0IHhjID0gYXBwKCkuZXhjaGFuZ2VzW29yZC5ob3N0XSB8fCB1bmRlZmluZWRcbiAgICAgIGlmICgoIWFwcCgpLmFzc2V0c1tvcmQuYmFzZUlEXSAmJiAheGMuYXNzZXRzW29yZC5iYXNlSURdKSB8fCAoIWFwcCgpLmFzc2V0c1tvcmQucXVvdGVJRF0gJiYgIXhjLmFzc2V0c1tvcmQucXVvdGVJRF0pKSBjb250aW51ZVxuICAgICAgY29uc3QgW2Jhc2VVbml0SW5mbywgcXVvdGVVbml0SW5mb10gPSBbYXBwKCkudW5pdEluZm8ob3JkLmJhc2VJRCwgeGMpLCBhcHAoKS51bml0SW5mbyhvcmQucXVvdGVJRCwgeGMpXVxuICAgICAgaWYgKG9yZC5zZWxsKSB7XG4gICAgICAgIFtmcm9tU3ltYm9sLCB0b1N5bWJvbF0gPSBbb3JkLmJhc2VTeW1ib2wsIG9yZC5xdW90ZVN5bWJvbF07XG4gICAgICAgIFtmcm9tVW5pdCwgdG9Vbml0XSA9IFtiYXNlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQsIHF1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRdXG4gICAgICAgIGZyb21RdHkgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHksIGJhc2VVbml0SW5mbylcbiAgICAgICAgaWYgKG9yZC50eXBlID09PSBPcmRlclV0aWwuTGltaXQpIHtcbiAgICAgICAgICB0b1F0eSA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkLnF0eSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgKiBvcmQucmF0ZSwgcXVvdGVVbml0SW5mbylcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgW2Zyb21TeW1ib2wsIHRvU3ltYm9sXSA9IFtvcmQucXVvdGVTeW1ib2wsIG9yZC5iYXNlU3ltYm9sXTtcbiAgICAgICAgW2Zyb21Vbml0LCB0b1VuaXRdID0gW3F1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQsIGJhc2VVbml0SW5mby5jb252ZW50aW9uYWwudW5pdF1cbiAgICAgICAgaWYgKG9yZC50eXBlID09PSBPcmRlclV0aWwuTWFya2V0KSB7XG4gICAgICAgICAgZnJvbVF0eSA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZyb21RdHkgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHkgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yICogb3JkLnJhdGUsIHF1b3RlVW5pdEluZm8pXG4gICAgICAgICAgdG9RdHkgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHksIGJhc2VVbml0SW5mbylcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBta3RJRCA9IGAke2Jhc2VVbml0SW5mby5jb252ZW50aW9uYWwudW5pdH0tJHtxdW90ZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0fWBcbiAgICAgIHRtcGwuaG9zdC50ZXh0Q29udGVudCA9IGAke21rdElEfSBAICR7b3JkLmhvc3R9YFxuXG4gICAgICB0bXBsLmZyb21RdHkudGV4dENvbnRlbnQgPSBmcm9tUXR5XG4gICAgICB0bXBsLmZyb21Mb2dvLnNyYyA9IERvYy5sb2dvUGF0aChmcm9tU3ltYm9sKVxuICAgICAgdG1wbC5mcm9tU3ltYm9sLnRleHRDb250ZW50ID0gZnJvbVVuaXRcbiAgICAgIHRtcGwudG9RdHkudGV4dENvbnRlbnQgPSB0b1F0eVxuICAgICAgdG1wbC50b0xvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHRvU3ltYm9sKVxuICAgICAgdG1wbC50b1N5bWJvbC50ZXh0Q29udGVudCA9IHRvVW5pdFxuICAgICAgdG1wbC50eXBlLnRleHRDb250ZW50ID0gYCR7T3JkZXJVdGlsLnR5cGVTdHJpbmcob3JkKX0gJHtPcmRlclV0aWwuc2VsbFN0cmluZyhvcmQpfWBcbiAgICAgIGxldCByYXRlID0gRG9jLmZvcm1hdENvaW5WYWx1ZShhcHAoKS5jb252ZW50aW9uYWxSYXRlKG9yZC5iYXNlSUQsIG9yZC5xdW90ZUlELCBvcmQucmF0ZSwgeGMpKVxuICAgICAgaWYgKG9yZC50eXBlID09PSBPcmRlclV0aWwuTWFya2V0KSByYXRlID0gT3JkZXJVdGlsLmF2ZXJhZ2VNYXJrZXRPcmRlclJhdGVTdHJpbmcob3JkKVxuICAgICAgdG1wbC5yYXRlLnRleHRDb250ZW50ID0gcmF0ZVxuICAgICAgdG1wbC5zdGF0dXMudGV4dENvbnRlbnQgPSBPcmRlclV0aWwuc3RhdHVzU3RyaW5nKG9yZClcbiAgICAgIHRtcGwuZmlsbGVkLnRleHRDb250ZW50ID0gYCR7KE9yZGVyVXRpbC5maWxsZWQob3JkKSAvIG9yZC5xdHkgKiAxMDApLnRvRml4ZWQoMSl9JWBcbiAgICAgIHRtcGwuc2V0dGxlZC50ZXh0Q29udGVudCA9IGAkeyhPcmRlclV0aWwuc2V0dGxlZChvcmQpIC8gb3JkLnF0eSAqIDEwMCkudG9GaXhlZCgxKX0lYFxuICAgICAgY29uc3QgZGF0ZVRpbWUgPSBuZXcgRGF0ZShvcmQuc3VibWl0VGltZSkudG9Mb2NhbGVTdHJpbmcoKVxuICAgICAgdG1wbC50aW1lQWdvLnRleHRDb250ZW50ID0gYCR7RG9jLnRpbWVTaW5jZShvcmQuc3VibWl0VGltZSl9IGFnb2BcbiAgICAgIHRtcGwudGltZS50ZXh0Q29udGVudCA9IGRhdGVUaW1lXG4gICAgICBjb25zdCBsaW5rID0gRG9jLnRtcGxFbGVtZW50KHRyLCAnbGluaycpXG4gICAgICBsaW5rLmhyZWYgPSBgb3JkZXIvJHtvcmQuaWR9YFxuICAgICAgYXBwKCkuYmluZEludGVybmFsTmF2aWdhdGlvbih0cilcbiAgICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKVxuICAgIH1cbiAgICBpZiAob3JkZXJzLmxlbmd0aCA9PT0gb3JkZXJCYXRjaFNpemUpIHtcbiAgICAgIHRoaXMub2Zmc2V0ID0gb3JkZXJzW29yZGVycy5sZW5ndGggLSAxXS5pZFxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9mZnNldCA9ICcnXG4gICAgfVxuICB9XG5cbiAgLyogc3VibWl0RmlsdGVyIHN1Ym1pdHMgdGhlIGN1cnJlbnQgZmlsdGVyIGFuZCByZWxvYWRzIHRoZSBvcmRlciB0YWJsZS4gKi9cbiAgYXN5bmMgc3VibWl0RmlsdGVyICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5vZmZzZXQgPSAnJ1xuICAgIGNvbnN0IGZpbHRlclN0YXRlID0gdGhpcy5maWx0ZXJTdGF0ZVxuICAgIGZpbHRlclN0YXRlLmhvc3RzID0gcGFyc2VTdWJGaWx0ZXIocGFnZS5ob3N0RmlsdGVyKVxuICAgIGZpbHRlclN0YXRlLmFzc2V0cyA9IHBhcnNlU3ViRmlsdGVyKHBhZ2UuYXNzZXRGaWx0ZXIpLm1hcCgoczogc3RyaW5nKSA9PiBwYXJzZUludChzKSlcbiAgICBmaWx0ZXJTdGF0ZS5zdGF0dXNlcyA9IHBhcnNlU3ViRmlsdGVyKHBhZ2Uuc3RhdHVzRmlsdGVyKS5tYXAoKHM6IHN0cmluZykgPT4gcGFyc2VJbnQocykpXG4gICAgdGhpcy5zZXRPcmRlcnMoYXdhaXQgdGhpcy5mZXRjaE9yZGVycygpKVxuICB9XG5cbiAgLyogZmV0Y2hPcmRlcnMgZmV0Y2hlcyBvcmRlcnMgdXNpbmcgdGhlIGN1cnJlbnQgZmlsdGVyLiAqL1xuICBhc3luYyBmZXRjaE9yZGVycyAoKSB7XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLm1haW4pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvb3JkZXJzJywgdGhpcy5jdXJyZW50RmlsdGVyKCkpXG4gICAgbG9hZGVkKClcbiAgICByZXR1cm4gcmVzLm9yZGVyc1xuICB9XG5cbiAgLyogZXhwb3J0T3JkZXJzIGRvd25sb2FkcyBhIGNzdiBvZiB0aGUgdXNlcidzIG9yZGVycyBiYXNlZCBvbiB0aGUgY3VycmVudCBmaWx0ZXIuICovXG4gIGV4cG9ydE9yZGVycyAoKSB7XG4gICAgdGhpcy5vZmZzZXQgPSAnJ1xuICAgIGNvbnN0IGZpbHRlclN0YXRlID0gdGhpcy5jdXJyZW50RmlsdGVyKClcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuICAgIGNvbnN0IHNlYXJjaCA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoJycpXG4gICAgY29uc3Qgc2V0UXVlcnkgPSAoazogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBzdWJGaWx0ZXIgPSAoZmlsdGVyU3RhdGUgYXMgYW55KVtrXVxuICAgICAgc3ViRmlsdGVyLmZvckVhY2goKHY6IGFueSkgPT4ge1xuICAgICAgICBzZWFyY2guYXBwZW5kKGssIHYpXG4gICAgICB9KVxuICAgIH1cbiAgICBzZXRRdWVyeSgnaG9zdHMnKVxuICAgIHNldFF1ZXJ5KCdhc3NldHMnKVxuICAgIHNldFF1ZXJ5KCdzdGF0dXNlcycpXG4gICAgdXJsLnNlYXJjaCA9IHNlYXJjaC50b1N0cmluZygpXG4gICAgdXJsLnBhdGhuYW1lID0gJy9vcmRlcnMvZXhwb3J0J1xuICAgIHdpbmRvdy5vcGVuKHVybC50b1N0cmluZygpKVxuICB9XG5cbiAgLyogZGVsZXRlQXJjaGl2ZWRSZWNvcmRzIHJlbW92ZXMgdGhlIHVzZXIncyBhcmNoaXZlZCBvcmRlcnMgYW5kIG1hdGNoZXNcbiAgICogY3JlYXRlZCBiZWZvcmUgdXNlciBzcGVjaWZpZWQgZGF0ZSB0aW1lIGluIG1pbGxpc2Vjb25kLiBEZWxldGVkIGFyY2hpdmVkXG4gICAqIHJlY29yZHMgYXJlIHNhdmVkIHRvIGEgQ1NWIGZpbGUgaWYgdGhlIHVzZXIgc3BlY2lmeSBzby5cbiAgICovXG4gIGFzeW5jIGRlbGV0ZUFyY2hpdmVkUmVjb3JkcyAob2xkZXJUaGFuTXM/OiBudW1iZXIpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3Qgc2F2ZU1hdGNoZXNUb0ZJbGUgPSBwYWdlLnNhdmVNYXRjaGVzVG9GaWxlLmNoZWNrZWQgfHwgZmFsc2VcbiAgICBjb25zdCBzYXZlT3JkZXJzVG9GaWxlID0gcGFnZS5zYXZlT3JkZXJzVG9GaWxlLmNoZWNrZWQgfHwgZmFsc2VcbiAgICBjb25zdCByZXFCb2R5ID0ge1xuICAgICAgb2xkZXJUaGFuTXM6IG9sZGVyVGhhbk1zLFxuICAgICAgc2F2ZU1hdGNoZXNUb0ZpbGU6IHNhdmVNYXRjaGVzVG9GSWxlLFxuICAgICAgc2F2ZU9yZGVyc1RvRmlsZTogc2F2ZU9yZGVyc1RvRmlsZVxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMubWFpbilcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9kZWxldGVhcmNoaXZlZHJlY29yZHMnLCByZXFCb2R5KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHJldHVybiBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc0VyciwgcmVzLm1zZylcbiAgICB9XG5cbiAgICBpZiAocmVzLmFyY2hpdmVkUmVjb3Jkc0RlbGV0ZWQgPiAwKSB7XG4gICAgICBwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc01zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0RFTEVURV9BUkNISVZFRF9SRUNPUkRTX1JFU1VMVCwgeyBuUmVjb3JkczogcmVzLmFyY2hpdmVkUmVjb3Jkc0RlbGV0ZWQgfSlcbiAgICAgIGlmIChzYXZlTWF0Y2hlc1RvRklsZSB8fCBzYXZlT3JkZXJzVG9GaWxlKSB7XG4gICAgICAgIHBhZ2UuYXJjaGl2ZWRSZWNvcmRzTG9jYXRpb24udGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BUkNISVZFRF9SRUNPUkRTX1BBVEgsIHsgcGF0aDogcmVzLmFyY2hpdmVkUmVjb3Jkc1BhdGggfSlcbiAgICAgICAgRG9jLnNob3cocGFnZS5hcmNoaXZlZFJlY29yZHNMb2NhdGlvbilcbiAgICAgIH1cbiAgICAgIC8vIFVwZGF0ZSB0aGUgb3JkZXIgcGFnZS5cbiAgICAgIHRoaXMuc3VibWl0RmlsdGVyKClcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5kZWxldGVBcmNoaXZlZFJlY29yZHNNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9OT19BUkNISVZFRF9SRUNPUkRTKVxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLmRlbGV0ZUFyY2hpdmVkUmVzdWx0LCBwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc01zZylcbiAgfVxuXG4gIC8qXG4gICAqIGN1cnJlbnRGaWx0ZXIgY29udmVydHMgdGhlIGxvY2FsIGZpbHRlciB0eXBlICh3aGljaCBpcyBhbGwgc3RyaW5ncykgdG8gdGhlXG4gICAqIHNlcnZlcidzIGZpbHRlciB0eXBlLlxuICAgKi9cbiAgY3VycmVudEZpbHRlciAoKTogT3JkZXJGaWx0ZXIge1xuICAgIGNvbnN0IGZpbHRlclN0YXRlID0gdGhpcy5maWx0ZXJTdGF0ZSBhcyBPcmRlckZpbHRlclxuICAgIHJldHVybiB7XG4gICAgICBob3N0czogZmlsdGVyU3RhdGUuaG9zdHMsXG4gICAgICBhc3NldHM6IGZpbHRlclN0YXRlLmFzc2V0cz8ubWFwKChzOiBhbnkpID0+IHBhcnNlSW50KHMpKSxcbiAgICAgIHN0YXR1c2VzOiBmaWx0ZXJTdGF0ZS5zdGF0dXNlcz8ubWFwKChzOiBhbnkpID0+IHBhcnNlSW50KHMpKSxcbiAgICAgIG46IG9yZGVyQmF0Y2hTaXplLFxuICAgICAgb2Zmc2V0OiB0aGlzLm9mZnNldFxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIG5leHRQYWdlIHJlc3VibWl0cyB0aGUgZmlsdGVyIHdpdGggdGhlIG9mZnNldCBzZXQgdG8gdGhlIGxhc3QgbG9hZGVkIG9yZGVyLlxuICAgKi9cbiAgYXN5bmMgbmV4dFBhZ2UgKCkge1xuICAgIGlmICh0aGlzLm9mZnNldCA9PT0gJycgfHwgdGhpcy5sb2FkaW5nKSByZXR1cm5cbiAgICB0aGlzLmxvYWRpbmcgPSB0cnVlXG4gICAgRG9jLnNob3codGhpcy5wYWdlLm9yZGVyTG9hZGVyKVxuICAgIGNvbnN0IG9yZGVycyA9IGF3YWl0IHRoaXMuZmV0Y2hPcmRlcnMoKVxuICAgIHRoaXMubG9hZGluZyA9IGZhbHNlXG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLm9yZGVyTG9hZGVyKVxuICAgIHRoaXMuYXBwZW5kT3JkZXJzKG9yZGVycylcbiAgfVxufVxuXG4vKlxuICogcGFyc2VTdWJGaWx0ZXIgcGFyc2VzIGEgYm9vbC1tYXAgZnJvbSB0aGUgY2hlY2tib3ggaW5wdXRzIGluIHRoZSBzcGVjaWZpZWRcbiAqIGFuY2VzdG9yIGVsZW1lbnQuXG4gKi9cbmZ1bmN0aW9uIHBhcnNlU3ViRmlsdGVyIChmb3JtOiBIVE1MRWxlbWVudCk6IHN0cmluZ1tdIHtcbiAgY29uc3QgZW50cmllczogc3RyaW5nW10gPSBbXVxuICBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JykuZm9yRWFjaChib3ggPT4ge1xuICAgIGlmIChib3guY2hlY2tlZCkgZW50cmllcy5wdXNoKGJveC52YWx1ZSlcbiAgfSlcbiAgcmV0dXJuIGVudHJpZXNcbn1cblxuLyogY29tcGFyZVN1YkZpbHRlciBjb21wYXJlcyB0aGUgdHdvIGZpbHRlciBhcnJheXMgZm9yIHVub3JkZXJlZCBlcXVpdmFsZW5jZS4gKi9cbmZ1bmN0aW9uIGNvbXBhcmVTdWJGaWx0ZXIgKGZpbHRlcjE6IGFueVtdLCBmaWx0ZXIyOiBhbnlbXSk6IGJvb2xlYW4ge1xuICBpZiAoZmlsdGVyMS5sZW5ndGggIT09IGZpbHRlcjIubGVuZ3RoKSByZXR1cm4gZmFsc2VcbiAgZm9yIChjb25zdCBlbnRyeSBvZiBmaWx0ZXIxKSB7XG4gICAgaWYgKGZpbHRlcjIuaW5kZXhPZihlbnRyeSkgPT09IC0xKSByZXR1cm4gZmFsc2VcbiAgfVxuICByZXR1cm4gdHJ1ZVxufVxuIiwiaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQge1xuICBhcHAsXG4gIE9yZGVyLFxuICBUcmFkZUZvcm0sXG4gIE9yZGVyT3B0aW9uLFxuICBNYXRjaFxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IHsgQm9vbGVhbk9wdGlvbiwgWFlSYW5nZU9wdGlvbiB9IGZyb20gJy4vb3B0cydcbmltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5cbmV4cG9ydCBjb25zdCBMaW1pdCA9IDEgLy8gVE9ETzogRGVsZXRlIGZvciB0aGUgdmVyc2lvbnMgYmVsb3dcbmV4cG9ydCBjb25zdCBNYXJrZXQgPSAyIC8vIFRPRE86IERlbGV0ZSBmb3IgdGhlIHZlcnNpb25zIGJlbG93XG5leHBvcnQgY29uc3QgQ2FuY2VsID0gMyAvLyBUT0RPOiBEZWxldGUgZm9yIHRoZSB2ZXJzaW9ucyBiZWxvd1xuXG5leHBvcnQgY29uc3QgT3JkZXJUeXBlTGltaXQgPSAxXG5leHBvcnQgY29uc3QgT3JkZXJUeXBlTWFya2V0ID0gMlxuZXhwb3J0IGNvbnN0IE9yZGVyVHlwZUNhbmNlbCA9IDNcblxuLyogVGhlIHRpbWUtaW4tZm9yY2Ugc3BlY2lmaWVycyBhcmUgYSBtaXJyb3Igb2YgZGV4L29yZGVyLlRpbWVJbkZvcmNlLiAqL1xuZXhwb3J0IGNvbnN0IEltbWVkaWF0ZVRpRiA9IDBcbmV4cG9ydCBjb25zdCBTdGFuZGluZ1RpRiA9IDFcblxuLyogVGhlIG9yZGVyIHN0YXR1c2VzIGFyZSBhIG1pcnJvciBvZiBkZXgvb3JkZXIuT3JkZXJTdGF0dXMuICovXG5leHBvcnQgY29uc3QgU3RhdHVzVW5rbm93biA9IDBcbmV4cG9ydCBjb25zdCBTdGF0dXNFcG9jaCA9IDFcbmV4cG9ydCBjb25zdCBTdGF0dXNCb29rZWQgPSAyXG5leHBvcnQgY29uc3QgU3RhdHVzRXhlY3V0ZWQgPSAzXG5leHBvcnQgY29uc3QgU3RhdHVzQ2FuY2VsZWQgPSA0XG5leHBvcnQgY29uc3QgU3RhdHVzUmV2b2tlZCA9IDVcblxuLyogVGhlIG1hdGNoIHN0YXR1c2VzIGFyZSBhIG1pcnJvciBvZiBkZXgvb3JkZXIuTWF0Y2hTdGF0dXMuICovXG5leHBvcnQgY29uc3QgTmV3bHlNYXRjaGVkID0gMFxuZXhwb3J0IGNvbnN0IE1ha2VyU3dhcENhc3QgPSAxXG5leHBvcnQgY29uc3QgVGFrZXJTd2FwQ2FzdCA9IDJcbmV4cG9ydCBjb25zdCBNYWtlclJlZGVlbWVkID0gM1xuZXhwb3J0IGNvbnN0IE1hdGNoQ29tcGxldGUgPSA0XG5leHBvcnQgY29uc3QgTWF0Y2hDb25maXJtZWQgPSA1XG5cbi8qIFRoZSBtYXRjaCBzaWRlcyBhcmUgYSBtaXJyb3Igb2YgZGV4L29yZGVyLk1hdGNoU2lkZS4gKi9cbmV4cG9ydCBjb25zdCBNYWtlciA9IDAgLy8gVE9ETzogRGVsZXRlIGZvciB0aGUgdmVyc2lvbnMgYmVsb3dcbmV4cG9ydCBjb25zdCBUYWtlciA9IDEgLy8gVE9ETzogRGVsZXRlIGZvciB0aGUgdmVyc2lvbnMgYmVsb3dcblxuZXhwb3J0IGNvbnN0IE1hdGNoU2lkZU1ha2VyID0gMFxuZXhwb3J0IGNvbnN0IE1hdGNoU2lkZVRha2VyID0gMVxuXG4vKlxuICogUmF0ZUVuY29kaW5nRmFjdG9yIGlzIHVzZWQgd2hlbiBlbmNvZGluZyBhbiBhdG9taWMgZXhjaGFuZ2UgcmF0ZSBhcyBhblxuICogaW50ZWdlci4gU2VlIGRvY3Mgb24gbWVzc2FnZS1yYXRlIGVuY29kaW5nIEBcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9kZWNyZWQvZGNyZGV4L2Jsb2IvbWFzdGVyL3NwZWMvY29tbS5tZWRpYXdpa2kjUmF0ZV9FbmNvZGluZ1xuICovXG5leHBvcnQgY29uc3QgUmF0ZUVuY29kaW5nRmFjdG9yID0gMWU4XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWxsU3RyaW5nIChvcmQ6IE9yZGVyKSB7XG4gIGNvbnN0IGtleSA9IG9yZC5zZWxsID8gaW50bC5JRF9TRUxMIDogaW50bC5JRF9CVVlcbiAgY29uc3QgbGFuZyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5sYW5nLnRvTG93ZXJDYXNlKClcbiAgcmV0dXJuIGludGwucHJlcChrZXkpLnRvTG9jYWxlTG93ZXJDYXNlKGxhbmcpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0eXBlU3RyaW5nIChvcmQ6IE9yZGVyKSB7XG4gIHJldHVybiBvcmQudHlwZSA9PT0gTGltaXQgPyAob3JkLnRpZiA9PT0gSW1tZWRpYXRlVGlGID8gaW50bC5wcmVwKGludGwuSURfTElNSVRfT1JERVJfSU1NRURJQVRFX1RJRikgOiBpbnRsLnByZXAoaW50bC5JRF9MSU1JVF9PUkRFUikpIDogaW50bC5wcmVwKGludGwuSURfTUFSS0VUX09SREVSKVxufVxuXG4vKiBpc01hcmtldEJ1eSB3aWxsIHJldHVybiB0cnVlIGlmIHRoZSBvcmRlciBpcyBhIG1hcmtldCBidXkgb3JkZXIuICovXG5leHBvcnQgZnVuY3Rpb24gaXNNYXJrZXRCdXkgKG9yZDogT3JkZXIpIHtcbiAgcmV0dXJuIG9yZC50eXBlID09PSBNYXJrZXQgJiYgIW9yZC5zZWxsXG59XG5cbi8qXG4gKiBoYXNBY3RpdmVNYXRjaGVzIHJldHVybnMgdHJ1ZSBpZiB0aGUgb3JkZXIgaGFzIG1hdGNoZXMgdGhhdCBoYXZlIG5vdCBjb21wbGV0ZWRcbiAqIHNldHRsZW1lbnQgeWV0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzQWN0aXZlTWF0Y2hlcyAob3JkZXI6IE9yZGVyKSB7XG4gIGlmICghb3JkZXIubWF0Y2hlcykgcmV0dXJuIGZhbHNlXG4gIGZvciAoY29uc3QgbWF0Y2ggb2Ygb3JkZXIubWF0Y2hlcykge1xuICAgIGlmIChtYXRjaC5hY3RpdmUpIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59XG5cbi8qKlxuICogc3RhdHVzU3RyaW5nIGNvbnZlcnRzIHRoZSBvcmRlciBzdGF0dXMgdG8gYSBzdHJpbmcuXG4gKlxuICogSU1QT1JUQU5UOiB3ZSBoYXZlIHNpbWlsYXIgZnVuY3Rpb24gaW4gR29sYW5nLCBpdCBtdXN0IG1hdGNoIHRoaXMgb25lIGV4YWN0bHksXG4gKiB3aGVuIHVwZGF0aW5nIG1ha2Ugc3VyZSB0byB1cGRhdGUgYm90aCFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0YXR1c1N0cmluZyAob3JkZXI6IE9yZGVyKTogc3RyaW5nIHtcbiAgaWYgKCFvcmRlci5pZCkgcmV0dXJuIGludGwucHJlcChpbnRsLklEX09SREVSX1NVQk1JVFRJTkcpIC8vIG9yZGVyIElEIGlzIGVtcHR5LlxuICBjb25zdCBpc0xpdmUgPSBoYXNBY3RpdmVNYXRjaGVzKG9yZGVyKVxuICBzd2l0Y2ggKG9yZGVyLnN0YXR1cykge1xuICAgIGNhc2UgU3RhdHVzVW5rbm93bjogcmV0dXJuIGludGwucHJlcChpbnRsLklEX1VOS05PV04pXG4gICAgY2FzZSBTdGF0dXNFcG9jaDogcmV0dXJuIGludGwucHJlcChpbnRsLklEX0VQT0NIKVxuICAgIGNhc2UgU3RhdHVzQm9va2VkOlxuICAgICAgaWYgKG9yZGVyLmNhbmNlbGxpbmcpIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9DQU5DRUxJTkcpXG4gICAgICByZXR1cm4gaXNMaXZlID8gYCR7aW50bC5wcmVwKGludGwuSURfQk9PS0VEKX0vJHtpbnRsLnByZXAoaW50bC5JRF9TRVRUTElORyl9YCA6IGludGwucHJlcChpbnRsLklEX0JPT0tFRClcbiAgICBjYXNlIFN0YXR1c0V4ZWN1dGVkOlxuICAgICAgaWYgKGlzTGl2ZSkgcmV0dXJuIGludGwucHJlcChpbnRsLklEX1NFVFRMSU5HKVxuICAgICAgaWYgKG9yZGVyLmZpbGxlZCA9PT0gMCAmJiBvcmRlci50eXBlICE9PSBDYW5jZWwpIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9OT19NQVRDSClcbiAgICAgIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9FWEVDVVRFRClcbiAgICBjYXNlIFN0YXR1c0NhbmNlbGVkOlxuICAgICAgcmV0dXJuIGlzTGl2ZSA/IGAke2ludGwucHJlcChpbnRsLklEX0NBTkNFTEVEKX0vJHtpbnRsLnByZXAoaW50bC5JRF9TRVRUTElORyl9YCA6IGludGwucHJlcChpbnRsLklEX0NBTkNFTEVEKVxuICAgIGNhc2UgU3RhdHVzUmV2b2tlZDpcbiAgICAgIHJldHVybiBpc0xpdmUgPyBgJHtpbnRsLnByZXAoaW50bC5JRF9SRVZPS0VEKX0vJHtpbnRsLnByZXAoaW50bC5JRF9TRVRUTElORyl9YCA6IGludGwucHJlcChpbnRsLklEX1JFVk9LRUQpXG4gIH1cbiAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX1VOS05PV04pXG59XG5cbi8qIGZpbGxlZCBzdW1zIHRoZSBxdWFudGl0aWVzIG9mIG5vbi1jYW5jZWwgbWF0Y2hlcyBhdmFpbGFibGUuICovXG5leHBvcnQgZnVuY3Rpb24gZmlsbGVkIChvcmRlcjogT3JkZXIpIHtcbiAgaWYgKCFvcmRlci5tYXRjaGVzKSByZXR1cm4gMFxuICBjb25zdCBxdHkgPSBpc01hcmtldEJ1eShvcmRlcikgPyAobTogTWF0Y2gpID0+IG0ucXR5ICogbS5yYXRlIC8gUmF0ZUVuY29kaW5nRmFjdG9yIDogKG06IE1hdGNoKSA9PiBtLnF0eVxuICByZXR1cm4gb3JkZXIubWF0Y2hlcy5yZWR1Y2UoKGZpbGxlZCwgbWF0Y2gpID0+IHtcbiAgICBpZiAobWF0Y2guaXNDYW5jZWwpIHJldHVybiBmaWxsZWRcbiAgICByZXR1cm4gZmlsbGVkICsgcXR5KG1hdGNoKVxuICB9LCAwKVxufVxuXG4vKiBzZXR0bGVkIHN1bXMgdGhlIHF1YW50aXRpZXMgb2YgdGhlIG1hdGNoZXMgdGhhdCBoYXZlIGNvbXBsZXRlZC4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXR0bGVkIChvcmRlcjogT3JkZXIpIHtcbiAgaWYgKCFvcmRlci5tYXRjaGVzKSByZXR1cm4gMFxuICBjb25zdCBxdHkgPSBpc01hcmtldEJ1eShvcmRlcikgPyAobTogTWF0Y2gpID0+IG0ucXR5ICogbS5yYXRlIC8gUmF0ZUVuY29kaW5nRmFjdG9yIDogKG06IE1hdGNoKSA9PiBtLnF0eVxuICByZXR1cm4gb3JkZXIubWF0Y2hlcy5yZWR1Y2UoKHNldHRsZWQsIG1hdGNoKSA9PiB7XG4gICAgaWYgKG1hdGNoLmlzQ2FuY2VsKSByZXR1cm4gc2V0dGxlZFxuICAgIGNvbnN0IHJlZGVlbWVkID0gKG1hdGNoLnNpZGUgPT09IE1ha2VyICYmIG1hdGNoLnN0YXR1cyA+PSBNYWtlclJlZGVlbWVkKSB8fFxuICAgICAgKG1hdGNoLnNpZGUgPT09IFRha2VyICYmIG1hdGNoLnN0YXR1cyA+PSBNYXRjaENvbXBsZXRlKVxuICAgIHJldHVybiByZWRlZW1lZCA/IHNldHRsZWQgKyBxdHkobWF0Y2gpIDogc2V0dGxlZFxuICB9LCAwKVxufVxuXG4vKiBhdmVyYWdlUmF0ZVN0cmluZyByZXR1cm5zIGEgZm9ybWF0dGluZyBzdHJpbmcgY29udGFpbmluZyB0aGUgYXZlcmFnZSByYXRlIG9mXG50aGUgbWF0Y2hlcyB0aGF0IGhhdmUgYmVlbiBmaWxsZWQgZm9yIGEgbWFya2V0IG9yZGVyLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGF2ZXJhZ2VNYXJrZXRPcmRlclJhdGVTdHJpbmcgKG9yZDogT3JkZXIpOiBzdHJpbmcge1xuICBpZiAoIW9yZC5tYXRjaGVzPy5sZW5ndGgpIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9NQVJLRVRfT1JERVIpXG4gIGxldCByYXRlU3RyID0gRG9jLmZvcm1hdENvaW5WYWx1ZShhcHAoKS5jb252ZW50aW9uYWxSYXRlKG9yZC5iYXNlSUQsIG9yZC5xdW90ZUlELCBhdmVyYWdlUmF0ZShvcmQpKSlcbiAgaWYgKG9yZC5tYXRjaGVzLmxlbmd0aCA+IDEpIHJhdGVTdHIgPSAnfiAnICsgcmF0ZVN0ciAvLyBcIn5cIiBvbmx5IG1ha2VzIHNlbnNlIGlmIHRoZSBvcmRlciBoYXMgbW9yZSB0aGFuIG9uZSBtYXRjaC5cbiAgcmV0dXJuIHJhdGVTdHJcbn1cblxuLyogYXZlcmFnZVJhdGUgcmV0dXJucyBhIHRoZSBhdmVyYWdlIHJhdGUgb2YgdGhlIG1hdGNoZXMgdGhhdCBoYXZlIGJlZW4gZmlsbGVkXG5pbiBhbiBvcmRlci4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhdmVyYWdlUmF0ZSAob3JkOiBPcmRlcik6IG51bWJlciB7XG4gIGlmICghb3JkLm1hdGNoZXM/Lmxlbmd0aCkgcmV0dXJuIDBcbiAgbGV0IHJhdGVQcm9kdWN0ID0gMFxuICBsZXQgYmFzZVF0eSA9IDBcbiAgZm9yIChjb25zdCBtIG9mIG9yZC5tYXRjaGVzKSB7XG4gICAgYmFzZVF0eSArPSBtLnF0eVxuICAgIHJhdGVQcm9kdWN0ICs9IChtLnJhdGUgKiBtLnF0eSkgLy8gb3JkZXIgfiAxZTE2XG4gIH1cbiAgcmV0dXJuIHJhdGVQcm9kdWN0IC8gYmFzZVF0eVxufVxuXG4vKiBiYXNlVG9RdW90ZSByZXR1cm5zIHRoZSBxdWFudGl0eSBvZiB0aGUgcXVvdGUgYXNzZXQuICovXG5leHBvcnQgZnVuY3Rpb24gYmFzZVRvUXVvdGUgKHJhdGU6IG51bWJlciwgYmFzZTogbnVtYmVyKSA6IG51bWJlciB7XG4gIHJldHVybiByYXRlICogYmFzZSAvIFJhdGVFbmNvZGluZ0ZhY3RvclxufVxuXG4vKiBvcmRlclBvcnRpb24gcmV0dXJucyBhIHN0cmluZyBzdGF0aW5nIHRoZSBwZXJjZW50YWdlIG9mIHRoZSBvcmRlciBhIG1hdGNoXG4gICBtYWtlcyB1cC4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvcmRlclBvcnRpb24gKG9yZGVyOiBPcmRlciwgbWF0Y2g6IE1hdGNoKSA6IHN0cmluZyB7XG4gIGxldCBtYXRjaFF0eSA9IG1hdGNoLnF0eVxuICBpZiAoaXNNYXJrZXRCdXkob3JkZXIpKSB7XG4gICAgbWF0Y2hRdHkgPSBiYXNlVG9RdW90ZShtYXRjaC5yYXRlLCBtYXRjaC5xdHkpXG4gIH1cbiAgcmV0dXJuICgobWF0Y2hRdHkgLyBvcmRlci5xdHkpICogMTAwKS50b0ZpeGVkKDEpICsgJyAlJ1xufVxuXG4vKlxuICogbWF0Y2hTdGF0dXNTdHJpbmcgaXMgYSBzdHJpbmcgdXNlZCB0byBjcmVhdGUgYSBkaXNwbGF5YWJsZSBzdHJpbmcgZGVzY3JpYmluZ1xuICogZGVzY3JpYmluZyB0aGUgbWF0Y2ggc3RhdHVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hTdGF0dXNTdHJpbmcgKG06IE1hdGNoKSB7XG4gIGlmIChtLnJldm9rZWQpIHtcbiAgICAvLyBXaGVuIHJldm9rZWQsIG1hdGNoIHN0YXR1cyBpcyBsZXNzIGltcG9ydGFudCB0aGFuIHBlbmRpbmcgYWN0aW9uIGlmIHN0aWxsXG4gICAgLy8gYWN0aXZlLCBvciB0aGUgb3V0Y29tZSBpZiBpbmFjdGl2ZS5cbiAgICBpZiAobS5hY3RpdmUpIHtcbiAgICAgIGlmIChtLnJlZGVlbSkgcmV0dXJuIHJldm9rZWRNYXRjaFN0YXR1cyhpbnRsLklEX01BVENIX1NUQVRVU19SRURFTVBUSU9OX1NFTlQpIC8vIG11c3QgcmVxdWlyZSBjb25maXJtYXRpb24gaWYgYWN0aXZlXG4gICAgICAvLyBJZiBtYWtlciBhbmQgd2UgaGF2ZSBub3QgcmVkZWVtZWQsIHdhaXRpbmcgdG8gcmVmdW5kLCBhc3N1bWluZyBpdCdzIG5vdFxuICAgICAgLy8gcmV2b2tlZCB3aGlsZSB3YWl0aW5nIGZvciBjb25mcyBvbiBhbiB1bnNwZW50L3VuZXhwaXJlZCB0YWtlciBzd2FwLlxuICAgICAgaWYgKG0uc2lkZSA9PT0gTWFrZXIpIHJldHVybiByZXZva2VkTWF0Y2hTdGF0dXMoaW50bC5JRF9NQVRDSF9TVEFUVVNfUkVGVU5EX1BFTkRJTkcpXG4gICAgICAvLyBBcyB0YWtlciwgcmVzb2x1dGlvbiBkZXBlbmRzIG9uIG1ha2VyJ3MgYWN0aW9ucyB3aGlsZSB3YWl0aW5nIHRvIHJlZnVuZC5cbiAgICAgIGlmIChtLmNvdW50ZXJSZWRlZW0pIHJldHVybiByZXZva2VkTWF0Y2hTdGF0dXMoaW50bC5JRF9NQVRDSF9TVEFUVVNfUkVERUVNX1BFTkRJTkcpIC8vIHRoaXMgc2hvdWxkIGJlIHZlcnkgYnJpZWYgaWYgd2Ugc2VlIHRoZSBtYWtlcidzIHJlZGVlbVxuICAgICAgcmV0dXJuIHJldm9rZWRNYXRjaFN0YXR1cyhpbnRsLklEX01BVENIX1NUQVRVU19SRUZVTkRfUEVORElORykgLy8gbWF5IHN3aXRjaCB0byByZWRlZW0gaWYgbWFrZXIgcmVkZWVtcyBvbiB0aGUgc2x5XG4gICAgfVxuICAgIGlmIChtLnJlZnVuZCkge1xuICAgICAgcmV0dXJuIHJldm9rZWRNYXRjaFN0YXR1cyhpbnRsLklEX01BVENIX1NUQVRVU19SRUZVTkRFRClcbiAgICB9XG4gICAgaWYgKG0ucmVkZWVtKSB7XG4gICAgICByZXR1cm4gcmV2b2tlZE1hdGNoU3RhdHVzKGludGwuSURfTUFUQ0hfU1RBVFVTX1JFREVNUFRJT05fQ09ORklSTUVEKVxuICAgIH1cbiAgICByZXR1cm4gcmV2b2tlZE1hdGNoU3RhdHVzKGludGwuSURfTUFUQ0hfU1RBVFVTX0NPTVBMRVRFKSAvLyBpLmUuIHdlIHNlbnQgbm8gc3dhcFxuICB9XG5cbiAgc3dpdGNoIChtLnN0YXR1cykge1xuICAgIGNhc2UgTmV3bHlNYXRjaGVkOlxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BVENIX1NUQVRVU19ORVdMWV9NQVRDSEVEKVxuICAgIGNhc2UgTWFrZXJTd2FwQ2FzdDpcbiAgICAgIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9NQVRDSF9TVEFUVVNfTUFLRVJfU1dBUF9DQVNUKVxuICAgIGNhc2UgVGFrZXJTd2FwQ2FzdDpcbiAgICAgIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9NQVRDSF9TVEFUVVNfVEFLRVJfU1dBUF9DQVNUKVxuICAgIGNhc2UgTWFrZXJSZWRlZW1lZDpcbiAgICAgIGlmIChtLnNpZGUgPT09IE1ha2VyKSB7XG4gICAgICAgIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9NQVRDSF9TVEFUVVNfUkVERU1QVElPTl9TRU5UKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BVENIX1NUQVRVU19NQUtFUl9SRURFRU1FRClcbiAgICBjYXNlIE1hdGNoQ29tcGxldGU6XG4gICAgICByZXR1cm4gaW50bC5wcmVwKGludGwuSURfTUFUQ0hfU1RBVFVTX1JFREVNUFRJT05fU0VOVClcbiAgICBjYXNlIE1hdGNoQ29uZmlybWVkOlxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BVENIX1NUQVRVU19SRURFTVBUSU9OX0NPTkZJUk1FRClcbiAgfVxuICByZXR1cm4gaW50bC5wcmVwKGludGwuSURfVU5LTk9XTilcbn1cblxuLy8gcmV2b2tlZE1hdGNoU3RhdHVzIGlzIGEgaGVscGVyIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgcmV2b2tlZCBtYXRjaCBzdGF0dXNcbi8vIHN0cmluZy5cbmZ1bmN0aW9uIHJldm9rZWRNYXRjaFN0YXR1cyAobWF0Y2hTdGF0dXM6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9NQVRDSF9TVEFUVVNfUkVWT0tFRCwgeyBzdGF0dXM6IGludGwucHJlcChtYXRjaFN0YXR1cykgfSlcbn1cblxuLypcbiAqIG9wdGlvbkVsZW1lbnQgaXMgYSBnZXR0ZXIgZm9yIGFuIGVsZW1lbnQgbWF0Y2hpbmcgdGhlICpPcmRlck9wdGlvbiBmcm9tXG4gKiBjbGllbnQvYXNzZXQuIGNoYW5nZSBpcyBhIGZ1bmN0aW9uIHdpdGggbm8gYXJndW1lbnRzIHRoYXQgaXMgY2FsbGVkIHdoZW4gdGhlXG4gKiByZXR1cm5lZCBvcHRpb24ncyB2YWx1ZSBoYXMgY2hhbmdlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9wdGlvbkVsZW1lbnQgKG9wdDogT3JkZXJPcHRpb24sIG9yZGVyOiBUcmFkZUZvcm0sIGNoYW5nZTogKCkgPT4gdm9pZCwgaXNTd2FwOiBib29sZWFuKTogSFRNTEVsZW1lbnQge1xuICBjb25zdCBpc0Jhc2VDaGFpbiA9IChpc1N3YXAgJiYgb3JkZXIuc2VsbCkgfHwgKCFpc1N3YXAgJiYgIW9yZGVyLnNlbGwpXG4gIGNvbnN0IHN5bWJvbCA9IGlzQmFzZUNoYWluID8gZGV4QXNzZXRTeW1ib2wob3JkZXIuaG9zdCwgb3JkZXIuYmFzZSkgOiBkZXhBc3NldFN5bWJvbChvcmRlci5ob3N0LCBvcmRlci5xdW90ZSlcblxuICBzd2l0Y2ggKHRydWUpIHtcbiAgICBjYXNlICEhb3B0LmJvb2xlYW46XG4gICAgICByZXR1cm4gbmV3IEJvb2xlYW5PcHRpb24ob3B0LCBzeW1ib2wsIG9yZGVyLm9wdGlvbnMsIGNoYW5nZSkubm9kZVxuICAgIGNhc2UgISFvcHQueHlSYW5nZTpcbiAgICAgIHJldHVybiBuZXcgWFlSYW5nZU9wdGlvbihvcHQsIHN5bWJvbCwgb3JkZXIub3B0aW9ucywgY2hhbmdlKS5ub2RlXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ25vIG9wdGlvbiB0eXBlIHNwZWNpZmllZCcsIG9wdClcbiAgfVxuICBjb25zb2xlLmVycm9yKCd1bmtub3duIG9wdGlvbiB0eXBlJywgb3B0KVxuICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcbn1cblxuZnVuY3Rpb24gZGV4QXNzZXRTeW1ib2wgKGhvc3Q6IHN0cmluZywgYXNzZXRJRDogbnVtYmVyKTogc3RyaW5nIHtcbiAgcmV0dXJuIGFwcCgpLmV4Y2hhbmdlc1tob3N0XS5hc3NldHNbYXNzZXRJRF0uc3ltYm9sXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NhbmNlbGxhYmxlIChvcmQ6IE9yZGVyKTogYm9vbGVhbiB7XG4gIHJldHVybiBvcmQudHlwZSA9PT0gTGltaXQgJiYgb3JkLnRpZiA9PT0gU3RhbmRpbmdUaUYgJiYgb3JkLnN0YXR1cyA8IFN0YXR1c0V4ZWN1dGVkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBvcmRlclR5cGVUZXh0IChvcmRUeXBlOiBudW1iZXIpOiBzdHJpbmcge1xuICBzd2l0Y2ggKG9yZFR5cGUpIHtcbiAgICBjYXNlIE9yZGVyVHlwZUxpbWl0OlxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX0xJTUlUX09SREVSKVxuICAgIGNhc2UgT3JkZXJUeXBlTWFya2V0OlxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BUktFVF9PUkRFUilcbiAgICBkZWZhdWx0OiAvLyBPcmRlclR5cGVDYW5jZWxcbiAgICAgIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9DQU5DRUxfT1JERVIpXG4gIH1cbn1cbiIsImltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0IHtcbiAgTmV3V2FsbGV0Rm9ybSxcbiAgREVYQWRkcmVzc0Zvcm0sXG4gIERpc2NvdmVyQWNjb3VudEZvcm0sXG4gIENvbmZpcm1SZWdpc3RyYXRpb25Gb3JtLFxuICBGZWVBc3NldFNlbGVjdGlvbkZvcm0sXG4gIFdhbGxldFdhaXRGb3JtLFxuICBzbGlkZVN3YXBcbn0gZnJvbSAnLi9mb3JtcydcbmltcG9ydCB7XG4gIGFwcCxcbiAgRXhjaGFuZ2UsXG4gIFBhZ2VFbGVtZW50LFxuICBQcmVwYWlkQm9uZElEXG59IGZyb20gJy4vcmVnaXN0cnknXG5cbmludGVyZmFjZSBSZWdpc3RyYXRpb25QYWdlRGF0YSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBiYWNrVG8/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVnaXN0cmF0aW9uUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgYm9keTogSFRNTEVsZW1lbnRcbiAgZGF0YTogUmVnaXN0cmF0aW9uUGFnZURhdGFcbiAgeGM6IEV4Y2hhbmdlXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBkZXhBZGRyRm9ybTogREVYQWRkcmVzc0Zvcm1cbiAgZGlzY292ZXJBY2N0Rm9ybTogRGlzY292ZXJBY2NvdW50Rm9ybVxuICBuZXdXYWxsZXRGb3JtOiBOZXdXYWxsZXRGb3JtXG4gIHJlZ0Fzc2V0Rm9ybTogRmVlQXNzZXRTZWxlY3Rpb25Gb3JtXG4gIHdhbGxldFdhaXRGb3JtOiBXYWxsZXRXYWl0Rm9ybVxuICBjb25maXJtUmVnaXN0ZXJGb3JtOiBDb25maXJtUmVnaXN0cmF0aW9uRm9ybVxuXG4gIGNvbnN0cnVjdG9yIChib2R5OiBIVE1MRWxlbWVudCwgZGF0YTogUmVnaXN0cmF0aW9uUGFnZURhdGEpIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5ib2R5ID0gYm9keVxuICAgIHRoaXMuZGF0YSA9IGRhdGFcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoYm9keSlcblxuICAgIGlmIChkYXRhLmhvc3QgJiYgcGFnZS5kZXhBZGRyRm9ybS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgIHBhZ2UuZGV4QWRkckZvcm0uY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgICAgcGFnZS5kaXNjb3ZlckFjY3RGb3JtLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgIHBhZ2UuZGlzY292ZXJBY2N0Rm9ybS5kYXRhc2V0Lmhvc3QgPSBkYXRhLmhvc3RcbiAgICB9XG5cbiAgICAvLyBIaWRlIHRoZSBmb3JtIGNsb3NlcnMgZm9yIHRoZSByZWdpc3RyYXRpb24gcHJvY2VzcyBleGNlcHQgZm9yIHRoZVxuICAgIC8vIHBhc3N3b3JkIHJlc2V0IGZvcm0gY2xvc2VyLlxuICAgIGZvciAoY29uc3QgZWwgb2YgYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKSkgaWYgKGVsICE9PSBwYWdlLnJlc2V0UGFzc0Zvcm1DbG9zZXIpIERvYy5oaWRlKGVsKVxuXG4gICAgdGhpcy5uZXdXYWxsZXRGb3JtID0gbmV3IE5ld1dhbGxldEZvcm0oXG4gICAgICBwYWdlLm5ld1dhbGxldEZvcm0sXG4gICAgICBhc3NldElEID0+IHRoaXMubmV3V2FsbGV0Q3JlYXRlZChhc3NldElELCB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0udGllciksXG4gICAgICAoKSA9PiB0aGlzLmFuaW1hdGVSZWdBc3NldChwYWdlLm5ld1dhbGxldEZvcm0pXG4gICAgKVxuXG4gICAgLy8gQUREIERFWFxuICAgIHRoaXMuZGV4QWRkckZvcm0gPSBuZXcgREVYQWRkcmVzc0Zvcm0ocGFnZS5kZXhBZGRyRm9ybSwgYXN5bmMgKHhjLCBjZXJ0RmlsZSkgPT4ge1xuICAgICAgdGhpcy5yZXF1ZXN0RmVlcGF5bWVudChwYWdlLmRleEFkZHJGb3JtLCB4YywgY2VydEZpbGUpXG4gICAgfSlcblxuICAgIGNvbnN0IGFkZHIgPSBwYWdlLmRpc2NvdmVyQWNjdEZvcm0uZGF0YXNldC5ob3N0XG4gICAgaWYgKGFkZHIpIHtcbiAgICAgIHRoaXMuZGlzY292ZXJBY2N0Rm9ybSA9IG5ldyBEaXNjb3ZlckFjY291bnRGb3JtKHBhZ2UuZGlzY292ZXJBY2N0Rm9ybSwgYWRkciwgYXN5bmMgKHhjKSA9PiB7XG4gICAgICAgIHRoaXMucmVxdWVzdEZlZXBheW1lbnQocGFnZS5kaXNjb3ZlckFjY3RGb3JtLCB4YywgJycpXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIFNFTEVDVCBSRUcgQVNTRVRcbiAgICB0aGlzLnJlZ0Fzc2V0Rm9ybSA9IG5ldyBGZWVBc3NldFNlbGVjdGlvbkZvcm0ocGFnZS5yZWdBc3NldEZvcm0sIGFzeW5jIChhc3NldElEOiBudW1iZXIsIHRpZXI6IG51bWJlcikgPT4ge1xuICAgICAgaWYgKGFzc2V0SUQgPT09IFByZXBhaWRCb25kSUQpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlckRFWFN1Y2Nlc3MoKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBjb25zdCB3YWxsZXQgPSBhc3NldC53YWxsZXRcbiAgICAgIGlmICh3YWxsZXQpIHtcbiAgICAgICAgY29uc3QgYm9uZEFzc2V0ID0gdGhpcy54Yy5ib25kQXNzZXRzW2Fzc2V0LnN5bWJvbF1cbiAgICAgICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgICAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGllciwgYm9uZHNGZWVCdWZmZXIpXG4gICAgICAgIGlmICh3YWxsZXQuc3luY2VkICYmIHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA+PSAyICogYm9uZEFzc2V0LmFtb3VudCArIGJvbmRzRmVlQnVmZmVyKSB7XG4gICAgICAgICAgdGhpcy5hbmltYXRlQ29uZmlybUZvcm0ocGFnZS5yZWdBc3NldEZvcm0pXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53YWxsZXRXYWl0Rm9ybS5zZXRXYWxsZXQoYXNzZXRJRCwgYm9uZHNGZWVCdWZmZXIsIHRpZXIpXG4gICAgICAgIHNsaWRlU3dhcChwYWdlLnJlZ0Fzc2V0Rm9ybSwgcGFnZS53YWxsZXRXYWl0KVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS50aWVyID0gdGllclxuICAgICAgdGhpcy5uZXdXYWxsZXRGb3JtLnNldEFzc2V0KGFzc2V0SUQpXG4gICAgICBzbGlkZVN3YXAocGFnZS5yZWdBc3NldEZvcm0sIHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICB9KVxuXG4gICAgdGhpcy53YWxsZXRXYWl0Rm9ybSA9IG5ldyBXYWxsZXRXYWl0Rm9ybShwYWdlLndhbGxldFdhaXQsICgpID0+IHtcbiAgICAgIHRoaXMuYW5pbWF0ZUNvbmZpcm1Gb3JtKHBhZ2Uud2FsbGV0V2FpdClcbiAgICB9LCAoKSA9PiB7IHRoaXMuYW5pbWF0ZVJlZ0Fzc2V0KHBhZ2Uud2FsbGV0V2FpdCkgfSlcblxuICAgIC8vIFNVQk1JVCBERVggUkVHSVNUUkFUSU9OXG4gICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtID0gbmV3IENvbmZpcm1SZWdpc3RyYXRpb25Gb3JtKHBhZ2UuY29uZmlybVJlZ0Zvcm0sICgpID0+IHtcbiAgICAgIHRoaXMucmVnaXN0ZXJERVhTdWNjZXNzKClcbiAgICB9LCAoKSA9PiB7XG4gICAgICB0aGlzLmFuaW1hdGVSZWdBc3NldChwYWdlLmNvbmZpcm1SZWdGb3JtKVxuICAgIH0pXG5cbiAgICBjb25zdCBjdXJyZW50Rm9ybSA9IERvYy5zYWZlU2VsZWN0b3IocGFnZS5mb3JtcywgJzpzY29wZSA+IGZvcm0uc2VsZWN0ZWQnKVxuICAgIGN1cnJlbnRGb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICBzd2l0Y2ggKGN1cnJlbnRGb3JtKSB7XG4gICAgICBjYXNlIHBhZ2UuZGV4QWRkckZvcm06XG4gICAgICAgIHRoaXMuZGV4QWRkckZvcm0uYW5pbWF0ZSgpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIHBhZ2UuZGlzY292ZXJBY2N0Rm9ybTpcbiAgICAgICAgdGhpcy5kaXNjb3ZlckFjY3RGb3JtLmFuaW1hdGUoKVxuICAgIH1cbiAgICBEb2Muc2hvdyhjdXJyZW50Rm9ybSlcblxuICAgIC8vIFRoZXJlJ3Mgbm90aGluZyBvbiB0aGUgcGFnZS5kaXNjb3ZlckFjY3RGb3JtIGV4Y2VwdCB0byByZWNlaXZlIHVzZXIgcGFzc1xuICAgIC8vIGJlZm9yZSBhdHRlbXB0aW5nIHRvIGRpc2NvdmVyIHVzZXIgYWNjb3VudCBhbmQgdGhlcmUncyBubyBuZWVkIHRvIGhhdmVcbiAgICAvLyB0aGVtIGNsaWNrIGFub3RoZXIgYnV0dG9uIHdoZW4gd2UgY2FuIGNhcnJ5IG9uIHdpdGhvdXQgdXNlciBpbnRlcmFjdGlvbi5cbiAgICBpZiAoY3VycmVudEZvcm0gPT09IHBhZ2UuZGlzY292ZXJBY2N0Rm9ybSkge1xuICAgICAgdGhpcy5kaXNjb3ZlckFjY3RGb3JtLnBhZ2Uuc3VibWl0LmNsaWNrKClcbiAgICB9XG5cbiAgICBpZiAoYXBwKCkuYXV0aGVkKSB0aGlzLmF1dGgoKVxuICB9XG5cbiAgLy8gYXV0aCBzaG91bGQgYmUgY2FsbGVkIG9uY2UgdXNlciBpcyBrbm93biB0byBiZSBhdXRoZWQgd2l0aCB0aGUgc2VydmVyLlxuICBhc3luYyBhdXRoICgpIHtcbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICB9XG5cbiAgYXN5bmMgcmVxdWVzdEZlZXBheW1lbnQgKG9sZEZvcm06IEhUTUxFbGVtZW50LCB4YzogRXhjaGFuZ2UsIGNlcnRGaWxlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnhjID0geGNcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0RXhjaGFuZ2UoeGMsIGNlcnRGaWxlKVxuICAgIHRoaXMud2FsbGV0V2FpdEZvcm0uc2V0RXhjaGFuZ2UoeGMpXG4gICAgdGhpcy5yZWdBc3NldEZvcm0uc2V0RXhjaGFuZ2UoeGMsIGNlcnRGaWxlKVxuICAgIHRoaXMuYW5pbWF0ZVJlZ0Fzc2V0KG9sZEZvcm0pXG4gIH1cblxuICAvKiBTd2FwIGluIHRoZSBhc3NldCBzZWxlY3Rpb24gZm9ybSBhbmQgcnVuIHRoZSBhbmltYXRpb24uICovXG4gIGFzeW5jIGFuaW1hdGVSZWdBc3NldCAob2xkRm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICBEb2MuaGlkZShvbGRGb3JtKVxuICAgIHRoaXMucmVnQXNzZXRGb3JtLmFuaW1hdGUoKVxuICAgIERvYy5zaG93KHRoaXMucGFnZS5yZWdBc3NldEZvcm0pXG4gIH1cblxuICAvKiBTd2FwIGluIHRoZSBjb25maXJtYXRpb24gZm9ybSBhbmQgcnVuIHRoZSBhbmltYXRpb24uICovXG4gIGFzeW5jIGFuaW1hdGVDb25maXJtRm9ybSAob2xkRm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uYW5pbWF0ZSgpXG4gICAgRG9jLmhpZGUob2xkRm9ybSlcbiAgICBEb2Muc2hvdyh0aGlzLnBhZ2UuY29uZmlybVJlZ0Zvcm0pXG4gIH1cblxuICAvLyBSZXRyaWV2ZSBhbiBlc3RpbWF0ZSBmb3IgdGhlIHR4IGZlZSBuZWVkZWQgdG8gY3JlYXRlIG5ldyBib25kIHJlc2VydmVzLlxuICBhc3luYyBnZXRCb25kc0ZlZUJ1ZmZlciAoYXNzZXRJRDogbnVtYmVyLCBmb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcoZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9ib25kc2ZlZWJ1ZmZlcicsIHsgYXNzZXRJRCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHJldHVybiAwXG4gICAgfVxuICAgIHJldHVybiByZXMuZmVlQnVmZmVyXG4gIH1cblxuICAvKiBnZXRzIHRoZSBjb250ZW50cyBvZiB0aGUgY2VydCBmaWxlICovXG4gIGFzeW5jIGdldENlcnRGaWxlICgpIHtcbiAgICBsZXQgY2VydCA9ICcnXG4gICAgaWYgKHRoaXMuZGV4QWRkckZvcm0ucGFnZS5jZXJ0RmlsZS52YWx1ZSkge1xuICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmRleEFkZHJGb3JtLnBhZ2UuY2VydEZpbGUuZmlsZXNcbiAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGgpIGNlcnQgPSBhd2FpdCBmaWxlc1swXS50ZXh0KClcbiAgICB9XG4gICAgcmV0dXJuIGNlcnRcbiAgfVxuXG4gIC8qIENhbGxlZCBhZnRlciBzdWNjZXNzZnVsIHJlZ2lzdHJhdGlvbiB0byBhIERFWC4gKi9cbiAgYXN5bmMgcmVnaXN0ZXJERVhTdWNjZXNzICgpIHtcbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIGFwcCgpLnVwZGF0ZU1lbnVJdGVtc0Rpc3BsYXkoKVxuICAgIGF3YWl0IGFwcCgpLmxvYWRQYWdlKHRoaXMuZGF0YS5iYWNrVG8gfHwgJ21hcmtldHMnKVxuICB9XG5cbiAgYXN5bmMgbmV3V2FsbGV0Q3JlYXRlZCAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIpIHtcbiAgICB0aGlzLnJlZ0Fzc2V0Rm9ybS5yZWZyZXNoKClcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICBpZiAoIXVzZXIpIHJldHVyblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhc3NldCA9IHVzZXIuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3Qgd2FsbGV0ID0gYXNzZXQud2FsbGV0XG4gICAgY29uc3QgYm9uZEFtdCA9IHRoaXMueGMuYm9uZEFzc2V0c1thc3NldC5zeW1ib2xdLmFtb3VudFxuXG4gICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICB0aGlzLndhbGxldFdhaXRGb3JtLnNldFdhbGxldChhc3NldElELCBib25kc0ZlZUJ1ZmZlciwgdGllcilcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGllciwgYm9uZHNGZWVCdWZmZXIpXG4gICAgaWYgKHdhbGxldC5zeW5jZWQgJiYgd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlID49IDIgKiBib25kQW10ICsgYm9uZHNGZWVCdWZmZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuYW5pbWF0ZUNvbmZpcm1Gb3JtKHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGF3YWl0IHNsaWRlU3dhcChwYWdlLm5ld1dhbGxldEZvcm0sIHBhZ2Uud2FsbGV0V2FpdClcbiAgfVxufVxuIiwiZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICBsb2c6ICguLi5hcmdzOiBhbnkpID0+IHZvaWRcbiAgICBlbmFibGVMb2dnZXI6IChsb2dnZXJJRDogc3RyaW5nLCBlbmFibGU6IGJvb2xlYW4pID0+IHZvaWRcbiAgICByZWNvcmRMb2dnZXI6IChsb2dnZXJJRDogc3RyaW5nLCBlbmFibGU6IGJvb2xlYW4pID0+IHZvaWRcbiAgICBkdW1wTG9nZ2VyOiAobG9nZ2VySUQ6IHN0cmluZykgPT4gdm9pZFxuICAgIG1tc3RhdHVzOiAoKSA9PiBQcm9taXNlPE1hcmtldE1ha2luZ1N0YXR1cz5cbiAgICB0ZXN0Rm9ybWF0Rm91clNpZ0ZpZ3M6ICgpID0+IHZvaWRcbiAgICB0ZXN0Rm9ybWF0UmF0ZUZ1bGxQcmVjaXNpb246ICgpID0+IHZvaWRcbiAgICB1c2VyOiAoKSA9PiBVc2VyXG4gICAgY2V4Qm9vazogKCkgPT4gUHJvbWlzZTx2b2lkPlxuICAgIG1tU3RhdHVzOiAoKSA9PiBNYXJrZXRNYWtpbmdTdGF0dXNcbiAgICBpc1dlYnZpZXc/OiAoKSA9PiBib29sZWFuXG4gICAgd2Via2l0OiBhbnkgfCB1bmRlZmluZWRcbiAgICBvcGVuVXJsOiAodXJsOiBzdHJpbmcpID0+IHZvaWRcbiAgICBzZW5kT1NOb3RpZmljYXRpb24gKHRpdGxlOiBzdHJpbmcsIGJvZHk/OiBzdHJpbmcpOiB2b2lkXG4gICAgY2xlYXJMb2NhbGUgKCk6IHZvaWRcbiAgfVxufVxuXG5leHBvcnQgZW51bSBDb25uZWN0aW9uU3RhdHVzIHtcbiAgRGlzY29ubmVjdGVkID0gMCxcbiAgQ29ubmVjdGVkID0gMSxcbiAgSW52YWxpZENlcnQgPSAyLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvbmRPcHRpb25zIHtcbiAgYm9uZEFzc2V0SUQ6IG51bWJlclxuICB0YXJnZXRUaWVyOiBudW1iZXJcbiAgbWF4Qm9uZGVkQW10OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXB1dGF0aW9uIHtcbiAgYm9uZGVkVGllcjogbnVtYmVyXG4gIHBlbmFsdGllczogbnVtYmVyXG4gIGxlZ2FjeVRpZXI6IGJvb2xlYW5cbiAgc2NvcmU6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4Y2hhbmdlQXV0aCB7XG4gIHJlcDogUmVwdXRhdGlvblxuICBib25kQXNzZXRJRDogbnVtYmVyXG4gIHBlbmRpbmdTdHJlbmd0aDogbnVtYmVyXG4gIHdlYWtTdHJlbmd0aDogbnVtYmVyXG4gIGxpdmVTdHJlbmd0aDogbnVtYmVyXG4gIHRhcmdldFRpZXI6IG51bWJlclxuICBlZmZlY3RpdmVUaWVyOiBudW1iZXJcbiAgbWF4Qm9uZGVkQW10OiBudW1iZXJcbiAgcGVuYWx0eUNvbXBzOiBudW1iZXJcbiAgcGVuZGluZ0JvbmRzOiBQZW5kaW5nQm9uZFN0YXRlW11cbiAgZXhwaXJlZEJvbmRzOiBhbnlbXVxuICBjb21wZW5zYXRpb246IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4Y2hhbmdlIHtcbiAgaG9zdDogc3RyaW5nXG4gIGFjY3RJRDogc3RyaW5nXG4gIGF1dGg6IEV4Y2hhbmdlQXV0aFxuICBtYXJrZXRzOiBSZWNvcmQ8c3RyaW5nLCBNYXJrZXQ+XG4gIGFzc2V0czogUmVjb3JkPG51bWJlciwgQXNzZXQ+XG4gIGNvbm5lY3Rpb25TdGF0dXM6IENvbm5lY3Rpb25TdGF0dXNcbiAgdmlld09ubHk6IGJvb2xlYW5cbiAgYm9uZEFzc2V0czogUmVjb3JkPHN0cmluZywgQm9uZEFzc2V0PlxuICBjYW5kbGVEdXJzOiBzdHJpbmdbXVxuICBtYXhTY29yZTogbnVtYmVyXG4gIHBlbmFsdHlUaHJlc2hvbGQ6IG51bWJlclxuICBkaXNhYmxlZDpib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FuZGxlIHtcbiAgc3RhcnRTdGFtcDogbnVtYmVyXG4gIGVuZFN0YW1wOiBudW1iZXJcbiAgbWF0Y2hWb2x1bWU6IG51bWJlclxuICBxdW90ZVZvbHVtZTogbnVtYmVyXG4gIGhpZ2hSYXRlOiBudW1iZXJcbiAgbG93UmF0ZTogbnVtYmVyXG4gIHN0YXJ0UmF0ZTogbnVtYmVyXG4gIGVuZFJhdGU6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhbmRsZXNQYXlsb2FkIHtcbiAgZHVyOiBzdHJpbmdcbiAgbXM6IG51bWJlclxuICBjYW5kbGVzOiBDYW5kbGVbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcmtldCB7XG4gIG5hbWU6IHN0cmluZ1xuICBiYXNlaWQ6IG51bWJlclxuICBiYXNlc3ltYm9sOiBzdHJpbmdcbiAgcXVvdGVpZDogbnVtYmVyXG4gIHF1b3Rlc3ltYm9sOiBzdHJpbmdcbiAgbG90c2l6ZTogbnVtYmVyXG4gIHBhcmNlbHNpemU6IG51bWJlclxuICByYXRlc3RlcDogbnVtYmVyXG4gIGVwb2NobGVuOiBudW1iZXJcbiAgc3RhcnRlcG9jaDogbnVtYmVyXG4gIGJ1eWJ1ZmZlcjogbnVtYmVyXG4gIG9yZGVyczogT3JkZXJbXVxuICBzcG90OiBTcG90IHwgdW5kZWZpbmVkXG4gIGF0b21Ub0NvbnY6IG51bWJlclxuICBpbmZsaWdodDogSW5GbGlnaHRPcmRlcltdXG4gIG1pbmltdW1SYXRlOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbkZsaWdodE9yZGVyIGV4dGVuZHMgT3JkZXIge1xuICB0ZW1wSUQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyIHtcbiAgaG9zdDogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIGJhc2VTeW1ib2w6IHN0cmluZ1xuICBxdW90ZUlEOiBudW1iZXJcbiAgcXVvdGVTeW1ib2w6IHN0cmluZ1xuICBtYXJrZXQ6IHN0cmluZ1xuICB0eXBlOiBudW1iZXJcbiAgaWQ6IHN0cmluZ1xuICBzdGFtcDogbnVtYmVyXG4gIHN1Ym1pdFRpbWU6IG51bWJlclxuICBzaWc6IHN0cmluZ1xuICBzdGF0dXM6IG51bWJlclxuICBlcG9jaDogbnVtYmVyXG4gIHF0eTogbnVtYmVyXG4gIHNlbGw6IGJvb2xlYW5cbiAgZmlsbGVkOiBudW1iZXJcbiAgbWF0Y2hlczogTWF0Y2hbXVxuICBjYW5jZWxsaW5nOiBib29sZWFuXG4gIGNhbmNlbGVkOiBib29sZWFuXG4gIGZlZXNQYWlkOiBGZWVCcmVha2Rvd25cbiAgZnVuZGluZ0NvaW5zOiBDb2luW11cbiAgYWNjZWxlcmF0aW9uQ29pbnM6IENvaW5bXVxuICBsb2NrZWRhbXQ6IG51bWJlclxuICByYXRlOiBudW1iZXIgLy8gbGltaXQgb25seVxuICB0aWY6IG51bWJlciAvLyBsaW1pdCBvbmx5XG4gIHRhcmdldE9yZGVySUQ6IHN0cmluZyAvLyBjYW5jZWwgb25seVxuICByZWFkeVRvVGljazogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hdGNoIHtcbiAgbWF0Y2hJRDogc3RyaW5nXG4gIHN0YXR1czogbnVtYmVyXG4gIGFjdGl2ZTogYm9vbGVhblxuICByZXZva2VkOiBib29sZWFuXG4gIHJhdGU6IG51bWJlclxuICBxdHk6IG51bWJlclxuICBzaWRlOiBudW1iZXJcbiAgZmVlUmF0ZTogbnVtYmVyXG4gIHN3YXA6IENvaW5cbiAgY291bnRlclN3YXA6IENvaW5cbiAgcmVkZWVtOiBDb2luXG4gIGNvdW50ZXJSZWRlZW06IENvaW5cbiAgcmVmdW5kOiBDb2luXG4gIHN0YW1wOiBudW1iZXJcbiAgaXNDYW5jZWw6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTcG90IHtcbiAgc3RhbXA6IG51bWJlclxuICBiYXNlSUQ6IG51bWJlclxuICBxdW90ZUlEOiBudW1iZXJcbiAgcmF0ZTogbnVtYmVyXG4gIGJvb2tWb2x1bWU6IG51bWJlciAvLyBVbnVzZWQ/XG4gIGNoYW5nZTI0OiBudW1iZXJcbiAgdm9sMjQ6IG51bWJlclxuICBsb3cyNDogbnVtYmVyXG4gIGhpZ2gyNDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXNzZXQge1xuICBpZDogbnVtYmVyXG4gIHN5bWJvbDogc3RyaW5nXG4gIHZlcnNpb246IG51bWJlclxuICBtYXhGZWVSYXRlOiBudW1iZXJcbiAgc3dhcFNpemU6IG51bWJlclxuICBzd2FwU2l6ZUJhc2U6IG51bWJlclxuICByZWRlZW1TaXplOiBudW1iZXJcbiAgc3dhcENvbmY6IG51bWJlclxuICB1bml0SW5mbzogVW5pdEluZm9cbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb25kQXNzZXQge1xuICB2ZXI6IG51bWJlclxuICBpZDogbnVtYmVyXG4gIGNvbmZzOiBudW1iZXJcbiAgYW1vdW50OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQZW5kaW5nQm9uZFN0YXRlIHtcbiAgc3ltYm9sOiBzdHJpbmdcbiAgYXNzZXRJRDogbnVtYmVyXG4gIGNvaW5JRDogc3RyaW5nXG4gIGNvbmZzOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGZWVCcmVha2Rvd24ge1xuICBzd2FwOiBudW1iZXJcbiAgcmVkZW1wdGlvbjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3VwcG9ydGVkQXNzZXQge1xuICBpZDogbnVtYmVyXG4gIHN5bWJvbDogc3RyaW5nXG4gIG5hbWU6IHN0cmluZ1xuICB3YWxsZXQ6IFdhbGxldFN0YXRlXG4gIGluZm8/OiBXYWxsZXRJbmZvXG4gIHRva2VuPzogVG9rZW5cbiAgdW5pdEluZm86IFVuaXRJbmZvXG4gIHdhbGxldENyZWF0aW9uUGVuZGluZzogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRva2VuIHtcbiAgcGFyZW50SUQ6IG51bWJlclxuICBuYW1lOiBzdHJpbmdcbiAgdW5pdEluZm86IFVuaXRJbmZvXG4gIGNvbnRyYWN0QWRkcmVzczogc3RyaW5nXG4gIGRlZmluaXRpb246IFdhbGxldERlZmluaXRpb25cbn1cblxuZXhwb3J0IGVudW0gQXBwcm92YWxTdGF0dXMge1xuICBBcHByb3ZlZCA9IDAsXG4gIFBlbmRpbmcgPSAxLFxuICBOb3RBcHByb3ZlZCA9IDJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGZWVTdGF0ZSB7XG4gIHJhdGU6IG51bWJlclxuICBzZW5kOiBudW1iZXJcbiAgc3dhcDogbnVtYmVyXG4gIHJlZGVlbTogbnVtYmVyXG4gIHJlZnVuZDogbnVtYmVyXG4gIHN0YW1wTVM6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN5bmNTdGF0dXMge1xuICBzeW5jZWQ6IGJvb2xlYW5cbiAgdGFyZ2V0SGVpZ2h0OiBudW1iZXJcbiAgc3RhcnRpbmdCbG9ja3M6IG51bWJlclxuICBibG9ja3M6IG51bWJlclxuICB0eHM6IG51bWJlciB8IHVuZGVmaW5lZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldFN0YXRlIHtcbiAgc3ltYm9sOiBzdHJpbmdcbiAgYXNzZXRJRDogbnVtYmVyXG4gIHZlcnNpb246IG51bWJlclxuICB0eXBlOiBzdHJpbmdcbiAgdHJhaXRzOiBudW1iZXJcbiAgb3BlbjogYm9vbGVhblxuICBydW5uaW5nOiBib29sZWFuXG4gIGRpc2FibGVkOiBib29sZWFuXG4gIGJhbGFuY2U6IFdhbGxldEJhbGFuY2VcbiAgYWRkcmVzczogc3RyaW5nXG4gIHVuaXRzOiBzdHJpbmdcbiAgZW5jcnlwdGVkOiBib29sZWFuXG4gIHBlZXJDb3VudDogbnVtYmVyXG4gIHN5bmNlZDogYm9vbGVhblxuICBzeW5jUHJvZ3Jlc3M6IG51bWJlclxuICBzeW5jU3RhdHVzOiBTeW5jU3RhdHVzXG4gIGFwcHJvdmVkOiBSZWNvcmQ8bnVtYmVyLCBBcHByb3ZhbFN0YXR1cz5cbiAgZmVlU3RhdGU/OiBGZWVTdGF0ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldEluZm8ge1xuICBuYW1lOiBzdHJpbmdcbiAgdmVyc2lvbjogbnVtYmVyXG4gIGF2YWlsYWJsZXdhbGxldHM6IFdhbGxldERlZmluaXRpb25bXVxuICB2ZXJzaW9uczogbnVtYmVyW11cbiAgZW1wdHlpZHg6IG51bWJlclxuICB1bml0aW5mbzogVW5pdEluZm9cbn1cblxuZXhwb3J0IGludGVyZmFjZSBXYWxsZXRCYWxhbmNlIHtcbiAgYXZhaWxhYmxlOiBudW1iZXJcbiAgaW1tYXR1cmU6IG51bWJlclxuICBsb2NrZWQ6IG51bWJlclxuICBzdGFtcDogc3RyaW5nIC8vIHRpbWUuVGltZVxuICBvcmRlcmxvY2tlZDogbnVtYmVyXG4gIGNvbnRyYWN0bG9ja2VkOiBudW1iZXJcbiAgYm9uZGxvY2tlZDogbnVtYmVyXG4gIGJvbmRSZXNlcnZlczogbnVtYmVyXG4gIHJlc2VydmVzRGVmaWNpdDogbnVtYmVyXG4gIG90aGVyOiBSZWNvcmQ8c3RyaW5nLCBDdXN0b21CYWxhbmNlPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1c3RvbUJhbGFuY2Uge1xuICBhbXQ6IG51bWJlclxuICBsb2NrZWQ6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBXYWxsZXREZWZpbml0aW9uIHtcbiAgc2VlZGVkOiBib29sZWFuXG4gIHR5cGU6IHN0cmluZ1xuICB0YWI6IHN0cmluZ1xuICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gIGNvbmZpZ3BhdGg6IHN0cmluZ1xuICBjb25maWdvcHRzOiBDb25maWdPcHRpb25bXVxuICBtdWx0aWZ1bmRpbmdvcHRzOiBPcmRlck9wdGlvbltdXG4gIG5vYXV0aDogYm9vbGVhblxuICBndWlkZWxpbms6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbmZpZ09wdGlvbiB7XG4gIGtleTogc3RyaW5nXG4gIGRpc3BsYXluYW1lOiBzdHJpbmdcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xuICBkZWZhdWx0OiBhbnlcbiAgbWF4OiBhbnlcbiAgbWluOiBhbnlcbiAgbm9lY2hvOiBib29sZWFuXG4gIGlzYm9vbGVhbjogYm9vbGVhblxuICBpc2RhdGU6IGJvb2xlYW5cbiAgZGlzYWJsZXdoZW5hY3RpdmU6IGJvb2xlYW5cbiAgaXNCaXJ0aGRheUNvbmZpZzogYm9vbGVhblxuICByZXBlYXRhYmxlPzogc3RyaW5nXG4gIHJlcGVhdE4/OiBudW1iZXJcbiAgcmVnQXNzZXQ/OiBudW1iZXJcbiAgcmVxdWlyZWQ/OiBib29sZWFuXG4gIGRlcGVuZHNPbj86IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvaW4ge1xuICBpZDogc3RyaW5nXG4gIHN0cmluZ0lEOiBzdHJpbmdcbiAgYXNzZXRJRDogbnVtYmVyXG4gIHN5bWJvbDogc3RyaW5nXG4gIGNvbmZzOiBDb25maXJtYXRpb25zXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlybWF0aW9ucyB7XG4gIHJlcXVpcmVkOiBudW1iZXJcbiAgY291bnQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVuaXRJbmZvIHtcbiAgYXRvbWljVW5pdDogc3RyaW5nXG4gIGNvbnZlbnRpb25hbDogRGVub21pbmF0aW9uXG4gIGRlbm9taW5hdGlvbnM6IERlbm9taW5hdGlvbltdXG4gIGZlZVJhdGVEZW5vbTogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVub21pbmF0aW9uIHtcbiAgdW5pdDogc3RyaW5nXG4gIGNvbnZlcnNpb25GYWN0b3I6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4dGVuc2lvbkNvbmZpZ3VyZWRXYWxsZXQge1xuICBoaWRkZW5GaWVsZHM6IHN0cmluZ1tdXG4gIGRpc2FibGVXYWxsZXRUeXBlOiBib29sZWFuXG4gIGRpc2FibGVQYXNzd29yZDogYm9vbGVhblxuICBkaXNhYmxlU3Rha2luZzogYm9vbGVhblxuICBkaXNhYmxlUHJpdmFjeTogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4dGVuc2lvbk1vZGVDb25maWcge1xuICBuYW1lOiBzdHJpbmdcbiAgcmVzdHJpY3RlZFdhbGxldHM6IFJlY29yZDxzdHJpbmcsIEV4dGVuc2lvbkNvbmZpZ3VyZWRXYWxsZXQ+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XG4gIGV4Y2hhbmdlczogUmVjb3JkPHN0cmluZywgRXhjaGFuZ2U+XG4gIGluaXRlZDogYm9vbGVhblxuICBzZWVkZ2VudGltZTogbnVtYmVyXG4gIGFzc2V0czogUmVjb3JkPG51bWJlciwgU3VwcG9ydGVkQXNzZXQ+XG4gIGZpYXRSYXRlczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICBib3RzOiBCb3RSZXBvcnRbXVxuICBuZXQ6IG51bWJlclxuICBleHRlbnNpb25Nb2RlQ29uZmlnOiBFeHRlbnNpb25Nb2RlQ29uZmlnXG4gIGFjdGlvbnM6IEFjdGlvblJlcXVpcmVkTm90ZVtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29yZU5vdGUge1xuICB0eXBlOiBzdHJpbmdcbiAgdG9waWM6IHN0cmluZ1xuICBzdWJqZWN0OiBzdHJpbmdcbiAgZGV0YWlsczogc3RyaW5nXG4gIHNldmVyaXR5OiBudW1iZXJcbiAgc3RhbXA6IG51bWJlclxuICBhY2tlZDogYm9vbGVhblxuICBpZDogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9uZE5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGFzc2V0OiBudW1iZXJcbiAgY29uZmlybWF0aW9uczogbnVtYmVyXG4gIGRleDogc3RyaW5nXG4gIGNvaW5JRDogc3RyaW5nIHwgbnVsbFxuICB0aWVyOiBudW1iZXIgfCBudWxsXG4gIGF1dGg6IEV4Y2hhbmdlQXV0aCB8IG51bGxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXB1dGF0aW9uTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgaG9zdDogc3RyaW5nXG4gIHJlcDogUmVwdXRhdGlvblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJhbGFuY2VOb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBhc3NldElEOiBudW1iZXJcbiAgYmFsYW5jZTogV2FsbGV0QmFsYW5jZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJhdGVOb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBmaWF0UmF0ZXM6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBXYWxsZXRDb25maWdOb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICB3YWxsZXQ6IFdhbGxldFN0YXRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2FsbGV0U3luY05vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGFzc2V0SUQ6IG51bWJlclxuICBzeW5jU3RhdHVzOiBTeW5jU3RhdHVzXG4gIHN5bmNQcm9ncmVzczogbnVtYmVyXG59XG5cbmV4cG9ydCB0eXBlIFdhbGxldFN0YXRlTm90ZSA9IFdhbGxldENvbmZpZ05vdGVcblxuZXhwb3J0IGludGVyZmFjZSBXYWxsZXRDcmVhdGlvbk5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGFzc2V0SUQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2VXYWxsZXROb3RlIHtcbiAgcm91dGU6IHN0cmluZ1xuICBhc3NldElEOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUaXBDaGFuZ2VOb3RlIGV4dGVuZHMgQmFzZVdhbGxldE5vdGUge1xuICB0aXA6IG51bWJlclxuICBkYXRhOiBhbnlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21XYWxsZXROb3RlIGV4dGVuZHMgQmFzZVdhbGxldE5vdGUge1xuICBwYXlsb2FkOiBhbnlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2FjdGlvbk5vdGUgZXh0ZW5kcyBCYXNlV2FsbGV0Tm90ZSB7XG4gIHRyYW5zYWN0aW9uOiBXYWxsZXRUcmFuc2FjdGlvblxuICBuZXc6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBBY3Rpb25SZXF1aXJlZE5vdGUgZXh0ZW5kcyBCYXNlV2FsbGV0Tm90ZSB7XG4gIHVuaXF1ZUlEOiBzdHJpbmdcbiAgYWN0aW9uSUQ6IHN0cmluZ1xuICBwYXlsb2FkOiBhbnlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBY3Rpb25SZXNvbHZlZE5vdGUgZXh0ZW5kcyBCYXNlV2FsbGV0Tm90ZSB7XG4gIHVuaXF1ZUlEOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2FjdGlvbkFjdGlvbk5vdGUge1xuICB0eDogV2FsbGV0VHJhbnNhY3Rpb25cbiAgbm9uY2U6IG51bWJlclxuICBuZXdGZWVzOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXYWxsZXROb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBwYXlsb2FkOiBCYXNlV2FsbGV0Tm90ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvcmVBY3Rpb25SZXF1aXJlZE5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIHBheWxvYWQ6IEFjdGlvblJlcXVpcmVkTm90ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlamVjdGVkUmVkZW1wdGlvbkRhdGEge1xuICBhc3NldElEOiBudW1iZXJcbiAgb3JkZXJJRDogc3RyaW5nXG4gIGNvaW5JRDogc3RyaW5nXG4gIGNvaW5GbXQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNwb3RQcmljZU5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBzcG90czogUmVjb3JkPHN0cmluZywgU3BvdD5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBSdW5TdGF0c05vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBiYXNlSUQ6IG51bWJlclxuICBxdW90ZUlEOiBudW1iZXJcbiAgc3RhdHM/OiBSdW5TdGF0c1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJ1bkV2ZW50Tm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgaG9zdDogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICBzdGFydFRpbWU6IG51bWJlclxuICBldmVudDogTWFya2V0TWFraW5nRXZlbnRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNYWtlclByb2dyYW0ge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIGxvdHM6IG51bWJlclxuICBvcmFjbGVXZWlnaHRpbmc6IG51bWJlclxuICBvcmFjbGVCaWFzOiBudW1iZXJcbiAgZHJpZnRUb2xlcmFuY2U6IG51bWJlclxuICBnYXBGYWN0b3I6IG51bWJlclxuICBnYXBTdHJhdGVneTogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90T3JkZXIge1xuICBob3N0OiBzdHJpbmdcbiAgbWFya2V0SUQ6IHN0cmluZ1xuICBvcmRlcklEOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb3RSZXBvcnQge1xuICBwcm9ncmFtSUQ6IG51bWJlclxuICBwcm9ncmFtOiBNYWtlclByb2dyYW1cbiAgcnVubmluZzogYm9vbGVhblxuICBvcmRlcnM6IEJvdE9yZGVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG90RmVlcyB7XG4gIHN3YXA6IG51bWJlclxuICByZWRlZW06IG51bWJlclxuICByZWZ1bmQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExvdEZlZVJhbmdlIHtcbiAgbWF4OiBMb3RGZWVzXG4gIGVzdGltYXRlZDogTG90RmVlc1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFzc2V0Qm9va2luZ0ZlZXMgZXh0ZW5kcyBMb3RGZWVSYW5nZSB7XG4gIGJvb2tpbmdGZWVzUGVyTG90OiBudW1iZXJcbiAgYm9va2luZ0ZlZXNQZXJDb3VudGVyTG90OiBudW1iZXJcbiAgYm9va2luZ0ZlZXM6IG51bWJlclxuICBzd2FwUmVzZXJ2ZXNGYWN0b3I6IG51bWJlciAvLyAoMSArIG9yZGVyUmVzZXJ2ZXNGYWN0b3IpXG4gIHJlZGVlbVJlc2VydmVzRmFjdG9yOiBudW1iZXJcbiAgdG9rZW5GZWVzUGVyU3dhcDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9va2luZ0ZlZXMge1xuICBiYXNlOiBBc3NldEJvb2tpbmdGZWVzXG4gIHF1b3RlOkFzc2V0Qm9va2luZ0ZlZXNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNYXJrZXRSZXBvcnQge1xuICBwcmljZTogbnVtYmVyXG4gIG9yYWNsZXM6IE9yYWNsZVJlcG9ydFtdXG4gIGJhc2VGaWF0UmF0ZTogbnVtYmVyXG4gIHF1b3RlRmlhdFJhdGU6IG51bWJlclxuICBiYXNlRmVlczogTG90RmVlUmFuZ2VcbiAgcXVvdGVGZWVzOiBMb3RGZWVSYW5nZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hdGNoTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgb3JkZXJJRDogc3RyaW5nXG4gIG1hdGNoOiBNYXRjaFxuICBob3N0OiBzdHJpbmdcbiAgbWFya2V0SUQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbm5FdmVudE5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBjb25uZWN0aW9uU3RhdHVzOiBDb25uZWN0aW9uU3RhdHVzXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3JkZXJOb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBvcmRlcjogT3JkZXJcbiAgdGVtcElEOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZWNlbnRNYXRjaCB7XG4gIHJhdGU6IG51bWJlclxuICBxdHk6IG51bWJlclxuICBzdGFtcDogbnVtYmVyXG4gIHNlbGw6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBFcG9jaE5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBtYXJrZXRJRDogc3RyaW5nXG4gIGVwb2NoOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBUElSZXNwb25zZSB7XG4gIHJlcXVlc3RTdWNjZXNzZnVsOiBib29sZWFuXG4gIG9rOiBib29sZWFuXG4gIG1zZzogc3RyaW5nXG4gIGVycj86IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExvZ01lc3NhZ2Uge1xuICB0aW1lOiBzdHJpbmdcbiAgbXNnOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBOb3RlRWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgbm90ZTogQ29yZU5vdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCYWxhbmNlUmVzcG9uc2UgZXh0ZW5kcyBBUElSZXNwb25zZSB7XG4gIGJhbGFuY2U6IFdhbGxldEJhbGFuY2Vcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMYXlvdXRNZXRyaWNzIHtcbiAgYm9keVRvcDogbnVtYmVyXG4gIGJvZHlMZWZ0OiBudW1iZXJcbiAgd2lkdGg6IG51bWJlclxuICBoZWlnaHQ6IG51bWJlclxuICBjZW50ZXJYOiBudW1iZXJcbiAgY2VudGVyWTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFnZUVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIHZhbHVlPzogc3RyaW5nXG4gIHNyYz86IHN0cmluZ1xuICBmaWxlcz86IEZpbGVMaXN0XG4gIGNoZWNrZWQ/OiBib29sZWFuXG4gIGhyZWY/OiBzdHJpbmdcbiAgaHRtbEZvcj86IHN0cmluZ1xuICBuYW1lPzogc3RyaW5nXG4gIG9wdGlvbnM/OiBIVE1MT3B0aW9uRWxlbWVudFtdXG4gIHNlbGVjdGVkSW5kZXg/OiBudW1iZXJcbiAgZGlzYWJsZWQ/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9vbGVhbkNvbmZpZyB7XG4gIHJlYXNvbjogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgWFlSYW5nZVBvaW50IHtcbiAgbGFiZWw6IHN0cmluZ1xuICB4OiBudW1iZXJcbiAgeTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgWFlSYW5nZSB7XG4gIHN0YXJ0OiBYWVJhbmdlUG9pbnRcbiAgZW5kOiBYWVJhbmdlUG9pbnRcbiAgeFVuaXQ6IHN0cmluZ1xuICB5VW5pdDogc3RyaW5nXG4gIHJvdW5kWD86IGJvb2xlYW5cbiAgcm91bmRZPzogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyT3B0aW9uIGV4dGVuZHMgQ29uZmlnT3B0aW9uIHtcbiAgYm9vbGVhbj86IEJvb2xlYW5Db25maWdcbiAgeHlSYW5nZT86IFhZUmFuZ2VcbiAgc2hvd0J5RGVmYXVsdD86IGJvb2xlYW5cbiAgcXVvdGVBc3NldE9ubHk/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3dhcEVzdGltYXRlIHtcbiAgbG90czogbnVtYmVyXG4gIHZhbHVlOiBudW1iZXJcbiAgbWF4RmVlczogbnVtYmVyXG4gIHJlYWxpc3RpY1dvcnN0Q2FzZTogbnVtYmVyXG4gIHJlYWxpc3RpY0Jlc3RDYXNlOiBudW1iZXJcbiAgZmVlUmVzZXJ2ZXNQZXJMb3Q6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlZGVlbUVzdGltYXRlIHtcbiAgcmVhbGlzdGljQmVzdENhc2U6IG51bWJlclxuICByZWFsaXN0aWNXb3JzdENhc2U6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByZVN3YXAge1xuICBlc3RpbWF0ZTogU3dhcEVzdGltYXRlXG4gIG9wdGlvbnM6IE9yZGVyT3B0aW9uW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcmVSZWRlZW0ge1xuICBlc3RpbWF0ZTogUmVkZWVtRXN0aW1hdGVcbiAgb3B0aW9uczogT3JkZXJPcHRpb25bXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyRXN0aW1hdGUge1xuICBzd2FwOiBQcmVTd2FwXG4gIHJlZGVlbTogUHJlUmVkZWVtXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWF4T3JkZXJFc3RpbWF0ZSB7XG4gIHN3YXA6IFN3YXBFc3RpbWF0ZVxuICByZWRlZW06IFJlZGVlbUVzdGltYXRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWF4U2VsbCB7XG4gIG1heFNlbGw6IE1heE9yZGVyRXN0aW1hdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNYXhCdXkge1xuICBtYXhCdXk6IE1heE9yZGVyRXN0aW1hdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFkZUZvcm0ge1xuICBob3N0OiBzdHJpbmdcbiAgaXNMaW1pdDogYm9vbGVhblxuICBzZWxsOiBib29sZWFuXG4gIGJhc2U6IG51bWJlclxuICBxdW90ZTogbnVtYmVyXG4gIHF0eTogbnVtYmVyXG4gIHJhdGU6IG51bWJlclxuICB0aWZub3c6IGJvb2xlYW5cbiAgb3B0aW9uczogUmVjb3JkPHN0cmluZywgYW55PlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvb2tVcGRhdGUge1xuICBhY3Rpb246IHN0cmluZ1xuICBob3N0OiBzdHJpbmdcbiAgbWFya2V0SUQ6IHN0cmluZ1xuICBtYXRjaGVzU3VtbWFyeTogUmVjZW50TWF0Y2hbXVxuICBwYXlsb2FkOiBhbnlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNaW5pT3JkZXIge1xuICBxdHk6IG51bWJlclxuICBxdHlBdG9taWM6IG51bWJlclxuICByYXRlOiBudW1iZXJcbiAgbXNnUmF0ZTogbnVtYmVyXG4gIGVwb2NoOiBudW1iZXJcbiAgc2VsbDogYm9vbGVhblxuICB0b2tlbjogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29yZU9yZGVyQm9vayB7XG4gIHNlbGxzOiBNaW5pT3JkZXJbXVxuICBidXlzOiBNaW5pT3JkZXJbXVxuICBlcG9jaDogTWluaU9yZGVyW11cbiAgcmVjZW50TWF0Y2hlczogUmVjZW50TWF0Y2hbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcmtldE9yZGVyQm9vayB7XG4gIGJhc2U6IG51bWJlclxuICBxdW90ZTogbnVtYmVyXG4gIGJvb2s6IENvcmVPcmRlckJvb2tcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZW1haW5kZXJVcGRhdGUge1xuICB0b2tlbjogc3RyaW5nXG4gIHF0eTogbnVtYmVyXG4gIHF0eUF0b21pYzogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3JkZXJGaWx0ZXJNYXJrZXQge1xuICBiYXNlSUQ6IG51bWJlclxuICBxdW90ZUlEOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcmRlckZpbHRlciB7XG4gIG4/OiBudW1iZXJcbiAgb2Zmc2V0Pzogc3RyaW5nXG4gIGhvc3RzPzogc3RyaW5nW11cbiAgYXNzZXRzPzogbnVtYmVyW11cbiAgbWFya2V0PzogT3JkZXJGaWx0ZXJNYXJrZXRcbiAgc3RhdHVzZXM/OiBudW1iZXJbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyUGxhY2VtZW50IHtcbiAgbG90czogbnVtYmVyXG4gIGdhcEZhY3RvcjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXV0b1JlYmFsYW5jZUNvbmZpZyB7XG4gIG1pbkJhc2VUcmFuc2ZlcjogbnVtYmVyXG4gIG1pblF1b3RlVHJhbnNmZXI6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2ljTWFya2V0TWFraW5nQ29uZmlnIHtcbiAgZ2FwU3RyYXRlZ3k6IHN0cmluZ1xuICBzZWxsUGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXVxuICBidXlQbGFjZW1lbnRzOiBPcmRlclBsYWNlbWVudFtdXG4gIGRyaWZ0VG9sZXJhbmNlOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBcmJNYXJrZXRNYWtpbmdQbGFjZW1lbnQge1xuICBsb3RzOiBudW1iZXJcbiAgbXVsdGlwbGllcjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXJiTWFya2V0TWFraW5nQ29uZmlnIHtcbiAgYnV5UGxhY2VtZW50czogQXJiTWFya2V0TWFraW5nUGxhY2VtZW50W11cbiAgc2VsbFBsYWNlbWVudHM6IEFyYk1hcmtldE1ha2luZ1BsYWNlbWVudFtdXG4gIHByb2ZpdDogbnVtYmVyXG4gIGRyaWZ0VG9sZXJhbmNlOiBudW1iZXJcbiAgb3JkZXJQZXJzaXN0ZW5jZTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2ltcGxlQXJiQ29uZmlnIHtcbiAgcHJvZml0VHJpZ2dlcjogbnVtYmVyXG4gIG1heEFjdGl2ZUFyYnM6IG51bWJlclxuICBudW1FcG9jaHNMZWF2ZU9wZW46IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvdENFWENmZyB7XG4gIG5hbWU6IHN0cmluZ1xuICBhdXRvUmViYWxhbmNlPzogQXV0b1JlYmFsYW5jZUNvbmZpZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvdEJhbGFuY2VBbGxvY2F0aW9uIHtcbiAgZGV4OiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIGNleDogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvdEFzc2V0Q29uZmlnIHtcbiAgc3dhcEZlZU46IG51bWJlclxuICBvcmRlclJlc2VydmVzRmFjdG9yOiBudW1iZXJcbiAgc2xpcHBhZ2VCdWZmZXJGYWN0b3I6IG51bWJlclxuICB0cmFuc2ZlckZhY3RvcjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVUlDb25maWcge1xuICBiYXNlQ29uZmlnOiBCb3RBc3NldENvbmZpZ1xuICBxdW90ZUNvbmZpZzogQm90QXNzZXRDb25maWdcbiAgc2ltcGxlQXJiTG90cz86IG51bWJlclxuICBjZXhSZWJhbGFuY2U6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFydENvbmZpZyBleHRlbmRzIE1hcmtldFdpdGhIb3N0IHtcbiAgYXV0b1JlYmFsYW5jZT86IEF1dG9SZWJhbGFuY2VDb25maWdcbiAgYWxsb2M6IEJvdEJhbGFuY2VBbGxvY2F0aW9uXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90Q29uZmlnIHtcbiAgaG9zdDogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICBiYXNlV2FsbGV0T3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgcXVvdGVXYWxsZXRPcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICBjZXhOYW1lOiBzdHJpbmdcbiAgdWlDb25maWc6IFVJQ29uZmlnXG4gIGJhc2ljTWFya2V0TWFraW5nQ29uZmlnPzogQmFzaWNNYXJrZXRNYWtpbmdDb25maWdcbiAgYXJiTWFya2V0TWFraW5nQ29uZmlnPzogQXJiTWFya2V0TWFraW5nQ29uZmlnXG4gIHNpbXBsZUFyYkNvbmZpZz86IFNpbXBsZUFyYkNvbmZpZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENFWENvbmZpZyB7XG4gIG5hbWU6IHN0cmluZ1xuICBhcGlLZXk6IHN0cmluZ1xuICBhcGlTZWNyZXQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcmtldFdpdGhIb3N0IHtcbiAgaG9zdDogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1NQ0VYU3RhdHVzIHtcbiAgY29uZmlnOiBDRVhDb25maWdcbiAgY29ubmVjdGVkOiBib29sZWFuXG4gIGNvbm5lY3RFcnI6IHN0cmluZ1xuICBtYXJrZXRzOiBSZWNvcmQ8c3RyaW5nLCBDRVhNYXJrZXQ+XG4gIGJhbGFuY2VzOiBSZWNvcmQ8bnVtYmVyLCBFeGNoYW5nZUJhbGFuY2U+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90QmFsYW5jZSB7XG4gIGF2YWlsYWJsZTogbnVtYmVyXG4gIGxvY2tlZDogbnVtYmVyXG4gIHBlbmRpbmc6IG51bWJlclxuICByZXNlcnZlZDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90QmFsYW5jZXMge1xuICBkZXg6IEJvdEJhbGFuY2VcbiAgY2V4OiBCb3RCYWxhbmNlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90SW52ZW50b3J5IHtcbiAgYXZhaWw6IG51bWJlclxuICBsb2NrZWQ6IG51bWJlciAvLyBpbmNsdWRlcyBCb3RCYWxhbmNlLnJlc2VydmVkXG4gIHRvdGFsOiBudW1iZXIgLy8gYXZhaWwgKyBsb2NrZWRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSdW5uaW5nQm90SW52ZW50b3J5IHtcbiAgYXZhaWw6IG51bWJlclxuICBsb2NrZWQ6IG51bWJlclxuICBkZXg6IEJvdEludmVudG9yeVxuICBjZXg6IEJvdEludmVudG9yeVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENFWE5vdGlmaWNhdGlvbiBleHRlbmRzIENvcmVOb3RlIHtcbiAgY2V4TmFtZTogc3RyaW5nXG4gIG5vdGU6IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENFWEJhbGFuY2VVcGRhdGUge1xuICBhc3NldElEOiBudW1iZXJcbiAgYmFsYW5jZTogRXhjaGFuZ2VCYWxhbmNlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXBvY2hSZXBvcnROb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIHJlcG9ydD86IEVwb2NoUmVwb3J0XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ0VYUHJvYmxlbXNOb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIHByb2JsZW1zPzogQ0VYUHJvYmxlbXNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGZWVFc3RpbWF0ZXMgZXh0ZW5kcyBMb3RGZWVSYW5nZSB7XG4gIGJvb2tpbmdGZWVzUGVyTG90OiBudW1iZXJcbiAgYm9va2luZ0ZlZXM6IG51bWJlclxuICB0b2tlbkZlZXNQZXJTd2FwOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcm9qZWN0ZWRBbGxvYyB7XG4gIC8vIGJvb2sgaXMgaW52ZW50b3J5IGRlZGljYXRlZCBlaXRoZXIgdG8gYWN0aXZlIG9yZGVycyBmb3IgYmFzaWNtbSBhbmQgYXJibW0sXG4gIC8vIG9yIG9uIHJlc2VydmUgZm9yIG9yZGVycyBpbiB0aGUgY2FzZSBvZiBiYXNpY2FyYi4gYm9vayArIGJvb2tpbmdGZWVzIGlzIHRoZVxuICAvLyBzdGFydmF0aW9uIHRocmVzaG9sZCBmb3IgREVYLCBtZWFuaW5nIGl0J3MgaW1wb3NzaWJsZSB0byBzdGFydCBhIGJvdFxuICAvLyB1bnN0YXJ2ZWQgaWYgdGhlcmUgbm8gd2F5IHRvIGdldCBib29rICsgYm9va2luZ0ZlZXMgdG8gQmlzb24gV2FsbGV0LiBBIHVzZXJcbiAgLy8gY291bGQgcG90ZW50aWFsbHkgYWRqdXN0IG9yZGVyIHJlc2VydmVzIG9yIHN3YXAgZmVlIHJlc2VydmVzIHRvIGZyZWUgdXBcbiAgLy8gbW9yZSBmdW5kcywgYnV0IHdpdGggcG9zc2libGUgZGVncmFkYXRpb24gb2YgYm90IHBlcmZvcm1hbmNlLlxuICBib29rOiBudW1iZXJcbiAgLy8gYm9va2luZyBmZWVzIGlzIGZ1bmRpbmcgZGVkaWNhdGVkIHRvIGNvdmVyaW5nIHRoZSBmZWVzIGZvciBmdW5kZWQgb3JkZXJzLlxuICAvLyBib29raW5nRmVlcyBhcmUgaW4gdGhlIHVuaXRzIG9mIHRoZSBwYXJlbnQgY2hhaW4gZm9yIHRva2VuIGFzc2V0cy5cbiAgYm9va2luZ0ZlZXM6IG51bWJlclxuICAvLyBzd2FwRmVlUmVzZXJ2ZXMgaXMgb25seSByZXF1aXJlZCBmb3IgdG9rZW4gYXNzZXRzLiBUaGVzZSBhcmUgZmVlc1xuICAvLyByZXNlcnZlZCBmb3IgZnVuZGluZyBzd2Fwcy4gVGhlc2UgZmVlcyBhcmUgb25seSBkZWJpdGVkLCBzbyB3aWxsIGRlZmluaXRlbHlcbiAgLy8gcnVuIG91dCBldmVudHVhbGx5LCBidXQgd2UnbGwgZ2V0IGEgVUkgdGhhdCBlbmFibGVkIG1hbnVhbCBhbmQvb3IgYXV0b1xuICAvLyByZWZpbGwgc29vbi4gc3dhcEZlZVJlc2VydmVzIGFyZSBpbiB0aGUgdW5pdHMgb2YgdGhlIHBhcmVudCBjaGFpbi5cbiAgc3dhcEZlZVJlc2VydmVzOiBudW1iZXJcbiAgLy8gY2V4IGlzIHRoZSBpbnZlbnRvcnkgZGVkaWNhdGVkIHRvIGZ1bmRpbmcgY291bnRlci1vcmRlcnMgb24gY2V4IGZvciBhblxuICAvLyBhcmJtbSBvciBzaW1wbGVhcmIgYm90LiBjZXggaXMgdGhlIHN0YXJ2YXRpb24gdGhyZXNob2xkIGZvciBDRVguXG4gIGNleDogbnVtYmVyXG4gIC8vIG9yZGVyUmVzZXJ2ZXMgaXMgaW52ZW50b3J5IHJlc2VydmVkIGZvciBmYWNpbGl0YXRpbmcgd2l0aGRyYXdzIGFuZFxuICAvLyBkZXBvc2l0cyBvciBmb3IgcmVwbGFjaW5nIG1hdGNoZWQgb3JkZXJzLiBJdCdzIGEgZ29vZCBpZGVhIHRvIGhhdmUgYVxuICAvLyBsaXR0bGUgZXh0cmEgYXJvdW5kLCBvdGhlcndpc2UgYSB0cmFkZSBzZXF1ZW5jZSBnb25lIHdyb25nIGNvdWxkIHB1dFxuICAvLyB0aGUgYm90IGluIGEgc3RhcnZlZCBvciB1bmJhbGFuY2VkIHN0YXRlLlxuICBvcmRlclJlc2VydmVzOiBudW1iZXJcbiAgLy8gc2xpcHBhZ2VCdWZmZXIgaXMgb25seSByZXF1aXJlZCBmb3IgdGhlIHF1b3RlIGFzc2V0LiBUaGlzIGFjY291bnRzIGZvclxuICAvLyB2YXJpYXRpb25zIGluIHJhdGUsIGJlY2F1c2UgdGhlIHF1b3RlIGFzc2V0J3MgXCJsb3Qgc2l6ZVwiIHZhcmllcyB3aXRoXG4gIC8vIHJhdGUuIElmIHRoZSByYXRlIGdvZXMgZG93biwgdGhlIHF1b3RlLWNvbnZlcnRlZCBsb3Qgc2l6ZSBnb2VzIHVwLCBzb1xuICAvLyB3ZSdsbCBsZXQgdGhlIHVzZXIgY2hvb3NlIHRvIHJlc2VydmUgYSBsaXR0bGUgZXh0cmEgZm9yIHRoaXMgY2FzZS5cbiAgc2xpcHBhZ2VCdWZmZXI6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlZUdhcFN0YXRzIHtcbiAgYmFzaXNQcmljZTogbnVtYmVyXG4gIGZlZUdhcDogbnVtYmVyXG4gIHJlbW90ZUdhcDogbnVtYmVyXG4gIHJvdW5kVHJpcEZlZXM6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJ1blN0YXRzIHtcbiAgaW5pdGlhbEJhbGFuY2VzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIGRleEJhbGFuY2VzOiBSZWNvcmQ8bnVtYmVyLCBCb3RCYWxhbmNlPlxuICBjZXhCYWxhbmNlczogUmVjb3JkPG51bWJlciwgQm90QmFsYW5jZT5cbiAgcHJvZml0TG9zczogUHJvZml0TG9zc1xuICBzdGFydFRpbWU6IG51bWJlclxuICBwZW5kaW5nRGVwb3NpdHM6IG51bWJlclxuICBwZW5kaW5nV2l0aGRyYXdhbHM6IG51bWJlclxuICBjb21wbGV0ZWRNYXRjaGVzOiBudW1iZXJcbiAgdHJhZGVkVVNEOiBudW1iZXJcbiAgZmVlR2FwOiBGZWVHYXBTdGF0c1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0YW1wZWRFcnJvciB7XG4gIHN0YW1wOiBudW1iZXJcbiAgZXJyb3I6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvdFByb2JsZW1zIHtcbiAgd2FsbGV0Tm90U3luY2VkOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPlxuICBub1dhbGxldFBlZXJzOiBSZWNvcmQ8bnVtYmVyLCBib29sZWFuPlxuICBhY2NvdW50U3VzcGVuZGVkOiBib29sZWFuXG4gIHVzZXJMaW1pdFRvb0xvdzogYm9vbGVhblxuICBub1ByaWNlU291cmNlOiBib29sZWFuXG4gIG9yYWNsZUZpYXRNaXNtYXRjaDogYm9vbGVhblxuICBjZXhPcmRlcmJvb2tVbnN5bmNlZDogYm9vbGVhblxuICBjYXVzZXNTZWxmTWF0Y2g6IGJvb2xlYW5cbiAgdW5rbm93bkVycm9yOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFkZVBsYWNlbWVudCB7XG4gIHJhdGU6IG51bWJlclxuICBsb3RzOiBudW1iZXJcbiAgc3RhbmRpbmdMb3RzOiBudW1iZXJcbiAgb3JkZXJlZExvdHM6IG51bWJlclxuICBjb3VudGVyVHJhZGVSYXRlOiBudW1iZXJcbiAgcmVxdWlyZWREZXg6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbiAgcmVxdWlyZWRDZXg6IG51bWJlclxuICB1c2VkRGV4OiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIHVzZWRDZXg6IG51bWJlclxuICBjYXVzZXNTZWxmTWF0Y2g6IGJvb2xlYW5cbiAgZXJyb3I/OiBCb3RQcm9ibGVtc1xuICByZWFzb246IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyUmVwb3J0IHtcbiAgcGxhY2VtZW50czogVHJhZGVQbGFjZW1lbnRbXVxuICBmZWVzOiBMb3RGZWVSYW5nZVxuICBhdmFpbGFibGVEZXhCYWxzOiBSZWNvcmQ8bnVtYmVyLCBCb3RCYWxhbmNlPlxuICByZXF1aXJlZERleEJhbHM6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbiAgcmVtYWluaW5nRGV4QmFsczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICB1c2VkRGV4QmFsczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICBhdmFpbGFibGVDZXhCYWw6IEJvdEJhbGFuY2VcbiAgcmVxdWlyZWRDZXhCYWw6IG51bWJlclxuICByZW1haW5pbmdDZXhCYWw6IG51bWJlclxuICB1c2VkQ2V4QmFsOiBudW1iZXJcbiAgZXJyb3I/OiBCb3RQcm9ibGVtc1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVwb2NoUmVwb3J0IHtcbiAgZXBvY2hOdW06IG51bWJlclxuICBwcmVPcmRlclByb2JsZW1zPzogQm90UHJvYmxlbXNcbiAgYnV5c1JlcG9ydD86IE9yZGVyUmVwb3J0XG4gIHNlbGxzUmVwb3J0PzogT3JkZXJSZXBvcnRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDRVhQcm9ibGVtcyB7XG4gIGRlcG9zaXRFcnI6IFJlY29yZDxudW1iZXIsIFN0YW1wZWRFcnJvcj5cbiAgd2l0aGRyYXdFcnI6IFJlY29yZDxudW1iZXIsIFN0YW1wZWRFcnJvcj5cbiAgdHJhZGVFcnI6IFN0YW1wZWRFcnJvclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1NQm90U3RhdHVzIHtcbiAgY29uZmlnOiBCb3RDb25maWdcbiAgcnVubmluZzogYm9vbGVhblxuICBydW5TdGF0cz86IFJ1blN0YXRzXG4gIGxhdGVzdEVwb2NoPzogRXBvY2hSZXBvcnRcbiAgY2V4UHJvYmxlbXM/OiBDRVhQcm9ibGVtc1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcmtldE1ha2luZ1N0YXR1cyB7XG4gIGNleGVzOiBSZWNvcmQ8c3RyaW5nLCBNTUNFWFN0YXR1cz5cbiAgYm90czogTU1Cb3RTdGF0dXNbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIERFWE9yZGVyRXZlbnQge1xuICBpZDogc3RyaW5nXG4gIHJhdGU6IG51bWJlclxuICBxdHk6IG51bWJlclxuICBzZWxsOiBib29sZWFuXG4gIHRyYW5zYWN0aW9uczogV2FsbGV0VHJhbnNhY3Rpb25bXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENFWE9yZGVyRXZlbnQge1xuICBpZDogc3RyaW5nXG4gIHJhdGU6IG51bWJlclxuICBxdHk6IG51bWJlclxuICBzZWxsOiBib29sZWFuXG4gIGJhc2VGaWxsZWQ6IG51bWJlclxuICBxdW90ZUZpbGxlZDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVwb3NpdEV2ZW50IHtcbiAgYXNzZXRJRDogbnVtYmVyXG4gIHRyYW5zYWN0aW9uOiBXYWxsZXRUcmFuc2FjdGlvblxuICBjZXhDcmVkaXQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdpdGhkcmF3YWxFdmVudCB7XG4gIGlkOiBzdHJpbmdcbiAgYXNzZXRJRDogbnVtYmVyXG4gIHRyYW5zYWN0aW9uOiBXYWxsZXRUcmFuc2FjdGlvblxuICBjZXhEZWJpdDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFsYW5jZUVmZmVjdHMge1xuICBzZXR0bGVkOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIHBlbmRpbmc6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbiAgbG9ja2VkOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIHJlc2VydmVkOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFya2V0TWFraW5nRXZlbnQge1xuICBpZDogbnVtYmVyXG4gIHRpbWVzdGFtcDogbnVtYmVyXG4gIGJhbGFuY2VFZmZlY3RzOiBCYWxhbmNlRWZmZWN0c1xuICBwZW5kaW5nOiBib29sZWFuXG4gIGRleE9yZGVyRXZlbnQ/OiBERVhPcmRlckV2ZW50XG4gIGNleE9yZGVyRXZlbnQ/OiBDRVhPcmRlckV2ZW50XG4gIGRlcG9zaXRFdmVudD86IERlcG9zaXRFdmVudFxuICB3aXRoZHJhd2FsRXZlbnQ/OiBXaXRoZHJhd2FsRXZlbnRcbn1cblxuaW50ZXJmYWNlIE1hcmtldERheSB7XG4gIHZvbDogbnVtYmVyXG4gIHF1b3RlVm9sOiBudW1iZXJcbiAgcHJpY2VDaGFuZ2U6IG51bWJlclxuICBwcmljZUNoYW5nZVBjdDogbnVtYmVyXG4gIGF2Z1ByaWNlOiBudW1iZXJcbiAgbGFzdFByaWNlOiBudW1iZXJcbiAgb3BlblByaWNlOiBudW1iZXJcbiAgaGlnaFByaWNlOiBudW1iZXJcbiAgbG93UHJpY2U6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENFWE1hcmtldCB7XG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICBiYXNlTWluV2l0aGRyYXc6IG51bWJlclxuICBxdW90ZU1pbldpdGhkcmF3OiBudW1iZXJcbiAgZGF5OiBNYXJrZXREYXlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcmFjbGVSZXBvcnQge1xuICBob3N0OiBzdHJpbmdcbiAgdXNkVm9sOiBudW1iZXJcbiAgYmVzdEJ1eTogbnVtYmVyXG4gIGJlc3RTZWxsOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFeGNoYW5nZUJhbGFuY2Uge1xuICBhdmFpbGFibGU6IG51bWJlclxuICBsb2NrZWQ6IG51bWJlclxufVxuXG4vLyBjaGFuZ2luZyB0aGUgb3JkZXIgb2YgdGhlIGVsZW1lbnRzIGluIHRoaXMgZW51bSB3aWxsIGFmZmVjdFxuLy8gdGhlIHNvcnRpbmcgb2YgdGhlIHBlZXJzIHRhYmxlIGluIHdhbGxldHMudHMuXG5leHBvcnQgZW51bSBQZWVyU291cmNlIHtcbiAgV2FsbGV0RGVmYXVsdCxcbiAgVXNlckFkZGVkLFxuICBEaXNjb3ZlcmVkLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJhbGFuY2VTdGF0ZSB7XG4gIGZpYXRSYXRlczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICBiYWxhbmNlczogUmVjb3JkPG51bWJlciwgQm90QmFsYW5jZT5cbiAgaW52TW9kczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFtb3VudCB7XG4gIGF0b21zOiBudW1iZXJcbiAgY29udmVudGlvbmFsOiBudW1iZXJcbiAgZm10OiBzdHJpbmdcbiAgdXNkOiBudW1iZXJcbiAgZm10VVNEOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcm9maXRMb3NzIHtcbiAgaW5pdGlhbDogUmVjb3JkPG51bWJlciwgQW1vdW50PlxuICBpbml0aWFsVVNEOiBudW1iZXJcbiAgbW9kczogUmVjb3JkPG51bWJlciwgQW1vdW50PlxuICBtb2RzVVNEOiBudW1iZXJcbiAgZmluYWw6IFJlY29yZDxudW1iZXIsIEFtb3VudD5cbiAgZmluYWxVU0Q6IG51bWJlclxuICBkaWZmczogUmVjb3JkPG51bWJlciwgQW1vdW50PlxuICBwcm9maXQ6IG51bWJlclxuICBwcm9maXRSYXRpbzogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhbXBlZEJvdENvbmZpZyB7XG4gIHRpbWVzdGFtcDogbnVtYmVyXG4gIGNmZzogQm90Q29uZmlnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFya2V0TWFraW5nUnVuT3ZlcnZpZXcge1xuICBlbmRUaW1lOiBudW1iZXJcbiAgY2ZnczogU3RhbXBlZEJvdENvbmZpZ1tdXG4gIGluaXRpYWxCYWxhbmNlczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICBwcm9maXRMb3NzOiBQcm9maXRMb3NzXG4gIGZpbmFsU3RhdGU6IEJhbGFuY2VTdGF0ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldFBlZXIge1xuICBhZGRyOiBzdHJpbmdcbiAgc291cmNlOiBQZWVyU291cmNlXG4gIGNvbm5lY3RlZDogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRpY2tldFRyYW5zYWN0aW9uIHtcbiAgaGFzaDogc3RyaW5nXG4gIHRpY2tldFByaWNlOiBudW1iZXJcbiAgZmVlczogbnVtYmVyXG4gIHN0YW1wOiBudW1iZXJcbiAgYmxvY2tIZWlnaHQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRpY2tldCB7XG4gIHR4OiBUaWNrZXRUcmFuc2FjdGlvblxuICBzdGF0dXM6IG51bWJlclxuICBzcGVuZGVyOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUQkNob2ljZSB7XG4gIGlkOiBzdHJpbmdcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRCQWdlbmRhIHtcbiAgaWQ6IHN0cmluZ1xuICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gIGN1cnJlbnRDaG9pY2U6IHN0cmluZ1xuICBjaG9pY2VzOiBUQkNob2ljZVtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVEtleVBvbGljeVJlc3VsdCB7XG4gIGtleTogc3RyaW5nXG4gIHBvbGljeTogc3RyaW5nXG4gIHRpY2tldD86IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRCVHJlYXN1cnlTcGVuZCB7XG4gIGhhc2g6IHN0cmluZ1xuICB2YWx1ZTogbnVtYmVyXG4gIGN1cnJlbnRQb2xpY3k6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0YW5jZXMge1xuICBhZ2VuZGFzOiBUQkFnZW5kYVtdXG4gIHRzcGVuZHM6IFRCVHJlYXN1cnlTcGVuZFtdXG4gIHRyZWFzdXJ5S2V5czogVEtleVBvbGljeVJlc3VsdFtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGlja2V0U3RhdHMge1xuICB0b3RhbFJld2FyZHM6IG51bWJlclxuICB0aWNrZXRDb3VudDogbnVtYmVyXG4gIHZvdGVzOiBudW1iZXJcbiAgcmV2b2tlczogbnVtYmVyXG4gIG1lbXBvb2w6IG51bWJlclxuICBxdWV1ZWQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRpY2tldFN0YWtpbmdTdGF0dXMge1xuICB0aWNrZXRQcmljZTogbnVtYmVyXG4gIHZvdGluZ1N1YnNpZHk6IG51bWJlclxuICB2c3A6IHN0cmluZ1xuICBpc1JQQzogYm9vbGVhblxuICB0aWNrZXRzOiBUaWNrZXRbXVxuICBzdGFuY2VzOiBTdGFuY2VzXG4gIHN0YXRzOiBUaWNrZXRTdGF0c1xufVxuXG4vLyBWb3RpbmdTZXJ2aWNlUHJvdmlkZXIgaXMgaW5mb3JtYXRpb24gYWJvdXQgYSB2b3Rpbmcgc2VydmljZSBwcm92aWRlci5cbmV4cG9ydCBpbnRlcmZhY2UgVm90aW5nU2VydmljZVByb3ZpZGVyIHtcbiAgdXJsOiBzdHJpbmdcbiAgbmV0d29yazogbnVtYmVyXG4gIGxhdW5jaGVkOiBudW1iZXJcbiAgbGFzdFVwZGF0ZWQ6IG51bWJlclxuICBhcGlWZXJzaW9uczogbnVtYmVyW11cbiAgZmVlUGVyY2VudGFnZTogbnVtYmVyXG4gIGNsb3NlZDogYm9vbGVhblxuICB2b3Rpbmc6IG51bWJlclxuICB2b3RlZDogbnVtYmVyXG4gIHJldm9rZWQ6IG51bWJlclxuICB2c3BkVmVyc2lvbjogc3RyaW5nXG4gIGJsb2NrSGVpZ2h0OiBudW1iZXJcbiAgbmV0U2hhcmU6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvbmRUeEluZm8ge1xuICBib25kSUQ6IHN0cmluZ1xuICBsb2NrVGltZTogbnVtYmVyXG4gIGFjY291bnRJRDogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2FsbGV0VHJhbnNhY3Rpb24ge1xuICB0eXBlOiBudW1iZXJcbiAgaWQ6IHN0cmluZ1xuICBhbW91bnQ6IG51bWJlclxuICBmZWVzOiBudW1iZXJcbiAgdGltZXN0YW1wOiBudW1iZXJcbiAgYmxvY2tOdW1iZXI6IG51bWJlclxuICB0b2tlbklEPzogbnVtYmVyXG4gIHJlY2lwaWVudD86IHN0cmluZ1xuICBib25kSW5mbz86IEJvbmRUeEluZm9cbiAgYWRkaXRpb25hbERhdGE6IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUeEhpc3RvcnlSZXN1bHQge1xuICB0eHMgOiBXYWxsZXRUcmFuc2FjdGlvbltdXG4gIGxhc3RUeDogYm9vbGVhblxufVxuXG5leHBvcnQgY29uc3QgUHJlcGFpZEJvbmRJRCA9IDIxNDc0ODM2NDdcblxuZXhwb3J0IGludGVyZmFjZSBBcHBsaWNhdGlvbiB7XG4gIGFzc2V0czogUmVjb3JkPG51bWJlciwgU3VwcG9ydGVkQXNzZXQ+XG4gIHNlZWRHZW5UaW1lOiBudW1iZXJcbiAgdXNlcjogVXNlclxuICBtbVN0YXR1czogTWFya2V0TWFraW5nU3RhdHVzXG4gIGhlYWRlcjogSFRNTEVsZW1lbnRcbiAgaGVhZGVyU3BhY2U6IEhUTUxFbGVtZW50XG4gIHdhbGxldE1hcDogUmVjb3JkPG51bWJlciwgV2FsbGV0U3RhdGU+XG4gIGV4Y2hhbmdlczogUmVjb3JkPHN0cmluZywgRXhjaGFuZ2U+XG4gIGZpYXRSYXRlc01hcDogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICBzaG93UG9wdXBzOiBib29sZWFuXG4gIGNvbW1pdEhhc2g6IHN0cmluZ1xuICBhdXRoZWQ6IGJvb2xlYW5cbiAgc3RhcnQgKCk6IFByb21pc2U8dm9pZD5cbiAgcmVjb25uZWN0ZWQgKCk6IHZvaWRcbiAgZmV0Y2hVc2VyICgpOiBQcm9taXNlPFVzZXIgfCB2b2lkPlxuICBmZXRjaE1NU3RhdHVzICgpOiBQcm9taXNlPFVzZXIgfCB2b2lkPlxuICBsb2FkUGFnZSAocGFnZTogc3RyaW5nLCBkYXRhPzogYW55LCBza2lwUHVzaD86IGJvb2xlYW4pOiBQcm9taXNlPGJvb2xlYW4+XG4gIGF0dGFjaCAoZGF0YTogYW55KTogdm9pZFxuICBiaW5kVG9vbHRpcHMgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCk6IHZvaWRcbiAgYmluZFVybEhhbmRsZXJzIChhbmNlc3RvcjogSFRNTEVsZW1lbnQpOiB2b2lkXG4gIGF0dGFjaEhlYWRlciAoKTogdm9pZFxuICB1cGRhdGVNYXJrZXRFbGVtZW50cyAoYW5jZXN0b3I6IFBhZ2VFbGVtZW50LCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCB4Yz86IEV4Y2hhbmdlKTogdm9pZFxuICBzaG93RHJvcGRvd24gKGljb246IEhUTUxFbGVtZW50LCBkaWFsb2c6IEhUTUxFbGVtZW50KTogdm9pZFxuICBhY2tOb3RlcyAoKTogdm9pZFxuICBzZXROb3RlVGltZXMgKG5vdGVMaXN0OiBIVE1MRWxlbWVudCk6IHZvaWRcbiAgYmluZEludGVybmFsTmF2aWdhdGlvbiAoYW5jZXN0b3I6IEhUTUxFbGVtZW50KTogdm9pZFxuICB1cGRhdGVNZW51SXRlbXNEaXNwbGF5ICgpOiB2b2lkXG4gIGF0dGFjaENvbW1vbiAobm9kZTogSFRNTEVsZW1lbnQpOiB2b2lkXG4gIHVwZGF0ZUJvbmRDb25mcyAoZGV4QWRkcjogc3RyaW5nLCBjb2luSUQ6IHN0cmluZywgY29uZnM6IG51bWJlciwgYXNzZXRJRDogbnVtYmVyKTogdm9pZFxuICBoYW5kbGVCb25kTm90ZSAobm90ZTogQm9uZE5vdGUpOiB2b2lkXG4gIGxvZ2dlZEluIChub3RlczogQ29yZU5vdGVbXSwgcG9rZXM6IENvcmVOb3RlW10pOiB2b2lkXG4gIHNldFBva2VzKHBva2VzOiBDb3JlTm90ZVtdKTogdm9pZFxuICBib3RTdGF0dXMgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcik6IE1NQm90U3RhdHVzIHwgdW5kZWZpbmVkXG4gIG5vdGlmeSAobm90ZTogQ29yZU5vdGUpOiB2b2lkXG4gIGxvZyAobG9nZ2VySUQ6IHN0cmluZywgLi4ubXNnOiBhbnkpOiB2b2lkXG4gIHByZXBlbmRQb2tlRWxlbWVudCAobm90ZTogQ29yZU5vdGUpOiB2b2lkXG4gIHByZXBlbmROb3RlRWxlbWVudCAobm90ZTogQ29yZU5vdGUsIHNraXBTYXZlPzogYm9vbGVhbik6IHZvaWRcbiAgcHJlcGVuZExpc3RFbGVtZW50IChub3RlTGlzdDogSFRNTEVsZW1lbnQsIG5vdGU6IENvcmVOb3RlLCBlbDogTm90ZUVsZW1lbnQpOiB2b2lkXG4gIGxvYWRpbmcgKGVsOiBIVE1MRWxlbWVudCk6ICgpID0+IHZvaWRcbiAgb3JkZXJzIChob3N0OiBzdHJpbmcsIG1rdElEOiBzdHJpbmcpOiBPcmRlcltdXG4gIGhhdmVBY3RpdmVPcmRlcnMgKGFzc2V0SUQ6IG51bWJlcik6IGJvb2xlYW5cbiAgb3JkZXIgKG9pZDogc3RyaW5nKTogT3JkZXIgfCBudWxsXG4gIGNhbkFjY2VsZXJhdGVPcmRlcihvcmRlcjogT3JkZXIpOiBib29sZWFuXG4gIHVuaXRJbmZvIChhc3NldElEOiBudW1iZXIsIHhjPzogRXhjaGFuZ2UpOiBVbml0SW5mb1xuICBiYXNlQ2hhaW5TeW1ib2wgKGFzc2V0SUQ6IG51bWJlcik6IHN0cmluZ1xuICBleHRlbnNpb25XYWxsZXQgKGFzc2V0SUQ6IG51bWJlcik6IEV4dGVuc2lvbkNvbmZpZ3VyZWRXYWxsZXQgfCB1bmRlZmluZWRcbiAgY29udmVudGlvbmFsUmF0ZSAoYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlciwgZW5jUmF0ZTogbnVtYmVyLCB4Yz86IEV4Y2hhbmdlKTogbnVtYmVyXG4gIHdhbGxldERlZmluaXRpb24gKGFzc2V0SUQ6IG51bWJlciwgd2FsbGV0VHlwZTogc3RyaW5nKTogV2FsbGV0RGVmaW5pdGlvblxuICBjdXJyZW50V2FsbGV0RGVmaW5pdGlvbiAoYXNzZXRJRDogbnVtYmVyKTogV2FsbGV0RGVmaW5pdGlvblxuICBmZXRjaEJhbGFuY2UgKGFzc2V0SUQ6IG51bWJlcik6IFByb21pc2U8V2FsbGV0QmFsYW5jZT5cbiAgY2hlY2tSZXNwb25zZSAocmVzcDogQVBJUmVzcG9uc2UpOiBib29sZWFuXG4gIHNpZ25PdXQgKCk6IFByb21pc2U8dm9pZD5cbiAgcmVnaXN0ZXJOb3RlRmVlZGVyIChyZWNlaXZlcnM6IFJlY29yZDxzdHJpbmcsIChuOiBDb3JlTm90ZSkgPT4gdm9pZD4pOiB2b2lkXG4gIHR4SGlzdG9yeShhc3NldElEOiBudW1iZXIsIG46IG51bWJlciwgYWZ0ZXI/OiBzdHJpbmcpOiBQcm9taXNlPFR4SGlzdG9yeVJlc3VsdD5cbiAgZ2V0V2FsbGV0VHgoYXNzZXRJRDogbnVtYmVyLCB0eGlkOiBzdHJpbmcpOiBXYWxsZXRUcmFuc2FjdGlvbiB8IHVuZGVmaW5lZFxuICBjbGVhclR4SGlzdG9yeShhc3NldElEOiBudW1iZXIpOiB2b2lkXG4gIHBhcmVudEFzc2V0KGFzc2V0SUQ6IG51bWJlcik6IFN1cHBvcnRlZEFzc2V0XG4gIG5lZWRzQ3VzdG9tUHJvdmlkZXIgKGFzc2V0SUQ6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj5cbn1cblxuLy8gVE9ETzogRGVmaW5lIGFuIGludGVyZmFjZSBmb3IgQXBwbGljYXRpb24/XG5sZXQgYXBwbGljYXRpb246IEFwcGxpY2F0aW9uXG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckFwcGxpY2F0aW9uIChhOiBBcHBsaWNhdGlvbikge1xuICBhcHBsaWNhdGlvbiA9IGFcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFwcCAoKTogQXBwbGljYXRpb24ge1xuICByZXR1cm4gYXBwbGljYXRpb25cbn1cbiIsImltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0IHsgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQgKiBhcyBmb3JtcyBmcm9tICcuL2Zvcm1zJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQgeyBzZXRDb2luSHJlZiB9IGZyb20gJy4vY29pbmV4cGxvcmVycydcbmltcG9ydCB7XG4gIHVwZGF0ZU50Zm5TZXR0aW5nLFxuICBEZXNrdG9wTnRmblNldHRpbmcsXG4gIGZldGNoRGVza3RvcE50Zm5TZXR0aW5ncyxcbiAgZGVza3RvcE50Zm5MYWJlbHMsXG4gIE5vdGlmaWVyXG59IGZyb20gJy4vbm90aWZpY2F0aW9ucydcbmltcG9ydCB7XG4gIGFwcCxcbiAgRXhjaGFuZ2UsXG4gIFBhZ2VFbGVtZW50LFxuICBQcmVwYWlkQm9uZElEXG59IGZyb20gJy4vcmVnaXN0cnknXG5cbmNvbnN0IGFuaW1hdGlvbkxlbmd0aCA9IDMwMFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXR0aW5nc1BhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIGJvZHk6IEhUTUxFbGVtZW50XG4gIGN1cnJlbnRERVg6IEV4Y2hhbmdlXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBmb3JtczogUGFnZUVsZW1lbnRbXVxuICBmaWF0UmF0ZVNvdXJjZXM6IFBhZ2VFbGVtZW50W11cbiAgcmVnQXNzZXRGb3JtOiBmb3Jtcy5GZWVBc3NldFNlbGVjdGlvbkZvcm1cbiAgY29uZmlybVJlZ2lzdGVyRm9ybTogZm9ybXMuQ29uZmlybVJlZ2lzdHJhdGlvbkZvcm1cbiAgbmV3V2FsbGV0Rm9ybTogZm9ybXMuTmV3V2FsbGV0Rm9ybVxuICB3YWxsZXRXYWl0Rm9ybTogZm9ybXMuV2FsbGV0V2FpdEZvcm1cbiAgZGV4QWRkckZvcm06IGZvcm1zLkRFWEFkZHJlc3NGb3JtXG4gIGFwcFBhc3NSZXNldEZvcm06IGZvcm1zLkFwcFBhc3NSZXNldEZvcm1cbiAgY3VycmVudEZvcm06IFBhZ2VFbGVtZW50XG4gIGtleXVwOiAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZFxuXG4gIGNvbnN0cnVjdG9yIChib2R5OiBIVE1MRWxlbWVudCkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLmJvZHkgPSBib2R5XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGJvZHkpXG5cbiAgICB0aGlzLmZvcm1zID0gRG9jLmFwcGx5U2VsZWN0b3IocGFnZS5mb3JtcywgJzpzY29wZSA+IGZvcm0nKVxuICAgIHRoaXMuZmlhdFJhdGVTb3VyY2VzID0gRG9jLmFwcGx5U2VsZWN0b3IocGFnZS5maWF0UmF0ZVNvdXJjZXMsICdpbnB1dFt0eXBlPWNoZWNrYm94XScpXG5cbiAgICBwYWdlLmRhcmtNb2RlLmNoZWNrZWQgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmRhcmtNb2RlTEspID09PSAnMSdcbiAgICBEb2MuYmluZChwYWdlLmRhcmtNb2RlLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmRhcmtNb2RlTEssIHBhZ2UuZGFya01vZGUuY2hlY2tlZCB8fCBmYWxzZSA/ICcxJyA6ICcwJylcbiAgICAgIGlmIChwYWdlLmRhcmtNb2RlLmNoZWNrZWQpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdkYXJrJylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnZGFyaycpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHBhZ2Uuc2hvd1Bva2VzLmNoZWNrZWQgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLnBvcHVwc0xLKSA9PT0gJzEnXG4gICAgRG9jLmJpbmQocGFnZS5zaG93UG9rZXMsICdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNob3cgPSBwYWdlLnNob3dQb2tlcy5jaGVja2VkIHx8IGZhbHNlXG4gICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLnBvcHVwc0xLLCBzaG93ID8gJzEnIDogJzAnKVxuICAgICAgYXBwKCkuc2hvd1BvcHVwcyA9IHNob3dcbiAgICB9KVxuXG4gICAgcGFnZS5jb21taXRIYXNoLnRleHRDb250ZW50ID0gYXBwKCkuY29tbWl0SGFzaC5zdWJzdHJpbmcoMCwgNylcbiAgICBEb2MuYmluZChwYWdlLmFkZEFEZXgsICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuZGV4QWRkckZvcm0ucmVmcmVzaCgpXG4gICAgICB0aGlzLnNob3dGb3JtKHBhZ2UuZGV4QWRkckZvcm0pXG4gICAgfSlcblxuICAgIHRoaXMuZmlhdFJhdGVTb3VyY2VzLmZvckVhY2goc3JjID0+IHtcbiAgICAgIERvYy5iaW5kKHNyYywgJ2NoYW5nZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvdG9nZ2xlcmF0ZXNvdXJjZScsIHtcbiAgICAgICAgICBkaXNhYmxlOiAhc3JjLmNoZWNrZWQsXG4gICAgICAgICAgc291cmNlOiBzcmMudmFsdWVcbiAgICAgICAgfSlcbiAgICAgICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgICAgICBzcmMuY2hlY2tlZCA9ICFzcmMuY2hlY2tlZFxuICAgICAgICB9XG4gICAgICAgIC8vIFVwZGF0ZSBhc3NldCByYXRlIHZhbHVlcyBhbmQgZGlzYWJsZSBjb252ZXJzaW9uIHN0YXR1cy5cbiAgICAgICAgYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICAgIH0pXG4gICAgfSlcblxuICAgIC8vIEFzc2V0IHNlbGVjdGlvblxuICAgIHRoaXMucmVnQXNzZXRGb3JtID0gbmV3IGZvcm1zLkZlZUFzc2V0U2VsZWN0aW9uRm9ybShwYWdlLnJlZ0Fzc2V0Rm9ybSwgYXN5bmMgKGFzc2V0SUQ6IG51bWJlciwgdGllcjogbnVtYmVyKSA9PiB7XG4gICAgICBpZiAoYXNzZXRJRCA9PT0gUHJlcGFpZEJvbmRJRCkge1xuICAgICAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgICAgY29uc3Qgd2FsbGV0ID0gYXNzZXQud2FsbGV0XG4gICAgICBpZiAod2FsbGV0KSB7XG4gICAgICAgIGNvbnN0IGJvbmRBc3NldCA9IHRoaXMuY3VycmVudERFWC5ib25kQXNzZXRzW2Fzc2V0LnN5bWJvbF1cbiAgICAgICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgICAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGllciwgYm9uZHNGZWVCdWZmZXIpXG4gICAgICAgIGlmICh3YWxsZXQuc3luY2VkICYmIHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA+PSAyICogYm9uZEFzc2V0LmFtb3VudCArIGJvbmRzRmVlQnVmZmVyKSB7XG4gICAgICAgICAgdGhpcy5hbmltYXRlQ29uZmlybUZvcm0ocGFnZS5yZWdBc3NldEZvcm0pXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53YWxsZXRXYWl0Rm9ybS5zZXRXYWxsZXQoYXNzZXRJRCwgYm9uZHNGZWVCdWZmZXIsIHRpZXIpXG4gICAgICAgIHRoaXMuc2xpZGVTd2FwKHBhZ2Uud2FsbGV0V2FpdClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS5zZXRBc3NldChhc3NldElELCB0aWVyLCAwKVxuICAgICAgdGhpcy5uZXdXYWxsZXRGb3JtLnNldEFzc2V0KGFzc2V0SUQpXG4gICAgICB0aGlzLnNsaWRlU3dhcChwYWdlLm5ld1dhbGxldEZvcm0pXG4gICAgfSlcblxuICAgIC8vIEFwcHJvdmUgZmVlIHBheW1lbnRcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0gPSBuZXcgZm9ybXMuQ29uZmlybVJlZ2lzdHJhdGlvbkZvcm0ocGFnZS5jb25maXJtUmVnRm9ybSwgKCkgPT4ge1xuICAgICAgdGhpcy5yZWdpc3RlckRFWFN1Y2Nlc3MoKVxuICAgIH0sICgpID0+IHtcbiAgICAgIHRoaXMuYW5pbWF0ZVJlZ0Fzc2V0KHBhZ2UuY29uZmlybVJlZ0Zvcm0pXG4gICAgfSlcblxuICAgIC8vIENyZWF0ZSBhIG5ldyB3YWxsZXRcbiAgICB0aGlzLm5ld1dhbGxldEZvcm0gPSBuZXcgZm9ybXMuTmV3V2FsbGV0Rm9ybShcbiAgICAgIHBhZ2UubmV3V2FsbGV0Rm9ybSxcbiAgICAgIGFzc2V0SUQgPT4gdGhpcy5uZXdXYWxsZXRDcmVhdGVkKGFzc2V0SUQsIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS50aWVyKSxcbiAgICAgICgpID0+IHRoaXMuYW5pbWF0ZVJlZ0Fzc2V0KHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICApXG5cbiAgICB0aGlzLndhbGxldFdhaXRGb3JtID0gbmV3IGZvcm1zLldhbGxldFdhaXRGb3JtKHBhZ2Uud2FsbGV0V2FpdCwgKCkgPT4ge1xuICAgICAgdGhpcy5hbmltYXRlQ29uZmlybUZvcm0ocGFnZS53YWxsZXRXYWl0KVxuICAgIH0sICgpID0+IHsgdGhpcy5hbmltYXRlUmVnQXNzZXQocGFnZS53YWxsZXRXYWl0KSB9KVxuXG4gICAgLy8gRW50ZXIgYW4gYWRkcmVzcyBmb3IgYSBuZXcgREVYXG4gICAgdGhpcy5kZXhBZGRyRm9ybSA9IG5ldyBmb3Jtcy5ERVhBZGRyZXNzRm9ybShwYWdlLmRleEFkZHJGb3JtLCBhc3luYyAoeGM6IEV4Y2hhbmdlLCBjZXJ0RmlsZTogc3RyaW5nKSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRERVggPSB4Y1xuICAgICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnNldEV4Y2hhbmdlKHhjLCBjZXJ0RmlsZSlcbiAgICAgIHRoaXMud2FsbGV0V2FpdEZvcm0uc2V0RXhjaGFuZ2UoeGMpXG4gICAgICB0aGlzLnJlZ0Fzc2V0Rm9ybS5zZXRFeGNoYW5nZSh4YywgY2VydEZpbGUpXG4gICAgICB0aGlzLmFuaW1hdGVSZWdBc3NldChwYWdlLmRleEFkZHJGb3JtKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLmltcG9ydEFjY291bnQsICdjbGljaycsICgpID0+IHRoaXMucHJlcGFyZUFjY291bnRJbXBvcnQocGFnZS5hdXRob3JpemVBY2NvdW50SW1wb3J0Rm9ybSkpXG4gICAgZm9ybXMuYmluZChwYWdlLmF1dGhvcml6ZUFjY291bnRJbXBvcnRGb3JtLCBwYWdlLmF1dGhvcml6ZUltcG9ydEFjY291bnRDb25maXJtLCAoKSA9PiB0aGlzLmltcG9ydEFjY291bnQoKSlcblxuICAgIERvYy5iaW5kKHBhZ2UuY2hhbmdlQXBwUFcsICdjbGljaycsICgpID0+IHRoaXMuc2hvd0Zvcm0ocGFnZS5jaGFuZ2VBcHBQV0Zvcm0pKVxuICAgIGZvcm1zLmJpbmQocGFnZS5jaGFuZ2VBcHBQV0Zvcm0sIHBhZ2Uuc3VibWl0TmV3UFcsICgpID0+IHRoaXMuY2hhbmdlQXBwUFcoKSlcblxuICAgIHRoaXMuYXBwUGFzc1Jlc2V0Rm9ybSA9IG5ldyBmb3Jtcy5BcHBQYXNzUmVzZXRGb3JtKHBhZ2UucmVzZXRBcHBQV0Zvcm0sIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGFwcCgpLmxvYWRQYWdlKCdsb2dpbicpXG4gICAgICBEb2MuaGlkZShwYWdlLmZvcm1zKVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS5yZXNldEFwcFBXLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmFwcFBhc3NSZXNldEZvcm0ucmVmcmVzaCgpXG4gICAgICB0aGlzLnNob3dGb3JtKHBhZ2UucmVzZXRBcHBQV0Zvcm0pXG4gICAgICB0aGlzLmFwcFBhc3NSZXNldEZvcm0uZm9jdXMoKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLmFjY291bnRGaWxlLCAnY2hhbmdlJywgKCkgPT4gdGhpcy5vbkFjY291bnRGaWxlQ2hhbmdlKCkpXG4gICAgRG9jLmJpbmQocGFnZS5yZW1vdmVBY2NvdW50LCAnY2xpY2snLCAoKSA9PiB0aGlzLmNsZWFyQWNjb3VudEZpbGUoKSlcbiAgICBEb2MuYmluZChwYWdlLmFkZEFjY291bnQsICdjbGljaycsICgpID0+IHBhZ2UuYWNjb3VudEZpbGUuY2xpY2soKSlcblxuICAgIERvYy5iaW5kKHBhZ2UuZXhwb3J0U2VlZCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5leHBvcnRTZWVkRXJyKVxuICAgICAgdGhpcy5zaG93Rm9ybShwYWdlLmV4cG9ydFNlZWRBdXRoKVxuICAgIH0pXG4gICAgZm9ybXMuYmluZChwYWdlLmV4cG9ydFNlZWRBdXRoLCBwYWdlLmV4cG9ydFNlZWRTdWJtaXQsICgpID0+IHRoaXMuc3VibWl0RXhwb3J0U2VlZFJlcSgpKVxuXG4gICAgRG9jLmJpbmQocGFnZS5nYW1lQ29kZUxpbmssICdjbGljaycsICgpID0+IHRoaXMuc2hvd0Zvcm0ocGFnZS5nYW1lQ29kZUZvcm0pKVxuICAgIERvYy5iaW5kKHBhZ2UuZ2FtZUNvZGVTdWJtaXQsICdjbGljaycsICgpID0+IHRoaXMuc3VibWl0R2FtZUNvZGUoKSlcblxuICAgIGNvbnN0IGNsb3NlUG9wdXBzID0gKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICAgIHBhZ2UuZXhwb3J0U2VlZFBXLnZhbHVlID0gJydcbiAgICAgIHBhZ2UubGVnYWN5U2VlZC50ZXh0Q29udGVudCA9ICcnXG4gICAgICBwYWdlLm1uZW1vbmljLnRleHRDb250ZW50ID0gJydcbiAgICB9XG5cbiAgICBEb2MuYmluZChwYWdlLmZvcm1zLCAnbW91c2Vkb3duJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICghRG9jLm1vdXNlSW5FbGVtZW50KGUsIHRoaXMuY3VycmVudEZvcm0pKSB7IGNsb3NlUG9wdXBzKCkgfVxuICAgIH0pXG5cbiAgICB0aGlzLmtleXVwID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgY2xvc2VQb3B1cHMoKVxuICAgICAgfVxuICAgIH1cbiAgICBEb2MuYmluZChkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5rZXl1cClcblxuICAgIHBhZ2UuZm9ybXMucXVlcnlTZWxlY3RvckFsbCgnLmZvcm0tY2xvc2VyJykuZm9yRWFjaChlbCA9PiB7XG4gICAgICBEb2MuYmluZChlbCwgJ2NsaWNrJywgKCkgPT4geyBjbG9zZVBvcHVwcygpIH0pXG4gICAgfSlcblxuICAgIHRoaXMucmVuZGVyRGVza3RvcE50Zm5TZXR0aW5ncygpXG4gIH1cblxuICB1cGRhdGVOdGZuU2V0dGluZyAoZTogRXZlbnQpIHtcbiAgICBjb25zdCBjaGVja2JveCA9IGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICBjb25zdCBub3RlVHlwZSA9IGNoZWNrYm94LmdldEF0dHJpYnV0ZSgnbmFtZScpXG4gICAgaWYgKG5vdGVUeXBlID09PSBudWxsKSByZXR1cm5cbiAgICBjb25zdCBlbmFibGVkID0gY2hlY2tib3guY2hlY2tlZFxuICAgIHVwZGF0ZU50Zm5TZXR0aW5nKG5vdGVUeXBlLCBlbmFibGVkKVxuICB9XG5cbiAgZ2V0QnJvd3Nlck50Zm5TZXR0aW5ncyAoKTogRGVza3RvcE50Zm5TZXR0aW5nIHtcbiAgICBjb25zdCBwZXJtaXNzaW9ucyA9IGZldGNoRGVza3RvcE50Zm5TZXR0aW5ncygpXG4gICAgcmV0dXJuIHBlcm1pc3Npb25zXG4gIH1cblxuICBhc3luYyByZW5kZXJEZXNrdG9wTnRmblNldHRpbmdzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbnRmblNldHRpbmdzID0gdGhpcy5nZXRCcm93c2VyTnRmblNldHRpbmdzKClcbiAgICBjb25zdCBsYWJlbHMgPSBkZXNrdG9wTnRmbkxhYmVsc1xuICAgIGNvbnN0IHRtcGwgPSBwYWdlLmJyb3dzZXJOdGZuQ2hlY2tib3hUZW1wbGF0ZVxuICAgIHRtcGwucmVtb3ZlQXR0cmlidXRlKCdpZCcpXG4gICAgY29uc3QgY29udGFpbmVyID0gcGFnZS5icm93c2VyTnRmbkNoZWNrYm94Q29udGFpbmVyXG4gICAgRG9jLmVtcHR5KHBhZ2UuYnJvd3Nlck50Zm5DaGVja2JveENvbnRhaW5lcilcblxuICAgIE9iamVjdC5rZXlzKGxhYmVscykuZm9yRWFjaCgobm90ZVR5cGUpID0+IHtcbiAgICAgIGNvbnN0IGh0bWwgPSB0bXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgY29uc3QgZW5hYmxlZCA9IG50Zm5TZXR0aW5nc1tub3RlVHlwZV1cbiAgICAgIGNvbnN0IGNoZWNrYm94ID0gRG9jLnRtcGxFbGVtZW50KGh0bWwsICdjaGVja2JveCcpXG4gICAgICBEb2MudG1wbEVsZW1lbnQoaHRtbCwgJ2xhYmVsJykudGV4dENvbnRlbnQgPSBpbnRsLnByZXAobGFiZWxzW25vdGVUeXBlXSlcbiAgICAgIGNoZWNrYm94LnNldEF0dHJpYnV0ZSgnbmFtZScsIG5vdGVUeXBlKVxuICAgICAgaWYgKGVuYWJsZWQpIGNoZWNrYm94LnNldEF0dHJpYnV0ZSgnY2hlY2tlZCcsICdjaGVja2VkJylcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChodG1sKVxuICAgICAgRG9jLmJpbmQoY2hlY2tib3gsICdjbGljaycsIHRoaXMudXBkYXRlTnRmblNldHRpbmcpXG4gICAgfSlcblxuICAgIGNvbnN0IGVuYWJsZWRDaGVja2JveCA9IHBhZ2UuYnJvd3Nlck50Zm5FbmFibGVkXG5cbiAgICBEb2MuYmluZChlbmFibGVkQ2hlY2tib3gsICdjbGljaycsIGFzeW5jIChlOiBFdmVudCkgPT4ge1xuICAgICAgaWYgKE5vdGlmaWVyLm50Zm5QZXJtaXNzaW9uRGVuaWVkKCkpIHJldHVyblxuICAgICAgY29uc3QgY2hlY2tib3ggPSBlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgICBpZiAoY2hlY2tib3guY2hlY2tlZCkge1xuICAgICAgICBhd2FpdCBOb3RpZmllci5yZXF1ZXN0TnRmblBlcm1pc3Npb24oKVxuICAgICAgICBjaGVja2JveC5jaGVja2VkID0gIU5vdGlmaWVyLm50Zm5QZXJtaXNzaW9uRGVuaWVkKClcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlTnRmblNldHRpbmcoZSlcbiAgICAgIGNoZWNrYm94LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdjaGFuZ2UnKSlcbiAgICB9KVxuXG4gICAgRG9jLmJpbmQoZW5hYmxlZENoZWNrYm94LCAnY2hhbmdlJywgKGU6IEV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBjaGVja2JveCA9IGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICAgIGNvbnN0IHBlcm1EZW5pZWQgPSBOb3RpZmllci5udGZuUGVybWlzc2lvbkRlbmllZCgpXG4gICAgICBEb2Muc2V0VmlzKGNoZWNrYm94LmNoZWNrZWQsIHBhZ2UuYnJvd3Nlck50Zm5DaGVja2JveENvbnRhaW5lcilcbiAgICAgIERvYy5zZXRWaXMocGVybURlbmllZCwgcGFnZS5icm93c2VyTnRmbkJsb2NrZWRNc2cpXG4gICAgICBjaGVja2JveC5kaXNhYmxlZCA9IHBlcm1EZW5pZWRcbiAgICB9KVxuXG4gICAgZW5hYmxlZENoZWNrYm94LmNoZWNrZWQgPSAoTm90aWZpZXIubnRmblBlcm1pc3Npb25HcmFudGVkKCkgJiYgbnRmblNldHRpbmdzLmJyb3dzZXJOdGZuRW5hYmxlZClcbiAgICBlbmFibGVkQ2hlY2tib3guZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2NoYW5nZScpKVxuICB9XG5cbiAgLypcbiAgICogc2xpZGVTd2FwIGFuaW1hdGVzIHRoZSByZXBsYWNlbWVudCBvZiB0aGUgY3VycmVudGx5IHNob3duIGZvcm0gd2l0aCB0aGVcbiAgICogbmV3Rm9ybSBhbmQgc2V0cyB0aGlzLmN1cnJlbnRGb3JtLlxuICAgKi9cbiAgc2xpZGVTd2FwIChuZXdGb3JtOiBQYWdlRWxlbWVudCkge1xuICAgIGZvcm1zLnNsaWRlU3dhcCh0aGlzLmN1cnJlbnRGb3JtLCBuZXdGb3JtKVxuICAgIHRoaXMuY3VycmVudEZvcm0gPSBuZXdGb3JtXG4gIH1cblxuICAvLyBSZXRyaWV2ZSBhbiBlc3RpbWF0ZSBmb3IgdGhlIHR4IGZlZSBuZWVkZWQgdG8gY3JlYXRlIG5ldyBib25kIHJlc2VydmVzLlxuICBhc3luYyBnZXRCb25kc0ZlZUJ1ZmZlciAoYXNzZXRJRDogbnVtYmVyLCBmb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcoZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9ib25kc2ZlZWJ1ZmZlcicsIHsgYXNzZXRJRCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHJldHVybiAwXG4gICAgfVxuICAgIHJldHVybiByZXMuZmVlQnVmZmVyXG4gIH1cblxuICBhc3luYyBuZXdXYWxsZXRDcmVhdGVkIChhc3NldElEOiBudW1iZXIsIHRpZXI6IG51bWJlcikge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIGlmICghdXNlcikgcmV0dXJuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGFzc2V0ID0gdXNlci5hc3NldHNbYXNzZXRJRF1cbiAgICBjb25zdCB3YWxsZXQgPSBhc3NldC53YWxsZXRcbiAgICBjb25zdCBib25kQW10ID0gdGhpcy5jdXJyZW50REVYLmJvbmRBc3NldHNbYXNzZXQuc3ltYm9sXS5hbW91bnRcblxuICAgIGNvbnN0IGJvbmRzRmVlQnVmZmVyID0gYXdhaXQgdGhpcy5nZXRCb25kc0ZlZUJ1ZmZlcihhc3NldElELCBwYWdlLm5ld1dhbGxldEZvcm0pXG4gICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnNldEZlZXMoYXNzZXRJRCwgYm9uZHNGZWVCdWZmZXIpXG4gICAgaWYgKHdhbGxldC5zeW5jZWQgJiYgd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlID49IDIgKiBib25kQW10ICsgYm9uZHNGZWVCdWZmZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuYW5pbWF0ZUNvbmZpcm1Gb3JtKHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRoaXMud2FsbGV0V2FpdEZvcm0uc2V0V2FsbGV0KGFzc2V0SUQsIGJvbmRzRmVlQnVmZmVyLCB0aWVyKVxuICAgIHRoaXMuc2xpZGVTd2FwKHBhZ2Uud2FsbGV0V2FpdClcbiAgfVxuXG4gIGFzeW5jIG9uQWNjb3VudEZpbGVDaGFuZ2UgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBmaWxlcyA9IHBhZ2UuYWNjb3VudEZpbGUuZmlsZXNcbiAgICBpZiAoIWZpbGVzIHx8ICFmaWxlcy5sZW5ndGgpIHJldHVyblxuICAgIHBhZ2Uuc2VsZWN0ZWRBY2NvdW50LnRleHRDb250ZW50ID0gZmlsZXNbMF0ubmFtZVxuICAgIERvYy5zaG93KHBhZ2UucmVtb3ZlQWNjb3VudClcbiAgICBEb2MuaGlkZShwYWdlLmFkZEFjY291bnQpXG4gIH1cblxuICAvKiBjbGVhckFjY291bnRGaWxlIGNsZWFudXAgYWNjb3VudEZpbGUgdmFsdWUgYW5kIHNlbGVjdGVkQWNjb3VudCB0ZXh0ICovXG4gIGNsZWFyQWNjb3VudEZpbGUgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLmFjY291bnRGaWxlLnZhbHVlID0gJydcbiAgICBwYWdlLnNlbGVjdGVkQWNjb3VudC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PTkVfU0VMRUNURUQpXG4gICAgRG9jLmhpZGUocGFnZS5yZW1vdmVBY2NvdW50KVxuICAgIERvYy5zaG93KHBhZ2UuYWRkQWNjb3VudClcbiAgfVxuXG4gIGFzeW5jIHByZXBhcmVBY2NvdW50SW1wb3J0IChhdXRob3JpemVBY2NvdW50SW1wb3J0Rm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5pbXBvcnRBY2NvdW50RXJyLnRleHRDb250ZW50ID0gJydcbiAgICB0aGlzLnNob3dGb3JtKGF1dGhvcml6ZUFjY291bnRJbXBvcnRGb3JtKVxuICB9XG5cbiAgLy8gaW1wb3J0QWNjb3VudCBpbXBvcnRzIHRoZSBhY2NvdW50XG4gIGFzeW5jIGltcG9ydEFjY291bnQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBsZXQgYWNjb3VudFN0cmluZyA9ICcnXG4gICAgaWYgKHBhZ2UuYWNjb3VudEZpbGUudmFsdWUpIHtcbiAgICAgIGNvbnN0IGZpbGVzID0gcGFnZS5hY2NvdW50RmlsZS5maWxlc1xuICAgICAgaWYgKCFmaWxlcyB8fCAhZmlsZXMubGVuZ3RoKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ltcG9ydEFjY291bnQ6IG5vIGZpbGUgc3BlY2lmaWVkJylcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBhY2NvdW50U3RyaW5nID0gYXdhaXQgZmlsZXNbMF0udGV4dCgpXG4gICAgfVxuICAgIGxldCBhY2NvdW50XG4gICAgdHJ5IHtcbiAgICAgIGFjY291bnQgPSBKU09OLnBhcnNlKGFjY291bnRTdHJpbmcpXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcGFnZS5pbXBvcnRBY2NvdW50RXJyLnRleHRDb250ZW50ID0gZS5tZXNzYWdlXG4gICAgICBEb2Muc2hvdyhwYWdlLmltcG9ydEFjY291bnRFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHR5cGVvZiBhY2NvdW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5pbXBvcnRBY2NvdW50RXJyLCBpbnRsLnByZXAoaW50bC5JRF9BQ0NUX1VOREVGSU5FRCkpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgeyBib25kcyA9IFtdLCAuLi5hY2N0SW5mIH0gPSBhY2NvdW50XG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgYWNjb3VudDogYWNjdEluZixcbiAgICAgIGJvbmRzOiBib25kc1xuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuYm9keSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9pbXBvcnRhY2NvdW50JywgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuaW1wb3J0QWNjb3VudEVyciwgcmVzLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gICAgLy8gSW5pdGlhbCBtZXRob2Qgb2YgZGlzcGxheWluZyBpbXBvcnRlZCBhY2NvdW50LlxuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxuICB9XG5cbiAgYXN5bmMgc3VibWl0RXhwb3J0U2VlZFJlcSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IHB3ID0gcGFnZS5leHBvcnRTZWVkUFcudmFsdWVcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuYm9keSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9leHBvcnRzZWVkJywgeyBwYXNzOiBwdyB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuZXhwb3J0U2VlZEVyciwgcmVzLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwYWdlLmV4cG9ydFNlZWRQVy52YWx1ZSA9ICcnXG4gICAgaWYgKHJlcy5zZWVkLmxlbmd0aCA9PT0gMTI4ICYmIHJlcy5zZWVkLnNwbGl0KCcgJykubGVuZ3RoID09PSAxKSB7XG4gICAgICBwYWdlLmxlZ2FjeVNlZWQudGV4dENvbnRlbnQgPSByZXMuc2VlZC5tYXRjaCgvLnsxLDMyfS9nKS5tYXAoKGNodW5rOiBzdHJpbmcpID0+IGNodW5rLm1hdGNoKC8uezEsOH0vZyk/LmpvaW4oJyAnKSkuam9pbignXFxuJylcbiAgICB9IGVsc2UgcGFnZS5tbmVtb25pYy50ZXh0Q29udGVudCA9IHJlcy5zZWVkXG4gICAgdGhpcy5zaG93Rm9ybShwYWdlLmF1dGhvcml6ZVNlZWREaXNwbGF5KVxuICB9XG5cbiAgLyogc2hvd0Zvcm0gc2hvd3MgYSBtb2RhbCBmb3JtIHdpdGggYSBsaXR0bGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBzaG93Rm9ybSAoZm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IGZvcm1cbiAgICB0aGlzLmZvcm1zLmZvckVhY2goZm9ybSA9PiBEb2MuaGlkZShmb3JtKSlcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzEwMDAwcHgnXG4gICAgRG9jLnNob3cocGFnZS5mb3JtcywgZm9ybSlcbiAgICBjb25zdCBzaGlmdCA9IChwYWdlLmZvcm1zLm9mZnNldFdpZHRoICsgZm9ybS5vZmZzZXRXaWR0aCkgLyAyXG4gICAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pbWF0aW9uTGVuZ3RoLCBwcm9ncmVzcyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gYCR7KDEgLSBwcm9ncmVzcykgKiBzaGlmdH1weGBcbiAgICB9LCAnZWFzZU91dEhhcmQnKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMCdcbiAgfVxuXG4gIC8qIGdldHMgdGhlIGNvbnRlbnRzIG9mIHRoZSBjZXJ0IGZpbGUgKi9cbiAgYXN5bmMgZ2V0Q2VydEZpbGUgKCkge1xuICAgIGxldCBjZXJ0ID0gJydcbiAgICBpZiAodGhpcy5kZXhBZGRyRm9ybS5wYWdlLmNlcnRGaWxlLnZhbHVlKSB7XG4gICAgICBjb25zdCBmaWxlcyA9IHRoaXMuZGV4QWRkckZvcm0ucGFnZS5jZXJ0RmlsZS5maWxlc1xuICAgICAgaWYgKGZpbGVzICYmIGZpbGVzLmxlbmd0aCkgY2VydCA9IGF3YWl0IGZpbGVzWzBdLnRleHQoKVxuICAgIH1cbiAgICByZXR1cm4gY2VydFxuICB9XG5cbiAgLyogQ2FsbGVkIGFmdGVyIHN1Y2Nlc3NmdWwgcmVnaXN0cmF0aW9uIHRvIGEgREVYLiAqL1xuICBhc3luYyByZWdpc3RlckRFWFN1Y2Nlc3MgKCkge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxuICB9XG5cbiAgLyogQ2hhbmdlIGFwcGxpY2F0aW9uIHBhc3N3b3JkICAqL1xuICBhc3luYyBjaGFuZ2VBcHBQVyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuY2hhbmdlUFdFcnJNc2cpXG5cbiAgICBjb25zdCBjbGVhclZhbHVlcyA9ICgpID0+IHtcbiAgICAgIHBhZ2UuYXBwUFcudmFsdWUgPSAnJ1xuICAgICAgcGFnZS5uZXdBcHBQVy52YWx1ZSA9ICcnXG4gICAgICBwYWdlLmNvbmZpcm1OZXdQVy52YWx1ZSA9ICcnXG4gICAgfVxuICAgIC8vIEVuc3VyZSBwYXNzd29yZCBmaWVsZHMgYXJlIG5vbmVtcHR5LlxuICAgIGlmICghcGFnZS5hcHBQVy52YWx1ZSB8fCAhcGFnZS5uZXdBcHBQVy52YWx1ZSB8fCAhcGFnZS5jb25maXJtTmV3UFcudmFsdWUpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuY2hhbmdlUFdFcnJNc2csIGludGwucHJlcChpbnRsLklEX05PX0FQUF9QQVNTX0VSUk9SX01TRykpXG4gICAgICBjbGVhclZhbHVlcygpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgLy8gRW5zdXJlIHBhc3N3b3JkIGNvbmZpcm1hdGlvbiBtYXRjaGVzLlxuICAgIGlmIChwYWdlLm5ld0FwcFBXLnZhbHVlICE9PSBwYWdlLmNvbmZpcm1OZXdQVy52YWx1ZSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5jaGFuZ2VQV0Vyck1zZywgaW50bC5wcmVwKGludGwuSURfUEFTU1dPUkRfTk9UX01BVENIKSlcbiAgICAgIGNsZWFyVmFsdWVzKClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuY2hhbmdlQXBwUFcpXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgYXBwUFc6IHBhZ2UuYXBwUFcudmFsdWUsXG4gICAgICBuZXdBcHBQVzogcGFnZS5uZXdBcHBQVy52YWx1ZVxuICAgIH1cbiAgICBjbGVhclZhbHVlcygpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvY2hhbmdlYXBwcGFzcycsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmNoYW5nZVBXRXJyTXNnLCByZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gIH1cblxuICAvKlxuICAgKiB1bmxvYWQgaXMgY2FsbGVkIGJ5IHRoZSBBcHBsaWNhdGlvbiB3aGVuIHRoZSB1c2VyIG5hdmlnYXRlcyBhd2F5IGZyb21cbiAgICogdGhlIC9zZXR0aW5ncyBwYWdlLlxuICAgKi9cbiAgdW5sb2FkICgpIHtcbiAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuICB9XG5cbiAgLyogU3dhcCBpbiB0aGUgYXNzZXQgc2VsZWN0aW9uIGZvcm0gYW5kIHJ1biB0aGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBhbmltYXRlUmVnQXNzZXQgKG9sZEZvcm06IEhUTUxFbGVtZW50KSB7XG4gICAgRG9jLmhpZGUob2xkRm9ybSlcbiAgICBjb25zdCBmb3JtID0gdGhpcy5wYWdlLnJlZ0Fzc2V0Rm9ybVxuICAgIHRoaXMuY3VycmVudEZvcm0gPSBmb3JtXG4gICAgdGhpcy5yZWdBc3NldEZvcm0uYW5pbWF0ZSgpXG4gICAgRG9jLnNob3coZm9ybSlcbiAgfVxuXG4gIC8qIFN3YXAgaW4gdGhlIGNvbmZpcm1hdGlvbiBmb3JtIGFuZCBydW4gdGhlIGFuaW1hdGlvbi4gKi9cbiAgYXN5bmMgYW5pbWF0ZUNvbmZpcm1Gb3JtIChvbGRGb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS5hbmltYXRlKClcbiAgICBjb25zdCBmb3JtID0gdGhpcy5wYWdlLmNvbmZpcm1SZWdGb3JtXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IGZvcm1cbiAgICBEb2MuaGlkZShvbGRGb3JtKVxuICAgIERvYy5zaG93KGZvcm0pXG4gIH1cblxuICBhc3luYyBzdWJtaXRHYW1lQ29kZSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuZ2FtZUNvZGVFcnIpXG4gICAgY29uc3QgY29kZSA9IHBhZ2UuZ2FtZUNvZGVJbnB1dC52YWx1ZVxuICAgIGlmICghY29kZSkge1xuICAgICAgcGFnZS5nYW1lQ29kZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX0NPREVfUFJPVklERUQpXG4gICAgICBEb2Muc2hvdyhwYWdlLmdhbWVDb2RlRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IG1zZyA9IHBhZ2UuZ2FtZUNvZGVNc2cudmFsdWUgfHwgJydcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuZ2FtZUNvZGVGb3JtKVxuICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9yZWRlZW1nYW1lY29kZScsIHsgY29kZSwgbXNnIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzcCkpIHtcbiAgICAgIHBhZ2UuZ2FtZUNvZGVFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BUElfRVJST1IsIHsgbXNnOiByZXNwLm1zZyB9KVxuICAgICAgRG9jLnNob3cocGFnZS5nYW1lQ29kZUVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLmdhbWVDb2RlU3VjY2VzcylcbiAgICBwYWdlLmdhbWVSZWRlZW1UeC5kYXRhc2V0LmV4cGxvcmVyQ29pbiA9IHJlc3AuY29pblN0cmluZ1xuICAgIGNvbnN0IGRjckJpcElEID0gNDJcbiAgICBzZXRDb2luSHJlZihkY3JCaXBJRCwgcGFnZS5nYW1lUmVkZWVtVHgpXG4gICAgcGFnZS5nYW1lUmVkZWVtVHgudGV4dENvbnRlbnQgPSByZXNwLmNvaW5TdHJpbmdcbiAgICBjb25zdCB1aSA9IGFwcCgpLnVuaXRJbmZvKGRjckJpcElEKVxuICAgIHBhZ2UuZ2FtZVJlZGVlbVZhbHVlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyZXNwLndpbiwgdWkpXG4gIH1cbn1cbiIsIi8vIFN0YXRlIGlzIGEgc2V0IG9mIHN0YXRpYyBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIHVzZXIgc3RhdGUuIEl0IGhhc1xuLy8gdXRpbGl0aWVzIGZvciBzZXR0aW5nIGFuZCByZXRyaWV2aW5nIGNvb2tpZXMgYW5kIHN0b3JpbmcgdXNlciBjb25maWd1cmF0aW9uXG4vLyB0byBsb2NhbFN0b3JhZ2UuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdGF0ZSB7XG4gIC8vIENvb2tpZSBrZXlzLlxuICBzdGF0aWMgZGFya01vZGVMSyA9ICdkYXJrTW9kZSdcbiAgc3RhdGljIGF1dGhDSyA9ICdkZXhhdXRoJ1xuICBzdGF0aWMgcHdLZXlDSyA9ICdzZXNzaW9ua2V5J1xuICAvLyBMb2NhbCBzdG9yYWdlIGtleXMgKGZvciBkYXRhIHRoYXQgd2UgZG9uJ3QgbmVlZCBhdCB0aGUgc2VydmVyKS5cbiAgc3RhdGljIHBvcHVwc0xLID0gJ3BvcHVwcydcbiAgc3RhdGljIGxvZ2dlcnNMSyA9ICdsb2dnZXJzJ1xuICBzdGF0aWMgcmVjb3JkZXJzTEsgPSAncmVjb3JkZXJzJ1xuICBzdGF0aWMgbGFzdE1hcmtldExLID0gJ3NlbGVjdGVkTWFya2V0J1xuICBzdGF0aWMgZGVwdGhab29tTEsgPSAnZGVwdGhab29tJ1xuICBzdGF0aWMgbGFzdE1NTWFya2V0TEsgPSAnbW1NYXJrZXQnXG4gIHN0YXRpYyBvcHRpb25zRXhwYW5zaW9uTEsgPSAnbW1PcHRzRXhwYW5kJ1xuICBzdGF0aWMgbGVmdE1hcmtldERvY2tMSyA9ICdsZWZ0bWFya2V0ZG9jaydcbiAgc3RhdGljIHNlbGVjdGVkQXNzZXRMSyA9ICdzZWxlY3RlZGFzc2V0J1xuICBzdGF0aWMgbm90aWZpY2F0aW9uc0xLID0gJ25vdGlmaWNhdGlvbnMnIC8vIERFUFJFQ0FURUQgYmVmb3JlIHYxXG4gIHN0YXRpYyBvcmRlckRpc2NsYWltZXJBY2tlZExLID0gJ29yZEFjaydcbiAgc3RhdGljIGxhc3RDYW5kbGVEdXJhdGlvbkxLID0gJ2xhc3RDYW5kbGVEdXJhdGlvbidcbiAgc3RhdGljIGxvY2FsZVNwZWNzS2V5ID0gJ2xvY2FsZVNwZWNzTEsnXG4gIHN0YXRpYyBsb2NhbGVLZXkgPSAnbG9jYWxlTEsnXG5cbiAgc3RhdGljIHNldENvb2tpZSAoY25hbWU6IHN0cmluZywgY3ZhbHVlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBkID0gbmV3IERhdGUoKVxuICAgIC8vIFNldCBjb29raWUgdG8gZXhwaXJlIGluIHRlbiB5ZWFycy5cbiAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyAoODY0MDAgKiAzNjUgKiAxMCAqIDEwMDApKVxuICAgIGNvbnN0IGV4cGlyZXMgPSAnZXhwaXJlcz0nICsgZC50b1VUQ1N0cmluZygpXG4gICAgZG9jdW1lbnQuY29va2llID0gY25hbWUgKyAnPScgKyBjdmFsdWUgKyAnOycgKyBleHBpcmVzICsgJztwYXRoPS8nXG4gIH1cblxuICAvKlxuICAgKiBnZXRDb29raWUgcmV0dXJucyB0aGUgdmFsdWUgYXQgdGhlIHNwZWNpZmllZCBjb29raWUgbmFtZSwgb3RoZXJ3aXNlIG51bGwuXG4gICAqL1xuICBzdGF0aWMgZ2V0Q29va2llIChjbmFtZTogc3RyaW5nKSB7XG4gICAgZm9yIChjb25zdCBjc3RyIG9mIGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpKSB7XG4gICAgICBjb25zdCBbaywgdl0gPSBjc3RyLnNwbGl0KCc9JylcbiAgICAgIGlmIChrLnRyaW0oKSA9PT0gY25hbWUpIHJldHVybiB2XG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKlxuICAgKiByZW1vdmVDb29raWUgdGVsbHMgdGhlIGJyb3dzZXIgdG8gc3RvcCB1c2luZyBjb29raWUuIEl0J3Mgbm90IGVub3VnaCB0byBzaW1wbHlcbiAgICogZXJhc2UgY29va2llIHZhbHVlIGJlY2F1c2UgYnJvd3NlciB3aWxsIHN0aWxsIHNlbmQgaXQgdG8gdGhlIHNlcnZlciAod2l0aCBlbXB0eVxuICAgKiB2YWx1ZSksIGFuZCB0aGF0J3Mgbm90IHdoYXQgc2VydmVyIGV4cGVjdHMuXG4gICAqL1xuICBzdGF0aWMgcmVtb3ZlQ29va2llIChjS2V5OiBzdHJpbmcpIHtcbiAgICBkb2N1bWVudC5jb29raWUgPSBgJHtjS2V5fT07ZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAxIEdNVDtgXG4gIH1cblxuICAvKlxuICAgKiBpc0RhcmsgcmV0dXJucyB0cnVlIGlmIHRoZSBkYXJrLW1vZGUgY29va2llIGlzIGN1cnJlbnRseSBzZXQgdG8gJzEnID0gdHJ1ZS5cbiAgICovXG4gIHN0YXRpYyBpc0RhcmsgKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmRhcmtNb2RlTEspID09PSAnMSdcbiAgfVxuXG4gIC8qIHN0b3JlTG9jYWwgcHV0cyB0aGUga2V5LXZhbHVlIHBhaXIgaW50byBXaW5kb3cubG9jYWxTdG9yYWdlLiAqL1xuICBzdGF0aWMgc3RvcmVMb2NhbCAoazogc3RyaW5nLCB2OiBhbnkpIHtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oaywgSlNPTi5zdHJpbmdpZnkodikpXG4gIH1cblxuICAvKlxuICAqIGZldGNoTG9jYWwgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUga2V5IGluIFdpbmRvdy5sb2NhbFN0b3JhZ2UsIG9yXG4gICogbnVsbCBpZiB0aGUgbm8gdmFsdWUgZXhpc3RzIGZvciB0aGUga2V5LlxuICAqL1xuICBzdGF0aWMgZmV0Y2hMb2NhbCAoazogc3RyaW5nKSB7XG4gICAgY29uc3QgdiA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrKVxuICAgIGlmICh2ICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZSh2KVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLyogcmVtb3ZlTG9jYWwgcmVtb3ZlcyB0aGUga2V5LXZhbHVlIHBhaXIgZnJvbSBXaW5kb3cubG9jYWxTdG9yYWdlLiAqL1xuICBzdGF0aWMgcmVtb3ZlTG9jYWwgKGs6IHN0cmluZykge1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrKVxuICB9XG59XG5cbi8vIFNldHRpbmcgZGVmYXVsdHMgaGVyZSwgdW5sZXNzIHNwZWNpZmljIGNvb2tpZSAob3IgbG9jYWwgc3RvcmFnZSkgdmFsdWUgd2FzIGFscmVhZHkgY2hvc2VuIGJ5IHRoZSB1c2VyLlxuaWYgKFN0YXRlLmZldGNoTG9jYWwoU3RhdGUuZGFya01vZGVMSykgPT09IG51bGwpIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUuZGFya01vZGVMSywgJzEnKVxuaWYgKFN0YXRlLmZldGNoTG9jYWwoU3RhdGUucG9wdXBzTEspID09PSBudWxsKSBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLnBvcHVwc0xLLCAnMScpXG5pZiAoU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5sZWZ0TWFya2V0RG9ja0xLKSA9PT0gbnVsbCkgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5sZWZ0TWFya2V0RG9ja0xLLCAnMScpXG4iLCJpbXBvcnQgRG9jLCB7IEFuaW1hdGlvbiwgQW5pVG9nZ2xlLCBwYXJzZUZsb2F0RGVmYXVsdCwgc2V0dXBDb3B5QnRuIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCB7IHBvc3RKU09OLCBFcnJvcnMgfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQge1xuICBOZXdXYWxsZXRGb3JtLFxuICBXYWxsZXRDb25maWdGb3JtLFxuICBEZXBvc2l0QWRkcmVzcyxcbiAgYmluZCBhcyBiaW5kRm9ybSxcbiAgc2hvd1N1Y2Nlc3Ncbn0gZnJvbSAnLi9mb3JtcydcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQgKiBhcyBPcmRlclV0aWwgZnJvbSAnLi9vcmRlcnV0aWwnXG5pbXBvcnQge1xuICBhcHAsXG4gIFBhZ2VFbGVtZW50LFxuICBTdXBwb3J0ZWRBc3NldCxcbiAgV2FsbGV0RGVmaW5pdGlvbixcbiAgQmFsYW5jZU5vdGUsXG4gIFdhbGxldFN0YXRlTm90ZSxcbiAgV2FsbGV0U3luY05vdGUsXG4gIFJhdGVOb3RlLFxuICBPcmRlcixcbiAgT3JkZXJGaWx0ZXIsXG4gIFdhbGxldENyZWF0aW9uTm90ZSxcbiAgQmFzZVdhbGxldE5vdGUsXG4gIFdhbGxldE5vdGUsXG4gIEN1c3RvbVdhbGxldE5vdGUsXG4gIFRpcENoYW5nZU5vdGUsXG4gIEV4Y2hhbmdlLFxuICBNYXJrZXQsXG4gIFBlZXJTb3VyY2UsXG4gIFdhbGxldFBlZXIsXG4gIEFwcHJvdmFsU3RhdHVzLFxuICBXYWxsZXRTdGF0ZSxcbiAgVW5pdEluZm8sXG4gIFRpY2tldFN0YWtpbmdTdGF0dXMsXG4gIFZvdGluZ1NlcnZpY2VQcm92aWRlcixcbiAgVGlja2V0LFxuICBUaWNrZXRTdGF0cyxcbiAgVHhIaXN0b3J5UmVzdWx0LFxuICBUcmFuc2FjdGlvbk5vdGUsXG4gIFdhbGxldFRyYW5zYWN0aW9uLFxuICBGZWVTdGF0ZVxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IHsgQ29pbkV4cGxvcmVycyB9IGZyb20gJy4vY29pbmV4cGxvcmVycydcblxuaW50ZXJmYWNlIERlY3JlZFRpY2tldFRpcFVwZGF0ZSB7XG4gIHRpY2tldFByaWNlOiBudW1iZXJcbiAgdm90aW5nU3Vic2lkeTogbnVtYmVyXG4gIHN0YXRzOiBUaWNrZXRTdGF0c1xufVxuXG5pbnRlcmZhY2UgVGlja2V0UHVyY2hhc2VVcGRhdGUgZXh0ZW5kcyBCYXNlV2FsbGV0Tm90ZSB7XG4gIGVycj86IHN0cmluZ1xuICByZW1haW5pbmc6bnVtYmVyXG4gIHRpY2tldHM/OiBUaWNrZXRbXVxuICBzdGF0cz86IFRpY2tldFN0YXRzXG59XG5cbmNvbnN0IGFuaW1hdGlvbkxlbmd0aCA9IDMwMFxuY29uc3QgdHJhaXRSZXNjYW5uZXIgPSAxXG5jb25zdCB0cmFpdExvZ0ZpbGVyID0gMSA8PCAyXG5jb25zdCB0cmFpdFJlY292ZXJlciA9IDEgPDwgNVxuY29uc3QgdHJhaXRXaXRoZHJhd2VyID0gMSA8PCA2XG5jb25zdCB0cmFpdFJlc3RvcmVyID0gMSA8PCA4XG5jb25zdCB0cmFpdFR4RmVlRXN0aW1hdG9yID0gMSA8PCA5XG5jb25zdCB0cmFpdFBlZXJNYW5hZ2VyID0gMSA8PCAxMFxuY29uc3QgdHJhaXRUb2tlbkFwcHJvdmVyID0gMSA8PCAxM1xuY29uc3QgdHJhaXRUaWNrZXRCdXllciA9IDEgPDwgMTVcbmNvbnN0IHRyYWl0SGlzdG9yaWFuID0gMSA8PCAxNlxuY29uc3QgdHJhaXRGdW5kc01peGVyID0gMSA8PCAxN1xuXG5jb25zdCB0cmFpdHNFeHRyYU9wdHMgPSB0cmFpdExvZ0ZpbGVyIHwgdHJhaXRSZWNvdmVyZXIgfCB0cmFpdFJlc3RvcmVyIHwgdHJhaXRSZXNjYW5uZXIgfCB0cmFpdFBlZXJNYW5hZ2VyIHwgdHJhaXRUb2tlbkFwcHJvdmVyXG5cbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNVbmtub3duID0gMFxuZXhwb3J0IGNvbnN0IHRpY2tldFN0YXR1c1VubWluZWQgPSAxXG5leHBvcnQgY29uc3QgdGlja2V0U3RhdHVzSW1tYXR1cmUgPSAyXG5leHBvcnQgY29uc3QgdGlja2V0U3RhdHVzTGl2ZSA9IDNcbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNWb3RlZCA9IDRcbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNNaXNzZWQgPSA1XG5leHBvcnQgY29uc3QgdGlja2V0U3RhdHVzRXhwaXJlZCA9IDZcbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNVbnNwZW50ID0gN1xuZXhwb3J0IGNvbnN0IHRpY2tldFN0YXR1c1Jldm9rZWQgPSA4XG5cbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNUcmFuc2xhdGlvbktleXMgPSBbXG4gIGludGwuSURfVElDS0VUX1NUQVRVU19VTktOT1dOLFxuICBpbnRsLklEX1RJQ0tFVF9TVEFUVVNfVU5NSU5FRCxcbiAgaW50bC5JRF9USUNLRVRfU1RBVFVTX0lNTUFUVVJFLFxuICBpbnRsLklEX1RJQ0tFVF9TVEFUVVNfTElWRSxcbiAgaW50bC5JRF9USUNLRVRfU1RBVFVTX1ZPVEVELFxuICBpbnRsLklEX1RJQ0tFVF9TVEFUVVNfTUlTU0VELFxuICBpbnRsLklEX1RJQ0tFVF9TVEFUVVNfRVhQSVJFRCxcbiAgaW50bC5JRF9USUNLRVRfU1RBVFVTX1VOU1BFTlQsXG4gIGludGwuSURfVElDS0VUX1NUQVRVU19SRVZPS0VEXG5dXG5cbmV4cG9ydCBjb25zdCB0eFR5cGVVbmtub3duID0gMFxuZXhwb3J0IGNvbnN0IHR4VHlwZVNlbmQgPSAxXG5leHBvcnQgY29uc3QgdHhUeXBlUmVjZWl2ZSA9IDJcbmV4cG9ydCBjb25zdCB0eFR5cGVTd2FwID0gM1xuZXhwb3J0IGNvbnN0IHR4VHlwZVJlZGVlbSA9IDRcbmV4cG9ydCBjb25zdCB0eFR5cGVSZWZ1bmQgPSA1XG5leHBvcnQgY29uc3QgdHhUeXBlU3BsaXQgPSA2XG5leHBvcnQgY29uc3QgdHhUeXBlQ3JlYXRlQm9uZCA9IDdcbmV4cG9ydCBjb25zdCB0eFR5cGVSZWRlZW1Cb25kID0gOFxuZXhwb3J0IGNvbnN0IHR4VHlwZUFwcHJvdmVUb2tlbiA9IDlcbmV4cG9ydCBjb25zdCB0eFR5cGVBY2NlbGVyYXRpb24gPSAxMFxuZXhwb3J0IGNvbnN0IHR4VHlwZVNlbGZTZW5kID0gMTFcbmV4cG9ydCBjb25zdCB0eFR5cGVSZXZva2VUb2tlbkFwcHJvdmFsID0gMTJcbmV4cG9ydCBjb25zdCB0eFR5cGVUaWNrZXRQdXJjaGFzZSA9IDEzXG5leHBvcnQgY29uc3QgdHhUeXBlVGlja2V0Vm90ZSA9IDE0XG5leHBvcnQgY29uc3QgdHhUeXBlVGlja2V0UmV2b2NhdGlvbiA9IDE1XG5leHBvcnQgY29uc3QgdHhUeXBlU3dhcE9yU2VuZCA9IDE2XG5leHBvcnQgY29uc3QgdHhUeXBlTWl4aW5nID0gMTdcblxuY29uc3QgcG9zaXRpdmVUeFR5cGVzIDogbnVtYmVyW10gPSBbXG4gIHR4VHlwZVJlY2VpdmUsXG4gIHR4VHlwZVJlZGVlbSxcbiAgdHhUeXBlUmVmdW5kLFxuICB0eFR5cGVSZWRlZW1Cb25kLFxuICB0eFR5cGVUaWNrZXRWb3RlLFxuICB0eFR5cGVUaWNrZXRSZXZvY2F0aW9uXG5dXG5cbmNvbnN0IG5lZ2F0aXZlVHhUeXBlcyA6IG51bWJlcltdID0gW1xuICB0eFR5cGVTZW5kLFxuICB0eFR5cGVTd2FwLFxuICB0eFR5cGVDcmVhdGVCb25kLFxuICB0eFR5cGVUaWNrZXRQdXJjaGFzZSxcbiAgdHhUeXBlU3dhcE9yU2VuZFxuXVxuXG5jb25zdCBub0FtdFR4VHlwZXMgOiBudW1iZXJbXSA9IFtcbiAgdHhUeXBlU3BsaXQsXG4gIHR4VHlwZUFwcHJvdmVUb2tlbixcbiAgdHhUeXBlQWNjZWxlcmF0aW9uLFxuICB0eFR5cGVSZXZva2VUb2tlbkFwcHJvdmFsXG5dXG5cbmZ1bmN0aW9uIHR4VHlwZVNpZ25BbmRDbGFzcyAodHhUeXBlOiBudW1iZXIpOiBbc3RyaW5nLCBzdHJpbmddIHtcbiAgaWYgKHBvc2l0aXZlVHhUeXBlcy5pbmNsdWRlcyh0eFR5cGUpKSByZXR1cm4gWycrJywgJ3Bvc2l0aXZlLXR4J11cbiAgaWYgKG5lZ2F0aXZlVHhUeXBlcy5pbmNsdWRlcyh0eFR5cGUpKSByZXR1cm4gWyctJywgJ25lZ2F0aXZlLXR4J11cbiAgcmV0dXJuIFsnJywgJyddXG59XG5cbmNvbnN0IHR4VHlwZVRyYW5zbGF0aW9uS2V5cyA9IFtcbiAgaW50bC5JRF9UWF9UWVBFX1VOS05PV04sXG4gIGludGwuSURfVFhfVFlQRV9TRU5ELFxuICBpbnRsLklEX1RYX1RZUEVfUkVDRUlWRSxcbiAgaW50bC5JRF9UWF9UWVBFX1NXQVAsXG4gIGludGwuSURfVFhfVFlQRV9SRURFRU0sXG4gIGludGwuSURfVFhfVFlQRV9SRUZVTkQsXG4gIGludGwuSURfVFhfVFlQRV9TUExJVCxcbiAgaW50bC5JRF9UWF9UWVBFX0NSRUFURV9CT05ELFxuICBpbnRsLklEX1RYX1RZUEVfUkVERUVNX0JPTkQsXG4gIGludGwuSURfVFhfVFlQRV9BUFBST1ZFX1RPS0VOLFxuICBpbnRsLklEX1RYX1RZUEVfQUNDRUxFUkFUSU9OLFxuICBpbnRsLklEX1RYX1RZUEVfU0VMRl9UUkFOU0ZFUixcbiAgaW50bC5JRF9UWF9UWVBFX1JFVk9LRV9UT0tFTl9BUFBST1ZBTCxcbiAgaW50bC5JRF9UWF9UWVBFX1RJQ0tFVF9QVVJDSEFTRSxcbiAgaW50bC5JRF9UWF9UWVBFX1RJQ0tFVF9WT1RFLFxuICBpbnRsLklEX1RYX1RZUEVfVElDS0VUX1JFVk9DQVRJT04sXG4gIGludGwuSURfVFhfVFlQRV9TV0FQX09SX1NFTkQsXG4gIGludGwuSURfVFhfVFlQRV9NSVhcbl1cblxuZXhwb3J0IGZ1bmN0aW9uIHR4VHlwZVN0cmluZyAodHhUeXBlOiBudW1iZXIpIDogc3RyaW5nIHtcbiAgcmV0dXJuIGludGwucHJlcCh0eFR5cGVUcmFuc2xhdGlvbktleXNbdHhUeXBlXSlcbn1cblxuY29uc3QgdGlja2V0UGFnZVNpemUgPSAxMFxuY29uc3Qgc2NhblN0YXJ0TWVtcG9vbCA9IC0xXG5cbmludGVyZmFjZSBSZWNvbmZpZ1JlcXVlc3Qge1xuICBhc3NldElEOiBudW1iZXJcbiAgd2FsbGV0VHlwZTogc3RyaW5nXG4gIGNvbmZpZzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICBuZXdXYWxsZXRQVz86IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgUmVzY2FuUmVjb3ZlcnlSZXF1ZXN0IHtcbiAgYXNzZXRJRDogbnVtYmVyXG4gIGFwcFBXPzogc3RyaW5nXG4gIGZvcmNlPzogYm9vbGVhblxufVxuXG5pbnRlcmZhY2UgV2FsbGV0UmVzdG9yYXRpb24ge1xuICB0YXJnZXQ6IHN0cmluZ1xuICBzZWVkOiBzdHJpbmdcbiAgc2VlZE5hbWU6IHN0cmluZ1xuICBpbnN0cnVjdGlvbnM6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgQXNzZXRCdXR0b24ge1xuICB0bXBsOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgYnR0bjogUGFnZUVsZW1lbnRcbn1cblxuaW50ZXJmYWNlIFRpY2tldFBhZ2luYXRpb24ge1xuICBudW1iZXI6IG51bWJlclxuICBoaXN0b3J5OiBUaWNrZXRbXVxuICBzY2FubmVkOiBib29sZWFuIC8vIFJlYWNoZWQgdGhlIGVuZCBvZiBoaXN0b3J5LiBBbGwgdGlja2V0cyBjYWNoZWQuXG59XG5cbmludGVyZmFjZSBXYWxsZXRzUGFnZURhdGEge1xuICBnb0JhY2s/OiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIHJlY29uZmlnU2V0dGluZ3Mge1xuICBza2lwQW5pbWF0aW9uPzogYm9vbGVhblxuICBlbGV2YXRlUHJvdmlkZXJzPzogYm9vbGVhblxufVxuXG5sZXQgbmV0ID0gMFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBXYWxsZXRzUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgYm9keTogSFRNTEVsZW1lbnRcbiAgZGF0YT86IFdhbGxldHNQYWdlRGF0YVxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgYXNzZXRCdXR0b25zOiBSZWNvcmQ8bnVtYmVyLCBBc3NldEJ1dHRvbj5cbiAgbmV3V2FsbGV0Rm9ybTogTmV3V2FsbGV0Rm9ybVxuICByZWNvbmZpZ0Zvcm06IFdhbGxldENvbmZpZ0Zvcm1cbiAgd2FsbGV0Q2ZnR3VpZGU6IFBhZ2VFbGVtZW50XG4gIGRlcG9zaXRBZGRyRm9ybTogRGVwb3NpdEFkZHJlc3NcbiAga2V5dXA6IChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG4gIGNoYW5nZVdhbGxldFBXOiBib29sZWFuXG4gIGRpc3BsYXllZDogSFRNTEVsZW1lbnRcbiAgYW5pbWF0aW9uOiBBbmltYXRpb25cbiAgZm9ybXM6IFBhZ2VFbGVtZW50W11cbiAgZm9yY2VSZXE6IFJlc2NhblJlY292ZXJ5UmVxdWVzdFxuICBmb3JjZVVybDogc3RyaW5nXG4gIGN1cnJlbnRGb3JtOiBQYWdlRWxlbWVudFxuICByZXN0b3JlSW5mb0NhcmQ6IEhUTUxFbGVtZW50XG4gIHNlbGVjdGVkQXNzZXRJRDogbnVtYmVyXG4gIHN0YWtlU3RhdHVzOiBUaWNrZXRTdGFraW5nU3RhdHVzXG4gIG1heFNlbmQ6IG51bWJlclxuICB1bmFwcHJvdmluZ1Rva2VuVmVyc2lvbjogbnVtYmVyXG4gIHRpY2tldFBhZ2U6IFRpY2tldFBhZ2luYXRpb25cbiAgb2xkZXN0VHg6IFdhbGxldFRyYW5zYWN0aW9uIHwgdW5kZWZpbmVkXG4gIGN1cnJUeDogV2FsbGV0VHJhbnNhY3Rpb24gfCB1bmRlZmluZWRcbiAgbWl4aW5nOiBib29sZWFuXG4gIG1peGVyVG9nZ2xlOiBBbmlUb2dnbGVcbiAgc3RhbXBlcnM6IFBhZ2VFbGVtZW50W11cbiAgc2Vjb25kVGlja2VyOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAoYm9keTogSFRNTEVsZW1lbnQsIGRhdGE/OiBXYWxsZXRzUGFnZURhdGEpIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5ib2R5ID0gYm9keVxuICAgIHRoaXMuZGF0YSA9IGRhdGFcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoYm9keSlcbiAgICB0aGlzLnN0YW1wZXJzID0gW11cbiAgICBuZXQgPSBhcHAoKS51c2VyLm5ldFxuXG4gICAgY29uc3Qgc2V0U3RhbXAgPSAoKSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IHNwYW4gb2YgdGhpcy5zdGFtcGVycykge1xuICAgICAgICBpZiAoc3Bhbi5kYXRhc2V0LnN0YW1wKSB7XG4gICAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IERvYy50aW1lU2luY2UocGFyc2VJbnQoc3Bhbi5kYXRhc2V0LnN0YW1wIHx8ICcnKSAqIDEwMDApXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zZWNvbmRUaWNrZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgc2V0U3RhbXAoKVxuICAgIH0sIDEwMDAwKSAvLyB1cGRhdGUgZXZlcnkgMTAgc2Vjb25kc1xuXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UucmVzdG9yZUluZm9DYXJkLCBwYWdlLmNvbm5lY3RlZEljb25UbXBsLCBwYWdlLmRpc2Nvbm5lY3RlZEljb25UbXBsLCBwYWdlLnJlbW92ZUljb25UbXBsKVxuICAgIHRoaXMucmVzdG9yZUluZm9DYXJkID0gcGFnZS5yZXN0b3JlSW5mb0NhcmQuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgRG9jLnNob3cocGFnZS5jb25uZWN0ZWRJY29uVG1wbCwgcGFnZS5kaXNjb25uZWN0ZWRJY29uVG1wbCwgcGFnZS5yZW1vdmVJY29uVG1wbClcblxuICAgIHRoaXMuZm9ybXMgPSBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLmZvcm1zLCAnOnNjb3BlID4gZm9ybScpXG4gICAgcGFnZS5mb3Jtcy5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIERvYy5iaW5kKGVsLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuY2xvc2VQb3B1cHMoKSB9KVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS5jYW5jZWxGb3JjZSwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmNsb3NlUG9wdXBzKCkgfSlcblxuICAgIHRoaXMuc2VsZWN0ZWRBc3NldElEID0gLTFcbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXMoXG4gICAgICBwYWdlLmljb25TZWxlY3RUbXBsLCBwYWdlLmJhbGFuY2VEZXRhaWxSb3csIHBhZ2UucmVjZW50T3JkZXJUbXBsLCBwYWdlLnZzcFJvd1RtcGwsXG4gICAgICBwYWdlLnRpY2tldEhpc3RvcnlSb3dUbXBsLCBwYWdlLnZvdGluZ0Nob2ljZVRtcGwsIHBhZ2Uudm90aW5nQWdlbmRhVG1wbCwgcGFnZS50c3BlbmRUbXBsLFxuICAgICAgcGFnZS50a2V5VG1wbCwgcGFnZS50eEhpc3RvcnlSb3dUbXBsLCBwYWdlLnR4SGlzdG9yeURhdGVSb3dUbXBsXG4gICAgKVxuXG4gICAgRG9jLmJpbmQocGFnZS5jcmVhdGVXYWxsZXQsICdjbGljaycsICgpID0+IHRoaXMuc2hvd05ld1dhbGxldCh0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgRG9jLmJpbmQocGFnZS5jb25uZWN0QnR0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5kb0Nvbm5lY3QodGhpcy5zZWxlY3RlZEFzc2V0SUQpKVxuICAgIERvYy5iaW5kKHBhZ2Uuc2VuZCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93U2VuZEZvcm0odGhpcy5zZWxlY3RlZEFzc2V0SUQpKVxuICAgIERvYy5iaW5kKHBhZ2UucmVjZWl2ZSwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93RGVwb3NpdCh0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgRG9jLmJpbmQocGFnZS51bmxvY2tCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLm9wZW5XYWxsZXQodGhpcy5zZWxlY3RlZEFzc2V0SUQpKVxuICAgIERvYy5iaW5kKHBhZ2UubG9ja0J0dG4sICdjbGljaycsICgpID0+IHRoaXMubG9jayh0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgRG9jLmJpbmQocGFnZS5yZWNvbmZpZ3VyZUJ0dG4sICdjbGljaycsICgpID0+IHRoaXMuc2hvd1JlY29uZmlnKHRoaXMuc2VsZWN0ZWRBc3NldElEKSlcbiAgICBEb2MuYmluZChwYWdlLm5lZWRzUHJvdmlkZXJCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLnNob3dSZWNvbmZpZyh0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgRG9jLmJpbmQocGFnZS5yZXNjYW5XYWxsZXQsICdjbGljaycsICgpID0+IHRoaXMucmVzY2FuV2FsbGV0KHRoaXMuc2VsZWN0ZWRBc3NldElEKSlcbiAgICBEb2MuYmluZChwYWdlLmVhcmxpZXJUeHMsICdjbGljaycsICgpID0+IHRoaXMubG9hZEVhcmxpZXJUeHMoKSlcblxuICAgIERvYy5iaW5kKHBhZ2UuY29weVR4SURCdG4sICdjbGljaycsICgpID0+IHsgc2V0dXBDb3B5QnRuKHRoaXMuY3VyclR4Py5pZCB8fCAnJywgcGFnZS50eERldGFpbHNJRCwgcGFnZS5jb3B5VHhJREJ0biwgJyMxZTdkMTEnKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuY29weVJlY2lwaWVudEJ0biwgJ2NsaWNrJywgKCkgPT4geyBzZXR1cENvcHlCdG4odGhpcy5jdXJyVHg/LnJlY2lwaWVudCB8fCAnJywgcGFnZS50eERldGFpbHNSZWNpcGllbnQsIHBhZ2UuY29weVJlY2lwaWVudEJ0biwgJyMxZTdkMTEnKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuY29weUJvbmRJREJ0biwgJ2NsaWNrJywgKCkgPT4geyBzZXR1cENvcHlCdG4odGhpcy5jdXJyVHg/LmJvbmRJbmZvPy5ib25kSUQgfHwgJycsIHBhZ2UudHhEZXRhaWxzQm9uZElELCBwYWdlLmNvcHlCb25kSURCdG4sICcjMWU3ZDExJykgfSlcbiAgICBEb2MuYmluZChwYWdlLmNvcHlCb25kQWNjb3VudElEQnRuLCAnY2xpY2snLCAoKSA9PiB7IHNldHVwQ29weUJ0bih0aGlzLmN1cnJUeD8uYm9uZEluZm8/LmFjY291bnRJRCB8fCAnJywgcGFnZS50eERldGFpbHNCb25kQWNjb3VudElELCBwYWdlLmNvcHlCb25kQWNjb3VudElEQnRuLCAnIzFlN2QxMScpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5oaWRlTWl4VHhzQ2hlY2tib3gsICdjaGFuZ2UnLCAoKSA9PiB7IHRoaXMuc2hvd1R4SGlzdG9yeSh0aGlzLnNlbGVjdGVkQXNzZXRJRCkgfSlcblxuICAgIC8vIEJpbmQgdGhlIG5ldyB3YWxsZXQgZm9ybS5cbiAgICB0aGlzLm5ld1dhbGxldEZvcm0gPSBuZXcgTmV3V2FsbGV0Rm9ybShwYWdlLm5ld1dhbGxldEZvcm0sIChhc3NldElEOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IGZtdFBhcmFtcyA9IHsgYXNzZXROYW1lOiBhcHAoKS5hc3NldHNbYXNzZXRJRF0ubmFtZSB9XG4gICAgICB0aGlzLmFzc2V0VXBkYXRlZChhc3NldElELCBwYWdlLm5ld1dhbGxldEZvcm0sIGludGwucHJlcChpbnRsLklEX05FV19XQUxMRVRfU1VDQ0VTUywgZm10UGFyYW1zKSlcbiAgICAgIHRoaXMuc29ydEFzc2V0QnV0dG9ucygpXG4gICAgICB0aGlzLnVwZGF0ZVRpY2tldEJ1eWVyKGFzc2V0SUQpXG4gICAgICB0aGlzLnVwZGF0ZVByaXZhY3koYXNzZXRJRClcbiAgICB9KVxuXG4gICAgLy8gQmluZCB0aGUgd2FsbGV0IHJlY29uZmlnIGZvcm0uXG4gICAgdGhpcy5yZWNvbmZpZ0Zvcm0gPSBuZXcgV2FsbGV0Q29uZmlnRm9ybShwYWdlLnJlY29uZmlnSW5wdXRzLCBmYWxzZSlcblxuICAgIHRoaXMud2FsbGV0Q2ZnR3VpZGUgPSBEb2MudG1wbEVsZW1lbnQocGFnZS5yZWNvbmZpZ0Zvcm0sICd3YWxsZXRDZmdHdWlkZScpXG5cbiAgICAvLyBCaW5kIHRoZSBzZW5kIGZvcm0uXG4gICAgYmluZEZvcm0ocGFnZS5zZW5kRm9ybSwgcGFnZS5zdWJtaXRTZW5kRm9ybSwgYXN5bmMgKCkgPT4geyB0aGlzLnN0ZXBTZW5kKCkgfSlcbiAgICAvLyBTZW5kIGNvbmZpcm1hdGlvbiBmb3JtLlxuICAgIGJpbmRGb3JtKHBhZ2UudlNlbmRGb3JtLCBwYWdlLnZTZW5kLCBhc3luYyAoKSA9PiB7IHRoaXMuc2VuZCgpIH0pXG4gICAgLy8gQmluZCB0aGUgd2FsbGV0IHJlY29uZmlndXJhdGlvbiBzdWJtaXNzaW9uLlxuICAgIGJpbmRGb3JtKHBhZ2UucmVjb25maWdGb3JtLCBwYWdlLnN1Ym1pdFJlY29uZmlnLCAoKSA9PiB0aGlzLnJlY29uZmlnKCkpXG5cbiAgICBwYWdlLmZvcm1zLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtLWNsb3NlcicpLmZvckVhY2goZWwgPT4ge1xuICAgICAgRG9jLmJpbmQoZWwsICdjbGljaycsICgpID0+IHRoaXMuY2xvc2VQb3B1cHMoKSlcbiAgICB9KVxuXG4gICAgRG9jLmJpbmQocGFnZS5mb3JtcywgJ21vdXNlZG93bicsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoIURvYy5tb3VzZUluRWxlbWVudChlLCB0aGlzLmN1cnJlbnRGb3JtKSkgeyB0aGlzLmNsb3NlUG9wdXBzKCkgfVxuICAgIH0pXG5cbiAgICB0aGlzLm1peGVyVG9nZ2xlID0gbmV3IEFuaVRvZ2dsZShwYWdlLnRvZ2dsZU1peGVyLCBwYWdlLm1peGluZ0VyciwgZmFsc2UsIChuZXdTdGF0ZTogYm9vbGVhbikgPT4geyByZXR1cm4gdGhpcy51cGRhdGVNaXhlclN0YXRlKG5ld1N0YXRlKSB9KVxuXG4gICAgdGhpcy5rZXl1cCA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIGlmIChEb2MuaXNEaXNwbGF5ZWQodGhpcy5wYWdlLmZvcm1zKSkgdGhpcy5jbG9zZVBvcHVwcygpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuXG4gICAgRG9jLmJpbmQocGFnZS5kb3dubG9hZExvZ3MsICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5kb3dubG9hZExvZ3MoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuZXhwb3J0V2FsbGV0LCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuZGlzcGxheUV4cG9ydFdhbGxldEF1dGgoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UucmVjb3ZlcldhbGxldCwgJ2NsaWNrJywgYXN5bmMgKCkgPT4geyB0aGlzLnNob3dSZWNvdmVyV2FsbGV0KCkgfSlcbiAgICBiaW5kRm9ybShwYWdlLmV4cG9ydFdhbGxldEF1dGgsIHBhZ2UuZXhwb3J0V2FsbGV0QXV0aFN1Ym1pdCwgYXN5bmMgKCkgPT4geyB0aGlzLmV4cG9ydFdhbGxldEF1dGhTdWJtaXQoKSB9KVxuICAgIGJpbmRGb3JtKHBhZ2UucmVjb3ZlcldhbGxldENvbmZpcm0sIHBhZ2UucmVjb3ZlcldhbGxldFN1Ym1pdCwgKCkgPT4geyB0aGlzLnJlY292ZXJXYWxsZXQoKSB9KVxuICAgIGJpbmRGb3JtKHBhZ2UuY29uZmlybUZvcmNlLCBwYWdlLmNvbmZpcm1Gb3JjZVN1Ym1pdCwgYXN5bmMgKCkgPT4geyB0aGlzLmNvbmZpcm1Gb3JjZVN1Ym1pdCgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5kaXNhYmxlV2FsbGV0LCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc2hvd1RvZ2dsZVdhbGxldFN0YXR1cyh0cnVlKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuZW5hYmxlV2FsbGV0LCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc2hvd1RvZ2dsZVdhbGxldFN0YXR1cyhmYWxzZSkgfSlcbiAgICBiaW5kRm9ybShwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0NvbmZpcm0sIHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzU3VibWl0LCBhc3luYyAoKSA9PiB7IHRoaXMudG9nZ2xlV2FsbGV0U3RhdHVzKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLm1hbmFnZVBlZXJzLCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc2hvd01hbmFnZVBlZXJzRm9ybSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5hZGRQZWVyU3VibWl0LCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc3VibWl0QWRkUGVlcigpIH0pXG4gICAgRG9jLmJpbmQocGFnZS51bmFwcHJvdmVUb2tlbkFsbG93YW5jZSwgJ2NsaWNrJywgYXN5bmMgKCkgPT4geyB0aGlzLnNob3dVbmFwcHJvdmVUb2tlbkFsbG93YW5jZVRhYmxlRm9ybSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS51bmFwcHJvdmVUb2tlblN1Ym1pdCwgJ2NsaWNrJywgYXN5bmMgKCkgPT4geyB0aGlzLnN1Ym1pdFVuYXBwcm92ZVRva2VuQWxsb3dhbmNlKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnNob3dWU1BzLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1ZTUFBpY2tlcigpIH0pXG4gICAgRG9jLmJpbmQocGFnZS52c3BEaXNwbGF5LCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1ZTUFBpY2tlcigpIH0pXG4gICAgYmluZEZvcm0ocGFnZS52c3BQaWNrZXIsIHBhZ2UuY3VzdG9tVnNwU3VibWl0LCBhc3luYyAoKSA9PiB7IHRoaXMuc2V0Q3VzdG9tVlNQKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnB1cmNoYXNlVGlja2V0c0J0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93UHVyY2hhc2VUaWNrZXRzRGlhbG9nKCkgfSlcbiAgICBiaW5kRm9ybShwYWdlLnB1cmNoYXNlVGlja2V0c0Zvcm0sIHBhZ2UucHVyY2hhc2VyU3VibWl0LCAoKSA9PiB7IHRoaXMucHVyY2hhc2VUaWNrZXRzKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnB1cmNoYXNlcklucHV0LCAnY2hhbmdlJywgKCkgPT4geyB0aGlzLnB1cmNoYXNlcklucHV0Q2hhbmdlZCgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS50aWNrZXRIaXN0b3J5LCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1RpY2tldEhpc3RvcnkoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UudGlja2V0SGlzdG9yeU5leHRQYWdlLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMubmV4dFRpY2tldFBhZ2UoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UudGlja2V0SGlzdG9yeVByZXZQYWdlLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMucHJldlRpY2tldFBhZ2UoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc2V0Vm90ZXMsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93U2V0Vm90ZXNEaWFsb2coKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UucHVyY2hhc2VUaWNrZXRzRXJyQ2xvc2VyLCAnY2xpY2snLCAoKSA9PiB7IERvYy5oaWRlKHBhZ2UucHVyY2hhc2VUaWNrZXRzRXJyQm94KSB9KVxuICAgIERvYy5iaW5kKHBhZ2UucHJpdmFjeUluZm9CdHRuLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd0Zvcm0ocGFnZS5taXhpbmdJbmZvKSB9KVxuXG4gICAgLy8gTmV3IGRlcG9zaXQgYWRkcmVzcyBidXR0b24uXG4gICAgdGhpcy5kZXBvc2l0QWRkckZvcm0gPSBuZXcgRGVwb3NpdEFkZHJlc3MocGFnZS5kZXBvc2l0KVxuXG4gICAgLy8gQ2xpY2tpbmcgb24gdGhlIGF2YWlsYWJsZSBhbW91bnQgb24gdGhlIFNlbmQgZm9ybSBwb3B1bGF0ZXMgdGhlXG4gICAgLy8gYW1vdW50IGZpZWxkLlxuICAgIERvYy5iaW5kKHBhZ2Uud2FsbGV0QmFsLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMucG9wdWxhdGVNYXhTZW5kKCkgfSlcblxuICAgIC8vIERpc3BsYXkgZmlhdCB2YWx1ZSBmb3IgY3VycmVudCBzZW5kIGFtb3VudC5cbiAgICBEb2MuYmluZChwYWdlLnNlbmRBbXQsICdpbnB1dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgdW5pdEluZm86IHVpIH0gPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgICBjb25zdCBhbXQgPSBwYXJzZUZsb2F0RGVmYXVsdChwYWdlLnNlbmRBbXQudmFsdWUpXG4gICAgICBjb25zdCBjb252ZXJzaW9uRmFjdG9yID0gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIERvYy5zaG93RmlhdFZhbHVlKHBhZ2Uuc2VuZFZhbHVlLCBhbXQgKiBjb252ZXJzaW9uRmFjdG9yLCBhcHAoKS5maWF0UmF0ZXNNYXBbdGhpcy5zZWxlY3RlZEFzc2V0SURdLCB1aSlcbiAgICB9KVxuXG4gICAgLy8gQ2xpY2tpbmcgb24gbWF4U2VuZCBvbiB0aGUgc2VuZCBmb3JtIHNob3VsZCBwb3B1bGF0ZSB0aGUgYW1vdW50IGZpZWxkLlxuICAgIERvYy5iaW5kKHBhZ2UubWF4U2VuZCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnBvcHVsYXRlTWF4U2VuZCgpIH0pXG5cbiAgICAvLyBWYWxpZGF0ZSBzZW5kIGFkZHJlc3Mgb24gaW5wdXQuXG4gICAgRG9jLmJpbmQocGFnZS5zZW5kQWRkciwgJ2lucHV0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgICBwYWdlLnNlbmRBZGRyLmNsYXNzTGlzdC5yZW1vdmUoJ2JvcmRlci1kYW5nZXInLCAnYm9yZGVyLXN1Y2Nlc3MnKVxuICAgICAgY29uc3QgYWRkciA9IHBhZ2Uuc2VuZEFkZHIudmFsdWUgfHwgJydcbiAgICAgIGlmICghYXNzZXQgfHwgYWRkciA9PT0gJycpIHJldHVyblxuICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCB0aGlzLnZhbGlkYXRlU2VuZEFkZHJlc3MoYWRkciwgYXNzZXQuaWQpXG4gICAgICBpZiAodmFsaWQpIHBhZ2Uuc2VuZEFkZHIuY2xhc3NMaXN0LmFkZCgnYm9yZGVyLXN1Y2Nlc3MnKVxuICAgICAgZWxzZSBwYWdlLnNlbmRBZGRyLmNsYXNzTGlzdC5hZGQoJ2JvcmRlci1kYW5nZXInKVxuICAgIH0pXG5cbiAgICAvLyBBIGxpbmsgb24gdGhlIHdhbGxldCByZWNvbmZpZ3VyYXRpb24gZm9ybSB0byBzaG93L2hpZGUgdGhlIHBhc3N3b3JkIGZpZWxkLlxuICAgIERvYy5iaW5kKHBhZ2Uuc2hvd0NoYW5nZVBXLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmNoYW5nZVdhbGxldFBXID0gIXRoaXMuY2hhbmdlV2FsbGV0UFdcbiAgICAgIHRoaXMuc2V0UFdTZXR0aW5nVml6KHRoaXMuY2hhbmdlV2FsbGV0UFcpXG4gICAgfSlcblxuICAgIC8vIENoYW5naW5nIHRoZSB0eXBlIG9mIHdhbGxldC5cbiAgICBEb2MuYmluZChwYWdlLmNoYW5nZVdhbGxldFR5cGVTZWxlY3QsICdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICB0aGlzLmNoYW5nZVdhbGxldFR5cGUoKVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zaG93Q2hhbmdlVHlwZSwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgaWYgKERvYy5pc0hpZGRlbihwYWdlLmNoYW5nZVdhbGxldFR5cGUpKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UuY2hhbmdlV2FsbGV0VHlwZSwgcGFnZS5jaGFuZ2VUeXBlSGlkZUljb24pXG4gICAgICAgIERvYy5oaWRlKHBhZ2UuY2hhbmdlVHlwZVNob3dJY29uKVxuICAgICAgICBwYWdlLmNoYW5nZVR5cGVNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9LRUVQX1dBTExFVF9UWVBFKVxuICAgICAgfSBlbHNlIHRoaXMuc2hvd1JlY29uZmlnKHRoaXMuc2VsZWN0ZWRBc3NldElELCB7IHNraXBBbmltYXRpb246IHRydWUgfSlcbiAgICB9KVxuXG4gICAgYXBwKCkucmVnaXN0ZXJOb3RlRmVlZGVyKHtcbiAgICAgIGZpYXRyYXRldXBkYXRlOiAobm90ZTogUmF0ZU5vdGUpID0+IHsgdGhpcy5oYW5kbGVSYXRlc05vdGUobm90ZSkgfSxcbiAgICAgIGJhbGFuY2U6IChub3RlOiBCYWxhbmNlTm90ZSkgPT4geyB0aGlzLmhhbmRsZUJhbGFuY2VOb3RlKG5vdGUpIH0sXG4gICAgICB3YWxsZXRzdGF0ZTogKG5vdGU6IFdhbGxldFN0YXRlTm90ZSkgPT4geyB0aGlzLmhhbmRsZVdhbGxldFN0YXRlTm90ZShub3RlKSB9LFxuICAgICAgd2FsbGV0Y29uZmlnOiAobm90ZTogV2FsbGV0U3RhdGVOb3RlKSA9PiB7IHRoaXMuaGFuZGxlV2FsbGV0U3RhdGVOb3RlKG5vdGUpIH0sXG4gICAgICB3YWxsZXRzeW5jOiAobm90ZTogV2FsbGV0U3luY05vdGUpID0+IHsgdGhpcy51cGRhdGVTeW5jQW5kUGVlcnMobm90ZS5hc3NldElEKSB9LFxuICAgICAgY3JlYXRld2FsbGV0OiAobm90ZTogV2FsbGV0Q3JlYXRpb25Ob3RlKSA9PiB7IHRoaXMuaGFuZGxlQ3JlYXRlV2FsbGV0Tm90ZShub3RlKSB9LFxuICAgICAgd2FsbGV0bm90ZTogKG5vdGU6IFdhbGxldE5vdGUpID0+IHsgdGhpcy5oYW5kbGVDdXN0b21XYWxsZXROb3RlKG5vdGUpIH1cbiAgICB9KVxuXG4gICAgY29uc3QgZmlyc3RBc3NldCA9IHRoaXMuc29ydEFzc2V0QnV0dG9ucygpXG4gICAgbGV0IHNlbGVjdGVkQXNzZXQgPSBmaXJzdEFzc2V0LmlkXG4gICAgY29uc3QgYXNzZXRJRFN0ciA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUuc2VsZWN0ZWRBc3NldExLKVxuICAgIGlmIChhc3NldElEU3RyKSBzZWxlY3RlZEFzc2V0ID0gTnVtYmVyKGFzc2V0SURTdHIpXG4gICAgdGhpcy5zZXRTZWxlY3RlZEFzc2V0KHNlbGVjdGVkQXNzZXQpXG5cbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IHJvdyBvZiB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmNoaWxkcmVuKSB7XG4gICAgICAgIGNvbnN0IGFnZSA9IERvYy50bXBsRWxlbWVudChyb3cgYXMgUGFnZUVsZW1lbnQsICdhZ2UnKVxuICAgICAgICBhZ2UudGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKHBhcnNlSW50KGFnZS5kYXRhc2V0LnRpbWVzdGFtcCBhcyBzdHJpbmcpKVxuICAgICAgfVxuICAgIH0sIDUwMDApXG4gIH1cblxuICBjbG9zZVBvcHVwcyAoKSB7XG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLmZvcm1zKVxuICAgIHRoaXMuY3VyclR4ID0gdW5kZWZpbmVkXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uKSB0aGlzLmFuaW1hdGlvbi5zdG9wKClcbiAgfVxuXG4gIGFzeW5jIHNhZmVQb3N0IChwYXRoOiBzdHJpbmcsIGFyZ3M6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgYXNzZXRJRCA9IHRoaXMuc2VsZWN0ZWRBc3NldElEXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04ocGF0aCwgYXJncylcbiAgICBpZiAoYXNzZXRJRCAhPT0gdGhpcy5zZWxlY3RlZEFzc2V0SUQpIHRocm93IEVycm9yKCdhc3NldCBjaGFuZ2VkIGR1cmluZyByZXF1ZXN0LiBhYm9ydGluZycpXG4gICAgcmV0dXJuIHJlc1xuICB9XG5cbiAgLy8gc3RlcFNlbmQgbWFrZXMgYSByZXF1ZXN0IHRvIGdldCBhbiBlc3RpbWF0ZWQgZmVlIGFuZCBkaXNwbGF5cyB0aGUgY29uZmlybVxuICAvLyBzZW5kIGZvcm0uXG4gIGFzeW5jIHN0ZXBTZW5kICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS52U2VuZEVyciwgcGFnZS5zZW5kRXJyLCBwYWdlLnZTZW5kRXN0aW1hdGVzLCBwYWdlLnR4RmVlTm90QXZhaWxhYmxlKVxuICAgIGNvbnN0IGFzc2V0SUQgPSBwYXJzZUludChwYWdlLnNlbmRGb3JtLmRhdGFzZXQuYXNzZXRJRCB8fCAnJylcbiAgICBjb25zdCB0b2tlbiA9IGFwcCgpLmFzc2V0c1thc3NldElEXS50b2tlblxuICAgIGNvbnN0IHN1YnRyYWN0ID0gcGFnZS5zdWJ0cmFjdENoZWNrQm94LmNoZWNrZWQgfHwgZmFsc2VcbiAgICBjb25zdCBjb252ZXJzaW9uRmFjdG9yID0gYXBwKCkudW5pdEluZm8oYXNzZXRJRCkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICBjb25zdCB2YWx1ZSA9IE1hdGgucm91bmQocGFyc2VGbG9hdERlZmF1bHQocGFnZS5zZW5kQW10LnZhbHVlLCAwKSAqIGNvbnZlcnNpb25GYWN0b3IpXG4gICAgY29uc3QgYWRkciA9IHBhZ2Uuc2VuZEFkZHIudmFsdWUgfHwgJydcbiAgICBpZiAoYWRkciA9PT0gJycpIHJldHVybiBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLnNlbmRFcnIsIGludGwucHJlcChpbnRsLklEX0lOVkFMSURfQUREUkVTU19NU0csIHsgYWRkcmVzczogYWRkciB9KSlcbiAgICBjb25zdCB7IHdhbGxldCwgdW5pdEluZm86IHVpLCBzeW1ib2wgfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuXG4gICAgLy8gdHhmZWUgd2lsbCBub3QgYmUgYXZhaWxhYmxlIGlmIHdhbGxldCBpcyBub3QgYSBmZWUgZXN0aW1hdG9yIG9yIHRoZVxuICAgIC8vIHJlcXVlc3QgZmFpbGVkLlxuICAgIGxldCB0eGZlZSA9IDBcbiAgICBpZiAoKHdhbGxldC50cmFpdHMgJiB0cmFpdFR4RmVlRXN0aW1hdG9yKSAhPT0gMCkge1xuICAgICAgY29uc3Qgb3BlbiA9IHtcbiAgICAgICAgYWRkcjogcGFnZS5zZW5kQWRkci52YWx1ZSxcbiAgICAgICAgYXNzZXRJRDogYXNzZXRJRCxcbiAgICAgICAgc3VidHJhY3Q6IHN1YnRyYWN0LFxuICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgIH1cblxuICAgICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnNlbmRGb3JtKVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvdHhmZWUnLCBvcGVuKVxuICAgICAgbG9hZGVkKClcbiAgICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAgIHBhZ2UudHhGZWVOb3RBdmFpbGFibGUuZGF0YXNldC50b29sdGlwID0gaW50bC5wcmVwKGludGwuSURfVFhGRUVfRVJSX01TRywgeyBlcnI6IHJlcy5tc2cgfSlcbiAgICAgICAgRG9jLnNob3cocGFnZS50eEZlZU5vdEF2YWlsYWJsZSlcbiAgICAgICAgLy8gV2Ugc3RpbGwgd2FudCB0byBlbnN1cmUgdXNlciBhZGRyZXNzIGlzIHZhbGlkIGJlZm9yZSBwcm9jZWVkaW5nIHRvIHNlbmRcbiAgICAgICAgLy8gY29uZmlybSBmb3JtIGlmIHRoZXJlJ3MgYW4gZXJyb3Igd2hpbGUgY2FsY3VsYXRpbmcgdGhlIHRyYW5zYWN0aW9uIGZlZS5cbiAgICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCB0aGlzLnZhbGlkYXRlU2VuZEFkZHJlc3MoYWRkciwgYXNzZXRJRClcbiAgICAgICAgaWYgKCF2YWxpZCkgcmV0dXJuIERvYy5zaG93Rm9ybUVycm9yKHBhZ2Uuc2VuZEVyciwgaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9BRERSRVNTX01TRywgeyBhZGRyZXNzOiBhZGRyIHx8ICcnIH0pKVxuICAgICAgfSBlbHNlIGlmIChyZXMub2spIHtcbiAgICAgICAgaWYgKCFyZXMudmFsaWRhZGRyZXNzKSByZXR1cm4gRG9jLnNob3dGb3JtRXJyb3IocGFnZS5zZW5kRXJyLCBpbnRsLnByZXAoaW50bC5JRF9JTlZBTElEX0FERFJFU1NfTVNHLCB7IGFkZHJlc3M6IHBhZ2Uuc2VuZEFkZHIudmFsdWUgfHwgJycgfSkpXG4gICAgICAgIHR4ZmVlID0gcmVzLnR4ZmVlXG4gICAgICAgIERvYy5zaG93KHBhZ2UudlNlbmRFc3RpbWF0ZXMpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFZhbGlkYXRlIG9ubHkgdGhlIHNlbmQgYWRkcmVzcyBmb3IgYXNzZXRzIHRoYXQgYXJlIG5vdCBmZWUgZXN0aW1hdG9ycy5cbiAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgdGhpcy52YWxpZGF0ZVNlbmRBZGRyZXNzKGFkZHIsIGFzc2V0SUQpXG4gICAgICBpZiAoIXZhbGlkKSByZXR1cm4gRG9jLnNob3dGb3JtRXJyb3IocGFnZS5zZW5kRXJyLCBpbnRsLnByZXAoaW50bC5JRF9JTlZBTElEX0FERFJFU1NfTVNHLCB7IGFkZHJlc3M6IGFkZHIgfHwgJycgfSkpXG4gICAgfVxuXG4gICAgcGFnZS52U2VuZFN5bWJvbC50ZXh0Q29udGVudCA9IHN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgcGFnZS52U2VuZExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHN5bWJvbClcblxuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgeyB1bml0SW5mbzogZmVlVUksIHN5bWJvbDogZmVlU3ltYm9sIH0gPSBhcHAoKS5hc3NldHNbdG9rZW4ucGFyZW50SURdXG4gICAgICBwYWdlLnZTZW5kRmVlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24odHhmZWUsIGZlZVVJKSArICcgJyArIGZlZVN5bWJvbFxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLnZTZW5kRmVlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24odHhmZWUsIHVpKVxuICAgIH1cbiAgICBjb25zdCB4Y1JhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLnZTZW5kRmVlRmlhdCwgdHhmZWUsIHhjUmF0ZSwgdWkpXG4gICAgcGFnZS52U2VuZERlc3RpbmF0aW9uQW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24odmFsdWUgLSB0eGZlZSwgdWkpXG4gICAgcGFnZS52VG90YWxTZW5kLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24odmFsdWUsIHVpKVxuICAgIERvYy5zaG93RmlhdFZhbHVlKHBhZ2UudlRvdGFsU2VuZEZpYXQsIHZhbHVlLCB4Y1JhdGUsIHVpKVxuICAgIHBhZ2UudlNlbmRBZGRyLnRleHRDb250ZW50ID0gcGFnZS5zZW5kQWRkci52YWx1ZSB8fCAnJ1xuICAgIGNvbnN0IGJhbCA9IHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSAtIHZhbHVlXG4gICAgcGFnZS5iYWxhbmNlQWZ0ZXJTZW5kLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oYmFsLCB1aSlcbiAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLmJhbGFuY2VBZnRlclNlbmRGaWF0LCBiYWwsIHhjUmF0ZSwgdWkpXG4gICAgRG9jLnNob3cocGFnZS5hcHByb3hTaWduKVxuICAgIC8vIE5PVEU6IEFsbCB0b2tlbnMgdGFrZSB0aGlzIHJvdXRlIGJlY2F1c2UgdGhleSBjYW5ub3QgcGF5IHRoZSBmZWUuXG4gICAgaWYgKCFzdWJ0cmFjdCkge1xuICAgICAgRG9jLmhpZGUocGFnZS5hcHByb3hTaWduKVxuICAgICAgcGFnZS52U2VuZERlc3RpbmF0aW9uQW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24odmFsdWUsIHVpKVxuICAgICAgbGV0IHRvdGFsU2VuZCA9IHZhbHVlXG4gICAgICBpZiAoIXRva2VuKSB0b3RhbFNlbmQgKz0gdHhmZWVcbiAgICAgIHBhZ2UudlRvdGFsU2VuZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHRvdGFsU2VuZCwgdWkpXG4gICAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLnZUb3RhbFNlbmRGaWF0LCB0b3RhbFNlbmQsIHhjUmF0ZSwgdWkpXG4gICAgICBsZXQgYmFsID0gd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC0gdmFsdWVcbiAgICAgIGlmICghdG9rZW4pIGJhbCAtPSB0eGZlZVxuICAgICAgLy8gaGFuZGxlIGVkZ2UgY2FzZXMgd2hlcmUgYmFsIGlzIG5vdCBlbm91Z2ggdG8gY292ZXIgdG90YWxTZW5kLlxuICAgICAgLy8gd2UgZG9uJ3Qgd2FudCBhIG1pbnVzIGRpc3BsYXkgb2YgdXNlciBiYWwuXG4gICAgICBpZiAoYmFsIDw9IDApIHtcbiAgICAgICAgcGFnZS5iYWxhbmNlQWZ0ZXJTZW5kLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oMCwgdWkpXG4gICAgICAgIERvYy5zaG93RmlhdFZhbHVlKHBhZ2UuYmFsYW5jZUFmdGVyU2VuZEZpYXQsIDAsIHhjUmF0ZSwgdWkpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYWdlLmJhbGFuY2VBZnRlclNlbmQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihiYWwsIHVpKVxuICAgICAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLmJhbGFuY2VBZnRlclNlbmRGaWF0LCBiYWwsIHhjUmF0ZSwgdWkpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2Uuc2VuZEZvcm0pXG4gICAgYXdhaXQgdGhpcy5zaG93Rm9ybShwYWdlLnZTZW5kRm9ybSlcbiAgfVxuXG4gIC8vIGNhbmNlbFNlbmQgZGlzcGxheXMgdGhlIHNlbmQgZm9ybSBpZiB1c2VyIHdhbnRzIHRvIG1ha2UgbW9kaWZpY2F0aW9uLlxuICBhc3luYyBjYW5jZWxTZW5kICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS52U2VuZEZvcm0sIHBhZ2Uuc2VuZEVycilcbiAgICBhd2FpdCB0aGlzLnNob3dGb3JtKHBhZ2Uuc2VuZEZvcm0pXG4gIH1cblxuICAvKlxuICAgKiB2YWxpZGF0ZVNlbmRBZGRyZXNzIHZhbGlkYXRlcyB0aGUgcHJvdmlkZWQgYWRkcmVzcyBmb3IgYW4gYXNzZXQuXG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZVNlbmRBZGRyZXNzIChhZGRyOiBzdHJpbmcsIGFzc2V0SUQ6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBwb3N0SlNPTignL2FwaS92YWxpZGF0ZWFkZHJlc3MnLCB7IGFkZHI6IGFkZHIsIGFzc2V0SUQ6IGFzc2V0SUQgfSlcbiAgICByZXR1cm4gYXBwKCkuY2hlY2tSZXNwb25zZShyZXNwKVxuICB9XG5cbiAgLypcbiAgICogc2V0UFdTZXR0aW5nVml6IHNldHMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIHBhc3N3b3JkIGZpZWxkIHNlY3Rpb24uXG4gICAqL1xuICBzZXRQV1NldHRpbmdWaXogKHZpc2libGU6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgaWYgKHZpc2libGUpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc2hvd0ljb24pXG4gICAgICBEb2Muc2hvdyhwYWdlLmhpZGVJY29uLCBwYWdlLmNoYW5nZVBXKVxuICAgICAgcGFnZS5zd2l0Y2hQV01zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0tFRVBfV0FMTEVUX1BBU1MpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLmhpZGUocGFnZS5oaWRlSWNvbiwgcGFnZS5jaGFuZ2VQVylcbiAgICBEb2Muc2hvdyhwYWdlLnNob3dJY29uKVxuICAgIHBhZ2Uuc3dpdGNoUFdNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9ORVdfV0FMTEVUX1BBU1MpXG4gIH1cblxuICAvKlxuICAgKiBhc3NldFZlcnNpb25Vc2VkQnlERVhlcyByZXR1cm5zIGEgbWFwIG9mIHRoZSB2ZXJzaW9ucyBvZiB0aGVcbiAgICogY3VycmVudGx5IHNlbGVjdGVkIGFzc2V0IHRvIHRoZSBERVhlcyB0aGF0IHVzZSB0aGF0IHZlcnNpb24uXG4gICAqL1xuICBhc3NldFZlcnNpb25Vc2VkQnlERVhlcyAoKTogUmVjb3JkPG51bWJlciwgc3RyaW5nW10+IHtcbiAgICBjb25zdCBhc3NldElEID0gdGhpcy5zZWxlY3RlZEFzc2V0SURcbiAgICBjb25zdCB2ZXJzaW9uVG9ERVhlcyA9IHt9IGFzIFJlY29yZDxudW1iZXIsIHN0cmluZ1tdPlxuICAgIGNvbnN0IGV4Y2hhbmdlcyA9IGFwcCgpLmV4Y2hhbmdlc1xuXG4gICAgZm9yIChjb25zdCBob3N0IGluIGV4Y2hhbmdlcykge1xuICAgICAgY29uc3QgZXhjaGFuZ2UgPSBleGNoYW5nZXNbaG9zdF1cbiAgICAgIGNvbnN0IGV4Y2hhbmdlQXNzZXQgPSBleGNoYW5nZS5hc3NldHNbYXNzZXRJRF1cbiAgICAgIGlmICghZXhjaGFuZ2VBc3NldCkgY29udGludWVcbiAgICAgIGlmICghdmVyc2lvblRvREVYZXNbZXhjaGFuZ2VBc3NldC52ZXJzaW9uXSkge1xuICAgICAgICB2ZXJzaW9uVG9ERVhlc1tleGNoYW5nZUFzc2V0LnZlcnNpb25dID0gW11cbiAgICAgIH1cbiAgICAgIHZlcnNpb25Ub0RFWGVzW2V4Y2hhbmdlQXNzZXQudmVyc2lvbl0ucHVzaChleGNoYW5nZS5ob3N0KVxuICAgIH1cblxuICAgIHJldHVybiB2ZXJzaW9uVG9ERVhlc1xuICB9XG5cbiAgLypcbiAgICogc3VibWl0VW5hcHByb3ZlVG9rZW5BbGxvd2FuY2Ugc3VibWl0cyBhIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB0b1xuICAgKiB1bmFwcHJvdmUgYSB2ZXJzaW9uIG9mIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgdG9rZW4ncyBzd2FwIGNvbnRyYWN0LlxuICAgKi9cbiAgYXN5bmMgc3VibWl0VW5hcHByb3ZlVG9rZW5BbGxvd2FuY2UgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBwYXRoID0gJy9hcGkvdW5hcHByb3ZldG9rZW4nXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04ocGF0aCwge1xuICAgICAgYXNzZXRJRDogdGhpcy5zZWxlY3RlZEFzc2V0SUQsXG4gICAgICB2ZXJzaW9uOiB0aGlzLnVuYXBwcm92aW5nVG9rZW5WZXJzaW9uXG4gICAgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS51bmFwcHJvdmVUb2tlbkVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UudW5hcHByb3ZlVG9rZW5FcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBhc3NldEV4cGxvcmVyID0gQ29pbkV4cGxvcmVyc1t0aGlzLnNlbGVjdGVkQXNzZXRJRF1cbiAgICBpZiAoYXNzZXRFeHBsb3JlciAmJiBhc3NldEV4cGxvcmVyW25ldF0pIHtcbiAgICAgIHBhZ2UudW5hcHByb3ZlVG9rZW5UeElELmhyZWYgPSBhc3NldEV4cGxvcmVyW25ldF0ocmVzLnR4SUQpXG4gICAgfVxuICAgIHBhZ2UudW5hcHByb3ZlVG9rZW5UeElELnRleHRDb250ZW50ID0gcmVzLnR4SURcbiAgICBEb2MuaGlkZShwYWdlLnVuYXBwcm92ZVRva2VuU3VibWlzc2lvbkVsZW1lbnRzLCBwYWdlLnVuYXBwcm92ZVRva2VuRXJyKVxuICAgIERvYy5zaG93KHBhZ2UudW5hcHByb3ZlVG9rZW5UeE1zZylcbiAgfVxuXG4gIC8qXG4gICAqIHNob3dVbmFwcHJvdmVUb2tlbkFsbG93YW5jZUZvcm0gZGlzcGxheXMgdGhlIGZvcm0gZm9yIHVuYXBwcm92aW5nXG4gICAqIGEgc3BlY2lmaWMgdmVyc2lvbiBvZiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHRva2VuJ3Mgc3dhcCBjb250cmFjdC5cbiAgICovXG4gIGFzeW5jIHNob3dVbmFwcHJvdmVUb2tlbkFsbG93YW5jZUZvcm0gKHZlcnNpb246IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLnVuYXBwcm92aW5nVG9rZW5WZXJzaW9uID0gdmVyc2lvblxuICAgIERvYy5zaG93KHBhZ2UudW5hcHByb3ZlVG9rZW5TdWJtaXNzaW9uRWxlbWVudHMpXG4gICAgRG9jLmhpZGUocGFnZS51bmFwcHJvdmVUb2tlblR4TXNnLCBwYWdlLnVuYXBwcm92ZVRva2VuRXJyKVxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW3RoaXMuc2VsZWN0ZWRBc3NldElEXVxuICAgIGlmICghYXNzZXQgfHwgIWFzc2V0LnRva2VuKSByZXR1cm5cbiAgICBjb25zdCBwYXJlbnRBc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgICBpZiAoIXBhcmVudEFzc2V0KSByZXR1cm5cbiAgICBEb2MuZW1wdHkocGFnZS50b2tlbkFsbG93YW5jZVJlbW92ZVN5bWJvbClcbiAgICBwYWdlLnRva2VuQWxsb3dhbmNlUmVtb3ZlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUoYXNzZXQsIHRydWUpKVxuICAgIHBhZ2UudG9rZW5BbGxvd2FuY2VSZW1vdmVWZXJzaW9uLnRleHRDb250ZW50ID0gdmVyc2lvbi50b1N0cmluZygpXG5cbiAgICBjb25zdCBwYXRoID0gJy9hcGkvYXBwcm92ZXRva2VuZmVlJ1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHBhdGgsIHtcbiAgICAgIGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElELFxuICAgICAgdmVyc2lvbjogdmVyc2lvbixcbiAgICAgIGFwcHJvdmluZzogZmFsc2VcbiAgICB9KVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLnVuYXBwcm92ZVRva2VuRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS51bmFwcHJvdmVUb2tlbkVycilcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGZlZVRleHQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKHJlcy50eEZlZSwgcGFyZW50QXNzZXQudW5pdEluZm8pfSAke3BhcmVudEFzc2V0LnVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0fWBcbiAgICAgIGNvbnN0IHJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbcGFyZW50QXNzZXQuaWRdXG4gICAgICBpZiAocmF0ZSkge1xuICAgICAgICBmZWVUZXh0ICs9IGAgKCR7RG9jLmZvcm1hdEZpYXRDb252ZXJzaW9uKHJlcy50eEZlZSwgcmF0ZSwgcGFyZW50QXNzZXQudW5pdEluZm8pfSBVU0QpYFxuICAgICAgfVxuICAgICAgcGFnZS51bmFwcHJvdmFsRmVlRXN0aW1hdGUudGV4dENvbnRlbnQgPSBmZWVUZXh0XG4gICAgfVxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS51bmFwcHJvdmVUb2tlbkZvcm0pXG4gIH1cblxuICAvKlxuICAgKiBzaG93VW5hcHByb3ZlVG9rZW5BbGxvd2FuY2VUYWJsZUZvcm0gZGlzcGxheXMgYSB0YWJsZSBzaG93aW5nIGVhY2ggb2YgdGhlXG4gICAqIHZlcnNpb25zIG9mIGEgdG9rZW4ncyBzd2FwIGNvbnRyYWN0IHRoYXQgaGF2ZSBiZWVuIGFwcHJvdmVkIGFuZCBhbGxvd3MgdGhlXG4gICAqIHVzZXIgdG8gdW5hcHByb3ZlIGFueSBvZiB0aGVtLlxuICAgKi9cbiAgYXN5bmMgc2hvd1VuYXBwcm92ZVRva2VuQWxsb3dhbmNlVGFibGVGb3JtICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgaWYgKCFhc3NldCB8fCAhYXNzZXQud2FsbGV0IHx8ICFhc3NldC53YWxsZXQuYXBwcm92ZWQpIHJldHVyblxuICAgIHdoaWxlIChwYWdlLnRva2VuVmVyc2lvbkJvZHkuZmlyc3RDaGlsZCkge1xuICAgICAgcGFnZS50b2tlblZlcnNpb25Cb2R5LnJlbW92ZUNoaWxkKHBhZ2UudG9rZW5WZXJzaW9uQm9keS5maXJzdENoaWxkKVxuICAgIH1cbiAgICBEb2MuZW1wdHkocGFnZS50b2tlblZlcnNpb25UYWJsZUFzc2V0U3ltYm9sKVxuICAgIHBhZ2UudG9rZW5WZXJzaW9uVGFibGVBc3NldFN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKGFzc2V0LCB0cnVlKSlcbiAgICBjb25zdCB2ZXJzaW9uVG9ERVhlcyA9IHRoaXMuYXNzZXRWZXJzaW9uVXNlZEJ5REVYZXMoKVxuXG4gICAgbGV0IHNob3dUYWJsZSA9IGZhbHNlXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gYXNzZXQud2FsbGV0LnZlcnNpb247IGkrKykge1xuICAgICAgY29uc3QgYXBwcm92YWxTdGF0dXMgPSBhc3NldC53YWxsZXQuYXBwcm92ZWRbaV1cbiAgICAgIGlmIChhcHByb3ZhbFN0YXR1cyA9PT0gdW5kZWZpbmVkIHx8IGFwcHJvdmFsU3RhdHVzICE9PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCkge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgc2hvd1RhYmxlID0gdHJ1ZVxuICAgICAgY29uc3Qgcm93ID0gcGFnZS50b2tlblZlcnNpb25Sb3cuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgdG1wbC52ZXJzaW9uLnRleHRDb250ZW50ID0gaS50b1N0cmluZygpXG4gICAgICBpZiAodmVyc2lvblRvREVYZXNbaV0pIHtcbiAgICAgICAgdG1wbC51c2VkQnkudGV4dENvbnRlbnQgPSB2ZXJzaW9uVG9ERVhlc1tpXS5qb2luKCcsICcpXG4gICAgICB9XG4gICAgICBjb25zdCByZW1vdmVJY29uID0gdGhpcy5wYWdlLnJlbW92ZUljb25UbXBsLmNsb25lTm9kZSh0cnVlKVxuICAgICAgRG9jLmJpbmQocmVtb3ZlSWNvbiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnNob3dVbmFwcHJvdmVUb2tlbkFsbG93YW5jZUZvcm0oaSlcbiAgICAgIH0pXG4gICAgICB0bXBsLnJlbW92ZS5hcHBlbmRDaGlsZChyZW1vdmVJY29uKVxuICAgICAgcGFnZS50b2tlblZlcnNpb25Cb2R5LmFwcGVuZENoaWxkKHJvdylcbiAgICB9XG4gICAgRG9jLnNldFZpcyhzaG93VGFibGUsIHBhZ2UudG9rZW5WZXJzaW9uVGFibGUpXG4gICAgRG9jLnNldFZpcyghc2hvd1RhYmxlLCBwYWdlLnRva2VuVmVyc2lvbk5vbmUpXG4gICAgdGhpcy5zaG93Rm9ybShwYWdlLnVuYXBwcm92ZVRva2VuVGFibGVGb3JtKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlV2FsbGV0UGVlcnMgcmV0cmlldmVzIHRoZSB3YWxsZXQgcGVlcnMgYW5kIGRpc3BsYXlzIHRoZW0gaW4gdGhlXG4gICAqIHdhbGxldCBwZWVycyB0YWJsZS5cbiAgICovXG4gIGFzeW5jIHVwZGF0ZVdhbGxldFBlZXJzVGFibGUgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcblxuICAgIERvYy5oaWRlKHBhZ2UucGVlclNwaW5uZXIpXG5cbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9nZXR3YWxsZXRwZWVycycsIHtcbiAgICAgIGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElEXG4gICAgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5tYW5hZ2VQZWVyc0Vyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UubWFuYWdlUGVlcnNFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB3aGlsZSAocGFnZS5wZWVyc1RhYmxlQm9keS5maXJzdENoaWxkKSB7XG4gICAgICBwYWdlLnBlZXJzVGFibGVCb2R5LnJlbW92ZUNoaWxkKHBhZ2UucGVlcnNUYWJsZUJvZHkuZmlyc3RDaGlsZClcbiAgICB9XG5cbiAgICBjb25zdCBwZWVycyA6IFdhbGxldFBlZXJbXSA9IHJlcy5wZWVycyB8fCBbXVxuICAgIHBlZXJzLnNvcnQoKGE6IFdhbGxldFBlZXIsIGI6IFdhbGxldFBlZXIpIDogbnVtYmVyID0+IHtcbiAgICAgIHJldHVybiBhLnNvdXJjZSAtIGIuc291cmNlXG4gICAgfSlcblxuICAgIGNvbnN0IGRlZmF1bHRUZXh0ID0gaW50bC5wcmVwKGludGwuSURfREVGQVVMVClcbiAgICBjb25zdCBhZGRlZFRleHQgPSBpbnRsLnByZXAoaW50bC5JRF9BRERFRClcbiAgICBjb25zdCBkaXNjb3ZlcmVkVGV4dCA9IGludGwucHJlcChpbnRsLklEX0RJU0NPVkVSRUQpXG5cbiAgICBwZWVycy5mb3JFYWNoKChwZWVyOiBXYWxsZXRQZWVyKSA9PiB7XG4gICAgICBjb25zdCByb3cgPSBwYWdlLnBlZXJUYWJsZVJvdy5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG5cbiAgICAgIHRtcGwuYWRkci50ZXh0Q29udGVudCA9IHBlZXIuYWRkclxuXG4gICAgICBzd2l0Y2ggKHBlZXIuc291cmNlKSB7XG4gICAgICAgIGNhc2UgUGVlclNvdXJjZS5XYWxsZXREZWZhdWx0OlxuICAgICAgICAgIHRtcGwuc291cmNlLnRleHRDb250ZW50ID0gZGVmYXVsdFRleHRcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIFBlZXJTb3VyY2UuVXNlckFkZGVkOlxuICAgICAgICAgIHRtcGwuc291cmNlLnRleHRDb250ZW50ID0gYWRkZWRUZXh0XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBQZWVyU291cmNlLkRpc2NvdmVyZWQ6XG4gICAgICAgICAgdG1wbC5zb3VyY2UudGV4dENvbnRlbnQgPSBkaXNjb3ZlcmVkVGV4dFxuICAgICAgICAgIGJyZWFrXG4gICAgICB9XG5cbiAgICAgIGxldCBjb25uZWN0aW9uSWNvblxuICAgICAgaWYgKHBlZXIuY29ubmVjdGVkKSB7XG4gICAgICAgIGNvbm5lY3Rpb25JY29uID0gdGhpcy5wYWdlLmNvbm5lY3RlZEljb25UbXBsLmNsb25lTm9kZSh0cnVlKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29ubmVjdGlvbkljb24gPSB0aGlzLnBhZ2UuZGlzY29ubmVjdGVkSWNvblRtcGwuY2xvbmVOb2RlKHRydWUpXG4gICAgICB9XG4gICAgICB0bXBsLmNvbm5lY3RlZC5hcHBlbmRDaGlsZChjb25uZWN0aW9uSWNvbilcblxuICAgICAgaWYgKHBlZXIuc291cmNlID09PSBQZWVyU291cmNlLlVzZXJBZGRlZCkge1xuICAgICAgICBjb25zdCByZW1vdmVJY29uID0gdGhpcy5wYWdlLnJlbW92ZUljb25UbXBsLmNsb25lTm9kZSh0cnVlKVxuICAgICAgICBEb2MuYmluZChyZW1vdmVJY29uLCAnY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgRG9jLmhpZGUocGFnZS5tYW5hZ2VQZWVyc0VycilcbiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9yZW1vdmV3YWxsZXRwZWVyJywge1xuICAgICAgICAgICAgYXNzZXRJRDogdGhpcy5zZWxlY3RlZEFzc2V0SUQsXG4gICAgICAgICAgICBhZGRyOiBwZWVyLmFkZHJcbiAgICAgICAgICB9KVxuICAgICAgICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAgICAgICBwYWdlLm1hbmFnZVBlZXJzRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgICAgICAgRG9jLnNob3cocGFnZS5tYW5hZ2VQZWVyc0VycilcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnNwaW5VbnRpbFBlZXJzVXBkYXRlKClcbiAgICAgICAgfSlcbiAgICAgICAgdG1wbC5yZW1vdmUuYXBwZW5kQ2hpbGQocmVtb3ZlSWNvbilcbiAgICAgIH1cblxuICAgICAgcGFnZS5wZWVyc1RhYmxlQm9keS5hcHBlbmRDaGlsZChyb3cpXG4gICAgfSlcbiAgfVxuXG4gIC8vIHNob3dNYW5hZ2VQZWVyc0Zvcm0gZGlzcGxheXMgdGhlIG1hbmFnZSBwZWVycyBmb3JtLlxuICBhc3luYyBzaG93TWFuYWdlUGVlcnNGb3JtICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgYXdhaXQgdGhpcy51cGRhdGVXYWxsZXRQZWVyc1RhYmxlKClcbiAgICBEb2MuaGlkZShwYWdlLm1hbmFnZVBlZXJzRXJyKVxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5tYW5hZ2VQZWVyc0Zvcm0pXG4gIH1cblxuICAvLyBzdWJtaXRBZGRQZWVycyBzZW5kcyBhIHJlcXVlc3QgZm9yIHRoZSB0aGUgd2FsbGV0IHRvIGNvbm5lY3QgdG8gYSBuZXdcbiAgLy8gcGVlci5cbiAgYXN5bmMgc3VibWl0QWRkUGVlciAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UubWFuYWdlUGVlcnNFcnIpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvYWRkd2FsbGV0cGVlcicsIHtcbiAgICAgIGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElELFxuICAgICAgYWRkcjogcGFnZS5hZGRQZWVySW5wdXQudmFsdWVcbiAgICB9KVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLm1hbmFnZVBlZXJzRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5tYW5hZ2VQZWVyc0VycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnNwaW5VbnRpbFBlZXJzVXBkYXRlKClcbiAgICBwYWdlLmFkZFBlZXJJbnB1dC52YWx1ZSA9ICcnXG4gIH1cblxuICAvKlxuICAgKiBzcGluVW50aWxQZWVyc1VwZGF0ZSB3aWxsIHNob3cgdGhlIHNwaW5uZXIgb24gdGhlIG1hbmFnZSBwZWVycyBmb3JrLlxuICAgKiBJZiBpdCBpcyBzdGlsbCBzaG93aW5nIGFmdGVyIDEwIHNlY29uZHMsIHRoZSBwZWVycyB0YWJsZSB3aWxsIGJlIHVwZGF0ZWRcbiAgICogaW5zdGVhZCBvZiB3YWl0aW5nIGZvciBhIG5vdGlmaWNhdGlvbi5cbiAgICovXG4gIGFzeW5jIHNwaW5VbnRpbFBlZXJzVXBkYXRlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLnNob3cocGFnZS5wZWVyU3Bpbm5lcilcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmIChEb2MuaXNEaXNwbGF5ZWQocGFnZS5wZWVyU3Bpbm5lcikpIHtcbiAgICAgICAgdGhpcy51cGRhdGVXYWxsZXRQZWVyc1RhYmxlKClcbiAgICAgIH1cbiAgICB9LCAxMDAwMClcbiAgfVxuXG4gIC8qXG4gICAqIHNob3dUb2dnbGVXYWxsZXRTdGF0dXMgZGlzcGxheXMgdGhlIHRvZ2dsZVdhbGxldFN0YXR1c0NvbmZpcm0gZm9ybSB3aXRoXG4gICAqIHJlbGV2YW50IGhlbHAgbWVzc2FnZS5cbiAgICovXG4gIHNob3dUb2dnbGVXYWxsZXRTdGF0dXMgKGRpc2FibGU6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS50b2dnbGVXYWxsZXRTdGF0dXNFcnIsIHBhZ2Uud2FsbGV0U3RhdHVzRGlzYWJsZSwgcGFnZS5kaXNhYmxlV2FsbGV0TXNnLCBwYWdlLndhbGxldFN0YXR1c0VuYWJsZSwgcGFnZS5lbmFibGVXYWxsZXRNc2cpXG4gICAgaWYgKGRpc2FibGUpIERvYy5zaG93KHBhZ2Uud2FsbGV0U3RhdHVzRGlzYWJsZSwgcGFnZS5kaXNhYmxlV2FsbGV0TXNnKVxuICAgIGVsc2UgRG9jLnNob3cocGFnZS53YWxsZXRTdGF0dXNFbmFibGUsIHBhZ2UuZW5hYmxlV2FsbGV0TXNnKVxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS50b2dnbGVXYWxsZXRTdGF0dXNDb25maXJtKVxuICB9XG5cbiAgLypcbiAgICogdG9nZ2xlV2FsbGV0U3RhdHVzIHRvZ2dsZXMgYSB3YWxsZXRzIHN0YXR1cyB0byBlaXRoZXIgZGlzYWJsZWQgb3IgZW5hYmxlZC5cbiAgICovXG4gIGFzeW5jIHRvZ2dsZVdhbGxldFN0YXR1cyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzRXJyKVxuXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgY29uc3QgZGlzYWJsZSA9ICFhc3NldC53YWxsZXQuZGlzYWJsZWRcbiAgICBjb25zdCB1cmwgPSAnL2FwaS90b2dnbGV3YWxsZXRzdGF0dXMnXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgYXNzZXRJRDogdGhpcy5zZWxlY3RlZEFzc2V0SUQsXG4gICAgICBkaXNhYmxlOiBkaXNhYmxlXG4gICAgfVxuXG4gICAgY29uc3QgZm10UGFyYW1zID0geyBhc3NldE5hbWU6IGFzc2V0Lm5hbWUgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS50b2dnbGVXYWxsZXRTdGF0dXNDb25maXJtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHVybCwgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGlmIChyZXMuY29kZSA9PT0gRXJyb3JzLmFjdGl2ZU9yZGVyc0VycikgcGFnZS50b2dnbGVXYWxsZXRTdGF0dXNFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BQ1RJVkVfT1JERVJTX0VSUl9NU0csIGZtdFBhcmFtcylcbiAgICAgIGVsc2UgcGFnZS50b2dnbGVXYWxsZXRTdGF0dXNFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0VycilcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGxldCBzdWNjZXNzTXNnID0gaW50bC5wcmVwKGludGwuSURfV0FMTEVUX0RJU0FCTEVEX01TRywgZm10UGFyYW1zKVxuICAgIGlmICghZGlzYWJsZSkgc3VjY2Vzc01zZyA9IGludGwucHJlcChpbnRsLklEX1dBTExFVF9FTkFCTEVEX01TRywgZm10UGFyYW1zKVxuICAgIHRoaXMuYXNzZXRVcGRhdGVkKHRoaXMuc2VsZWN0ZWRBc3NldElELCBwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0NvbmZpcm0sIHN1Y2Nlc3NNc2cpXG4gIH1cblxuICAvKlxuICAgKiBzaG93Qm94IHNob3dzIHRoZSBib3ggd2l0aCBhIGZhZGUtaW4gYW5pbWF0aW9uLlxuICAgKi9cbiAgYXN5bmMgc2hvd0JveCAoYm94OiBIVE1MRWxlbWVudCwgZm9jdXNlcj86IFBhZ2VFbGVtZW50KSB7XG4gICAgYm94LnN0eWxlLm9wYWNpdHkgPSAnMCdcbiAgICBEb2Muc2hvdyhib3gpXG4gICAgaWYgKGZvY3VzZXIpIGZvY3VzZXIuZm9jdXMoKVxuICAgIGF3YWl0IERvYy5hbmltYXRlKGFuaW1hdGlvbkxlbmd0aCwgcHJvZ3Jlc3MgPT4ge1xuICAgICAgYm94LnN0eWxlLm9wYWNpdHkgPSBgJHtwcm9ncmVzc31gXG4gICAgfSwgJ2Vhc2VPdXQnKVxuICAgIGJveC5zdHlsZS5vcGFjaXR5ID0gJzEnXG4gICAgdGhpcy5kaXNwbGF5ZWQgPSBib3hcbiAgfVxuXG4gIC8qIHNob3dGb3JtIHNob3dzIGEgbW9kYWwgZm9ybSB3aXRoIGEgbGl0dGxlIGFuaW1hdGlvbi4gKi9cbiAgYXN5bmMgc2hvd0Zvcm0gKGZvcm06IFBhZ2VFbGVtZW50KSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHRoaXMuY3VycmVudEZvcm0gPSBmb3JtXG4gICAgdGhpcy5mb3Jtcy5mb3JFYWNoKGZvcm0gPT4gRG9jLmhpZGUoZm9ybSkpXG4gICAgZm9ybS5zdHlsZS5yaWdodCA9ICcxMDAwMHB4J1xuICAgIERvYy5zaG93KHBhZ2UuZm9ybXMsIGZvcm0pXG4gICAgY29uc3Qgc2hpZnQgPSAocGFnZS5mb3Jtcy5vZmZzZXRXaWR0aCArIGZvcm0ub2Zmc2V0V2lkdGgpIC8gMlxuICAgIGF3YWl0IERvYy5hbmltYXRlKGFuaW1hdGlvbkxlbmd0aCwgcHJvZ3Jlc3MgPT4ge1xuICAgICAgZm9ybS5zdHlsZS5yaWdodCA9IGAkeygxIC0gcHJvZ3Jlc3MpICogc2hpZnR9cHhgXG4gICAgfSwgJ2Vhc2VPdXRIYXJkJylcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzAnXG4gIH1cblxuICBhc3luYyBzaG93U3VjY2VzcyAobXNnOiBzdHJpbmcpIHtcbiAgICB0aGlzLmZvcm1zLmZvckVhY2goZm9ybSA9PiBEb2MuaGlkZShmb3JtKSlcbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gdGhpcy5wYWdlLmNoZWNrbWFya0Zvcm1cbiAgICB0aGlzLmFuaW1hdGlvbiA9IHNob3dTdWNjZXNzKHRoaXMucGFnZSwgbXNnKVxuICAgIGF3YWl0IHRoaXMuYW5pbWF0aW9uLndhaXQoKVxuICAgIHRoaXMuYW5pbWF0aW9uID0gbmV3IEFuaW1hdGlvbigxNTAwLCAoKSA9PiB7IC8qIHBhc3MgKi8gfSwgJycsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRGb3JtID09PSB0aGlzLnBhZ2UuY2hlY2ttYXJrRm9ybSkgdGhpcy5jbG9zZVBvcHVwcygpXG4gICAgfSlcbiAgfVxuXG4gIC8qIFNob3cgdGhlIG5ldyB3YWxsZXQgZm9ybS4gKi9cbiAgYXN5bmMgc2hvd05ld1dhbGxldCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGJveCA9IHBhZ2UubmV3V2FsbGV0Rm9ybVxuICAgIHRoaXMubmV3V2FsbGV0Rm9ybS5zZXRBc3NldChhc3NldElEKVxuICAgIGNvbnN0IGRlZmF1bHRzTG9hZGVkID0gdGhpcy5uZXdXYWxsZXRGb3JtLmxvYWREZWZhdWx0cygpXG4gICAgYXdhaXQgdGhpcy5zaG93Rm9ybShib3gpXG4gICAgYXdhaXQgZGVmYXVsdHNMb2FkZWRcbiAgfVxuXG4gIC8vIHNvcnRBc3NldEJ1dHRvbnMgZGlzcGxheXMgc3VwcG9ydGVkIGFzc2V0cywgc29ydGVkLiBSZXR1cm5zIGZpcnN0IGFzc2V0IGluIHRoZVxuICAvLyBsaXN0LlxuICBzb3J0QXNzZXRCdXR0b25zICgpOiBTdXBwb3J0ZWRBc3NldCB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHRoaXMuYXNzZXRCdXR0b25zID0ge31cbiAgICBEb2MuZW1wdHkocGFnZS5hc3NldFNlbGVjdClcbiAgICBjb25zdCBzb3J0ZWRBc3NldHMgPSBbLi4uT2JqZWN0LnZhbHVlcyhhcHAoKS5hc3NldHMpXVxuICAgIHNvcnRlZEFzc2V0cy5zb3J0KChhOiBTdXBwb3J0ZWRBc3NldCwgYjogU3VwcG9ydGVkQXNzZXQpID0+IHtcbiAgICAgIGlmIChhLndhbGxldCAmJiAhYi53YWxsZXQpIHJldHVybiAtMVxuICAgICAgaWYgKCFhLndhbGxldCAmJiBiLndhbGxldCkgcmV0dXJuIDFcbiAgICAgIGlmICghYS53YWxsZXQgJiYgIWIud2FsbGV0KSByZXR1cm4gYS5zeW1ib2wgPT09ICdkY3InID8gLTEgOiAxXG4gICAgICBjb25zdCBbYUJhbCwgYkJhbF0gPSBbYS53YWxsZXQuYmFsYW5jZSwgYi53YWxsZXQuYmFsYW5jZV1cbiAgICAgIGNvbnN0IFthVG90YWwsIGJUb3RhbF0gPSBbYUJhbC5hdmFpbGFibGUgKyBhQmFsLmltbWF0dXJlICsgYUJhbC5sb2NrZWQsIGJCYWwuYXZhaWxhYmxlICsgYkJhbC5pbW1hdHVyZSArIGJCYWwubG9ja2VkXVxuICAgICAgaWYgKGFUb3RhbCA9PT0gMCAmJiBiVG90YWwgPT09IDApIHJldHVybiBhLnN5bWJvbC5sb2NhbGVDb21wYXJlKGIuc3ltYm9sKVxuICAgICAgZWxzZSBpZiAoYVRvdGFsID09PSAwKSByZXR1cm4gMVxuICAgICAgZWxzZSBpZiAoYVRvdGFsID09PSAwKSByZXR1cm4gLTFcbiAgICAgIGNvbnN0IFthRmlhdCwgYkZpYXRdID0gW2FwcCgpLmZpYXRSYXRlc01hcFthLmlkXSwgYXBwKCkuZmlhdFJhdGVzTWFwW2IuaWRdXVxuICAgICAgaWYgKGFGaWF0ICYmICFiRmlhdCkgcmV0dXJuIC0xXG4gICAgICBpZiAoIWFGaWF0ICYmIGJGaWF0KSByZXR1cm4gMVxuICAgICAgcmV0dXJuIGJGaWF0ICogYlRvdGFsIC0gYUZpYXQgKiBhVG90YWxcbiAgICB9KVxuICAgIGZvciAoY29uc3QgYSBvZiBzb3J0ZWRBc3NldHMpIHtcbiAgICAgIGNvbnN0IGJ0dG4gPSBwYWdlLmljb25TZWxlY3RUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgcGFnZS5hc3NldFNlbGVjdC5hcHBlbmRDaGlsZChidHRuKVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGJ0dG4pXG4gICAgICB0aGlzLmFzc2V0QnV0dG9uc1thLmlkXSA9IHsgdG1wbCwgYnR0biB9XG4gICAgICB0aGlzLnVwZGF0ZUFzc2V0QnV0dG9uKGEuaWQpXG4gICAgICBEb2MuYmluZChidHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRBc3NldChhLmlkKVxuICAgICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLnNlbGVjdGVkQXNzZXRMSywgU3RyaW5nKGEuaWQpKVxuICAgICAgfSlcbiAgICB9XG4gICAgcGFnZS5hc3NldFNlbGVjdC5jbGFzc0xpc3QucmVtb3ZlKCdpbnZpc2libGUnKVxuICAgIHJldHVybiBzb3J0ZWRBc3NldHNbMF1cbiAgfVxuXG4gIHVwZGF0ZUFzc2V0QnV0dG9uIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBhID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgeyBidHRuLCB0bXBsIH0gPSB0aGlzLmFzc2V0QnV0dG9uc1thc3NldElEXVxuICAgIERvYy5oaWRlKHRtcGwuZmlhdEJveCwgdG1wbC5ub1dhbGxldClcbiAgICBidHRuLmNsYXNzTGlzdC5hZGQoJ25vd2FsbGV0JylcbiAgICB0bXBsLmltZy5zcmMgfHw9IERvYy5sb2dvUGF0aChhLnN5bWJvbCkgLy8gZG9uJ3QgaW5pdGlhdGUgR0VUIGlmIGFscmVhZHkgc2V0IChlLmcuIHVwZGF0ZSBvbiBzb21lIG5vdGlmaWNhdGlvbilcbiAgICBjb25zdCBzeW1ib2xQYXJ0cyA9IGEuc3ltYm9sLnNwbGl0KCcuJylcbiAgICBpZiAoc3ltYm9sUGFydHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBjb25zdCBwYXJlbnRTeW1ib2wgPSBzeW1ib2xQYXJ0c1sxXVxuICAgICAgdG1wbC5wYXJlbnRJbWcuY2xhc3NMaXN0LnJlbW92ZSgnZC1oaWRlJylcbiAgICAgIHRtcGwucGFyZW50SW1nLnNyYyB8fD0gRG9jLmxvZ29QYXRoKHBhcmVudFN5bWJvbClcbiAgICB9XG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRBc3NldElEID09PSBhc3NldElEKSBidHRuLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBhLm5hbWVcbiAgICBpZiAoYS53YWxsZXQpIHtcbiAgICAgIGJ0dG4uY2xhc3NMaXN0LnJlbW92ZSgnbm93YWxsZXQnKVxuICAgICAgY29uc3QgeyB3YWxsZXQ6IHsgYmFsYW5jZTogYiB9LCB1bml0SW5mbzogdWkgfSA9IGFcbiAgICAgIGNvbnN0IHRvdGFsQmFsYW5jZSA9IGIuYXZhaWxhYmxlICsgYi5sb2NrZWQgKyBiLmltbWF0dXJlXG4gICAgICBjb25zdCBbcywgdW5pdF0gPSBEb2MuZm9ybWF0QmVzdFVuaXRzRm91clNpZ0ZpZ3ModG90YWxCYWxhbmNlLCB1aSlcbiAgICAgIHRtcGwuYmFsYW5jZS50ZXh0Q29udGVudCA9IHNcbiAgICAgIHRtcGwudW5pdC50ZXh0Q29udGVudCA9IHVuaXRcbiAgICAgIERvYy5zaG93KHRtcGwuYmFsYW5jZUJveClcbiAgICAgIGNvbnN0IGZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2EuaWRdXG4gICAgICBpZiAoZmlhdFJhdGUpIHtcbiAgICAgICAgRG9jLnNob3codG1wbC5maWF0Qm94KVxuICAgICAgICB0bXBsLmZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModG90YWxCYWxhbmNlIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgKiBmaWF0UmF0ZSlcbiAgICAgIH1cbiAgICB9IGVsc2UgRG9jLnNob3codG1wbC5ub1dhbGxldClcbiAgfVxuXG4gIGFzeW5jIHNldFNlbGVjdGVkQXNzZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHsgYXNzZXRTZWxlY3QgfSA9IHRoaXMucGFnZVxuICAgIGZvciAoY29uc3QgYiBvZiBhc3NldFNlbGVjdC5jaGlsZHJlbikgYi5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgdGhpcy5hc3NldEJ1dHRvbnNbYXNzZXRJRF0uYnR0bi5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgdGhpcy5zZWxlY3RlZEFzc2V0SUQgPSBhc3NldElEXG4gICAgdGhpcy5wYWdlLmhpZGVNaXhUeHNDaGVja2JveC5jaGVja2VkID0gdHJ1ZVxuICAgIHRoaXMudXBkYXRlRGlzcGxheWVkQXNzZXQoYXNzZXRJRClcbiAgICB0aGlzLnNob3dBdmFpbGFibGVNYXJrZXRzKGFzc2V0SUQpXG4gICAgY29uc3QgYSA9IHRoaXMuc2hvd1JlY2VudEFjdGl2aXR5KGFzc2V0SUQpXG4gICAgY29uc3QgYiA9IHRoaXMuc2hvd1R4SGlzdG9yeShhc3NldElEKVxuICAgIGNvbnN0IGMgPSB0aGlzLnVwZGF0ZVRpY2tldEJ1eWVyKGFzc2V0SUQpXG4gICAgY29uc3QgZCA9IHRoaXMudXBkYXRlUHJpdmFjeShhc3NldElEKVxuICAgIGZvciAoY29uc3QgcCBvZiBbYSwgYiwgYywgZF0pIGF3YWl0IHBcbiAgfVxuXG4gIHVwZGF0ZURpc3BsYXllZEFzc2V0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBpZiAoYXNzZXRJRCAhPT0gdGhpcy5zZWxlY3RlZEFzc2V0SUQpIHJldHVyblxuICAgIGNvbnN0IHsgc3ltYm9sLCB3YWxsZXQsIG5hbWUsIHRva2VuLCB1bml0SW5mbyB9ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgeyBwYWdlLCBib2R5IH0gPSB0aGlzXG4gICAgRG9jLnNldFRleHQoYm9keSwgJ1tkYXRhLWFzc2V0LW5hbWVdJywgbmFtZSlcbiAgICBEb2Muc2V0VGV4dChib2R5LCAnW2RhdGEtdGlja2VyXScsIHVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0KVxuICAgIHBhZ2UuYXNzZXRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChzeW1ib2wpXG4gICAgRG9jLmhpZGUoXG4gICAgICBwYWdlLmJhbGFuY2VCb3gsIHBhZ2UuZmlhdEJhbGFuY2VCb3gsIHBhZ2UuY3JlYXRlV2FsbGV0LCBwYWdlLndhbGxldERldGFpbHMsXG4gICAgICBwYWdlLnNlbmRSZWNlaXZlLCBwYWdlLmNvbm5lY3RCdHRuQm94LCBwYWdlLnN0YXR1c0xvY2tlZCwgcGFnZS5zdGF0dXNSZWFkeSxcbiAgICAgIHBhZ2Uuc3RhdHVzT2ZmLCBwYWdlLnVubG9ja0J0dG5Cb3gsIHBhZ2UubG9ja0J0dG5Cb3gsIHBhZ2UuY29ubmVjdEJ0dG5Cb3gsXG4gICAgICBwYWdlLnBlZXJDb3VudEJveCwgcGFnZS5zeW5jUHJvZ3Jlc3NCb3gsIHBhZ2Uuc3RhdHVzRGlzYWJsZWQsIHBhZ2UudG9rZW5JbmZvQm94LFxuICAgICAgcGFnZS5uZWVkc1Byb3ZpZGVyQm94LCBwYWdlLmZlZVN0YXRlQm94LCBwYWdlLnR4U3luY0JveCwgcGFnZS50eFByb2dyZXNzLFxuICAgICAgcGFnZS50eEZpbmRpbmdBZGRyc1xuICAgIClcbiAgICB0aGlzLmNoZWNrTmVlZHNQcm92aWRlcihhc3NldElEKVxuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS5hc3NldHNbdG9rZW4ucGFyZW50SURdXG4gICAgICBwYWdlLnRva2VuUGFyZW50TG9nby5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50QXNzZXQuc3ltYm9sKVxuICAgICAgcGFnZS50b2tlblBhcmVudE5hbWUudGV4dENvbnRlbnQgPSBwYXJlbnRBc3NldC5uYW1lXG4gICAgICBwYWdlLmNvbnRyYWN0QWRkcmVzcy50ZXh0Q29udGVudCA9IHRva2VuLmNvbnRyYWN0QWRkcmVzc1xuICAgICAgRG9jLnNob3cocGFnZS50b2tlbkluZm9Cb3gpXG4gICAgfVxuICAgIGlmICh3YWxsZXQpIHtcbiAgICAgIHRoaXMudXBkYXRlRGlzcGxheWVkQXNzZXRCYWxhbmNlKClcbiAgICAgIGNvbnN0IHsgZmVlU3RhdGUsIHJ1bm5pbmcsIGRpc2FibGVkLCB0eXBlOiB3YWxsZXRUeXBlIH0gPSB3YWxsZXRcblxuICAgICAgY29uc3Qgd2FsbGV0RGVmID0gYXBwKCkud2FsbGV0RGVmaW5pdGlvbihhc3NldElELCB3YWxsZXRUeXBlKVxuICAgICAgcGFnZS53YWxsZXRUeXBlLnRleHRDb250ZW50ID0gd2FsbGV0RGVmLnRhYlxuICAgICAgaWYgKGZlZVN0YXRlKSB0aGlzLnVwZGF0ZUZlZVN0YXRlKGZlZVN0YXRlKVxuICAgICAgaWYgKGRpc2FibGVkKSBEb2Muc2hvdyhwYWdlLnN0YXR1c0Rpc2FibGVkKSAvLyB3YWxsZXQgaXMgZGlzYWJsZWRcbiAgICAgIGVsc2UgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTeW5jQW5kUGVlcnMod2FsbGV0LmFzc2V0SUQpXG4gICAgICB9IGVsc2UgRG9jLnNob3cocGFnZS5zdGF0dXNPZmYsIHBhZ2UuY29ubmVjdEJ0dG5Cb3gpIC8vIHdhbGxldCBub3QgcnVubmluZ1xuICAgIH0gZWxzZSBEb2Muc2hvdyhwYWdlLmNyZWF0ZVdhbGxldCkgLy8gbm8gd2FsbGV0XG5cbiAgICBwYWdlLndhbGxldERldGFpbHNCb3guY2xhc3NMaXN0LnJlbW92ZSgnaW52aXNpYmxlJylcbiAgfVxuXG4gIHVwZGF0ZVN5bmNBbmRQZWVycyAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzZWxlY3RlZEFzc2V0SUQgfSA9IHRoaXNcbiAgICBpZiAoYXNzZXRJRCAhPT0gc2VsZWN0ZWRBc3NldElEKSByZXR1cm5cbiAgICBjb25zdCB7IHBlZXJDb3VudCwgc3luY1Byb2dyZXNzLCBzeW5jU3RhdHVzLCBlbmNyeXB0ZWQsIG9wZW4sIHJ1bm5pbmcgfSA9IGFwcCgpLndhbGxldE1hcFthc3NldElEXVxuICAgIGlmICghcnVubmluZykgcmV0dXJuXG4gICAgRG9jLnNob3cocGFnZS5zZW5kUmVjZWl2ZSwgcGFnZS5wZWVyQ291bnRCb3gsIHBhZ2Uuc3luY1Byb2dyZXNzQm94KVxuICAgIHBhZ2UucGVlckNvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHBlZXJDb3VudClcbiAgICBwYWdlLnN5bmNQcm9ncmVzcy50ZXh0Q29udGVudCA9IGAkeyhzeW5jUHJvZ3Jlc3MgKiAxMDApLnRvRml4ZWQoMSl9JWBcbiAgICBpZiAob3Blbikge1xuICAgICAgRG9jLnNob3cocGFnZS5zdGF0dXNSZWFkeSlcbiAgICAgIGlmICghYXBwKCkuaGF2ZUFjdGl2ZU9yZGVycyhhc3NldElEKSAmJiBlbmNyeXB0ZWQpIERvYy5zaG93KHBhZ2UubG9ja0J0dG5Cb3gpXG4gICAgfSBlbHNlIERvYy5zaG93KHBhZ2Uuc3RhdHVzTG9ja2VkLCBwYWdlLnVubG9ja0J0dG5Cb3gpIC8vIHdhbGxldCBub3QgdW5sb2NrZWRcbiAgICBEb2Muc2V0VmlzKHN5bmNTdGF0dXMudHhzICE9PSB1bmRlZmluZWQsIHBhZ2UudHhTeW5jQm94KVxuICAgIGlmIChzeW5jU3RhdHVzLnR4cyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnR4UHJvZ3Jlc3MsIHBhZ2UudHhGaW5kaW5nQWRkcnMpXG4gICAgICBpZiAoc3luY1N0YXR1cy50eHMgPT09IDAgJiYgc3luY1N0YXR1cy5ibG9ja3MgPj0gc3luY1N0YXR1cy50YXJnZXRIZWlnaHQpIERvYy5zaG93KHBhZ2UudHhGaW5kaW5nQWRkcnMpXG4gICAgICBlbHNlIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS50eFByb2dyZXNzKVxuICAgICAgICBjb25zdCBwcm9nID0gc3luY1N0YXR1cy50eHMgLyBzeW5jU3RhdHVzLnRhcmdldEhlaWdodFxuICAgICAgICBwYWdlLnR4UHJvZ3Jlc3MudGV4dENvbnRlbnQgPSBgJHsocHJvZyAqIDEwMCkudG9GaXhlZCgxKX0lYFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZUZlZVN0YXRlIChmZWVTdGF0ZTogRmVlU3RhdGUpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHNlbGVjdGVkQXNzZXRJRDogYXNzZXRJRCB9ID0gdGhpc1xuICAgIERvYy5oaWRlKHBhZ2UuZmVlU3RhdGVCb3gpXG4gICAgY29uc3QgeyB1bml0SW5mbzogdWksIHRva2VuIH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICBjb25zdCBmaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXVxuICAgIGlmICghZmlhdFJhdGUpIHJldHVyblxuICAgIGNvbnN0IGZlZUFzc2V0SUQgPSB0b2tlbiA/IHRva2VuLnBhcmVudElEIDogYXNzZXRJRFxuICAgIGNvbnN0IGZlZUZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2ZlZUFzc2V0SURdXG4gICAgaWYgKHRva2VuICYmICFmZWVGaWF0UmF0ZSkgcmV0dXJuXG4gICAgRG9jLnNob3cocGFnZS5mZWVTdGF0ZUJveClcbiAgICBjb25zdCBmZWVVSSA9IHRva2VuID8gYXBwKCkuYXNzZXRzW3Rva2VuLnBhcmVudElEXS51bml0SW5mbyA6IHVpXG4gICAgRG9jLmZvcm1hdEJlc3RSYXRlRWxlbWVudChwYWdlLmZlZVN0YXRlTmV0UmF0ZSwgZmVlQXNzZXRJRCwgZmVlU3RhdGUucmF0ZSwgZmVlVUkpXG4gICAgRG9jLmZvcm1hdEJlc3RWYWx1ZUVsZW1lbnQocGFnZS5mZWVTdGF0ZVNlbmRGZWVzLCBmZWVBc3NldElELCBmZWVTdGF0ZS5zZW5kLCBmZWVVSSlcbiAgICBEb2MuZm9ybWF0QmVzdFZhbHVlRWxlbWVudChwYWdlLmZlZVN0YXRlU3dhcEZlZXMsIGZlZUFzc2V0SUQsIGZlZVN0YXRlLnN3YXAsIGZlZVVJKVxuICAgIERvYy5mb3JtYXRCZXN0VmFsdWVFbGVtZW50KHBhZ2UuZmVlU3RhdGVSZWRlZW1GZWVzLCBmZWVBc3NldElELCBmZWVTdGF0ZS5yZWRlZW0sIGZlZVVJKVxuICAgIHBhZ2UuZmVlU3RhdGVYY1JhdGUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZmlhdFJhdGUpXG4gICAgY29uc3Qgc2VuZEZpYXQgPSBmZWVTdGF0ZS5zZW5kIC8gZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgKiBmZWVGaWF0UmF0ZVxuICAgIHBhZ2UuZmVlU3RhdGVTZW5kRmlhdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhzZW5kRmlhdClcbiAgICBjb25zdCBzd2FwRmlhdCA9IGZlZVN0YXRlLnN3YXAgLyBmZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAqIGZlZUZpYXRSYXRlXG4gICAgcGFnZS5mZWVTdGF0ZVN3YXBGaWF0LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHN3YXBGaWF0KVxuICAgIGNvbnN0IHJlZGVlbUZpYXQgPSBmZWVTdGF0ZS5yZWRlZW0gLyBmZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAqIGZlZUZpYXRSYXRlXG4gICAgcGFnZS5mZWVTdGF0ZVJlZGVlbUZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocmVkZWVtRmlhdClcbiAgICBEb2Muc2hvdyhwYWdlLmZlZVN0YXRlQm94KVxuICB9XG5cbiAgYXN5bmMgY2hlY2tOZWVkc1Byb3ZpZGVyIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBuZWVkcyA9IGF3YWl0IGFwcCgpLm5lZWRzQ3VzdG9tUHJvdmlkZXIoYXNzZXRJRClcbiAgICBjb25zdCB7IHBhZ2U6IHsgbmVlZHNQcm92aWRlckJveDogYm94LCBuZWVkc1Byb3ZpZGVyQnR0bjogYnR0biB9IH0gPSB0aGlzXG4gICAgRG9jLnNldFZpcyhuZWVkcywgYm94KVxuICAgIGlmICghbmVlZHMpIHJldHVyblxuICAgIERvYy5ibGluayhidHRuKVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlVGlja2V0QnV5ZXIgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIHRoaXMudGlja2V0UGFnZSA9IHtcbiAgICAgIG51bWJlcjogMCxcbiAgICAgIGhpc3Rvcnk6IFtdLFxuICAgICAgc2Nhbm5lZDogZmFsc2VcbiAgICB9XG4gICAgY29uc3QgeyB3YWxsZXQsIHVuaXRJbmZvOiB1aSB9ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKFxuICAgICAgcGFnZS5zdGFraW5nQm94LCBwYWdlLnBpY2tWU1AsIHBhZ2Uuc3Rha2luZ1N1bW1hcnksIHBhZ2Uuc3Rha2luZ0VycixcbiAgICAgIHBhZ2UudnNwRGlzcGxheUJveCwgcGFnZS50aWNrZXRQcmljZUJveCwgcGFnZS5wdXJjaGFzZVRpY2tldHNCb3gsXG4gICAgICBwYWdlLnN0YWtpbmdScGNTcHZNc2csIHBhZ2UudGlja2V0c0Rpc2FibGVkXG4gICAgKVxuICAgIGlmICghd2FsbGV0Py5ydW5uaW5nIHx8ICh3YWxsZXQudHJhaXRzICYgdHJhaXRUaWNrZXRCdXllcikgPT09IDApIHJldHVyblxuICAgIERvYy5zaG93KHBhZ2Uuc3Rha2luZ0JveClcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2Uuc3Rha2luZ0JveClcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnNhZmVQb3N0KCcvYXBpL3N0YWtlc3RhdHVzJywgYXNzZXRJRClcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAvLyBMb29rIGZvciBjb21tb24gZXJyb3IgZm9yIFJQQyArIFNQViB3YWxsZXQuXG4gICAgICBpZiAocmVzLm1zZy5pbmNsdWRlcygnZGlzY29ubmVjdGVkIGZyb20gY29uc2Vuc3VzIFJQQycpKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2Uuc3Rha2luZ1JwY1Nwdk1zZylcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBEb2Muc2hvdyhwYWdlLnN0YWtpbmdFcnIpXG4gICAgICBwYWdlLnN0YWtpbmdFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLnNob3cocGFnZS5zdGFraW5nU3VtbWFyeSwgcGFnZS50aWNrZXRQcmljZUJveClcbiAgICBjb25zdCBzdGFrZVN0YXR1cyA9IHJlcy5zdGF0dXMgYXMgVGlja2V0U3Rha2luZ1N0YXR1c1xuICAgIHRoaXMuc3Rha2VTdGF0dXMgPSBzdGFrZVN0YXR1c1xuICAgIHBhZ2Uuc3Rha2luZ0FnZW5kYUNvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHN0YWtlU3RhdHVzLnN0YW5jZXMuYWdlbmRhcy5sZW5ndGgpXG4gICAgcGFnZS5zdGFraW5nVHNwZW5kQ291bnQudGV4dENvbnRlbnQgPSBTdHJpbmcoc3Rha2VTdGF0dXMuc3RhbmNlcy50c3BlbmRzLmxlbmd0aClcbiAgICBwYWdlLnB1cmNoYXNlckN1cnJlbnRQcmljZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhzdGFrZVN0YXR1cy50aWNrZXRQcmljZSAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgIHBhZ2UucHVyY2hhc2VyQmFsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZSh3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUsIHVpKVxuICAgIHRoaXMudXBkYXRlVGlja2V0U3RhdHMoc3Rha2VTdGF0dXMuc3RhdHMsIHVpLCBzdGFrZVN0YXR1cy50aWNrZXRQcmljZSwgc3Rha2VTdGF0dXMudm90aW5nU3Vic2lkeSlcbiAgICAvLyBJZiB0aGlzIGlzIGFuIGV4dGVuc2lvbiB3YWxsZXQsIHdlJ2xsIG1pZ2h0IHRvIGRpc2FibGUgYWxsIGNvbnRyb2xzLlxuICAgIGNvbnN0IGRpc2FibGVTdGFraW5nID0gYXBwKCkuZXh0ZW5zaW9uV2FsbGV0KHRoaXMuc2VsZWN0ZWRBc3NldElEKT8uZGlzYWJsZVN0YWtpbmdcbiAgICBpZiAoZGlzYWJsZVN0YWtpbmcpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc2V0Vm90ZXMsIHBhZ2Uuc2hvd1ZTUHMpXG4gICAgICBEb2Muc2hvdyhwYWdlLnRpY2tldHNEaXNhYmxlZClcbiAgICAgIHBhZ2UuZXh0ZW5zaW9uTW9kZUFwcE5hbWUudGV4dENvbnRlbnQgPSBhcHAoKS51c2VyLmV4dGVuc2lvbk1vZGVDb25maWcubmFtZVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5zZXRWU1BWaXooc3Rha2VTdGF0dXMudnNwKVxuICB9XG5cbiAgc2V0VlNQVml6ICh2c3A6IHN0cmluZykge1xuICAgIGNvbnN0IHsgcGFnZSwgc3Rha2VTdGF0dXMgfSA9IHRoaXNcbiAgICBEb2MuaGlkZShwYWdlLnZzcERpc3BsYXlCb3gpXG4gICAgaWYgKHZzcCkge1xuICAgICAgRG9jLnNob3cocGFnZS52c3BEaXNwbGF5Qm94LCBwYWdlLnB1cmNoYXNlVGlja2V0c0JveClcbiAgICAgIERvYy5oaWRlKHBhZ2UucGlja1ZTUClcbiAgICAgIHBhZ2UudnNwVVJMLnRleHRDb250ZW50ID0gdnNwXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLnNldFZpcyghc3Rha2VTdGF0dXMuaXNSUEMsIHBhZ2UucGlja1ZTUClcbiAgICBEb2Muc2V0VmlzKHN0YWtlU3RhdHVzLmlzUlBDLCBwYWdlLnB1cmNoYXNlVGlja2V0c0JveClcbiAgfVxuXG4gIHVwZGF0ZVRpY2tldFN0YXRzIChzdGF0czogVGlja2V0U3RhdHMsIHVpOiBVbml0SW5mbywgdGlja2V0UHJpY2U/OiBudW1iZXIsIHZvdGluZ1N1YnNpZHk/OiBudW1iZXIpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHN0YWtlU3RhdHVzIH0gPSB0aGlzXG4gICAgc3Rha2VTdGF0dXMuc3RhdHMgPSBzdGF0c1xuICAgIGlmICh0aWNrZXRQcmljZSkgc3Rha2VTdGF0dXMudGlja2V0UHJpY2UgPSB0aWNrZXRQcmljZVxuICAgIGlmICh2b3RpbmdTdWJzaWR5KSBzdGFrZVN0YXR1cy52b3RpbmdTdWJzaWR5ID0gdm90aW5nU3Vic2lkeVxuICAgIGNvbnN0IGxpdmVUaWNrZXRDb3VudCA9IHN0YWtlU3RhdHVzLnRpY2tldHMuZmlsdGVyKCh0a3Q6IFRpY2tldCkgPT4gdGt0LnN0YXR1cyA8PSB0aWNrZXRTdGF0dXNMaXZlICYmIHRrdC5zdGF0dXMgPj0gdGlja2V0U3RhdHVzVW5taW5lZCkubGVuZ3RoXG4gICAgcGFnZS5zdGFraW5nVGlja2V0Q291bnQudGV4dENvbnRlbnQgPSBTdHJpbmcobGl2ZVRpY2tldENvdW50KVxuICAgIHBhZ2UuaW1tYXR1cmVUaWNrZXRDb3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhzdGF0cy5tZW1wb29sKVxuICAgIERvYy5zZXRWaXMoc3RhdHMubWVtcG9vbCA+IDAsIHBhZ2UuaW1tYXR1cmVUaWNrZXRDb3VudEJveClcbiAgICBwYWdlLnF1ZXVlZFRpY2tldENvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHN0YXRzLnF1ZXVlZClcbiAgICBwYWdlLmZvcm1RdWV1ZWRUaXgudGV4dENvbnRlbnQgPSBTdHJpbmcoc3RhdHMucXVldWVkKVxuICAgIERvYy5zZXRWaXMoc3RhdHMucXVldWVkID4gMCwgcGFnZS5mb3JtUXVldWVUaXhCb3gsIHBhZ2UucXVldWVkVGlja2V0Q291bnRCb3gpXG4gICAgcGFnZS50b3RhbFRpY2tldENvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHN0YXRzLnRpY2tldENvdW50KVxuICAgIHBhZ2UudG90YWxUaWNrZXRSZXdhcmRzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHN0YXRzLnRvdGFsUmV3YXJkcyAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgIHBhZ2UudG90YWxUaWNrZXRWb3Rlcy50ZXh0Q29udGVudCA9IFN0cmluZyhzdGF0cy52b3RlcylcbiAgICBpZiAodGlja2V0UHJpY2UpIHBhZ2UudGlja2V0UHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModGlja2V0UHJpY2UgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICBpZiAodm90aW5nU3Vic2lkeSkgcGFnZS52b3RpbmdTdWJzaWR5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHZvdGluZ1N1YnNpZHkgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgfVxuXG4gIGFzeW5jIHNob3dWU1BQaWNrZXIgKCkge1xuICAgIGNvbnN0IGFzc2V0SUQgPSB0aGlzLnNlbGVjdGVkQXNzZXRJRFxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UudnNwUGlja2VyKVxuICAgIERvYy5lbXB0eShwYWdlLnZzcFBpY2tlckxpc3QpXG4gICAgRG9jLmhpZGUocGFnZS5zdGFraW5nRXJyKVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS52c3BQaWNrZXIpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS9saXN0dnNwcycsIGFzc2V0SUQpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3cocGFnZS5zdGFraW5nRXJyKVxuICAgICAgcGFnZS5zdGFraW5nRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IHZzcHMgPSByZXMudnNwcyBhcyBWb3RpbmdTZXJ2aWNlUHJvdmlkZXJbXVxuICAgIGZvciAoY29uc3QgdnNwIG9mIHZzcHMpIHtcbiAgICAgIGNvbnN0IHJvdyA9IHBhZ2UudnNwUm93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIHBhZ2UudnNwUGlja2VyTGlzdC5hcHBlbmRDaGlsZChyb3cpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgdG1wbC51cmwudGV4dENvbnRlbnQgPSB2c3AudXJsXG4gICAgICB0bXBsLmZlZVJhdGUudGV4dENvbnRlbnQgPSB2c3AuZmVlUGVyY2VudGFnZS50b0ZpeGVkKDIpXG4gICAgICB0bXBsLnZvdGluZy50ZXh0Q29udGVudCA9IFN0cmluZyh2c3Audm90aW5nKVxuICAgICAgRG9jLmJpbmQocm93LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIERvYy5oaWRlKHBhZ2Uuc3Rha2luZ0VycilcbiAgICAgICAgdGhpcy5zZXRWU1AoYXNzZXRJRCwgdnNwKVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBzaG93UHVyY2hhc2VUaWNrZXRzRGlhbG9nICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5wdXJjaGFzZXJJbnB1dC52YWx1ZSA9ICcnXG4gICAgRG9jLmhpZGUocGFnZS5wdXJjaGFzZXJFcnIpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UucHVyY2hhc2VUaWNrZXRzRm9ybSlcbiAgICBwYWdlLnB1cmNoYXNlcklucHV0LmZvY3VzKClcbiAgfVxuXG4gIHB1cmNoYXNlcklucHV0Q2hhbmdlZCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IG4gPSBwYXJzZUludChwYWdlLnB1cmNoYXNlcklucHV0LnZhbHVlIHx8ICcwJylcbiAgICBpZiAobiA8PSAxKSB7XG4gICAgICBwYWdlLnB1cmNoYXNlcklucHV0LnZhbHVlID0gJzEnXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgcGFnZS5wdXJjaGFzZXJJbnB1dC52YWx1ZSA9IFN0cmluZyhuKVxuICB9XG5cbiAgYXN5bmMgcHVyY2hhc2VUaWNrZXRzICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHNlbGVjdGVkQXNzZXRJRDogYXNzZXRJRCB9ID0gdGhpc1xuICAgIC8vIERSQUZUIE5PVEU6IFRoZSB1c2VyIHdpbGwgZ2V0IGFuIGFjdHVhbCB0aWNrZXQgY291bnQgc29tZXdoZXJlIGluIHRoZVxuICAgIC8vIHJhbmdlIDEgPD0gdGlja2V0c19wdXJjaGFzZWQgPD0gbi4gU2VlIG5vdGVzIGluXG4gICAgLy8gKCpzcHZXYWxsZXQpLlB1cmNoYXNlVGlja2V0cy5cbiAgICAvLyBIb3cgZG8gd2UgaGFuZGxlIHRoaXMgYXQgdGhlIFVJLiBPciBkbyB3ZSBoYW5kbGUgaXQgYWxsIGluIHRoZSBiYWNrZW5kXG4gICAgLy8gc29tZWhvdz9cbiAgICBjb25zdCBuID0gcGFyc2VJbnQocGFnZS5wdXJjaGFzZXJJbnB1dC52YWx1ZSB8fCAnMCcpXG4gICAgaWYgKG4gPCAxKSByZXR1cm5cbiAgICAvLyBUT0RPOiBBZGQgY29uZmlybWF0aW9uIGRpYWxvZy5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UucHVyY2hhc2VUaWNrZXRzRm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnNhZmVQb3N0KCcvYXBpL3B1cmNoYXNldGlja2V0cycsIHsgYXNzZXRJRCwgbiB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UucHVyY2hhc2VyRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5wdXJjaGFzZXJFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zaG93U3VjY2VzcyhpbnRsLnByZXAoaW50bC5JRF9USUNLRVRTX1BVUkNIQVNFRCwgeyBuOiBuLnRvTG9jYWxlU3RyaW5nKERvYy5sYW5ndWFnZXMoKSkgfSkpXG4gIH1cblxuICBwcm9jZXNzVGlja2V0UHVyY2hhc2VVcGRhdGUgKHdhbGxldE5vdGU6IEN1c3RvbVdhbGxldE5vdGUpIHtcbiAgICBjb25zdCB7IHN0YWtlU3RhdHVzLCBzZWxlY3RlZEFzc2V0SUQsIHBhZ2UgfSA9IHRoaXNcbiAgICBjb25zdCB7IGFzc2V0SUQgfSA9IHdhbGxldE5vdGVcbiAgICBjb25zdCB7IGVyciwgcmVtYWluaW5nLCB0aWNrZXRzLCBzdGF0cyB9ID0gd2FsbGV0Tm90ZS5wYXlsb2FkIGFzIFRpY2tldFB1cmNoYXNlVXBkYXRlXG4gICAgaWYgKGFzc2V0SUQgIT09IHNlbGVjdGVkQXNzZXRJRCkgcmV0dXJuXG4gICAgaWYgKGVycikge1xuICAgICAgRG9jLnNob3cocGFnZS5wdXJjaGFzZVRpY2tldHNFcnJCb3gpXG4gICAgICBwYWdlLnB1cmNoYXNlVGlja2V0c0Vyci50ZXh0Q29udGVudCA9IGVyclxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmICh0aWNrZXRzKSBzdGFrZVN0YXR1cy50aWNrZXRzID0gdGlja2V0cy5jb25jYXQoc3Rha2VTdGF0dXMudGlja2V0cylcbiAgICBpZiAoc3RhdHMpIHRoaXMudXBkYXRlVGlja2V0U3RhdHMoc3RhdHMsIGFwcCgpLmFzc2V0c1thc3NldElEXS51bml0SW5mbylcbiAgICBzdGFrZVN0YXR1cy5zdGF0cy5xdWV1ZWQgPSByZW1haW5pbmdcbiAgICBwYWdlLnF1ZXVlZFRpY2tldENvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHJlbWFpbmluZylcbiAgICBwYWdlLmZvcm1RdWV1ZWRUaXgudGV4dENvbnRlbnQgPSBTdHJpbmcocmVtYWluaW5nKVxuICAgIERvYy5zZXRWaXMocmVtYWluaW5nID4gMCwgcGFnZS5xdWV1ZWRUaWNrZXRDb3VudEJveClcbiAgfVxuXG4gIGFzeW5jIHNldFZTUCAoYXNzZXRJRDogbnVtYmVyLCB2c3A6IFZvdGluZ1NlcnZpY2VQcm92aWRlcikge1xuICAgIHRoaXMuY2xvc2VQb3B1cHMoKVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2Uuc3Rha2luZ0JveClcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnNhZmVQb3N0KCcvYXBpL3NldHZzcCcsIHsgYXNzZXRJRCwgdXJsOiB2c3AudXJsIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3cocGFnZS5zdGFraW5nRXJyKVxuICAgICAgcGFnZS5zdGFraW5nRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuc2V0VlNQVml6KHZzcC51cmwpXG4gIH1cblxuICBzZXRDdXN0b21WU1AgKCkge1xuICAgIGNvbnN0IGFzc2V0SUQgPSB0aGlzLnNlbGVjdGVkQXNzZXRJRFxuICAgIGNvbnN0IHZzcCA9IHsgdXJsOiB0aGlzLnBhZ2UuY3VzdG9tVnNwVXJsLnZhbHVlIH0gYXMgVm90aW5nU2VydmljZVByb3ZpZGVyXG4gICAgdGhpcy5zZXRWU1AoYXNzZXRJRCwgdnNwKVxuICB9XG5cbiAgcGFnZU9mVGlja2V0cyAocGdOdW06IG51bWJlcikge1xuICAgIGNvbnN0IHsgc3Rha2VTdGF0dXMsIHRpY2tldFBhZ2UgfSA9IHRoaXNcbiAgICBsZXQgc3RhcnRPZmZzZXQgPSBwZ051bSAqIHRpY2tldFBhZ2VTaXplXG4gICAgY29uc3QgcGFnZU9mVGlja2V0czogVGlja2V0W10gPSBbXVxuICAgIGlmIChzdGFydE9mZnNldCA8IHN0YWtlU3RhdHVzLnRpY2tldHMubGVuZ3RoKSB7XG4gICAgICBwYWdlT2ZUaWNrZXRzLnB1c2goLi4uc3Rha2VTdGF0dXMudGlja2V0cy5zbGljZShzdGFydE9mZnNldCwgc3RhcnRPZmZzZXQgKyB0aWNrZXRQYWdlU2l6ZSkpXG4gICAgICBpZiAocGFnZU9mVGlja2V0cy5sZW5ndGggPCB0aWNrZXRQYWdlU2l6ZSkge1xuICAgICAgICBjb25zdCBuZWVkID0gdGlja2V0UGFnZVNpemUgLSBwYWdlT2ZUaWNrZXRzLmxlbmd0aFxuICAgICAgICBwYWdlT2ZUaWNrZXRzLnB1c2goLi4udGlja2V0UGFnZS5oaXN0b3J5LnNsaWNlKDAsIG5lZWQpKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzdGFydE9mZnNldCAtPSBzdGFrZVN0YXR1cy50aWNrZXRzLmxlbmd0aFxuICAgICAgcGFnZU9mVGlja2V0cy5wdXNoKC4uLnRpY2tldFBhZ2UuaGlzdG9yeS5zbGljZShzdGFydE9mZnNldCwgc3RhcnRPZmZzZXQgKyB0aWNrZXRQYWdlU2l6ZSkpXG4gICAgfVxuICAgIHJldHVybiBwYWdlT2ZUaWNrZXRzXG4gIH1cblxuICBkaXNwbGF5VGlja2V0UGFnZSAocGFnZU51bWJlcjogbnVtYmVyLCBwYWdlT2ZUaWNrZXRzOiBUaWNrZXRbXSkge1xuICAgIGNvbnN0IHsgcGFnZSwgc2VsZWN0ZWRBc3NldElEOiBhc3NldElEIH0gPSB0aGlzXG4gICAgY29uc3QgdWkgPSBhcHAoKS51bml0SW5mbyhhc3NldElEKVxuICAgIGNvbnN0IGNvaW5MaW5rID0gQ29pbkV4cGxvcmVyc1thc3NldElEXVthcHAoKS51c2VyLm5ldF1cbiAgICBEb2MuZW1wdHkocGFnZS50aWNrZXRIaXN0b3J5Um93cylcbiAgICBwYWdlLnRpY2tldEhpc3RvcnlQYWdlLnRleHRDb250ZW50ID0gU3RyaW5nKHBhZ2VOdW1iZXIpXG4gICAgZm9yIChjb25zdCB7IHR4LCBzdGF0dXMgfSBvZiBwYWdlT2ZUaWNrZXRzKSB7XG4gICAgICBjb25zdCB0ciA9IHBhZ2UudGlja2V0SGlzdG9yeVJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLnRpY2tldEhpc3RvcnlSb3dzLmFwcGVuZENoaWxkKHRyKVxuICAgICAgYXBwKCkuYmluZFVybEhhbmRsZXJzKHRyKVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRyKVxuICAgICAgdG1wbC5hZ2UudGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKHR4LnN0YW1wICogMTAwMClcbiAgICAgIHRtcGwucHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbih0eC50aWNrZXRQcmljZSwgdWkpXG4gICAgICB0bXBsLnN0YXR1cy50ZXh0Q29udGVudCA9IGludGwucHJlcCh0aWNrZXRTdGF0dXNUcmFuc2xhdGlvbktleXNbc3RhdHVzXSlcbiAgICAgIHRtcGwuaGFzaFN0YXJ0LnRleHRDb250ZW50ID0gdHguaGFzaC5zbGljZSgwLCA2KVxuICAgICAgdG1wbC5oYXNoRW5kLnRleHRDb250ZW50ID0gdHguaGFzaC5zbGljZSgtNilcbiAgICAgIHRtcGwuZGV0YWlsc0xpbmtVcmwuc2V0QXR0cmlidXRlKCdocmVmJywgY29pbkxpbmsodHguaGFzaCkpXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdGlja2V0UGFnZU4gKHBhZ2VOdW1iZXI6IG51bWJlcikge1xuICAgIGNvbnN0IHsgcGFnZSwgc3Rha2VTdGF0dXMsIHRpY2tldFBhZ2UsIHNlbGVjdGVkQXNzZXRJRDogYXNzZXRJRCB9ID0gdGhpc1xuICAgIGNvbnN0IHBhZ2VPZlRpY2tldHMgPSB0aGlzLnBhZ2VPZlRpY2tldHMocGFnZU51bWJlcilcbiAgICBpZiAocGFnZU9mVGlja2V0cy5sZW5ndGggPCB0aWNrZXRQYWdlU2l6ZSAmJiAhdGlja2V0UGFnZS5zY2FubmVkKSB7XG4gICAgICBjb25zdCBuID0gdGlja2V0UGFnZVNpemUgLSBwYWdlT2ZUaWNrZXRzLmxlbmd0aFxuICAgICAgY29uc3QgbGFzdExpc3QgPSB0aWNrZXRQYWdlLmhpc3RvcnkubGVuZ3RoID4gMCA/IHRpY2tldFBhZ2UuaGlzdG9yeSA6IHN0YWtlU3RhdHVzLnRpY2tldHNcbiAgICAgIGNvbnN0IHNjYW5TdGFydCA9IGxhc3RMaXN0Lmxlbmd0aCA+IDAgPyBsYXN0TGlzdFtsYXN0TGlzdC5sZW5ndGggLSAxXS50eC5ibG9ja0hlaWdodCA6IHNjYW5TdGFydE1lbXBvb2xcbiAgICAgIGNvbnN0IHNraXBOID0gbGFzdExpc3QuZmlsdGVyKCh0a3Q6IFRpY2tldCkgPT4gdGt0LnR4LmJsb2NrSGVpZ2h0ID09PSBzY2FuU3RhcnQpLmxlbmd0aFxuICAgICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnRpY2tldEhpc3RvcnlGb3JtKVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS90aWNrZXRwYWdlJywgeyBhc3NldElELCBzY2FuU3RhcnQsIG4sIHNraXBOIH0pXG4gICAgICBsb2FkZWQoKVxuICAgICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignZXJyb3IgZmV0Y2hpbmcgdGlja2V0IHBhZ2UnLCByZXMubXNnKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHRoaXMudGlja2V0UGFnZS5oaXN0b3J5LnB1c2goLi4ucmVzLnRpY2tldHMpXG4gICAgICBwYWdlT2ZUaWNrZXRzLnB1c2goLi4ucmVzLnRpY2tldHMpXG4gICAgICBpZiAocmVzLnRpY2tldHMubGVuZ3RoIDwgbikgdGhpcy50aWNrZXRQYWdlLnNjYW5uZWQgPSB0cnVlXG4gICAgfVxuXG4gICAgY29uc3QgdG90YWxUaXggPSBzdGFrZVN0YXR1cy50aWNrZXRzLmxlbmd0aCArIHRpY2tldFBhZ2UuaGlzdG9yeS5sZW5ndGhcbiAgICBEb2Muc2V0VmlzKHRvdGFsVGl4ID49IHRpY2tldFBhZ2VTaXplLCBwYWdlLnRpY2tldEhpc3RvcnlQYWdpbmF0aW9uKVxuICAgIERvYy5zZXRWaXModG90YWxUaXggPiAwLCBwYWdlLnRpY2tldEhpc3RvcnlUYWJsZSlcbiAgICBEb2Muc2V0VmlzKHRvdGFsVGl4ID09PSAwLCBwYWdlLm5vVGlja2V0c01lc3NhZ2UpXG4gICAgaWYgKHBhZ2VPZlRpY2tldHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyBQcm9iYWJseSBlbmRlZCB3aXRoIGEgcGFnZSBvZiBzaXplIHRpY2tldFBhZ2VTaXplLCBzbyBkaWRuJ3Qga25vdyB3ZVxuICAgICAgLy8gaGFkIGhpdCB0aGUgZW5kIHVudGlsIHRoZSB1c2VyIGNsaWNrZWQgdGhlIGFycm93IGFuZCB3ZSB3ZW50IGxvb2tpbmdcbiAgICAgIC8vIGZvciB0aGUgbmV4dC4gV291bGQgYmUgZ29vZCB0byBmaWd1cmUgb3V0IGEgd2F5IHRvIGhpZGUgdGhlIGFycm93IGluXG4gICAgICAvLyB0aGF0IGNhc2UuXG4gICAgICBEb2MuaGlkZShwYWdlLnRpY2tldEhpc3RvcnlOZXh0UGFnZSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLmRpc3BsYXlUaWNrZXRQYWdlKHBhZ2VOdW1iZXIsIHBhZ2VPZlRpY2tldHMpXG4gICAgdGlja2V0UGFnZS5udW1iZXIgPSBwYWdlTnVtYmVyXG4gICAgY29uc3QgYXRFbmQgPSBwYWdlTnVtYmVyICogdGlja2V0UGFnZVNpemUgKyBwYWdlT2ZUaWNrZXRzLmxlbmd0aCA9PT0gdG90YWxUaXhcbiAgICBEb2Muc2V0VmlzKCFhdEVuZCB8fCAhdGlja2V0UGFnZS5zY2FubmVkLCBwYWdlLnRpY2tldEhpc3RvcnlOZXh0UGFnZSlcbiAgICBEb2Muc2V0VmlzKHBhZ2VOdW1iZXIgPiAwLCBwYWdlLnRpY2tldEhpc3RvcnlQcmV2UGFnZSlcbiAgfVxuXG4gIGFzeW5jIHNob3dUaWNrZXRIaXN0b3J5ICgpIHtcbiAgICB0aGlzLnNob3dGb3JtKHRoaXMucGFnZS50aWNrZXRIaXN0b3J5Rm9ybSlcbiAgICBhd2FpdCB0aGlzLnRpY2tldFBhZ2VOKHRoaXMudGlja2V0UGFnZS5udW1iZXIpXG4gIH1cblxuICBhc3luYyBuZXh0VGlja2V0UGFnZSAoKSB7XG4gICAgYXdhaXQgdGhpcy50aWNrZXRQYWdlTih0aGlzLnRpY2tldFBhZ2UubnVtYmVyICsgMSlcbiAgfVxuXG4gIGFzeW5jIHByZXZUaWNrZXRQYWdlICgpIHtcbiAgICBhd2FpdCB0aGlzLnRpY2tldFBhZ2VOKHRoaXMudGlja2V0UGFnZS5udW1iZXIgLSAxKVxuICB9XG5cbiAgc2hvd1NldFZvdGVzRGlhbG9nICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHN0YWtlU3RhdHVzLCBzZWxlY3RlZEFzc2V0SUQ6IGFzc2V0SUQgfSA9IHRoaXNcbiAgICBjb25zdCB1aSA9IGFwcCgpLnVuaXRJbmZvKGFzc2V0SUQpXG4gICAgRG9jLmhpZGUocGFnZS52b3RpbmdGb3JtRXJyKVxuICAgIGNvbnN0IGNvaW5MaW5rID0gQ29pbkV4cGxvcmVyc1thc3NldElEXVthcHAoKS51c2VyLm5ldF1cbiAgICBjb25zdCB1cHBlckNhc2UgPSAoczogc3RyaW5nKSA9PiBzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKVxuXG4gICAgY29uc3Qgc2V0Vm90ZXMgPSBhc3luYyAocmVxOiBhbnkpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uudm90aW5nRm9ybUVycilcbiAgICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS52b3RpbmdGb3JtKVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS9zZXR2b3RlcycsIHJlcSlcbiAgICAgIGxvYWRlZCgpXG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLnZvdGluZ0Zvcm1FcnIpXG4gICAgICAgIHBhZ2Uudm90aW5nRm9ybUVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgICAgdGhyb3cgRXJyb3IocmVzLm1zZylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZXRBZ2VuZGFDaG9pY2UgPSBhc3luYyAoYWdlbmRhSUQ6IHN0cmluZywgY2hvaWNlSUQ6IHN0cmluZykgPT4ge1xuICAgICAgYXdhaXQgc2V0Vm90ZXMoeyBhc3NldElELCBjaG9pY2VzOiB7IFthZ2VuZGFJRF06IGNob2ljZUlEIH0gfSlcbiAgICAgIGZvciAoY29uc3QgYWdlbmRhIG9mIHN0YWtlU3RhdHVzLnN0YW5jZXMuYWdlbmRhcykgaWYgKGFnZW5kYS5pZCA9PT0gYWdlbmRhSUQpIGFnZW5kYS5jdXJyZW50Q2hvaWNlID0gY2hvaWNlSURcbiAgICB9XG5cbiAgICBEb2MuZW1wdHkocGFnZS52b3RpbmdBZ2VuZGFzKVxuICAgIGZvciAoY29uc3QgYWdlbmRhIG9mIHN0YWtlU3RhdHVzLnN0YW5jZXMuYWdlbmRhcykge1xuICAgICAgY29uc3QgZGl2ID0gcGFnZS52b3RpbmdBZ2VuZGFUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgcGFnZS52b3RpbmdBZ2VuZGFzLmFwcGVuZENoaWxkKGRpdilcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgICB0bXBsLmRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gYWdlbmRhLmRlc2NyaXB0aW9uXG4gICAgICBmb3IgKGNvbnN0IGNob2ljZSBvZiBhZ2VuZGEuY2hvaWNlcykge1xuICAgICAgICBjb25zdCBkaXYgPSBwYWdlLnZvdGluZ0Nob2ljZVRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgIHRtcGwuY2hvaWNlcy5hcHBlbmRDaGlsZChkaXYpXG4gICAgICAgIGNvbnN0IGNob2ljZVRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgICAgIGNob2ljZVRtcGwuaWQudGV4dENvbnRlbnQgPSB1cHBlckNhc2UoY2hvaWNlLmlkKVxuICAgICAgICBjaG9pY2VUbXBsLmlkLmRhdGFzZXQudG9vbHRpcCA9IGNob2ljZS5kZXNjcmlwdGlvblxuICAgICAgICBjaG9pY2VUbXBsLnJhZGlvLnZhbHVlID0gY2hvaWNlLmlkXG4gICAgICAgIGNob2ljZVRtcGwucmFkaW8ubmFtZSA9IGFnZW5kYS5pZFxuICAgICAgICBEb2MuYmluZChjaG9pY2VUbXBsLnJhZGlvLCAnY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgIGlmICghY2hvaWNlVG1wbC5yYWRpby5jaGVja2VkKSByZXR1cm5cbiAgICAgICAgICBzZXRBZ2VuZGFDaG9pY2UoYWdlbmRhLmlkLCBjaG9pY2UuaWQpXG4gICAgICAgIH0pXG4gICAgICAgIGlmIChjaG9pY2UuaWQgPT09IGFnZW5kYS5jdXJyZW50Q2hvaWNlKSBjaG9pY2VUbXBsLnJhZGlvLmNoZWNrZWQgPSB0cnVlXG4gICAgICB9XG4gICAgICBhcHAoKS5iaW5kVG9vbHRpcHModG1wbC5jaG9pY2VzKVxuICAgIH1cblxuICAgIGNvbnN0IHNldFRzcGVuZFZvdGUgPSBhc3luYyAodHhIYXNoOiBzdHJpbmcsIHBvbGljeUlEOiBzdHJpbmcpID0+IHtcbiAgICAgIGF3YWl0IHNldFZvdGVzKHsgYXNzZXRJRCwgdFNwZW5kUG9saWN5OiB7IFt0eEhhc2hdOiBwb2xpY3lJRCB9IH0pXG4gICAgICBmb3IgKGNvbnN0IHRzcGVuZCBvZiBzdGFrZVN0YXR1cy5zdGFuY2VzLnRzcGVuZHMpIGlmICh0c3BlbmQuaGFzaCA9PT0gdHhIYXNoKSB0c3BlbmQuY3VycmVudFBvbGljeSA9IHBvbGljeUlEXG4gICAgfVxuXG4gICAgRG9jLmVtcHR5KHBhZ2Uudm90aW5nVHNwZW5kcylcbiAgICBmb3IgKGNvbnN0IHRzcGVuZCBvZiBzdGFrZVN0YXR1cy5zdGFuY2VzLnRzcGVuZHMpIHtcbiAgICAgIGNvbnN0IGRpdiA9IHBhZ2UudHNwZW5kVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIHBhZ2Uudm90aW5nVHNwZW5kcy5hcHBlbmRDaGlsZChkaXYpXG4gICAgICBhcHAoKS5iaW5kVXJsSGFuZGxlcnMoZGl2KVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICAgIGZvciAoY29uc3Qgb3B0IG9mIFt0bXBsLnllcywgdG1wbC5ub10pIHtcbiAgICAgICAgb3B0Lm5hbWUgPSB0c3BlbmQuaGFzaFxuICAgICAgICBpZiAodHNwZW5kLmN1cnJlbnRQb2xpY3kgPT09IG9wdC52YWx1ZSkgb3B0LmNoZWNrZWQgPSB0cnVlXG4gICAgICAgIERvYy5iaW5kKG9wdCwgJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICBpZiAoIW9wdC5jaGVja2VkKSByZXR1cm5cbiAgICAgICAgICBzZXRUc3BlbmRWb3RlKHRzcGVuZC5oYXNoLCBvcHQudmFsdWUgPz8gJycpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBpZiAodHNwZW5kLnZhbHVlID4gMCkgdG1wbC52YWx1ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyh0c3BlbmQudmFsdWUgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICAgIGVsc2UgRG9jLmhpZGUodG1wbC52YWx1ZSlcbiAgICAgIHRtcGwuaGFzaC50ZXh0Q29udGVudCA9IHRzcGVuZC5oYXNoXG4gICAgICB0bXBsLmV4cGxvcmVyTGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBjb2luTGluayh0c3BlbmQuaGFzaCkpXG4gICAgfVxuXG4gICAgY29uc3Qgc2V0VEtleVBvbGljeSA9IGFzeW5jIChrZXk6IHN0cmluZywgcG9saWN5OiBzdHJpbmcpID0+IHtcbiAgICAgIGF3YWl0IHNldFZvdGVzKHsgYXNzZXRJRCwgdHJlYXN1cnlQb2xpY3k6IHsgW2tleV06IHBvbGljeSB9IH0pXG4gICAgICBmb3IgKGNvbnN0IHRrZXkgb2Ygc3Rha2VTdGF0dXMuc3RhbmNlcy50cmVhc3VyeUtleXMpIGlmICh0a2V5LmtleSA9PT0ga2V5KSB0a2V5LnBvbGljeSA9IHBvbGljeVxuICAgIH1cblxuICAgIERvYy5lbXB0eShwYWdlLnZvdGluZ1RLZXlzKVxuICAgIGZvciAoY29uc3Qga2V5UG9saWN5IG9mIChzdGFrZVN0YXR1cy5zdGFuY2VzLnRyZWFzdXJ5S2V5cyA/PyBbXSkpIHtcbiAgICAgIGNvbnN0IGRpdiA9IHBhZ2UudGtleVRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLnZvdGluZ1RLZXlzLmFwcGVuZENoaWxkKGRpdilcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgICBmb3IgKGNvbnN0IG9wdCBvZiBbdG1wbC55ZXMsIHRtcGwubm9dKSB7XG4gICAgICAgIG9wdC5uYW1lID0ga2V5UG9saWN5LmtleVxuICAgICAgICBpZiAoa2V5UG9saWN5LnBvbGljeSA9PT0gb3B0LnZhbHVlKSBvcHQuY2hlY2tlZCA9IHRydWVcbiAgICAgICAgRG9jLmJpbmQob3B0LCAnY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgIGlmICghb3B0LmNoZWNrZWQpIHJldHVyblxuICAgICAgICAgIHNldFRLZXlQb2xpY3koa2V5UG9saWN5LmtleSwgb3B0LnZhbHVlID8/ICcnKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgdG1wbC5rZXkudGV4dENvbnRlbnQgPSBrZXlQb2xpY3kua2V5XG4gICAgfVxuXG4gICAgdGhpcy5zaG93Rm9ybShwYWdlLnZvdGluZ0Zvcm0pXG4gIH1cblxuICBhc3luYyB1cGRhdGVQcml2YWN5IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBkaXNhYmxlUHJpdmFjeSA9IGFwcCgpLmV4dGVuc2lvbldhbGxldChhc3NldElEKT8uZGlzYWJsZVByaXZhY3lcbiAgICB0aGlzLm1peGluZyA9IGZhbHNlXG4gICAgY29uc3QgeyB3YWxsZXQgfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLm1peGluZ0JveCwgcGFnZS5taXhlck9mZiwgcGFnZS5taXhlck9uKVxuICAgIC8vIFRPRE86IFNob3cgc3BlY2lhbCBtZXNzYWdpbmcgaWYgdGhlIGFzc2V0IHN1cHBvcnRzIG1peGluZyBidXQgbm90IHRoaXNcbiAgICAvLyB3YWxsZXQgdHlwZS5cbiAgICBpZiAoZGlzYWJsZVByaXZhY3kgfHwgIXdhbGxldD8ucnVubmluZyB8fCAod2FsbGV0LnRyYWl0cyAmIHRyYWl0RnVuZHNNaXhlcikgPT09IDApIHJldHVyblxuICAgIERvYy5zaG93KHBhZ2UubWl4aW5nQm94LCBwYWdlLm1peGVyTG9hZGluZylcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnNhZmVQb3N0KCcvYXBpL21peGluZ3N0YXRzJywgeyBhc3NldElEIH0pXG4gICAgRG9jLmhpZGUocGFnZS5taXhlckxvYWRpbmcpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UubWl4aW5nRXJyKVxuICAgICAgcGFnZS5taXhpbmdFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLm1peGluZyA9IHJlcy5zdGF0cy5lbmFibGVkIGFzIGJvb2xlYW5cbiAgICBpZiAodGhpcy5taXhpbmcpIERvYy5zaG93KHBhZ2UubWl4ZXJPbilcbiAgICBlbHNlIERvYy5zaG93KHBhZ2UubWl4ZXJPZmYpXG4gICAgdGhpcy5taXhlclRvZ2dsZS5zZXRTdGF0ZSh0aGlzLm1peGluZylcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZU1peGVyU3RhdGUgKG9uOiBib29sZWFuKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UubWl4aW5nRXJyKVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5taXhpbmdCb3gpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvY29uZmlndXJlbWl4ZXInLCB7IGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElELCBlbmFibGVkOiBvbiB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UubWl4aW5nRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQVBJX0VSUk9SLCB7IG1zZzogcmVzLm1zZyB9KVxuICAgICAgRG9jLnNob3cocGFnZS5taXhpbmdFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLnNldFZpcyhvbiwgcGFnZS5taXhlck9uKVxuICAgIERvYy5zZXRWaXMoIW9uLCBwYWdlLm1peGVyT2ZmKVxuICAgIHRoaXMubWl4ZXJUb2dnbGUuc2V0U3RhdGUob24pXG4gIH1cblxuICB1cGRhdGVEaXNwbGF5ZWRBc3NldEJhbGFuY2UgKCk6IHZvaWQge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1t0aGlzLnNlbGVjdGVkQXNzZXRJRF1cbiAgICBjb25zdCB7IHdhbGxldCwgdW5pdEluZm86IHVpLCBpZDogYXNzZXRJRCB9ID0gYXNzZXRcbiAgICBjb25zdCBiYWwgPSB3YWxsZXQuYmFsYW5jZVxuICAgIERvYy5zaG93KHBhZ2UuYmFsYW5jZUJveCwgcGFnZS53YWxsZXREZXRhaWxzKVxuICAgIGNvbnN0IHRvdGFsTG9ja2VkID0gYmFsLmxvY2tlZCArIGJhbC5jb250cmFjdGxvY2tlZCArIGJhbC5ib25kbG9ja2VkXG4gICAgY29uc3QgdG90YWxCYWxhbmNlID0gYmFsLmF2YWlsYWJsZSArIHRvdGFsTG9ja2VkICsgYmFsLmltbWF0dXJlXG4gICAgcGFnZS5iYWxhbmNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZSh0b3RhbEJhbGFuY2UsIHVpKVxuICAgIHBhZ2UuYmFsYW5jZVVuaXQudGV4dENvbnRlbnQgPSB1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIGNvbnN0IHJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICBpZiAocmF0ZSkge1xuICAgICAgRG9jLnNob3cocGFnZS5maWF0QmFsYW5jZUJveClcbiAgICAgIHBhZ2UuZmlhdEJhbGFuY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RmlhdENvbnZlcnNpb24odG90YWxCYWxhbmNlLCByYXRlLCB1aSlcbiAgICB9XG4gICAgRG9jLmVtcHR5KHBhZ2UuYmFsYW5jZURldGFpbEJveClcblxuICAgIGNvbnN0IGFkZEJhbGFuY2VSb3cgPSAoY2F0OiBzdHJpbmcsIGJhbDogbnVtYmVyLCB0b29sdGlwTXNnPzogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCByb3cgPSBwYWdlLmJhbGFuY2VEZXRhaWxSb3cuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLmJhbGFuY2VEZXRhaWxCb3guYXBwZW5kQ2hpbGQocm93KVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIHRtcGwubmFtZS50ZXh0Q29udGVudCA9IGNhdFxuICAgICAgaWYgKHRvb2x0aXBNc2cpIHtcbiAgICAgICAgdG1wbC50b29sdGlwTXNnLmRhdGFzZXQudG9vbHRpcCA9IHRvb2x0aXBNc2dcbiAgICAgICAgRG9jLnNob3codG1wbC50b29sdGlwTXNnKVxuICAgICAgfVxuICAgICAgdG1wbC5iYWxhbmNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShiYWwsIHVpKVxuICAgICAgcmV0dXJuIHJvd1xuICAgIH1cblxuICAgIGxldCBsYXN0U3ViTG9ja2VkUm93OiBQYWdlRWxlbWVudCB8IHVuZGVmaW5lZFxuICAgIGxldCBsYXN0UHJpbWFyeVJvdzogUGFnZUVsZW1lbnQgfCB1bmRlZmluZWRcbiAgICBjb25zdCBhZGRQcmltYXJ5QmFsYW5jZSA9IChjYXQ6IHN0cmluZywgYmFsOiBudW1iZXIsIHRvb2x0aXBNc2c/OiBzdHJpbmcpID0+IHtcbiAgICAgIGxhc3RTdWJMb2NrZWRSb3cgPSB1bmRlZmluZWRcbiAgICAgIGxhc3RQcmltYXJ5Um93ID0gYWRkQmFsYW5jZVJvdyhjYXQsIGJhbCwgdG9vbHRpcE1zZylcbiAgICB9XG4gICAgY29uc3QgYWRkU3ViQmFsYW5jZSA9IChjYXQ6IHN0cmluZywgYmFsOiBudW1iZXIsIHRvb2x0aXBNc2c/OiBzdHJpbmcpID0+IHtcbiAgICAgIGxhc3RTdWJMb2NrZWRSb3cgPSBhZGRCYWxhbmNlUm93KGNhdCwgYmFsLCB0b29sdGlwTXNnKVxuICAgICAgbGFzdFN1YkxvY2tlZFJvdy5jbGFzc0xpc3QuYWRkKCdzdWInKVxuICAgIH1cbiAgICBjb25zdCBzZXRSb3dDbGFzc2VzID0gKCkgPT4ge1xuICAgICAgaWYgKCFsYXN0U3ViTG9ja2VkUm93KSByZXR1cm5cbiAgICAgIChsYXN0UHJpbWFyeVJvdyBhcyBQYWdlRWxlbWVudCkuY2xhc3NMaXN0LmFkZCgnaXRlbWl6ZWQnKVxuICAgICAgbGFzdFN1YkxvY2tlZFJvdy5jbGFzc0xpc3QuYWRkKCdsYXN0JylcbiAgICB9XG5cbiAgICBhZGRQcmltYXJ5QmFsYW5jZShpbnRsLnByZXAoaW50bC5JRF9BVkFJTEFCTEVfVElUTEUpLCBiYWwuYXZhaWxhYmxlLCAnJylcbiAgICBpZiAoYmFsLm90aGVyPy5TaGllbGRlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCB0cmFuc3BhcmVudCA9IGJhbC5hdmFpbGFibGUgLSBiYWwub3RoZXIuU2hpZWxkZWQuYW10XG4gICAgICBhZGRTdWJCYWxhbmNlKGludGwucHJlcChpbnRsLklEX1RSQU5TUEFSRU5UKSwgdHJhbnNwYXJlbnQpXG4gICAgICBhZGRTdWJCYWxhbmNlKGludGwucHJlcChpbnRsLklEX1NISUVMREVEKSwgYmFsLm90aGVyLlNoaWVsZGVkLmFtdClcbiAgICB9XG4gICAgc2V0Um93Q2xhc3NlcygpXG5cbiAgICBhZGRQcmltYXJ5QmFsYW5jZShpbnRsLnByZXAoaW50bC5JRF9MT0NLRURfVElUTEUpLCB0b3RhbExvY2tlZCwgaW50bC5wcmVwKGludGwuSURfTE9DS0VEX0JBTF9NU0cpKVxuICAgIGlmIChiYWwub3JkZXJsb2NrZWQgPiAwKSBhZGRTdWJCYWxhbmNlKGludGwucHJlcChpbnRsLklEX09SREVSKSwgYmFsLm9yZGVybG9ja2VkLCBpbnRsLnByZXAoaW50bC5JRF9MT0NLRURfT1JERVJfQkFMX01TRykpXG4gICAgaWYgKGJhbC5jb250cmFjdGxvY2tlZCA+IDApIGFkZFN1YkJhbGFuY2UoaW50bC5wcmVwKGludGwuSURfU1dBUFBJTkcpLCBiYWwuY29udHJhY3Rsb2NrZWQsIGludGwucHJlcChpbnRsLklEX0xPQ0tFRF9TV0FQUElOR19CQUxfTVNHKSlcbiAgICBpZiAoYmFsLmJvbmRsb2NrZWQgPiAwKSBhZGRTdWJCYWxhbmNlKGludGwucHJlcChpbnRsLklEX0JPTkRFRCksIGJhbC5ib25kbG9ja2VkLCBpbnRsLnByZXAoaW50bC5JRF9MT0NLRURfQk9ORF9CQUxfTVNHKSlcbiAgICBpZiAoYmFsLmJvbmRSZXNlcnZlcyA+IDApIGFkZFN1YkJhbGFuY2UoaW50bC5wcmVwKGludGwuSURfQk9ORF9SRVNFUlZFUyksIGJhbC5ib25kUmVzZXJ2ZXMsIGludGwucHJlcChpbnRsLklEX0JPTkRfUkVTRVJWRVNfTVNHKSlcbiAgICBpZiAoYmFsPy5vdGhlcj8uU3Rha2VkICE9PSB1bmRlZmluZWQpIGFkZFN1YkJhbGFuY2UoJ1N0YWtlZCcsIGJhbC5vdGhlci5TdGFrZWQuYW10KVxuICAgIHNldFJvd0NsYXNzZXMoKVxuXG4gICAgaWYgKGJhbC5pbW1hdHVyZSkgYWRkUHJpbWFyeUJhbGFuY2UoaW50bC5wcmVwKGludGwuSURfSU1NQVRVUkVfVElUTEUpLCBiYWwuaW1tYXR1cmUsIGludGwucHJlcChpbnRsLklEX0lNTUFUVVJFX0JBTF9NU0cpKVxuICAgIGlmIChiYWw/Lm90aGVyPy5Vbm1peGVkICE9PSB1bmRlZmluZWQpIGFkZFN1YkJhbGFuY2UoJ1VubWl4ZWQnLCBiYWwub3RoZXIuVW5taXhlZC5hbXQpXG4gICAgc2V0Um93Q2xhc3NlcygpXG5cbiAgICAvLyBUT0RPOiBoYW5kbGUgcmVzZXJ2ZXMgZGVmaWNpdCB3aXRoIGEgbm90aWZpY2F0aW9uLlxuICAgIC8vIGlmIChiYWwucmVzZXJ2ZXNEZWZpY2l0ID4gMCkgYWRkUHJpbWFyeUJhbGFuY2UoaW50bC5wcmVwKGludGwuSURfUkVTRVJWRVNfREVGSUNJVCksIGJhbC5yZXNlcnZlc0RlZmljaXQsIGludGwucHJlcChpbnRsLklEX1JFU0VSVkVTX0RFRklDSVRfTVNHKSlcblxuICAgIHBhZ2UucHVyY2hhc2VyQmFsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGJhbC5hdmFpbGFibGUgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICBhcHAoKS5iaW5kVG9vbHRpcHMocGFnZS5iYWxhbmNlRGV0YWlsQm94KVxuICB9XG5cbiAgc2hvd0F2YWlsYWJsZU1hcmtldHMgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBleGNoYW5nZXMgPSBhcHAoKS51c2VyLmV4Y2hhbmdlc1xuICAgIGNvbnN0IG1hcmtldHM6IFtzdHJpbmcsIEV4Y2hhbmdlLCBNYXJrZXRdW10gPSBbXVxuICAgIGZvciAoY29uc3QgeGMgb2YgT2JqZWN0LnZhbHVlcyhleGNoYW5nZXMpKSB7XG4gICAgICBpZiAoIXhjLm1hcmtldHMpIGNvbnRpbnVlXG4gICAgICBmb3IgKGNvbnN0IG1rdCBvZiBPYmplY3QudmFsdWVzKHhjLm1hcmtldHMpKSB7XG4gICAgICAgIGlmIChta3QuYmFzZWlkID09PSBhc3NldElEIHx8IG1rdC5xdW90ZWlkID09PSBhc3NldElEKSBtYXJrZXRzLnB1c2goW3hjLmhvc3QsIHhjLCBta3RdKVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHNwb3RWb2x1bWUgPSAoYXNzZXRJRDogbnVtYmVyLCBta3Q6IE1hcmtldCk6IG51bWJlciA9PiB7XG4gICAgICBjb25zdCBzcG90ID0gbWt0LnNwb3RcbiAgICAgIGlmICghc3BvdCkgcmV0dXJuIDBcbiAgICAgIGNvbnN0IGNvbnZlcnNpb25GYWN0b3IgPSBhcHAoKS51bml0SW5mbyhhc3NldElEKS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgICAgY29uc3Qgdm9sdW1lID0gYXNzZXRJRCA9PT0gbWt0LmJhc2VpZCA/IHNwb3Qudm9sMjQgOiBzcG90LnZvbDI0ICogc3BvdC5yYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvclxuICAgICAgcmV0dXJuIHZvbHVtZSAvIGNvbnZlcnNpb25GYWN0b3JcbiAgICB9XG5cbiAgICBtYXJrZXRzLnNvcnQoKGE6IFtzdHJpbmcsIEV4Y2hhbmdlLCBNYXJrZXRdLCBiOiBbc3RyaW5nLCBFeGNoYW5nZSwgTWFya2V0XSk6IG51bWJlciA9PiB7XG4gICAgICBjb25zdCBbaG9zdEEsLCBta3RBXSA9IGFcbiAgICAgIGNvbnN0IFtob3N0QiwsIG1rdEJdID0gYlxuICAgICAgaWYgKCFta3RBLnNwb3QgJiYgIW1rdEIuc3BvdCkgcmV0dXJuIGhvc3RBLmxvY2FsZUNvbXBhcmUoaG9zdEIpXG4gICAgICByZXR1cm4gc3BvdFZvbHVtZShhc3NldElELCBta3RCKSAtIHNwb3RWb2x1bWUoYXNzZXRJRCwgbWt0QSlcbiAgICB9KVxuICAgIERvYy5lbXB0eShwYWdlLmF2YWlsYWJsZU1hcmtldHMpXG5cbiAgICBmb3IgKGNvbnN0IFtob3N0LCB4YywgbWt0XSBvZiBtYXJrZXRzKSB7XG4gICAgICBjb25zdCB7IHNwb3QsIGJhc2VpZCwgYmFzZXN5bWJvbCwgcXVvdGVpZCwgcXVvdGVzeW1ib2wgfSA9IG1rdFxuICAgICAgY29uc3Qgcm93ID0gcGFnZS5tYXJrZXRSb3cuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLmF2YWlsYWJsZU1hcmtldHMuYXBwZW5kQ2hpbGQocm93KVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIHRtcGwuaG9zdC50ZXh0Q29udGVudCA9IGhvc3RcbiAgICAgIHRtcGwuYmFzZUxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGJhc2VzeW1ib2wpXG4gICAgICB0bXBsLnF1b3RlTG9nby5zcmMgPSBEb2MubG9nb1BhdGgocXVvdGVzeW1ib2wpXG4gICAgICBEb2MuZW1wdHkodG1wbC5iYXNlU3ltYm9sLCB0bXBsLnF1b3RlU3ltYm9sKVxuICAgICAgdG1wbC5iYXNlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUoeGMuYXNzZXRzW2Jhc2VpZF0sIHRydWUpKVxuICAgICAgdG1wbC5xdW90ZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKHhjLmFzc2V0c1txdW90ZWlkXSwgdHJ1ZSkpXG5cbiAgICAgIGlmIChzcG90KSB7XG4gICAgICAgIGNvbnN0IGNvbnZSYXRlID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlaWQsIHF1b3RlaWQsIHNwb3QucmF0ZSwgZXhjaGFuZ2VzW2hvc3RdKVxuICAgICAgICB0bXBsLnByaWNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNvbnZSYXRlKVxuICAgICAgICBjb25zdCBmbXRTeW1ib2wgPSAoczogc3RyaW5nKSA9PiBzLnNwbGl0KCcuJylbMF0udG9VcHBlckNhc2UoKVxuICAgICAgICB0bXBsLnByaWNlUXVvdGVVbml0LnRleHRDb250ZW50ID0gZm10U3ltYm9sKHF1b3Rlc3ltYm9sKVxuICAgICAgICB0bXBsLnByaWNlQmFzZVVuaXQudGV4dENvbnRlbnQgPSBmbXRTeW1ib2woYmFzZXN5bWJvbClcbiAgICAgICAgdG1wbC52b2x1bWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moc3BvdFZvbHVtZShhc3NldElELCBta3QpKVxuICAgICAgICB0bXBsLnZvbHVtZVVuaXQudGV4dENvbnRlbnQgPSBhc3NldElEID09PSBiYXNlaWQgPyBmbXRTeW1ib2woYmFzZXN5bWJvbCkgOiBmbXRTeW1ib2wocXVvdGVzeW1ib2wpXG4gICAgICB9IGVsc2UgRG9jLmhpZGUodG1wbC5wcmljZUJveCwgdG1wbC52b2x1bWVCb3gpXG4gICAgICBEb2MuYmluZChyb3csICdjbGljaycsICgpID0+IGFwcCgpLmxvYWRQYWdlKCdtYXJrZXRzJywgeyBob3N0LCBiYXNlSUQ6IGJhc2VpZCwgcXVvdGVJRDogcXVvdGVpZCB9KSlcbiAgICB9XG4gICAgcGFnZS5tYXJrZXRzT3ZlcnZpZXdCb3guY2xhc3NMaXN0LnJlbW92ZSgnaW52aXNpYmxlJylcbiAgfVxuXG4gIGFzeW5jIHNob3dSZWNlbnRBY3Rpdml0eSAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5vcmRlckFjdGl2aXR5Qm94KVxuICAgIGNvbnN0IGZpbHRlcjogT3JkZXJGaWx0ZXIgPSB7XG4gICAgICBuOiAyMCxcbiAgICAgIGFzc2V0czogW2Fzc2V0SURdLFxuICAgICAgaG9zdHM6IFtdLFxuICAgICAgc3RhdHVzZXM6IFtdXG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL29yZGVycycsIGZpbHRlcilcbiAgICBsb2FkZWQoKVxuICAgIERvYy5oaWRlKHBhZ2Uubm9BY3Rpdml0eSwgcGFnZS5vcmRlckFjdGl2aXR5KVxuICAgIGlmICghcmVzLm9yZGVycyB8fCByZXMub3JkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgRG9jLnNob3cocGFnZS5ub0FjdGl2aXR5KVxuICAgICAgcGFnZS5vcmRlckFjdGl2aXR5Qm94LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmlzaWJsZScpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLnNob3cocGFnZS5vcmRlckFjdGl2aXR5KVxuICAgIERvYy5lbXB0eShwYWdlLnJlY2VudE9yZGVycylcbiAgICBmb3IgKGNvbnN0IG9yZCBvZiAocmVzLm9yZGVycyBhcyBPcmRlcltdKSkge1xuICAgICAgY29uc3Qgcm93ID0gcGFnZS5yZWNlbnRPcmRlclRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLnJlY2VudE9yZGVycy5hcHBlbmRDaGlsZChyb3cpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgbGV0IGZyb206IFN1cHBvcnRlZEFzc2V0LCB0bzogU3VwcG9ydGVkQXNzZXRcbiAgICAgIGNvbnN0IFtiYXNlVW5pdEluZm8sIHF1b3RlVW5pdEluZm9dID0gW2FwcCgpLnVuaXRJbmZvKG9yZC5iYXNlSUQpLCBhcHAoKS51bml0SW5mbyhvcmQucXVvdGVJRCldXG4gICAgICBpZiAob3JkLnNlbGwpIHtcbiAgICAgICAgW2Zyb20sIHRvXSA9IFthcHAoKS5hc3NldHNbb3JkLmJhc2VJRF0sIGFwcCgpLmFzc2V0c1tvcmQucXVvdGVJRF1dXG4gICAgICAgIHRtcGwuZnJvbVF0eS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgICBpZiAob3JkLnR5cGUgPT09IE9yZGVyVXRpbC5MaW1pdCkge1xuICAgICAgICAgIHRtcGwudG9RdHkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHkgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yICogb3JkLnJhdGUsIHF1b3RlVW5pdEluZm8pXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFtmcm9tLCB0b10gPSBbYXBwKCkuYXNzZXRzW29yZC5xdW90ZUlEXSwgYXBwKCkuYXNzZXRzW29yZC5iYXNlSURdXVxuICAgICAgICBpZiAob3JkLnR5cGUgPT09IE9yZGVyVXRpbC5NYXJrZXQpIHtcbiAgICAgICAgICB0bXBsLmZyb21RdHkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHksIGJhc2VVbml0SW5mbylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0bXBsLmZyb21RdHkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHkgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yICogb3JkLnJhdGUsIHF1b3RlVW5pdEluZm8pXG4gICAgICAgICAgdG1wbC50b1F0eS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRtcGwuZnJvbUxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGZyb20uc3ltYm9sKVxuICAgICAgRG9jLmVtcHR5KHRtcGwuZnJvbVN5bWJvbCwgdG1wbC50b1N5bWJvbClcbiAgICAgIHRtcGwuZnJvbVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKGZyb20sIHRydWUpKVxuICAgICAgdG1wbC50b0xvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHRvLnN5bWJvbClcbiAgICAgIHRtcGwudG9TeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZSh0bywgdHJ1ZSkpXG4gICAgICB0bXBsLnN0YXR1cy50ZXh0Q29udGVudCA9IE9yZGVyVXRpbC5zdGF0dXNTdHJpbmcob3JkKVxuICAgICAgdG1wbC5maWxsZWQudGV4dENvbnRlbnQgPSBgJHsoT3JkZXJVdGlsLmZpbGxlZChvcmQpIC8gb3JkLnF0eSAqIDEwMCkudG9GaXhlZCgxKX0lYFxuICAgICAgdG1wbC5hZ2UudGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKG9yZC5zdWJtaXRUaW1lKVxuICAgICAgdG1wbC5saW5rLmhyZWYgPSBgb3JkZXIvJHtvcmQuaWR9YFxuICAgICAgYXBwKCkuYmluZEludGVybmFsTmF2aWdhdGlvbihyb3cpXG4gICAgfVxuICAgIHBhZ2Uub3JkZXJBY3Rpdml0eUJveC5jbGFzc0xpc3QucmVtb3ZlKCdpbnZpc2libGUnKVxuICB9XG5cbiAgdXBkYXRlVHhIaXN0b3J5Um93IChyb3c6IFBhZ2VFbGVtZW50LCB0eDogV2FsbGV0VHJhbnNhY3Rpb24sIGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgbGV0IGFtdEFzc2V0SUQgPSBhc3NldElEXG4gICAgbGV0IGZlZXNBc3NldElEID0gYXNzZXRJRFxuICAgIGlmICh0eC50b2tlbklEKSB7XG4gICAgICBhbXRBc3NldElEID0gdHgudG9rZW5JRFxuICAgICAgaWYgKGFzc2V0SUQgIT09IHR4LnRva2VuSUQpIGZlZXNBc3NldElEID0gYXNzZXRJRFxuICAgICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICAgIGlmIChhc3NldC50b2tlbikgZmVlc0Fzc2V0SUQgPSBhc3NldC50b2tlbi5wYXJlbnRJRFxuICAgICAgICBlbHNlIGNvbnNvbGUuZXJyb3IoYHVuYWJsZSB0byBkZXRlcm1pbmUgZmVlIGFzc2V0IGZvciB0eCAke3R4LmlkfWApXG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGFtdEFzc2V0VUkgPSBhcHAoKS51bml0SW5mbyhhbXRBc3NldElEKVxuICAgIGNvbnN0IGZlZXNBc3NldFVJID0gYXBwKCkudW5pdEluZm8oZmVlc0Fzc2V0SUQpXG4gICAgdG1wbC5hZ2UudGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKHR4LnRpbWVzdGFtcCAqIDEwMDApXG4gICAgdG1wbC5hZ2UuZGF0YXNldC50aW1lc3RhbXAgPSBTdHJpbmcodHgudGltZXN0YW1wICogMTAwMClcbiAgICBEb2Muc2V0VmlzKHR4LnRpbWVzdGFtcCA9PT0gMCwgdG1wbC5wZW5kaW5nKVxuICAgIERvYy5zZXRWaXModHgudGltZXN0YW1wICE9PSAwLCB0bXBsLmFnZSlcbiAgICBpZiAodHgudGltZXN0YW1wID4gMCkgdG1wbC5hZ2UuZGF0YXNldC5zdGFtcCA9IFN0cmluZyh0eC50aW1lc3RhbXApXG4gICAgbGV0IHR4VHlwZSA9IHR4VHlwZVN0cmluZyh0eC50eXBlKVxuICAgIGlmICh0eC50b2tlbklEICYmIHR4LnRva2VuSUQgIT09IGFzc2V0SUQpIHtcbiAgICAgIGNvbnN0IHRva2VuQXNzZXQgPSBhcHAoKS5hc3NldHNbdHgudG9rZW5JRF1cbiAgICAgIGNvbnN0IHRva2VuU3ltYm9sID0gdG9rZW5Bc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgICAgdHhUeXBlID0gYCR7dG9rZW5TeW1ib2x9ICR7dHhUeXBlfWBcbiAgICB9XG4gICAgdG1wbC50eXBlLnRleHRDb250ZW50ID0gdHhUeXBlXG4gICAgdG1wbC5pZC50ZXh0Q29udGVudCA9IHRyaW1TdHJpbmdXaXRoRWxsaXBzaXModHguaWQsIDEyKVxuICAgIHRtcGwuaWQuc2V0QXR0cmlidXRlKCd0aXRsZScsIHR4LmlkKVxuICAgIHRtcGwuZmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUodHguZmVlcywgZmVlc0Fzc2V0VUkpXG4gICAgaWYgKG5vQW10VHhUeXBlcy5pbmNsdWRlcyh0eC50eXBlKSkge1xuICAgICAgdG1wbC5hbW91bnQudGV4dENvbnRlbnQgPSAnLSdcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgW3UsIGNdID0gdHhUeXBlU2lnbkFuZENsYXNzKHR4LnR5cGUpXG4gICAgICBjb25zdCBhbXQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHR4LmFtb3VudCwgYW10QXNzZXRVSSlcbiAgICAgIHRtcGwuYW1vdW50LnRleHRDb250ZW50ID0gYCR7dX0ke2FtdH1gXG4gICAgICBpZiAoYyAhPT0gJycpIHRtcGwuYW1vdW50LmNsYXNzTGlzdC5hZGQoYylcbiAgICB9XG4gIH1cblxuICB0eEhpc3RvcnlSb3cgKHR4OiBXYWxsZXRUcmFuc2FjdGlvbiwgYXNzZXRJRDogbnVtYmVyKSA6IFBhZ2VFbGVtZW50IHtcbiAgICBjb25zdCByb3cgPSB0aGlzLnBhZ2UudHhIaXN0b3J5Um93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICByb3cuZGF0YXNldC50eGlkID0gdHguaWRcbiAgICBEb2MuYmluZChyb3csICdjbGljaycsICgpID0+IHRoaXMuc2hvd1R4RGV0YWlsc1BvcHVwKHR4LmlkKSlcbiAgICB0aGlzLnVwZGF0ZVR4SGlzdG9yeVJvdyhyb3csIHR4LCBhc3NldElEKVxuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgdGhpcy5zdGFtcGVycy5wdXNoKHRtcGwuYWdlKVxuICAgIHJldHVybiByb3dcbiAgfVxuXG4gIHR4SGlzdG9yeURhdGVSb3cgKGRhdGU6IHN0cmluZykgOiBQYWdlRWxlbWVudCB7XG4gICAgY29uc3Qgcm93ID0gdGhpcy5wYWdlLnR4SGlzdG9yeURhdGVSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgdG1wbC5kYXRlLnRleHRDb250ZW50ID0gZGF0ZVxuICAgIHJldHVybiByb3dcbiAgfVxuXG4gIHNldFR4RGV0YWlsc1BvcHVwRWxlbWVudHMgKHR4OiBXYWxsZXRUcmFuc2FjdGlvbikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcblxuICAgIC8vIEJsb2NrIGV4cGxvcmVyXG4gICAgY29uc3QgYXNzZXRFeHBsb3JlciA9IENvaW5FeHBsb3JlcnNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgaWYgKGFzc2V0RXhwbG9yZXIgJiYgYXNzZXRFeHBsb3JlcltuZXRdKSB7XG4gICAgICBwYWdlLnR4Vmlld0Jsb2NrRXhwbG9yZXIuaHJlZiA9IGFzc2V0RXhwbG9yZXJbbmV0XSh0eC5pZClcbiAgICB9XG5cbiAgICAvLyBUeCB0eXBlXG4gICAgbGV0IHR4VHlwZSA9IHR4VHlwZVN0cmluZyh0eC50eXBlKVxuICAgIGlmICh0eC50b2tlbklEICYmIHR4LnRva2VuSUQgIT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSB7XG4gICAgICBjb25zdCB0b2tlblN5bWJvbCA9IGFwcCgpLmFzc2V0c1t0eC50b2tlbklEXS5zeW1ib2wuc3BsaXQoJy4nKVswXS50b1VwcGVyQ2FzZSgpXG4gICAgICB0eFR5cGUgPSBgJHt0b2tlblN5bWJvbH0gJHt0eFR5cGV9YFxuICAgIH1cbiAgICBwYWdlLnR4RGV0YWlsc1R5cGUudGV4dENvbnRlbnQgPSB0eFR5cGVcbiAgICBEb2Muc2V0VmlzKHR4LnR5cGUgPT09IHR4VHlwZVN3YXBPclNlbmQsIHBhZ2UudHhUeXBlVG9vbHRpcClcbiAgICBwYWdlLnR4VHlwZVRvb2x0aXAuZGF0YXNldC50b29sdGlwID0gaW50bC5wcmVwKGludGwuSURfU1dBUF9PUl9TRU5EX1RPT0xUSVApXG5cbiAgICAvLyBBbW91bnRcbiAgICBpZiAobm9BbXRUeFR5cGVzLmluY2x1ZGVzKHR4LnR5cGUpKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnR4RGV0YWlsc0FtdFNlY3Rpb24pXG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBhc3NldElEID0gdGhpcy5zZWxlY3RlZEFzc2V0SURcbiAgICAgIGlmICh0eC50b2tlbklEKSBhc3NldElEID0gdHgudG9rZW5JRFxuICAgICAgRG9jLnNob3cocGFnZS50eERldGFpbHNBbXRTZWN0aW9uKVxuICAgICAgY29uc3QgdWkgPSBhcHAoKS51bml0SW5mbyhhc3NldElEKVxuICAgICAgY29uc3QgYW10ID0gRG9jLmZvcm1hdENvaW5WYWx1ZSh0eC5hbW91bnQsIHVpKVxuICAgICAgY29uc3QgW3MsIGNdID0gdHhUeXBlU2lnbkFuZENsYXNzKHR4LnR5cGUpXG4gICAgICBwYWdlLnR4RGV0YWlsc0Ftb3VudC50ZXh0Q29udGVudCA9IGAke3N9JHthbXR9ICR7dWkuY29udmVudGlvbmFsLnVuaXR9YFxuICAgICAgaWYgKGMgIT09ICcnKSBwYWdlLnR4RGV0YWlsc0Ftb3VudC5jbGFzc0xpc3QuYWRkKGMpXG4gICAgfVxuXG4gICAgLy8gRmVlXG4gICAgbGV0IGZlZUFzc2V0ID0gdGhpcy5zZWxlY3RlZEFzc2V0SURcbiAgICBpZiAodHgudG9rZW5JRCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1t0eC50b2tlbklEXVxuICAgICAgaWYgKGFzc2V0LnRva2VuKSB7XG4gICAgICAgIGZlZUFzc2V0ID0gYXNzZXQudG9rZW4ucGFyZW50SURcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYHdhbGxldCB0cmFuc2FjdGlvbiAke3R4LmlkfSBpcyBzdXBwb3NlZCB0byBiZSBhIHRva2VuIHR4LCBidXQgYXNzZXQgJHt0eC50b2tlbklEfSBpcyBub3QgYSB0b2tlbmApXG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGZlZVVJID0gYXBwKCkudW5pdEluZm8oZmVlQXNzZXQpXG4gICAgY29uc3QgZmVlID0gRG9jLmZvcm1hdENvaW5WYWx1ZSh0eC5mZWVzLCBmZWVVSSlcbiAgICBwYWdlLnR4RGV0YWlsc0ZlZS50ZXh0Q29udGVudCA9IGAke2ZlZX0gJHtmZWVVSS5jb252ZW50aW9uYWwudW5pdH1gXG5cbiAgICAvLyBUaW1lIC8gYmxvY2sgbnVtYmVyXG4gICAgcGFnZS50eERldGFpbHNCbG9ja051bWJlci50ZXh0Q29udGVudCA9IGAke3R4LmJsb2NrTnVtYmVyfWBcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodHgudGltZXN0YW1wICogMTAwMClcbiAgICBjb25zdCBkYXRlU3RyID0gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKVxuICAgIGNvbnN0IHRpbWVTdHIgPSBkYXRlLnRvTG9jYWxlVGltZVN0cmluZygpXG4gICAgcGFnZS50eERldGFpbHNUaW1lc3RhbXAudGV4dENvbnRlbnQgPSBgJHtkYXRlU3RyfSAke3RpbWVTdHJ9YFxuICAgIERvYy5zZXRWaXModHguYmxvY2tOdW1iZXIgPT09IDAsIHBhZ2UudGltZXN0YW1wUGVuZGluZywgcGFnZS5ibG9ja051bWJlclBlbmRpbmcpXG4gICAgRG9jLnNldFZpcyh0eC5ibG9ja051bWJlciAhPT0gMCwgcGFnZS50eERldGFpbHNCbG9ja051bWJlciwgcGFnZS50eERldGFpbHNUaW1lc3RhbXApXG5cbiAgICAvLyBUeCBJRFxuICAgIHBhZ2UudHhEZXRhaWxzSUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKHR4LmlkLCAyMClcbiAgICBwYWdlLnR4RGV0YWlsc0lELnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0eC5pZClcblxuICAgIC8vIFJlY2lwaWVudFxuICAgIGlmICh0eC5yZWNpcGllbnQpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudHhEZXRhaWxzUmVjaXBpZW50U2VjdGlvbilcbiAgICAgIHBhZ2UudHhEZXRhaWxzUmVjaXBpZW50LnRleHRDb250ZW50ID0gdHJpbVN0cmluZ1dpdGhFbGxpcHNpcyh0eC5yZWNpcGllbnQsIDIwKVxuICAgICAgcGFnZS50eERldGFpbHNSZWNpcGllbnQuc2V0QXR0cmlidXRlKCd0aXRsZScsIHR4LnJlY2lwaWVudClcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS50eERldGFpbHNSZWNpcGllbnRTZWN0aW9uKVxuICAgIH1cblxuICAgIC8vIEJvbmQgSW5mb1xuICAgIGlmICh0eC5ib25kSW5mbykge1xuICAgICAgRG9jLnNob3cocGFnZS50eERldGFpbHNCb25kSURTZWN0aW9uLCBwYWdlLnR4RGV0YWlsc0JvbmRMb2NrdGltZVNlY3Rpb24pXG4gICAgICBEb2Muc2V0VmlzKHR4LmJvbmRJbmZvLmFjY291bnRJRCAhPT0gJycsIHBhZ2UudHhEZXRhaWxzQm9uZEFjY291bnRJRFNlY3Rpb24pXG4gICAgICBwYWdlLnR4RGV0YWlsc0JvbmRJRC50ZXh0Q29udGVudCA9IHRyaW1TdHJpbmdXaXRoRWxsaXBzaXModHguYm9uZEluZm8uYm9uZElELCAyMClcbiAgICAgIHBhZ2UudHhEZXRhaWxzQm9uZElELnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0eC5ib25kSW5mby5ib25kSUQpXG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodHguYm9uZEluZm8ubG9ja1RpbWUgKiAxMDAwKVxuICAgICAgY29uc3QgZGF0ZVN0ciA9IGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKClcbiAgICAgIGNvbnN0IHRpbWVTdHIgPSBkYXRlLnRvTG9jYWxlVGltZVN0cmluZygpXG4gICAgICBwYWdlLnR4RGV0YWlsc0JvbmRMb2NrdGltZS50ZXh0Q29udGVudCA9IGAke2RhdGVTdHJ9ICR7dGltZVN0cn1gXG4gICAgICBwYWdlLnR4RGV0YWlsc0JvbmRBY2NvdW50SUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKHR4LmJvbmRJbmZvLmFjY291bnRJRCwgMjApXG4gICAgICBwYWdlLnR4RGV0YWlsc0JvbmRBY2NvdW50SUQuc2V0QXR0cmlidXRlKCd0aXRsZScsIHR4LmJvbmRJbmZvLmFjY291bnRJRClcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS50eERldGFpbHNCb25kSURTZWN0aW9uLCBwYWdlLnR4RGV0YWlsc0JvbmRMb2NrdGltZVNlY3Rpb24sIHBhZ2UudHhEZXRhaWxzQm9uZEFjY291bnRJRFNlY3Rpb24pXG4gICAgfVxuXG4gICAgLy8gTm9uY2VcbiAgICBpZiAodHguYWRkaXRpb25hbERhdGEgJiYgdHguYWRkaXRpb25hbERhdGEuTm9uY2UpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudHhEZXRhaWxzTm9uY2VTZWN0aW9uKVxuICAgICAgcGFnZS50eERldGFpbHNOb25jZS50ZXh0Q29udGVudCA9IGAke3R4LmFkZGl0aW9uYWxEYXRhLk5vbmNlfWBcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS50eERldGFpbHNOb25jZVNlY3Rpb24pXG4gICAgfVxuICB9XG5cbiAgc2hvd1R4RGV0YWlsc1BvcHVwIChpZDogc3RyaW5nKSB7XG4gICAgY29uc3QgdHggPSBhcHAoKS5nZXRXYWxsZXRUeCh0aGlzLnNlbGVjdGVkQXNzZXRJRCwgaWQpXG4gICAgaWYgKCF0eCkge1xuICAgICAgY29uc29sZS5lcnJvcihgd2FsbGV0IHRyYW5zYWN0aW9uICR7aWR9IG5vdCBmb3VuZGApXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5jdXJyVHggPSB0eFxuICAgIHRoaXMuc2V0VHhEZXRhaWxzUG9wdXBFbGVtZW50cyh0eClcbiAgICB0aGlzLnNob3dGb3JtKHRoaXMucGFnZS50eERldGFpbHMpXG4gIH1cblxuICB0eEhpc3RvcnlUYWJsZU5ld2VzdERhdGUgKCkgOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmNoaWxkcmVuLmxlbmd0aCA+PSAxKSB7XG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5jaGlsZHJlblswXSBhcyBQYWdlRWxlbWVudClcbiAgICAgIHJldHVybiB0bXBsLmRhdGUudGV4dENvbnRlbnQgfHwgJydcbiAgICB9XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICB0eERhdGUgKHR4OiBXYWxsZXRUcmFuc2FjdGlvbikgOiBzdHJpbmcge1xuICAgIGlmICh0eC50aW1lc3RhbXAgPT09IDApIHtcbiAgICAgIHJldHVybiAobmV3IERhdGUoKSkudG9Mb2NhbGVEYXRlU3RyaW5nKClcbiAgICB9XG4gICAgcmV0dXJuIChuZXcgRGF0ZSh0eC50aW1lc3RhbXAgKiAxMDAwKSkudG9Mb2NhbGVEYXRlU3RyaW5nKClcbiAgfVxuXG4gIGhhbmRsZVR4Tm90ZSAodHg6IFdhbGxldFRyYW5zYWN0aW9uLCBuZXdUeDogYm9vbGVhbikge1xuICAgIGNvbnN0IHcgPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdLndhbGxldFxuICAgIGNvbnN0IGhpZGVNaXhpbmcgPSAody50cmFpdHMgJiB0cmFpdEZ1bmRzTWl4ZXIpICE9PSAwICYmICEhdGhpcy5wYWdlLmhpZGVNaXhUeHMuY2hlY2tlZFxuICAgIGlmIChoaWRlTWl4aW5nICYmIHR4LnR5cGUgPT09IHR4VHlwZU1peGluZykgcmV0dXJuXG4gICAgaWYgKG5ld1R4KSB7XG4gICAgICBpZiAoIXRoaXMub2xkZXN0VHgpIHtcbiAgICAgICAgRG9jLnNob3codGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlKVxuICAgICAgICBEb2MuaGlkZSh0aGlzLnBhZ2Uubm9UeEhpc3RvcnkpXG4gICAgICAgIHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuYXBwZW5kQ2hpbGQodGhpcy50eEhpc3RvcnlEYXRlUm93KHRoaXMudHhEYXRlKHR4KSkpXG4gICAgICAgIHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuYXBwZW5kQ2hpbGQodGhpcy50eEhpc3RvcnlSb3codHgsIHRoaXMuc2VsZWN0ZWRBc3NldElEKSlcbiAgICAgICAgdGhpcy5vbGRlc3RUeCA9IHR4XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudHhEYXRlKHR4KSAhPT0gdGhpcy50eEhpc3RvcnlUYWJsZU5ld2VzdERhdGUoKSkge1xuICAgICAgICB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5Lmluc2VydEJlZm9yZSh0aGlzLnR4SGlzdG9yeVJvdyh0eCwgdGhpcy5zZWxlY3RlZEFzc2V0SUQpLCB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmNoaWxkcmVuWzBdKVxuICAgICAgICB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5Lmluc2VydEJlZm9yZSh0aGlzLnR4SGlzdG9yeURhdGVSb3codGhpcy50eERhdGUodHgpKSwgdGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5jaGlsZHJlblswXSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuaW5zZXJ0QmVmb3JlKHRoaXMudHhIaXN0b3J5Um93KHR4LCB0aGlzLnNlbGVjdGVkQXNzZXRJRCksIHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuY2hpbGRyZW5bMV0pXG4gICAgICB9XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5jaGlsZHJlbikge1xuICAgICAgY29uc3QgcGVSb3cgPSByb3cgYXMgUGFnZUVsZW1lbnRcbiAgICAgIGlmIChwZVJvdy5kYXRhc2V0LnR4aWQgPT09IHR4LmlkKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVHhIaXN0b3J5Um93KHBlUm93LCB0eCwgdGhpcy5zZWxlY3RlZEFzc2V0SUQpXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0eC5pZCA9PT0gdGhpcy5jdXJyVHg/LmlkKSB7XG4gICAgICB0aGlzLnNldFR4RGV0YWlsc1BvcHVwRWxlbWVudHModHgpXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0VHhIaXN0b3J5IChhc3NldElEOiBudW1iZXIsIGhpZGVNaXhUeHM6IGJvb2xlYW4sIGFmdGVyPzogc3RyaW5nKSA6IFByb21pc2U8VHhIaXN0b3J5UmVzdWx0PiB7XG4gICAgbGV0IG51bVRvRmV0Y2ggPSAxMFxuICAgIGlmIChoaWRlTWl4VHhzKSBudW1Ub0ZldGNoID0gMTVcblxuICAgIGNvbnN0IHJlcyA6IFR4SGlzdG9yeVJlc3VsdCA9IHsgdHhzOiBbXSwgbGFzdFR4OiBmYWxzZSB9XG4gICAgbGV0IHJlZiA9IGFmdGVyXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQwOyBpKyspIHtcbiAgICAgIGNvbnN0IGN1cnJSZXMgPSBhd2FpdCBhcHAoKS50eEhpc3RvcnkoYXNzZXRJRCwgbnVtVG9GZXRjaCwgcmVmKVxuICAgICAgaWYgKGN1cnJSZXMudHhzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmVmID0gY3VyclJlcy50eHNbY3VyclJlcy50eHMubGVuZ3RoIC0gMV0uaWRcbiAgICAgIH1cbiAgICAgIGxldCB0eHMgPSBjdXJyUmVzLnR4c1xuICAgICAgaWYgKGhpZGVNaXhUeHMpIHtcbiAgICAgICAgdHhzID0gdHhzLmZpbHRlcigodHgpID0+IHR4LnR5cGUgIT09IHR4VHlwZU1peGluZylcbiAgICAgIH1cbiAgICAgIGlmIChyZXMudHhzLmxlbmd0aCArIHR4cy5sZW5ndGggPiAxMCkge1xuICAgICAgICBjb25zdCBudW1Ub1B1c2ggPSAxMCAtIHJlcy50eHMubGVuZ3RoXG4gICAgICAgIHJlcy50eHMucHVzaCguLi50eHMuc2xpY2UoMCwgbnVtVG9QdXNoKSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChjdXJyUmVzLmxhc3RUeCkgcmVzLmxhc3RUeCA9IHRydWVcbiAgICAgICAgcmVzLnR4cy5wdXNoKC4uLnR4cylcbiAgICAgIH1cbiAgICAgIGlmIChyZXMudHhzLmxlbmd0aCA+PSAxMCB8fCBjdXJyUmVzLmxhc3RUeCkgYnJlYWtcbiAgICB9XG4gICAgcmV0dXJuIHJlc1xuICB9XG5cbiAgYXN5bmMgc2hvd1R4SGlzdG9yeSAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGxldCB0eFJlcyA6IFR4SGlzdG9yeVJlc3VsdFxuICAgIERvYy5oaWRlKHBhZ2UudHhIaXN0b3J5VGFibGUsIHBhZ2UudHhIaXN0b3J5Qm94LCBwYWdlLm5vVHhIaXN0b3J5LCBwYWdlLmVhcmxpZXJUeHMsIHBhZ2UudHhIaXN0b3J5Tm90QXZhaWxhYmxlLCBwYWdlLmhpZGVNaXhUeHMpXG4gICAgRG9jLmVtcHR5KHBhZ2UudHhIaXN0b3J5VGFibGVCb2R5KVxuICAgIGNvbnN0IHcgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF0ud2FsbGV0XG4gICAgaWYgKCF3IHx8IHcuZGlzYWJsZWQgfHwgKHcudHJhaXRzICYgdHJhaXRIaXN0b3JpYW4pID09PSAwKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnR4SGlzdG9yeU5vdEF2YWlsYWJsZSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRoaXMub2xkZXN0VHggPSB1bmRlZmluZWRcblxuICAgIGNvbnN0IGlzTWl4aW5nID0gKHcudHJhaXRzICYgdHJhaXRGdW5kc01peGVyKSAhPT0gMFxuICAgIERvYy5zZXRWaXMoaXNNaXhpbmcsIHBhZ2UuaGlkZU1peFR4cylcbiAgICBEb2Muc2hvdyhwYWdlLnR4SGlzdG9yeUJveClcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBoaWRlTWl4aW5nID0gaXNNaXhpbmcgJiYgISFwYWdlLmhpZGVNaXhUeHNDaGVja2JveC5jaGVja2VkXG4gICAgICB0eFJlcyA9IGF3YWl0IHRoaXMuZ2V0VHhIaXN0b3J5KGFzc2V0SUQsIGhpZGVNaXhpbmcpXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLm5vVHhIaXN0b3J5KVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmICh0eFJlcy50eHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLm5vVHhIaXN0b3J5KVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgbGV0IG9sZGVzdERhdGUgPSB0aGlzLnR4RGF0ZSh0eFJlcy50eHNbMF0pXG4gICAgcGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuYXBwZW5kQ2hpbGQodGhpcy50eEhpc3RvcnlEYXRlUm93KG9sZGVzdERhdGUpKVxuICAgIGZvciAoY29uc3QgdHggb2YgdHhSZXMudHhzKSB7XG4gICAgICBjb25zdCBkYXRlID0gdGhpcy50eERhdGUodHgpXG4gICAgICBpZiAoZGF0ZSAhPT0gb2xkZXN0RGF0ZSkge1xuICAgICAgICBvbGRlc3REYXRlID0gZGF0ZVxuICAgICAgICBwYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5hcHBlbmRDaGlsZCh0aGlzLnR4SGlzdG9yeURhdGVSb3coZGF0ZSkpXG4gICAgICB9XG4gICAgICBjb25zdCByb3cgPSB0aGlzLnR4SGlzdG9yeVJvdyh0eCwgYXNzZXRJRClcbiAgICAgIHBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmFwcGVuZENoaWxkKHJvdylcbiAgICB9XG4gICAgdGhpcy5vbGRlc3RUeCA9IHR4UmVzLnR4c1t0eFJlcy50eHMubGVuZ3RoIC0gMV1cbiAgICBEb2Muc2hvdyhwYWdlLnR4SGlzdG9yeVRhYmxlKVxuICAgIERvYy5zZXRWaXMoIXR4UmVzLmxhc3RUeCwgcGFnZS5lYXJsaWVyVHhzKVxuICB9XG5cbiAgYXN5bmMgbG9hZEVhcmxpZXJUeHMgKCkge1xuICAgIGlmICghdGhpcy5vbGRlc3RUeCkgcmV0dXJuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGxldCB0eFJlcyA6IFR4SGlzdG9yeVJlc3VsdFxuICAgIGNvbnN0IHcgPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdLndhbGxldFxuICAgIGNvbnN0IGhpZGVNaXhpbmcgPSAody50cmFpdHMgJiB0cmFpdEZ1bmRzTWl4ZXIpICE9PSAwICYmICEhcGFnZS5oaWRlTWl4VHhzQ2hlY2tib3guY2hlY2tlZFxuICAgIHRyeSB7XG4gICAgICB0eFJlcyA9IGF3YWl0IHRoaXMuZ2V0VHhIaXN0b3J5KHRoaXMuc2VsZWN0ZWRBc3NldElELCBoaWRlTWl4aW5nLCB0aGlzLm9sZGVzdFR4LmlkKVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgbGV0IG9sZGVzdERhdGUgPSB0aGlzLnR4RGF0ZSh0aGlzLm9sZGVzdFR4KVxuICAgIGZvciAoY29uc3QgdHggb2YgdHhSZXMudHhzKSB7XG4gICAgICBjb25zdCBkYXRlID0gdGhpcy50eERhdGUodHgpXG4gICAgICBpZiAoZGF0ZSAhPT0gb2xkZXN0RGF0ZSkge1xuICAgICAgICBvbGRlc3REYXRlID0gZGF0ZVxuICAgICAgICBwYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5hcHBlbmRDaGlsZCh0aGlzLnR4SGlzdG9yeURhdGVSb3coZGF0ZSkpXG4gICAgICB9XG4gICAgICBjb25zdCByb3cgPSB0aGlzLnR4SGlzdG9yeVJvdyh0eCwgdGhpcy5zZWxlY3RlZEFzc2V0SUQpXG4gICAgICBwYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5hcHBlbmRDaGlsZChyb3cpXG4gICAgfVxuICAgIERvYy5zZXRWaXMoIXR4UmVzLmxhc3RUeCwgcGFnZS5lYXJsaWVyVHhzKVxuICAgIGlmICh0eFJlcy50eHMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5vbGRlc3RUeCA9IHR4UmVzLnR4c1t0eFJlcy50eHMubGVuZ3RoIC0gMV1cbiAgICB9XG4gIH1cblxuICBhc3luYyByZXNjYW5XYWxsZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnJlY29uZmlnRXJyKVxuXG4gICAgY29uc3QgdXJsID0gJy9hcGkvcmVzY2Fud2FsbGV0J1xuICAgIGNvbnN0IHJlcSA9IHsgYXNzZXRJRDogYXNzZXRJRCB9XG5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuYm9keSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTih1cmwsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmIChyZXMuY29kZSA9PT0gRXJyb3JzLmFjdGl2ZU9yZGVyc0Vycikge1xuICAgICAgdGhpcy5mb3JjZVVybCA9IHVybFxuICAgICAgdGhpcy5mb3JjZVJlcSA9IHJlcVxuICAgICAgdGhpcy5zaG93Q29uZmlybUZvcmNlKClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5yZWNvbmZpZ0VyciwgcmVzLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLmFzc2V0VXBkYXRlZChhc3NldElELCBwYWdlLnJlY29uZmlnRm9ybSwgaW50bC5wcmVwKGludGwuSURfUkVTQ0FOX1NUQVJURUQpKVxuICB9XG5cbiAgc2hvd0NvbmZpcm1Gb3JjZSAoKSB7XG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLmNvbmZpcm1Gb3JjZUVycilcbiAgICB0aGlzLnNob3dGb3JtKHRoaXMucGFnZS5jb25maXJtRm9yY2UpXG4gIH1cblxuICBzaG93UmVjb3ZlcldhbGxldCAoKSB7XG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLnJlY292ZXJXYWxsZXRFcnIpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UucmVjb3ZlcldhbGxldENvbmZpcm0pXG4gIH1cblxuICAvKiBTaG93IHRoZSBvcGVuIHdhbGxldCBmb3JtIGlmIHRoZSBwYXNzd29yZCBpcyBub3QgY2FjaGVkLCBhbmQgb3RoZXJ3aXNlXG4gICAqIGF0dGVtcHQgdG8gb3BlbiB0aGUgd2FsbGV0LlxuICAgKi9cbiAgYXN5bmMgb3BlbldhbGxldCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3Qgb3BlbiA9IHtcbiAgICAgIGFzc2V0SUQ6IGFzc2V0SURcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvb3BlbndhbGxldCcsIG9wZW4pXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ29wZW53YWxsZXQgZXJyb3InLCByZXMpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5hc3NldFVwZGF0ZWQoYXNzZXRJRCwgdW5kZWZpbmVkLCBpbnRsLnByZXAoaW50bC5JRF9XQUxMRVRfVU5MT0NLRUQpKVxuICB9XG5cbiAgLyogU2hvdyB0aGUgZm9ybSB1c2VkIHRvIGNoYW5nZSB3YWxsZXQgY29uZmlndXJhdGlvbiBzZXR0aW5ncy4gKi9cbiAgYXN5bmMgc2hvd1JlY29uZmlnIChhc3NldElEOiBudW1iZXIsIGNmZz86IHJlY29uZmlnU2V0dGluZ3MpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUoXG4gICAgICBwYWdlLmNoYW5nZVdhbGxldFR5cGUsIHBhZ2UuY2hhbmdlVHlwZUhpZGVJY29uLCBwYWdlLnJlY29uZmlnRXJyLFxuICAgICAgcGFnZS5zaG93Q2hhbmdlVHlwZSwgcGFnZS5jaGFuZ2VUeXBlSGlkZUljb24sIHBhZ2UucmVjb25maWdFcnIsXG4gICAgICBwYWdlLmVuYWJsZVdhbGxldCwgcGFnZS5kaXNhYmxlV2FsbGV0XG4gICAgKVxuICAgIC8vIEhpZGUgdXBkYXRlIHBhc3N3b3JkIHNlY3Rpb24gYnkgZGVmYXVsdFxuICAgIHRoaXMuY2hhbmdlV2FsbGV0UFcgPSBmYWxzZVxuICAgIHRoaXMuc2V0UFdTZXR0aW5nVml6KHRoaXMuY2hhbmdlV2FsbGV0UFcpXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cblxuICAgIGNvbnN0IGN1cnJlbnREZWYgPSBhcHAoKS5jdXJyZW50V2FsbGV0RGVmaW5pdGlvbihhc3NldElEKVxuICAgIGNvbnN0IHdhbGxldERlZnMgPSBhc3NldC50b2tlbiA/IFthc3NldC50b2tlbi5kZWZpbml0aW9uXSA6IGFzc2V0LmluZm8gPyBhc3NldC5pbmZvLmF2YWlsYWJsZXdhbGxldHMgOiBbXVxuICAgIGNvbnN0IGRpc2FibGVXYWxsZXRUeXBlID0gYXBwKCkuZXh0ZW5zaW9uV2FsbGV0KGFzc2V0SUQpPy5kaXNhYmxlV2FsbGV0VHlwZVxuICAgIGlmICh3YWxsZXREZWZzLmxlbmd0aCA+IDEgJiYgIWRpc2FibGVXYWxsZXRUeXBlKSB7XG4gICAgICBEb2MuZW1wdHkocGFnZS5jaGFuZ2VXYWxsZXRUeXBlU2VsZWN0KVxuICAgICAgRG9jLnNob3cocGFnZS5zaG93Q2hhbmdlVHlwZSwgcGFnZS5jaGFuZ2VUeXBlU2hvd0ljb24pXG4gICAgICBwYWdlLmNoYW5nZVR5cGVNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9DSEFOR0VfV0FMTEVUX1RZUEUpXG4gICAgICBmb3IgKGNvbnN0IHdEZWYgb2Ygd2FsbGV0RGVmcykge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKSBhcyBIVE1MT3B0aW9uRWxlbWVudFxuICAgICAgICBpZiAod0RlZi50eXBlID09PSBjdXJyZW50RGVmLnR5cGUpIG9wdGlvbi5zZWxlY3RlZCA9IHRydWVcbiAgICAgICAgb3B0aW9uLnZhbHVlID0gb3B0aW9uLnRleHRDb250ZW50ID0gd0RlZi50eXBlXG4gICAgICAgIHBhZ2UuY2hhbmdlV2FsbGV0VHlwZVNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24pXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNmZz8uZWxldmF0ZVByb3ZpZGVycykge1xuICAgICAgZm9yIChjb25zdCBvcHQgb2YgKGN1cnJlbnREZWYuY29uZmlnb3B0cykpIGlmIChvcHQua2V5ID09PSAncHJvdmlkZXJzJykgb3B0LnJlcXVpcmVkID0gdHJ1ZVxuICAgIH1cblxuICAgIGNvbnN0IHdhbGxldCA9IGFwcCgpLndhbGxldE1hcFthc3NldElEXVxuICAgIERvYy5zZXRWaXMod2FsbGV0LnRyYWl0cyAmIHRyYWl0TG9nRmlsZXIsIHBhZ2UuZG93bmxvYWRMb2dzKVxuICAgIERvYy5zZXRWaXMod2FsbGV0LnRyYWl0cyAmIHRyYWl0UmVjb3ZlcmVyLCBwYWdlLnJlY292ZXJXYWxsZXQpXG4gICAgRG9jLnNldFZpcyh3YWxsZXQudHJhaXRzICYgdHJhaXRSZXN0b3JlciwgcGFnZS5leHBvcnRXYWxsZXQpXG4gICAgRG9jLnNldFZpcyh3YWxsZXQudHJhaXRzICYgdHJhaXRSZXNjYW5uZXIsIHBhZ2UucmVzY2FuV2FsbGV0KVxuICAgIERvYy5zZXRWaXMod2FsbGV0LnRyYWl0cyAmIHRyYWl0UGVlck1hbmFnZXIgJiYgIXdhbGxldC5kaXNhYmxlZCwgcGFnZS5tYW5hZ2VQZWVycylcbiAgICBEb2Muc2V0VmlzKHdhbGxldC50cmFpdHMgJiB0cmFpdFRva2VuQXBwcm92ZXIgJiYgIXdhbGxldC5kaXNhYmxlZCwgcGFnZS51bmFwcHJvdmVUb2tlbkFsbG93YW5jZSlcblxuICAgIERvYy5zZXRWaXMod2FsbGV0LnRyYWl0cyAmIHRyYWl0c0V4dHJhT3B0cywgcGFnZS5vdGhlckFjdGlvbnNMYWJlbClcblxuICAgIGlmICh3YWxsZXQuZGlzYWJsZWQpIERvYy5zaG93KHBhZ2UuZW5hYmxlV2FsbGV0KVxuICAgIGVsc2UgRG9jLnNob3cocGFnZS5kaXNhYmxlV2FsbGV0KVxuXG4gICAgdGhpcy5zaG93T3JIaWRlUmVjb3ZlcnlTdXBwb3J0TXNnKHdhbGxldCwgY3VycmVudERlZi5zZWVkZWQpXG5cbiAgICBwYWdlLnJlY2ZnQXNzZXRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChhc3NldC5zeW1ib2wpXG4gICAgcGFnZS5yZWNmZ0Fzc2V0TmFtZS50ZXh0Q29udGVudCA9IGFzc2V0Lm5hbWVcbiAgICBpZiAoIWNmZz8uc2tpcEFuaW1hdGlvbikgdGhpcy5zaG93Rm9ybShwYWdlLnJlY29uZmlnRm9ybSlcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UucmVjb25maWdGb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3dhbGxldHNldHRpbmdzJywgeyBhc3NldElEIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5yZWNvbmZpZ0VyciwgcmVzLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBhc3NldEhhc0FjdGl2ZU9yZGVycyA9IGFwcCgpLmhhdmVBY3RpdmVPcmRlcnMoYXNzZXRJRClcbiAgICB0aGlzLnJlY29uZmlnRm9ybS51cGRhdGUoYXNzZXQuaWQsIGN1cnJlbnREZWYuY29uZmlnb3B0cyB8fCBbXSwgYXNzZXRIYXNBY3RpdmVPcmRlcnMpXG4gICAgdGhpcy5zZXRHdWlkZUxpbmsoY3VycmVudERlZi5ndWlkZWxpbmspXG4gICAgdGhpcy5yZWNvbmZpZ0Zvcm0uc2V0Q29uZmlnKHJlcy5tYXApXG4gICAgdGhpcy51cGRhdGVEaXNwbGF5ZWRSZWNvbmZpZ0ZpZWxkcyhjdXJyZW50RGVmKVxuICB9XG5cbiAgc2hvd09ySGlkZVJlY292ZXJ5U3VwcG9ydE1zZyAod2FsbGV0OiBXYWxsZXRTdGF0ZSwgc2VlZGVkOiBib29sZWFuKSB7XG4gICAgdGhpcy5zZXRSZWNvdmVyeVN1cHBvcnRNc2dWaXooc2VlZGVkICYmICF3YWxsZXQucnVubmluZyAmJiAhd2FsbGV0LmRpc2FibGVkICYmIEJvb2xlYW4od2FsbGV0LnRyYWl0cyAmIHRyYWl0UmVjb3ZlcmVyKSwgd2FsbGV0LnN5bWJvbClcbiAgfVxuXG4gIHNldFJlY292ZXJ5U3VwcG9ydE1zZ1ZpeiAodml6OiBib29sZWFuLCBzeW1ib2w6IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBpZiAodml6KSB7XG4gICAgICBwYWdlLnJlY29uZmlnU3VwcG9ydE1zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1dBTExFVF9SRUNPVkVSWV9TVVBQT1JUX01TRywgeyB3YWxsZXRTeW1ib2w6IHN5bWJvbC50b0xvY2FsZVVwcGVyQ2FzZSgpIH0pXG4gICAgICBEb2Muc2hvdyhwYWdlLnJlY29uZmlnU3VwcG9ydE1zZylcbiAgICAgIHBhZ2Uuc3VibWl0UmVjb25maWcuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKVxuICAgICAgcGFnZS5zdWJtaXRSZWNvbmZpZy5jbGFzc0xpc3QuYWRkKCdncmV5JylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwYWdlLnN1Ym1pdFJlY29uZmlnLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxuICAgIHBhZ2Uuc3VibWl0UmVjb25maWcuY2xhc3NMaXN0LnJlbW92ZSgnZ3JleScpXG4gICAgRG9jLmVtcHR5KHBhZ2UucmVjb25maWdTdXBwb3J0TXNnKVxuICAgIERvYy5oaWRlKHBhZ2UucmVjb25maWdTdXBwb3J0TXNnKVxuICB9XG5cbiAgY2hhbmdlV2FsbGV0VHlwZSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IHdhbGxldFR5cGUgPSBwYWdlLmNoYW5nZVdhbGxldFR5cGVTZWxlY3QudmFsdWUgfHwgJydcbiAgICBjb25zdCB3YWxsZXREZWYgPSBhcHAoKS53YWxsZXREZWZpbml0aW9uKHRoaXMuc2VsZWN0ZWRBc3NldElELCB3YWxsZXRUeXBlKVxuICAgIHRoaXMucmVjb25maWdGb3JtLnVwZGF0ZSh0aGlzLnNlbGVjdGVkQXNzZXRJRCwgd2FsbGV0RGVmLmNvbmZpZ29wdHMgfHwgW10sIGZhbHNlKVxuICAgIGNvbnN0IHdhbGxldCA9IGFwcCgpLndhbGxldE1hcFt0aGlzLnNlbGVjdGVkQXNzZXRJRF1cbiAgICBjb25zdCBjdXJyZW50RGVmID0gYXBwKCkuY3VycmVudFdhbGxldERlZmluaXRpb24odGhpcy5zZWxlY3RlZEFzc2V0SUQpXG4gICAgaWYgKHdhbGxldERlZi50eXBlICE9PSBjdXJyZW50RGVmLnR5cGUpIHRoaXMuc2V0UmVjb3ZlcnlTdXBwb3J0TXNnVml6KGZhbHNlLCB3YWxsZXQuc3ltYm9sKVxuICAgIGVsc2UgdGhpcy5zaG93T3JIaWRlUmVjb3ZlcnlTdXBwb3J0TXNnKHdhbGxldCwgd2FsbGV0RGVmLnNlZWRlZClcbiAgICB0aGlzLnNldEd1aWRlTGluayh3YWxsZXREZWYuZ3VpZGVsaW5rKVxuICAgIHRoaXMudXBkYXRlRGlzcGxheWVkUmVjb25maWdGaWVsZHMod2FsbGV0RGVmKVxuICB9XG5cbiAgc2V0R3VpZGVMaW5rIChndWlkZUxpbms6IHN0cmluZykge1xuICAgIERvYy5oaWRlKHRoaXMud2FsbGV0Q2ZnR3VpZGUpXG4gICAgaWYgKGd1aWRlTGluayAhPT0gJycpIHtcbiAgICAgIHRoaXMud2FsbGV0Q2ZnR3VpZGUuaHJlZiA9IGd1aWRlTGlua1xuICAgICAgRG9jLnNob3codGhpcy53YWxsZXRDZmdHdWlkZSlcbiAgICB9XG4gIH1cblxuICB1cGRhdGVEaXNwbGF5ZWRSZWNvbmZpZ0ZpZWxkcyAod2FsbGV0RGVmOiBXYWxsZXREZWZpbml0aW9uKSB7XG4gICAgY29uc3QgZGlzYWJsZVBhc3N3b3JkID0gYXBwKCkuZXh0ZW5zaW9uV2FsbGV0KHRoaXMuc2VsZWN0ZWRBc3NldElEKT8uZGlzYWJsZVBhc3N3b3JkXG4gICAgaWYgKHdhbGxldERlZi5zZWVkZWQgfHwgd2FsbGV0RGVmLnR5cGUgPT09ICd0b2tlbicgfHwgZGlzYWJsZVBhc3N3b3JkKSB7XG4gICAgICBEb2MuaGlkZSh0aGlzLnBhZ2Uuc2hvd0NoYW5nZVBXLCB0aGlzLnJlY29uZmlnRm9ybS5maWxlU2VsZWN0b3IpXG4gICAgICB0aGlzLmNoYW5nZVdhbGxldFBXID0gZmFsc2VcbiAgICAgIHRoaXMuc2V0UFdTZXR0aW5nVml6KGZhbHNlKVxuICAgIH0gZWxzZSBEb2Muc2hvdyh0aGlzLnBhZ2Uuc2hvd0NoYW5nZVBXLCB0aGlzLnJlY29uZmlnRm9ybS5maWxlU2VsZWN0b3IpXG4gIH1cblxuICAvKiBEaXNwbGF5IGEgZGVwb3NpdCBhZGRyZXNzLiAqL1xuICBhc3luYyBzaG93RGVwb3NpdCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgdGhpcy5kZXBvc2l0QWRkckZvcm0uc2V0QXNzZXQoYXNzZXRJRClcbiAgICB0aGlzLnNob3dGb3JtKHRoaXMucGFnZS5kZXBvc2l0KVxuICB9XG5cbiAgLyogU2hvdyB0aGUgZm9ybSB0byBlaXRoZXIgc2VuZCBvciB3aXRoZHJhdyBmdW5kcy4gKi9cbiAgYXN5bmMgc2hvd1NlbmRGb3JtIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYm94ID0gcGFnZS5zZW5kRm9ybVxuICAgIGNvbnN0IHsgd2FsbGV0LCB1bml0SW5mbzogdWksIHN5bWJvbCwgdG9rZW4gfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIERvYy5oaWRlKHBhZ2UudG9nZ2xlU3VidHJhY3QpXG4gICAgcGFnZS5zdWJ0cmFjdENoZWNrQm94LmNoZWNrZWQgPSBmYWxzZVxuXG4gICAgY29uc3QgaXNXaXRoZHJhd2VyID0gKHdhbGxldC50cmFpdHMgJiB0cmFpdFdpdGhkcmF3ZXIpICE9PSAwXG4gICAgaWYgKGlzV2l0aGRyYXdlcikge1xuICAgICAgRG9jLnNob3cocGFnZS50b2dnbGVTdWJ0cmFjdClcbiAgICB9XG5cbiAgICBEb2MuaGlkZShwYWdlLnNlbmRFcnIsIHBhZ2UubWF4U2VuZERpc3BsYXksIHBhZ2Uuc2VuZFRva2VuTXNnQm94KVxuICAgIHBhZ2Uuc2VuZEFkZHIuY2xhc3NMaXN0LnJlbW92ZSgnYm9yZGVyLWRhbmdlcicsICdib3JkZXItc3VjY2VzcycpXG4gICAgcGFnZS5zZW5kQWRkci52YWx1ZSA9ICcnXG4gICAgcGFnZS5zZW5kQW10LnZhbHVlID0gJydcbiAgICBjb25zdCB4Y1JhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLnNlbmRWYWx1ZSwgMCwgeGNSYXRlLCB1aSlcbiAgICBwYWdlLndhbGxldEJhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSwgdWkpXG4gICAgcGFnZS5zZW5kTG9nby5zcmMgPSBEb2MubG9nb1BhdGgoc3ltYm9sKVxuICAgIHBhZ2Uuc2VuZE5hbWUudGV4dENvbnRlbnQgPSB1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS5hc3NldHNbdG9rZW4ucGFyZW50SURdXG4gICAgICBwYWdlLnNlbmRUb2tlblBhcmVudExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHBhcmVudEFzc2V0LnN5bWJvbClcbiAgICAgIHBhZ2Uuc2VuZFRva2VuUGFyZW50TmFtZS50ZXh0Q29udGVudCA9IHBhcmVudEFzc2V0Lm5hbWVcbiAgICAgIERvYy5zaG93KHBhZ2Uuc2VuZFRva2VuTXNnQm94KVxuICAgIH1cbiAgICAvLyBwYWdlLnNlbmRGZWUudGV4dENvbnRlbnQgPSB3YWxsZXQuZmVlcmF0ZVxuICAgIC8vIHBhZ2Uuc2VuZFVuaXQudGV4dENvbnRlbnQgPSB3YWxsZXQudW5pdHNcblxuICAgIGlmICh3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgPiAwICYmICh3YWxsZXQudHJhaXRzICYgdHJhaXRUeEZlZUVzdGltYXRvcikgIT09IDApIHtcbiAgICAgIGNvbnN0IGZlZVJlcSA9IHtcbiAgICAgICAgYXNzZXRJRDogYXNzZXRJRCxcbiAgICAgICAgc3VidHJhY3Q6IGlzV2l0aGRyYXdlcixcbiAgICAgICAgbWF4V2l0aGRyYXc6IHRydWUsXG4gICAgICAgIHZhbHVlOiB3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGVcbiAgICAgIH1cblxuICAgICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmJvZHkpXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS90eGZlZScsIGZlZVJlcSlcbiAgICAgIGxvYWRlZCgpXG4gICAgICBpZiAoYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAgIGxldCBjYW5TZW5kID0gd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlXG4gICAgICAgIGlmICghdG9rZW4pIHtcbiAgICAgICAgICBjYW5TZW5kIC09IHJlcy50eGZlZVxuICAgICAgICAgIGlmIChjYW5TZW5kIDwgMCkgY2FuU2VuZCA9IDBcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubWF4U2VuZCA9IGNhblNlbmRcbiAgICAgICAgcGFnZS5tYXhTZW5kLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oY2FuU2VuZCwgdWkpXG4gICAgICAgIERvYy5zaG93RmlhdFZhbHVlKHBhZ2UubWF4U2VuZEZpYXQsIGNhblNlbmQsIHhjUmF0ZSwgdWkpXG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgIGNvbnN0IGZlZVVJID0gYXBwKCkuYXNzZXRzW3Rva2VuLnBhcmVudElEXS51bml0SW5mb1xuICAgICAgICAgIHBhZ2UubWF4U2VuZEZlZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHJlcy50eGZlZSwgZmVlVUkpICsgJyAnICsgZmVlVUkuY29udmVudGlvbmFsLnVuaXRcbiAgICAgICAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLm1heFNlbmRGZWVGaWF0LCByZXMudHhmZWUsIGFwcCgpLmZpYXRSYXRlc01hcFt0b2tlbi5wYXJlbnRJRF0sIGZlZVVJKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBhZ2UubWF4U2VuZEZlZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHJlcy50eGZlZSwgdWkpXG4gICAgICAgICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5tYXhTZW5kRmVlRmlhdCwgcmVzLnR4ZmVlLCB4Y1JhdGUsIHVpKVxuICAgICAgICB9XG4gICAgICAgIERvYy5zaG93KHBhZ2UubWF4U2VuZERpc3BsYXkpXG4gICAgICB9XG4gICAgfVxuXG4gICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5zZW5kVmFsdWUsIDAsIHhjUmF0ZSwgdWkpXG4gICAgcGFnZS53YWxsZXRCYWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbih3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUsIHVpKVxuICAgIGJveC5kYXRhc2V0LmFzc2V0SUQgPSBTdHJpbmcoYXNzZXRJRClcbiAgICB0aGlzLnNob3dGb3JtKGJveClcbiAgfVxuXG4gIC8qIGRvQ29ubmVjdCBjb25uZWN0cyB0byBhIHdhbGxldCB2aWEgdGhlIGNvbm5lY3R3YWxsZXQgQVBJIHJvdXRlLiAqL1xuICBhc3luYyBkb0Nvbm5lY3QgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5ib2R5KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2Nvbm5lY3R3YWxsZXQnLCB7IGFzc2V0SUQgfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBjb25zdCB7IHN5bWJvbCB9ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgICBwYWdlLmVycm9yTW9kYWxNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9DT05ORUNUX1dBTExFVF9FUlJfTVNHLCB7IGFzc2V0TmFtZTogc3ltYm9sLCBlcnJNc2c6IHJlcy5tc2cgfSlcbiAgICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5lcnJvck1vZGFsKVxuICAgIH1cbiAgICB0aGlzLnVwZGF0ZURpc3BsYXllZEFzc2V0KGFzc2V0SUQpXG4gIH1cblxuICBhc3NldFVwZGF0ZWQgKGFzc2V0SUQ6IG51bWJlciwgb2xkRm9ybT86IFBhZ2VFbGVtZW50LCBzdWNjZXNzTXNnPzogc3RyaW5nKSB7XG4gICAgaWYgKGFzc2V0SUQgIT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSByZXR1cm5cbiAgICB0aGlzLnVwZGF0ZURpc3BsYXllZEFzc2V0KGFzc2V0SUQpXG4gICAgaWYgKG9sZEZvcm0gJiYgT2JqZWN0LmlzKHRoaXMuY3VycmVudEZvcm0sIG9sZEZvcm0pKSB7XG4gICAgICBpZiAoc3VjY2Vzc01zZykgdGhpcy5zaG93U3VjY2VzcyhzdWNjZXNzTXNnKVxuICAgICAgZWxzZSB0aGlzLmNsb3NlUG9wdXBzKClcbiAgICB9XG4gIH1cblxuICAvKiBwb3B1bGF0ZU1heFNlbmQgcG9wdWxhdGVzIHRoZSBhbW91bnQgZmllbGQgd2l0aCB0aGUgbWF4IGFtb3VudCB0aGUgd2FsbGV0XG4gICAgIGNhbiBzZW5kLiBUaGUgbWF4IHNlbmQgYW1vdW50IGNhbiBiZSB0aGUgbWF4aW11bSBhbW91bnQgYmFzZWQgb24gb3VyXG4gICAgIHByZS1lc3RpbWF0aW9uIG9yIHRoZSBhc3NldCdzIHdhbGxldCBiYWxhbmNlLlxuICAqL1xuICBhc3luYyBwb3B1bGF0ZU1heFNlbmQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCB7IGlkOiBhc3NldElELCB1bml0SW5mbzogdWksIHdhbGxldCB9ID0gYXBwKCkuYXNzZXRzW3RoaXMuc2VsZWN0ZWRBc3NldElEXVxuICAgIC8vIFBvcHVsYXRlIHNlbmQgYW1vdW50IHdpdGggbWF4IHNlbmQgdmFsdWUgYW5kIGVuc3VyZSB3ZSBkb24ndCBjaGVja1xuICAgIC8vIHN1YnRyYWN0IGNoZWNrYm94IGZvciBhc3NldHMgdGhhdCBkb24ndCBoYXZlIGEgd2l0aGRyYXcgbWV0aG9kLlxuICAgIGNvbnN0IHhjUmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXVxuICAgIGlmICgod2FsbGV0LnRyYWl0cyAmIHRyYWl0V2l0aGRyYXdlcikgPT09IDApIHtcbiAgICAgIHBhZ2Uuc2VuZEFtdC52YWx1ZSA9IFN0cmluZyh0aGlzLm1heFNlbmQgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICAgIERvYy5zaG93RmlhdFZhbHVlKHBhZ2Uuc2VuZFZhbHVlLCB0aGlzLm1heFNlbmQsIHhjUmF0ZSwgdWkpXG4gICAgICBwYWdlLnN1YnRyYWN0Q2hlY2tCb3guY2hlY2tlZCA9IGZhbHNlXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGFtdCA9IHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZVxuICAgICAgcGFnZS5zZW5kQW10LnZhbHVlID0gU3RyaW5nKGFtdCAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5zZW5kVmFsdWUsIGFtdCwgeGNSYXRlLCB1aSlcbiAgICAgIHBhZ2Uuc3VidHJhY3RDaGVja0JveC5jaGVja2VkID0gdHJ1ZVxuICAgIH1cbiAgfVxuXG4gIC8qIHNlbmQgc3VibWl0cyB0aGUgc2VuZCBmb3JtIHRvIHRoZSBBUEkuICovXG4gIGFzeW5jIHNlbmQgKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhc3NldElEID0gcGFyc2VJbnQocGFnZS5zZW5kRm9ybS5kYXRhc2V0LmFzc2V0SUQgPz8gJycpXG4gICAgY29uc3Qgc3VidHJhY3QgPSBwYWdlLnN1YnRyYWN0Q2hlY2tCb3guY2hlY2tlZCA/PyBmYWxzZVxuICAgIGNvbnN0IGNvbnZlcnNpb25GYWN0b3IgPSBhcHAoKS51bml0SW5mbyhhc3NldElEKS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIGNvbnN0IHB3ID0gcGFnZS52U2VuZFB3LnZhbHVlIHx8ICcnXG4gICAgcGFnZS52U2VuZFB3LnZhbHVlID0gJydcbiAgICBpZiAocHcgPT09ICcnKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLnZTZW5kRXJyLCBpbnRsLnByZXAoaW50bC5JRF9OT19QQVNTX0VSUk9SX01TRykpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3Qgb3BlbiA9IHtcbiAgICAgIGFzc2V0SUQ6IGFzc2V0SUQsXG4gICAgICBhZGRyZXNzOiBwYWdlLnNlbmRBZGRyLnZhbHVlLFxuICAgICAgc3VidHJhY3Q6IHN1YnRyYWN0LFxuICAgICAgdmFsdWU6IE1hdGgucm91bmQocGFyc2VGbG9hdERlZmF1bHQocGFnZS5zZW5kQW10LnZhbHVlKSAqIGNvbnZlcnNpb25GYWN0b3IpLFxuICAgICAgcHc6IHB3XG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS52U2VuZEZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvc2VuZCcsIG9wZW4pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS52U2VuZEVyciwgcmVzLm1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBuYW1lID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdLm5hbWVcbiAgICB0aGlzLmFzc2V0VXBkYXRlZChhc3NldElELCBwYWdlLnZTZW5kRm9ybSwgaW50bC5wcmVwKGludGwuSURfU0VORF9TVUNDRVNTLCB7IGFzc2V0TmFtZTogbmFtZSB9KSlcbiAgfVxuXG4gIC8qIHVwZGF0ZSB3YWxsZXQgY29uZmlndXJhdGlvbiAqL1xuICBhc3luYyByZWNvbmZpZyAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGFzc2V0SUQgPSB0aGlzLnNlbGVjdGVkQXNzZXRJRFxuICAgIERvYy5oaWRlKHBhZ2UucmVjb25maWdFcnIpXG4gICAgbGV0IHdhbGxldFR5cGUgPSBhcHAoKS5jdXJyZW50V2FsbGV0RGVmaW5pdGlvbihhc3NldElEKS50eXBlXG4gICAgaWYgKCFEb2MuaXNIaWRkZW4ocGFnZS5jaGFuZ2VXYWxsZXRUeXBlKSkge1xuICAgICAgd2FsbGV0VHlwZSA9IHBhZ2UuY2hhbmdlV2FsbGV0VHlwZVNlbGVjdC52YWx1ZSB8fCAnJ1xuICAgIH1cblxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5yZWNvbmZpZ0Zvcm0pXG4gICAgY29uc3QgcmVxOiBSZWNvbmZpZ1JlcXVlc3QgPSB7XG4gICAgICBhc3NldElEOiBhc3NldElELFxuICAgICAgY29uZmlnOiB0aGlzLnJlY29uZmlnRm9ybS5tYXAoYXNzZXRJRCksXG4gICAgICB3YWxsZXRUeXBlOiB3YWxsZXRUeXBlXG4gICAgfVxuICAgIGlmICh0aGlzLmNoYW5nZVdhbGxldFBXKSByZXEubmV3V2FsbGV0UFcgPSBwYWdlLm5ld1BXLnZhbHVlXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS9yZWNvbmZpZ3VyZXdhbGxldCcsIHJlcSlcbiAgICBwYWdlLm5ld1BXLnZhbHVlID0gJydcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLnJlY29uZmlnRXJyLCByZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmICh0aGlzLmRhdGE/LmdvQmFjaykge1xuICAgICAgYXBwKCkubG9hZFBhZ2UodGhpcy5kYXRhLmdvQmFjaylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLmFzc2V0VXBkYXRlZChhc3NldElELCBwYWdlLnJlY29uZmlnRm9ybSwgaW50bC5wcmVwKGludGwuSURfUkVDT05GSUdfU1VDQ0VTUykpXG4gICAgdGhpcy51cGRhdGVUaWNrZXRCdXllcihhc3NldElEKVxuICAgIGFwcCgpLmNsZWFyVHhIaXN0b3J5KGFzc2V0SUQpXG4gICAgdGhpcy5zaG93VHhIaXN0b3J5KGFzc2V0SUQpXG4gICAgdGhpcy51cGRhdGVQcml2YWN5KGFzc2V0SUQpXG4gICAgdGhpcy5jaGVja05lZWRzUHJvdmlkZXIoYXNzZXRJRClcbiAgfVxuXG4gIC8qIGxvY2sgaW5zdHJ1Y3RzIHRoZSBBUEkgdG8gbG9jayB0aGUgd2FsbGV0LiAqL1xuICBhc3luYyBsb2NrIChhc3NldElEOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLm5ld1dhbGxldEZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvY2xvc2V3YWxsZXQnLCB7IGFzc2V0SUQ6IGFzc2V0SUQgfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSByZXR1cm5cbiAgICB0aGlzLnVwZGF0ZURpc3BsYXllZEFzc2V0KGFzc2V0SUQpXG4gICAgdGhpcy51cGRhdGVQcml2YWN5KGFzc2V0SUQpXG4gIH1cblxuICBhc3luYyBkb3dubG9hZExvZ3MgKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHNlYXJjaCA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoJycpXG4gICAgc2VhcmNoLmFwcGVuZCgnYXNzZXRpZCcsIGAke3RoaXMuc2VsZWN0ZWRBc3NldElEfWApXG4gICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZilcbiAgICB1cmwuc2VhcmNoID0gc2VhcmNoLnRvU3RyaW5nKClcbiAgICB1cmwucGF0aG5hbWUgPSAnL3dhbGxldHMvbG9nZmlsZSdcbiAgICB3aW5kb3cub3Blbih1cmwudG9TdHJpbmcoKSlcbiAgfVxuXG4gIC8vIGRpc3BsYXlFeHBvcnRXYWxsZXRBdXRoIGRpc3BsYXlzIGEgZm9ybSB0byB3YXJuIHRoZSB1c2VyIGFib3V0IHRoZVxuICAvLyBkYW5nZXJzIG9mIGV4cG9ydGluZyBhIHdhbGxldCwgYW5kIGFza3MgdGhlbSB0byBlbnRlciB0aGVpciBwYXNzd29yZC5cbiAgYXN5bmMgZGlzcGxheUV4cG9ydFdhbGxldEF1dGggKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmV4cG9ydFdhbGxldEVycilcbiAgICBwYWdlLmV4cG9ydFdhbGxldFBXLnZhbHVlID0gJydcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UuZXhwb3J0V2FsbGV0QXV0aClcbiAgfVxuXG4gIC8vIGV4cG9ydFdhbGxldEF1dGhTdWJtaXQgaXMgY2FsbGVkIGFmdGVyIHRoZSB1c2VyIGVudGVycyB0aGVpciBwYXNzd29yZCB0b1xuICAvLyBhdXRob3JpemUgbG9va2luZyB1cCB0aGUgaW5mb3JtYXRpb24gdG8gcmVzdG9yZSB0aGVpciB3YWxsZXQgaW4gYW5cbiAgLy8gZXh0ZXJuYWwgd2FsbGV0LlxuICBhc3luYyBleHBvcnRXYWxsZXRBdXRoU3VibWl0ICgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgYXNzZXRJRDogdGhpcy5zZWxlY3RlZEFzc2V0SUQsXG4gICAgICBwYXNzOiBwYWdlLmV4cG9ydFdhbGxldFBXLnZhbHVlXG4gICAgfVxuICAgIGNvbnN0IHVybCA9ICcvYXBpL3Jlc3RvcmV3YWxsZXRpbmZvJ1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5mb3JtcylcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTih1cmwsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmIChhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UuZXhwb3J0V2FsbGV0UFcudmFsdWUgPSAnJ1xuICAgICAgdGhpcy5kaXNwbGF5UmVzdG9yZVdhbGxldEluZm8ocmVzLnJlc3RvcmF0aW9uaW5mbylcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5leHBvcnRXYWxsZXRFcnIsIHJlcy5tc2cpXG4gICAgfVxuICB9XG5cbiAgLy8gZGlzcGxheVJlc3RvcmVXYWxsZXRJbmZvIGRpc3BsYXlzIHRoZSBpbmZvcm1hdGlvbiBuZWVkZWQgdG8gcmVzdG9yZSBhXG4gIC8vIHdhbGxldCBpbiBleHRlcm5hbCB3YWxsZXRzLlxuICBhc3luYyBkaXNwbGF5UmVzdG9yZVdhbGxldEluZm8gKGluZm86IFdhbGxldFJlc3RvcmF0aW9uW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmVtcHR5KHBhZ2UucmVzdG9yZUluZm9DYXJkc0xpc3QpXG4gICAgZm9yIChjb25zdCB3ciBvZiBpbmZvKSB7XG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5yZXN0b3JlSW5mb0NhcmQuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoY2FyZClcbiAgICAgIHRtcGwubmFtZS50ZXh0Q29udGVudCA9IHdyLnRhcmdldFxuICAgICAgdG1wbC5zZWVkLnRleHRDb250ZW50ID0gd3Iuc2VlZFxuICAgICAgdG1wbC5zZWVkTmFtZS50ZXh0Q29udGVudCA9IGAke3dyLnNlZWROYW1lfTpgXG4gICAgICB0bXBsLmluc3RydWN0aW9ucy50ZXh0Q29udGVudCA9IHdyLmluc3RydWN0aW9uc1xuICAgICAgcGFnZS5yZXN0b3JlSW5mb0NhcmRzTGlzdC5hcHBlbmRDaGlsZChjYXJkKVxuICAgIH1cbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UucmVzdG9yZVdhbGxldEluZm8pXG4gIH1cblxuICBhc3luYyByZWNvdmVyV2FsbGV0ICgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5yZWNvdmVyV2FsbGV0RXJyKVxuICAgIGNvbnN0IHJlcSA9IHtcbiAgICAgIGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElEXG4gICAgfVxuICAgIGNvbnN0IHVybCA9ICcvYXBpL3JlY292ZXJ3YWxsZXQnXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLmZvcm1zKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHVybCwgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKHJlcy5jb2RlID09PSBFcnJvcnMuYWN0aXZlT3JkZXJzRXJyKSB7XG4gICAgICB0aGlzLmZvcmNlVXJsID0gdXJsXG4gICAgICB0aGlzLmZvcmNlUmVxID0gcmVxXG4gICAgICB0aGlzLnNob3dDb25maXJtRm9yY2UoKVxuICAgIH0gZWxzZSBpZiAoYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICB0aGlzLmNsb3NlUG9wdXBzKClcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5yZWNvdmVyV2FsbGV0RXJyLCByZXMubXNnKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGNvbmZpcm1Gb3JjZVN1Ym1pdCByZXN1Ym1pdHMgZWl0aGVyIHRoZSByZWNvdmVyIG9yIHJlc2NhbiByZXF1ZXN0cyB3aXRoXG4gICAqIGZvcmNlIHNldCB0byB0cnVlLiBUaGVzZSB0d28gcmVxdWVzdHMgcmVxdWlyZSBmb3JjZSB0byBiZSBzZXQgdG8gdHJ1ZSBpZlxuICAgKiB0aGV5IGFyZSBjYWxsZWQgd2hpbGUgdGhlIHdhbGxldCBpcyBtYW5hZ2luZyBhY3RpdmUgb3JkZXJzLlxuICAgKi9cbiAgYXN5bmMgY29uZmlybUZvcmNlU3VibWl0ICgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5mb3JjZVJlcS5mb3JjZSA9IHRydWVcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuZm9ybXMpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04odGhpcy5mb3JjZVVybCwgdGhpcy5mb3JjZVJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmIChhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHRoaXMuY2xvc2VQb3B1cHMoKVxuICAgIGVsc2Uge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5jb25maXJtRm9yY2VFcnIsIHJlcy5tc2cpXG4gICAgfVxuICB9XG5cbiAgLyogaGFuZGxlQmFsYW5jZSBoYW5kbGVzIG5vdGlmaWNhdGlvbnMgdXBkYXRpbmcgYSB3YWxsZXQncyBiYWxhbmNlIGFuZCBhc3NldHMnXG4gICAgIHZhbHVlIGluIGRlZmF1bHQgZmlhdCByYXRlLlxuICAuICovXG4gIGhhbmRsZUJhbGFuY2VOb3RlIChub3RlOiBCYWxhbmNlTm90ZSk6IHZvaWQge1xuICAgIHRoaXMudXBkYXRlQXNzZXRCdXR0b24obm90ZS5hc3NldElEKVxuICAgIGlmIChub3RlLmFzc2V0SUQgPT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSB0aGlzLnVwZGF0ZURpc3BsYXllZEFzc2V0QmFsYW5jZSgpXG4gIH1cblxuICAvKiBoYW5kbGVSYXRlc05vdGUgaGFuZGxlcyBmaWF0IHJhdGUgbm90aWZpY2F0aW9ucywgdXBkYXRpbmcgdGhlIGZpYXQgdmFsdWUgb2ZcbiAgICogIGFsbCBzdXBwb3J0ZWQgYXNzZXRzLlxuICAgKi9cbiAgaGFuZGxlUmF0ZXNOb3RlIChub3RlOiBSYXRlTm90ZSk6IHZvaWQge1xuICAgIHRoaXMudXBkYXRlQXNzZXRCdXR0b24odGhpcy5zZWxlY3RlZEFzc2V0SUQpXG4gICAgaWYgKCFub3RlLmZpYXRSYXRlc1t0aGlzLnNlbGVjdGVkQXNzZXRJRF0pIHJldHVyblxuICAgIHRoaXMudXBkYXRlRGlzcGxheWVkQXNzZXRCYWxhbmNlKClcbiAgICBjb25zdCB7IGZlZVN0YXRlIH0gPSBhcHAoKS53YWxsZXRNYXBbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgaWYgKGZlZVN0YXRlKSB0aGlzLnVwZGF0ZUZlZVN0YXRlKGZlZVN0YXRlKVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlV2FsbGV0U3RhdGVOb3RlIGlzIGEgaGFuZGxlciBmb3IgYm90aCB0aGUgJ3dhbGxldHN0YXRlJyBhbmRcbiAgICogJ3dhbGxldGNvbmZpZycgbm90aWZpY2F0aW9ucy5cbiAgICovXG4gIGhhbmRsZVdhbGxldFN0YXRlTm90ZSAobm90ZTogV2FsbGV0U3RhdGVOb3RlKTogdm9pZCB7XG4gICAgY29uc3QgeyBhc3NldElELCBmZWVTdGF0ZSB9ID0gbm90ZS53YWxsZXRcbiAgICB0aGlzLnVwZGF0ZUFzc2V0QnV0dG9uKGFzc2V0SUQpXG4gICAgdGhpcy5hc3NldFVwZGF0ZWQoYXNzZXRJRClcbiAgICBpZiAobm90ZS50b3BpYyA9PT0gJ1dhbGxldFBlZXJzVXBkYXRlJyAmJlxuICAgICAgICBhc3NldElEID09PSB0aGlzLnNlbGVjdGVkQXNzZXRJRCAmJlxuICAgICAgICBEb2MuaXNEaXNwbGF5ZWQodGhpcy5wYWdlLm1hbmFnZVBlZXJzRm9ybSkpIHtcbiAgICAgIHRoaXMudXBkYXRlV2FsbGV0UGVlcnNUYWJsZSgpXG4gICAgfVxuICAgIGlmIChmZWVTdGF0ZSAmJiBhc3NldElEID09PSB0aGlzLnNlbGVjdGVkQXNzZXRJRCkgdGhpcy51cGRhdGVGZWVTdGF0ZShmZWVTdGF0ZSlcbiAgfVxuXG4gIC8qXG4gICAqIGhhbmRsZUNyZWF0ZVdhbGxldE5vdGUgaXMgYSBoYW5kbGVyIGZvciAnY3JlYXRld2FsbGV0JyBub3RpZmljYXRpb25zLlxuICAgKi9cbiAgaGFuZGxlQ3JlYXRlV2FsbGV0Tm90ZSAobm90ZTogV2FsbGV0Q3JlYXRpb25Ob3RlKSB7XG4gICAgdGhpcy51cGRhdGVBc3NldEJ1dHRvbihub3RlLmFzc2V0SUQpXG4gICAgdGhpcy5hc3NldFVwZGF0ZWQobm90ZS5hc3NldElEKVxuICAgIHRoaXMuc2hvd1R4SGlzdG9yeShub3RlLmFzc2V0SUQpXG4gIH1cblxuICBoYW5kbGVDdXN0b21XYWxsZXROb3RlIChub3RlOiBXYWxsZXROb3RlKSB7XG4gICAgY29uc3Qgd2FsbGV0Tm90ZSA9IG5vdGUucGF5bG9hZCBhcyBCYXNlV2FsbGV0Tm90ZVxuICAgIHN3aXRjaCAod2FsbGV0Tm90ZS5yb3V0ZSkge1xuICAgICAgY2FzZSAndGlwQ2hhbmdlJzoge1xuICAgICAgICBjb25zdCBuID0gd2FsbGV0Tm90ZSBhcyBUaXBDaGFuZ2VOb3RlXG4gICAgICAgIHN3aXRjaCAobi5hc3NldElEKSB7XG4gICAgICAgICAgY2FzZSA0MjogeyAvLyBkY3JcbiAgICAgICAgICAgIGlmICghdGhpcy5zdGFrZVN0YXR1cykgcmV0dXJuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gbi5kYXRhIGFzIERlY3JlZFRpY2tldFRpcFVwZGF0ZVxuICAgICAgICAgICAgY29uc3Qgc3luY2VkID0gYXBwKCkud2FsbGV0TWFwW24uYXNzZXRJRF0uc3luY2VkXG4gICAgICAgICAgICBpZiAoc3luY2VkKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHVpID0gYXBwKCkudW5pdEluZm8obi5hc3NldElEKVxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRpY2tldFN0YXRzKGRhdGEuc3RhdHMsIHVpLCBkYXRhLnRpY2tldFByaWNlLCBkYXRhLnZvdGluZ1N1YnNpZHkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICd0aWNrZXRQdXJjaGFzZVVwZGF0ZSc6IHtcbiAgICAgICAgdGhpcy5wcm9jZXNzVGlja2V0UHVyY2hhc2VVcGRhdGUod2FsbGV0Tm90ZSBhcyBDdXN0b21XYWxsZXROb3RlKVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAndHJhbnNhY3Rpb24nOiB7XG4gICAgICAgIGNvbnN0IG4gPSB3YWxsZXROb3RlIGFzIFRyYW5zYWN0aW9uTm90ZVxuICAgICAgICBpZiAobi5hc3NldElEID09PSB0aGlzLnNlbGVjdGVkQXNzZXRJRCkgdGhpcy5oYW5kbGVUeE5vdGUobi50cmFuc2FjdGlvbiwgbi5uZXcpXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICd0cmFuc2FjdGlvbkhpc3RvcnlTeW5jZWQnIDoge1xuICAgICAgICBjb25zdCBuID0gd2FsbGV0Tm90ZVxuICAgICAgICBpZiAobi5hc3NldElEID09PSB0aGlzLnNlbGVjdGVkQXNzZXRJRCkgdGhpcy5zaG93VHhIaXN0b3J5KG4uYXNzZXRJRClcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiB1bmxvYWQgaXMgY2FsbGVkIGJ5IHRoZSBBcHBsaWNhdGlvbiB3aGVuIHRoZSB1c2VyIG5hdmlnYXRlcyBhd2F5IGZyb21cbiAgICogdGhlIC93YWxsZXRzIHBhZ2UuXG4gICAqL1xuICB1bmxvYWQgKCk6IHZvaWQge1xuICAgIGNsZWFySW50ZXJ2YWwodGhpcy5zZWNvbmRUaWNrZXIpXG4gICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5rZXl1cClcbiAgfVxufVxuXG5mdW5jdGlvbiB0cmltU3RyaW5nV2l0aEVsbGlwc2lzIChzdHI6IHN0cmluZywgbWF4TGVuOiBudW1iZXIpOiBzdHJpbmcge1xuICBpZiAoc3RyLmxlbmd0aCA8PSBtYXhMZW4pIHJldHVybiBzdHJcbiAgcmV0dXJuIGAke3N0ci5zdWJzdHJpbmcoMCwgbWF4TGVuIC8gMil9Li4uJHtzdHIuc3Vic3RyaW5nKHN0ci5sZW5ndGggLSBtYXhMZW4gLyAyKX1gXG59XG4iLCIvLyBNZXNzYWdlU29ja2V0IGlzIGEgV2ViU29ja2V0IG1hbmFnZXIgdGhhdCB1c2VzIHRoZSBEZWNyZWQgREVYIE1lc3NhZ2UgZm9ybWF0XG4vLyBmb3IgY29tbXVuaWNhdGlvbnMuXG4vL1xuLy8gTWVzc2FnZSByZXF1ZXN0IGZvcm1hdDpcbi8vIHtcbi8vICAgcm91dGU6ICduYW1lJyxcbi8vICAgaWQ6IGludCxcbi8vICAgcGF5bG9hZDogYW55dGhpbmcgb3Igbm90aGluZ1xuLy8gfVxuLy9cbi8vIE1lc3NhZ2UgcmVzcG9uc2UgcGF5bG9hZCB3aWxsIGJlIGEgcmVzdWx0IG9iamVjdCB3aXRoIGVpdGhlciBhIHZhbGlkICdyZXN1bHQnXG4vLyBmaWVsZCBvciBhbiAnZXJyb3InIGZpZWxkXG4vL1xuLy8gRnVuY3Rpb25zIGZvciBleHRlcm5hbCB1c2U6XG4vLyByZWdpc3RlclJvdXRlIChyb3V0ZSwgaGFuZGxlcikgLS0gcmVnaXN0ZXIgYSBmdW5jdGlvbiB0byBoYW5kbGUgZXZlbnRzXG4vLyBvZiB0aGUgZ2l2ZW4gdHlwZVxuLy8gcmVxdWVzdCAocm91dGUsIHBheWxvYWQpIC0tIGNyZWF0ZSBhIEpTT04gbWVzc2FnZSBpbiB0aGUgYWJvdmUgZm9ybWF0IGFuZFxuLy8gc2VuZCBpdFxuLy9cbi8vIEJhc2VkIG9uIG1lc3NhZ2Vzb2NrZXRfc2VydmljZS5qcyBieSBKb25hdGhhbiBDaGFwcGVsb3cgQCBkY3JkYXRhLCB3aGljaCBpc1xuLy8gYmFzZWQgb24gd3NfZXZlbnRzX2Rpc3BhdGNoZXIuanMgYnkgSXNtYWVsIENlbGlzXG5jb25zdCB0eXBlUmVxdWVzdCA9IDFcblxuZnVuY3Rpb24gZm9yd2FyZCAocm91dGU6IHN0cmluZywgcGF5bG9hZDogYW55LCBoYW5kbGVyczogUmVjb3JkPHN0cmluZywgKChwYXlsb2FkOiBhbnkpID0+IHZvaWQpW10+KSB7XG4gIGlmICghcm91dGUgJiYgcGF5bG9hZC5lcnJvcikge1xuICAgIGNvbnN0IGVyciA9IHBheWxvYWQuZXJyb3JcbiAgICBjb25zb2xlLmVycm9yKGB3ZWJzb2NrZXQgZXJyb3IgKGNvZGUgJHtlcnIuY29kZX0pOiAke2Vyci5tZXNzYWdlfWApXG4gICAgcmV0dXJuXG4gIH1cbiAgaWYgKHR5cGVvZiBoYW5kbGVyc1tyb3V0ZV0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgLy8gY29uc29sZS5sb2coYHVuaGFuZGxlZCBtZXNzYWdlIGZvciAke3JvdXRlfTogJHtwYXlsb2FkfWApXG4gICAgcmV0dXJuXG4gIH1cbiAgLy8gY2FsbCBlYWNoIGhhbmRsZXJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBoYW5kbGVyc1tyb3V0ZV0ubGVuZ3RoOyBpKyspIHtcbiAgICBoYW5kbGVyc1tyb3V0ZV1baV0ocGF5bG9hZClcbiAgfVxufVxuXG5sZXQgaWQgPSAwXG5cbnR5cGUgTm90ZVJlY2VpdmVyID0gKHBheWxvYWQ6IGFueSkgPT4gdm9pZFxuXG5jbGFzcyBNZXNzYWdlU29ja2V0IHtcbiAgdXJpOiBzdHJpbmdcbiAgY29ubmVjdGlvbjogV2ViU29ja2V0IHwgbnVsbFxuICBoYW5kbGVyczogUmVjb3JkPHN0cmluZywgTm90ZVJlY2VpdmVyW10+XG4gIHF1ZXVlOiBbc3RyaW5nLCBhbnldW11cbiAgbWF4UWxlbmd0aDogbnVtYmVyXG4gIHJlbG9hZGVyOiAoKSA9PiB2b2lkIC8vIGFwcGVhcnMgdW51c2VkXG5cbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHRoaXMuaGFuZGxlcnMgPSB7fVxuICAgIHRoaXMucXVldWUgPSBbXVxuICAgIHRoaXMubWF4UWxlbmd0aCA9IDVcbiAgfVxuXG4gIHJlZ2lzdGVyUm91dGUgKHJvdXRlOiBzdHJpbmcsIGhhbmRsZXI6IE5vdGVSZWNlaXZlcikge1xuICAgIHRoaXMuaGFuZGxlcnNbcm91dGVdID0gdGhpcy5oYW5kbGVyc1tyb3V0ZV0gfHwgW11cbiAgICB0aGlzLmhhbmRsZXJzW3JvdXRlXS5wdXNoKGhhbmRsZXIpXG4gIH1cblxuICBkZXJlZ2lzdGVyUm91dGUgKHJvdXRlOiBzdHJpbmcpIHtcbiAgICB0aGlzLmhhbmRsZXJzW3JvdXRlXSA9IFtdXG4gIH1cblxuICAvLyByZXF1ZXN0IHNlbmRzIGEgcmVxdWVzdC10eXBlIG1lc3NhZ2UgdG8gdGhlIHNlcnZlclxuICByZXF1ZXN0IChyb3V0ZTogc3RyaW5nLCBwYXlsb2FkOiBhbnkpIHtcbiAgICBpZiAoIXRoaXMuY29ubmVjdGlvbiB8fCB0aGlzLmNvbm5lY3Rpb24ucmVhZHlTdGF0ZSAhPT0gd2luZG93LldlYlNvY2tldC5PUEVOKSB7XG4gICAgICB3aGlsZSAodGhpcy5xdWV1ZS5sZW5ndGggPiB0aGlzLm1heFFsZW5ndGggLSAxKSB0aGlzLnF1ZXVlLnNoaWZ0KClcbiAgICAgIHRoaXMucXVldWUucHVzaChbcm91dGUsIHBheWxvYWRdKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlkKytcbiAgICBjb25zdCBtZXNzYWdlID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcm91dGU6IHJvdXRlLFxuICAgICAgdHlwZTogdHlwZVJlcXVlc3QsXG4gICAgICBpZDogaWQsXG4gICAgICBwYXlsb2FkOiBwYXlsb2FkXG4gICAgfSlcblxuICAgIHdpbmRvdy5sb2coJ3dzJywgJ3NlbmRpbmcnLCBtZXNzYWdlKVxuICAgIHRoaXMuY29ubmVjdGlvbi5zZW5kKG1lc3NhZ2UpXG4gIH1cblxuICBjbG9zZSAocmVhc29uOiBzdHJpbmcpIHtcbiAgICB3aW5kb3cubG9nKCd3cycsICdjbG9zZSwgcmVhc29uOicsIHJlYXNvbiwgdGhpcy5oYW5kbGVycylcbiAgICB0aGlzLmhhbmRsZXJzID0ge31cbiAgICBpZiAodGhpcy5jb25uZWN0aW9uKSB0aGlzLmNvbm5lY3Rpb24uY2xvc2UoKVxuICB9XG5cbiAgY29ubmVjdCAodXJpOiBzdHJpbmcsIHJlbG9hZGVyOiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy51cmkgPSB1cmlcbiAgICB0aGlzLnJlbG9hZGVyID0gcmVsb2FkZXJcbiAgICBsZXQgcmV0cnlzID0gMFxuICAgIGNvbnN0IGdvID0gKCkgPT4ge1xuICAgICAgd2luZG93LmxvZygnd3MnLCBgY29ubmVjdGluZyB0byAke3VyaX1gKVxuICAgICAgbGV0IGNvbm46IFdlYlNvY2tldCB8IG51bGwgPSB0aGlzLmNvbm5lY3Rpb24gPSBuZXcgd2luZG93LldlYlNvY2tldCh1cmkpXG4gICAgICBpZiAoIWNvbm4pIHJldHVyblxuICAgICAgY29uc3QgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAvLyByZWFkeVN0YXRlIGlzIHN0aWxsIFdlYlNvY2tldC5DT05ORUNUSU5HLiBDYW5jZWwgYW5kIHRyaWdnZXIgb25jbG9zZS5cbiAgICAgICAgaWYgKGNvbm4pIGNvbm4uY2xvc2UoKVxuICAgICAgfSwgNTAwKVxuXG4gICAgICAvLyB1bm1hcnNoYWwgbWVzc2FnZSwgYW5kIGZvcndhcmQgdGhlIG1lc3NhZ2UgdG8gcmVnaXN0ZXJlZCBoYW5kbGVyc1xuICAgICAgY29ubi5vbm1lc3NhZ2UgPSAoZXZ0OiBNZXNzYWdlRXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IEpTT04ucGFyc2UoZXZ0LmRhdGEpXG4gICAgICAgIGZvcndhcmQobWVzc2FnZS5yb3V0ZSwgbWVzc2FnZS5wYXlsb2FkLCB0aGlzLmhhbmRsZXJzKVxuICAgICAgfVxuXG4gICAgICAvLyBTdHViIG91dCBzdGFuZGFyZCBmdW5jdGlvbnNcbiAgICAgIGNvbm4ub25jbG9zZSA9IChldnQ6IENsb3NlRXZlbnQpID0+IHtcbiAgICAgICAgd2luZG93LmxvZygnd3MnLCAnb25jbG9zZScpXG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KVxuICAgICAgICBjb25uID0gdGhpcy5jb25uZWN0aW9uID0gbnVsbFxuICAgICAgICBmb3J3YXJkKCdjbG9zZScsIG51bGwsIHRoaXMuaGFuZGxlcnMpXG4gICAgICAgIHJldHJ5cysrXG4gICAgICAgIC8vIDEuMiwgMS42LCAyLjAsIDIuNCwgMy4xLCAzLjgsIDQuOCwgNi4wLCA3LjUsIDkuMywgLi4uXG4gICAgICAgIGNvbnN0IGRlbGF5ID0gTWF0aC5taW4oTWF0aC5wb3coMS4yNSwgcmV0cnlzKSwgMTApXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYHdlYnNvY2tldCBkaXNjb25uZWN0ZWQgKCR7ZXZ0LmNvZGV9KSwgdHJ5aW5nIGFnYWluIGluICR7ZGVsYXkudG9GaXhlZCgxKX0gc2Vjb25kc2ApXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGdvKClcbiAgICAgICAgfSwgZGVsYXkgKiAxMDAwKVxuICAgICAgfVxuXG4gICAgICBjb25uLm9ub3BlbiA9ICgpID0+IHtcbiAgICAgICAgd2luZG93LmxvZygnd3MnLCAnb25vcGVuJylcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpXG4gICAgICAgIGlmIChyZXRyeXMgPiAwKSB7XG4gICAgICAgICAgcmV0cnlzID0gMFxuICAgICAgICAgIHJlbG9hZGVyKClcbiAgICAgICAgfVxuICAgICAgICBmb3J3YXJkKCdvcGVuJywgbnVsbCwgdGhpcy5oYW5kbGVycylcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnF1ZXVlXG4gICAgICAgIHRoaXMucXVldWUgPSBbXVxuICAgICAgICBmb3IgKGNvbnN0IFtyb3V0ZSwgbWVzc2FnZV0gb2YgcXVldWUpIHtcbiAgICAgICAgICB0aGlzLnJlcXVlc3Qocm91dGUsIG1lc3NhZ2UpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29ubi5vbmVycm9yID0gKGV2dDogRXZlbnQpID0+IHtcbiAgICAgICAgd2luZG93LmxvZygnd3MnLCAnb25lcnJvcjonLCBldnQpXG4gICAgICAgIGZvcndhcmQoJ2Vycm9yJywgZXZ0LCB0aGlzLmhhbmRsZXJzKVxuICAgICAgfVxuICAgIH1cbiAgICBnbygpXG4gIH1cbn1cblxuY29uc3Qgd3MgPSBuZXcgTWVzc2FnZVNvY2tldCgpXG5leHBvcnQgZGVmYXVsdCB3c1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJpbXBvcnQgQXBwbGljYXRpb24gZnJvbSAnLi9qcy9hcHAnXG5pbXBvcnQgeyByZWdpc3RlckFwcGxpY2F0aW9uIH0gZnJvbSAnLi9qcy9yZWdpc3RyeSdcbmltcG9ydCAnLi9jc3MvYm9vdHN0cmFwLnNjc3MnXG5pbXBvcnQgJy4vY3NzL2FwcGxpY2F0aW9uLnNjc3MnXG5cbmNvbnN0IGFwcCA9IG5ldyBBcHBsaWNhdGlvbigpXG5yZWdpc3RlckFwcGxpY2F0aW9uKGFwcClcbmFwcC5zdGFydCgpXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=