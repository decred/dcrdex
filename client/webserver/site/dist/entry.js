(()=>{var e={757:(e,t,n)=>{e.exports=n(666)},666:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),i=new R(r||[]);return o._invoke=function(e,t,n){var r=h;return function(a,o){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===a)throw o;return O()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var s=F(i,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?p:d,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(e,n,i),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",m={};function v(){}function y(){}function g(){}var w={};c(w,o,(function(){return this}));var k=Object.getPrototypeOf,b=k&&k(k(I([])));b&&b!==n&&r.call(b,o)&&(w=b);var x=g.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(a,o,i,s){var c=l(e[a],e,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,i,s)}),(function(e){n("throw",e,i,s)})):t.resolve(h).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,s)}))}s(c.arg)}var a;this._invoke=function(e,r){function o(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(o,o):o()}}function F(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,F(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=l(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function I(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}return{next:O}}function O(){return{value:t,done:!0}}return y.prototype=g,c(x,"constructor",g),c(g,"constructor",y),y.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,s,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},C(S.prototype),c(S.prototype,i,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new S(u(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},C(x),c(x,s,"Generator"),c(x,o,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=I,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return s.type="throw",s.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;A(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}return o}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,c,"next",e)}function c(e){a(i,r,o,s,c,"throw",e)}s(void 0)}))}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l,h,d,f,p,m,v=n(757),y=n.n(v),g="ID_NO_PASS_ERROR_MSG",w="ID_NO_APP_PASS_ERROR_MSG",k="ID_SET_BUTTON_BUY",b="ID_SET_BUTTON_SELL",x="ID_OFF",C="ID_READY",S="ID_LOCKED",F="ID_NOWALLET",E="ID_WALLET_SYNC_PROGRESS",A="ID_HIDE_ADDITIONAL_SETTINGS",R="ID_SHOW_ADDITIONAL_SETTINGS",I="ID_BUY",O="ID_SELL",D="ID_NOT_SUPPORTED",T="ID_CONNECTION_FAILED",L="ID_ORDER_PREVIEW",P="ID_CALCULATING",W="ID_ESTIMATE_UNAVAILABLE",B="ID_NO_ZERO_RATE",q="ID_NO_ZERO_QUANTITY",M="ID_TRADE",N="ID_NO_ASSET_WALLET",U="ID_EXECUTED",z="ID_BOOKED",j="ID_CANCELING",_="ID_PASSWORD_NOT_MATCH",V="ID_ACCT_UNDEFINED",H="ID_KEEP_WALLET_PASS",G="ID_NEW_WALLET_PASS",X="ID_LOT",Q="ID_LOTS",Y="ID_UNKNOWN",K="ID_EPOCH",Z="ID_SETTLING",J="ID_NO_MATCH",$="ID_CANCELED",ee="ID_REVOKED",te="ID_WAITING_FOR_CONFS",ne="ID_NONE_SELECTED",re="ID_REGISTRATION_FEE_SUCCESS",ae="ID_API_ERROR",oe="ID_ADD",ie="ID_CREATE",se="ID_SETUP_WALLET",ce="ID_WALLET_READY",ue="ID_CHANGE_WALLET_TYPE",le="ID_KEEP_WALLET_TYPE",he="WALLET_READY",de="SETUP_NEEDED",fe=(u(l={},g,"password cannot be empty"),u(l,w,"app password cannot be empty"),u(l,_,"passwords do not match"),u(l,k,"Place order to buy  {{ asset }}"),u(l,b,"Place order to sell {{ asset }}"),u(l,x,"off"),u(l,C,"ready"),u(l,S,"locked"),u(l,F,"no wallet"),u(l,E,"wallet is {{ syncProgress }}% synced"),u(l,A,"hide additional settings"),u(l,R,"show additional settings"),u(l,I,"Buy"),u(l,O,"Sell"),u(l,D,"{{ asset }} is not supported"),u(l,T,"Connection to dex server failed. You can close dexc and try again later or wait for it to reconnect."),u(l,L,"Total: {{ total }} {{ asset }}"),u(l,P,"calculating..."),u(l,W,"estimate unavailable"),u(l,B,"zero rate not allowed"),u(l,q,"zero quantity not allowed"),u(l,M,"trade"),u(l,N,"No {{ asset }} wallet"),u(l,U,"executed"),u(l,z,"booked"),u(l,j,"canceling"),u(l,V,"Account undefined."),u(l,H,"keep current wallet password"),u(l,G,"set a new wallet password"),u(l,X,"lot"),u(l,Q,"lots"),u(l,Y,"unknown"),u(l,K,"epoch"),u(l,Z,"settling"),u(l,J,"no match"),u(l,$,"canceled"),u(l,ee,"revoked"),u(l,te,"Waiting for confirmations..."),u(l,ne,"none selected"),u(l,re,"Registration fee payment successful!"),u(l,ae,"API error"),u(l,oe,"Add"),u(l,ie,"Create"),u(l,ce,"Ready"),u(l,se,"Setup"),u(l,ue,"change the wallet type"),u(l,le,"don't change the wallet type"),u(l,he,"Wallet Ready"),u(l,de,"Setup Needed"),l),pe=(u(h={},g,"senha não pode ser vazia"),u(h,w,"senha do app não pode ser vazia"),u(h,_,"senhas diferentes"),u(h,k,"Ordem de compra de {{ asset }}"),u(h,b,"Ordem de venda de {{ asset }}"),u(h,x,"desligar"),u(h,C,"pronto"),u(h,S,"trancado"),u(h,F,"sem carteira"),u(h,E,"carteira está {{ syncProgress }}% sincronizada"),u(h,A,"esconder configurações adicionais"),u(h,R,"mostrar configurações adicionais"),u(h,I,"Comprar"),u(h,O,"Vender"),u(h,D,"{{ asset }} não tem suporte"),u(h,T,"Conexão ao server dex falhou. Pode fechar dexc e tentar novamente depois ou esperar para tentar se reconectar."),u(h,L,"Total: {{ total }} {{ asset }}"),u(h,P,"calculando..."),u(h,W,"estimativa indisponível"),u(h,B,"taxa não pode ser zero"),u(h,q,"quantidade não pode ser zero"),u(h,M,"troca"),u(h,N,"Sem carteira {{ asset }}"),u(h,U,"executado"),u(h,z,"reservado"),u(h,j,"cancelando"),u(h,V,"conta não definida."),u(h,H,"manter senha da carteira"),u(h,G,"definir nova senha para carteira"),u(h,X,"lote"),u(h,Q,"lotes"),u(h,Y,"desconhecido"),u(h,K,"epoque"),u(h,Z,"assentando"),u(h,J,"sem combinações"),u(h,$,"cancelado"),u(h,ee,"revocado"),u(h,te,"Esperando confirmações..."),u(h,ne,"nenhuma selecionado"),u(h,re,"Sucesso no pagamento da taxa de registro!"),u(h,ae,"Erro de API"),u(h,oe,"Adicionar"),u(h,ie,"Criar"),u(h,ce,"Escolher"),u(h,se,"Configurar"),u(h,ue,"trocar o tipo de carteira"),u(h,le,"Não trocara tipo de carteira"),u(h,he,"Carteira Pronta"),u(h,de,"Configuração Necessária"),h),me=(u(d={},g,"密码不能为空"),u(d,w,"应用密码不能为空"),u(d,_,"密码不相同"),u(d,k,"来自{{ asset }}的买入订单"),u(d,b,"来自{{ asset }}的卖出订单"),u(d,x,"关闭"),u(d,C,"准备就绪"),u(d,S,"锁定"),u(d,F,"未连接钱包"),u(d,E,"钱包同步进度{{ syncProgress }}%"),u(d,A,"隐藏其它设置"),u(d,R,"显示其它设置"),u(d,I,"买"),u(d,O,"卖"),u(d,D,"{{ asset }}不受支持"),u(d,T,"连接到服务器 dex 失败。您可以关闭 dexc 并稍后重试或等待尝试重新连接。"),u(d,L,"总计： {{ total }} {{ asset }}"),u(d,P,"计算中..."),u(d,W,"估计不可用"),u(d,B,"汇率不能为零"),u(d,q,"数量不能为零"),u(d,M,"交易"),u(d,N,"没有钱包 {{ asset }}"),u(d,U,"执行"),u(d,z,"保留"),u(d,j,"取消"),u(d,V,"帐户未定义。"),u(d,H,"保留钱包密码"),u(d,G,"设置新的钱包密码"),u(d,X,"批处理"),u(d,Q,"批"),u(d,Y,"unknown"),u(d,K,"时间"),u(d,Z,"settling"),u(d,J,"no match"),u(d,$,"canceled"),u(d,ee,"revoked"),u(d,te,"Waiting for confirmations..."),u(d,ne,"none selected"),u(d,re,"Registration fee payment successful!"),u(d,ae,"接口错误"),u(d,oe,"加"),u(d,ie,"创建"),u(d,ce,"Choose Wallet"),u(d,se,"Setup"),d),ve=(u(f={},g,"hasło nie może być puste"),u(f,w,"hasło aplikacji nie może być puste"),u(f,_,"hasła nie są jednakowe"),u(f,k,"Złóż zlecenie, aby kupić  {{ asset }}"),u(f,b,"Złóż zlecenie, aby sprzedać {{ asset }}"),u(f,x,"wyłączony"),u(f,C,"gotowy"),u(f,S,"zablokowany"),u(f,F,"brak portfela"),u(f,E,"portfel zsynchronizowany w {{ syncProgress }}%"),u(f,A,"ukryj dodatkowe ustawienia"),u(f,R,"pokaż dodatkowe ustawienia"),u(f,I,"Kup"),u(f,O,"Sprzedaj"),u(f,D,"{{ asset }} nie jest wspierany"),u(f,T,"Połączenie z serwerem dex nie powiodło się. Możesz zamknąć dexc i spróbować ponownie później, lub poczekać na wznowienie połączenia."),u(f,L,"W sumie: {{ total }} {{ asset }}"),u(f,P,"obliczanie..."),u(f,W,"brak szacunkowego wyliczenia"),u(f,B,"zero nie może być ceną"),u(f,q,"zero nie może być ilością"),u(f,M,"handluj"),u(f,N,"Brak portfela {{ asset }}"),u(f,U,"wykonano"),u(f,z,"zapisano"),u(f,j,"anulowanie"),u(f,V,"Niezdefiniowane konto."),u(f,H,"zachowaj obecne hasło portfela"),u(f,G,"ustaw nowe hasło portfela"),u(f,X,"lot"),u(f,Q,"loty(ów)"),u(f,Y,"nieznane"),u(f,K,"epoka"),u(f,Z,"rozliczanie"),u(f,J,"brak spasowania"),u(f,$,"anulowano"),u(f,ee,"unieważniono"),u(f,te,"Oczekiwanie na potwierdzenia..."),u(f,ne,"brak zaznaczenia"),u(f,re,"Płatność rejestracyjna powiodła się!"),u(f,ae,"błąd API"),u(f,oe,"Dodaj"),u(f,ie,"Utwórz"),u(f,ce,"Gotowy"),u(f,se,"Konfiguracja"),u(f,ue,"zmień typ portfela"),u(f,le,"nie zmieniaj typu portfela"),u(f,he,"Portfel jest gotowy"),u(f,de,"Potrzebna konfiguracja"),f),ye=(u(p={},g,"Passwort darf nicht leer sein"),u(p,w,"App-Passwort darf nicht leer sein"),u(p,_,"Passwörter stimmen nicht überein"),u(p,k,"Platziere Auftrag zum Kauf von  {{ asset }}"),u(p,b,"Platziere Auftrag zum Verkauf von {{ asset }}"),u(p,x,"aus"),u(p,C,"bereit"),u(p,S,"gesperrt"),u(p,F,"kein Wallet"),u(p,E,"Wallet ist zu {{ syncProgress }}% synchronisiert"),u(p,A,"zusätzliche Einstellungen ausblenden"),u(p,R,"zusätzliche Einstellungen anzeigen"),u(p,I,"Kaufen"),u(p,O,"Verkaufen"),u(p,D,"{{ asset }} wird nicht unterstützt"),u(p,T,"Die Verbindung zum Dex-Server fehlgeschlagen. Du kannst dexc schließen und es später erneut versuchen oder warten bis die Verbindung wiederhergestellt ist."),u(p,L,"Insgesamt: {{ total }} {{ asset }}"),u(p,P,"kalkuliere..."),u(p,W,"Schätzung nicht verfügbar"),u(p,B,"Null-Satz nicht erlaubt"),u(p,q,"Null-Menge nicht erlaubt"),u(p,M,"Handel"),u(p,N,"Kein {{ asset }} Wallet"),u(p,U,"ausgeführt"),u(p,z,"gebucht"),u(p,j,"Abbruch"),u(p,V,"Account undefiniert."),u(p,H,"aktuelles Passwort für das Wallet behalten"),u(p,G,"ein neues Passwort für das Wallet festlegen"),u(p,X,"Lot"),u(p,Q,"Lots"),u(p,Y,"unbekannt"),u(p,K,"Epoche"),u(p,Z,"Abwicklung"),u(p,J,"kein Match"),u(p,$,"abgebrochen"),u(p,ee,"widerrufen"),u(p,te,"Warten auf Bestätigungen..."),u(p,ne,"keine ausgewählt"),u(p,re,"Zahlung der Registrierungsgebühr erfolgreich!"),u(p,ae,"API Fehler"),u(p,oe,"Hinzufügen"),u(p,ie,"Erstellen"),u(p,ce,"Bereit"),u(p,se,"Einrichten"),u(p,ue,"den Wallet-Typ ändern"),u(p,le,"den Wallet-Typ nicht ändern"),u(p,he,"Wallet bereit"),u(p,de,"Einrichtung erforderlich"),p),ge={"en-us":fe,"pt-br":pe,"zh-cn":me,"pl-pl":ve,"de-de":ye},we=fe;function ke(e,t){return function(e,t){return e.replace(/{{\s?([^{}\s]*)\s?}}/g,(function(e,n){return t[n]}))}(m[e]||we[e],t||{})}function be(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){s=!0,o=e})),f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.localeDiscrepancies=function(){for(var e=fe,t=0,n=Object.entries(ge);t<n.length;t++){var a=r(n[t],2),o=a[0],i=a[1];if(i!==e)for(var s=0,c=Object.entries(e);s<c.length;s++){var u=r(c[s],2),l=u[0],h=u[1];i[l]||console.log("".concat(o," needs a tranlation for: ").concat(h))}}};var Ce=new window.DOMParser,Se=Object.values({0:"btc",42:"dcr",2:"ltc",22:"mona",28:"vtc",3:"doge",145:"bch",60:"eth",133:"zec"}),Fe=new Intl.NumberFormat(navigator.languages),Ee={},Ae={};function Re(e){return Ie(Ae,e,e)}function Ie(e,t,n){var r="".concat(t,"-").concat(n),a=e[r];return a||(a=new Intl.NumberFormat(navigator.languages,{minimumFractionDigits:t,maximumFractionDigits:n}),e[r]=a),a}function Oe(e,t){var n=8;if(t){var r=t.conventional.conversionFactor;e/=r,n=Math.round(Math.log10(r))}return[e,n]}var De=function(){function e(){i(this,e)}var t;return c(e,null,[{key:"idel",value:function(e,t){return e.querySelector("#".concat(t))}},{key:"bind",value:function(e,t,n){e.addEventListener(t,n)}},{key:"unbind",value:function(e,t,n){e.removeEventListener(t,n)}},{key:"noderize",value:function(e){return Ce.parseFromString(e,"text/html")}},{key:"mouseInElement",value:function(e,t){var n=t.getBoundingClientRect();return e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom}},{key:"layoutMetrics",value:function(e){var t=e.getBoundingClientRect(),n=document.documentElement,r=t.top+n.scrollTop,a=t.left+n.scrollLeft,o=e.offsetWidth,i=e.offsetHeight;return{bodyTop:r,bodyLeft:a,width:o,height:i,centerX:a+o/2,centerY:r+i/2}}},{key:"empty",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)for(var o=a[r];o.firstChild;)o.removeChild(o.firstChild)}},{key:"hide",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++){var o=a[r];o.classList.add("d-hide")}}},{key:"show",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++){var o=a[r];o.classList.remove("d-hide")}}},{key:"isHidden",value:function(e){return e.classList.contains("d-hide")}},{key:"isDisplayed",value:function(e){return!e.classList.contains("d-hide")}},{key:"animate",value:(t=o(y().mark((function e(t,n,r){var a,o,i,s,c,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r?Te[r]:Te.linear,o=(new Date).getTime(),s=(i=o+t)-o,c=1e3/30,u=o;case 6:if(!(u<i)){e.next=13;break}return n(a((u-o)/s)),e.next=10,Pe(c);case 10:u=(new Date).getTime(),e.next=6;break;case 13:n(1);case 14:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"applySelector",value:function(e,t){return Array.from(e.querySelectorAll(t))}},{key:"kids",value:function(e){return Array.from(e.children)}},{key:"safeSelector",value:function(e,t){return e.querySelector(t)||(console.warn("no element found for selector '".concat(t,"' on element ->"),e),document.createElement("div"))}},{key:"idDescendants",value:function(t){var n,r={},a=be(e.applySelector(t,"[id]"));try{for(a.s();!(n=a.n()).done;){var o=n.value;r[o.id]=o}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"formatCoinValue",value:function(e,t){var n=r(Oe(e,t),2),a=n[0],o=n[1];return Number.isInteger(a)?Fe.format(a):function(e){return Ie(Ee,2,e)}(o).format(a)}},{key:"formatFullPrecision",value:function(e,t){var n=r(Oe(e,t),2),a=n[0];return Re(n[1]).format(a)}},{key:"formatFiatConversion",value:function(e,t,n){if(!t||0===t)return"unavailable";var a=r(Oe(e,n),1)[0]*t;return Re(2).format(a)}},{key:"logoPath",value:function(e){return-1===Se.indexOf(e)&&(e=e.substring(0,1)),"/img/coins/".concat(e,".png")}},{key:"cleanTemplates",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e.remove(),e.removeAttribute("id")}))}},{key:"tmplElement",value:function(e,t){return e.querySelector('[data-tmpl="'.concat(t,'"]'))||document.createElement("div")}},{key:"parseTemplate",value:function(t){var n,r={},a=be(e.applySelector(t,"[data-tmpl]"));try{for(a.s();!(n=a.n()).done;){var o=n.value;r[o.dataset.tmpl||""]=o}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"timeSince",value:function(t){return e.formatDuration((new Date).getTime()-t)}},{key:"formatDuration",value:function(e){var t,n,a,o,i,s,c=Math.floor(e),u="",l=0,h=function(e,t){return(e>0||l>0)&&l++,e>0&&(u+="".concat(e," ").concat(t," ")),l>=2},d=r(Ue(c,We),2);if(t=d[0],c=d[1],h(t,"y"))return u;var f=r(Ue(c,Be),2);if(n=f[0],c=f[1],h(n,"mo"))return u;var p=r(Ue(c,qe),2);if(a=p[0],c=p[1],h(a,"d"))return u;var m=r(Ue(c,Me),2);if(o=m[0],c=m[1],h(o,"h"))return u;var v=r(Ue(c,Ne),2);if(i=v[0],c=v[1],h(i,"m"))return u;var y=r(Ue(c,1e3),2);return s=y[0],c=y[1],h(s,"s"),u||"0 s"}},{key:"disableMouseWheel",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++){var o=a[r];o.addEventListener("wheel",(function(e){e.preventDefault()}))}}}]),e}(),Te={linear:function(e){return e},easeIn:function(e){return e*e},easeOut:function(e){return e*(2-e)},easeInHard:function(e){return e*e*e},easeOutHard:function(e){return--e*e*e+1}},Le=function(){function e(t){i(this,e),u(this,"icons",void 0),u(this,"status",void 0);var n=function(e){return t.querySelector("[data-state=".concat(e,"]"))};this.icons={},this.icons.sleeping=n("sleeping"),this.icons.locked=n("locked"),this.icons.unlocked=n("unlocked"),this.icons.nowallet=n("nowallet"),this.icons.syncing=n("syncing"),this.icons.nopeers=n("nopeers"),this.status=n("status")}return c(e,[{key:"sleeping",value:function(){var e=this.icons;De.hide(e.locked,e.unlocked,e.nowallet,e.syncing),De.show(e.sleeping),this.status&&(this.status.textContent=ke(x))}},{key:"locked",value:function(){var e=this.icons;De.hide(e.unlocked,e.nowallet,e.sleeping),De.show(e.locked),this.status&&(this.status.textContent=ke(S))}},{key:"unlocked",value:function(){var e=this.icons;De.hide(e.locked,e.nowallet,e.sleeping),De.show(e.unlocked),this.status&&(this.status.textContent=ke(C))}},{key:"nowallet",value:function(){var e=this.icons;De.hide(e.locked,e.unlocked,e.sleeping,e.syncing),De.show(e.nowallet),this.status&&(this.status.textContent=ke(F))}},{key:"setSyncing",value:function(e){var t=this.icons.syncing;if(e&&e.running){if(0===e.peerCount)return De.show(this.icons.nopeers),void De.hide(t);if(De.hide(this.icons.nopeers),!e.synced)return De.show(t),void(t.dataset.tooltip=ke(E,{syncProgress:(100*e.syncProgress).toFixed(1)}));De.hide(t)}else De.hide(t)}},{key:"readWallet",value:function(e){if(this.setSyncing(e),!e)return this.nowallet();switch(!0){case!e.running:this.sleeping();break;case!e.open:this.locked();break;case e.open:this.unlocked();break;default:console.error("wallet in unknown state",e)}}}]),e}();function Pe(e){return new Promise((function(t){return setTimeout(t,e)}))}var We=31536e6,Be=2592e6,qe=864e5,Me=36e5,Ne=6e4;function Ue(e,t){var n=Math.floor(e/t);return[n,e-n*t]}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var je="darkMode",_e="popups",Ve=function(){function e(){i(this,e)}return c(e,null,[{key:"setCookie",value:function(e,t){var n=new Date;n.setTime(n.getTime()+31536e7);var r="expires="+n.toUTCString();document.cookie=e+"="+t+";"+r+";path=/"}},{key:"getCookie",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}(document.cookie.split(";"));try{for(n.s();!(t=n.n()).done;){var a=r(t.value.split("="),2),o=a[0],i=a[1];if(o.trim()===e)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"dark",value:function(e){this.setCookie(je,e?"1":"0"),e?document.body.classList.add("dark"):document.body.classList.remove("dark")}},{key:"isDark",value:function(){return document.cookie.split(";").filter((function(e){return e.includes("".concat(je,"=1"))})).length}},{key:"passwordIsCached",value:function(){return!!this.getCookie("sessionkey")}},{key:"store",value:function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}},{key:"clearAllStore",value:function(){window.localStorage.clear()}},{key:"removeAuthCK",value:function(){document.cookie="".concat("dexauth","=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")}},{key:"fetch",value:function(e){var t=window.localStorage.getItem(e);return null!==t?JSON.parse(t):null}}]),e}();function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e,t){return Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ge(e,t)}function Xe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ge(e,t)}function Qe(e){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(e)}function Ye(e,t){if(t&&("object"===Qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return He(e)}function Ke(e){return Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ke(e)}null===Ve.getCookie(je)&&Ve.setCookie(je,"1"),null===Ve.getCookie(_e)&&Ve.setCookie(_e,"1");var Ze,Je,$e=function(){function e(){i(this,e)}return c(e,[{key:"unload",value:function(){}}]),e}();function et(e,t,n){return tt.apply(this,arguments)}function tt(){return(tt=o(y().mark((function e(t,n,r){var a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.fetch(n,{method:t,headers:new window.Headers({"content-type":"application/json"}),body:r});case 3:if(200===(a=e.sent).status){e.next=6;break}throw a;case 6:return e.next=8,a.json();case 8:return(o=e.sent).requestSuccessful=!0,e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(0),e.t0.requestSuccessful=!1,e.next=18,e.t0.text();case 18:return e.t0.msg=e.sent,e.abrupt("return",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function nt(e,t){return rt.apply(this,arguments)}function rt(){return(rt=o(y().mark((function e(t,n){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",et("POST",t,JSON.stringify(n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function at(e){return ot.apply(this,arguments)}function ot(){return(ot=o(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",et("GET",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function it(n){return function(t){if(Array.isArray(t))return e(t)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||t(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(){return Je}function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ke(e);if(t){var a=Ke(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ye(this,n)}}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected",e[e.InvalidCert=2]="InvalidCert"}(Ze||(Ze={}));var lt,ht,dt,ft=1e8;function pt(e){return e.sell?"sell":"buy"}function mt(e){return 1===e.type?0===e.tif?"limit (i)":"limit":"market"}function vt(e){return 2===e.type&&!e.sell}function yt(e){if(!e.matches)return!1;var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}(e.matches);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!r.revoked&&r.status<3)return!0}}catch(e){n.e(e)}finally{n.f()}return!1}function gt(e){var t=yt(e);switch(e.status){case 0:return ke(Y);case 1:return ke(K);case 2:return e.cancelling?ke(j):t?"".concat(ke(z),"/").concat(ke(Z)):ke(z);case 3:return t?ke(Z):0===e.filled?ke(J):ke(U);case 4:return t?"".concat(ke($),"/").concat(ke(Z)):ke($);case 5:return t?"".concat(ke(ee),"/").concat(ke(Z)):ke(ee)}return""}function wt(e){if(!e.matches)return 0;var t=vt(e)?function(e){return e.qty*e.rate/ft}:function(e){return e.qty};return e.matches.reduce((function(e,n){return n.isCancel?e:e+t(n)}),0)}function kt(e){if(!e.matches)return 0;var t=vt(e)?function(e){return e.qty*e.rate/ft}:function(e){return e.qty};return e.matches.reduce((function(e,n){return n.isCancel?e:0===n.side&&n.status>=3||1===n.side&&n.status>=4?e+t(n):e}),0)}function bt(e){var t=[e.booleanOptTmpl,e.rangeOptTmpl,e.orderOptTmpl];ht=t[0],dt=t[1],lt=t[2]}var xt=function(){function e(t,n,r,a){var o=this;i(this,e),u(this,"opt",void 0),u(this,"order",void 0),u(this,"node",void 0),u(this,"tmpl",void 0),u(this,"on",void 0),this.opt=t,this.order=n;var s=this.node=lt.cloneNode(!0),c=this.tmpl=De.parseTemplate(s);c.optName.textContent=t.displayname,c.tooltip.dataset.tooltip=t.description;var l=r&&n.sell||!r&&!n.sell?this.baseSymbol():this.quoteSymbol();c.chainIcon.src=De.logoPath(l),this.on=!1,De.bind(s,"click",(function(){o.on||(o.on=!0,s.classList.add("selected"),a.enable())})),De.bind(c.toggle,"click",(function(e){o.on&&(e.stopPropagation(),o.on=!1,s.classList.remove("selected"),a.disable())}))}return c(e,[{key:"quoteSymbol",value:function(){return At(this.order.host,this.order.quote)}},{key:"baseSymbol",value:function(){return At(this.order.host,this.order.base)}}]),e}(),Ct=function(e){Xe(n,e);var t=ct(n);function n(e,r,a,o){var s;i(this,n),u(He(s=t.call(this,e,r,o,{enable:function(){return s.enable()},disable:function(){return s.disable()}})),"control",void 0),u(He(s),"changed",void 0),s.changed=function(){return a()};var c=e.boolean,l=s.control=ht.cloneNode(!0);return s.tmpl.controls.appendChild(l),De.parseTemplate(l).reason.textContent=c.reason,s.on=void 0!==r.options[e.key]?r.options[e.key]:e.default,s.on&&s.node.classList.add("selected"),s}return c(n,[{key:"store",value:function(){this.on===this.opt.default?delete this.order.options[this.opt.key]:this.order.options[this.opt.key]=this.on,this.changed()}},{key:"enable",value:function(){this.store()}},{key:"disable",value:function(){this.store()}}]),n}(xt),St=function(e){Xe(n,e);var t=ct(n);function n(e,r,a,o){var s;i(this,n),u(He(s=t.call(this,e,r,o,{enable:function(){return s.enable()},disable:function(){return s.disable()}})),"handler",void 0),u(He(s),"x",void 0),u(He(s),"changed",void 0),s.changed=a;var c=e.xyRange,l=r.options[e.key];return s.on=void 0!==l,s.on?(s.node.classList.add("selected"),s.x=l):s.x=e.default,s.handler=new Ft(c,s.x,(function(e){s.x=e,s.order.options[s.opt.key]=e}),(function(){s.changed()}),(function(){s.node.classList.add("selected")})),s.tmpl.controls.appendChild(s.handler.control),s}return c(n,[{key:"enable",value:function(){this.order.options[this.opt.key]=this.x,this.changed()}},{key:"disable",value:function(){delete this.order.options[this.opt.key],this.changed()}}]),n}(xt),Ft=c((function e(t,n,r,a,o,s){var c=this;i(this,e),u(this,"control",void 0),u(this,"x",void 0),u(this,"updated",void 0),u(this,"changed",void 0),u(this,"selected",void 0);var l=this.control=dt.cloneNode(!0),h=De.parseTemplate(l);this.changed=a,this.selected=o,this.updated=r;var d=h.slider,f=h.handle,p=t.end.x-t.start.x,m=t.end.y-t.start.y,v=function(e){return(e-t.start.x)/p},y=v(n),g=this.x=n,w=y*m+t.start.y,k=new Intl.NumberFormat(navigator.languages,{minimumSignificantDigits:3,maximumSignificantDigits:3}),b=function(e){s&&(w=Math.round(w)),h.x.textContent=k.format(g),h.y.textContent=k.format(w),s&&(h.y.textContent="".concat(w)),f.style.left="calc(".concat(100*y,"% - ").concat(14*y,"px)"),c.x=g,e||c.updated(g,w)},x=function e(n){if("change"===n.type||n.target!==h.xInput){var r=h.xInput.value;if(r){var a=parseFloat(r);isNaN(a)||(g=Rt(a,t.start.x,t.end.x),y=v(g),w=y*m+t.start.y,b())}De.hide(h.xInput),De.show(h.x),De.unbind(document,"click",e),c.changed()}};De.bind(h.x,"click",(function(e){De.hide(h.x),De.show(h.xInput),h.xInput.focus(),h.xInput.value=k.format(g),De.bind(document,"click",x),e.stopPropagation()})),De.bind(h.xInput,"change",x);var C=function e(n){if("change"===n.type||n.target!==h.yInput){var r=h.yInput.value;if(r){var a=parseFloat(r);isNaN(a)||(w=Rt(a,t.start.y,t.end.y),y=(w-t.start.y)/m,g=t.start.x+y*p,b())}De.hide(h.yInput),De.show(h.y),De.unbind(document,"click",e),c.changed()}};De.bind(h.y,"click",(function(e){De.hide(h.y),De.show(h.yInput),h.yInput.focus(),h.yInput.value=k.format(w),De.bind(document,"click",C),e.stopPropagation()})),De.bind(h.yInput,"change",C),De.bind(f,"mousedown",(function(e){if(0===e.button){e.preventDefault(),c.selected();var n=e.pageX,r=d.clientWidth-f.offsetWidth,a=v(g)*r,o=function(e){e.preventDefault(),y=function(e){return Math.max(Math.min(a+(e.pageX-n),r),0)}(e)/r,g=y*p+t.start.x,w=y*m+t.start.y,b()};De.bind(document,"mousemove",o),De.bind(document,"mouseup",(function e(t){o(t),De.unbind(document,"mousemove",o),De.unbind(document,"mouseup",e),c.changed()}))}})),h.rangeLblStart.textContent=t.start.label,h.rangeLblEnd.textContent=t.end.label,h.xUnit.textContent=t.xUnit,h.yUnit.textContent=t.yUnit,b(!0)}));function Et(e,t,n,r){switch(!0){case!!e.boolean:return new Ct(e,t,n,r).node;case!!e.xyRange:return new St(e,t,n,r).node;default:console.error("no option type specified",e)}return console.error("unknown option type",e),document.createElement("div")}function At(e,t){return st().exchanges[e].assets[t].symbol}var Rt=function(e,t,n){return e<t?t:e>n?n:e};function It(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ot(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){s=!0,o=e})),f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dt=function(){function e(t,n,r,a){var o=this;i(this,e),u(this,"page",void 0),u(this,"form",void 0),u(this,"pwCache",void 0),u(this,"success",void 0),u(this,"currentAsset",void 0),u(this,"pwHiders",void 0),u(this,"subform",void 0),u(this,"currentWalletType",void 0),this.form=t,this.success=n,this.pwCache=r||null;var s=this.page=De.parseTemplate(t);this.pwHiders=Array.from(t.querySelectorAll(".hide-pw")),this.refresh(),a&&(De.show(s.goBack),De.bind(s.goBack,"click",(function(){a()}))),De.empty(s.walletTabTmpl),s.walletTabTmpl.removeAttribute("id"),this.subform=new Tt(s.walletSettings,!0),De.bind(this.subform.showOther,"click",(function(){return De.show(s.walletSettingsHeader)})),_t(t,s.submitAdd,(function(){return o.submit()})),_t(t,s.oneBttn,(function(){return o.submit()}))}var t,n,r,a,s;return c(e,[{key:"refresh",value:function(){Ve.passwordIsCached()||this.pwCache&&this.pwCache.pw?De.hide.apply(De,it(this.pwHiders)):De.show.apply(De,it(this.pwHiders))}},{key:"submit",value:(s=o(y().mark((function e(){var t,n,r,a,o,i,s,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=t.appPass,r=t.newWalletPass,(a=n.value||(this.pwCache?this.pwCache.pw:""))||Ve.passwordIsCached()){e.next=8;break}return t.newWalletErr.textContent=ke(w),De.show(t.newWalletErr),e.abrupt("return");case 8:return De.hide(t.newWalletErr),o=this.currentAsset.id,i={assetID:o,pass:r.value||"",config:this.subform.map(),appPass:a,walletType:this.currentWalletType},n.value="",s=st().loading(t.mainForm),e.next=15,nt("/api/newwallet",i);case 15:if(c=e.sent,s(),st().checkResponse(c)){e.next=20;break}return this.setError(c.msg),e.abrupt("return");case 20:this.pwCache&&(this.pwCache.pw=a),r.value="",this.success(o);case 23:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"setAsset",value:(a=o(y().mark((function e(t){var n,r,a,o,i,s,c,u=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=st().assets[t],a=n.walletTypeTabs,!this.currentAsset||this.currentAsset.id!==r.id){e.next=5;break}return e.abrupt("return");case 5:if(this.currentAsset=r,n.assetLogo.src=De.logoPath(r.symbol),n.assetName.textContent=r.info.name,n.newWalletPass.value="",r.info.availablewallets.length>1?n.header.classList.add("bordertop"):n.header.classList.remove("bordertop"),o=r.info.availablewallets[0],De.empty(a),De.hide(a,n.newWalletErr),r.info.availablewallets.length>1){De.show(a),i=It(r.info.availablewallets);try{for(c=function(){var e=s.value,t=n.walletTabTmpl.cloneNode(!0);t.dataset.tooltip=e.description,t.textContent=e.tab,a.appendChild(t),De.bind(t,"click",(function(){var n,r=It(De.kids(a));try{for(r.s();!(n=r.n()).done;)n.value.classList.remove("selected")}catch(e){r.e(e)}finally{r.f()}t.classList.add("selected"),u.update(e)}))},i.s();!(s=i.n()).done;)c()}catch(e){i.e(e)}finally{i.f()}st().bindTooltips(a),a.firstChild.classList.add("selected")}return e.next=16,this.update(o);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"update",value:(r=o(y().mark((function e(t){var n,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentWalletType=t.type,r=Ve.passwordIsCached()||this.pwCache&&this.pwCache.pw,De.hide(n.auth,n.oneBttnBox,n.newWalletPassBox),(a=t.configopts||[]).map((function(e){return e.isBirthdayConfig&&st().seedGenTime>0&&(e.default=Vt(new Date)),e})),r&&t.seeded?De.show(n.oneBttnBox):t.seeded?(De.show(n.auth),n.newWalletPass.value="",n.submitAdd.textContent=ke(ie)):(De.show(n.auth),t.noauth||De.show(n.newWalletPassBox),n.submitAdd.textContent=ke(oe)),this.subform.update(a),this.subform.dynamicOpts.children.length?De.show(n.walletSettingsHeader):De.hide(n.walletSettingsHeader),this.refresh(),e.next=12,this.loadDefaults();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setError",value:(n=o(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.page.newWalletErr.textContent=t,De.show(this.page.newWalletErr);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"loadDefaults",value:(t=o(y().mark((function e(){var t,n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=st().walletDefinition(this.currentAsset.id,this.currentWalletType)).seeded){e.next=3;break}return e.abrupt("return");case 3:if(""!==t.configpath){e.next=5;break}return e.abrupt("return");case 5:return n=st().loading(this.form),e.next=8,nt("/api/defaultwalletcfg",{assetID:this.currentAsset.id,type:this.currentWalletType});case 8:if(r=e.sent,n(),st().checkResponse(r)){e.next=13;break}return this.setError(r.msg),e.abrupt("return");case 13:this.subform.setLoadedConfig(r.config);case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Tt=function(){function e(t,n){var r=this;i(this,e),u(this,"form",void 0),u(this,"configElements",void 0),u(this,"configOpts",void 0),u(this,"sectionize",void 0),u(this,"allSettings",void 0),u(this,"dynamicOpts",void 0),u(this,"textInputTmpl",void 0),u(this,"dateInputTmpl",void 0),u(this,"checkboxTmpl",void 0),u(this,"fileSelector",void 0),u(this,"fileInput",void 0),u(this,"errMsg",void 0),u(this,"showOther",void 0),u(this,"showIcon",void 0),u(this,"hideIcon",void 0),u(this,"showHideMsg",void 0),u(this,"otherSettings",void 0),u(this,"loadedSettingsMsg",void 0),u(this,"loadedSettings",void 0),u(this,"defaultSettingsMsg",void 0),u(this,"defaultSettings",void 0),this.form=t,this.configElements={},this.configOpts=[],this.sectionize=n,this.allSettings=De.tmplElement(t,"allSettings"),this.dynamicOpts=De.tmplElement(t,"dynamicOpts"),this.textInputTmpl=De.tmplElement(t,"textInput"),this.textInputTmpl.remove(),this.dateInputTmpl=De.tmplElement(t,"dateInput"),this.dateInputTmpl.remove(),this.checkboxTmpl=De.tmplElement(t,"checkbox"),this.checkboxTmpl.remove(),this.fileSelector=De.tmplElement(t,"fileSelector"),this.fileInput=De.tmplElement(t,"fileInput"),this.errMsg=De.tmplElement(t,"errMsg"),this.showOther=De.tmplElement(t,"showOther"),this.showIcon=De.tmplElement(t,"showIcon"),this.hideIcon=De.tmplElement(t,"hideIcon"),this.showHideMsg=De.tmplElement(t,"showHideMsg"),this.otherSettings=De.tmplElement(t,"otherSettings"),this.loadedSettingsMsg=De.tmplElement(t,"loadedSettingsMsg"),this.loadedSettings=De.tmplElement(t,"loadedSettings"),this.defaultSettingsMsg=De.tmplElement(t,"defaultSettingsMsg"),this.defaultSettings=De.tmplElement(t,"defaultSettings"),n||De.hide(this.showOther),De.bind(this.fileSelector,"click",(function(){return r.fileInput.click()})),De.bind(this.fileInput,"change",o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.fileInputChanged());case 1:case"end":return e.stop()}}),e)})))),De.bind(this.showOther,"click",(function(){r.setOtherSettingsViz(r.hideIcon.classList.contains("d-hide"))}))}var t;return c(e,[{key:"fileInputChanged",value:(t=o(y().mark((function e(){var t,n,r,a,o,i,s,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(De.hide(this.errMsg),this.fileInput.value){e.next=3;break}return e.abrupt("return");case 3:if((n=this.fileInput.files)&&0!==n.length){e.next=6;break}return e.abrupt("return");case 6:return r=st().loading(this.form),e.next=9,n[0].text();case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,nt("/api/parseconfig",{configtext:a});case 14:if(o=e.sent,r(),st().checkResponse(o)){e.next=20;break}return this.errMsg.textContent=o.msg,De.show(this.errMsg),e.abrupt("return");case 20:if(0!==Object.keys(o.map).length){e.next=22;break}return e.abrupt("return");case 22:(t=this.dynamicOpts).append.apply(t,it(this.setConfig(o.map))),this.reorder(this.dynamicOpts),i=[this.loadedSettings.children.length,this.defaultSettings.children.length],c=i[1],0===(s=i[0])&&De.hide(this.loadedSettings,this.loadedSettingsMsg),0===c&&De.hide(this.defaultSettings,this.defaultSettingsMsg),s+c===0&&De.hide(this.showOther,this.otherSettings);case 28:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"update",value:function(e,t){var n=this;if(this.configElements={},this.configOpts=e,De.empty(this.dynamicOpts,this.defaultSettings,this.loadedSettings),0===e.length)return De.hide(this.form);De.show(this.form),this.setOtherSettingsViz(!1),De.hide(this.loadedSettingsMsg,this.loadedSettings,this.defaultSettingsMsg,this.defaultSettings,this.errMsg);var r,a=[],o=function(e,r){var a,o="wcfg-"+r.key;a=r.isboolean?n.checkboxTmpl.cloneNode(!0):r.isdate?n.dateInputTmpl.cloneNode(!0):n.textInputTmpl.cloneNode(!0),n.configElements[r.key]=a;var i=a.querySelector("input");i.id=o,i.configOpt=r;var s=De.safeSelector(a,"label");if(s.htmlFor=o,s.prepend(r.displayname),e.appendChild(a),r.noecho&&(i.type="password",i.autocomplete="off"),r.description&&(s.dataset.tooltip=r.description),r.isboolean)i.checked=r.default;else if(r.isdate){var c=function(e){return e?("now"===e?new Date:new Date(1e3*e)).toISOString().split("T")[0]:""};i.max=c(r.max),i.min=c(r.min),i.valueAsDate=r.default?new Date(1e3*r.default):new Date}else i.value=null!==r.default?r.default:"";i.disabled=Boolean(r.disablewhenactive&&t)},i=It(this.configOpts);try{for(i.s();!(r=i.n()).done;){var s=r.value;this.sectionize&&null!==s.default?a.push(s):o(this.dynamicOpts,s)}}catch(e){i.e(e)}finally{i.f()}if(a.length){var c,u=It(a);try{for(u.s();!(c=u.n()).done;){var l=c.value;o(this.defaultSettings,l)}}catch(e){u.e(e)}finally{u.f()}De.show(this.showOther,this.defaultSettingsMsg,this.defaultSettings)}else De.hide(this.showOther);st().bindTooltips(this.allSettings),this.dynamicOpts.children.length?De.show(this.dynamicOpts):De.hide(this.dynamicOpts)}},{key:"setOtherSettingsViz",value:function(e){if(e)return De.hide(this.showIcon),De.show(this.hideIcon,this.otherSettings),void(this.showHideMsg.textContent=ke(A));De.hide(this.hideIcon,this.otherSettings),De.show(this.showIcon),this.showHideMsg.textContent=ke(R)}},{key:"setConfig",value:function(e){var t=this,n=[];return this.allSettings.querySelectorAll("input").forEach((function(r){var a,o=r.configOpt.key,i=e[o];void 0!==i&&(n.push(t.configElements[o]),r.configOpt.isboolean?r.checked="1"===(a=i)||"true"===a.toLowerCase():r.configOpt.isdate?r.valueAsDate=new Date(1e3*parseInt(i)):r.value=i)})),n}},{key:"setLoadedConfig",value:function(e){var t,n=this.setConfig(e);this.sectionize&&0!==n.length&&((t=this.loadedSettings).append.apply(t,it(n)),this.reorder(this.loadedSettings),De.show(this.loadedSettings,this.loadedSettingsMsg),0===this.defaultSettings.children.length&&De.hide(this.defaultSettings,this.defaultSettingsMsg))}},{key:"map",value:function(){var e={};return this.allSettings.querySelectorAll("input").forEach((function(t){if(t.configOpt.isboolean&&t.configOpt.key)e[t.configOpt.key]=t.checked?"1":"0";else if(t.configOpt.isdate&&t.configOpt.key){var n=t.min?Vt(new Date(t.min)):Number.MIN_SAFE_INTEGER,r=t.max?Vt(new Date(t.max)):Number.MAX_SAFE_INTEGER,a=t.value?Vt(new Date(t.value)):0;a<n?a=n:a>r&&(a=r),e[t.configOpt.key]=""+a}else t.value&&(e[t.configOpt.key]=t.value)})),e}},{key:"reorder",value:function(e){var t=this,n={};e.querySelectorAll("input").forEach((function(e){var r=e.configOpt.key;n[r]=t.configElements[r]}));var r,a=It(this.configOpts);try{for(a.s();!(r=a.n()).done;){var o=r.value,i=n[o.key];i&&e.append(i)}}catch(e){a.e(e)}finally{a.f()}}}]),e}(),Lt=function(){function e(t,n,r,a){var o=this;i(this,e),u(this,"form",void 0),u(this,"success",void 0),u(this,"page",void 0),u(this,"xc",void 0),u(this,"certFile",void 0),u(this,"feeAssetID",void 0),u(this,"pwCache",void 0),this.form=t,this.success=n,this.page=De.parseTemplate(t),this.certFile="",this.pwCache=a,De.bind(this.page.goBack,"click",(function(){return r()})),_t(t,this.page.submit,(function(){return o.submitForm()}))}var t,n;return c(e,[{key:"setExchange",value:function(e,t){this.xc=e,this.certFile=t;var n=this.page;Ve.passwordIsCached()||this.pwCache&&this.pwCache.pw?De.hide(n.passBox):De.show(n.passBox),n.host.textContent=e.host}},{key:"setAsset",value:function(e){var t=st().assets[e],n=t.info.unitinfo;this.feeAssetID=t.id;var r=this.page,a=this.xc.regFees[t.symbol];r.fee.textContent=De.formatCoinValue(a.amount,n),r.feeUnit.textContent=n.conventional.unit.toUpperCase(),r.logo.src=De.logoPath(t.symbol)}},{key:"animate",value:(n=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,De.animate(400,(function(e){t.style.transform="scale(".concat(e,")"),t.style.opacity=String(Math.pow(e,4));var n="".concat(500*(1-e),"px");t.style.top=n,t.style.left=n}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"submitForm",value:(t=o(y().mark((function e(){var t,n,r,a,o,i,s,c,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.page).submit.classList.contains("selected")){e.next=3;break}return e.abrupt("return");case 3:if(null!==this.feeAssetID){e.next=7;break}return t.regErr.innerText="You must select a valid wallet for the fee payment",De.show(t.regErr),e.abrupt("return");case 7:return n=st().user.assets[this.feeAssetID].wallet.symbol,De.hide(t.regErr),r=this.xc.regFees[n],e.next=12,this.certFile;case 12:return a=e.sent,o=this.xc.host,i=t.appPass.value||(this.pwCache?this.pwCache.pw:""),s={addr:o,pass:i,fee:r.amount,asset:r.id,cert:a},t.appPass.value="",c=st().loading(this.form),e.next=20,nt("/api/register",s);case 20:if(u=e.sent,c(),st().checkResponse(u)){e.next=26;break}return t.regErr.textContent=u.msg,De.show(t.regErr),e.abrupt("return");case 26:this.success();case 27:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Pt=function(){function e(t,n){i(this,e),u(this,"form",void 0),u(this,"success",void 0),u(this,"xc",void 0),u(this,"page",void 0),this.form=t,this.success=n,this.page=De.parseTemplate(t),De.cleanTemplates(this.page.marketTmpl,this.page.assetTmpl)}var t;return c(e,[{key:"setExchange",value:function(e){var t=this;this.xc=e;var n=this.page;De.empty(n.assets,n.allMarkets);for(var a=function(e){return e.conventional.conversionFactor},o=function(t,r){var o=n.marketTmpl.cloneNode(!0),i=De.parseTemplate(o),s=e.assets[t.baseid],c=st().unitInfo(t.baseid,e),u=e.assets[t.quoteid],l=st().unitInfo(t.quoteid,e);if(0===a(c)||0===a(l))return null;if(void 0!==r){var h=r===t.baseid,d=e.assets[h?t.quoteid:t.baseid].symbol;i.logo.src=De.logoPath(d)}else{var f=i.logo.cloneNode(!0);i.logo.src=De.logoPath(s.symbol),f.src=De.logoPath(u.symbol);var p=i.logo.parentNode;p&&p.insertBefore(f,i.logo.nextSibling)}var m=s.symbol.toUpperCase(),v=u.symbol.toUpperCase();i.name.textContent="".concat(m,"-").concat(v);var y=De.formatCoinValue(t.lotsize,c);if(i.lotSize.textContent="".concat(y," ").concat(m),t.spot){De.show(i.quoteLotSize);var g=a(l)/a(c),w=t.lotsize*t.spot.rate/ft*g,k=De.formatCoinValue(w,l);i.quoteLotSize.textContent="(~".concat(k," ").concat(v,")")}return o},i=function(){var a=r(c[s],2),i=a[0],u=a[1],l=st().assets[u.id];if(!l)return"continue";var h=l.wallet,d=l.info.unitinfo,f=n.assetTmpl.cloneNode(!0);De.bind(f,"click",(function(){t.success(u.id)}));var p=De.parseTemplate(f);n.assets.appendChild(f),p.logo.src=De.logoPath(i);var m=De.formatCoinValue(u.amount,d);p.fee.textContent="".concat(m," ").concat(d.conventional.unit),p.confs.textContent=String(u.confs),p.ready.textContent=ke(h?he:de),p.ready.classList.add(h?"readygreen":"setuporange");for(var v=0,y=0,g=Object.values(e.markets);y<g.length;y++){var w=g[y];if(w.baseid===u.id||w.quoteid===u.id){var k=o(w,u.id);k&&(v++,p.markets.appendChild(k))}}v<3&&De.hide(p.fader)},s=0,c=Object.entries(e.regFees);s<c.length;s++)i();n.host.textContent=e.host;for(var u=0,l=Object.values(e.markets);u<l.length;u++){var h=l[u],d=o(h);d&&n.allMarkets.appendChild(d)}}},{key:"refresh",value:function(){this.setExchange(this.xc)}},{key:"animate",value:(t=o(y().mark((function e(){var t,n,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.form,r=t.how,(a=Array.from(t.assets.children)).push(t.allmkts),n.style.opacity="0",e.next=11,De.animate(350,(function(e){var t,o=It(a);try{for(o.s();!(t=o.n()).done;){var i=t.value;i.style.marginTop="".concat(75*(1-e),"px"),i.style.transform="scale(".concat(e,")")}}catch(e){o.e(e)}finally{o.f()}n.style.opacity=Math.pow(e,4).toFixed(1),n.style.paddingTop="".concat(50*(1-e),"px"),r.style.fontSize="".concat(24*e,"px")}),"easeOut");case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Wt=function(){function e(t,n,r){var a=this;i(this,e),u(this,"form",void 0),u(this,"success",void 0),u(this,"goBack",void 0),u(this,"page",void 0),u(this,"assetID",void 0),u(this,"xc",void 0),u(this,"regFee",void 0),u(this,"progressCache",void 0),u(this,"progressed",void 0),u(this,"funded",void 0),this.form=t,this.success=n,this.page=De.parseTemplate(t),this.assetID=-1,this.progressCache=[],this.progressed=!1,this.funded=!1,De.bind(this.page.goBack,"click",(function(){a.assetID=-1,r()})),st().registerNoteFeeder({walletstate:function(e){return a.reportWalletState(e.wallet)},balance:function(e){return a.reportBalance(e.balance,e.assetID)}})}return c(e,[{key:"setExchange",value:function(e){this.xc=e}},{key:"setWallet",value:function(e,t){this.assetID=e.assetID,this.progressCache=[],this.progressed=!1,this.funded=!1;var n,r=this.page,a=st().assets[e.assetID],o=this.regFee=this.xc.regFees[a.symbol],i=It(De.applySelector(this.form,".unit"));try{for(i.s();!(n=i.n()).done;)n.value.textContent=a.symbol.toUpperCase()}catch(e){i.e(e)}finally{i.f()}r.logo.src=De.logoPath(a.symbol),r.depoAddr.textContent=e.address,r.fee.textContent=De.formatCoinValue(o.amount,a.info.unitinfo),De.hide(r.syncUncheck,r.syncCheck,r.balUncheck,r.balCheck,r.syncRemainBox),De.show(r.balanceBox),t>0?(r.totalFees.textContent=De.formatCoinValue(o.amount+t,a.info.unitinfo),De.show(r.sendEnoughWithEst),De.hide(r.sendEnough)):(De.show(r.sendEnough),De.hide(r.sendEnoughWithEst)),De.show(e.synced?r.syncCheck:e.syncProgress>=1?r.syncSpinner:r.syncUncheck),De.show(e.balance.available>o.amount?r.balCheck:r.balUncheck),r.progress.textContent=String(Math.round(100*e.syncProgress)),e.synced&&(this.progressed=!0),this.reportBalance(e.balance,e.assetID)}},{key:"reportWalletState",value:function(e){e.assetID===this.assetID&&(this.progressed&&this.funded||(this.reportProgress(e.synced,e.syncProgress),this.reportBalance(e.balance,e.assetID)))}},{key:"reportBalance",value:function(e,t){if(!this.funded&&-1!==this.assetID&&this.assetID===t){var n=this.page,r=st().assets[this.assetID];e.available<=this.regFee.amount?n.balance.textContent=De.formatCoinValue(e.available,r.info.unitinfo):(De.show(n.balCheck),De.hide(n.balUncheck,n.balanceBox,n.sendEnough),this.funded=!0,this.progressed&&this.success())}}},{key:"reportProgress",value:function(e,t){var n=this.page;if(e)return n.progress.textContent="100",De.hide(n.syncUncheck,n.syncRemainBox,n.syncSpinner),De.show(n.syncCheck),this.progressed=!0,void(this.funded&&this.success());1===t?(De.hide(n.syncUncheck),De.show(n.syncSpinner)):(De.hide(n.syncSpinner),De.show(n.syncUncheck)),n.progress.textContent=String(Math.round(100*t));var r=this.progressCache;for(r.push({stamp:(new Date).getTime(),progress:t});r.length>20;)r.shift();if(1!==r.length){De.show(n.syncRemainBox);var a=[r[0],r[r.length-1]],o=a[0],i=a[1],s=i.progress-o.progress;if(0!==s){var c=s/(i.stamp-o.stamp),u=(1-i.progress)/c;n.syncRemain.textContent=De.formatDuration(u)}else n.syncRemain.textContent="> 1 day"}}}]),e}(),Bt=function(){function e(t,n,r){var a=this;i(this,e),u(this,"form",void 0),u(this,"success",void 0),u(this,"pwCache",void 0),u(this,"page",void 0),u(this,"currentAsset",void 0),this.page=De.idDescendants(t),this.form=t,this.pwCache=r||null,this.success=n,_t(t,this.page.submitUnlock,(function(){return a.submit()}))}var t;return c(e,[{key:"refresh",value:function(e){var t=this.page;this.currentAsset=e,t.uwAssetLogo.src=De.logoPath(e.symbol),t.uwAssetName.textContent=e.info.name,t.uwAppPass.value="",t.unlockErr.textContent="",De.hide(t.unlockErr),Ve.passwordIsCached()||this.pwCache&&this.pwCache.pw?De.hide(t.uwAppPassBox):De.show(t.uwAppPassBox)}},{key:"setError",value:function(e){this.page.unlockErr.textContent=e,De.show(this.page.unlockErr)}},{key:"showErrorOnly",value:function(e){this.setError(e),De.hide(this.page.uwAppPassBox),De.hide(this.page.submitUnlockDiv)}},{key:"submit",value:(t=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.uwAppPass.value||(this.pwCache?this.pwCache.pw:""))||Ve.passwordIsCached()){e.next=6;break}return t.unlockErr.textContent=ke(w),De.show(t.unlockErr),e.abrupt("return");case 6:return De.hide(this.page.unlockErr),r={assetID:this.currentAsset.id,pass:n},t.uwAppPass.value="",a=st().loading(this.form),e.next=12,nt("/api/openwallet",r);case 12:if(o=e.sent,a(),st().checkResponse(o)){e.next=17;break}return this.setError(o.msg),e.abrupt("return");case 17:this.pwCache&&(this.pwCache.pw=n),this.success();case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),qt=function(){function e(t,n){var r=this;i(this,e),u(this,"form",void 0),u(this,"page",void 0),u(this,"order",void 0),u(this,"acceleratedRate",void 0),u(this,"earlyAcceleration",void 0),u(this,"currencyUnit",void 0),u(this,"success",void 0),this.form=t,this.success=n;var a=this.page=De.idDescendants(t);De.bind(a.accelerateSubmit,"click",(function(){r.submit()})),De.bind(a.submitEarlyConfirm,"click",(function(){r.sendAccelerateRequest()}))}var t,n,r,a;return c(e,[{key:"displayEarlyAccelerationMsg",value:function(){var e=this.page;this.earlyAcceleration&&(e.recentAccelerationTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60)),e.recentSwapTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60)),this.earlyAcceleration.wasAcceleration?(De.show(e.recentAccelerationMsg),De.hide(e.recentSwapMsg),e.recentAccelerationTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60))):(De.show(e.recentSwapMsg),De.hide(e.recentAccelerationMsg),e.recentSwapTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60))),De.hide(e.configureAccelerationDiv,e.accelerateErr),De.show(e.earlyAccelerationDiv))}},{key:"sendAccelerateRequest",value:(a=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.order,n=this.page,r={pw:n.acceleratePass.value,orderID:t.id,newRate:this.acceleratedRate},n.acceleratePass.value="",a=st().loading(n.accelerateMainDiv),e.next=7,nt("/api/accelerateorder",r);case 7:o=e.sent,a(),st().checkResponse(o)?(n.accelerateTxID.textContent=o.txID,De.hide(n.accelerateMainDiv,n.preAccelerateErr,n.accelerateErr),De.show(n.accelerateMsgDiv,n.accelerateSuccess),this.success()):(n.accelerateErr.textContent="Error accelerating order: ".concat(o.msg),De.hide(n.earlyAccelerationDiv),De.show(n.accelerateErr,n.configureAccelerationDiv));case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"submit",value:(r=o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.earlyAcceleration?this.displayEarlyAccelerationMsg():this.sendAccelerateRequest();case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"refresh",value:(n=o(y().mark((function e(t){var n,r,a,o,i,s,c=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.order=t,e.next=4,nt("/api/preaccelerate",t.id);case 4:if(r=e.sent,st().checkResponse(r)){e.next=10;break}return n.preAccelerateErr.textContent="Error accelerating order: ".concat(r.msg),De.hide(n.accelerateMainDiv,n.accelerateSuccess),De.show(n.accelerateMsgDiv,n.preAccelerateErr),e.abrupt("return");case 10:De.hide(n.accelerateMsgDiv,n.preAccelerateErr,n.accelerateErr,n.feeEstimateDiv,n.earlyAccelerationDiv),De.show(n.accelerateMainDiv,n.accelerateSuccess,n.configureAccelerationDiv),a=r.preAccelerate,this.earlyAcceleration=a.earlyAcceleration,this.currencyUnit=a.suggestedRange.yUnit,n.accelerateAvgFeeRate.textContent="".concat(a.swapRate," ").concat(a.suggestedRange.yUnit),n.accelerateCurrentFeeRate.textContent="".concat(a.suggestedRate," ").concat(a.suggestedRange.yUnit),this.acceleratedRate=a.suggestedRange.start.y,o=function(){},i=function(e,t){c.acceleratedRate=t},s=new Ft(a.suggestedRange,a.suggestedRange.start.x,i,(function(){return c.updateAccelerationEstimate()}),o,!0),De.empty(n.sliderContainer),n.sliderContainer.appendChild(s.control),this.updateAccelerationEstimate();case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateAccelerationEstimate",value:(t=o(y().mark((function e(){var t,n,r,a,o,i,s,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.order,r={orderID:n.id,newRate:this.acceleratedRate},a=st().loading(t.sliderContainer),e.next=6,nt("/api/accelerationestimate",r);case 6:if(o=e.sent,a(),st().checkResponse(o)){e.next=12;break}return t.accelerateErr.textContent="Error estimating acceleration fee: ".concat(o.msg),De.show(t.accelerateErr),e.abrupt("return");case 12:t.feeRateEstimate.textContent="".concat(this.acceleratedRate," ").concat(this.currencyUnit),n.sell?(i=n.baseID,s=n.baseSymbol):(i=n.quoteID,s=n.quoteSymbol),c=st().unitInfo(i),t.feeEstimate.textContent="".concat(o.fee/c.conventional.conversionFactor," ").concat(s),De.show(t.feeEstimateDiv);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Mt=function(){function e(t,n,r,a){var o=this;i(this,e),u(this,"form",void 0),u(this,"success",void 0),u(this,"pwCache",void 0),u(this,"defaultTLSText",void 0),u(this,"page",void 0),u(this,"knownExchanges",void 0),u(this,"dexToUpdate",void 0),this.form=t,this.success=n,this.pwCache=r||null,this.defaultTLSText="none selected";var s=this.page=De.parseTemplate(t);s.selectedCert.textContent=this.defaultTLSText,De.bind(s.certFile,"change",(function(){return o.onCertFileChange()})),De.bind(s.removeCert,"click",(function(){return o.clearCertFile()})),De.bind(s.addCert,"click",(function(){return s.certFile.click()})),De.bind(s.showCustom,"click",(function(){De.hide(s.showCustom),De.show(s.customBox,s.auth)})),this.knownExchanges=Array.from(s.knownXCs.querySelectorAll(".known-exchange"));var c,l=It(this.knownExchanges);try{var h=function(){var e=c.value;De.bind(e,"click",(function(){var t,n=e.dataset.host,a=It(o.knownExchanges);try{for(a.s();!(t=a.n()).done;)t.value.classList.remove("selected")}catch(e){a.e(e)}finally{a.f()}if(Ve.passwordIsCached()||r&&r.pw)return o.checkDEX(n);e.classList.add("selected"),s.appPW.focus(),s.addr.value=n}))};for(l.s();!(c=l.n()).done;)h()}catch(e){l.e(e)}finally{l.f()}_t(t,s.submit,(function(){return o.checkDEX()})),a&&(De.hide(s.addDexHdr),De.show(s.updateDexHdr),this.dexToUpdate=a),this.refresh()}var t,n,r;return c(e,[{key:"refresh",value:function(){var e=this.page;e.addr.value="",e.appPW.value="",this.clearCertFile(),De.hide(e.err),Ve.passwordIsCached()||this.pwCache&&this.pwCache.pw?De.hide(e.appPWBox,e.auth):De.show(e.appPWBox,e.auth),0===this.knownExchanges.length||this.dexToUpdate?(De.show(e.customBox,e.auth),De.hide(e.showCustom,e.knownXCs,e.pickServerMsg,e.addCustomMsg)):(De.hide(e.customBox),De.show(e.showCustom));var t,n=It(this.knownExchanges);try{for(n.s();!(t=n.n()).done;)t.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}}},{key:"animate",value:(r=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,De.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"checkDEX",value:(n=o(y().mark((function e(t){var n,r,a,o,i,s,c,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,De.hide(n.err),""!==(t=t||n.addr.value)){e.next=7;break}return n.err.textContent="DEX address cannot be empty",De.show(n.err),e.abrupt("return");case 7:if(r="",!n.certFile.value){e.next=14;break}if(!(a=n.certFile.files)||!a.length){e.next=14;break}return e.next=13,a[0].text();case 13:r=e.sent;case 14:return o="",Ve.passwordIsCached()||(o=n.appPW.value||(this.pwCache?this.pwCache.pw:"")),this.dexToUpdate?(i="/api/updatedexhost",s={newHost:t,cert:r,pw:o,oldHost:this.dexToUpdate}):(i="/api/discoveracct",s={addr:t,cert:r,pass:o}),c=st().loading(this.form),e.next=20,nt(i,s);case 20:if(u=e.sent,c(),st().checkResponse(u,!0)){e.next=25;break}return"certificate required"===u.msg?De.show(n.needCert):(n.err.textContent=u.msg,De.show(n.err)),e.abrupt("return");case 25:if(this.dexToUpdate||!u.paid){e.next=30;break}return e.next=28,st().fetchUser();case 28:return st().loadPage("markets"),e.abrupt("return");case 30:this.pwCache&&(this.pwCache.pw=o),this.success(u.xc,r);case 32:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onCertFileChange",value:(t=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.certFile.files)&&n.length){e.next=4;break}return e.abrupt("return");case 4:t.selectedCert.textContent=n[0].name,De.show(t.removeCert),De.hide(t.addCert);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"clearCertFile",value:function(){var e=this.page;e.certFile.value="",e.selectedCert.textContent=this.defaultTLSText,De.hide(e.removeCert),De.show(e.addCert)}}]),e}(),Nt=function(){function e(t,n,r){var a=this;i(this,e),u(this,"form",void 0),u(this,"success",void 0),u(this,"pwCache",void 0),u(this,"headerTxt",void 0),u(this,"page",void 0),this.success=n,this.form=t,this.pwCache=r||null;var o=this.page=De.parseTemplate(t);this.headerTxt=o.header.textContent||"",_t(t,o.submit,(function(){a.submit()}))}var t,n;return c(e,[{key:"focus",value:function(){this.page.pw.focus()}},{key:"submit",value:(n=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,De.hide(t.errMsg),n=t.pw.value||"",t.pw.value="",r=t.rememberPass.checked,""!==n){e.next=9;break}return t.errMsg.textContent=ke(g),De.show(t.errMsg),e.abrupt("return");case 9:return a=st().loading(this.form),e.next=12,nt("/api/login",{pass:n,rememberPass:r});case 12:if(o=e.sent,a(),st().checkResponse(o)){e.next=18;break}return t.errMsg.textContent=o.msg,De.show(t.errMsg),e.abrupt("return");case 18:o.notes&&o.notes.reverse(),st().setNotes(o.notes||[]),this.pwCache&&(this.pwCache.pw=n),this.success();case 22:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"animate",value:(t=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,De.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ut=300;function zt(e,t){return jt.apply(this,arguments)}function jt(){return(jt=o(y().mark((function e(t,n){var r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.body.offsetWidth/2,e.next=3,De.animate(Ut,(function(e){t.style.right="".concat(e*r,"px")}),"easeInHard");case 3:return De.hide(t),t.style.right="0",n.style.right=String(-r),De.show(n),n.querySelector("input")&&De.safeSelector(n,"input").focus(),e.next=10,De.animate(Ut,(function(e){n.style.right="".concat(e*r-r,"px")}),"easeOutHard");case 10:n.style.right="0";case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _t(e,t,n){var r=function(e){e.preventDefault&&e.preventDefault(),n(e)};De.bind(t,"click",r),De.bind(e,"submit",r)}function Vt(e){return Math.floor(e.getTime()/1e3)}var Ht=function(e){Xe(v,e);var t,n,r,a,s,l,h,d,f,p,m=(f=v,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(f);if(p){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function v(e){var t;i(this,v),u(He(t=m.call(this)),"body",void 0),u(He(t),"pwCache",void 0),u(He(t),"currentDEX",void 0),u(He(t),"page",void 0),u(He(t),"loginForm",void 0),u(He(t),"dexAddrForm",void 0),u(He(t),"newWalletForm",void 0),u(He(t),"regAssetForm",void 0),u(He(t),"walletWaitForm",void 0),u(He(t),"confirmRegisterForm",void 0),t.body=e,t.pwCache={pw:""};var n=t.page=De.idDescendants(e);e.querySelectorAll(".form-closer").forEach((function(e){return De.hide(e)})),_t(n.appPWForm,n.appPWSubmit,(function(){return t.setAppPass()})),De.bind(n.showSeedRestore,"click",(function(){De.show(n.seedRestore),De.hide(n.showSeedRestore)})),t.loginForm=new Nt(n.loginForm,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st().fetchUser();case 2:t.dexAddrForm.refresh(),zt(n.loginForm,n.dexAddrForm);case 4:case"end":return e.stop()}}),e)}))),t.pwCache),t.newWalletForm=new Dt(n.newWalletForm,(function(e){return t.newWalletCreated(e)}),t.pwCache,(function(){return t.animateRegAsset(n.newWalletForm)})),t.dexAddrForm=new Mt(n.dexAddrForm,function(){var e=o(y().mark((function e(r,a){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.currentDEX=r,t.confirmRegisterForm.setExchange(r,a),t.walletWaitForm.setExchange(r),t.regAssetForm.setExchange(r),t.animateRegAsset(n.dexAddrForm);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.pwCache),t.regAssetForm=new Pt(n.regAssetForm,function(){var e=o(y().mark((function e(r){var a,o,i,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.confirmRegisterForm.setAsset(r),a=st().assets[r],!(o=a.wallet)){e.next=14;break}if(i=t.currentDEX.regFees[a.symbol],!(o.synced&&o.balance.available>i.amount)){e.next=8;break}return t.animateConfirmForm(n.regAssetForm),e.abrupt("return");case 8:return e.next=10,t.getRegistrationTxFeeEstimate(r,n.regAssetForm);case 10:return s=e.sent,t.walletWaitForm.setWallet(o,s),zt(n.regAssetForm,n.walletWait),e.abrupt("return");case 14:t.newWalletForm.setAsset(r),t.newWalletForm.loadDefaults(),zt(n.regAssetForm,n.newWalletForm);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.walletWaitForm=new Wt(n.walletWait,(function(){t.animateConfirmForm(n.walletWait)}),(function(){t.animateRegAsset(n.walletWait)})),t.confirmRegisterForm=new Lt(n.confirmRegForm,(function(){t.registerDEXSuccess()}),(function(){t.animateRegAsset(n.confirmRegForm)}),t.pwCache);var r=De.safeSelector(n.forms,":scope > form.selected");switch(r.classList.remove("selected"),r){case n.loginForm:t.loginForm.animate();break;case n.dexAddrForm:t.dexAddrForm.animate()}return De.show(r),st().user.authed&&t.auth(),t}return c(v,[{key:"unload",value:function(){this.pwCache.pw=""}},{key:"auth",value:(d=o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st().fetchUser();case 2:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"animateRegAsset",value:(h=o(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:De.hide(t),this.regAssetForm.animate(),De.show(this.page.regAssetForm);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"animateConfirmForm",value:(l=o(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.confirmRegisterForm.animate(),De.hide(t),De.show(this.page.confirmRegForm);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getRegistrationTxFeeEstimate",value:(s=o(y().mark((function e(t,n){var r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCertFile();case 2:return r=e.sent,a=st().loading(n),e.next=6,nt("/api/regtxfee",{addr:this.currentDEX.host,cert:r,asset:t});case 6:if(o=e.sent,a(),st().checkResponse(o,!0)){e.next=10;break}return e.abrupt("return",0);case 10:return e.abrupt("return",o.txfee);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"setAppPass",value:(a=o(y().mark((function e(){var t,n,r,a,o,i,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,De.hide(t.appPWErrMsg),n=t.appPW.value||"",r=t.appPWAgain.value,""!==n){e.next=8;break}return t.appPWErrMsg.textContent=ke(g),De.show(t.appPWErrMsg),e.abrupt("return");case 8:if(n===r){e.next=12;break}return t.appPWErrMsg.textContent=ke(_),De.show(t.appPWErrMsg),e.abrupt("return");case 12:return st().setNotes([]),t.appPW.value="",t.appPWAgain.value="",a=st().loading(t.appPWForm),o=t.seedInput.value,i=t.rememberPass.checked,e.next=20,nt("/api/init",{pass:n,seed:o,rememberPass:i});case 20:if(s=e.sent,a(),st().checkResponse(s)){e.next=26;break}return t.appPWErrMsg.textContent=s.msg,De.show(t.appPWErrMsg),e.abrupt("return");case 26:return this.pwCache.pw=n,this.auth(),st().updateMenuItemsDisplay(),this.newWalletForm.refresh(),this.dexAddrForm.refresh(),e.next=33,zt(t.appPWForm,t.dexAddrForm);case 33:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getCertFile",value:(r=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.dexAddrForm.page.certFile.value){e.next=7;break}if(!(n=this.dexAddrForm.page.certFile.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:t=e.sent;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"registerDEXSuccess",value:(n=o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st().fetchUser();case 2:st().loadPage("markets");case 3:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"newWalletCreated",value:(t=o(y().mark((function e(t){var n,r,a,o,i,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.regAssetForm.refresh(),e.next=3,st().fetchUser();case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(r=this.page,a=n.assets[t],o=a.wallet,i=this.currentDEX.regFees[a.symbol].amount,!(o.synced&&o.balance.available>i)){e.next=14;break}return e.next=13,this.animateConfirmForm(r.newWalletForm);case 13:return e.abrupt("return");case 14:return e.next=16,this.getRegistrationTxFeeEstimate(t,r.newWalletForm);case 16:return s=e.sent,this.walletWaitForm.setWallet(o,s),e.next=20,zt(r.newWalletForm,r.walletWait);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),v}($e);var Gt=function(e){Xe(s,e);var t,n,r,a=(n=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(n);if(r){var a=Ke(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return Ye(this,e)});function s(e){var t;return i(this,s),u(He(t=a.call(this)),"form",void 0),u(He(t),"loginForm",void 0),t.form=De.idel(e,"loginForm"),De.show(t.form),t.loginForm=new Nt(t.form,(function(){t.loggedIn()})),t.loginForm.focus(),t}return c(s,[{key:"loggedIn",value:(t=o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st().fetchUser();case 2:st().loadPage("markets");case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),s}($e);function Xt(e,t,n){return{subject:e,details:t,severity:n,stamp:(new Date).getTime(),acked:!1,type:"internal",topic:"internal",id:""}}function Qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){s=!0,o=e})),f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Kt=De.bind,Zt=function(e){Xe(B,e);var t,n,a,s,l,h,d,f,p,m,v,g,k,b,x,C,S,F,E,A,R,I,O,D,T,L,P,W=(L=B,P=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(L);if(P){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function B(e){var t;i(this,B),u(He(t=W.call(this)),"body",void 0),u(He(t),"page",void 0),u(He(t),"rowInfos",void 0),u(He(t),"sendAsset",void 0),u(He(t),"newWalletForm",void 0),u(He(t),"reconfigForm",void 0),u(He(t),"unlockForm",void 0),u(He(t),"lastFormAsset",void 0),u(He(t),"keyup",void 0),u(He(t),"changeWalletPW",void 0),u(He(t),"depositAsset",void 0),u(He(t),"displayed",void 0),u(He(t),"animation",void 0),u(He(t),"openAsset",void 0),u(He(t),"walletAsset",void 0),u(He(t),"reconfigAsset",void 0),u(He(t),"forms",void 0),u(He(t),"forceReq",void 0),u(He(t),"forceUrl",void 0),u(He(t),"currentForm",void 0),u(He(t),"restoreInfoCard",void 0),t.body=e;var n=t.page=De.idDescendants(e);De.cleanTemplates(n.restoreInfoCard),t.restoreInfoCard=n.restoreInfoCard.cloneNode(!0),t.forms=De.applySelector(n.forms,":scope > form"),n.forms.querySelectorAll(".form-closer").forEach((function(e){De.bind(e,"click",(function(){t.closePopups()}))})),De.bind(n.cancelForce,"click",(function(){t.closePopups()})),De.bind(n.copyAddressBtn,"click",(function(){t.copyAddress()}));var a,s,c=function(e,t){return e.querySelector("[data-action=".concat(t,"]"))},l=t.rowInfos={},h=Qt(De.applySelector(n.walletTable,"tr"));try{for(h.s();!(s=h.n()).done;){var d=s.value,f=parseInt(d.dataset.assetID||"");l[f]={assetID:f,tr:d,symbol:d.dataset.symbol||"",name:d.dataset.name||"",stateIcons:new Le(d),actions:{connect:c(d,"connect"),unlock:c(d,"unlock"),send:c(d,"send"),deposit:c(d,"deposit"),create:c(d,"create"),rescan:c(d,"rescan"),lock:c(d,"lock"),settings:c(d,"settings")}},a||(a=l[f])}}catch(e){h.e(e)}finally{h.f()}n.marketCard.removeAttribute("id"),n.marketCard.remove(),n.oneMarket.removeAttribute("id"),n.oneMarket.remove(),t.newWalletForm=new Dt(n.newWalletForm,(function(){t.createWalletSuccess()})),t.reconfigForm=new Tt(n.reconfigInputs,!1),t.unlockForm=new Bt(n.unlockWalletForm,(function(){t.openWalletSuccess()})),_t(n.sendForm,n.submitSendForm,(function(){t.send()})),_t(n.reconfigForm,n.submitReconfig,(function(){return t.reconfig()}));for(var p=function(){var e=v[m];Kt(e.tr,"click",(function(){t.showMarkets(e.assetID)}))},m=0,v=Object.values(l);m<v.length;m++)p();n.rightBox.querySelectorAll(".form-closer").forEach((function(e){De.bind(e,"click",(function(){t.showMarkets(t.lastFormAsset)}))})),De.bind(n.forms,"mousedown",(function(e){De.mouseInElement(e,t.currentForm)||t.closePopups()})),t.keyup=function(e){"Escape"===e.key&&(De.isDisplayed(t.page.forms)?t.closePopups():t.showMarkets(t.lastFormAsset))},Kt(document,"keyup",t.keyup),Kt(n.downloadLogs,"click",o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.downloadLogs();case 1:case"end":return e.stop()}}),e)})))),Kt(n.exportWallet,"click",o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.displayExportWalletAuth();case 1:case"end":return e.stop()}}),e)})))),Kt(n.recoverWallet,"click",o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showRecoverWallet();case 1:case"end":return e.stop()}}),e)})))),_t(n.exportWalletAuth,n.exportWalletAuthSubmit,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.exportWalletAuthSubmit();case 1:case"end":return e.stop()}}),e)})))),_t(n.recoverWalletConfirm,n.recoverWalletSubmit,(function(){t.recoverWallet()})),_t(n.confirmForce,n.confirmForceSubmit,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.confirmForceSubmit();case 1:case"end":return e.stop()}}),e)}))));for(var g=function(){var e=r(k[w],2),n=e[0],a=e[1],i=parseInt(n),s=a.actions,c=function(e,t){e.stopPropagation(),t(i,a)};Kt(s.connect,"click",(function(e){c(e,t.doConnect.bind(He(t)))})),Kt(s.send,"click",(function(e){c(e,t.showSendForm.bind(He(t)))})),Kt(s.deposit,"click",(function(e){c(e,t.showDeposit.bind(He(t)))})),Kt(s.create,"click",(function(e){c(e,t.showNewWallet.bind(He(t)))})),Kt(s.rescan,"click",(function(e){c(e,t.rescanWallet.bind(He(t)))})),Kt(s.unlock,"click",(function(e){c(e,t.openWallet.bind(He(t)))})),Kt(s.lock,"click",function(){var e=o(y().mark((function e(n){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(n,t.lock.bind(He(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Kt(s.settings,"click",(function(e){c(e,t.showReconfig.bind(He(t)))}))},w=0,k=Object.entries(l);w<k.length;w++)g();Kt(n.newDepAddrBttn,"click",o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.newDepositAddress();case 1:case"end":return e.stop()}}),e)})))),Kt(n.sendAvail,"click",(function(){var e=t.sendAsset,r=e.wallet.balance.available;n.sendAmt.value=String(r/e.info.unitinfo.conventional.conversionFactor),t.showFiatValue(e.id,r,n.sendValue),0==(64&e.wallet.traits)?n.subtractCheckBox.checked=!1:n.subtractCheckBox.checked=!0}));var b,x=Qt(Object.entries(st().walletMap));try{for(x.s();!(b=x.n()).done;){var C=r(b.value,2),S=C[0],F=C[1];if(F){var E=t.page.walletTable.querySelector('[data-conversion-target="'.concat(S,'"]'));E&&t.showFiatValue(S,F.balance.available,E)}}}catch(e){x.e(e)}finally{x.f()}return Kt(n.sendAmt,"input",(function(){var e=t.sendAsset;if(e){var r=parseFloat(n.sendAmt.value||"0"),a=e.info.unitinfo.conventional.conversionFactor;t.showFiatValue(e.id,r*a,n.sendValue)}})),Kt(n.showChangePW,"click",(function(){t.changeWalletPW=!t.changeWalletPW,t.setPWSettingViz(t.changeWalletPW)})),Kt(n.changeWalletTypeSelect,"change",(function(){t.changeWalletType()})),Kt(n.showChangeType,"click",(function(){De.isHidden(n.changeWalletType)?(De.show(n.changeWalletType,n.changeTypeHideIcon),De.hide(n.changeTypeShowIcon),n.changeTypeMsg.textContent=ke(le)):t.showReconfig(t.reconfigAsset)})),a?(t.showMarkets(a.assetID),st().registerNoteFeeder({fiatrateupdate:function(e){t.handleRatesNote(e)},balance:function(e){t.handleBalanceNote(e)},walletstate:function(e){t.handleWalletStateNote(e)},walletconfig:function(e){t.handleWalletStateNote(e)}}),t):Ye(t)}return c(B,[{key:"closePopups",value:function(){De.hide(this.page.forms)}},{key:"copyAddress",value:(T=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,navigator.clipboard.writeText(t.depositAddress.textContent||"").then((function(){De.show(t.copyAlert),setTimeout((function(){De.hide(t.copyAlert)}),800)})).catch((function(e){console.error("Unable to copy: ",e)}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"setPWSettingViz",value:function(e){if(e)return De.hide(this.page.showIcon),De.show(this.page.hideIcon,this.page.changePW),void(this.page.switchPWMsg.textContent=ke(H));De.hide(this.page.hideIcon,this.page.changePW),De.show(this.page.showIcon),this.page.switchPWMsg.textContent=ke(G)}},{key:"hideBox",value:(D=o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.animation){e.next=3;break}return e.next=3,this.animation;case 3:if(this.displayed){e.next=5;break}return e.abrupt("return");case 5:De.hide(this.displayed);case 6:case"end":return e.stop()}}),e,this)}))),function(){return D.apply(this,arguments)})},{key:"showBox",value:(O=o(y().mark((function e(t,n){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.style.opacity="0",De.show(t),n&&n.focus(),e.next=5,De.animate(300,(function(e){t.style.opacity="".concat(e)}),"easeOut");case 5:t.style.opacity="1",this.displayed=t;case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"showForm",value:(I=o(y().mark((function e(t){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return De.hide(e)})),t.style.right="10000px",De.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,De.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"showMarkets",value:(R=o(y().mark((function e(t){var n,a,o,i,s,c,u,l,h,d,f,p,m,v,g,w,k,b;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,a=n.marketsBox,o=n.marketsCard,i=this.rowInfos[t],e.next=6,this.hideBox();case 6:De.empty(o),n.marketsFor.textContent=i.name,n.marketsForLogo.src=De.logoPath(st().assets[t].symbol),s=0,c=Object.entries(st().user.exchanges);case 10:if(!(s<c.length)){e.next=36;break}if(u=r(c[s],2),l=u[0],h=u[1],d=0,h.markets){e.next=15;break}return e.abrupt("continue",33);case 15:for(f=0,p=Object.values(h.markets);f<p.length;f++)(m=p[f]).baseid!==t&&m.quoteid!==t||d++;if(0!==d){e.next=18;break}return e.abrupt("continue",33);case 18:if(v=n.marketCard.cloneNode(!0),(g=De.parseTemplate(v)).dexTitle.textContent=l,o.appendChild(v),h.markets){e.next=24;break}return e.abrupt("continue",33);case 24:w=function(){var e=b[k];if(e.baseid!==t&&e.quoteid!==t)return"continue";var r=n.oneMarket.cloneNode(!0);De.safeSelector(r,"span").textContent=Jt(e);var a=e.basesymbol;e.baseid===t&&(a=e.quotesymbol),De.safeSelector(r,"img").src=De.logoPath(a);var o={host:l,base:e.baseid,quote:e.quoteid};Kt(r,"click",(function(){st().loadPage("markets",o)})),g.markets.appendChild(r)},k=0,b=Object.values(h.markets);case 26:if(!(k<b.length)){e.next=33;break}if("continue"!==w()){e.next=30;break}return e.abrupt("continue",30);case 30:k++,e.next=26;break;case 33:s++,e.next=10;break;case 36:this.animation=this.showBox(a);case 37:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"showNewWallet",value:(A=o(y().mark((function e(t){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=n.newWalletForm,e.next=4,this.hideBox();case 4:return this.walletAsset=this.lastFormAsset=t,this.newWalletForm.setAsset(t),this.animation=this.showBox(r),e.next=9,this.newWalletForm.loadDefaults();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"rescanWallet",value:(E=o(y().mark((function e(t){var n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=st().loading(this.body),r="/api/rescanwallet",a={assetID:t},e.next=5,nt(r,a);case 5:if(o=e.sent,n(),35!==o.code){e.next=12;break}return this.forceUrl=r,this.forceReq=a,this.showConfirmForce(),e.abrupt("return");case 12:st().checkResponse(o);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"showConfirmForce",value:function(){De.hide(this.page.confirmForceErr),this.showForm(this.page.confirmForce)}},{key:"showRecoverWallet",value:function(){De.hide(this.page.recoverWalletErr),this.showForm(this.page.recoverWalletConfirm)}},{key:"openWallet",value:(F=o(y().mark((function e(t){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ve.passwordIsCached()){e.next=4;break}this.showOpen(t),e.next=10;break;case 4:return this.openAsset=t,n={assetID:t},e.next=8,nt("/api/openwallet",n);case 8:r=e.sent,st().checkResponse(r)?this.openWalletSuccess.bind(this)():this.showOpen(t,"Error opening wallet: ".concat(r.msg));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"showOpen",value:(S=o(y().mark((function e(t,n){var r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.page,this.openAsset=this.lastFormAsset=t,e.next=4,this.hideBox();case 4:this.unlockForm.refresh(st().assets[t]),n&&this.unlockForm.showErrorOnly(n),this.animation=this.showBox(r.unlockWalletForm,r.walletPass);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"showReconfig",value:(C=o(y().mark((function e(t){var n,r,a,o,i,s,c,u,l,h,d;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,De.hide(n.changeWalletType,n.changeTypeHideIcon,n.reconfigErr,n.showChangeType,n.changeTypeHideIcon),De.hide(n.reconfigErr),this.reconfigAsset=this.lastFormAsset=t,this.changeWalletPW=!1,this.setPWSettingViz(this.changeWalletPW),r=st().assets[t],a=st().currentWalletDefinition(t),r.info.availablewallets.length>1){De.empty(n.changeWalletTypeSelect),De.show(n.showChangeType,n.changeTypeShowIcon),n.changeTypeMsg.textContent=ke(ue),o=Qt(r.info.availablewallets);try{for(o.s();!(i=o.n()).done;)s=i.value,c=document.createElement("option"),s.type===a.type&&(c.selected=!0),c.value=c.textContent=s.type,n.changeWalletTypeSelect.appendChild(c)}catch(e){o.e(e)}finally{o.f()}}else De.hide(n.showChangeType);return 0!=(4&(u=st().walletMap[t]).traits)?De.show(n.downloadLogs):De.hide(n.downloadLogs),0!=(32&u.traits)?De.show(n.recoverWallet):De.hide(n.recoverWallet),256&u.traits?De.show(n.exportWallet):De.hide(n.exportWallet),n.recfgAssetLogo.src=De.logoPath(r.symbol),n.recfgAssetName.textContent=r.info.name,e.next=17,this.hideBox();case 17:return this.animation=this.showBox(n.reconfigForm),l=st().loading(n.reconfigForm),e.next=21,nt("/api/walletsettings",{assetID:t});case 21:if(h=e.sent,l(),st().checkResponse(h,!0)){e.next=27;break}return n.reconfigErr.textContent=h.msg,De.show(n.reconfigErr),e.abrupt("return");case 27:d=st().walletIsActive(t),this.reconfigForm.update(a.configopts||[],d),this.reconfigForm.setConfig(h.map),this.updateDisplayedReconfigFields(a);case 31:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"changeWalletType",value:function(){var e=this.page.changeWalletTypeSelect.value||"",t=st().walletDefinition(this.reconfigAsset,e);this.reconfigForm.update(t.configopts||[]),this.updateDisplayedReconfigFields(t)}},{key:"updateDisplayedReconfigFields",value:function(e){e.seeded?(De.hide(this.page.showChangePW),this.changeWalletPW=!1,this.setPWSettingViz(!1)):De.show(this.page.showChangePW)}},{key:"showDeposit",value:(x=o(y().mark((function e(t){var n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,De.hide(n.depositErr),r=n.deposit,a=st().assets[t],n.depositLogo.src=De.logoPath(a.symbol),o=st().walletMap[t],this.depositAsset=this.lastFormAsset=t,o){e.next=10;break}return st().notify(Xt("Cannot retrieve deposit address.","No wallet found for ".concat(a.info.name),5)),e.abrupt("return");case 10:return e.next=12,this.hideBox();case 12:n.depositName.textContent=a.info.name,n.depositAddress.textContent=o.address,n.qrcode.src="/generateqrcode?address=".concat(o.address),0!=(2&o.traits)?De.show(n.newDepAddrBttn):De.hide(n.newDepAddrBttn),this.animation=this.showBox(r);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"newDepositAddress",value:(b=o(y().mark((function e(){var t,n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,De.hide(t.depositErr),n=st().loading(t.deposit),e.next=5,nt("/api/depositaddress",{assetID:this.depositAsset});case 5:if(r=e.sent,n(),st().checkResponse(r,!0)){e.next=11;break}return t.depositErr.textContent=r.msg,De.show(t.depositErr),e.abrupt("return");case 11:t.depositAddress.textContent=r.address,t.qrcode.src="/generateqrcode?address=".concat(r.address);case 13:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"showSendForm",value:(k=o(y().mark((function e(t){var n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=n.sendForm,a=this.sendAsset=st().assets[t],this.lastFormAsset=t,(o=st().walletMap[t])||st().notify(Xt("Cannot send/withdraw.","No wallet found for ".concat(a.info.name),5)),e.next=8,this.hideBox();case 8:De.hide(n.senderOnlyHelpText),De.hide(n.toggleSubtract),n.subtractCheckBox.checked=!1,0!=(64&o.traits)?De.show(n.toggleSubtract):(De.show(n.senderOnlyHelpText),n.subtractCheckBox.checked=!1),n.sendAddr.value="",n.sendAmt.value="",n.sendPW.value="",n.sendErr.textContent="",this.showFiatValue(a.id,0,n.sendValue),n.sendAvail.textContent=De.formatFullPrecision(o.balance.available,a.info.unitinfo),n.sendLogo.src=De.logoPath(a.symbol),n.sendName.textContent=a.info.name,r.dataset.assetID=String(t),this.animation=this.showBox(r,n.walletPass);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"doConnect",value:(g=o(y().mark((function e(t){var n,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=st().loading(this.body),e.next=3,nt("/api/connectwallet",{assetID:t});case 3:if(r=e.sent,n(),st().checkResponse(r)){e.next=7;break}return e.abrupt("return");case 7:a=this.rowInfos[t],De.hide(a.actions.connect);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"createWalletSuccess",value:(v=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.rowInfos[this.walletAsset],this.showMarkets(t.assetID),e.next=4,st().fetchUser();case 4:return e.next=6,st().loadPage("wallets");case 6:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"openWalletSuccess",value:(m=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.rowInfos[this.openAsset],n=t.actions,De.show(n.send,n.deposit),De.hide(n.unlock,n.connect),st().walletMap[t.assetID].encrypted&&De.show(n.lock),this.showMarkets(this.openAsset);case 6:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"send",value:(p=o(y().mark((function e(){var t,n,r,a,o,i,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,De.hide(t.sendErr),n=parseInt(t.sendForm.dataset.assetID||""),r=t.subtractCheckBox.checked||!1,a=st().unitInfo(n).conventional.conversionFactor,o={assetID:n,address:t.sendAddr.value,subtract:r,value:Math.round(parseFloat(t.sendAmt.value||"")*a),pw:t.sendPW.value},i=st().loading(t.sendForm),e.next=9,nt("/api/send",o);case 9:if(s=e.sent,i(),st().checkResponse(s,!0)){e.next=15;break}return t.sendErr.textContent=s.msg,De.show(t.sendErr),e.abrupt("return");case 15:this.showMarkets(n);case 16:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"reconfig",value:(f=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,De.hide(t.reconfigErr),t.appPW.value||Ve.passwordIsCached()){e.next=6;break}return t.reconfigErr.textContent=ke(w),De.show(t.reconfigErr),e.abrupt("return");case 6:return n=st().currentWalletDefinition(this.reconfigAsset).type,De.isHidden(t.changeWalletType)||(n=t.changeWalletTypeSelect.value||""),r=st().loading(t.reconfigForm),a={assetID:this.reconfigAsset,config:this.reconfigForm.map(),appPW:t.appPW.value||"",walletType:n},this.changeWalletPW&&(a.newWalletPW=t.newPW.value),e.next=13,nt("/api/reconfigurewallet",a);case 13:if(o=e.sent,t.appPW.value="",t.newPW.value="",r(),st().checkResponse(o,!0)){e.next=21;break}return t.reconfigErr.textContent=o.msg,De.show(t.reconfigErr),e.abrupt("return");case 21:this.showMarkets(this.reconfigAsset);case 22:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"lock",value:(d=o(y().mark((function e(t,n){var r,a,o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.page,a=st().loading(r.newWalletForm),e.next=4,nt("/api/closewallet",{assetID:t});case 4:if(o=e.sent,a(),st().checkResponse(o)){e.next=8;break}return e.abrupt("return");case 8:i=n.actions,De.hide(i.send,i.lock,i.deposit),De.show(i.unlock);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"downloadLogs",value:(h=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new URLSearchParams("")).append("assetid","".concat(this.reconfigAsset)),(n=new URL(window.location.href)).search=t.toString(),n.pathname="/wallets/logfile",window.open(n.toString());case 6:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"displayExportWalletAuth",value:(l=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,De.hide(t.exportWalletErr),t.exportWalletPW.value="",this.showForm(t.exportWalletAuth);case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"exportWalletAuthSubmit",value:(s=o(y().mark((function e(){var t,n,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n={assetID:this.reconfigAsset,pass:t.exportWalletPW.value},r=st().loading(t.forms),e.next=6,nt("/api/restorewalletinfo",n);case 6:a=e.sent,r(),st().checkResponse(a)?(t.exportWalletPW.value="",this.displayRestoreWalletInfo(a.restorationinfo)):(t.exportWalletErr.textContent=a.msg,De.show(t.exportWalletErr));case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"displayRestoreWalletInfo",value:(a=o(y().mark((function e(t){var n,r,a,o,i,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,De.empty(n.restoreInfoCardsList),r=Qt(t);try{for(r.s();!(a=r.n()).done;)o=a.value,i=this.restoreInfoCard.cloneNode(!0),(s=De.parseTemplate(i)).name.textContent=o.target,s.seed.textContent=o.seed,s.seedName.textContent="".concat(o.seedName,":"),s.instructions.textContent=o.instructions,n.restoreInfoCardsList.appendChild(i)}catch(e){r.e(e)}finally{r.f()}this.showForm(n.restoreWalletInfo);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"recoverWallet",value:(n=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,De.hide(t.recoverWalletErr),n={assetID:this.reconfigAsset,appPW:t.recoverWalletPW.value},t.recoverWalletPW.value="",r="/api/recoverwallet",a=st().loading(t.forms),e.next=8,nt(r,n);case 8:o=e.sent,a(),35===o.code?(this.forceUrl=r,this.forceReq=n,this.showConfirmForce()):st().checkResponse(o)?this.closePopups():(t.recoverWalletErr.textContent=o.msg,De.show(t.recoverWalletErr));case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"confirmForceSubmit",value:(t=o(y().mark((function e(){var t,n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,this.forceReq.force=!0,n=st().loading(t.forms),e.next=5,nt(this.forceUrl,this.forceReq);case 5:r=e.sent,n(),st().checkResponse(r)?this.closePopups():(t.confirmForceErr.textContent=r.msg,De.show(t.confirmForceErr));case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleBalanceNote",value:function(e){De.safeSelector(this.page.walletTable,'[data-balance-target="'.concat(e.assetID,'"]')).textContent=De.formatFullPrecision(e.balance.available,st().unitInfo(e.assetID));var t=De.safeSelector(this.page.walletTable,'[data-conversion-target="'.concat(e.assetID,'"]'));t&&this.showFiatValue(e.assetID,e.balance.available,t)}},{key:"handleRatesNote",value:function(e){st().fiatRatesMap=e.fiatRates;var t,n=Qt(Object.entries(st().walletMap));try{for(n.s();!(t=n.n()).done;){var a=r(t.value,2),o=a[0],i=a[1];if(i){var s=this.page.walletTable.querySelector('[data-conversion-target="'.concat(o,'"]'));s&&this.showFiatValue(o,i.balance.available,s)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"showFiatValue",value:function(e,t,n){if(n){var r=st().fiatRatesMap[e];n.textContent=De.formatFiatConversion(t,r,st().unitInfo(e)),r?De.show(n.parentElement):De.hide(n.parentElement)}}},{key:"handleWalletStateNote",value:function(e){this.rowInfos[e.wallet.assetID].stateIcons.readWallet(e.wallet);var t=this.page.walletTable.querySelector('[data-conversion-target="'.concat(e.wallet.assetID,'"]'));t&&this.showFiatValue(e.wallet.assetID,e.wallet.balance.available,t)}},{key:"unload",value:function(){De.unbind(document,"keyup",this.keyup)}}]),B}($e);function Jt(e){return"".concat(e.basesymbol.toUpperCase(),"-").concat(e.quotesymbol.toUpperCase())}var $t=function(e){Xe(x,e);var t,n,r,a,s,l,h,d,f,p,m,v,g,k,b=(g=x,k=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(g);if(k){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function x(e){var t;i(this,x),u(He(t=b.call(this)),"body",void 0),u(He(t),"currentDEX",void 0),u(He(t),"page",void 0),u(He(t),"forms",void 0),u(He(t),"fiatRateSources",void 0),u(He(t),"regAssetForm",void 0),u(He(t),"confirmRegisterForm",void 0),u(He(t),"newWalletForm",void 0),u(He(t),"walletWaitForm",void 0),u(He(t),"dexAddrForm",void 0),u(He(t),"currentForm",void 0),u(He(t),"pwCache",void 0),u(He(t),"defaultTLSText",void 0),u(He(t),"keyup",void 0),t.body=e,t.defaultTLSText="none selected";var n=t.page=De.idDescendants(e);t.forms=De.applySelector(n.forms,":scope > form"),t.fiatRateSources=De.applySelector(n.fiatRateSources,"input[type=checkbox]"),De.bind(n.darkMode,"click",(function(){Ve.dark(n.darkMode.checked||!1),n.darkMode.checked?document.body.classList.add("dark"):document.body.classList.remove("dark")})),De.bind(n.showPokes,"click",(function(){var e=n.showPokes.checked||!1;Ve.setCookie("popups",e?"1":"0"),st().showPopups=e})),n.commitHash.textContent=st().commitHash.substring(0,7),De.bind(n.addADex,"click",(function(){t.dexAddrForm.refresh(),t.showForm(n.dexAddrForm)})),t.fiatRateSources.forEach((function(e){De.bind(e,"change",o(y().mark((function t(){var n;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt("/api/toggleratesource",{disable:!e.checked,source:e.value});case 2:return n=t.sent,st().checkResponse(n)||(e.checked=!e.checked),t.next=6,st().fetchUser();case 6:case"end":return t.stop()}}),t)}))))})),t.regAssetForm=new Pt(n.regAssetForm,function(){var e=o(y().mark((function e(r){var a,o,i,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.confirmRegisterForm.setAsset(r),a=st().assets[r],!(o=a.wallet)){e.next=14;break}if(i=t.currentDEX.regFees[a.symbol],!(o.synced&&o.balance.available>i.amount)){e.next=8;break}return t.animateConfirmForm(n.regAssetForm),e.abrupt("return");case 8:return e.next=10,t.getRegistrationTxFeeEstimate(r,n.regAssetForm);case 10:return s=e.sent,t.walletWaitForm.setWallet(o,s),zt(n.regAssetForm,n.walletWait),e.abrupt("return");case 14:t.newWalletForm.setAsset(r),t.newWalletForm.loadDefaults(),t.currentForm=n.newWalletForm,zt(n.regAssetForm,n.newWalletForm);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.confirmRegisterForm=new Lt(n.confirmRegForm,(function(){t.registerDEXSuccess()}),(function(){t.animateRegAsset(n.confirmRegForm)}),t.pwCache),t.newWalletForm=new Dt(n.newWalletForm,(function(e){return t.newWalletCreated(e)}),t.pwCache,(function(){return t.animateRegAsset(n.newWalletForm)})),t.walletWaitForm=new Wt(n.walletWait,(function(){t.animateConfirmForm(n.walletWait)}),(function(){t.animateRegAsset(n.walletWait)})),t.dexAddrForm=new Mt(n.dexAddrForm,function(){var e=o(y().mark((function e(r,a){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.currentDEX=r,t.confirmRegisterForm.setExchange(r,a),t.walletWaitForm.setExchange(r),t.regAssetForm.setExchange(r),t.animateRegAsset(n.dexAddrForm);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),De.bind(n.importAccount,"click",(function(){return t.prepareAccountImport(n.authorizeAccountImportForm)})),_t(n.authorizeAccountImportForm,n.authorizeImportAccountConfirm,(function(){return t.importAccount()})),De.bind(n.changeAppPW,"click",(function(){return t.showForm(n.changeAppPWForm)})),_t(n.changeAppPWForm,n.submitNewPW,(function(){return t.changeAppPW()})),De.bind(n.accountFile,"change",(function(){return t.onAccountFileChange()})),De.bind(n.removeAccount,"click",(function(){return t.clearAccountFile()})),De.bind(n.addAccount,"click",(function(){return n.accountFile.click()})),De.bind(n.exportSeed,"click",(function(){return t.showForm(n.exportSeedAuth)})),_t(n.exportSeedAuth,n.exportSeedSubmit,(function(){return t.submitExportSeedReq()}));var r=function(){De.hide(n.forms),n.exportSeedPW.value="",n.seedDiv.textContent=""};return De.bind(n.forms,"mousedown",(function(e){De.mouseInElement(e,t.currentForm)||r()})),t.keyup=function(e){"Escape"===e.key&&r()},De.bind(document,"keyup",t.keyup),n.forms.querySelectorAll(".form-closer").forEach((function(e){De.bind(e,"click",(function(){r()}))})),t}return c(x,[{key:"getRegistrationTxFeeEstimate",value:(v=o(y().mark((function e(t,n){var r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCertFile();case 2:return r=e.sent,a=st().loading(n),e.next=6,nt("/api/regtxfee",{addr:this.currentDEX.host,cert:r,asset:t});case 6:if(o=e.sent,a(),st().checkResponse(o,!0)){e.next=10;break}return e.abrupt("return",0);case 10:return e.abrupt("return",o.txfee);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"newWalletCreated",value:(m=o(y().mark((function e(t){var n,r,a,o,i,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st().fetchUser();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(r=this.page,a=n.assets[t],o=a.wallet,i=this.currentDEX.regFees[a.symbol].amount,!(o.synced&&o.balance.available>i)){e.next=13;break}return e.next=12,this.animateConfirmForm(r.newWalletForm);case 12:return e.abrupt("return");case 13:return e.next=15,this.getRegistrationTxFeeEstimate(t,r.newWalletForm);case 15:return s=e.sent,this.walletWaitForm.setWallet(o,s),this.currentForm=r.walletWait,e.next=20,zt(r.newWalletForm,r.walletWait);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"onAccountFileChange",value:(p=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.accountFile.files)&&n.length){e.next=4;break}return e.abrupt("return");case 4:t.selectedAccount.textContent=n[0].name,De.show(t.removeAccount),De.hide(t.addAccount);case 7:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"clearAccountFile",value:function(){var e=this.page;e.accountFile.value="",e.selectedAccount.textContent="none selected",De.hide(e.removeAccount),De.show(e.addAccount)}},{key:"prepareAccountImport",value:(f=o(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.page.importAccountErr.textContent="",this.showForm(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"importAccount",value:(d=o(y().mark((function e(){var t,n,r,a,o,i,s,c,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=t.importAccountAppPass.value,t.importAccountAppPass.value="",r="",!t.accountFile.value){e.next=12;break}if((a=t.accountFile.files)&&a.length){e.next=9;break}return console.error("importAccount: no file specified"),e.abrupt("return");case 9:return e.next=11,a[0].text();case 11:r=e.sent;case 12:e.prev=12,o=JSON.parse(r),e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(12),t.importAccountErr.textContent=e.t0.message,De.show(t.importAccountErr),e.abrupt("return");case 21:if(void 0!==o){e.next=25;break}return t.importAccountErr.textContent=ke(V),De.show(t.importAccountErr),e.abrupt("return");case 25:return i={pw:n,account:o},s=st().loading(this.body),e.next=29,nt("/api/importaccount",i);case 29:if(c=e.sent,s(),st().checkResponse(c)){e.next=35;break}return t.importAccountErr.textContent=c.msg,De.show(t.importAccountErr),e.abrupt("return");case 35:return e.next=37,nt("/api/login",{pass:n});case 37:if(u=e.sent,st().checkResponse(u)){e.next=42;break}return t.importAccountErr.textContent=u.msg,De.show(t.importAccountErr),e.abrupt("return");case 42:return e.next=44,st().fetchUser();case 44:De.hide(t.forms),window.location.reload();case 46:case"end":return e.stop()}}),e,this,[[12,16]])}))),function(){return d.apply(this,arguments)})},{key:"submitExportSeedReq",value:(h=o(y().mark((function e(){var t,n,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.exportSeedPW.value,r=st().loading(this.body),e.next=5,nt("/api/exportseed",{pass:n});case 5:if(a=e.sent,r(),st().checkResponse(a)){e.next=11;break}return t.exportAccountErr.textContent=a.msg,De.show(t.exportSeedE),e.abrupt("return");case 11:t.exportSeedPW.value="",t.seedDiv.textContent=a.seed,this.showForm(t.authorizeSeedDisplay);case 14:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"showForm",value:(l=o(y().mark((function e(t){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return De.hide(e)})),t.style.right="10000px",De.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,De.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getCertFile",value:(s=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.dexAddrForm.page.certFile.value){e.next=7;break}if(!(n=this.dexAddrForm.page.certFile.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:t=e.sent;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"registerDEXSuccess",value:(a=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,De.hide(t.forms),e.next=4,st().fetchUser();case 4:window.location.reload();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"changeAppPW",value:(r=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,De.hide(t.changePWErrMsg),n=function(){t.appPW.value="",t.newAppPW.value="",t.confirmNewPW.value=""},t.appPW.value&&t.newAppPW.value&&t.confirmNewPW.value){e.next=8;break}return t.changePWErrMsg.textContent=ke(w),De.show(t.changePWErrMsg),n(),e.abrupt("return");case 8:if(t.newAppPW.value===t.confirmNewPW.value){e.next=13;break}return t.changePWErrMsg.textContent=ke(_),De.show(t.changePWErrMsg),n(),e.abrupt("return");case 13:return r=st().loading(t.changeAppPW),a={appPW:t.appPW.value,newAppPW:t.newAppPW.value},n(),e.next=18,nt("/api/changeapppass",a);case 18:if(o=e.sent,r(),st().checkResponse(o,!0)){e.next=24;break}return t.changePWErrMsg.textContent=o.msg,De.show(t.changePWErrMsg),e.abrupt("return");case 24:De.hide(t.forms);case 25:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"unload",value:function(){De.unbind(document,"keyup",this.keyup)}},{key:"animateRegAsset",value:(n=o(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:De.hide(t),n=this.page.regAssetForm,this.currentForm=n,this.regAssetForm.animate(),De.show(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"animateConfirmForm",value:(t=o(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.confirmRegisterForm.animate(),n=this.page.confirmRegForm,this.currentForm=n,De.hide(t),De.show(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),x}($e);function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var tn=function(){function e(t,n,r){i(this,e),u(this,"base",void 0),u(this,"baseSymbol",void 0),u(this,"quote",void 0),u(this,"quoteSymbol",void 0),u(this,"buys",void 0),u(this,"sells",void 0),this.base=t.base,this.baseSymbol=n,this.quote=t.quote,this.quoteSymbol=r,this.buys=t.book.buys||[],this.sells=t.book.sells||[]}return c(e,[{key:"add",value:function(e){if(0!==e.qtyAtomic){var t=e.sell?this.sells:this.buys;t.splice(function(e,t,n){for(var r=0;r<e.length;r++)if(e[r].rate<t===n)return r;return e.length}(t,e.rate,!e.sell),0,e)}else window.log("zeroqty","zero quantity order encountered",e)}},{key:"remove",value:function(e){this.removeFromSide(this.sells,e)||this.removeFromSide(this.buys,e)}},{key:"removeFromSide",value:function(e,t){var n=r(this.findOrder(e,t),2),a=n[0],o=n[1];return!!a&&(e.splice(o,1),!0)}},{key:"findOrder",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].token===t)return[e[n],n];return[null,-1]}},{key:"updateRemaining",value:function(e,t,n){this.updateRemainingSide(this.sells,e,t,n)||this.updateRemainingSide(this.buys,e,t,n)}},{key:"updateRemainingSide",value:function(e,t,n,r){var a=this.findOrder(e,t)[0];return!!a&&(a.qty=n,a.qtyAtomic=r,!0)}},{key:"setEpoch",value:function(e){var t=function(t){return void 0===t.epoch||0===t.epoch||t.epoch===e};this.sells=this.sells.filter(t),this.buys=this.buys.filter(t)}},{key:"empty",value:function(){return!this.sells.length&&!this.buys.length}},{key:"count",value:function(){return this.sells.length+this.buys.length}},{key:"bestGapOrder",value:function(e){var t,n=null,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return en(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?en(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(!a.epoch)return a;n||(n=a)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"bestGapBuy",value:function(){return this.bestGapOrder(this.buys)}},{key:"bestGapSell",value:function(){return this.bestGapOrder(this.sells)}}]),e}();function nn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return rn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){s=!0,o=e})),f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function an(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ke(e);if(t){var a=Ke(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ye(this,n)}}var on=De.bind,sn=De.unbind,cn=2*Math.PI,un=String.fromCharCode(59914),ln=String.fromCharCode(59915),hn={axisLabel:"#b1b1b1",gridBorder:"#3a3a3a",gridLines:"#2a2a2a",gapLine:"#6b6b6b",value:"#9a9a9a",zoom:"#5b5b5b",zoomHover:"#aaa",sellLine:"#ae3333",buyLine:"#05a35a",sellFill:"#591a1a",buyFill:"#02572f",crosshairs:"#888",legendFill:"black",legendText:"#d5d5d5"},dn={axisLabel:"#1b1b1b",gridBorder:"#3a3a3a",gridLines:"#dadada",gapLine:"#595959",value:"#4d4d4d",zoom:"#777",zoomHover:"#333",sellLine:"#99302b",buyLine:"#207a46",sellFill:"#bd5959",buyFill:"#4cad75",crosshairs:"#595959",legendFill:"#e6e6e6",legendText:"#1b1b1b"},fn=function(){function e(t,n){var r=this;i(this,e),u(this,"parent",void 0),u(this,"report",void 0),u(this,"theme",void 0),u(this,"canvas",void 0),u(this,"visible",void 0),u(this,"ctx",void 0),u(this,"mousePos",void 0),u(this,"rect",void 0),u(this,"wheelLimiter",void 0),u(this,"boundResizer",void 0),u(this,"plotRegion",void 0),u(this,"xRegion",void 0),u(this,"yRegion",void 0),u(this,"dataExtents",void 0),this.parent=t,this.report=n,this.theme=Ve.isDark()?hn:dn,this.canvas=document.createElement("canvas"),this.visible=!0,t.appendChild(this.canvas);var a=this.canvas.getContext("2d");a?(this.ctx=a,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.mousePos=null,on(this.canvas,"mousemove",(function(e){r.mousePos={x:e.clientX-r.rect.left,y:e.clientY-r.rect.y},r.draw()})),on(this.canvas,"mouseleave",(function(){r.mousePos=null,r.draw()})),this.wheelLimiter=null,on(this.canvas,"wheel",(function(e){r.wheel(e)})),this.boundResizer=function(){r.resize(t.clientHeight)},on(window,"resize",this.boundResizer),on(this.canvas,"click",(function(e){r.click(e)}))):console.error("error getting canvas context")}return c(e,[{key:"wheeled",value:function(){var e=this;this.wheelLimiter=window.setTimeout((function(){e.wheelLimiter=null}),100)}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"draw",value:function(){this.render()}},{key:"click",value:function(e){this.report.click(e)}},{key:"wheel",value:function(e){this.zoom(e.deltaY<0),e.preventDefault()}},{key:"resize",value:function(e){var t=this;this.canvas.width=this.parent.clientWidth,this.canvas.height=e-20;var n=new vn(40,this.canvas.width,10,this.canvas.height-30),r=new vn(40,this.canvas.width,this.canvas.height-30,this.canvas.height),a=new vn(0,40,10,this.canvas.height-30);this.plotRegion=new yn(this.ctx,n),this.xRegion=new yn(this.ctx,r),this.yRegion=new yn(this.ctx,a),window.requestAnimationFrame((function(){t.rect=t.canvas.getBoundingClientRect(),t.report.resize()}))}},{key:"zoom",value:function(e){this.wheelLimiter||this.report.zoom(e)}},{key:"hide",value:function(){this.visible=!1,De.hide(this.canvas)}},{key:"show",value:function(){this.visible=!0,De.show(this.canvas),this.resize(this.parent.clientHeight)}},{key:"unattach",value:function(){sn(window,"resize",this.boundResizer)}},{key:"render",value:function(){console.error("child class must override render method")}},{key:"applyLabelStyle",value:function(){this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.font="12px 'sans', sans-serif",this.ctx.fillStyle=this.theme.axisLabel}},{key:"plotXLabels",value:function(e,t,n,r){var a=this,o=new vn(t,n,0,1);this.xRegion.plot(o,(function(o,i){a.applyLabelStyle();var s=(n+t)/2,c=t,u=s;e.lbls.forEach((function(e){o.fillText(e.txt,i.x(e.val),i.y(.5)),s>=c&&s<e.val&&(u=(c+e.val)/2),c=e.val})),o.font="11px 'sans', sans-serif",2===r.length?(o.fillText(r[0],i.x(u),i.y(.63)),o.fillText(r[1],i.x(u),i.y(.23))):1===r.length&&o.fillText(r[0],i.x(u),i.y(.5))}),!0),this.plotRegion.plot(o,(function(t,n){t.lineWidth=1,t.strokeStyle=a.theme.gridLines,e.lbls.forEach((function(e){bn(t,n.x(e.val),n.y(0),n.x(e.val),n.y(1))}))}),!0)}},{key:"plotYLabels",value:function(e,t,n,r,a){var o=this,i=new vn(0,1,n,r);this.yRegion.plot(i,(function(e,n){o.applyLabelStyle();var i=r/2,s=0,c=i;t.lbls.forEach((function(t){e.fillText(t.txt,n.x(.5),n.y(t.val)),i>=s&&i<t.val&&(c=(s+t.val)/2),s=t.val})),e.fillText(a,n.x(.5),n.y(c))}),!0),e.plot(i,(function(e,n){e.lineWidth=1,e.strokeStyle=o.theme.gridLines,t.lbls.forEach((function(t){bn(e,n.x(0),n.y(t.val),n.x(1),n.y(t.val))}))}),!0)}},{key:"doYLabels",value:function(e,t,n,r){var a=gn(this.ctx,e.height(),this.dataExtents.y.min,this.dataExtents.y.max,50,t,n,r),o=1.5*(a.widest||0);return this.yRegion.extents.x.max=o,this.yRegion.extents.y.max=e.extents.y.max,this.plotRegion.extents.x.min=o,this.xRegion.extents.x.min=o,this.plotYLabels(e,a,this.dataExtents.y.min,this.dataExtents.y.max,n),a}},{key:"drawFrame",value:function(){var e=this;this.plotRegion.plot(new vn(0,1,0,1),(function(t,n){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.beginPath(),n.dataCoords((function(){t.moveTo(0,0),t.lineTo(0,1),t.lineTo(1,1),t.lineTo(1,0),t.lineTo(0,0)})),t.stroke()}))}}]),e}(),pn=function(e){Xe(n,e);var t=an(n);function n(e,r,a){var o;return i(this,n),u(He(o=t.call(this,e,{resize:function(){return o.resized()},click:function(e){return o.clicked(e)},zoom:function(e){return o.zoomed(e)}})),"reporters",void 0),u(He(o),"book",void 0),u(He(o),"zoomLevel",void 0),u(He(o),"lotSize",void 0),u(He(o),"rateStep",void 0),u(He(o),"lines",void 0),u(He(o),"markers",void 0),u(He(o),"zoomInBttn",void 0),u(He(o),"zoomOutBttn",void 0),u(He(o),"baseUnit",void 0),u(He(o),"quoteUnit",void 0),o.reporters=r,o.zoomLevel=a,o.lines=[],o.markers={buys:[],sells:[]},o.setZoomBttns(),o.resize(e.clientHeight),o}return c(n,[{key:"setZoomBttns",value:function(){this.zoomInBttn=new yn(this.ctx,new vn(0,0,0,0)),this.zoomOutBttn=new yn(this.ctx,new vn(0,0,0,0))}},{key:"resized",value:function(){this.setZoomBttns(),this.book&&this.draw()}},{key:"zoomed",value:function(e){var t;this.zoomLevel&&this.book.buys&&this.book.sells&&(this.wheeled(),this.zoomLevel*=e?2/3:1.5,this.zoomLevel=(2,(t=this.zoomLevel)<.005?.005:t>2?2:t),this.draw(),this.reporters.zoom(this.zoomLevel))}},{key:"clicked",value:function(e){if(this.dataExtents){var t=e.clientX-this.rect.left,n=e.clientY-this.rect.y;if(this.zoomInBttn.contains(t,n))this.zoom(!0);else if(this.zoomOutBttn.contains(t,n))this.zoom(!1);else{var r=this.plotRegion.translator(this.dataExtents);this.reporters.click(r.unx(t))}}}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"set",value:function(e,t,n,a,o){this.book=e,this.lotSize=t/a.conventional.conversionFactor;var i=[o.conventional.conversionFactor,a.conventional.conversionFactor],s=i[0],c=i[1];if(this.rateStep=n/ft*s/c,this.baseUnit=a.conventional.unit,this.quoteUnit=o.conventional.unit,!this.zoomLevel){var u=r(this.gap(),2),l=u[0],h=u[1],d=Math.max(h/l*5,.05);this.zoomLevel=Math.min(d,2)}this.draw()}},{key:"render",value:function(){var e=this;if(this.book&&this.visible){this.clear();var t=this.ctx,n=this.mousePos,a=this.book.buys,o=this.book.sells,i=r(this.gap(),2),s=i[0],c=i[1],u=this.zoomLevel*s/2,l=s+u,h=s-u,d=it(this.markers.buys),f=it(this.markers.sells);d.sort((function(e,t){return t.rate-e.rate})),f.sort((function(e,t){return e.rate-t.rate}));for(var p=[],m=[],v=[],y=[],g=[],w={buyBase:0,buyQuote:0,sellBase:0,sellQuote:0},k=0,b=0,x=0;x<a.length;x++){var C=a[x];if(b+=C.qty,C.rate>=h&&v.push([C.rate,b]),!C.epoch)for(k+=C.qty,m.push([C.rate,k]),w.buyBase+=C.qty,w.buyQuote+=C.qty*C.rate;d.length&&Sn(d[0].rate,C.rate);){var S=d.shift();S&&p.push({rate:S.rate,qty:C.epoch?b:k,sell:C.sell,active:S.active})}}var F=m.length?kn(m)[1]:0;m.push([h,F]);var E=v.length?kn(v)[1]:0;v.push([h,E]),b=k=0;for(var A=0;A<o.length;A++){var R=o[A];if(b+=R.qty,R.rate<=l&&g.push([R.rate,b]),!R.epoch)for(k+=R.qty,y.push([R.rate,k]),w.sellBase+=R.qty,w.sellQuote+=R.qty*R.rate;f.length&&Sn(f[0].rate,R.rate);){var I=f.shift();I&&p.push({rate:I.rate,qty:R.epoch?b:k,sell:R.sell,active:I.active})}}var O=y.length?kn(y)[1]:0;y.push([l,O]);var D=g.length?kn(g)[1]:0;g.push([l,D]);var T=this.xRegion.extents.y.min,L=(T+30)/T,P=(D&&E?Math.max(E,D):D||E||1)*L,W=new vn(h,l,0,P);this.dataExtents=W,this.doYLabels(this.plotRegion,this.lotSize,this.baseUnit);var B=gn(t,this.plotRegion.width(),W.x.min,W.x.max,100,this.rateStep,"");this.plotXLabels(B,h,l,["".concat(this.quoteUnit,"/"),this.baseUnit]);var q=null;this.drawFrame(),this.plotRegion.plot(W,(function(t,r){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.lineWidth=2.5,t.strokeStyle=e.theme.gapLine,bn(t,r.x(s),r.y(0),r.x(s),r.y(.3*W.y.max)),t.font="30px 'demi-sans', sans-serif",t.textAlign="center",t.textBaseline="middle",t.fillStyle=e.theme.value;var a=.5*W.y.max;t.fillText(Cn(s),r.x(s),r.y(a)),t.font="12px 'sans', sans-serif",t.fillText("".concat((c/s*100).toFixed(2),"% spread"),r.x(s),r.y(a)+24),t.textAlign="center",t.textBaseline="middle";var o=e.plotRegion.extents.midX,i=r.y(.9*P),u=W.xRange/s*100,d="".concat(u.toFixed(1),"%"),f=t.measureText(d).width;t.font="13px 'sans', sans-serif",t.fillText(d,o,i+1);var v=o-f/2-10-20,g=i-10;e.zoomOutBttn.setExtents(v,v+20,g,g+20);var w=n&&e.zoomOutBttn.contains(n.x,n.y);e.zoomOutBttn.plot(new vn(0,1,0,1),(function(t){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,w&&(t.fillStyle=e.theme.zoomHover,t.font="13px 'icomoon'"),t.fillText(ln,e.zoomOutBttn.extents.midX,e.zoomOutBttn.extents.midY)})),v=o+f/2+10,e.zoomInBttn.setExtents(v,v+20,g,g+20),w=n&&e.zoomInBttn.contains(n.x,n.y),e.zoomInBttn.plot(new vn(0,1,0,1),(function(t){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,w&&(t.fillStyle=e.theme.zoomHover,t.font="14px 'icomoon'"),t.fillText(un,e.zoomInBttn.extents.midX,e.zoomInBttn.extents.midY)}));var k,b=function(e,n){e>l||e<h||(t.save(),t.setLineDash([3,5]),t.lineWidth=1.5,t.strokeStyle=n,bn(t,r.x(e),r.y(0),r.x(e),r.y(P)),t.restore())},x=nn(e.lines||[]);try{for(x.s();!(k=x.n()).done;){var C=k.value;b(C.rate,C.color)}}catch(e){x.e(e)}finally{x.f()}var S,F=.005*(l-h),E=[],A=nn(p||[]);try{for(A.s();!(S=A.n()).done;){var R=S.value,I=n&&Fn(R.rate,r.unx(n.x),F);I&&E.push(R.rate),t.save(),t.lineWidth=I||R.active?5:3,t.strokeStyle=R.sell?e.theme.sellLine:e.theme.buyLine,t.fillStyle=R.sell?e.theme.sellFill:e.theme.buyFill;var O=I||R.active?10:8;t.beginPath();var D={x:r.x(R.rate),y:r.y(R.qty)-8},T=D.y-Math.sqrt(3)*O/2;t.moveTo(D.x,D.y),t.lineTo(D.x-O/2,T),t.lineTo(D.x+O/2,T),t.closePath(),t.stroke(),t.fill(),t.restore()}}catch(e){A.e(e)}finally{A.f()}if(n&&e.plotRegion.contains(n.x,n.y)){var L=r.unx(n.x),B=y,M=function(e){return e>=L},N=e.theme.sellLine;L<s&&(B=m,M=function(e){return e<=L},N=e.theme.buyLine);for(var U=B[0],z=0;z<B.length;z++){var j=B[z];if(M(j[0]))break;U=j}b(L,e.theme.crosshairs),q={rate:L,depth:U[1],dotColor:N,hoverMarkers:E}}})),t.lineWidth=1.5,t.setLineDash([3,3]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(g),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(v),t.lineWidth=2.5,t.setLineDash([]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(y),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(m),q&&this.plotRegion.plot(W,(function(e,t){q&&function(e,t,n,r,a){e.fillStyle=r,e.beginPath(),e.arc(t,n,5,0,cn),e.fill()}(e,t.x(q.rate),t.y(q.depth),q.dotColor)})),this.reporters.volume(w),this.reporters.mouse(q)}}},{key:"drawDepth",value:function(e){var t,n=e[0],r=n[1];this.plotRegion.plot(this.dataExtents,(function(a,o){o.dataCoords((function(){a.beginPath(),a.moveTo(n[0],n[1]);for(var o=0;o<e.length;o++)t=e[o][0],a.lineTo(t,r),r=e[o][1],a.lineTo(t,r)})),a.stroke(),o.dataCoords((function(){a.lineTo(t,0),a.lineTo(n[0],0)})),a.closePath(),a.globalAlpha=.25,a.fill()}))}},{key:"gap",value:function(){var e=[this.book.bestGapBuy(),this.book.bestGapSell()],t=e[0],n=e[1];return t?n?[(n.rate+t.rate)/2,n.rate-t.rate]:[t.rate,0]:n?[n.rate,0]:[1,0]}},{key:"setLines",value:function(e){this.lines=e}},{key:"setMarkers",value:function(e){this.markers=e}}]),n}(fn),mn=function(e){Xe(n,e);var t=an(n);function n(e,r){var a;return i(this,n),u(He(a=t.call(this,e,{resize:function(){return a.resized()},click:function(){a.clicked()},zoom:function(e){return a.zoomed(e)}})),"reporters",void 0),u(He(a),"data",void 0),u(He(a),"zoomLevel",void 0),u(He(a),"numToShow",void 0),u(He(a),"candleRegion",void 0),u(He(a),"volumeRegion",void 0),u(He(a),"resizeTimer",void 0),u(He(a),"zoomLevels",void 0),u(He(a),"market",void 0),u(He(a),"rateConversionFactor",void 0),a.reporters=r,a.zoomLevel=1,a.numToShow=100,a.resize(e.clientHeight),a}return c(n,[{key:"resized",value:function(){var e=this,t=this.plotRegion.extents,n=new vn(t.x.min,t.x.max,t.y.min,t.y.min+.85*t.yRange);this.candleRegion=new yn(this.ctx,n);var r=new vn(t.x.min,t.x.max,t.y.min+.85*t.yRange,t.y.max);this.volumeRegion=new yn(this.ctx,r),this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=window.setTimeout((function(){return e.draw()}),100)}},{key:"clicked",value:function(){}},{key:"zoomed",value:function(e){var t=this.zoomLevels.indexOf(this.numToShow);if(e){if(0===t)return;this.numToShow=this.zoomLevels[t-1]}else{if(this.zoomLevels.length<=t+1||this.numToShow>this.data.candles.length)return;this.numToShow=this.zoomLevels[t+1]}this.draw()}},{key:"render",value:function(){var e=this,t=this.data;if(t&&this.visible){var n=t.ms,r=this.mousePos,a=t.candles||[],o=Math.min(this.numToShow,a.length),i=a.slice(a.length-o);if(this.clear(),0!==o){var s,c=function(e){return En(e.endStamp,n)},u=function(e){return c(e)+n},l=function(e){return c(e)+.2*n},h=.6*n,d=i[0],f=i[o-1],p=[d.highRate,d.lowRate,d.matchVolume],m=p[0],v=p[1],y=p[2],g=nn(i);try{for(g.s();!(s=g.n()).done;){var w=s.value;w.highRate>m&&(m=w.highRate),w.lowRate<v&&(v=w.lowRate),w.matchVolume>y&&(y=w.matchVolume)}}catch(e){g.e(e)}finally{g.f()}var k=this.market.ratestep,b=new vn(c(d),u(f),v,m);v===m&&(b.y.min-=k,b.y.max+=k),this.dataExtents=b;var x=this.rateConversionFactor;this.doYLabels(this.candleRegion,k,this.market.quotesymbol,(function(e){return Cn(e/x)})),this.candleRegion.extents.x.min=this.yRegion.extents.x.max,this.volumeRegion.extents.x.min=this.yRegion.extents.x.max;var C=function(e,t,n,r){var a=e[0],o=e[e.length-1],i=En(a.endStamp,t),s=En(o.endStamp,t)+t,c=s-i,u=Math.min(e.length,n/100),l=En(c/u,t);if(0===l)return console.error("zero tick",t,c,u),{lbls:[]};var h=i,d=(new Date).getTimezoneOffset(),f=function(e){return(e-=6e4*d)-e%864e5},p=f(i),m=0;f(a.endStamp)===f(o.endStamp)&&(p=0);var v,y=[];for(v=t<864e5?function(e,t){return f(t)!==p?"".concat(wn[e.getMonth()]).concat(e.getDate()," ").concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0")):"".concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0"))}:function(e){var t=e.getFullYear();return t!==m?"".concat(wn[e.getMonth()]).concat(e.getDate()," '").concat(String(t).slice(2,4)):"".concat(wn[e.getMonth()]).concat(e.getDate())};h<=s;){var g=new Date(h);y.push({val:h,txt:v(g,h)}),p=f(h),m=g.getFullYear(),h+=l}return{lbls:y}}(i,n,this.plotRegion.width());this.plotXLabels(C,c(d),u(f),[]),this.drawFrame();var S=null;if(r&&(this.plotRegion.plot(new vn(b.x.min,b.x.max,0,1),(function(t,a){var o,s=En(a.unx(r.x),n),u=nn(i);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(c(l)===s){S=l,t.fillStyle=e.theme.gridLines,t.fillRect(a.x(c(l)),a.y(0),a.w(n),a.h(1));break}}}catch(e){u.e(e)}finally{u.f()}})),S)){var F=this.xRegion.extents.y;this.xRegion.plot(new vn(b.x.min,b.x.max,F.min,F.max),(function(t,n){if(S){e.applyLabelStyle();var r="".concat(new Date(c(S)).toLocaleString()," - ").concat(new Date(u(S)).toLocaleString()),a=t.measureText(r).width+50,o=n.x((c(S)+u(S))/2),i=o-a/2,s=e.xRegion.extents.x;i<s.min?i=s.min:i+a>s.max&&(i=s.max-a),o=i+a/2;var l=F.min+(e.xRegion.height()-16)/2;t.fillStyle=e.theme.legendFill,t.strokeStyle=e.theme.gridBorder;var h=[i-25,l-2,a+50,20];t.fillRect.apply(t,h),t.strokeRect.apply(t,h),e.applyLabelStyle(),t.fillText(r,o,e.xRegion.extents.midY,a)}}))}var E=new vn(c(d),u(f),0,y);this.volumeRegion.plot(E,(function(t,n){t.fillStyle=e.theme.gridBorder;var r,a=nn(i);try{for(a.s();!(r=a.n()).done;){var o=r.value;t.fillRect(n.x(l(o)),n.y(0),n.w(h),n.h(o.matchVolume))}}catch(e){a.e(e)}finally{a.f()}})),this.candleRegion.plot(b,(function(t,n){t.lineWidth=1;var r,a=nn(i);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.startRate>o.endRate,c=[n.x(l(o)),n.y(o.startRate),n.w(h),n.h(o.endRate-o.startRate)],u=c[0],d=c[1],f=c[2],p=c[3],m=[n.y(o.highRate),n.y(o.lowRate),f/2+u],v=m[0],y=m[1],g=m[2];t.strokeStyle=s?e.theme.sellLine:e.theme.buyLine,t.fillStyle=s?e.theme.sellFill:e.theme.buyFill,t.beginPath(),t.moveTo(g,v),t.lineTo(g,y),t.stroke(),t.fillRect(u,d,f,p),t.strokeRect(u,d,f,p)}}catch(e){a.e(e)}finally{a.f()}})),this.reporters.mouse(S)}}}},{key:"setCandles",value:function(e,t,n,r){if(this.data=e,e.candles){this.market=t;var a=[r.conventional.conversionFactor,n.conventional.conversionFactor],o=a[0],i=a[1];this.rateConversionFactor=ft*i/o;var s=25;this.zoomLevels=[];for(var c=Math.max(e.candles.length,1e3);s<c;)this.zoomLevels.push(s),s*=2;this.numToShow=100,this.draw()}}}]),n}(fn),vn=function(){function e(t,n,r,a){i(this,e),u(this,"x",void 0),u(this,"y",void 0),this.setExtents(t,n,r,a)}return c(e,[{key:"setExtents",value:function(e,t,n,r){this.x={min:e,max:t},this.y={min:n,max:r}}},{key:"xRange",get:function(){return this.x.max-this.x.min}},{key:"midX",get:function(){return(this.x.max+this.x.min)/2}},{key:"yRange",get:function(){return this.y.max-this.y.min}},{key:"midY",get:function(){return(this.y.max+this.y.min)/2}}]),e}(),yn=function(){function e(t,n){i(this,e),u(this,"context",void 0),u(this,"extents",void 0),this.context=t,this.extents=n}return c(e,[{key:"setExtents",value:function(e,t,n,r){this.extents.setExtents(e,t,n,r)}},{key:"width",value:function(){return this.extents.xRange}},{key:"height",value:function(){return this.extents.yRange}},{key:"contains",value:function(e,t){var n=this.extents;return e<n.x.max&&e>n.x.min&&t<n.y.max&&t>n.y.min}},{key:"translator",value:function(e){var t=this.extents,n=e.x.min,r=e.y.min,a=e.yRange,o=e.xRange,i=t.x.min,s=t.x.max-i,c=t.y.max,u=c-t.y.min,l=s/o,h=u/a;return{x:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return(e-n)*l+i})),y:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return c-(e-r)*h})),unx:function(e){return(e-i)/l+n},uny:function(e){return r-(e-c)/h},w:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return e/o*s})),h:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return-e/a*u})),dataCoords:function(){}}}},{key:"clear",value:function(){var e=this.extents;this.context.clearRect(e.x.min,e.y.min,e.xRange,e.yRange)}},{key:"plot",value:function(e,t,n){var r=this.context,a=this.extents;r.save(),n||(r.beginPath(),r.rect(a.x.min,a.y.min,a.xRange,a.yRange),r.clip());var o=this.translator(e),i=e.yRange,s=a.xRange/e.xRange,c=a.yRange/i,u=e.x.min,l=e.y.min,h=a.x.min+u-u*s,d=-a.y.min-(i-l)*c;o.dataCoords=function(e){r.save(),r.transform(1,0,0,-1,-u,l),r.transform(s,0,0,c,h,d),e(),r.restore()},t(this.context,o),r.restore()}}]),e}();function gn(e,t,n,r,a,o,i,s){s=s||Cn;var c=t/a,u=r-n;if(c<1||u<=0)return{lbls:[]};for(var l=u/c,h=l+o-l%o,d=n+h-n%h,f=Math.max(Math.abs(r),Math.abs(n)),p=Math.round(Math.log10(f/h))+2,m=[],v=0;d<r;){var y=s(d=Number(d.toPrecision(p)));v=Math.max(v,e.measureText(y).width),m.push({val:d,txt:y}),d+=h}var g=e.measureText(i).width;return g>v&&(v=g),{widest:v,lbls:m}}var wn=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function kn(e){return e[e.length-1]}function bn(e,t,n,r,a,o){e.beginPath(),e.moveTo(t,n),e.lineTo(r,a),o||e.stroke()}var xn={minimumSignificantDigits:4,maximumSignificantDigits:5};function Cn(e){return e.toLocaleString("en-us",xn)}function Sn(e,t){return Fn(e,t,1e-8)}function Fn(e,t,n){return Math.abs(e-t)<Math.abs(n)}function En(e,t){return e-e%t}function An(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rn(e,t,n){if(e||!t.error){if(void 0!==n[e])for(var r=0;r<n[e].length;r++)n[e][r](t)}else{var a=t.error;console.error("websocket error (code ".concat(a.code,"): ").concat(a.message))}}var In=0;const On=new(function(){function e(){i(this,e),u(this,"uri",void 0),u(this,"connection",void 0),u(this,"handlers",void 0),u(this,"queue",void 0),u(this,"maxQlength",void 0),u(this,"reloader",void 0),this.handlers={},this.queue=[],this.maxQlength=5}return c(e,[{key:"registerRoute",value:function(e,t){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push(t)}},{key:"deregisterRoute",value:function(e){this.handlers[e]=[]}},{key:"request",value:function(e,t){if(this.connection&&this.connection.readyState===window.WebSocket.OPEN){In++;var n=JSON.stringify({route:e,type:1,id:In,payload:t});window.log("ws","sending",n),this.connection.send(n)}else{for(;this.queue.length>this.maxQlength-1;)this.queue.shift();this.queue.push([e,t])}}},{key:"close",value:function(e){window.log("ws","close, reason:",e,this.handlers),this.handlers={},this.connection&&this.connection.close()}},{key:"connect",value:function(e,t){var n=this;this.uri=e,this.reloader=t;var a=0;!function o(){window.log("ws","connecting to ".concat(e));var i=n.connection=new window.WebSocket(e);if(i){var s=setTimeout((function(){i&&i.close()}),500);i.onmessage=function(e){var t=JSON.parse(e.data);Rn(t.route,t.payload,n.handlers)},i.onclose=function(e){window.log("ws","onclose"),clearTimeout(s),i=n.connection=null,Rn("close",null,n.handlers),a++;var t=Math.min(Math.pow(1.25,a),10);console.error("websocket disconnected (".concat(e.code,"), trying again in ").concat(t.toFixed(1)," seconds")),setTimeout((function(){o()}),1e3*t)},i.onopen=function(){window.log("ws","onopen"),clearTimeout(s),a>0&&(a=0,t()),Rn("open",null,n.handlers);var e=n.queue;n.queue=[];var o,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return An(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?An(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}(e);try{for(i.s();!(o=i.n()).done;){var c=r(o.value,2),u=c[0],l=c[1];n.request(u,l)}}catch(e){i.e(e)}finally{i.f()}},i.onerror=function(e){window.log("ws","onerror:",e),Rn("error",e,n.handlers)}}}()}}]),e}());function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ln(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){s=!0,o=e})),f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wn=De.bind,Bn="book",qn="book_order",Mn="unbook_order",Nn="update_remaining",Un="epoch_order",zn="candles",jn="candle_update",_n="selectedMarket",Vn="chartRatio",Hn="depthZoom",Gn="depth_chart",Xn="candle_chart",Qn=document.createElement("span");Qn.classList.add("ico-check");var Yn=new Intl.NumberFormat(document.documentElement.lang,{minimumFractionDigits:1,maximumFractionDigits:2}),Kn=function(e){Xe(E,e);var t,n,a,s,l,h,d,f,p,m,v,g,w,x,C,S,F=(C=E,S=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(C);if(S){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function E(e,t){var n;i(this,E),u(He(n=F.call(this)),"page",void 0),u(He(n),"main",void 0),u(He(n),"loaded",void 0),u(He(n),"maxLoaded",void 0),u(He(n),"maxOrderUpdateCounter",void 0),u(He(n),"market",void 0),u(He(n),"currentForm",void 0),u(He(n),"openAsset",void 0),u(He(n),"openFunc",void 0),u(He(n),"currentCreate",void 0),u(He(n),"maxEstimateTimer",void 0),u(He(n),"book",void 0),u(He(n),"cancelData",void 0),u(He(n),"metaOrders",void 0),u(He(n),"preorderCache",void 0),u(He(n),"currentOrder",void 0),u(He(n),"depthLines",void 0),u(He(n),"activeMarkerRate",void 0),u(He(n),"hovers",void 0),u(He(n),"ordersSortKey",void 0),u(He(n),"ordersSortDirection",void 0),u(He(n),"ogTitle",void 0),u(He(n),"depthChart",void 0),u(He(n),"candleChart",void 0),u(He(n),"currentChart",void 0),u(He(n),"candleDur",void 0),u(He(n),"balanceWgt",void 0),u(He(n),"marketList",void 0),u(He(n),"quoteUnits",void 0),u(He(n),"baseUnits",void 0),u(He(n),"unlockForm",void 0),u(He(n),"newWalletForm",void 0),u(He(n),"keyup",void 0),u(He(n),"secondTicker",void 0),u(He(n),"candlesLoading",void 0),u(He(n),"accelerateOrderForm",void 0);var r=n.page=De.idDescendants(e);if(n.main=e,!n.main.parentElement)return Ye(n);n.loaded=st().loading(n.main.parentElement),n.maxOrderUpdateCounter=0,n.metaOrders={},n.preorderCache={},n.depthLines={hover:[],input:[]},n.hovers=[],n.ordersSortKey="submitTime",n.ordersSortDirection=1,n.ogTitle=document.title;var a={click:function(e){n.reportDepthClick(e)},volume:function(e){n.reportDepthVolume(e)},mouse:function(e){n.reportDepthMouse(e)},zoom:function(e){n.reportDepthZoom(e)}};n.depthChart=new pn(r.marketChart,a,Ve.fetch(Hn));var s={mouse:function(e){n.reportMouseCandle(e)}};n.candleChart=new mn(r.marketChart,s),n.accelerateOrderForm=new qt(r.accelerateForm,(function(){})),n.candleChart.hide(),n.currentChart=Gn,n.candleDur="";var c=n.balanceWgt=new er(r.balanceTable),l=c.base.stateIcons.icons,h=c.quote.stateIcons.icons;Wn(c.base.connect,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Wn(c.quote.connect,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Wn(c.base.expired,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Wn(c.quote.expired,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Wn(l.sleeping,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Wn(h.sleeping,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Wn(l.locked,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),Wn(h.locked,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),Wn(c.base.newWalletBttn,"click",(function(){n.showCreate(n.market.base)})),Wn(c.quote.newWalletBttn,"click",(function(){n.showCreate(n.market.quote)})),bt(r),De.cleanTemplates(r.rowTemplate,r.liveTemplate,r.durBttnTemplate,r.booleanOptTmpl,r.rangeOptTmpl,r.orderOptTmpl),n.marketList=new Zn(r.marketList);var d,f=Ln(n.marketList.xcSections);try{var p=function(){var e=d.value;if(!e.marketRows)return"continue";var t,r=Ln(e.marketRows);try{var a=function(){var r=t.value;Wn(r.node,"click",(function(){n.setMarket(e.host,r.mkt.baseid,r.mkt.quoteid)}))};for(r.s();!(t=r.n()).done;)a()}catch(e){r.e(e)}finally{r.f()}};for(f.s();!(d=f.n()).done;)p()}catch(e){f.e(e)}finally{f.f()}n.quoteUnits=e.querySelectorAll("[data-unit=quote]"),n.baseUnits=e.querySelectorAll("[data-unit=base]"),Wn(r.buyBttn,"click",(function(){ar(r.sellBttn,r.buyBttn),r.submitBttn.classList.remove("sellred"),r.submitBttn.classList.add("buygreen"),r.maxLbl.textContent=ke(I),n.setOrderBttnText(),n.setOrderVisibility(),n.drawChartLines()})),Wn(r.sellBttn,"click",(function(){ar(r.buyBttn,r.sellBttn),r.submitBttn.classList.add("sellred"),r.submitBttn.classList.remove("buygreen"),r.maxLbl.textContent=ke(O),n.setOrderBttnText(),n.setOrderVisibility(),n.drawChartLines()})),Wn(r.limitBttn,"click",(function(){ar(r.marketBttn,r.limitBttn),n.setOrderVisibility(),r.rateField.value&&(n.depthLines.input=[{rate:parseFloat(r.rateField.value||"0"),color:n.isSell()?n.depthChart.theme.sellLine:n.depthChart.theme.buyLine}],n.drawChartLines())})),Wn(r.marketBttn,"click",(function(){ar(r.limitBttn,r.marketBttn),n.setOrderVisibility(),n.setMarketBuyOrderEstimate(),n.depthLines.input=[],n.drawChartLines()})),Wn(r.maxOrd,"click",(function(){if(n.isSell()){var e=n.market.maxSell;if(!e)return;r.lotField.value=String(e.swap.lots)}else r.lotField.value=String(n.market.maxBuys[n.adjustedRate()].swap.lots);n.lotChanged()})),Wn(r.depthBttn,"click",(function(){n.depthChartSelected()})),Wn(r.candlestickBttn,"click",(function(){n.candleChartSelected()})),De.disableMouseWheel(r.rateField,r.lotField,r.qtyField,r.mktBuyField),On.registerRoute(Bn,(function(e){n.handleBookRoute(e)})),On.registerRoute(qn,(function(e){n.handleBookOrderRoute(e)})),On.registerRoute(Mn,(function(e){n.handleUnbookOrderRoute(e)})),On.registerRoute(Nn,(function(e){n.handleUpdateRemainingRoute(e)})),On.registerRoute(Un,(function(e){n.handleEpochOrderRoute(e)})),On.registerRoute(zn,(function(e){n.handleCandlesRoute(e)})),On.registerRoute(jn,(function(e){n.handleCandleUpdateRoute(e)})),n.unlockForm=new Bt(r.unlockWalletForm,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.openFunc();case 1:case"end":return e.stop()}}),e)})))),n.newWalletForm=new Dt(r.newWalletForm,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.createWallet();case 1:case"end":return e.stop()}}),e)})))),_t(r.orderForm,r.submitBttn,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stepSubmit();case 1:case"end":return e.stop()}}),e)})))),_t(r.verifyForm,r.vSubmit,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitOrder();case 1:case"end":return e.stop()}}),e)})))),De.bind(r.vUnlockSubmit,"click",o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitEstimateUnlock();case 1:case"end":return e.stop()}}),e)})))),_t(r.cancelForm,r.cancelSubmit,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitCancel();case 1:case"end":return e.stop()}}),e)})))),De.bind(r.vFeeDetails,"click",(function(){return n.showForm(r.vDetailPane)})),De.bind(r.closeDetailPane,"click",(function(){return n.showVerifyForm()})),r.liveTable.querySelectorAll("[data-ordercol]").forEach((function(e){return Wn(e,"click",(function(){return m(e.dataset.ordercol||"")}))}));var m=function(e){v(),n.ordersSortKey===e?n.ordersSortDirection*=-1:(n.ordersSortKey=e,n.ordersSortDirection=1),n.refreshActiveOrders(),g()},v=function(){r.liveTable.querySelectorAll("[data-ordercol]").forEach((function(e){return e.classList.remove("sorted-asc","sorted-dsc")}))},g=function(){var e=n.ordersSortKey,t=1===n.ordersSortDirection?"sorted-asc":"sorted-dsc";De.safeSelector(r.liveTable,"[data-ordercol=".concat(e,"]")).classList.add(t)};g();var w=function(){De.hide(r.forms),r.vPass.value="",r.cancelPass.value=""};Wn(r.forms,"mousedown",(function(e){if(De.isDisplayed(r.vDetailPane)&&!De.mouseInElement(e,r.vDetailPane))return n.showVerifyForm();De.mouseInElement(e,n.currentForm)||w()})),n.keyup=function(e){"Escape"===e.key&&w()},Wn(document,"keyup",n.keyup),r.forms.querySelectorAll(".form-closer").forEach((function(e){De.bind(e,"click",(function(){w()}))})),Wn(r.lotField,"change",(function(){n.lotChanged()})),Wn(r.lotField,"keyup",(function(){n.lotChanged()})),Wn(r.qtyField,"change",(function(){n.quantityChanged(!0)})),Wn(r.qtyField,"keyup",(function(){n.quantityChanged(!1)})),Wn(r.mktBuyField,"change",(function(){n.marketBuyChanged()})),Wn(r.mktBuyField,"keyup",(function(){n.marketBuyChanged()})),Wn(r.rateField,"change",(function(){n.rateFieldChanged()})),Wn(r.rateField,"keyup",(function(){n.previewQuoteAmt(!0)})),Wn(r.marketSearch,"change",(function(){n.filterMarkets()})),Wn(r.marketSearch,"keyup",(function(){n.filterMarkets()}));var k=function(){n.depthLines.hover=[],n.drawChartLines()};Wn(r.buyRows,"mouseleave",k),Wn(r.sellRows,"mouseleave",k),Wn(r.liveList,"mouseleave",(function(){n.activeMarkerRate=null,n.setDepthMarkers()}));var b,x=function(e){e>.7?e=.7:e<.25&&(e=.25);var t=e*(n.main.clientHeight-st().header.offsetHeight);r.marketChart.style.height="".concat(t,"px"),n.depthChart.resize(t),n.candleChart.resize(t)},C=Ve.fetch(Vn);return C&&x(C),Wn(r.chartResizer,"mousedown",(function(e){if(0===e.button){var t;e.preventDefault();var n=function(e){e.preventDefault();var n=r.rightSide.getBoundingClientRect(),a=n.bottom-n.top;t=(e.pageY-n.top)/a,x(t)};Wn(document,"mousemove",n),Wn(document,"mouseup",(function(){t&&Ve.store(Vn,t),De.unbind(document,"mousemove",n)}))}})),st().registerNoteFeeder({order:function(e){n.handleOrderNote(e)},epoch:function(e){n.handleEpochNote(e)},conn:function(e){n.handleConnNote(e)},balance:function(e){n.handleBalanceNote(e)},feepayment:function(e){n.handleFeePayment(e)},spots:function(e){n.handlePriceUpdate(e)}}),(b=t&&t.host&&void 0!==t.base&&void 0!==t.quote?tr(t.host,parseInt(t.base),parseInt(t.quote)):Ve.fetch(_n))&&n.marketList.exists(b.host,b.base,b.quote)||(b=n.marketList.first()),n.setMarket(b.host,b.base,b.quote),n.secondTicker=window.setInterval((function(){for(var e=0,t=Object.values(n.metaOrders);e<t.length;e++){var r=t[e];De.tmplElement(r.row,"age").textContent=De.timeSince(r.order.submitTime)}}),1e3),n.setRegistrationStatusVisibility(),n.setBalanceVisibility(),n}return c(E,[{key:"isSell",value:function(){return this.page.sellBttn.classList.contains("selected")}},{key:"isLimit",value:function(){return this.page.limitBttn.classList.contains("selected")}},{key:"hasFeePending",value:function(){return!!this.market.dex.pendingFee}},{key:"assetsAreSupported",value:function(){var e=[this.market.base,this.market.quote];return e[0]&&e[1]}},{key:"setOrderVisibility",value:function(){var e=this.page;this.isLimit()?(De.show(e.priceBox,e.tifBox,e.qtyBox,e.maxBox),De.hide(e.mktBuyBox),this.previewQuoteAmt(!0)):(De.hide(e.tifBox,e.maxBox,e.priceBox),this.isSell()?(De.hide(e.mktBuyBox),De.show(e.qtyBox),this.previewQuoteAmt(!0)):(De.show(e.mktBuyBox),De.hide(e.qtyBox),this.previewQuoteAmt(!1)))}},{key:"resolveOrderFormVisibility",value:function(){var e=this.page;De.hide(e.orderForm);var t=!this.hasFeePending(),n=this.assetsAreSupported(),r=this.market,a=r.base,o=r.quote,i=a&&st().assets[a.id].wallet&&o&&st().assets[o.id].wallet;t&&n&&i&&De.show(e.orderForm)}},{key:"setLoaderMsgVisibility",value:function(){var e=this.page,t=this.market;if(this.assetsAreSupported())De.hide(e.loaderMsg);else{var n=t.base?t.quoteCfg.symbol:t.baseCfg.symbol;e.loaderMsg.textContent=ke(D,{asset:n.toUpperCase()}),De.show(e.loaderMsg)}}},{key:"setRegistrationStatusView",value:function(e,t,n){var r=this.page;r.regStatusTitle.textContent=e,r.regStatusConfsDisplay.textContent=t,r.registrationStatus.classList.remove("completed","error","waiting"),r.registrationStatus.classList.add(n)}},{key:"updateRegistrationStatusView",value:function(){var e=this.page,t=this.market.dex;e.regStatusDex.textContent=t.host;var n=t.pendingFee;if(n){var r=t.regFees[n.symbol].confs;e.confReq.textContent=String(r);var a="".concat(n.confs," / ").concat(r);this.setRegistrationStatusView(ke(te),a,"waiting")}else this.setRegistrationStatusView(ke(re),"","completed")}},{key:"setRegistrationStatusVisibility",value:function(){var e=this;if(this.market&&this.market.dex){var t=this.page,n=this.market.dex;if(n.connectionStatus===Ze.Connected)if(this.updateRegistrationStatusView(),n.pendingFee)De.show(t.registrationStatus);else{var r=function(){De.hide(t.registrationStatus),e.resolveOrderFormVisibility()};if(De.isHidden(t.orderForm))return void setTimeout(r,5e3);r()}}}},{key:"setOrderBttnText",value:function(){this.isSell()?this.page.submitBttn.textContent=ke(b,{asset:this.market.baseCfg.symbol.toUpperCase()}):this.page.submitBttn.textContent=ke(k,{asset:this.market.baseCfg.symbol.toUpperCase()})}},{key:"setCandleDurBttns",value:function(){var e=this,t=this.page,n=this.market;De.empty(t.durBttnBox);var r,a=Ln(n.dex.candleDurs);try{var o=function(){var n=r.value,a=t.durBttnTemplate.cloneNode(!0);a.textContent=n,De.bind(a,"click",(function(){return e.candleDurationSelected(n)})),t.durBttnBox.appendChild(a)};for(a.s();!(r=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}}},{key:"setMarket",value:(x=o(y().mark((function e(t,n,r){var a,o,i,s,c,u,l,h,d;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=st().user.exchanges[t],(o=this.page).lotField.value="",o.qtyField.value="",o.rateField.value="",a.connectionStatus===Ze.Connected){e.next=12;break}return o.chartErrMsg.textContent=ke(T),De.show(o.chartErrMsg),this.loaded&&this.loaded(),this.main.style.opacity="1",De.hide(o.marketLoader),e.abrupt("return");case 12:i=a.assets[n],s=a.assets[r],c=[st().unitInfo(n,a),st().unitInfo(r,a)],l=c[1],h=ft/(u=c[0]).conventional.conversionFactor*l.conventional.conversionFactor,De.hide(o.maxOrd,o.chartErrMsg),this.maxEstimateTimer&&(window.clearTimeout(this.maxEstimateTimer),this.maxEstimateTimer=null),d=nr(i.symbol,s.symbol),this.market={dex:a,sid:d,cfg:a.markets[d],base:st().assets[n],quote:st().assets[r],baseUnitInfo:u,quoteUnitInfo:l,maxSell:null,maxBuys:{},maxSellRequested:!1,candleCaches:{},baseCfg:i,quoteCfg:s,rateConversionFactor:h,sellBalance:0,buyBalance:0},De.show(o.marketLoader),a.candleDurs&&0!==a.candleDurs.length||(this.currentChart=Gn),this.currentChart===Gn?On.request("loadmarket",tr(t,n,r)):(-1===a.candleDurs.indexOf(this.candleDur)&&(this.candleDur=a.candleDurs[0]),this.loadCandles()),this.setLoaderMsgVisibility(),this.setRegistrationStatusVisibility(),this.resolveOrderFormVisibility(),this.setOrderBttnText(),this.setCandleDurBttns(),this.previewQuoteAmt(!1);case 29:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return x.apply(this,arguments)})},{key:"reportDepthClick",value:function(e){this.page.rateField.value=String(e),this.rateFieldChanged()}},{key:"reportDepthVolume",value:function(e){var t=this.page,n=this.market,r=n.baseUnitInfo,a=n.quoteUnitInfo;t.sellBookedBase.textContent=De.formatCoinValue(e.sellBase*r.conventional.conversionFactor,r),t.sellBookedQuote.textContent=De.formatCoinValue(e.sellQuote*a.conventional.conversionFactor,a),t.buyBookedBase.textContent=De.formatCoinValue(e.buyBase*r.conventional.conversionFactor,r),t.buyBookedQuote.textContent=De.formatCoinValue(e.buyQuote*a.conventional.conversionFactor,a)}},{key:"reportDepthMouse",value:function(e){for(;this.hovers.length;)this.hovers.shift().classList.remove("hover");var t=this.page;if(e){for(var n=0,r=Object.values(this.metaOrders);n<r.length;n++){var a=r[n],o=[a.row,a.order],i=o[0],s=o[1];2===s.status&&e.hoverMarkers.indexOf(s.rate)>-1&&(i.classList.add("hover"),this.hovers.push(i))}t.hoverPrice.textContent=De.formatCoinValue(e.rate),t.hoverVolume.textContent=De.formatCoinValue(e.depth),t.hoverVolume.style.color=e.dotColor,De.show(t.hoverData)}else De.hide(t.hoverData)}},{key:"reportDepthZoom",value:function(e){Ve.store(Hn,e)}},{key:"reportMouseCandle",value:function(e){var t=this.page;e?(t.candleStart.textContent=De.formatCoinValue(e.startRate/this.market.rateConversionFactor),t.candleEnd.textContent=De.formatCoinValue(e.endRate/this.market.rateConversionFactor),t.candleHigh.textContent=De.formatCoinValue(e.highRate/this.market.rateConversionFactor),t.candleLow.textContent=De.formatCoinValue(e.lowRate/this.market.rateConversionFactor),t.candleVol.textContent=De.formatCoinValue(e.matchVolume,this.market.baseUnitInfo),De.show(t.hoverData)):De.hide(t.hoverData)}},{key:"parseOrder",value:function(){var e=this.page,t=e.qtyField,n=this.isLimit(),r=this.isSell(),a=this.market;return n||r||(t=e.mktBuyField),{host:a.dex.host,isLimit:n,sell:r,base:a.base.id,quote:a.quote.id,qty:rr(t.value||"",a.baseUnitInfo.conventional.conversionFactor),rate:rr(e.rateField.value||"",a.rateConversionFactor),tifnow:e.tifNow.checked||!1,options:{}}}},{key:"previewQuoteAmt",value:function(e){var t=this.page;if(this.market.base&&this.market.quote){var n=this.parseOrder(),r=this.adjustedRate();if(t.orderErr.textContent="",r&&(n.sell?this.preSell():this.preBuy()),this.depthLines.input=[],r&&this.isLimit()&&(this.depthLines.input=[{rate:n.rate/this.market.rateConversionFactor,color:n.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}]),this.drawChartLines(),!e||!r||!n.qty)return t.orderPreview.textContent="",void this.drawChartLines();var a=st().assets[n.quote],o=n.qty*n.rate/ft,i=De.formatCoinValue(o,this.market.quoteUnitInfo);t.orderPreview.textContent=ke(L,{total:i,asset:a.symbol.toUpperCase()}),this.isSell()?this.preSell():this.preBuy()}}},{key:"preSell",value:function(){var e=this,t=this.market,n=st().assets[t.base.id].wallet;n.balance.available<t.cfg.lotsize?this.setMaxOrder(null):t.maxSell?this.setMaxOrder(t.maxSell.swap):t.maxSellRequested||(t.maxSellRequested=!0,this.scheduleMaxEstimate("/api/maxsell",{},0,(function(r){t.maxSellRequested=!1,t.maxSell=r.maxSell,t.sellBalance=n.balance.available,e.setMaxOrder(r.maxSell.swap)})))}},{key:"preBuy",value:function(){var e=this,t=this.market,n=this.adjustedRate(),r=st().assets[t.quote.id].wallet;if(r){var a=t.cfg.lotsize*(n/ft);if(r.balance.available<a)this.setMaxOrder(null);else if(t.maxBuys[n])this.setMaxOrder(t.maxBuys[n].swap);else{var o=Object.keys(t.maxBuys).length?350:0;this.scheduleMaxEstimate("/api/maxbuy",{rate:n},o,(function(r){t.maxBuys[n]=r.maxBuy,t.buyBalance=st().assets[t.quote.id].wallet.balance.available,e.setMaxOrder(r.maxBuy.swap)}))}}}},{key:"scheduleMaxEstimate",value:function(e,t,n,r){var a=this,i=this.page;this.maxLoaded||(this.maxLoaded=st().loading(i.maxOrd));var s=[this.market.base.id,this.market.quote.id],c=s[0],u=s[1],l=[st().assets[c].wallet,st().assets[u].wallet],h=l[0],d=l[1];if(h&&h.running&&d&&d.running){this.maxEstimateTimer&&window.clearTimeout(this.maxEstimateTimer),De.show(i.maxOrd,i.maxLotBox),De.hide(i.maxAboveZero),i.maxFromLots.textContent=ke(P),i.maxFromLotsLbl.textContent="",this.maxOrderUpdateCounter++;var f=this.maxOrderUpdateCounter;this.maxEstimateTimer=window.setTimeout(o(y().mark((function n(){var o;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.maxEstimateTimer=null,f===a.maxOrderUpdateCounter){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,nt(e,Tn({host:a.market.dex.host,base:c,quote:u},t));case 5:if(o=n.sent,f===a.maxOrderUpdateCounter){n.next=8;break}return n.abrupt("return");case 8:if(st().checkResponse(o,!0)){n.next=13;break}return console.warn("max order estimate not available:",o),i.maxFromLots.textContent=ke(W),a.maxLoaded&&(a.maxLoaded(),a.maxLoaded=null),n.abrupt("return");case 13:r(o);case 14:case"end":return n.stop()}}),n)}))),n)}}},{key:"setMaxOrder",value:function(e){var t=this.page;this.maxLoaded&&(this.maxLoaded(),this.maxLoaded=null),De.show(t.maxOrd,t.maxLotBox,t.maxAboveZero);var n=this.isSell(),a=0;if(e&&(a=e.lots),t.maxFromLots.textContent=a.toString(),t.maxFromLotsLbl.textContent=1===a?"lot":"lots",e){var o=r(n?[this.market.base,this.market.quote]:[this.market.quote,this.market.base],2),i=o[0],s=o[1];t.maxFromAmt.textContent=De.formatCoinValue(e.value||0,i.info.unitinfo),t.maxFromTicker.textContent=i.symbol.toUpperCase();var c=n?this.adjustedRate()/ft:ft/this.adjustedRate();t.maxToAmt.textContent=De.formatCoinValue((e.value||0)*c,s.info.unitinfo),t.maxToTicker.textContent=s.symbol.toUpperCase()}else De.hide(t.maxAboveZero)}},{key:"validateOrder",value:function(e){var t=this.page;return e.isLimit&&!e.rate?(De.show(t.orderErr),t.orderErr.textContent=ke(B),!1):!!e.qty||(De.show(t.orderErr),t.orderErr.textContent=ke(q),!1)}},{key:"handleBook",value:function(e){var t=this.market,n=t.cfg,r=t.baseUnitInfo,a=t.quoteUnitInfo,o=t.baseCfg,i=t.quoteCfg;this.book=new tn(e,o.symbol,i.symbol),this.loadTable();var s,c=Ln(e.book.epoch||[]);try{for(c.s();!(s=c.n()).done;){var u=s.value;u.rate>0&&this.book.add(u),this.addTableOrder(u)}}catch(e){c.e(e)}finally{c.f()}if(!this.book)return this.depthChart.clear(),De.empty(this.page.buyRows),void De.empty(this.page.sellRows);this.depthChart.set(this.book,n.lotsize,n.ratestep,r,a)}},{key:"midGapConventional",value:function(){var e=this.midGap();if(!e)return e;var t=this.market,n=t.baseUnitInfo,r=t.quoteUnitInfo;return e*n.conventional.conversionFactor/r.conventional.conversionFactor}},{key:"midGap",value:function(){var e=this.book;if(e)return e.buys&&e.buys.length?e.sells&&e.sells.length?(e.buys[0].msgRate+e.sells[0].msgRate)/2/ft:e.buys[0].msgRate/ft:e.sells&&e.sells.length?e.sells[0].msgRate/ft:null}},{key:"setMarketBuyOrderEstimate",value:function(){var e=this.market,t=e.cfg.lotsize,n=st().user.exchanges[e.dex.host].markets[e.sid].buybuffer,r=this.midGapConventional();r&&(this.page.minMktBuy.textContent=De.formatCoinValue(t*n*r,e.baseUnitInfo))}},{key:"ordersSortCompare",value:function(){var e=this;switch(this.ordersSortKey){case"submitTime":return function(t,n){return e.ordersSortDirection*(n.submitTime-t.submitTime)};case"rate":return function(t,n){return e.ordersSortDirection*(t.rate-n.rate)};case"qty":return function(t,n){return e.ordersSortDirection*(t.qty-n.qty)};case"type":return function(t,n){return e.ordersSortDirection*mt(t).localeCompare(mt(n))};case"sell":return function(t,n){return e.ordersSortDirection*pt(t).localeCompare(pt(n))};case"status":return function(t,n){return e.ordersSortDirection*gt(t).localeCompare(gt(n))};case"settled":return function(t,n){return e.ordersSortDirection*(100*kt(t)/t.qty-100*kt(n)/n.qty)};case"filled":return function(t,n){return e.ordersSortDirection*(100*wt(t)/t.qty-100*wt(n)/n.qty)}}}},{key:"refreshActiveOrders",value:function(){var e=this,t=this.page,n=this.metaOrders,r=this.market;for(var a in n)delete n[a];var o=st().orders(r.dex.host,nr(r.baseCfg.symbol,r.quoteCfg.symbol)),i=this.ordersSortCompare();o.sort(i),De.empty(t.liveList);var s,c=Ln(o);try{var u=function(){var r=s.value,a=t.liveTemplate.cloneNode(!0);if(n[r.id]={row:a,order:r},De.bind(a,"mouseenter",(function(){e.activeMarkerRate=r.rate,e.setDepthMarkers()})),e.updateUserOrderRow(a,r),1===r.type&&1===r.tif&&r.status<3){var o=De.tmplElement(a,"cancelBttn");De.show(o),Wn(o,"click",(function(t){t.stopPropagation(),e.showCancel(a,r.id)}))}var i=De.tmplElement(a,"accelerateBttn");Wn(i,"click",(function(t){t.stopPropagation(),e.showAccelerate(r)})),st().canAccelerateOrder(r)&&De.show(i),De.tmplElement(a,"side").classList.add(r.sell?"sellcolor":"buycolor"),De.tmplElement(a,"link").href="order/".concat(r.id),st().bindInternalNavigation(a),t.liveList.appendChild(a),st().bindTooltips(a)};for(c.s();!(s=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}this.setDepthMarkers()}},{key:"updateUserOrderRow",value:function(e,t){or(e,"type",mt(t)),or(e,"side",pt(t)),or(e,"age",De.timeSince(t.submitTime)),or(e,"rate",De.formatCoinValue(t.rate/this.market.rateConversionFactor)),or(e,"qty",De.formatCoinValue(t.qty,this.market.baseUnitInfo)),or(e,"filled","".concat((wt(t)/t.qty*100).toFixed(1),"%")),or(e,"settled","".concat((kt(t)/t.qty*100).toFixed(1),"%")),or(e,"status",gt(t))}},{key:"setDepthMarkers",value:function(){for(var e={buys:[],sells:[]},t=this.market.rateConversionFactor,n=0,r=Object.values(this.metaOrders);n<r.length;n++){var a=r[n].order;a.rate&&2===a.status&&(a.sell?e.sells.push({rate:a.rate/t,active:a.rate===this.activeMarkerRate}):e.buys.push({rate:a.rate/t,active:a.rate===this.activeMarkerRate}))}this.depthChart.setMarkers(e),this.book&&this.depthChart.draw()}},{key:"updateTitle",value:function(){var e=this.midGapConventional();if(e){var t=this.market,n=t.baseCfg,r=t.quoteCfg,a=n.symbol.toUpperCase(),o=r.symbol.toUpperCase();document.title="".concat(De.formatCoinValue(e)," | ").concat(a).concat(o," | ").concat(this.ogTitle)}}},{key:"handleBookRoute",value:function(e){var t=this;st().log("book","handleBookRoute:",e);var n=e.payload,r=this.market,a=this.page,o=r.dex.host,i=[r.baseCfg,r.quoteCfg],s=i[0],c=i[1];n.base===s.id&&n.quote===c.id&&(this.refreshActiveOrders(),this.handleBook(n),this.updateTitle(),De.hide(a.marketLoader),this.marketList.select(o,s.id,c.id),Ve.store(_n,{host:e.host,base:n.base,quote:n.quote}),a.lotSize.textContent=De.formatCoinValue(r.cfg.lotsize,r.baseUnitInfo),a.rateStep.textContent=De.formatCoinValue(r.cfg.ratestep/r.rateConversionFactor),this.baseUnits.forEach((function(e){e.textContent=s.symbol.toUpperCase()})),this.quoteUnits.forEach((function(e){e.textContent=c.symbol.toUpperCase()})),this.balanceWgt.setWallets(o,s.id,c.id),this.setMarketBuyOrderEstimate(),this.refreshActiveOrders(),this.loaded&&(this.loaded(),this.loaded=null,De.animate(250,(function(e){t.main.style.opacity=String(e)}))))}},{key:"handleBookOrderRoute",value:function(e){if(st().log("book","handleBookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.rate>0&&this.book.add(t),this.addTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUnbookOrderRoute",value:function(e){if(st().log("book","handleUnbookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.remove(t.token),this.removeTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUpdateRemainingRoute",value:function(e){if(st().log("book","handleUpdateRemainingRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.updateRemaining(t.token,t.qty,t.qtyAtomic),this.updateTableOrder(t),this.depthChart.draw()}}},{key:"handleEpochOrderRoute",value:function(e){if(st().log("book","handleEpochOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.msgRate>0&&this.book.add(t),t.qtyAtomic>0&&this.addTableOrder(t),this.depthChart.draw()}}},{key:"handleCandlesRoute",value:function(e){if(this.candlesLoading&&(clearTimeout(this.candlesLoading.timer),this.candlesLoading.loaded(),this.candlesLoading=null),this.depthChart.hide(),this.candleChart.show(),e.host===this.market.dex.host){var t=e.payload.dur;this.market.candleCaches[t]=e.payload,this.currentChart===Xn&&this.candleDur===t&&this.candleChart.setCandles(e.payload,this.market.cfg,this.market.baseUnitInfo,this.market.quoteUnitInfo)}}},{key:"handleCandleUpdateRoute",value:function(e){if(e.host===this.market.dex.host){var t=e.payload,n=t.dur,r=t.candle,a=this.market.candleCaches[n];if(a){var o=a.candles;0===o.length?o.push(r):o[o.length-1].startStamp===r.startStamp?o[o.length-1]=r:o.push(r),this.currentChart===Xn&&this.candleDur===n&&this.candleChart.draw()}}}},{key:"showForm",value:(w=o(y().mark((function e(t){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,De.hide(n.unlockWalletForm,n.verifyForm,n.newWalletForm,n.cancelForm,n.vDetailPane,n.accelerateForm),t.style.right="10000px",De.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,De.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"showOpen",value:(g=o(y().mark((function e(t,n){var r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.page,this.openAsset=t,this.openFunc=n,this.unlockForm.refresh(st().assets[t.id]),this.showForm(r.unlockWalletForm),r.uwAppPass.focus();case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:"showVerify",value:function(){this.preorderCache={};var e,t=this.page,n=this.currentOrder=this.parseOrder(),r=n.sell,a=st().assets[n.base],o=st().assets[n.quote],i=r?o:a,s=r?a:o,c=Ln(De.applySelector(t.vDetailPane,"[data-icon]"));try{for(c.s();!(e=c.n()).done;){var u=e.value;switch(u.dataset.icon){case"from":u.src=De.logoPath(s.symbol);break;case"to":u.src=De.logoPath(i.symbol)}}}catch(e){c.e(e)}finally{c.f()}De.hide(t.vUnlockPreorder,t.vPreorderErr),De.show(t.vPreorder),t.vBuySell.textContent=r?"Selling":"Buying";var l=ke(r?O:I);if(t.vSideSubmit.textContent=l,t.vOrderHost.textContent=n.host,n.isLimit){De.show(t.verifyLimit),De.hide(t.verifyMarket);var h="Limit ".concat(l," Order");t.vOrderType.textContent=n.tifnow?h+" (immediate)":h,t.vRate.textContent=De.formatCoinValue(n.rate/this.market.rateConversionFactor),t.vQty.textContent=De.formatCoinValue(n.qty,a.info.unitinfo);var d=n.rate/ft*n.qty;t.vTotal.textContent=De.formatCoinValue(d,o.info.unitinfo),this.showFiatValue(o.id,d,t.vFiatTotal)}else{De.hide(t.verifyLimit),De.show(t.verifyMarket),t.vOrderType.textContent="Market ".concat(l," Order");var f=n.sell?this.market.baseUnitInfo:this.market.quoteUnitInfo;t.vmFromTotal.textContent=De.formatCoinValue(n.qty,f),t.vmFromAsset.textContent=s.symbol.toUpperCase(),this.showFiatValue(s.id,n.qty,t.vmFromTotalFiat);var p=this.midGap();if(p){De.show(t.vMarketEstimate);var m=n.sell?n.qty*p:n.qty/p;t.vmToTotal.textContent=De.formatCoinValue(m,i.info.unitinfo),t.vmToAsset.textContent=i.symbol.toUpperCase(),this.showFiatValue(i.id,m,t.vmTotalFiat)}else De.hide(t.vMarketEstimate)}var v="buygreen",y="sellred";r?(t.vHeader.classList.add(y),t.vHeader.classList.remove(v),t.vSubmit.classList.add(y),t.vSubmit.classList.remove(v)):(t.vHeader.classList.add(v),t.vHeader.classList.remove(y),t.vSubmit.classList.add(v),t.vSubmit.classList.remove(y)),this.showVerifyForm(),t.vPass.focus(),a.wallet.open&&o.wallet.open?this.preOrder(n):(De.hide(t.vPreorder),Ve.passwordIsCached()?this.unlockWalletsForEstimates(""):De.show(t.vUnlockPreorder))}},{key:"showFiatValue",value:function(e,t,n){if(n){var r=st().fiatRatesMap[e];n.textContent=De.formatFiatConversion(t,r,st().unitInfo(e)),r?De.show(n.parentElement):De.hide(n.parentElement)}}},{key:"showVerifyForm",value:(v=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,De.hide(t.vErr),this.showForm(t.verifyForm);case 3:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"submitEstimateUnlock",value:(m=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page.vUnlockPass.value||"",e.next=3,this.unlockWalletsForEstimates(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"unlockWalletsForEstimates",value:(p=o(y().mark((function e(t){var n,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=st().loading(n.verifyForm),e.next=4,this.attemptWalletUnlock(t);case 4:if(a=e.sent,r(),!a){e.next=8;break}return e.abrupt("return",this.setPreorderErr(a));case 8:De.show(n.vPreorder),De.hide(n.vUnlockPreorder),this.preOrder(this.parseOrder());case 11:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"attemptWalletUnlock",value:(f=o(y().mark((function e(t){var n,r,a,o,i,s,c,u,l;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.market,r=n.base,a=n.quote,o=[],r.wallet.open||o.push(r.id),a.wallet.open||o.push(a.id),i={pass:t,assetID:-1},s=0,c=o;case 6:if(!(s<c.length)){e.next=17;break}return u=c[s],i.assetID=u,e.next=11,nt("/api/openwallet",i);case 11:if(l=e.sent,st().checkResponse(l,!0)){e.next=14;break}return e.abrupt("return",l.msg);case 14:s++,e.next=6;break;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"fetchPreorder",value:(d=o(y().mark((function e(t){var n,r,a,o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=JSON.stringify(t.options),!(a=this.preorderCache[r])){e.next=5;break}return e.abrupt("return",a);case 5:return De.hide(n.vPreorderErr),o=st().loading(n.verifyForm),e.next=9,nt("/api/preorder",ir(t));case 9:if(i=e.sent,o(),st().checkResponse(i,!0)){e.next=13;break}return e.abrupt("return",{err:i.msg});case 13:return this.preorderCache[r]=i.estimate,e.abrupt("return",i.estimate);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"setPreorderErr",value:function(e){var t=this.page;De.hide(t.vPreorder),De.show(t.vPreorderErr),t.vPreorderErrTip.dataset.tooltip=e}},{key:"preOrder",value:(h=o(y().mark((function e(t){var n,r,a=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,r=function(){var e=o(y().mark((function e(){var i,s,c,u,l,h,d,f,p,m,v,g;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetchPreorder(t);case 2:if(!(i=e.sent).err){e.next=5;break}return e.abrupt("return",a.setPreorderErr(i.err));case 5:s=i,De.hide(n.vPreorderErr),De.show(n.vPreorder),c=s.swap,u=s.redeem,De.empty(n.vOrderOpts),c.options=c.options||[],u.options=u.options||[],a.setFeeEstimates(c,u,t),l=function(){var e=o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:De.animate(400,(function(e){n.vFeeSummary.style.backgroundColor="rgba(128, 128, 128, ".concat(.5-.5*e,")")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(e,r){return n.vOrderOpts.appendChild(Et(e,t,l,r))},d=Ln(c.options||[]);try{for(d.s();!(f=d.n()).done;)p=f.value,h(p,!0)}catch(e){d.e(e)}finally{d.f()}m=Ln(u.options||[]);try{for(m.s();!(v=m.n()).done;)g=v.value,h(g,!1)}catch(e){m.e(e)}finally{m.f()}st().bindTooltips(n.vOrderOpts);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"setFeeEstimates",value:function(e,t,n){var r=this.page,a=this.market,o=a.baseUnitInfo,i=a.quoteUnitInfo,s=a.rateConversionFactor,c=e.estimate.value||0,u=Yn.format,l=o,h=i;if(this.currentOrder.sell){var d=[l,h];h=d[0],l=d[1]}var f=e.estimate.realisticBestCase/c*100;r.vSwapFeesLowPct.textContent="".concat(u(f),"%"),r.vSwapFeesLow.textContent=De.formatCoinValue(e.estimate.realisticBestCase,h);var p=e.estimate.realisticWorstCase/c*100;r.vSwapFeesHighPct.textContent="".concat(u(p),"%"),r.vSwapFeesHigh.textContent=De.formatCoinValue(e.estimate.realisticWorstCase,h),r.vSwapFeesMaxPct.textContent="".concat(u(e.estimate.maxFees/c*100),"%"),r.vSwapFeesMax.textContent=De.formatCoinValue(e.estimate.maxFees,h);var m=this.midGap()||n.rate/s,v=n.sell?c*m:c/m,y=t.estimate.realisticBestCase/v*100;r.vRedeemFeesLowPct.textContent="".concat(u(y),"%"),r.vRedeemFeesLow.textContent=De.formatCoinValue(t.estimate.realisticBestCase,l);var g=t.estimate.realisticWorstCase/v*100;r.vRedeemFeesHighPct.textContent="".concat(u(g),"%"),r.vRedeemFeesHigh.textContent=De.formatCoinValue(t.estimate.realisticWorstCase,l),r.vFeeSummaryLow.textContent=u(f+y),r.vFeeSummaryHigh.textContent=u(p+g)}},{key:"submitCancel",value:(l=o(y().mark((function e(){var t,n,r,a,o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.cancelData,r=n.order,a={orderID:r.id,pw:t.cancelPass.value},t.cancelPass.value="",o=st().loading(t.cancelSubmit),e.next=8,nt("/api/cancel",a);case 8:if(i=e.sent,o(),st().checkResponse(i,!0)){e.next=14;break}return t.cancelErr.textContent=i.msg,De.show(t.cancelErr),e.abrupt("return");case 14:De.hide(n.bttn,t.forms),r.cancelling=!0;case 16:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"showCancel",value:function(e,t){var n=this.metaOrders[t].order,r=this.page,a=n.qty-n.filled,o=vt(n)?this.market.quote:this.market.base;r.cancelRemain.textContent=De.formatCoinValue(a,o.info.unitinfo),r.cancelUnit.textContent=o.symbol.toUpperCase(),De.hide(r.cancelErr),this.showForm(r.cancelForm),r.cancelPass.focus(),this.cancelData={bttn:De.tmplElement(e,"cancelBttn"),order:n}}},{key:"showAccelerate",value:function(e){var t=st().loading(this.main);this.accelerateOrderForm.refresh(e),t(),this.showForm(this.page.accelerateForm)}},{key:"showCreate",value:function(e){var t=this.page;this.currentCreate=e,this.newWalletForm.setAsset(e.id),this.showForm(t.newWalletForm),this.newWalletForm.loadDefaults()}},{key:"stepSubmit",value:function(){var e=this.page,t=this.market;if(De.hide(e.orderErr),this.validateOrder(this.parseOrder())){var n=st().walletMap[t.base.id],r=st().walletMap[t.quote.id];return n?r?void this.showVerify():(e.orderErr.textContent=ke(N,{asset:t.quote.symbol}),void De.show(e.orderErr)):(e.orderErr.textContent=ke(N,{asset:t.base.symbol}),void De.show(e.orderErr))}}},{key:"handlePriceUpdate",value:function(e){var t=this.marketList.xcSection(e.host);if(t&&t.marketRows)for(var n=0,r=Object.values(e.spots);n<r.length;n++){var a=r[n],o=t.marketRow(a.baseID,a.quoteID);o&&o.setSpot(a)}}},{key:"handleFeePayment",value:function(e){var t=e.dex;t===this.market.dex.host&&(this.market.dex=st().exchanges[t],this.setRegistrationStatusVisibility())}},{key:"handleOrderNote",value:function(e){var t=e.order,n=this.metaOrders[t.id];if(!n)return this.refreshActiveOrders();var r=n.status;n.order=t;var a=De.tmplElement(n.row,"cancelBttn");"MissedCancel"===e.topic&&De.show(a),t.filled===t.qty&&De.hide(a);var o=De.tmplElement(n.row,"accelerateBttn");st().canAccelerateOrder(t)?De.show(o):De.hide(o),this.updateUserOrderRow(n.row,t),(1===r&&2===t.status||2===r&&t.status>2)&&this.setDepthMarkers()}},{key:"handleEpochNote",value:function(e){if(st().log("book","handleEpochNote:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){this.book&&(this.book.setEpoch(e.epoch),this.depthChart.draw()),this.clearOrderTableEpochs();for(var t=0,n=Object.values(this.metaOrders);t<n.length;t++){var r=n[t],a=r.order,o=e.epoch>a.epoch,i=De.tmplElement(r.row,"status");switch(!0){case 1===a.type&&1===a.status&&o:i.textContent=0===a.tif?ke(U):ke(z),a.status=0===a.tif?3:2;break;case 2===a.type&&1===a.status:i.textContent=ke(U),a.status=3}}}}},{key:"setBalanceVisibility",value:function(){this.market&&this.market.dex&&(this.market.dex.connectionStatus===Ze.Connected?De.show(this.page.balanceTable):De.hide(this.page.balanceTable))}},{key:"handleBalanceNote",value:function(e){if(this.setBalanceVisibility(),this.market&&this.market.dex&&this.market.dex.connectionStatus===Ze.Connected){var t=this.market,n=e.balance.available;switch(e.assetID){case t.baseCfg.id:if(!t.maxSell)break;"number"==typeof t.sellBalance&&t.sellBalance!==n&&(t.maxSell=null),this.isSell()&&this.preSell();break;case t.quoteCfg.id:if(!Object.keys(t.maxBuys).length)break;"number"==typeof t.buyBalance&&t.buyBalance!==n&&(t.maxBuys={}),this.isSell()||this.preBuy()}}}},{key:"submitOrder",value:(s=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,De.hide(t.orderErr,t.vErr),n=this.currentOrder,r=t.vPass.value,t.vPass.value="",a={order:ir(n),pw:r},this.validateOrder(n)){e.next=8;break}return e.abrupt("return");case 8:return t.vSubmit.classList.add("d-hide"),t.vLoader.classList.remove("d-hide"),e.next=12,nt("/api/trade",a);case 12:if(o=e.sent,t.vSubmit.classList.remove("d-hide"),t.vLoader.classList.add("d-hide"),st().checkResponse(o,!0)){e.next=19;break}return t.vErr.textContent=o.msg,De.show(t.vErr),e.abrupt("return");case 19:De.hide(t.forms),this.refreshActiveOrders(),this.depthChart.draw();case 22:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"createWallet",value:(a=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st().fetchUser();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=t.assets[this.currentCreate.id],De.hide(this.page.forms),this.balanceWgt.updateAsset(n.id),this.resolveOrderFormVisibility();case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"walletUnlocked",value:(n=o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:De.hide(this.page.forms),this.balanceWgt.updateAsset(this.openAsset.id);case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"lotChanged",value:function(){var e=this.page,t=parseInt(e.lotField.value||"0");if(t<=0)return e.lotField.value="0",e.qtyField.value="",void this.previewQuoteAmt(!1);var n=this.market.cfg.lotsize;e.lotField.value=String(t),e.qtyField.value=String(t*n/this.market.baseUnitInfo.conventional.conversionFactor),this.previewQuoteAmt(!0)}},{key:"quantityChanged",value:function(e){var t=this.page,n=this.parseOrder();if(n.qty<0)return t.lotField.value="0",t.qtyField.value="",void this.previewQuoteAmt(!1);var r=this.market.cfg.lotsize,a=Math.floor(n.qty/r),o=a*r;t.lotField.value=String(a),(n.isLimit||n.sell)&&(e&&(t.qtyField.value=String(o/this.market.baseUnitInfo.conventional.conversionFactor)),this.previewQuoteAmt(!0))}},{key:"marketBuyChanged",value:function(){var e=this.page,t=rr(e.mktBuyField.value||"",this.market.quoteUnitInfo.conventional.conversionFactor),n=this.midGap();if(!n||!t)return e.mktBuyLots.textContent="0",void(e.mktBuyScore.textContent="0");var r=this.market.cfg.lotsize,a=t/n;e.mktBuyLots.textContent=(a/r).toFixed(1),e.mktBuyScore.textContent=De.formatCoinValue(a,this.market.baseUnitInfo)}},{key:"rateFieldChanged",value:function(){var e=this.adjustedRate();if(e<=0)return this.depthLines.input=[],this.drawChartLines(),void(this.page.rateField.value="0");var t=this.parseOrder(),n=e/this.market.rateConversionFactor;this.page.rateField.value=String(n),this.depthLines.input=[{rate:n,color:t.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}],this.drawChartLines(),this.previewQuoteAmt(!0)}},{key:"adjustedRate",value:function(){var e=this.page.rateField.value;if(!e)return NaN;var t=rr(e,this.market.rateConversionFactor);return t-t%this.market.cfg.ratestep}},{key:"loadTable",value:function(){this.loadTableSide(!0),this.loadTableSide(!1)}},{key:"binOrdersByRateAndEpoch",value:function(e){if(!e||!e.length)return[];var t=[],n=[],r=[],a=e[0].msgRate;e[0].epoch?n.push(e[0]):r.push(e[0]);for(var o=1;o<e.length;o++)e[o].msgRate!==a&&(t.push(r),t.push(n),n=[],r=[],a=e[o].msgRate),e[o].epoch?n.push(e[o]):r.push(e[o]);return t.push(r),t.push(n),t.filter((function(e){return e.length>0}))}},{key:"loadTableSide",value:function(e){var t=this,n=e?this.book.sells:this.book.buys,r=e?this.page.sellRows:this.page.buyRows;De.empty(r),n&&n.length&&this.binOrdersByRateAndEpoch(n).forEach((function(e){r.appendChild(t.orderTableRow(e))}))}},{key:"addTableOrder",value:function(e){var t=e.sell?this.page.sellRows:this.page.buyRows,n=t.firstChild;if(0!==e.rate){for(n&&0===n.manager.getRate()&&(n=n.nextSibling);n;){if(0===n.manager.compare(e))return void n.manager.insertOrder(e);if(n.manager.compare(e)>0){var r=this.orderTableRow([e]);return void t.insertBefore(r,n)}n=n.nextSibling}var a=this.orderTableRow([e]);t.appendChild(a)}else n&&0===n.manager.getRate()?n.manager.insertOrder(e):(n=this.orderTableRow([e]),t.insertBefore(n,t.firstChild))}},{key:"removeTableOrder",value:function(e){for(var t=e.token,n=0,r=[this.page.sellRows,this.page.buyRows];n<r.length;n++){var a,o=r[n],i=Ln(Array.from(o.children));try{for(i.s();!(a=i.n()).done;)if(a.value.manager.removeOrder(t))return}catch(e){i.e(e)}finally{i.f()}}}},{key:"updateTableOrder",value:function(e){for(var t=0,n=[this.page.sellRows,this.page.buyRows];t<n.length;t++){var r,a=n[t],o=Ln(Array.from(a.children));try{for(o.s();!(r=o.n()).done;)if(r.value.manager.updateOrderQty(e))return}catch(e){o.e(e)}finally{o.f()}}}},{key:"clearOrderTableEpochs",value:function(){this.clearOrderTableEpochSide(this.page.sellRows),this.clearOrderTableEpochSide(this.page.buyRows)}},{key:"clearOrderTableEpochSide",value:function(e){var t,n=Ln(Array.from(e.children));try{for(n.s();!(t=n.n()).done;)t.value.manager.removeEpochOrders()}catch(e){n.e(e)}finally{n.f()}}},{key:"orderTableRow",value:function(e){var t=this,n=this.page.rowTemplate.cloneNode(!0),r=this.market,a=r.baseUnitInfo,o=r.rateConversionFactor,i=new sr(n,e,a,o);return n.manager=i,Wn(n,"click",(function(){t.reportDepthClick(n.manager.getRate()/o)})),0!==n.manager.getRate()&&De.bind(n,"mouseenter",(function(){var e=t.depthChart;t.depthLines.hover=[{rate:n.manager.getRate()/o,color:n.manager.isSell()?e.theme.sellLine:e.theme.buyLine}],t.drawChartLines()})),n}},{key:"handleConnNote",value:(t=o(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.marketList.setConnectionStatus(t),t.connectionStatus!==Ze.Connected){e.next=5;break}return e.next=4,st().fetchUser();case 4:st().loadPage("markets");case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"filterMarkets",value:function(){var e=this.page.marketSearch.value,t=e?function(t){return t.name.includes(e)}:function(){return!0};this.marketList.setFilter(t)}},{key:"drawChartLines",value:function(){this.depthChart.setLines([].concat(it(this.depthLines.hover),it(this.depthLines.input))),this.depthChart.draw()}},{key:"depthChartSelected",value:function(){var e=this.page;De.hide(e.depthBttn,e.durBttnBox,e.candleHoverData),De.show(e.candlestickBttn,e.epochLine,e.depthHoverData,e.depthSummary),this.currentChart=Gn,this.depthChart.show(),this.candleChart.hide()}},{key:"candleChartSelected",value:function(){var e=this.page,t=this.market.dex;this.currentChart=Xn,De.hide(e.candlestickBttn,e.epochLine,e.depthHoverData,e.depthSummary),De.show(e.depthBttn,e.durBttnBox,e.candleHoverData),-1===t.candleDurs.indexOf(this.candleDur)&&(this.candleDur=t.candleDurs[0]),this.loadCandles()}},{key:"candleDurationSelected",value:function(e){this.candleDur=e,this.loadCandles()}},{key:"loadCandles",value:function(){var e,t=Ln(De.kids(this.page.durBttnBox));try{for(t.s();!(e=t.n()).done;){var n=e.value;n.textContent===this.candleDur?n.classList.add("selected"):n.classList.remove("selected")}}catch(e){t.e(e)}finally{t.f()}var r=this.market,a=r.candleCaches,o=r.cfg,i=r.baseUnitInfo,s=r.quoteUnitInfo,c=a[this.candleDur];if(c)return this.depthChart.hide(),this.candleChart.show(),void this.candleChart.setCandles(c,o,i,s);this.requestCandles()}},{key:"requestCandles",value:function(){var e=this;this.candlesLoading={loaded:function(){De.hide(e.page.marketLoader)},timer:window.setTimeout((function(){e.candlesLoading&&(e.candlesLoading=null,De.hide(e.page.marketLoader),console.error("candles not received"))}),1e4)};var t=this.market,n=t.dex,r=t.baseCfg,a=t.quoteCfg;On.request("loadcandles",{host:n.host,base:r.id,quote:a.id,dur:this.candleDur})}},{key:"unload",value:function(){On.request("unmarket",{}),On.deregisterRoute(Bn),On.deregisterRoute(qn),On.deregisterRoute(Mn),On.deregisterRoute(Nn),On.deregisterRoute(Un),On.deregisterRoute(zn),On.deregisterRoute(jn),this.depthChart.unattach(),this.candleChart.unattach(),De.unbind(document,"keyup",this.keyup),clearInterval(this.secondTicker)}}]),E}($e),Zn=function(){function e(t){i(this,e),u(this,"xcSections",void 0),u(this,"selected",void 0);var n=De.tmplElement(t,"xc");De.cleanTemplates(n),this.xcSections=[];for(var r=0,a=Object.values(st().user.exchanges);r<a.length;r++){var o=a[r];this.xcSections.push(new Jn(n,o))}var s,c=Ln(this.sortedSections());try{for(c.s();!(s=c.n()).done;){var l=s.value;t.appendChild(l.node)}}catch(e){c.e(e)}finally{c.f()}}return c(e,[{key:"sortedSections",value:function(){return it(this.xcSections).sort((function(e,t){return e.host<t.host?-1:1}))}},{key:"xcSection",value:function(e){var t,n=Ln(this.xcSections);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.host===e)return r}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"exists",value:function(e,t,n){var r=this.xcSection(e);if(!r||!r.marketRows)return!1;var a,o=Ln(r.marketRows);try{for(o.s();!(a=o.n()).done;){var i=a.value;if(i.baseID===t&&i.quoteID===n)return!0}}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"first",value:function(){var e=this.sortedSections()[0],t=e.first();return t?tr(e.host,t.baseID,t.quoteID):tr(e.host)}},{key:"select",value:function(e,t,n){this.selected&&this.selected.node.classList.remove("selected");var r=this.xcSection(e);if(!r)return console.error("select: no exchange section for ".concat(e));var a=r.marketRow(t,n);if(!a)return console.error("select: no market row for ".concat(e,", ").concat(t,"-").concat(n));this.selected=a,this.selected.node.classList.add("selected")}},{key:"setConnectionStatus",value:function(e){var t=this.xcSection(e.host);if(!t)return console.error("setConnectionStatus: no exchange section for ".concat(e.host));t.setConnected(e.connectionStatus===Ze.Connected)}},{key:"setFilter",value:function(e){var t,n=Ln(this.xcSections);try{for(n.s();!(t=n.n()).done;)t.value.setFilter(e)}catch(e){n.e(e)}finally{n.f()}}}]),e}(),Jn=function(){function e(t,n){i(this,e),u(this,"marketRows",void 0),u(this,"host",void 0),u(this,"dex",void 0),u(this,"node",void 0),u(this,"disconnectedIco",void 0),this.dex=n,this.host=n.host,this.node=t.cloneNode(!0);var r=De.parseTemplate(this.node);if(r.header.textContent=n.host,this.disconnectedIco=r.disconnected,n.connectionStatus===Ze.Connected&&De.hide(r.disconnected),r.mkts.removeChild(r.mktrow),n.markets){this.marketRows=Object.values(n.markets).map((function(e){var t=st().unitInfo(e.baseid,n),a=st().unitInfo(e.quoteid,n),o=ft/t.conventional.conversionFactor*a.conventional.conversionFactor;return new $n(r.mktrow,e,o)}));var a,o=Ln(this.sortedMarkets());try{for(o.s();!(a=o.n()).done;){var s=a.value;r.mkts.appendChild(s.node)}}catch(e){o.e(e)}finally{o.f()}}}return c(e,[{key:"sortedMarkets",value:function(){return this.marketRows?it(this.marketRows).sort((function(e,t){return e.name<t.name?-1:1})):[]}},{key:"first",value:function(){return this.sortedMarkets()[0]}},{key:"marketRow",value:function(e,t){var n,r=Ln(this.marketRows);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.baseID===e&&a.quoteID===t)return a}}catch(e){r.e(e)}finally{r.f()}}},{key:"setConnected",value:function(e){e?De.hide(this.disconnectedIco):De.show(this.disconnectedIco)}},{key:"setFilter",value:function(e){var t,n=Ln(this.marketRows);try{for(n.s();!(t=n.n()).done;){var r=t.value;e(r)?De.show(r.node):De.hide(r.node)}}catch(e){n.e(e)}finally{n.f()}}}]),e}(),$n=function(){function e(t,n,r){i(this,e),u(this,"node",void 0),u(this,"mkt",void 0),u(this,"name",void 0),u(this,"baseID",void 0),u(this,"quoteID",void 0),u(this,"lotSize",void 0),u(this,"rateStep",void 0),u(this,"tmpl",void 0),u(this,"rateConversionFactor",void 0),this.mkt=n,this.name=n.name,this.baseID=n.baseid,this.quoteID=n.quoteid,this.lotSize=n.lotsize,this.rateStep=n.ratestep,this.rateConversionFactor=r,this.node=t.cloneNode(!0);var a=this.tmpl=De.parseTemplate(this.node);a.baseIcon.src=De.logoPath(n.basesymbol),a.quoteIcon.src=De.logoPath(n.quotesymbol),a.baseSymbol.textContent=n.basesymbol.toUpperCase(),a.quoteSymbol.textContent=n.quotesymbol.toUpperCase(),this.setSpot(n.spot)}return c(e,[{key:"setSpot",value:function(e){if(e){var t=this.tmpl,n=this.mkt;De.show(t.pctChange);var r=100*e.change24,a=Yn.format(r),o=r>0?"+":"";t.pctChange.textContent="".concat(o).concat(a,"%"),t.pctChange.classList.remove("upgreen","downred","grey"),t.pctChange.classList.add(0===r?"grey":r>0?"upgreen":"downred");var i=st().assets[n.baseid];i&&(De.show(t.bottomRow),t.assetName.textContent=i.info.name,t.price.textContent=De.formatCoinValue(e.rate/this.rateConversionFactor))}}}]),e}(),er=function(){function e(t){var n=this;i(this,e),u(this,"base",void 0),u(this,"quote",void 0),u(this,"dex",void 0);var r=De.idDescendants(t);this.base={id:0,cfg:null,logo:r.baseImg,avail:r.baseAvail,newWalletRow:r.baseNewWalletRow,newWalletBttn:r.baseNewButton,locked:r.baseLocked,immature:r.baseImmature,unsupported:r.baseUnsupported,expired:r.baseExpired,connect:r.baseConnect,spinner:r.baseSpinner,iconBox:r.baseWalletState,stateIcons:new Le(r.baseWalletState)},this.quote={id:0,cfg:null,logo:r.quoteImg,avail:r.quoteAvail,newWalletRow:r.quoteNewWalletRow,newWalletBttn:r.quoteNewButton,locked:r.quoteLocked,immature:r.quoteImmature,unsupported:r.quoteUnsupported,expired:r.quoteExpired,connect:r.quoteConnect,spinner:r.quoteSpinner,iconBox:r.quoteWalletState,stateIcons:new Le(r.quoteWalletState)},st().registerNoteFeeder({balance:function(e){n.updateAsset(e.assetID)},walletstate:function(e){n.updateAsset(e.wallet.assetID)}})}return c(e,[{key:"setWallets",value:function(e,t,n){this.dex=st().user.exchanges[e],this.base.id=t,this.base.cfg=this.dex.assets[t],this.quote.id=n,this.quote.cfg=this.dex.assets[n],this.updateWallet(this.base),this.updateWallet(this.quote)}},{key:"updateWallet",value:function(e){if(e.cfg){var t=st().assets[e.id];if(De.hide(e.newWalletRow,e.avail,e.immature,e.locked,e.expired,e.unsupported,e.connect,e.spinner,e.iconBox),e.logo.src=De.logoPath(e.cfg.symbol),t){De.show(e.iconBox);var n=t.wallet;if(e.stateIcons.readWallet(n),n){var r=n.balance;if(r||n.running){if(!r)return st().fetchBalance(e.id),void De.show(e.spinner);De.show(e.avail,e.immature,e.locked),e.avail.textContent=De.formatCoinValue(r.available,t.info.unitinfo),e.locked.textContent=De.formatCoinValue(r.locked+r.contractlocked,t.info.unitinfo),e.immature.textContent=De.formatCoinValue(r.immature,t.info.unitinfo),(new Date).getTime()-new Date(r.stamp).getTime()>36e5?(De.show(e.expired),n.running&&st().fetchBalance(e.id)):De.hide(e.expired)}else De.show(e.connect)}else De.show(e.newWalletRow)}else De.show(e.unsupported)}}},{key:"updateAsset",value:function(e){e===this.base.id?this.updateWallet(this.base):e===this.quote.id&&this.updateWallet(this.quote)}}]),e}();function tr(e,t,n){return{host:e,base:t,quote:n}}function nr(e,t){return"".concat(e,"_").concat(t)}function rr(e,t){return e?Math.round(parseFloat(e)*t):0}function ar(e,t){e.classList.remove("selected"),t.classList.add("selected")}function or(e,t,n){De.tmplElement(e,t).textContent=n}function ir(e){for(var t={},n=0,a=Object.entries(e.options);n<a.length;n++){var o=r(a[n],2),i=o[0],s=o[1];t[i]=JSON.stringify(s)}return Object.assign({},e,{options:t})}var sr=function(){function e(t,n,r,a){i(this,e),u(this,"tableRow",void 0),u(this,"orderBin",void 0),u(this,"sell",void 0),u(this,"msgRate",void 0),u(this,"epoch",void 0),u(this,"baseUnitInfo",void 0),u(this,"rateConversionFactor",void 0),this.tableRow=t,this.orderBin=n,this.sell=n[0].sell,this.msgRate=n[0].msgRate,this.epoch=!!n[0].epoch,this.baseUnitInfo=r,this.rateConversionFactor=a,this.setRateEl(),this.setEpochEl(),this.updateQtyNumOrdersEl()}return c(e,[{key:"setEpochEl",value:function(){var e=De.tmplElement(this.tableRow,"epoch");this.isEpoch()&&e.appendChild(Qn.cloneNode())}},{key:"setRateEl",value:function(){var e=De.tmplElement(this.tableRow,"rate");if(0===this.msgRate)e.innerText="market";else{var t=this.isSell()?"sellcolor":"buycolor";e.innerText=De.formatFullPrecision(this.msgRate/this.rateConversionFactor),e.classList.add(t)}}},{key:"updateQtyNumOrdersEl",value:function(){var e=this.orderBin.reduce((function(e,t){return e+t.qtyAtomic}),0),t=this.orderBin.length,n=De.tmplElement(this.tableRow,"qty"),r=De.tmplElement(this.tableRow,"numorders");n.innerText=De.formatFullPrecision(e,this.baseUnitInfo),t>1?(r.removeAttribute("hidden"),r.innerText=String(t),r.title="quantity is comprised of ".concat(t," orders")):r.setAttribute("hidden","true")}},{key:"insertOrder",value:function(e){this.orderBin.push(e),this.updateQtyNumOrdersEl()}},{key:"updateOrderQty",value:function(e){for(var t=e.token,n=e.qty,r=e.qtyAtomic,a=0;a<this.orderBin.length;a++)if(this.orderBin[a].token===t)return this.orderBin[a].qty=n,this.orderBin[a].qtyAtomic=r,this.updateQtyNumOrdersEl(),!0;return!1}},{key:"removeOrder",value:function(e){var t=this.orderBin.findIndex((function(t){return t.token===e}));return!(t<0||(this.orderBin.splice(t,1),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove(),0))}},{key:"removeEpochOrders",value:function(e){this.orderBin=this.orderBin.filter((function(t){return!(t.epoch&&t.epoch!==e)})),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove()}},{key:"getRate",value:function(){return this.msgRate}},{key:"isEpoch",value:function(){return this.epoch}},{key:"isSell",value:function(){return this.sell}},{key:"compare",value:function(e){return this.getRate()===e.msgRate&&this.isEpoch()===!!e.epoch?0:this.getRate()!==e.msgRate?this.getRate()>e.msgRate===e.sell?1:-1:this.isEpoch()?1:-1}}]),e}();function cr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ur(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ur(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lr,hr,dr,fr,pr,mr,vr=function(e){Xe(h,e);var t,n,r,a,s,l=(a=h,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(a);if(s){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function h(e){var t;i(this,h),u(He(t=l.call(this)),"main",void 0),u(He(t),"offset",void 0),u(He(t),"loading",void 0),u(He(t),"orderTmpl",void 0),u(He(t),"filterState",void 0),u(He(t),"page",void 0),t.main=e,t.offset="",t.loading=!1;var n=t.page=De.idDescendants(e);t.orderTmpl=n.rowTmpl,t.orderTmpl.remove();var r=t.filterState={hosts:[],assets:[],statuses:[]},a=new URLSearchParams(window.location.search),o=function(e,t){var n=a.get(t);if(n&&0!==n.length){var o=n.split(",");n&&(r[t]=o),e.querySelectorAll("input").forEach((function(e){o.indexOf(e.value)>=0&&(e.checked=!0)}))}};o(n.hostFilter,"hosts"),o(n.assetFilter,"assets"),o(n.statusFilter,"statuses");var s=[],c=function(e,n){var a=e.querySelector(".apply-bttn");s.push(a),De.bind(a,"click",(function(){t.submitFilter(),s.forEach((function(e){return De.hide(e)}))})),e.querySelectorAll("input").forEach((function(t){De.bind(t,"change",(function(){!function(e,t){if(e.length!==t.length)return!1;var n,r=cr(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(-1===t.indexOf(a))return!1}}catch(e){r.e(e)}finally{r.f()}return!0}(yr(e),r[n])?De.show(a):De.hide(a)}))}))};return c(n.hostFilter,"hosts"),c(n.assetFilter,"assets"),c(n.statusFilter,"statuses"),De.bind(t.main,"scroll",(function(){t.loading||n.ordersTable.offsetHeight-t.main.offsetHeight-t.main.scrollTop<0&&t.nextPage()})),De.bind(n.exportOrders,"click",(function(){t.exportOrders()})),t.submitFilter(),t}return c(h,[{key:"setOrders",value:function(e){De.empty(this.page.tableBody),this.appendOrders(e)}},{key:"appendOrders",value:function(e){var t,n=this,r=this.page.tableBody,a=cr(e);try{var o=function(){var e=t.value,a=n.orderTmpl.cloneNode(!0),o=function(e,t){De.tmplElement(a,e).textContent=t},i="".concat(e.baseSymbol.toUpperCase(),"-").concat(e.quoteSymbol.toUpperCase());o("host","".concat(i," @ ").concat(e.host));var s=void 0,c=void 0,u=void 0,l="",h=[st().unitInfo(e.baseID),st().unitInfo(e.quoteID)],d=h[0],f=h[1];if(e.sell){var p=[e.baseSymbol,e.quoteSymbol];s=p[0],c=p[1],u=De.formatCoinValue(e.qty,d),1===e.type&&(l=De.formatCoinValue(e.qty/ft*e.rate,f))}else{var m=[e.quoteSymbol,e.baseSymbol];s=m[0],c=m[1],2===e.type?u=De.formatCoinValue(e.qty,d):(u=De.formatCoinValue(e.qty/ft*e.rate,f),l=De.formatCoinValue(e.qty,d))}o("fromQty",u),De.tmplElement(a,"fromLogo").src=De.logoPath(s),o("fromSymbol",s),o("toQty",l),De.tmplElement(a,"toLogo").src=De.logoPath(c),o("toSymbol",c),o("type","".concat(mt(e)," ").concat(pt(e))),o("rate",De.formatCoinValue(st().conventionalRate(e.baseID,e.quoteID,e.rate))),o("status",gt(e)),o("filled","".concat((wt(e)/e.qty*100).toFixed(1),"%")),o("settled","".concat((kt(e)/e.qty*100).toFixed(1),"%"));var v=new Date(e.submitTime).toLocaleString();o("time","".concat(De.timeSince(e.submitTime)," ago, ").concat(v)),De.tmplElement(a,"link").href="order/".concat(e.id),st().bindInternalNavigation(a),r.appendChild(a)};for(a.s();!(t=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}50===e.length?this.offset=e[e.length-1].id:this.offset=""}},{key:"submitFilter",value:(r=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,this.offset="",(n=this.filterState).hosts=yr(t.hostFilter),n.assets=yr(t.assetFilter).map((function(e){return parseInt(e)})),n.statuses=yr(t.statusFilter).map((function(e){return parseInt(e)})),e.t0=this,e.next=9,this.fetchOrders();case 9:e.t1=e.sent,e.t0.setOrders.call(e.t0,e.t1);case 11:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"fetchOrders",value:(n=o(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=st().loading(this.main),e.next=3,nt("/api/orders",this.currentFilter());case 3:return n=e.sent,t(),e.abrupt("return",n.orders);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"exportOrders",value:function(){this.offset="";var e=this.currentFilter(),t=new URL(window.location.href),n=new URLSearchParams(""),r=function(t){e[t].forEach((function(e){n.append(t,e)}))};r("hosts"),r("assets"),r("statuses"),t.search=n.toString(),t.pathname="/orders/export",window.open(t.toString())}},{key:"currentFilter",value:function(){var e=this.filterState;return{hosts:e.hosts,assets:e.assets.map((function(e){return parseInt(e)})),statuses:e.statuses.map((function(e){return parseInt(e)})),n:50,offset:this.offset}}},{key:"nextPage",value:(t=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.offset&&!this.loading){e.next=2;break}return e.abrupt("return");case 2:return this.loading=!0,De.show(this.page.orderLoader),e.next=6,this.fetchOrders();case 6:t=e.sent,this.loading=!1,De.hide(this.page.orderLoader),this.appendOrders(t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),h}($e);function yr(e){var t=[];return e.querySelectorAll("input").forEach((function(e){e.checked&&t.push(e.value)})),t}function gr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var kr,br=function(e){Xe(d,e);var t,n,r,a,s,l,h=(s=d,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(s);if(l){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function d(e){var t;i(this,d),u(He(t=h.call(this)),"orderID",void 0),u(He(t),"order",void 0),u(He(t),"page",void 0),u(He(t),"currentForm",void 0),u(He(t),"secondTicker",void 0),u(He(t),"refreshOnPopupClose",void 0),u(He(t),"accelerateOrderForm",void 0);var n=De.applySelector(e,"[data-stamp]");kr=parseInt(e.dataset.net||""),t.orderID=e.dataset.oid||"";var r=st().order(t.orderID);r?t.order=r:t.fetchOrder();var a=t.page=De.idDescendants(e);a.forms.querySelectorAll(".form-closer").forEach((function(e){De.bind(e,"click",(function(){t.refreshOnPopupClose?window.location.replace(window.location.href):De.hide(a.forms)}))})),a.cancelBttn&&De.bind(a.cancelBttn,"click",(function(){t.showForm(a.cancelForm)})),De.bind(a.accelerateBttn,"click",(function(){t.showAccelerateForm()})),t.showAccelerationButton(),bt(a),t.accelerateOrderForm=new qt(a.accelerateForm,(function(){t.refreshOnPopupClose=!0})),De.cleanTemplates(a.booleanOptTmpl,a.rangeOptTmpl,a.orderOptTmpl),De.bind(a.forms,"mousedown",(function(e){if(!De.mouseInElement(e,t.currentForm)){if(t.refreshOnPopupClose)return void window.location.reload();De.hide(a.forms),a.cancelPass.value=""}})),_t(a.cancelForm,a.cancelSubmit,o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.submitCancel();case 1:case"end":return e.stop()}}),e)})))),e.querySelectorAll("[data-explorer-id]").forEach((function(e){Cr(e)}));var s=function(){var e,t=gr(n);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.textContent=De.timeSince(parseInt(r.dataset.stamp||""))}}catch(e){t.e(e)}finally{t.f()}};return s(),t.secondTicker=window.setInterval((function(){s()}),1e4),st().registerNoteFeeder({order:function(e){t.handleOrderNote(e)},match:function(e){t.handleMatchNote(e)}}),t}return c(d,[{key:"unload",value:function(){clearInterval(this.secondTicker)}},{key:"fetchOrder",value:(a=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt("/api/order",this.orderID);case 2:if(t=e.sent,st().checkResponse(t)){e.next=5;break}return e.abrupt("return");case 5:this.order=t.order;case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"showCancel",value:function(){var e=this.order,t=this.page,n=e.qty-e.filled,r=vt(e)?st().assets[e.quoteID]:st().assets[e.baseID];t.cancelRemain.textContent=De.formatCoinValue(n,r.info.unitinfo),t.cancelUnit.textContent=r.info.unitinfo.conventional.unit.toUpperCase(),this.showForm(t.cancelForm)}},{key:"showForm",value:(r=o(y().mark((function e(t){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,De.hide(n.cancelForm,n.accelerateForm),t.style.right="10000px",De.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,De.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0px";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"submitCancel",value:(n=o(y().mark((function e(){var t,n,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.order,r={orderID:n.id,pw:t.cancelPass.value},t.cancelPass.value="",a=st().loading(t.cancelForm),e.next=7,nt("/api/cancel",r);case 7:if(o=e.sent,a(),st().checkResponse(o)){e.next=11;break}return e.abrupt("return");case 11:t.status.textContent=ke(j),De.hide(t.forms),n.cancelling=!0;case 14:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"showAccelerationButton",value:function(){var e=this.order;if(e){var t=this.page;st().canAccelerateOrder(e)?De.show(t.accelerateBttn,t.actionsLabel):De.hide(t.accelerateBttn,t.actionsLabel)}}},{key:"showAccelerateForm",value:(t=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=st().loading(this.page.accelerateBttn),this.accelerateOrderForm.refresh(this.order),t(),this.showForm(this.page.accelerateForm);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleOrderNote",value:function(e){var t=this.page,n=e.order;if(n.id===this.orderID){this.order=n;var r=t.cancelBttn;r&&n.status>2&&De.hide(r),t.status.textContent=gt(n);var a,o=gr(n.matches||[]);try{for(o.s();!(a=o.n()).done;){var i=a.value;this.processMatch(i)}}catch(e){o.e(e)}finally{o.f()}this.showAccelerationButton()}}},{key:"handleMatchNote",value:function(e){e.orderID===this.orderID&&this.processMatch(e.match)}},{key:"processMatch",value:function(e){var t,n=null,r=gr(De.applySelector(this.page.matchBox,".match-card"));try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.dataset.matchID===e.matchID){n=a;break}}}catch(e){r.e(e)}finally{r.f()}if(n){var o=function(e,t,r){if(n&&r){De.show(De.tmplElement(n,e));var a=De.tmplElement(n,t);a.textContent=r.stringID,a.dataset.explorerCoin=r.stringID,Cr(a)}};o("swap","swapCoin",e.swap),o("counterSwap","counterSwapCoin",e.counterSwap),o("redeem","redeemCoin",e.redeem),o("counterRedeem","counterRedeemCoin",e.counterRedeem),o("refund","refundCoin",e.refund);var i=De.tmplElement(n,"swapMsg"),s=De.tmplElement(n,"counterSwapMsg");!function(e){return 1===e.side&&1===e.status||0===e.side&&2===e.status}(e)?function(e){return 0===e.side&&1===e.status||1===e.side&&2===e.status}(e)?(i.textContent=xr(e.swap),De.hide(De.tmplElement(n,"counterSwapMsg")),De.show(i)):De.hide(i,s):(s.textContent=xr(e.counterSwap),De.hide(De.tmplElement(n,"swapMsg")),De.show(s)),De.tmplElement(n,"status").textContent=function(e){if(e.revoked)return e.active?"Revoked - Refund PENDING":e.refund?"Revoked - Refunded":e.redeem?"Revoked - Redeemed":"Revoked - Complete";switch(e.status){case 0:return"(0 / 4) Newly Matched";case 1:return"(1 / 4) First Swap Sent";case 2:return"(2 / 4) Second Swap Sent";case 3:return 0===e.side?"Match Complete":"(3 / 4) Maker Redeemed";case 4:return"Match Complete"}return"Unknown Match Status"}(e)}}}]),d}($e);function xr(e){return e.confs?"".concat(e.confs.count," / ").concat(e.confs.required," confirmations"):""}function Cr(e){var t=Sr[parseInt(e.dataset.explorerId||"")];if(t){var n=t[kr];n&&(e.classList.remove("plainlink"),e.classList.add("subtlelink"),e.href=n(e.dataset.explorerCoin||""))}}var Sr={42:(lr={},u(lr,0,(function(e){var t=r(e.split(":"),2),n=t[0],a=t[1];return"https://explorer.dcrdata.org/tx/".concat(n,"/out/").concat(a)})),u(lr,1,(function(e){var t=r(e.split(":"),2),n=t[0],a=t[1];return"https://testnet.dcrdata.org/tx/".concat(n,"/out/").concat(a)})),lr),0:(hr={},u(hr,0,(function(e){return"https://mempool.space/tx/".concat(e.split(":")[0])})),u(hr,1,(function(e){return"https://mempool.space/testnet/tx/".concat(e.split(":")[0])})),hr),2:(dr={},u(dr,0,(function(e){return"https://ltc.bitaps.com/".concat(e.split(":")[0])})),u(dr,1,(function(e){return"https://sochain.com/tx/LTCTEST/".concat(e.split(":")[0])})),dr),60:(fr={},u(fr,0,(function(e){return 42===e.length?"https://etherscan.io/address/".concat(e):"https://etherscan.io/tx/".concat(e)})),u(fr,1,(function(e){return 42===e.length?"https://goerli.etherscan.io/address/".concat(e):"https://goerli.etherscan.io/tx/".concat(e)})),fr),3:(pr={},u(pr,0,(function(e){return"https://dogeblocks.com/tx/".concat(e.split(":")[0])})),u(pr,1,(function(e){return"https://blockexplorer.one/dogecoin/testnet/tx/".concat(e.split(":")[0])})),pr),145:(mr={},u(mr,0,(function(e){return"https://bch.loping.net/tx/".concat(e.split(":")[0])})),u(mr,1,(function(e){return"https://tbch4.loping.net/tx/".concat(e.split(":")[0])})),mr)};var Fr,Er=function(e){Xe(m,e);var t,n,r,a,s,l,h,d,f,p=(d=m,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(d);if(f){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function m(e){var t;i(this,m),u(He(t=p.call(this)),"body",void 0),u(He(t),"forms",void 0),u(He(t),"currentForm",void 0),u(He(t),"page",void 0),u(He(t),"host",void 0),u(He(t),"keyup",void 0),u(He(t),"dexAddrForm",void 0),t.body=e,t.host=e.dataset.host?e.dataset.host:"";var n=t.page=De.idDescendants(e);t.forms=De.applySelector(n.forms,":scope > form"),De.bind(n.exportDexBtn,"click",(function(){return t.prepareAccountExport(n.authorizeAccountExportForm)})),De.bind(n.disableAcctBtn,"click",(function(){return t.prepareAccountDisable(n.disableAccountForm)})),De.bind(n.updateCertBtn,"click",(function(){return n.certFileInput.click()})),De.bind(n.updateHostBtn,"click",(function(){return t.prepareUpdateHost()})),De.bind(n.certFileInput,"change",(function(){return t.onCertFileChange()})),t.dexAddrForm=new Mt(n.dexAddrForm,function(){var e=o(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location.assign("/dexsettings/".concat(t.host));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),void 0,t.host),_t(n.authorizeAccountExportForm,n.authorizeExportAccountConfirm,(function(){return t.exportAccount()})),_t(n.disableAccountForm,n.disableAccountConfirm,(function(){return t.disableAccount()}));var r=function(){De.hide(n.forms)};return De.bind(n.forms,"mousedown",(function(e){De.mouseInElement(e,t.currentForm)||r()})),t.keyup=function(e){"Escape"===e.key&&r()},De.bind(document,"keyup",t.keyup),n.forms.querySelectorAll(".form-closer").forEach((function(e){De.bind(e,"click",(function(){r()}))})),st().registerNoteFeeder({conn:function(){t.setConnectionStatus()}}),t.setConnectionStatus(),t}return c(m,[{key:"showForm",value:(h=o(y().mark((function e(t){var n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return De.hide(e)})),t.style.right="10000px",De.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,De.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"exportAccount",value:(l=o(y().mark((function e(){var t,n,r,a,o,i,s,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.exportAccountAppPass.value,r=t.exportAccountHost.textContent,t.exportAccountAppPass.value="",a={pw:n,host:r},o=st().loading(this.body),e.next=8,nt("/api/exportaccount",a);case 8:if(i=e.sent,o(),st().checkResponse(i)){e.next=14;break}return t.exportAccountErr.textContent=i.msg,De.show(t.exportAccountErr),e.abrupt("return");case 14:s=JSON.parse(JSON.stringify(i.account)),(c=document.createElement("a")).setAttribute("download","dcrAccount-"+r+".json"),c.setAttribute("href","data:text/json,"+JSON.stringify(s,null,2)),c.click(),De.hide(t.forms);case 20:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"disableAccount",value:(s=o(y().mark((function e(){var t,n,r,a,o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.disableAccountAppPW.value,r=t.disableAccountHost.textContent,t.disableAccountAppPW.value="",a={pw:n,host:r},o=st().loading(this.body),e.next=8,nt("/api/disableaccount",a);case 8:if(i=e.sent,o(),st().checkResponse(i,!0)){e.next=14;break}return t.disableAccountErr.textContent=i.msg,De.show(t.disableAccountErr),e.abrupt("return");case 14:De.hide(t.forms),window.location.assign("/settings");case 16:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"prepareAccountExport",value:(a=o(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).exportAccountHost.textContent=this.host,n.exportAccountErr.textContent="",Ve.passwordIsCached()?this.exportAccount():this.showForm(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"prepareAccountDisable",value:(r=o(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).disableAccountHost.textContent=this.host,n.disableAccountErr.textContent="",this.showForm(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"prepareUpdateHost",value:(n=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,this.dexAddrForm.refresh(),this.showForm(t.dexAddrForm);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onCertFileChange",value:(t=o(y().mark((function e(){var t,n,r,a,o,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,De.hide(t.errMsg),!(n=t.certFileInput.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:r=e.sent;case 7:if(r){e.next=9;break}return e.abrupt("return");case 9:return a={host:this.host,cert:r},o=st().loading(this.body),e.next=13,nt("/api/updatecert",a);case 13:i=e.sent,o(),st().checkResponse(i,!0)?(De.show(t.updateCertMsg),setTimeout((function(){De.hide(t.updateCertMsg)}),5e3)):(t.errMsg.textContent=i.msg,De.show(t.errMsg));case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setConnectionStatus",value:function(){var e=this.page,t=st().user.exchanges[this.host],n=function(t){t?(De.hide(e.disconnectedIcon),De.show(e.connectedIcon)):(De.show(e.disconnectedIcon),De.hide(e.connectedIcon))};if(t)switch(t.connectionStatus){case Ze.Connected:n(!0),e.connectionStatus.textContent="Connected";break;case Ze.Disconnected:n(!1),e.connectionStatus.textContent="Disconnected";break;case Ze.InvalidCert:n(!1),e.connectionStatus.textContent="Disconnected - Invalid Certificate"}}}]),m}($e);function Ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ar(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ir(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Or(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Or(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dr=De.idel,Tr=De.bind,Lr=De.unbind,Pr="loggers",Wr="recorders",Br={login:Gt,register:Ht,markets:Kn,wallets:Zt,settings:$t,orders:vr,order:br,dexsettings:Er},qr=["register","login","settings"],Mr=function(){function e(){var t=this;i(this,e),u(this,"notes",void 0),u(this,"pokes",void 0),u(this,"user",void 0),u(this,"seedGenTime",void 0),u(this,"commitHash",void 0),u(this,"showPopups",void 0),u(this,"loggers",void 0),u(this,"recorders",void 0),u(this,"main",void 0),u(this,"header",void 0),u(this,"assets",void 0),u(this,"exchanges",void 0),u(this,"walletMap",void 0),u(this,"fiatRatesMap",void 0),u(this,"tooltip",void 0),u(this,"page",void 0),u(this,"loadedPage",void 0),u(this,"popupNotes",void 0),u(this,"popupTmpl",void 0),u(this,"noteReceivers",void 0),this.notes=[],this.pokes=[],this.user={exchanges:{},inited:!1,seedgentime:0,assets:{},fiatRates:{},authed:!1,ok:!0},this.seedGenTime=0,this.commitHash="96ca610234baca682e732faf657faeec691a68f8",this.noteReceivers=[],this.showPopups="1"===Ve.getCookie("popups"),console.log("Decred DEX Client App, Build",this.commitHash.substring(0,7)),this.loggers=Ve.fetch(Pr)||{},window.enableLogger=function(e,n){return n?t.loggers[e]=!0:delete t.loggers[e],Ve.store(Pr,t.loggers),"".concat(e," logger ").concat(n?"enabled":"disabled")},window.log=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t.log.apply(t,[e].concat(r))};var n=Ve.fetch(Wr)||[];this.recorders={};var r,a=Ir(n);try{for(a.s();!(r=a.n()).done;){var o=r.value;console.log("recording",o),this.recorders[o]=[]}}catch(e){a.e(e)}finally{a.f()}window.recordLogger=function(e,n){return n?t.recorders[e]=[]:delete t.recorders[e],Ve.store(Wr,Object.keys(t.recorders)),"".concat(e," recorder ").concat(n?"enabled":"disabled")},window.dumpLogger=function(e){var n=t.recorders[e];if(!n)return"no recorder for logger ".concat(e);var r=document.createElement("a");r.href="data:application/octet-stream;base64,".concat(window.btoa(JSON.stringify(n,null,4))),r.download="".concat(e,".json"),document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r)}),0)},m=ge[document.documentElement.lang.toLowerCase()]}var t,n,a,s,l;return c(e,[{key:"start",value:(l=o(y().mark((function e(){var t,n,r,a=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Tr(window,"popstate",(function(e){var t=e.state.page;(t||""===t)&&a.loadPage(t,e.state.data,!0)})),this.main=Dr(document,"main"),t=this.main.dataset.handler,e.next=5,this.fetchUser();case 5:Ur((n=new URL(window.location.href)).pathname)!==t&&(n.pathname="/".concat(t),n.search="",window.history.replaceState({page:t},"",n)),this.attachHeader(),this.attachCommon(this.header),this.attach({}),r=Ve.fetch("notifications"),this.setNotes(r||[]),On.connect((void 0,o="https:"===window.location.protocol?"wss":"ws","".concat(o,"://").concat(window.location.host,"/ws")),this.reconnected),On.registerRoute("notify",(function(e){a.notify(e)}));case 14:case"end":return e.stop()}var o}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"reconnected",value:function(){window.location.reload()}},{key:"fetchUser",value:(s=o(y().mark((function e(){var t,n,a,o,i,s,c,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at("/api/user");case 2:if(t=e.sent,n=qr.indexOf(this.main.dataset.handler||"")>-1,this.checkResponse(t,n)){e.next=6;break}return e.abrupt("return");case 6:a=t,this.seedGenTime=a.seedgentime,this.user=a,this.assets=a.assets,this.exchanges=a.exchanges,this.walletMap={},this.fiatRatesMap=a.fiatRates,o=Ir(Object.entries(a.assets));try{for(o.s();!(i=o.n()).done;)s=r(i.value,2),c=s[0],(u=s[1]).wallet&&(this.walletMap[c]=u.wallet)}catch(e){o.e(e)}finally{o.f()}return this.updateMenuItemsDisplay(),e.abrupt("return",a);case 17:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"loadPage",value:(a=o(y().mark((function e(t,n,r){var a,o,i,s,c,u,l,h;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tooltip.style.left="-10000px",De.hide(this.page.noteBox,this.page.profileBox),a=new URL("/".concat(t),window.location.origin),o=Ur(t),e.next=6,window.fetch(a.toString());case 6:if((i=e.sent).ok){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,i.text();case 11:return s=e.sent,c=De.noderize(s),u=Dr(c,"main"),l=u.dataset.handler,r||(h=l===o?a.toString():"/".concat(l),window.history.pushState({page:t,data:n},"",h)),document.title=c.title,this.main.replaceWith(u),this.main=u,this.noteReceivers=[],this.attach(n),e.abrupt("return",!0);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"attach",value:function(e){var t=this.main.dataset.handler;if(t){this.attachCommon(this.main),this.loadedPage&&this.loadedPage.unload();var n=Br[t];this.loadedPage=n?new n(this.main,e):null,this.bindTooltips(this.main)}else console.error("cannot attach to content with no specified handler")}},{key:"bindTooltips",value:function(e){var t=this;e.querySelectorAll("[data-tooltip]").forEach((function(e){Tr(e,"mouseenter",(function(){t.tooltip.textContent=e.dataset.tooltip||"";var n=De.layoutMetrics(e),r=n.centerX-t.tooltip.offsetWidth/2;r<0&&(r=5),r+t.tooltip.offsetWidth>document.body.offsetWidth&&(r=document.body.offsetWidth-t.tooltip.offsetWidth-5),t.tooltip.style.left="".concat(r,"px"),t.tooltip.style.top="".concat(n.bodyTop-t.tooltip.offsetHeight-5,"px")})),Tr(e,"mouseleave",(function(){t.tooltip.style.left="-10000px"}))}))}},{key:"attachHeader",value:function(){var e=this;this.header=Dr(document.body,"header"),this.popupNotes=Dr(document.body,"popupNotes"),this.popupTmpl=De.tmplElement(this.popupNotes,"note"),this.popupTmpl?this.popupTmpl.remove():console.error("popupTmpl element not found"),this.tooltip=Dr(document.body,"tooltip");var t=this.page=De.idDescendants(this.header);t.noteTmpl.removeAttribute("id"),t.noteTmpl.remove(),t.pokeTmpl.removeAttribute("id"),t.pokeTmpl.remove(),t.loader.remove(),De.show(t.loader),Tr(t.noteMenuEntry,"click",o(y().mark((function n(){var r,a,o;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:De.hide(t.pokeList),De.show(t.noteList),e.ackNotes(),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),e.showDropdown(t.noteMenuEntry,t.noteBox),De.hide(t.noteIndicator),r=Ir(e.notes);try{for(r.s();!(a=r.n()).done;)(o=a.value).acked&&o.el.classList.remove("firstview")}catch(e){r.e(e)}finally{r.f()}e.setNoteTimes(t.noteList),e.setNoteTimes(t.pokeList),e.storeNotes();case 12:case"end":return n.stop()}}),n)})))),Tr(t.profileMenuEntry,"click",(function(){e.showDropdown(t.profileMenuEntry,t.profileBox)})),Tr(t.innerNoteIcon,"click",(function(){De.hide(t.noteBox)})),Tr(t.innerProfileIcon,"click",(function(){De.hide(t.profileBox)})),Tr(t.profileSignout,"click",o(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.signOut();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))),Tr(t.pokeCat,"click",(function(){e.setNoteTimes(t.pokeList),t.pokeCat.classList.add("active"),t.noteCat.classList.remove("active"),De.hide(t.noteList),De.show(t.pokeList),e.ackNotes()})),Tr(t.noteCat,"click",(function(){e.setNoteTimes(t.noteList),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),De.hide(t.pokeList),De.show(t.noteList),e.ackNotes()}))}},{key:"showDropdown",value:function(e,t){var n=this,r=e.getBoundingClientRect();De.hide(this.page.noteBox,this.page.profileBox),De.show(t),t.style.right="".concat(window.innerWidth-r.left-r.width+11,"px"),t.style.top="".concat(r.top-9,"px"),Tr(document,"click",(function e(r){De.mouseInElement(r,t)||(De.hide(t),Lr(document,"click",e),t===n.page.noteBox&&De.isDisplayed(n.page.noteList)&&n.ackNotes())}))}},{key:"ackNotes",value:function(){var e,t=[],n=Ir(this.notes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.acked?r.el.classList.remove("firstview"):(r.acked=!0,r.id&&r.severity>2&&t.push(r.id))}}catch(e){n.e(e)}finally{n.f()}t.length&&On.request("acknotes",t),De.hide(this.page.noteIndicator)}},{key:"setNoteTimes",value:function(e){var t,n=Ir(Array.from(e.children));try{for(n.s();!(t=n.n()).done;){var r=t.value;De.safeSelector(r,"span.note-time").textContent=De.timeSince(r.note.stamp)}}catch(e){n.e(e)}finally{n.f()}}},{key:"bindInternalNavigation",value:function(e){var t=this,n=new URL(window.location.href);e.querySelectorAll("a").forEach((function(e){if(e.href){var r=new URL(e.href);if(r.origin===n.origin){var a=r.pathname.substring(1),o={};r.search&&r.searchParams.forEach((function(e,t){o[t]=e})),De.bind(e,"click",(function(e){e.preventDefault(),t.loadPage(a,o)}))}}}))}},{key:"storeNotes",value:function(){Ve.store("notifications",this.notes.map((function(e){return{subject:e.subject,details:e.details,severity:e.severity,stamp:e.stamp,id:e.id,acked:e.acked}})))}},{key:"updateMenuItemsDisplay",value:function(){var e=this.page;e&&(this.user.authed?(De.show(e.noteMenuEntry,e.walletsMenuEntry,e.profileMenuEntry),Object.keys(this.user.exchanges).length>0?De.show(e.marketsMenuEntry):De.hide(e.marketsMenuEntry)):De.hide(e.noteMenuEntry,e.walletsMenuEntry,e.marketsMenuEntry,e.profileMenuEntry))}},{key:"attachCommon",value:function(e){this.bindInternalNavigation(e)}},{key:"updateExchangeRegistration",value:function(e,t,n){var r=this.exchanges[e],a=this.assets[n].symbol;r.pendingFee={confs:t,assetID:n,symbol:a}}},{key:"setDEXPaid",value:function(e){this.exchanges[e].pendingFee=null}},{key:"handleFeePaymentNote",value:function(e){switch(e.topic){case"RegUpdate":this.updateExchangeRegistration(e.dex,e.confirmations,e.asset);break;case"AccountRegistered":this.setDEXPaid(e.dex)}}},{key:"setNotes",value:function(e){this.log("notes","setNotes",e),this.notes=[],De.empty(this.page.noteList);for(var t=0;t<e.length;t++)this.prependNoteElement(e[t],!0);this.storeNotes()}},{key:"notify",value:function(e){switch(this.log("notes","notify",e),e.type){case"order":var t=e.order,n=this.user.exchanges[t.host].markets[t.market];n.orders?function(e,t){for(var n in e.orders||[])if(e.orders[n].id===t.id)return e.orders[n]=t,!0;return!1}(n,t)||n.orders.push(t):n.orders=[t];break;case"balance":var a=e,i=this.user.assets[a.assetID];if(!i)break;var s=i.wallet;s&&(s.balance=a.balance);break;case"feepayment":this.handleFeePaymentNote(e);break;case"walletstate":case"walletconfig":if(!this.assets)return;var c=e.wallet,u=this.assets[c.assetID];u.wallet=c,this.walletMap[c.assetID]=c;var l=c.balance.available;this.main.querySelectorAll('[data-balance-target="'.concat(c.assetID,'"]')).forEach((function(e){e.textContent=De.formatFullPrecision(l,u.info.unitinfo)}));break;case"match":var h=e,d=this.order(h.orderID);d&&function(e,t){for(var n in e.matches)if(e.matches[n].matchID===t.matchID)return void(e.matches[n]=t);e.matches=e.matches||[],e.matches.push(t)}(d,h.match);break;case"conn":var f=e,p=this.user.exchanges[f.host];p&&(p.connectionStatus=f.connectionStatus);break;case"spots":var m=e,v=this.user.exchanges[m.host];if(!v||!v.markets)break;for(var g=0,w=Object.entries(m.spots);g<w.length;g++){var k=r(w[g],2),b=k[0],x=k[1];v.markets[b].spot=x}break;case"fiatrateupdate":this.fiatRatesMap=e.fiatRates}var C,S=Ir(this.noteReceivers);try{for(S.s();!(C=S.n()).done;){var F=C.value[e.type];if(F)try{F(e)}catch(e){console.error("note feeder error:",e.message?e.message:e)}}}catch(e){S.e(e)}finally{S.f()}if(!(e.severity<2)){if(this.showPopups){var E=this.popupTmpl.cloneNode(!0);De.tmplElement(E,"text").textContent="".concat(e.subject,": ").concat(e.details);var A=De.tmplElement(E,"indicator");2===e.severity?De.hide(A):jr(A,e.severity);var R=this.popupNotes;for(R.appendChild(E);R.children.length>5;)R.removeChild(R.firstChild);setTimeout(o(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De.animate(500,(function(e){E.style.opacity=String(1-e)}));case 2:E.remove();case 3:case"end":return e.stop()}}),e)}))),6e3)}2===e.severity?this.prependPokeElement(e):this.prependNoteElement(e)}}},{key:"registerNoteFeeder",value:function(e){this.noteReceivers.push(e)}},{key:"log",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];this.loggers[e]&&(t=console).log.apply(t,["".concat(zr(),"[").concat(e,"]:")].concat(r)),this.recorders[e]&&this.recorders[e].push({time:zr(),msg:r})}},{key:"prependPokeElement",value:function(e){var t=r(this.makePoke(e),2),n=t[0],a=t[1];for(this.pokes.push(a);this.pokes.length>100;)this.pokes.shift();this.prependListElement(this.page.pokeList,a,n)}},{key:"prependNoteElement",value:function(e,t){var n=r(this.makeNote(e),2),a=n[0],o=n[1];for(this.notes.push(o);this.notes.length>100;)this.notes.shift();var i=this.page.noteList;if(this.prependListElement(i,o,a),t||this.storeNotes(),!(0===this.notes.length||De.isDisplayed(this.page.noteBox)&&De.isDisplayed(i))){var s=0,c=this.notes.reduce((function(e,t){return t.acked||s++,!t.acked&&t.severity>e?t.severity:e}),0),u=this.page.noteIndicator;jr(u,c),s?(u.textContent=String(s>99?"".concat(99,"+"):s),De.show(u)):De.hide(u)}}},{key:"prependListElement",value:function(e,t,n){for(n.note=t,e.prepend(n);e.children.length>100;)e.removeChild(e.lastChild);this.setNoteTimes(e)}},{key:"makeNote",value:function(e){var t=this.page.noteTmpl.cloneNode(!0);if(e.severity>2){var n=3===e.severity?"good":4===e.severity?"warn":"bad";De.safeSelector(t,"div.note-indicator").classList.add(n)}return De.safeSelector(t,"div.note-subject").textContent=e.subject,De.safeSelector(t,"div.note-details").textContent=e.details,[t,Rr({el:t},e)]}},{key:"makePoke",value:function(e){var t=this.page.pokeTmpl.cloneNode(!0),n=new Date(e.stamp);return De.tmplElement(t,"dateTime").textContent="".concat(n.toLocaleDateString(),", ").concat(n.toLocaleTimeString()),De.tmplElement(t,"details").textContent="".concat(e.subject,": ").concat(e.details),[t,Rr({el:t},e)]}},{key:"loading",value:function(e){var t=this.page.loader.cloneNode(!0);return e.appendChild(t),function(){t.remove()}}},{key:"orders",value:function(e,t){var n=this.user.exchanges[e].markets[t].orders;return n||(n=[],this.user.exchanges[e].markets[t].orders=n),n}},{key:"haveAssetOrders",value:function(e){for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++){var r=n[t];if(r.markets)for(var a=0,o=Object.values(r.markets);a<o.length;a++){var i=o[a];if(i.orders){var s,c=Ir(i.orders);try{for(c.s();!(s=c.n()).done;){var u=s.value;if((u.baseID===e||u.quoteID===e)&&(u.status<3||yt(u)))return!0}}catch(e){c.e(e)}finally{c.f()}}}}return!1}},{key:"walletIsActive",value:function(e){if(this.haveAssetOrders(e))return!0;for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++){var r=n[t];if(r.pendingFee&&r.pendingFee.assetID===e)return!0}return!1}},{key:"order",value:function(e){for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++)for(var r=n[t],a=0,o=Object.values(r.markets);a<o.length;a++){var i=o[a];if(i.orders){var s,c=Ir(i.orders);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(u.id===e)return u}}catch(e){c.e(e)}finally{c.f()}}}return null}},{key:"canAccelerateOrder",value:function(e){var t;t=e.sell?e.baseID:e.quoteID;var n=this.walletMap[t];if(!(n&&16&n.traits))return!1;if(e.matches)for(var r=0;r<e.matches.length;r++){var a=e.matches[r];if(a.swap&&a.swap.confs&&0===a.swap.confs.count)return!0}return!1}},{key:"unitInfo",value:function(e,t){var n=this.assets[e];if(n)return n.info.unitinfo;if(!t)throw Error("no supported asset info for id = ".concat(e,", and no exchange info provided"));return t.assets[e].unitInfo}},{key:"conventionalRate",value:function(e,t,n){var r=[this.unitInfo(e),this.unitInfo(t)],a=r[1],o=r[0].conventional.conversionFactor/a.conventional.conversionFactor;return n/ft*o}},{key:"walletDefinition",value:function(e,t){var n=this.assets[e].info;return""===t?n.availablewallets[n.emptyidx]:n.availablewallets.filter((function(e){return e.type===t}))[0]}},{key:"currentWalletDefinition",value:function(e){return this.walletDefinition(e,this.assets[e].wallet.type)}},{key:"fetchBalance",value:(n=o(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt("/api/balance",{assetID:t});case 2:if(n=e.sent,this.checkResponse(n)){e.next=5;break}throw new Error("failed to fetch balance for asset ID ".concat(t));case 5:return e.abrupt("return",n.balance);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"checkResponse",value:function(e,t){return!(!e.requestSuccessful||!e.ok)||(this.user.inited&&!t&&this.notify(Xt(ke(ae),e.msg,5)),!1)}},{key:"signOut",value:(t=o(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt("/api/logout");case 2:if(t=e.sent,this.checkResponse(t)){e.next=6;break}return De.hide(this.page.profileBox),e.abrupt("return");case 6:Ve.clearAllStore(),Ve.removeAuthCK(),window.location.href="/login";case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Nr=(u(Fr={},3,"good"),u(Fr,5,"bad"),u(Fr,4,"warn"),Fr);function Ur(e){return e.replace(/^\//,"").split("/")[0].split("?")[0].split("#")[0]}function zr(){var e=new Date,t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0"),a=e.getMilliseconds().toString().padStart(3,"0");return"".concat(t,":").concat(n,":").concat(r,".").concat(a)}function jr(e,t){e.classList.remove("bad","warn","good"),e.classList.add(Nr[t])}var _r=new Mr;Je=_r,_r.start()})()})();
//# sourceMappingURL=entry.js.map